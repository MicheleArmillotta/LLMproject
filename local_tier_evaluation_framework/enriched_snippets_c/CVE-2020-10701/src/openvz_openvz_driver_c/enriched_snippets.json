[
  {
    "function_name": "openvzRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "2422-2426",
    "snippet": "int openvzRegister(void)\n{\n    return virRegisterConnectDriver(&openvzConnectDriver,\n                                    false);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virConnectDriver openvzConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"openvz\", NULL },\n    .hypervisorDriver = &openvzHypervisorDriver,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRegisterConnectDriver",
          "args": [
            "&openvzConnectDriver",
            "false"
          ],
          "line": 2424
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterConnectDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "515-550",
          "snippet": "int\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];",
            "static int virConnectDriverTabCount;",
            "static virNetworkDriverPtr virSharedNetworkDriver;",
            "static virInterfaceDriverPtr virSharedInterfaceDriver;",
            "static virStorageDriverPtr virSharedStorageDriver;",
            "static virNodeDeviceDriverPtr virSharedNodeDeviceDriver;",
            "static virSecretDriverPtr virSharedSecretDriver;",
            "static virNWFilterDriverPtr virSharedNWFilterDriver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];\nstatic int virConnectDriverTabCount;\nstatic virNetworkDriverPtr virSharedNetworkDriver;\nstatic virInterfaceDriverPtr virSharedInterfaceDriver;\nstatic virStorageDriverPtr virSharedStorageDriver;\nstatic virNodeDeviceDriverPtr virSharedNodeDeviceDriver;\nstatic virSecretDriverPtr virSharedSecretDriver;\nstatic virNWFilterDriverPtr virSharedNWFilterDriver;\n\nint\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virConnectDriver openvzConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"openvz\", NULL },\n    .hypervisorDriver = &openvzHypervisorDriver,\n};\n\nint openvzRegister(void)\n{\n    return virRegisterConnectDriver(&openvzConnectDriver,\n                                    false);\n}"
  },
  {
    "function_name": "openvzDomainHasManagedSaveImage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "2328-2344",
    "snippet": "static int\nopenvzDomainHasManagedSaveImage(virDomainPtr dom, unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    ret = 0;\n\n    virDomainObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 2342
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 2337
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 2335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainHasManagedSaveImage(virDomainPtr dom, unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    ret = 0;\n\n    virDomainObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainMigrateConfirm3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "2280-2326",
    "snippet": "static int\nopenvzDomainMigrateConfirm3Params(virDomainPtr domain,\n                                  virTypedParameterPtr params,\n                                  int nparams,\n                                  const char *cookiein G_GNUC_UNUSED,\n                                  int cookieinlen G_GNUC_UNUSED,\n                                  unsigned int flags,\n                                  int cancelled)\n{\n    struct openvz_driver *driver = domain->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    int status;\n    int ret = -1;\n\n    virCheckFlags(OPENVZ_MIGRATION_FLAGS, -1);\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (!(vm = openvzDomObjFromDomain(driver, domain->uuid)))\n        goto cleanup;\n\n    if (cancelled) {\n        if (openvzGetVEStatus(vm, &status, NULL) == -1)\n            goto cleanup;\n\n        if (status == VIR_DOMAIN_RUNNING) {\n            ret = 0;\n        } else {\n            VIR_DEBUG(\"Domain '%s' does not recover after failed migration\",\n                      vm->def->name);\n        }\n\n        goto cleanup;\n    }\n\n    vm->def->id = -1;\n\n    VIR_DEBUG(\"Domain '%s' successfully migrated\", vm->def->name);\n\n    virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2324
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "driver->domains",
            "vm"
          ],
          "line": 2319
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Domain '%s' successfully migrated\"",
            "vm->def->name"
          ],
          "line": 2317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Domain '%s' does not recover after failed migration\"",
            "vm->def->name"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "&status",
            "NULL"
          ],
          "line": 2302
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "domain->uuid"
          ],
          "line": 2298
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "OPENVZ_MIGRATION_PARAMETERS"
          ],
          "line": 2295
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "OPENVZ_MIGRATION_FLAGS",
            "-1"
          ],
          "line": 2294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzDomainMigrateConfirm3Params(virDomainPtr domain,\n                                  virTypedParameterPtr params,\n                                  int nparams,\n                                  const char *cookiein G_GNUC_UNUSED,\n                                  int cookieinlen G_GNUC_UNUSED,\n                                  unsigned int flags,\n                                  int cancelled)\n{\n    struct openvz_driver *driver = domain->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    int status;\n    int ret = -1;\n\n    virCheckFlags(OPENVZ_MIGRATION_FLAGS, -1);\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (!(vm = openvzDomObjFromDomain(driver, domain->uuid)))\n        goto cleanup;\n\n    if (cancelled) {\n        if (openvzGetVEStatus(vm, &status, NULL) == -1)\n            goto cleanup;\n\n        if (status == VIR_DOMAIN_RUNNING) {\n            ret = 0;\n        } else {\n            VIR_DEBUG(\"Domain '%s' does not recover after failed migration\",\n                      vm->def->name);\n        }\n\n        goto cleanup;\n    }\n\n    vm->def->id = -1;\n\n    VIR_DEBUG(\"Domain '%s' successfully migrated\", vm->def->name);\n\n    virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainMigrateFinish3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "2222-2278",
    "snippet": "static virDomainPtr\nopenvzDomainMigrateFinish3Params(virConnectPtr dconn,\n                                 virTypedParameterPtr params,\n                                 int nparams,\n                                 const char *cookiein G_GNUC_UNUSED,\n                                 int cookieinlen G_GNUC_UNUSED,\n                                 char **cookieout G_GNUC_UNUSED,\n                                 int *cookieoutlen G_GNUC_UNUSED,\n                                 unsigned int flags,\n                                 int cancelled)\n{\n    struct openvz_driver *driver = dconn->privateData;\n    virDomainObjPtr vm = NULL;\n    const char *dname = NULL;\n    virDomainPtr dom = NULL;\n    int status;\n\n    if (cancelled)\n        goto cleanup;\n\n    virCheckFlags(OPENVZ_MIGRATION_FLAGS, NULL);\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME,\n                                &dname) < 0)\n        goto cleanup;\n\n    if (!dname ||\n        !(vm = virDomainObjListFindByName(driver->domains, dname))) {\n        /* Migration obviously failed if the domain doesn't exist */\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Migration failed. No domain on destination host \"\n                         \"with matching name '%s'\"),\n                       NULLSTR(dname));\n        goto cleanup;\n    }\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not running on destination host\"));\n        goto cleanup;\n    }\n\n    vm->def->id = strtoI(vm->def->name);\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_MIGRATED);\n\n    dom = virGetDomain(dconn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2276
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "dconn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 2273
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_RUNNING",
            "VIR_DOMAIN_RUNNING_MIGRATED"
          ],
          "line": 2271
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoI",
          "args": [
            "vm->def->name"
          ],
          "line": 2270
        },
        "resolved": true,
        "details": {
          "function_name": "strtoI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "54-63",
          "snippet": "int\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domain is not running on destination host\")"
          ],
          "line": 2265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domain is not running on destination host\""
          ],
          "line": 2266
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "&status",
            "NULL"
          ],
          "line": 2261
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"Migration failed. No domain on destination host \"\n                         \"with matching name '%s'\")",
            "NULLSTR(dname)"
          ],
          "line": 2254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 2257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByName",
          "args": [
            "driver->domains",
            "dname"
          ],
          "line": 2252
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "205-222",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "&dname"
          ],
          "line": 2246
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "OPENVZ_MIGRATION_PARAMETERS"
          ],
          "line": 2243
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "OPENVZ_MIGRATION_FLAGS",
            "NULL"
          ],
          "line": 2242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic virDomainPtr\nopenvzDomainMigrateFinish3Params(virConnectPtr dconn,\n                                 virTypedParameterPtr params,\n                                 int nparams,\n                                 const char *cookiein G_GNUC_UNUSED,\n                                 int cookieinlen G_GNUC_UNUSED,\n                                 char **cookieout G_GNUC_UNUSED,\n                                 int *cookieoutlen G_GNUC_UNUSED,\n                                 unsigned int flags,\n                                 int cancelled)\n{\n    struct openvz_driver *driver = dconn->privateData;\n    virDomainObjPtr vm = NULL;\n    const char *dname = NULL;\n    virDomainPtr dom = NULL;\n    int status;\n\n    if (cancelled)\n        goto cleanup;\n\n    virCheckFlags(OPENVZ_MIGRATION_FLAGS, NULL);\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME,\n                                &dname) < 0)\n        goto cleanup;\n\n    if (!dname ||\n        !(vm = virDomainObjListFindByName(driver->domains, dname))) {\n        /* Migration obviously failed if the domain doesn't exist */\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Migration failed. No domain on destination host \"\n                         \"with matching name '%s'\"),\n                       NULLSTR(dname));\n        goto cleanup;\n    }\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not running on destination host\"));\n        goto cleanup;\n    }\n\n    vm->def->id = strtoI(vm->def->name);\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_MIGRATED);\n\n    dom = virGetDomain(dconn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "openvzDomainMigratePerform3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "2169-2220",
    "snippet": "static int\nopenvzDomainMigratePerform3Params(virDomainPtr domain,\n                                  const char *dconnuri G_GNUC_UNUSED,\n                                  virTypedParameterPtr params,\n                                  int nparams,\n                                  const char *cookiein G_GNUC_UNUSED,\n                                  int cookieinlen G_GNUC_UNUSED,\n                                  char **cookieout G_GNUC_UNUSED,\n                                  int *cookieoutlen G_GNUC_UNUSED,\n                                  unsigned int flags)\n{\n    struct openvz_driver *driver = domain->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    const char *uri_str = NULL;\n    virURIPtr uri = NULL;\n    virCommandPtr cmd = NULL;\n    int ret = -1;\n\n    virCheckFlags(OPENVZ_MIGRATION_FLAGS, -1);\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI,\n                                &uri_str) < 0)\n        goto cleanup;\n\n    if (!(vm = openvzDomObjFromDomain(driver, domain->uuid)))\n        goto cleanup;\n\n    /* parse dst host:port from uri */\n    uri = virURIParse(uri_str);\n    if (uri == NULL || uri->server == NULL)\n        goto cleanup;\n\n    cmd = virCommandNew(VZMIGRATE);\n    if (flags & VIR_MIGRATE_LIVE)\n        virCommandAddArg(cmd, \"--live\");\n    virCommandAddArg(cmd, uri->server);\n    virCommandAddArg(cmd, vm->def->name);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    virURIFree(uri);\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2218
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virURIFree",
          "args": [
            "uri"
          ],
          "line": 2217
        },
        "resolved": true,
        "details": {
          "function_name": "virURIFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "277-298",
          "snippet": "void virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvoid virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 2216
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 2210
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArg",
          "args": [
            "cmd",
            "vm->def->name"
          ],
          "line": 2208
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1655-1684",
          "snippet": "void\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNew",
          "args": [
            "VZMIGRATE"
          ],
          "line": 2204
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virURIParse",
          "args": [
            "uri_str"
          ],
          "line": 2200
        },
        "resolved": true,
        "details": {
          "function_name": "virURIParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "143-194",
          "snippet": "virURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvirURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "domain->uuid"
          ],
          "line": 2196
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_URI",
            "&uri_str"
          ],
          "line": 2191
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "OPENVZ_MIGRATION_PARAMETERS"
          ],
          "line": 2188
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "OPENVZ_MIGRATION_FLAGS",
            "-1"
          ],
          "line": 2187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzDomainMigratePerform3Params(virDomainPtr domain,\n                                  const char *dconnuri G_GNUC_UNUSED,\n                                  virTypedParameterPtr params,\n                                  int nparams,\n                                  const char *cookiein G_GNUC_UNUSED,\n                                  int cookieinlen G_GNUC_UNUSED,\n                                  char **cookieout G_GNUC_UNUSED,\n                                  int *cookieoutlen G_GNUC_UNUSED,\n                                  unsigned int flags)\n{\n    struct openvz_driver *driver = domain->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    const char *uri_str = NULL;\n    virURIPtr uri = NULL;\n    virCommandPtr cmd = NULL;\n    int ret = -1;\n\n    virCheckFlags(OPENVZ_MIGRATION_FLAGS, -1);\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI,\n                                &uri_str) < 0)\n        goto cleanup;\n\n    if (!(vm = openvzDomObjFromDomain(driver, domain->uuid)))\n        goto cleanup;\n\n    /* parse dst host:port from uri */\n    uri = virURIParse(uri_str);\n    if (uri == NULL || uri->server == NULL)\n        goto cleanup;\n\n    cmd = virCommandNew(VZMIGRATE);\n    if (flags & VIR_MIGRATE_LIVE)\n        virCommandAddArg(cmd, \"--live\");\n    virCommandAddArg(cmd, uri->server);\n    virCommandAddArg(cmd, vm->def->name);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    virURIFree(uri);\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainMigratePrepare3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "2070-2167",
    "snippet": "static int\nopenvzDomainMigratePrepare3Params(virConnectPtr dconn,\n                                  virTypedParameterPtr params,\n                                  int nparams,\n                                  const char *cookiein G_GNUC_UNUSED,\n                                  int cookieinlen G_GNUC_UNUSED,\n                                  char **cookieout G_GNUC_UNUSED,\n                                  int *cookieoutlen G_GNUC_UNUSED,\n                                  char **uri_out,\n                                  unsigned int fflags G_GNUC_UNUSED)\n{\n    struct openvz_driver *driver = dconn->privateData;\n    const char *dom_xml = NULL;\n    const char *uri_in = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    char *my_hostname = NULL;\n    const char *hostname = NULL;\n    virURIPtr uri = NULL;\n    int ret = -1;\n\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        goto error;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML,\n                                &dom_xml) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI,\n                                &uri_in) < 0)\n        goto error;\n\n    if (!dom_xml) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no domain XML passed\"));\n        goto error;\n    }\n\n    if (!(def = virDomainDefParseString(dom_xml, driver->xmlopt,\n                                        NULL,\n                                        VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                        VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE)))\n        goto error;\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE,\n                                   NULL)))\n        goto error;\n    def = NULL;\n\n    if (!uri_in) {\n        if ((my_hostname = virGetHostname()) == NULL)\n            goto error;\n\n        if (STRPREFIX(my_hostname, \"localhost\")) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"hostname on destination resolved to localhost,\"\n                             \" but migration requires an FQDN\"));\n            goto error;\n        }\n    } else {\n        uri = virURIParse(uri_in);\n\n        if (uri == NULL) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unable to parse URI: %s\"),\n                           uri_in);\n            goto error;\n        }\n\n        if (uri->server == NULL) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"missing host in migration URI: %s\"),\n                           uri_in);\n            goto error;\n        } else {\n            hostname = uri->server;\n        }\n    }\n\n    *uri_out = g_strdup_printf(\"ssh://%s\", hostname);\n\n    ret = 0;\n    goto done;\n\n error:\n    virDomainDefFree(def);\n    if (vm)\n        virDomainObjListRemove(driver->domains, vm);\n\n done:\n    VIR_FREE(my_hostname);\n    virURIFree(uri);\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2165
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virURIFree",
          "args": [
            "uri"
          ],
          "line": 2164
        },
        "resolved": true,
        "details": {
          "function_name": "virURIFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "277-298",
          "snippet": "void virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvoid virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "my_hostname"
          ],
          "line": 2163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "driver->domains",
            "vm"
          ],
          "line": 2160
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 2158
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"ssh://%s\"",
            "hostname"
          ],
          "line": 2152
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"missing host in migration URI: %s\")",
            "uri_in"
          ],
          "line": 2143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unable to parse URI: %s\")",
            "uri_in"
          ],
          "line": 2136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virURIParse",
          "args": [
            "uri_in"
          ],
          "line": 2133
        },
        "resolved": true,
        "details": {
          "function_name": "virURIParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "143-194",
          "snippet": "virURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvirURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"hostname on destination resolved to localhost,\"\n                             \" but migration requires an FQDN\")"
          ],
          "line": 2127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "my_hostname",
            "\"localhost\""
          ],
          "line": 2126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetHostname",
          "args": [],
          "line": 2123
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostnameQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "560-564",
          "snippet": "char *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListAdd",
          "args": [
            "driver->domains",
            "def",
            "driver->xmlopt",
            "VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE",
            "NULL"
          ],
          "line": 2114
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "354-366",
          "snippet": "virDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "dom_xml",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                        VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE"
          ],
          "line": 2108
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"no domain XML passed\")"
          ],
          "line": 2103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_URI",
            "&uri_in"
          ],
          "line": 2097
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "OPENVZ_MIGRATION_PARAMETERS"
          ],
          "line": 2091
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int\nopenvzDomainMigratePrepare3Params(virConnectPtr dconn,\n                                  virTypedParameterPtr params,\n                                  int nparams,\n                                  const char *cookiein G_GNUC_UNUSED,\n                                  int cookieinlen G_GNUC_UNUSED,\n                                  char **cookieout G_GNUC_UNUSED,\n                                  int *cookieoutlen G_GNUC_UNUSED,\n                                  char **uri_out,\n                                  unsigned int fflags G_GNUC_UNUSED)\n{\n    struct openvz_driver *driver = dconn->privateData;\n    const char *dom_xml = NULL;\n    const char *uri_in = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    char *my_hostname = NULL;\n    const char *hostname = NULL;\n    virURIPtr uri = NULL;\n    int ret = -1;\n\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        goto error;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML,\n                                &dom_xml) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI,\n                                &uri_in) < 0)\n        goto error;\n\n    if (!dom_xml) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no domain XML passed\"));\n        goto error;\n    }\n\n    if (!(def = virDomainDefParseString(dom_xml, driver->xmlopt,\n                                        NULL,\n                                        VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                        VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE)))\n        goto error;\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE,\n                                   NULL)))\n        goto error;\n    def = NULL;\n\n    if (!uri_in) {\n        if ((my_hostname = virGetHostname()) == NULL)\n            goto error;\n\n        if (STRPREFIX(my_hostname, \"localhost\")) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"hostname on destination resolved to localhost,\"\n                             \" but migration requires an FQDN\"));\n            goto error;\n        }\n    } else {\n        uri = virURIParse(uri_in);\n\n        if (uri == NULL) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unable to parse URI: %s\"),\n                           uri_in);\n            goto error;\n        }\n\n        if (uri->server == NULL) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"missing host in migration URI: %s\"),\n                           uri_in);\n            goto error;\n        } else {\n            hostname = uri->server;\n        }\n    }\n\n    *uri_out = g_strdup_printf(\"ssh://%s\", hostname);\n\n    ret = 0;\n    goto done;\n\n error:\n    virDomainDefFree(def);\n    if (vm)\n        virDomainObjListRemove(driver->domains, vm);\n\n done:\n    VIR_FREE(my_hostname);\n    virURIFree(uri);\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainMigrateBegin3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "2030-2068",
    "snippet": "static char *\nopenvzDomainMigrateBegin3Params(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                char **cookieout G_GNUC_UNUSED,\n                                int *cookieoutlen G_GNUC_UNUSED,\n                                unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    struct openvz_driver *driver = domain->conn->privateData;\n    char *xml = NULL;\n    int status;\n\n    virCheckFlags(OPENVZ_MIGRATION_FLAGS, NULL);\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        return NULL;\n\n    if (!(vm = openvzDomObjFromDomain(driver, domain->uuid)))\n        return NULL;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    xml = virDomainDefFormat(vm->def, driver->xmlopt,\n                             VIR_DOMAIN_DEF_FORMAT_SECURE);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return xml;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2066
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormat",
          "args": [
            "vm->def",
            "driver->xmlopt",
            "VIR_DOMAIN_DEF_FORMAT_SECURE"
          ],
          "line": 2062
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29496-29508",
          "snippet": "char *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)\n\nchar *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domain is not in running state\")"
          ],
          "line": 2057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domain is not in running state\""
          ],
          "line": 2058
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "&status",
            "NULL"
          ],
          "line": 2053
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2050
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "domain->uuid"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "OPENVZ_MIGRATION_PARAMETERS"
          ],
          "line": 2044
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "OPENVZ_MIGRATION_FLAGS",
            "NULL"
          ],
          "line": 2043
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic char *\nopenvzDomainMigrateBegin3Params(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                char **cookieout G_GNUC_UNUSED,\n                                int *cookieoutlen G_GNUC_UNUSED,\n                                unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    struct openvz_driver *driver = domain->conn->privateData;\n    char *xml = NULL;\n    int status;\n\n    virCheckFlags(OPENVZ_MIGRATION_FLAGS, NULL);\n    if (virTypedParamsValidate(params, nparams, OPENVZ_MIGRATION_PARAMETERS) < 0)\n        return NULL;\n\n    if (!(vm = openvzDomObjFromDomain(driver, domain->uuid)))\n        return NULL;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    xml = virDomainDefFormat(vm->def, driver->xmlopt,\n                             VIR_DOMAIN_DEF_FORMAT_SECURE);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return xml;\n}"
  },
  {
    "function_name": "openvzConnectSupportsFeature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "2004-2027",
    "snippet": "static int\nopenvzConnectSupportsFeature(virConnectPtr conn G_GNUC_UNUSED, int feature)\n{\n    switch ((virDrvFeature) feature) {\n    case VIR_DRV_FEATURE_MIGRATION_PARAMS:\n    case VIR_DRV_FEATURE_MIGRATION_V3:\n        return 1;\n    case VIR_DRV_FEATURE_FD_PASSING:\n    case VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION:\n    case VIR_DRV_FEATURE_MIGRATION_DIRECT:\n    case VIR_DRV_FEATURE_MIGRATION_OFFLINE:\n    case VIR_DRV_FEATURE_MIGRATION_P2P:\n    case VIR_DRV_FEATURE_MIGRATION_V1:\n    case VIR_DRV_FEATURE_MIGRATION_V2:\n    case VIR_DRV_FEATURE_PROGRAM_KEEPALIVE:\n    case VIR_DRV_FEATURE_REMOTE:\n    case VIR_DRV_FEATURE_REMOTE_CLOSE_CALLBACK:\n    case VIR_DRV_FEATURE_REMOTE_EVENT_CALLBACK:\n    case VIR_DRV_FEATURE_TYPED_PARAM_STRING:\n    case VIR_DRV_FEATURE_XML_MIGRATABLE:\n    default:\n        return 0;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzConnectSupportsFeature(virConnectPtr conn G_GNUC_UNUSED, int feature)\n{\n    switch ((virDrvFeature) feature) {\n    case VIR_DRV_FEATURE_MIGRATION_PARAMS:\n    case VIR_DRV_FEATURE_MIGRATION_V3:\n        return 1;\n    case VIR_DRV_FEATURE_FD_PASSING:\n    case VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION:\n    case VIR_DRV_FEATURE_MIGRATION_DIRECT:\n    case VIR_DRV_FEATURE_MIGRATION_OFFLINE:\n    case VIR_DRV_FEATURE_MIGRATION_P2P:\n    case VIR_DRV_FEATURE_MIGRATION_V1:\n    case VIR_DRV_FEATURE_MIGRATION_V2:\n    case VIR_DRV_FEATURE_PROGRAM_KEEPALIVE:\n    case VIR_DRV_FEATURE_REMOTE:\n    case VIR_DRV_FEATURE_REMOTE_CLOSE_CALLBACK:\n    case VIR_DRV_FEATURE_REMOTE_EVENT_CALLBACK:\n    case VIR_DRV_FEATURE_TYPED_PARAM_STRING:\n    case VIR_DRV_FEATURE_XML_MIGRATABLE:\n    default:\n        return 0;\n    }\n}"
  },
  {
    "function_name": "openvzNodeGetCPUMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1994-2001",
    "snippet": "static int\nopenvzNodeGetCPUMap(virConnectPtr conn G_GNUC_UNUSED,\n                    unsigned char **cpumap,\n                    unsigned int *online,\n                    unsigned int flags)\n{\n    return virHostCPUGetMap(cpumap, online, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostCPUGetMap",
          "args": [
            "cpumap",
            "online",
            "flags"
          ],
          "line": 2000
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetMap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "1087-1116",
          "snippet": "int\nvirHostCPUGetMap(unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    virBitmapPtr cpus = NULL;\n    int ret = -1;\n    int dummy;\n\n    virCheckFlags(0, -1);\n\n    if (!cpumap && !online)\n        return virHostCPUGetCount();\n\n    if (!(cpus = virHostCPUGetOnlineBitmap()))\n        goto cleanup;\n\n    if (cpumap && virBitmapToData(cpus, cpumap, &dummy) < 0)\n        goto cleanup;\n    if (online)\n        *online = virBitmapCountBits(cpus);\n\n    ret = virHostCPUGetCount();\n\n cleanup:\n    if (ret < 0 && cpumap)\n        VIR_FREE(*cpumap);\n    virBitmapFree(cpus);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetMap(unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    virBitmapPtr cpus = NULL;\n    int ret = -1;\n    int dummy;\n\n    virCheckFlags(0, -1);\n\n    if (!cpumap && !online)\n        return virHostCPUGetCount();\n\n    if (!(cpus = virHostCPUGetOnlineBitmap()))\n        goto cleanup;\n\n    if (cpumap && virBitmapToData(cpus, cpumap, &dummy) < 0)\n        goto cleanup;\n    if (online)\n        *online = virBitmapCountBits(cpus);\n\n    ret = virHostCPUGetCount();\n\n cleanup:\n    if (ret < 0 && cpumap)\n        VIR_FREE(*cpumap);\n    virBitmapFree(cpus);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzNodeGetCPUMap(virConnectPtr conn G_GNUC_UNUSED,\n                    unsigned char **cpumap,\n                    unsigned int *online,\n                    unsigned int flags)\n{\n    return virHostCPUGetMap(cpumap, online, flags);\n}"
  },
  {
    "function_name": "openvzNodeGetFreeMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1984-1991",
    "snippet": "static unsigned long long\nopenvzNodeGetFreeMemory(virConnectPtr conn G_GNUC_UNUSED)\n{\n    unsigned long long freeMem;\n    if (virHostMemGetInfo(NULL, &freeMem) < 0)\n        return 0;\n    return freeMem;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetInfo",
          "args": [
            "NULL",
            "&freeMem"
          ],
          "line": 1988
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "790-826",
          "snippet": "int\nvirHostMemGetInfo(unsigned long long *mem,\n                  unsigned long long *freeMem)\n{\n    int max_node;\n    int n;\n\n    if (mem)\n        *mem = 0;\n\n    if (freeMem)\n        *freeMem = 0;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetInfoFake(mem, freeMem);\n\n    if ((max_node = virNumaGetMaxNode()) < 0)\n        return -1;\n\n    for (n = 0; n <= max_node; n++) {\n        unsigned long long tmp_mem = 0, tmp_freeMem = 0;\n\n        if (!virNumaNodeIsAvailable(n))\n            continue;\n\n        if (virNumaGetNodeMemory(n, &tmp_mem, &tmp_freeMem) < 0)\n            return -1;\n\n        if (mem)\n            *mem += tmp_mem;\n\n        if (freeMem)\n            *freeMem += tmp_freeMem;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetInfo(unsigned long long *mem,\n                  unsigned long long *freeMem)\n{\n    int max_node;\n    int n;\n\n    if (mem)\n        *mem = 0;\n\n    if (freeMem)\n        *freeMem = 0;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetInfoFake(mem, freeMem);\n\n    if ((max_node = virNumaGetMaxNode()) < 0)\n        return -1;\n\n    for (n = 0; n <= max_node; n++) {\n        unsigned long long tmp_mem = 0, tmp_freeMem = 0;\n\n        if (!virNumaNodeIsAvailable(n))\n            continue;\n\n        if (virNumaGetNodeMemory(n, &tmp_mem, &tmp_freeMem) < 0)\n            return -1;\n\n        if (mem)\n            *mem += tmp_mem;\n\n        if (freeMem)\n            *freeMem += tmp_freeMem;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic unsigned long long\nopenvzNodeGetFreeMemory(virConnectPtr conn G_GNUC_UNUSED)\n{\n    unsigned long long freeMem;\n    if (virHostMemGetInfo(NULL, &freeMem) < 0)\n        return 0;\n    return freeMem;\n}"
  },
  {
    "function_name": "openvzNodeGetCellsFreeMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1974-1981",
    "snippet": "static int\nopenvzNodeGetCellsFreeMemory(virConnectPtr conn G_GNUC_UNUSED,\n                             unsigned long long *freeMems,\n                             int startCell,\n                             int maxCells)\n{\n    return virHostMemGetCellsFree(freeMems, startCell, maxCells);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetCellsFree",
          "args": [
            "freeMems",
            "startCell",
            "maxCells"
          ],
          "line": 1980
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetCellsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "756-788",
          "snippet": "int\nvirHostMemGetCellsFree(unsigned long long *freeMems,\n                       int startCell,\n                       int maxCells)\n{\n    unsigned long long mem;\n    int n, lastCell, numCells;\n    int maxCell;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetCellsFreeFake(freeMems,\n                                          startCell, maxCells);\n\n    if ((maxCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > maxCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, maxCell);\n        return -1;\n    }\n    lastCell = startCell + maxCells - 1;\n    if (lastCell > maxCell)\n        lastCell = maxCell;\n\n    for (numCells = 0, n = startCell; n <= lastCell; n++) {\n        virNumaGetNodeMemory(n, NULL, &mem);\n\n        freeMems[numCells++] = mem;\n    }\n    return numCells;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetCellsFree(unsigned long long *freeMems,\n                       int startCell,\n                       int maxCells)\n{\n    unsigned long long mem;\n    int n, lastCell, numCells;\n    int maxCell;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetCellsFreeFake(freeMems,\n                                          startCell, maxCells);\n\n    if ((maxCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > maxCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, maxCell);\n        return -1;\n    }\n    lastCell = startCell + maxCells - 1;\n    if (lastCell > maxCell)\n        lastCell = maxCell;\n\n    for (numCells = 0, n = startCell; n <= lastCell; n++) {\n        virNumaGetNodeMemory(n, NULL, &mem);\n\n        freeMems[numCells++] = mem;\n    }\n    return numCells;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzNodeGetCellsFreeMemory(virConnectPtr conn G_GNUC_UNUSED,\n                             unsigned long long *freeMems,\n                             int startCell,\n                             int maxCells)\n{\n    return virHostMemGetCellsFree(freeMems, startCell, maxCells);\n}"
  },
  {
    "function_name": "openvzNodeGetMemoryStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1963-1971",
    "snippet": "static int\nopenvzNodeGetMemoryStats(virConnectPtr conn G_GNUC_UNUSED,\n                         int cellNum,\n                         virNodeMemoryStatsPtr params,\n                         int *nparams,\n                         unsigned int flags)\n{\n    return virHostMemGetStats(cellNum, params, nparams, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetStats",
          "args": [
            "cellNum",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1970
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "244-302",
          "snippet": "int\nvirHostMemGetStats(int cellNum G_GNUC_UNUSED,\n                   virNodeMemoryStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        g_autofree char *meminfo_path = NULL;\n        FILE *meminfo;\n        int max_node;\n\n        /*\n         * Even if built without numactl, libvirt claims\n         * to have a one-cells NUMA topology. In such a\n         * case return the statistics for the entire host.\n         */\n        if (!virNumaIsAvailable() && cellNum == 0)\n            cellNum = VIR_NODE_MEMORY_STATS_ALL_CELLS;\n\n        if (cellNum == VIR_NODE_MEMORY_STATS_ALL_CELLS) {\n            meminfo_path = g_strdup(MEMINFO_PATH);\n        } else {\n            if ((max_node = virNumaGetMaxNode()) < 0)\n                return -1;\n\n            if (cellNum > max_node) {\n                virReportInvalidArg(cellNum,\n                                    _(\"cellNum in %s must be less than or equal to %d\"),\n                                    __FUNCTION__, max_node);\n                return -1;\n            }\n\n            meminfo_path = g_strdup_printf(\n                                           SYSFS_SYSTEM_PATH \"/node/node%d/meminfo\", cellNum);\n        }\n        meminfo = fopen(meminfo_path, \"r\");\n\n        if (!meminfo) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), meminfo_path);\n            return -1;\n        }\n        ret = virHostMemGetStatsLinux(meminfo, cellNum, params, nparams);\n        VIR_FORCE_FCLOSE(meminfo);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostMemGetStatsFreeBSD(params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node memory stats not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetStats(int cellNum G_GNUC_UNUSED,\n                   virNodeMemoryStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        g_autofree char *meminfo_path = NULL;\n        FILE *meminfo;\n        int max_node;\n\n        /*\n         * Even if built without numactl, libvirt claims\n         * to have a one-cells NUMA topology. In such a\n         * case return the statistics for the entire host.\n         */\n        if (!virNumaIsAvailable() && cellNum == 0)\n            cellNum = VIR_NODE_MEMORY_STATS_ALL_CELLS;\n\n        if (cellNum == VIR_NODE_MEMORY_STATS_ALL_CELLS) {\n            meminfo_path = g_strdup(MEMINFO_PATH);\n        } else {\n            if ((max_node = virNumaGetMaxNode()) < 0)\n                return -1;\n\n            if (cellNum > max_node) {\n                virReportInvalidArg(cellNum,\n                                    _(\"cellNum in %s must be less than or equal to %d\"),\n                                    __FUNCTION__, max_node);\n                return -1;\n            }\n\n            meminfo_path = g_strdup_printf(\n                                           SYSFS_SYSTEM_PATH \"/node/node%d/meminfo\", cellNum);\n        }\n        meminfo = fopen(meminfo_path, \"r\");\n\n        if (!meminfo) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), meminfo_path);\n            return -1;\n        }\n        ret = virHostMemGetStatsLinux(meminfo, cellNum, params, nparams);\n        VIR_FORCE_FCLOSE(meminfo);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostMemGetStatsFreeBSD(params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node memory stats not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzNodeGetMemoryStats(virConnectPtr conn G_GNUC_UNUSED,\n                         int cellNum,\n                         virNodeMemoryStatsPtr params,\n                         int *nparams,\n                         unsigned int flags)\n{\n    return virHostMemGetStats(cellNum, params, nparams, flags);\n}"
  },
  {
    "function_name": "openvzNodeGetCPUStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1952-1960",
    "snippet": "static int\nopenvzNodeGetCPUStats(virConnectPtr conn G_GNUC_UNUSED,\n                      int cpuNum,\n                      virNodeCPUStatsPtr params,\n                      int *nparams,\n                      unsigned int flags)\n{\n    return virHostCPUGetStats(cpuNum, params, nparams, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostCPUGetStats",
          "args": [
            "cpuNum",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1959
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "998-1027",
          "snippet": "int\nvirHostCPUGetStats(int cpuNum G_GNUC_UNUSED,\n                   virNodeCPUStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        FILE *procstat = fopen(PROCSTAT_PATH, \"r\");\n        if (!procstat) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), PROCSTAT_PATH);\n            return -1;\n        }\n        ret = virHostCPUGetStatsLinux(procstat, cpuNum, params, nparams);\n        VIR_FORCE_FCLOSE(procstat);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostCPUGetStatsFreeBSD(cpuNum, params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node CPU stats not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetStats(int cpuNum G_GNUC_UNUSED,\n                   virNodeCPUStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        FILE *procstat = fopen(PROCSTAT_PATH, \"r\");\n        if (!procstat) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), PROCSTAT_PATH);\n            return -1;\n        }\n        ret = virHostCPUGetStatsLinux(procstat, cpuNum, params, nparams);\n        VIR_FORCE_FCLOSE(procstat);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostCPUGetStatsFreeBSD(cpuNum, params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node CPU stats not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzNodeGetCPUStats(virConnectPtr conn G_GNUC_UNUSED,\n                      int cpuNum,\n                      virNodeCPUStatsPtr params,\n                      int *nparams,\n                      unsigned int flags)\n{\n    return virHostCPUGetStats(cpuNum, params, nparams, flags);\n}"
  },
  {
    "function_name": "openvzNodeGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1944-1949",
    "snippet": "static int\nopenvzNodeGetInfo(virConnectPtr conn G_GNUC_UNUSED,\n                  virNodeInfoPtr nodeinfo)\n{\n    return virCapabilitiesGetNodeInfo(nodeinfo);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesGetNodeInfo",
          "args": [
            "nodeinfo"
          ],
          "line": 1948
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesGetNodeInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1434-1456",
          "snippet": "int\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzNodeGetInfo(virConnectPtr conn G_GNUC_UNUSED,\n                  virNodeInfoPtr nodeinfo)\n{\n    return virCapabilitiesGetNodeInfo(nodeinfo);\n}"
  },
  {
    "function_name": "openvzConnectListAllDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1924-1940",
    "snippet": "static int\nopenvzConnectListAllDomains(virConnectPtr conn,\n                            virDomainPtr **domains,\n                            unsigned int flags)\n{\n    struct openvz_driver *driver = conn->privateData;\n    int ret = -1;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL, -1);\n\n    openvzDriverLock(driver);\n    ret = virDomainObjListExport(driver->domains, conn, domains,\n                                 NULL, flags);\n    openvzDriverUnlock(driver);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1937
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListExport",
          "args": [
            "driver->domains",
            "conn",
            "domains",
            "NULL",
            "flags"
          ],
          "line": 1935
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListExport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "1060-1101",
          "snippet": "int\nvirDomainObjListExport(virDomainObjListPtr domlist,\n                       virConnectPtr conn,\n                       virDomainPtr **domains,\n                       virDomainObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virDomainObjPtr *vms = NULL;\n    virDomainPtr *doms = NULL;\n    size_t nvms = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virDomainObjListCollect(domlist, conn, &vms, &nvms, filter, flags) < 0)\n        return -1;\n\n    if (domains) {\n        if (VIR_ALLOC_N(doms, nvms + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nvms; i++) {\n            virDomainObjPtr vm = vms[i];\n\n            virObjectLock(vm);\n            doms[i] = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n            virObjectUnlock(vm);\n\n            if (!doms[i])\n                goto cleanup;\n        }\n\n        *domains = doms;\n        doms = NULL;\n    }\n\n    ret = nvms;\n\n cleanup:\n    virObjectListFree(doms);\n    virObjectListFreeCount(vms, nvms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListExport(virDomainObjListPtr domlist,\n                       virConnectPtr conn,\n                       virDomainPtr **domains,\n                       virDomainObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virDomainObjPtr *vms = NULL;\n    virDomainPtr *doms = NULL;\n    size_t nvms = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virDomainObjListCollect(domlist, conn, &vms, &nvms, filter, flags) < 0)\n        return -1;\n\n    if (domains) {\n        if (VIR_ALLOC_N(doms, nvms + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nvms; i++) {\n            virDomainObjPtr vm = vms[i];\n\n            virObjectLock(vm);\n            doms[i] = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n            virObjectUnlock(vm);\n\n            if (!doms[i])\n                goto cleanup;\n        }\n\n        *domains = doms;\n        doms = NULL;\n    }\n\n    ret = nvms;\n\n cleanup:\n    virObjectListFree(doms);\n    virObjectListFreeCount(vms, nvms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 1934
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL",
            "-1"
          ],
          "line": 1932
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzConnectListAllDomains(virConnectPtr conn,\n                            virDomainPtr **domains,\n                            unsigned int flags)\n{\n    struct openvz_driver *driver = conn->privateData;\n    int ret = -1;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL, -1);\n\n    openvzDriverLock(driver);\n    ret = virDomainObjListExport(driver->domains, conn, domains,\n                                 NULL, flags);\n    openvzDriverUnlock(driver);\n\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainUpdateDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1876-1922",
    "snippet": "static int\nopenvzDomainUpdateDeviceFlags(virDomainPtr dom, const char *xml,\n                              unsigned int flags)\n{\n    int ret = -1;\n    int veid;\n    struct  openvz_driver *driver = dom->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    bool persist = false;\n\n    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |\n                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);\n\n    openvzDriverLock(driver);\n    if (!(vm = openvzDomObjFromDomainLocked(driver, dom->uuid)))\n        goto cleanup;\n\n    if (virStrToLong_i(vm->def->name, NULL, 10, &veid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not convert domain name to VEID\"));\n        goto cleanup;\n    }\n\n    if (!(def = virDomainObjGetOneDef(vm, flags)))\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, def, driver->xmlopt, NULL,\n                                  VIR_DOMAIN_DEF_PARSE_INACTIVE);\n    if (!dev)\n        goto cleanup;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG)\n        persist = true;\n\n    if (openvzUpdateDevice(def, dev, persist) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    openvzDriverUnlock(driver);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1920
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefFree",
          "args": [
            "dev"
          ],
          "line": 1919
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3062-3146",
          "snippet": "void virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1918
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzUpdateDevice",
          "args": [
            "def",
            "dev",
            "persist"
          ],
          "line": 1912
        },
        "resolved": true,
        "details": {
          "function_name": "openvzUpdateDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1831-1873",
          "snippet": "static int\nopenvzUpdateDevice(virDomainDefPtr vmdef,\n                   virDomainDeviceDefPtr dev,\n                   bool persist)\n{\n    virDomainFSDefPtr fs, cur;\n    int pos;\n\n    if (dev->type == VIR_DOMAIN_DEVICE_FS) {\n        fs = dev->data.fs;\n        pos = virDomainFSIndexByName(vmdef, fs->dst);\n\n        if (pos < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"target %s doesn't exist.\"), fs->dst);\n            return -1;\n        }\n        cur = vmdef->fss[pos];\n\n        /* We only allow updating the quota */\n        if (STRNEQ(cur->src->path, fs->src->path)\n            || cur->type != fs->type\n            || cur->accessmode != fs->accessmode\n            || cur->wrpolicy != fs->wrpolicy\n            || cur->readonly != fs->readonly) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Can only modify disk quota\"));\n            return -1;\n        }\n\n        if (openvzSetDiskQuota(vmdef, fs, persist) < 0)\n            return -1;\n        cur->space_hard_limit = fs->space_hard_limit;\n        cur->space_soft_limit = fs->space_soft_limit;\n    } else {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Can't modify device type '%s'\"),\n                       virDomainDeviceTypeToString(dev->type));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzUpdateDevice(virDomainDefPtr vmdef,\n                   virDomainDeviceDefPtr dev,\n                   bool persist)\n{\n    virDomainFSDefPtr fs, cur;\n    int pos;\n\n    if (dev->type == VIR_DOMAIN_DEVICE_FS) {\n        fs = dev->data.fs;\n        pos = virDomainFSIndexByName(vmdef, fs->dst);\n\n        if (pos < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"target %s doesn't exist.\"), fs->dst);\n            return -1;\n        }\n        cur = vmdef->fss[pos];\n\n        /* We only allow updating the quota */\n        if (STRNEQ(cur->src->path, fs->src->path)\n            || cur->type != fs->type\n            || cur->accessmode != fs->accessmode\n            || cur->wrpolicy != fs->wrpolicy\n            || cur->readonly != fs->readonly) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Can only modify disk quota\"));\n            return -1;\n        }\n\n        if (openvzSetDiskQuota(vmdef, fs, persist) < 0)\n            return -1;\n        cur->space_hard_limit = fs->space_hard_limit;\n        cur->space_soft_limit = fs->space_soft_limit;\n    } else {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Can't modify device type '%s'\"),\n                       virDomainDeviceTypeToString(dev->type));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefParse",
          "args": [
            "xml",
            "def",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_DEF_PARSE_INACTIVE"
          ],
          "line": 1904
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "16792-16961",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetOneDef",
          "args": [
            "vm",
            "flags"
          ],
          "line": 1901
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetOneDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3926-3931",
          "snippet": "virDomainDefPtr\nvirDomainObjGetOneDef(virDomainObjPtr vm,\n                      unsigned int flags)\n{\n    return virDomainObjGetOneDefState(vm, flags, NULL);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainObjGetOneDef(virDomainObjPtr vm,\n                      unsigned int flags)\n{\n    return virDomainObjGetOneDefState(vm, flags, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not convert domain name to VEID\")"
          ],
          "line": 1896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not convert domain name to VEID\""
          ],
          "line": 1897
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "vm->def->name",
            "NULL",
            "10",
            "&veid"
          ],
          "line": 1895
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomainLocked",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 1892
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomainLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "81-97",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomainLocked(struct openvz_driver *driver,\n                             const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(vm = virDomainObjListFindByUUID(driver->domains, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomainLocked(struct openvz_driver *driver,\n                             const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(vm = virDomainObjListFindByUUID(driver->domains, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 1891
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_DEVICE_MODIFY_LIVE |\n                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG",
            "-1"
          ],
          "line": 1888
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int\nopenvzDomainUpdateDeviceFlags(virDomainPtr dom, const char *xml,\n                              unsigned int flags)\n{\n    int ret = -1;\n    int veid;\n    struct  openvz_driver *driver = dom->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    bool persist = false;\n\n    virCheckFlags(VIR_DOMAIN_DEVICE_MODIFY_LIVE |\n                  VIR_DOMAIN_DEVICE_MODIFY_CONFIG, -1);\n\n    openvzDriverLock(driver);\n    if (!(vm = openvzDomObjFromDomainLocked(driver, dom->uuid)))\n        goto cleanup;\n\n    if (virStrToLong_i(vm->def->name, NULL, 10, &veid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not convert domain name to VEID\"));\n        goto cleanup;\n    }\n\n    if (!(def = virDomainObjGetOneDef(vm, flags)))\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, def, driver->xmlopt, NULL,\n                                  VIR_DOMAIN_DEF_PARSE_INACTIVE);\n    if (!dev)\n        goto cleanup;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG)\n        persist = true;\n\n    if (openvzUpdateDevice(def, dev, persist) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    openvzDriverUnlock(driver);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzUpdateDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1831-1873",
    "snippet": "static int\nopenvzUpdateDevice(virDomainDefPtr vmdef,\n                   virDomainDeviceDefPtr dev,\n                   bool persist)\n{\n    virDomainFSDefPtr fs, cur;\n    int pos;\n\n    if (dev->type == VIR_DOMAIN_DEVICE_FS) {\n        fs = dev->data.fs;\n        pos = virDomainFSIndexByName(vmdef, fs->dst);\n\n        if (pos < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"target %s doesn't exist.\"), fs->dst);\n            return -1;\n        }\n        cur = vmdef->fss[pos];\n\n        /* We only allow updating the quota */\n        if (STRNEQ(cur->src->path, fs->src->path)\n            || cur->type != fs->type\n            || cur->accessmode != fs->accessmode\n            || cur->wrpolicy != fs->wrpolicy\n            || cur->readonly != fs->readonly) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Can only modify disk quota\"));\n            return -1;\n        }\n\n        if (openvzSetDiskQuota(vmdef, fs, persist) < 0)\n            return -1;\n        cur->space_hard_limit = fs->space_hard_limit;\n        cur->space_soft_limit = fs->space_soft_limit;\n    } else {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Can't modify device type '%s'\"),\n                       virDomainDeviceTypeToString(dev->type));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Can't modify device type '%s'\")",
            "virDomainDeviceTypeToString(dev->type)"
          ],
          "line": 1866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDeviceTypeToString",
          "args": [
            "dev->type"
          ],
          "line": 1868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Can't modify device type '%s'\""
          ],
          "line": 1867
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetDiskQuota",
          "args": [
            "vmdef",
            "fs",
            "persist"
          ],
          "line": 1861
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetDiskQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "204-245",
          "snippet": "static int\nopenvzSetDiskQuota(virDomainDefPtr vmdef,\n                   virDomainFSDefPtr fss,\n                   bool persist)\n{\n    int ret = -1;\n    unsigned long long sl, hl;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"set\",\n                                             vmdef->name,\n                                             NULL);\n    if (persist)\n        virCommandAddArg(cmd, \"--save\");\n\n    if (fss->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        if (fss->space_hard_limit) {\n            hl = VIR_DIV_UP(fss->space_hard_limit, 1024);\n            virCommandAddArg(cmd, \"--diskspace\");\n\n            if (fss->space_soft_limit) {\n                sl = VIR_DIV_UP(fss->space_soft_limit, 1024);\n                virCommandAddArgFormat(cmd, \"%lld:%lld\", sl, hl);\n            } else {\n                virCommandAddArgFormat(cmd, \"%lld\", hl);\n            }\n        } else if (fss->space_soft_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Can't set soft limit without hard limit\"));\n            goto cleanup;\n        }\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzSetDiskQuota(virDomainDefPtr vmdef,\n                   virDomainFSDefPtr fss,\n                   bool persist)\n{\n    int ret = -1;\n    unsigned long long sl, hl;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"set\",\n                                             vmdef->name,\n                                             NULL);\n    if (persist)\n        virCommandAddArg(cmd, \"--save\");\n\n    if (fss->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        if (fss->space_hard_limit) {\n            hl = VIR_DIV_UP(fss->space_hard_limit, 1024);\n            virCommandAddArg(cmd, \"--diskspace\");\n\n            if (fss->space_soft_limit) {\n                sl = VIR_DIV_UP(fss->space_soft_limit, 1024);\n                virCommandAddArgFormat(cmd, \"%lld:%lld\", sl, hl);\n            } else {\n                virCommandAddArgFormat(cmd, \"%lld\", hl);\n            }\n        } else if (fss->space_soft_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Can't set soft limit without hard limit\"));\n            goto cleanup;\n        }\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Can only modify disk quota\")"
          ],
          "line": 1856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "cur->src->path",
            "fs->src->path"
          ],
          "line": 1851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"target %s doesn't exist.\")",
            "fs->dst"
          ],
          "line": 1844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainFSIndexByName",
          "args": [
            "vmdef",
            "fs->dst"
          ],
          "line": 1841
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainFSIndexByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "25372-25384",
          "snippet": "int\nvirDomainFSIndexByName(virDomainDefPtr def, const char *name)\n{\n    virDomainFSDefPtr fs;\n    size_t i;\n\n    for (i = 0; i < def->nfss; i++) {\n        fs = def->fss[i];\n        if (STREQ(fs->dst, name))\n            return i;\n    }\n    return -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainFSIndexByName(virDomainDefPtr def, const char *name)\n{\n    virDomainFSDefPtr fs;\n    size_t i;\n\n    for (i = 0; i < def->nfss; i++) {\n        fs = def->fss[i];\n        if (STREQ(fs->dst, name))\n            return i;\n    }\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzUpdateDevice(virDomainDefPtr vmdef,\n                   virDomainDeviceDefPtr dev,\n                   bool persist)\n{\n    virDomainFSDefPtr fs, cur;\n    int pos;\n\n    if (dev->type == VIR_DOMAIN_DEVICE_FS) {\n        fs = dev->data.fs;\n        pos = virDomainFSIndexByName(vmdef, fs->dst);\n\n        if (pos < 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"target %s doesn't exist.\"), fs->dst);\n            return -1;\n        }\n        cur = vmdef->fss[pos];\n\n        /* We only allow updating the quota */\n        if (STRNEQ(cur->src->path, fs->src->path)\n            || cur->type != fs->type\n            || cur->accessmode != fs->accessmode\n            || cur->wrpolicy != fs->wrpolicy\n            || cur->readonly != fs->readonly) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Can only modify disk quota\"));\n            return -1;\n        }\n\n        if (openvzSetDiskQuota(vmdef, fs, persist) < 0)\n            return -1;\n        cur->space_hard_limit = fs->space_hard_limit;\n        cur->space_soft_limit = fs->space_soft_limit;\n    } else {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Can't modify device type '%s'\"),\n                       virDomainDeviceTypeToString(dev->type));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzDomainInterfaceStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1800-1828",
    "snippet": "static int\nopenvzDomainInterfaceStats(virDomainPtr dom,\n                           const char *device,\n                           virDomainInterfaceStatsPtr stats)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virDomainNetDefPtr net = NULL;\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (!(net = virDomainNetFind(vm->def, device)))\n        goto cleanup;\n\n    if (virNetDevTapInterfaceStats(net->ifname, stats,\n                                   !virDomainNetTypeSharesHostView(net)) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1826
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevTapInterfaceStats",
          "args": [
            "net->ifname",
            "stats",
            "!virDomainNetTypeSharesHostView(net)"
          ],
          "line": 1819
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevTapInterfaceStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevtap.c",
          "lines": "906-914",
          "snippet": "int\nvirNetDevTapInterfaceStats(const char *ifname G_GNUC_UNUSED,\n                           virDomainInterfaceStatsPtr stats G_GNUC_UNUSED,\n                           bool swapped G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                   _(\"interface stats not implemented on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <ifaddrs.h>",
            "# include <sys/sysctl.h>",
            "# include <net/if_mib.h>",
            "# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */",
            "#include <fcntl.h>",
            "# include <net/if.h>",
            "# include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <ifaddrs.h>\n# include <sys/sysctl.h>\n# include <net/if_mib.h>\n# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */\n#include <fcntl.h>\n# include <net/if.h>\n# include <sys/ioctl.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevtap.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirNetDevTapInterfaceStats(const char *ifname G_GNUC_UNUSED,\n                           virDomainInterfaceStatsPtr stats G_GNUC_UNUSED,\n                           bool swapped G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                   _(\"interface stats not implemented on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetTypeSharesHostView",
          "args": [
            "net"
          ],
          "line": 1820
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetTypeSharesHostView",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "31122-31144",
          "snippet": "bool\nvirDomainNetTypeSharesHostView(const virDomainNetDef *net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainNetTypeSharesHostView(const virDomainNetDef *net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetFind",
          "args": [
            "vm->def",
            "device"
          ],
          "line": 1816
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30458-30470",
          "snippet": "virDomainNetDefPtr\nvirDomainNetFindByName(virDomainDefPtr def,\n                       const char *ifname)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (STREQ_NULLABLE(ifname, def->nets[i]->ifname))\n            return def->nets[i];\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetDefPtr\nvirDomainNetFindByName(virDomainDefPtr def,\n                       const char *ifname)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (STREQ_NULLABLE(ifname, def->nets[i]->ifname))\n            return def->nets[i];\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 1810
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainInterfaceStats(virDomainPtr dom,\n                           const char *device,\n                           virDomainInterfaceStatsPtr stats)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virDomainNetDefPtr net = NULL;\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (!(net = virDomainNetFind(vm->def, device)))\n        goto cleanup;\n\n    if (virNetDevTapInterfaceStats(net->ifname, stats,\n                                   !virDomainNetTypeSharesHostView(net)) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzGetVEStatus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1758-1798",
    "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "outbuf"
          ],
          "line": 1796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 1795
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "outbuf",
            "\"running\""
          ],
          "line": 1781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "reason"
          ],
          "line": 1779
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to parse vzlist output\")"
          ],
          "line": 1773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse vzlist output\""
          ],
          "line": 1774
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "outbuf",
            "'\\n'"
          ],
          "line": 1772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "&outbuf"
          ],
          "line": 1768
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZLIST",
            "vm->def->name",
            "\"-ostatus\"",
            "\"-H\"",
            "NULL"
          ],
          "line": 1767
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainSetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1702-1755",
    "snippet": "static int\nopenvzDomainSetMemoryParameters(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    size_t i;\n    long kb_per_pages;\n\n    kb_per_pages = openvzKBPerPages();\n    if (kb_per_pages < 0)\n        return -1;\n\n    virCheckFlags(0, -1);\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_MEMORY_HARD_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_MEMORY_SOFT_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_MEMORY_MIN_GUARANTEE,\n                               VIR_TYPED_PARAM_ULLONG,\n                               NULL) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n        unsigned long long barrier, limit;\n\n        if (STREQ(param->field, VIR_DOMAIN_MEMORY_HARD_LIMIT)) {\n            if (openvzDomainGetBarrierLimit(domain, \"privvmpages\",\n                                            &barrier, &limit) < 0)\n                return -1;\n            limit = params[i].value.ul / kb_per_pages;\n            if (openvzDomainSetBarrierLimit(domain, \"privvmpages\",\n                                            barrier, limit) < 0)\n                return -1;\n        } else if (STREQ(param->field, VIR_DOMAIN_MEMORY_SOFT_LIMIT)) {\n            if (openvzDomainGetBarrierLimit(domain, \"privvmpages\",\n                                            &barrier, &limit) < 0)\n                return -1;\n            barrier = params[i].value.ul / kb_per_pages;\n            if (openvzDomainSetBarrierLimit(domain, \"privvmpages\",\n                                            barrier, limit) < 0)\n                return -1;\n        } else if (STREQ(param->field, VIR_DOMAIN_MEMORY_MIN_GUARANTEE)) {\n            barrier = params[i].value.ul / kb_per_pages;\n            if (openvzDomainSetBarrierLimit(domain, \"vmguarpages\",\n                                            barrier, LONG_MAX) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainSetBarrierLimit",
          "args": [
            "domain",
            "\"vmguarpages\"",
            "barrier",
            "LONG_MAX"
          ],
          "line": 1748
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetBarrierLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1603-1631",
          "snippet": "static int\nopenvzDomainSetBarrierLimit(virDomainPtr domain,\n                            const  char *param,\n                            unsigned long long barrier,\n                            unsigned long long limit)\n{\n    int ret = -1;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL, \"--quiet\", \"set\", NULL);\n\n    /* LONG_MAX indicates unlimited so reject larger values */\n    if (barrier > LONG_MAX || limit > LONG_MAX) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to set %s for %s: value too large\"), param,\n                       domain->name);\n        goto cleanup;\n    }\n\n    virCommandAddArg(cmd, domain->name);\n    virCommandAddArgFormat(cmd, \"--%s\", param);\n    virCommandAddArgFormat(cmd, \"%llu:%llu\", barrier, limit);\n    virCommandAddArg(cmd, \"--save\");\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzDomainSetBarrierLimit(virDomainPtr domain,\n                            const  char *param,\n                            unsigned long long barrier,\n                            unsigned long long limit)\n{\n    int ret = -1;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL, \"--quiet\", \"set\", NULL);\n\n    /* LONG_MAX indicates unlimited so reject larger values */\n    if (barrier > LONG_MAX || limit > LONG_MAX) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to set %s for %s: value too large\"), param,\n                       domain->name);\n        goto cleanup;\n    }\n\n    virCommandAddArg(cmd, domain->name);\n    virCommandAddArgFormat(cmd, \"--%s\", param);\n    virCommandAddArgFormat(cmd, \"%llu:%llu\", barrier, limit);\n    virCommandAddArg(cmd, \"--save\");\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_MEMORY_MIN_GUARANTEE"
          ],
          "line": 1746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzDomainGetBarrierLimit",
          "args": [
            "domain",
            "\"privvmpages\"",
            "&barrier",
            "&limit"
          ],
          "line": 1739
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainGetBarrierLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1563-1600",
          "snippet": "static int\nopenvzDomainGetBarrierLimit(virDomainPtr domain,\n                            const char *param,\n                            unsigned long long *barrier,\n                            unsigned long long *limit)\n{\n    int ret = -1;\n    char *endp, *output = NULL;\n    const char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST, \"--no-header\", NULL);\n\n    virCommandSetOutputBuffer(cmd, &output);\n    virCommandAddArgFormat(cmd, \"-o%s.b,%s.l\", param, param);\n    virCommandAddArg(cmd, domain->name);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = output;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, barrier) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse limit from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n    tmp = endp;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, limit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse barrier from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(output);\n    virCommandFree(cmd);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzDomainGetBarrierLimit(virDomainPtr domain,\n                            const char *param,\n                            unsigned long long *barrier,\n                            unsigned long long *limit)\n{\n    int ret = -1;\n    char *endp, *output = NULL;\n    const char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST, \"--no-header\", NULL);\n\n    virCommandSetOutputBuffer(cmd, &output);\n    virCommandAddArgFormat(cmd, \"-o%s.b,%s.l\", param, param);\n    virCommandAddArg(cmd, domain->name);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = output;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, barrier) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse limit from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n    tmp = endp;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, limit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse barrier from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(output);\n    virCommandFree(cmd);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_MEMORY_SOFT_LIMIT"
          ],
          "line": 1738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_MEMORY_HARD_LIMIT"
          ],
          "line": 1730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VIR_DOMAIN_MEMORY_HARD_LIMIT",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_DOMAIN_MEMORY_SOFT_LIMIT",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_DOMAIN_MEMORY_MIN_GUARANTEE",
            "VIR_TYPED_PARAM_ULLONG",
            "NULL"
          ],
          "line": 1716
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzKBPerPages",
          "args": [],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "openvzKBPerPages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_util.c",
          "lines": "41-55",
          "snippet": "long\nopenvzKBPerPages(void)\n{\n    static long kb_per_pages;\n\n    if (kb_per_pages == 0) {\n        if ((kb_per_pages = virGetSystemPageSizeKB()) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Can't determine page size\"));\n            kb_per_pages = 0;\n            return -1;\n        }\n    }\n    return kb_per_pages;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <config.h>\n\nlong\nopenvzKBPerPages(void)\n{\n    static long kb_per_pages;\n\n    if (kb_per_pages == 0) {\n        if ((kb_per_pages = virGetSystemPageSizeKB()) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Can't determine page size\"));\n            kb_per_pages = 0;\n            return -1;\n        }\n    }\n    return kb_per_pages;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzDomainSetMemoryParameters(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    size_t i;\n    long kb_per_pages;\n\n    kb_per_pages = openvzKBPerPages();\n    if (kb_per_pages < 0)\n        return -1;\n\n    virCheckFlags(0, -1);\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_MEMORY_HARD_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_MEMORY_SOFT_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_MEMORY_MIN_GUARANTEE,\n                               VIR_TYPED_PARAM_ULLONG,\n                               NULL) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n        unsigned long long barrier, limit;\n\n        if (STREQ(param->field, VIR_DOMAIN_MEMORY_HARD_LIMIT)) {\n            if (openvzDomainGetBarrierLimit(domain, \"privvmpages\",\n                                            &barrier, &limit) < 0)\n                return -1;\n            limit = params[i].value.ul / kb_per_pages;\n            if (openvzDomainSetBarrierLimit(domain, \"privvmpages\",\n                                            barrier, limit) < 0)\n                return -1;\n        } else if (STREQ(param->field, VIR_DOMAIN_MEMORY_SOFT_LIMIT)) {\n            if (openvzDomainGetBarrierLimit(domain, \"privvmpages\",\n                                            &barrier, &limit) < 0)\n                return -1;\n            barrier = params[i].value.ul / kb_per_pages;\n            if (openvzDomainSetBarrierLimit(domain, \"privvmpages\",\n                                            barrier, limit) < 0)\n                return -1;\n        } else if (STREQ(param->field, VIR_DOMAIN_MEMORY_MIN_GUARANTEE)) {\n            barrier = params[i].value.ul / kb_per_pages;\n            if (openvzDomainSetBarrierLimit(domain, \"vmguarpages\",\n                                            barrier, LONG_MAX) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzDomainGetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1634-1699",
    "snippet": "static int\nopenvzDomainGetMemoryParameters(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int *nparams,\n                                unsigned int flags)\n{\n    size_t i;\n    const char *name;\n    long kb_per_pages;\n    unsigned long long barrier, limit, val;\n\n    virCheckFlags(0, -1);\n\n    kb_per_pages = openvzKBPerPages();\n    if (kb_per_pages < 0)\n        return -1;\n\n    if (*nparams == 0) {\n        *nparams = OPENVZ_NB_MEM_PARAM;\n        return 0;\n    }\n\n    for (i = 0; i <= *nparams; i++) {\n        virMemoryParameterPtr param = &params[i];\n\n        switch (i) {\n        case 0:\n            name = \"privvmpages\";\n            if (openvzDomainGetBarrierLimit(domain, name, &barrier, &limit) < 0)\n                return -1;\n\n            val = (limit == LONG_MAX) ? VIR_DOMAIN_MEMORY_PARAM_UNLIMITED : limit * kb_per_pages;\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_HARD_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                return -1;\n            break;\n\n        case 1:\n            name = \"privvmpages\";\n            if (openvzDomainGetBarrierLimit(domain, name, &barrier, &limit) < 0)\n                return -1;\n\n            val = (barrier == LONG_MAX) ? VIR_DOMAIN_MEMORY_PARAM_UNLIMITED : barrier * kb_per_pages;\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_SOFT_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                return -1;\n            break;\n\n        case 2:\n            name = \"vmguarpages\";\n            if (openvzDomainGetBarrierLimit(domain, name, &barrier, &limit) < 0)\n                return -1;\n\n            val = (barrier == LONG_MAX) ? 0ull : barrier * kb_per_pages;\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_MIN_GUARANTEE,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                return -1;\n            break;\n        }\n    }\n\n    if (*nparams > OPENVZ_NB_MEM_PARAM)\n        *nparams = OPENVZ_NB_MEM_PARAM;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define OPENVZ_NB_MEM_PARAM 3"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "param",
            "VIR_DOMAIN_MEMORY_MIN_GUARANTEE",
            "VIR_TYPED_PARAM_ULLONG",
            "val"
          ],
          "line": 1688
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "276-294",
          "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomainGetBarrierLimit",
          "args": [
            "domain",
            "name",
            "&barrier",
            "&limit"
          ],
          "line": 1684
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainGetBarrierLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1563-1600",
          "snippet": "static int\nopenvzDomainGetBarrierLimit(virDomainPtr domain,\n                            const char *param,\n                            unsigned long long *barrier,\n                            unsigned long long *limit)\n{\n    int ret = -1;\n    char *endp, *output = NULL;\n    const char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST, \"--no-header\", NULL);\n\n    virCommandSetOutputBuffer(cmd, &output);\n    virCommandAddArgFormat(cmd, \"-o%s.b,%s.l\", param, param);\n    virCommandAddArg(cmd, domain->name);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = output;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, barrier) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse limit from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n    tmp = endp;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, limit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse barrier from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(output);\n    virCommandFree(cmd);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzDomainGetBarrierLimit(virDomainPtr domain,\n                            const char *param,\n                            unsigned long long *barrier,\n                            unsigned long long *limit)\n{\n    int ret = -1;\n    char *endp, *output = NULL;\n    const char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST, \"--no-header\", NULL);\n\n    virCommandSetOutputBuffer(cmd, &output);\n    virCommandAddArgFormat(cmd, \"-o%s.b,%s.l\", param, param);\n    virCommandAddArg(cmd, domain->name);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = output;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, barrier) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse limit from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n    tmp = endp;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, limit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse barrier from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(output);\n    virCommandFree(cmd);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzKBPerPages",
          "args": [],
          "line": 1647
        },
        "resolved": true,
        "details": {
          "function_name": "openvzKBPerPages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_util.c",
          "lines": "41-55",
          "snippet": "long\nopenvzKBPerPages(void)\n{\n    static long kb_per_pages;\n\n    if (kb_per_pages == 0) {\n        if ((kb_per_pages = virGetSystemPageSizeKB()) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Can't determine page size\"));\n            kb_per_pages = 0;\n            return -1;\n        }\n    }\n    return kb_per_pages;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <config.h>\n\nlong\nopenvzKBPerPages(void)\n{\n    static long kb_per_pages;\n\n    if (kb_per_pages == 0) {\n        if ((kb_per_pages = virGetSystemPageSizeKB()) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Can't determine page size\"));\n            kb_per_pages = 0;\n            return -1;\n        }\n    }\n    return kb_per_pages;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1645
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define OPENVZ_NB_MEM_PARAM 3\n\nstatic int\nopenvzDomainGetMemoryParameters(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int *nparams,\n                                unsigned int flags)\n{\n    size_t i;\n    const char *name;\n    long kb_per_pages;\n    unsigned long long barrier, limit, val;\n\n    virCheckFlags(0, -1);\n\n    kb_per_pages = openvzKBPerPages();\n    if (kb_per_pages < 0)\n        return -1;\n\n    if (*nparams == 0) {\n        *nparams = OPENVZ_NB_MEM_PARAM;\n        return 0;\n    }\n\n    for (i = 0; i <= *nparams; i++) {\n        virMemoryParameterPtr param = &params[i];\n\n        switch (i) {\n        case 0:\n            name = \"privvmpages\";\n            if (openvzDomainGetBarrierLimit(domain, name, &barrier, &limit) < 0)\n                return -1;\n\n            val = (limit == LONG_MAX) ? VIR_DOMAIN_MEMORY_PARAM_UNLIMITED : limit * kb_per_pages;\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_HARD_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                return -1;\n            break;\n\n        case 1:\n            name = \"privvmpages\";\n            if (openvzDomainGetBarrierLimit(domain, name, &barrier, &limit) < 0)\n                return -1;\n\n            val = (barrier == LONG_MAX) ? VIR_DOMAIN_MEMORY_PARAM_UNLIMITED : barrier * kb_per_pages;\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_SOFT_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                return -1;\n            break;\n\n        case 2:\n            name = \"vmguarpages\";\n            if (openvzDomainGetBarrierLimit(domain, name, &barrier, &limit) < 0)\n                return -1;\n\n            val = (barrier == LONG_MAX) ? 0ull : barrier * kb_per_pages;\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_MIN_GUARANTEE,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                return -1;\n            break;\n        }\n    }\n\n    if (*nparams > OPENVZ_NB_MEM_PARAM)\n        *nparams = OPENVZ_NB_MEM_PARAM;\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzDomainSetBarrierLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1603-1631",
    "snippet": "static int\nopenvzDomainSetBarrierLimit(virDomainPtr domain,\n                            const  char *param,\n                            unsigned long long barrier,\n                            unsigned long long limit)\n{\n    int ret = -1;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL, \"--quiet\", \"set\", NULL);\n\n    /* LONG_MAX indicates unlimited so reject larger values */\n    if (barrier > LONG_MAX || limit > LONG_MAX) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to set %s for %s: value too large\"), param,\n                       domain->name);\n        goto cleanup;\n    }\n\n    virCommandAddArg(cmd, domain->name);\n    virCommandAddArgFormat(cmd, \"--%s\", param);\n    virCommandAddArgFormat(cmd, \"%llu:%llu\", barrier, limit);\n    virCommandAddArg(cmd, \"--save\");\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 1629
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1624
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArg",
          "args": [
            "cmd",
            "\"--save\""
          ],
          "line": 1623
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1655-1684",
          "snippet": "void\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArgFormat",
          "args": [
            "cmd",
            "\"%llu:%llu\"",
            "barrier",
            "limit"
          ],
          "line": 1622
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1569-1590",
          "snippet": "void\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"Failed to set %s for %s: value too large\")",
            "param",
            "domain->name"
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to set %s for %s: value too large\""
          ],
          "line": 1615
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZCTL",
            "\"--quiet\"",
            "\"set\"",
            "NULL"
          ],
          "line": 1610
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzDomainSetBarrierLimit(virDomainPtr domain,\n                            const  char *param,\n                            unsigned long long barrier,\n                            unsigned long long limit)\n{\n    int ret = -1;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL, \"--quiet\", \"set\", NULL);\n\n    /* LONG_MAX indicates unlimited so reject larger values */\n    if (barrier > LONG_MAX || limit > LONG_MAX) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Failed to set %s for %s: value too large\"), param,\n                       domain->name);\n        goto cleanup;\n    }\n\n    virCommandAddArg(cmd, domain->name);\n    virCommandAddArgFormat(cmd, \"--%s\", param);\n    virCommandAddArgFormat(cmd, \"%llu:%llu\", barrier, limit);\n    virCommandAddArg(cmd, \"--save\");\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainGetBarrierLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1563-1600",
    "snippet": "static int\nopenvzDomainGetBarrierLimit(virDomainPtr domain,\n                            const char *param,\n                            unsigned long long *barrier,\n                            unsigned long long *limit)\n{\n    int ret = -1;\n    char *endp, *output = NULL;\n    const char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST, \"--no-header\", NULL);\n\n    virCommandSetOutputBuffer(cmd, &output);\n    virCommandAddArgFormat(cmd, \"-o%s.b,%s.l\", param, param);\n    virCommandAddArg(cmd, domain->name);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = output;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, barrier) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse limit from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n    tmp = endp;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, limit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse barrier from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(output);\n    virCommandFree(cmd);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 1598
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "output"
          ],
          "line": 1597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Can't parse barrier from vzlist output '%s'\")",
            "output"
          ],
          "line": 1590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Can't parse barrier from vzlist output '%s'\""
          ],
          "line": 1591
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "tmp",
            "&endp",
            "10",
            "limit"
          ],
          "line": 1589
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&tmp"
          ],
          "line": 1588
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Can't parse limit from vzlist output '%s'\")",
            "output"
          ],
          "line": 1583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1577
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArg",
          "args": [
            "cmd",
            "domain->name"
          ],
          "line": 1576
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1655-1684",
          "snippet": "void\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArgFormat",
          "args": [
            "cmd",
            "\"-o%s.b,%s.l\"",
            "param",
            "param"
          ],
          "line": 1575
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1569-1590",
          "snippet": "void\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "&output"
          ],
          "line": 1574
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZLIST",
            "\"--no-header\"",
            "NULL"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzDomainGetBarrierLimit(virDomainPtr domain,\n                            const char *param,\n                            unsigned long long *barrier,\n                            unsigned long long *limit)\n{\n    int ret = -1;\n    char *endp, *output = NULL;\n    const char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST, \"--no-header\", NULL);\n\n    virCommandSetOutputBuffer(cmd, &output);\n    virCommandAddArgFormat(cmd, \"-o%s.b,%s.l\", param, param);\n    virCommandAddArg(cmd, domain->name);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = output;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, barrier) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse limit from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n    tmp = endp;\n    virSkipSpaces(&tmp);\n    if (virStrToLong_ull(tmp, &endp, 10, limit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Can't parse barrier from vzlist output '%s'\"), output);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(output);\n    virCommandFree(cmd);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainSetMemoryInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1543-1560",
    "snippet": "static int\nopenvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                              unsigned long long mem)\n{\n    char str_mem[16];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n        \"--kmemsize\", str_mem, \"--save\", NULL\n    };\n\n    /* memory has to be changed its format from kbyte to byte */\n    g_snprintf(str_mem, sizeof(str_mem), \"%llu\", mem * 1024);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 1556
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 1555
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "str_mem",
            "sizeof(str_mem)",
            "\"%llu\"",
            "mem * 1024"
          ],
          "line": 1553
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);\n\nstatic int\nopenvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                              unsigned long long mem)\n{\n    char str_mem[16];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n        \"--kmemsize\", str_mem, \"--save\", NULL\n    };\n\n    /* memory has to be changed its format from kbyte to byte */\n    g_snprintf(str_mem, sizeof(str_mem), \"%llu\", mem * 1024);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzConnectNumOfDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1531-1541",
    "snippet": "static int openvzConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    struct openvz_driver *driver =  conn->privateData;\n    int n;\n\n    openvzDriverLock(driver);\n    n = virDomainObjListNumOfDomains(driver->domains, false, NULL, NULL);\n    openvzDriverUnlock(driver);\n\n    return n;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1538
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListNumOfDomains",
          "args": [
            "driver->domains",
            "false",
            "NULL",
            "NULL"
          ],
          "line": 1537
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNumOfDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "674-685",
          "snippet": "int\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 1536
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    struct openvz_driver *driver =  conn->privateData;\n    int n;\n\n    openvzDriverLock(driver);\n    n = virDomainObjListNumOfDomains(driver->domains, false, NULL, NULL);\n    openvzDriverUnlock(driver);\n\n    return n;\n}"
  },
  {
    "function_name": "openvzGetProcessInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1480-1529",
    "snippet": "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid)\n{\n    FILE *fp;\n    char *line = NULL;\n    size_t line_size = 0;\n    unsigned long long usertime, systime, nicetime;\n    int readvps = vpsid + 1;  /* ensure readvps is initially different */\n    ssize_t ret;\n    int err = 0;\n\n/* read statistic from /proc/vz/vestat.\n sample:\nVersion: 2.2\n   VEID     user      nice     system     uptime                 idle   other..\n     33       78         0       1330   59454597      142650441835148   other..\n     55      178         0       5340   59424597      542650441835148   other..\n*/\n\n    if ((fp = fopen(\"/proc/vz/vestat\", \"r\")) == NULL)\n        return -1;\n\n    /* search line with VEID=vpsid */\n    while (1) {\n        ret = getline(&line, &line_size, fp);\n        if (ret < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (sscanf(line, \"%d %llu %llu %llu\",\n                   &readvps, &usertime, &nicetime, &systime) == 4\n            && readvps == vpsid) { /* found vpsid */\n            /* convert jiffies to nanoseconds */\n            *cpuTime = (1000ull * 1000ull * 1000ull\n                        * (usertime + nicetime  + systime)\n                        / (unsigned long long)sysconf(_SC_CLK_TCK));\n            break;\n        }\n    }\n\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    if (err)\n        return -1;\n\n    if (readvps != vpsid) /*not found*/\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 1521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "line"
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_CLK_TCK"
          ],
          "line": 1515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "line",
            "\"%d %llu %llu %llu\"",
            "&readvps",
            "&usertime",
            "&nicetime",
            "&systime"
          ],
          "line": 1509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feof",
          "args": [
            "fp"
          ],
          "line": 1505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "&line",
            "&line_size",
            "fp"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "\"/proc/vz/vestat\"",
            "\"r\""
          ],
          "line": 1498
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid)\n{\n    FILE *fp;\n    char *line = NULL;\n    size_t line_size = 0;\n    unsigned long long usertime, systime, nicetime;\n    int readvps = vpsid + 1;  /* ensure readvps is initially different */\n    ssize_t ret;\n    int err = 0;\n\n/* read statistic from /proc/vz/vestat.\n sample:\nVersion: 2.2\n   VEID     user      nice     system     uptime                 idle   other..\n     33       78         0       1330   59454597      142650441835148   other..\n     55      178         0       5340   59424597      542650441835148   other..\n*/\n\n    if ((fp = fopen(\"/proc/vz/vestat\", \"r\")) == NULL)\n        return -1;\n\n    /* search line with VEID=vpsid */\n    while (1) {\n        ret = getline(&line, &line_size, fp);\n        if (ret < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (sscanf(line, \"%d %llu %llu %llu\",\n                   &readvps, &usertime, &nicetime, &systime) == 4\n            && readvps == vpsid) { /* found vpsid */\n            /* convert jiffies to nanoseconds */\n            *cpuTime = (1000ull * 1000ull * 1000ull\n                        * (usertime + nicetime  + systime)\n                        / (unsigned long long)sysconf(_SC_CLK_TCK));\n            break;\n        }\n    }\n\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    if (err)\n        return -1;\n\n    if (readvps != vpsid) /*not found*/\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzConnectListDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1431-1478",
    "snippet": "static int openvzConnectListDefinedDomains(virConnectPtr conn G_GNUC_UNUSED,\n                                           char **const names, int nnames) {\n    int got = 0;\n    int veid, outfd = -1, ret;\n    int rc = -1;\n    char vpsname[32];\n    char buf[32];\n    char *endptr;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST,\n                                             \"-ovpsid\", \"-H\", \"-S\", NULL);\n\n    /* the -S options lists only stopped domains */\n    virCommandSetOutputFD(cmd, &outfd);\n    if (virCommandRunAsync(cmd, NULL) < 0)\n        goto out;\n\n    while (got < nnames) {\n        ret = openvz_readline(outfd, buf, 32);\n        if (!ret)\n            break;\n        if (virStrToLong_i(buf, &endptr, 10, &veid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse VPS ID %s\"), buf);\n            continue;\n        }\n        g_snprintf(vpsname, sizeof(vpsname), \"%d\", veid);\n        names[got] = g_strdup(vpsname);\n        got ++;\n    }\n\n    if (virCommandWait(cmd, NULL) < 0)\n        goto out;\n\n    if (VIR_CLOSE(outfd) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"failed to close file\"));\n        goto out;\n    }\n\n    rc = got;\n out:\n    VIR_FORCE_CLOSE(outfd);\n    virCommandFree(cmd);\n    if (rc < 0) {\n        for (; got >= 0; got--)\n            VIR_FREE(names[got]);\n    }\n    return rc;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "names[got]"
          ],
          "line": 1475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "outfd"
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"failed to close file\")"
          ],
          "line": 1465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to close file\""
          ],
          "line": 1465
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLOSE",
          "args": [
            "outfd"
          ],
          "line": 1464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandWait",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1461
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2940-2946",
          "snippet": "int\nvirCommandWait(virCommandPtr cmd G_GNUC_UNUSED, int *exitstatus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandWait(virCommandPtr cmd G_GNUC_UNUSED, int *exitstatus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "vpsname",
            "sizeof(vpsname)",
            "\"%d\"",
            "veid"
          ],
          "line": 1456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not parse VPS ID %s\")",
            "buf"
          ],
          "line": 1452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "buf",
            "&endptr",
            "10",
            "&veid"
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvz_readline",
          "args": [
            "outfd",
            "buf",
            "32"
          ],
          "line": 1448
        },
        "resolved": true,
        "details": {
          "function_name": "openvz_readline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "875-897",
          "snippet": "int\nopenvz_readline(int fd, char *ptr, int maxlen)\n{\n    int n, rc;\n    char c;\n\n    for (n = 1; n < maxlen; n++) {\n        if ((rc = read(fd, &c, 1)) == 1) {\n            *ptr++ = c;\n            if (c == '\\n')\n                break;\n        } else if (rc == 0) {\n            if (n == 1)\n                return 0; /* EOF condition */\n            else\n                break;\n        }\n        else\n            return -1; /* error */\n    }\n    *ptr = 0;\n    return n;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nopenvz_readline(int fd, char *ptr, int maxlen)\n{\n    int n, rc;\n    char c;\n\n    for (n = 1; n < maxlen; n++) {\n        if ((rc = read(fd, &c, 1)) == 1) {\n            *ptr++ = c;\n            if (c == '\\n')\n                break;\n        } else if (rc == 0) {\n            if (n == 1)\n                return 0; /* EOF condition */\n            else\n                break;\n        }\n        else\n            return -1; /* error */\n    }\n    *ptr = 0;\n    return n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRunAsync",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1444
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputFD",
          "args": [
            "cmd",
            "&outfd"
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1958-1971",
          "snippet": "void\nvirCommandSetOutputFD(virCommandPtr cmd, int *outfd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outfdptr = outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputFD(virCommandPtr cmd, int *outfd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outfdptr = outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZLIST",
            "\"-ovpsid\"",
            "\"-H\"",
            "\"-S\"",
            "NULL"
          ],
          "line": 1439
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectListDefinedDomains(virConnectPtr conn G_GNUC_UNUSED,\n                                           char **const names, int nnames) {\n    int got = 0;\n    int veid, outfd = -1, ret;\n    int rc = -1;\n    char vpsname[32];\n    char buf[32];\n    char *endptr;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST,\n                                             \"-ovpsid\", \"-H\", \"-S\", NULL);\n\n    /* the -S options lists only stopped domains */\n    virCommandSetOutputFD(cmd, &outfd);\n    if (virCommandRunAsync(cmd, NULL) < 0)\n        goto out;\n\n    while (got < nnames) {\n        ret = openvz_readline(outfd, buf, 32);\n        if (!ret)\n            break;\n        if (virStrToLong_i(buf, &endptr, 10, &veid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse VPS ID %s\"), buf);\n            continue;\n        }\n        g_snprintf(vpsname, sizeof(vpsname), \"%d\", veid);\n        names[got] = g_strdup(vpsname);\n        got ++;\n    }\n\n    if (virCommandWait(cmd, NULL) < 0)\n        goto out;\n\n    if (VIR_CLOSE(outfd) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"failed to close file\"));\n        goto out;\n    }\n\n    rc = got;\n out:\n    VIR_FORCE_CLOSE(outfd);\n    virCommandFree(cmd);\n    if (rc < 0) {\n        for (; got >= 0; got--)\n            VIR_FREE(names[got]);\n    }\n    return rc;\n}"
  },
  {
    "function_name": "openvzConnectNumOfDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1419-1429",
    "snippet": "static int openvzConnectNumOfDomains(virConnectPtr conn)\n{\n    struct openvz_driver *driver = conn->privateData;\n    int n;\n\n    openvzDriverLock(driver);\n    n = virDomainObjListNumOfDomains(driver->domains, true, NULL, NULL);\n    openvzDriverUnlock(driver);\n\n    return n;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1426
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListNumOfDomains",
          "args": [
            "driver->domains",
            "true",
            "NULL",
            "NULL"
          ],
          "line": 1425
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNumOfDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "674-685",
          "snippet": "int\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectNumOfDomains(virConnectPtr conn)\n{\n    struct openvz_driver *driver = conn->privateData;\n    int n;\n\n    openvzDriverLock(driver);\n    n = virDomainObjListNumOfDomains(driver->domains, true, NULL, NULL);\n    openvzDriverUnlock(driver);\n\n    return n;\n}"
  },
  {
    "function_name": "openvzConnectListDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1375-1417",
    "snippet": "static int openvzConnectListDomains(virConnectPtr conn G_GNUC_UNUSED,\n                                    int *ids, int nids)\n{\n    int got = 0;\n    int veid;\n    int outfd = -1;\n    int rc = -1;\n    int ret;\n    char buf[32];\n    char *endptr;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST, \"-ovpsid\", \"-H\", NULL);\n\n    virCommandSetOutputFD(cmd, &outfd);\n    if (virCommandRunAsync(cmd, NULL) < 0)\n        goto cleanup;\n\n    while (got < nids) {\n        ret = openvz_readline(outfd, buf, 32);\n        if (!ret)\n            break;\n        if (virStrToLong_i(buf, &endptr, 10, &veid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse VPS ID %s\"), buf);\n            continue;\n        }\n        ids[got] = veid;\n        got ++;\n    }\n\n    if (virCommandWait(cmd, NULL) < 0)\n        goto cleanup;\n\n    if (VIR_CLOSE(outfd) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"failed to close file\"));\n        goto cleanup;\n    }\n\n    rc = got;\n cleanup:\n    VIR_FORCE_CLOSE(outfd);\n    virCommandFree(cmd);\n    return rc;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 1415
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "outfd"
          ],
          "line": 1414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"failed to close file\")"
          ],
          "line": 1408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to close file\""
          ],
          "line": 1408
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLOSE",
          "args": [
            "outfd"
          ],
          "line": 1407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandWait",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1404
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2940-2946",
          "snippet": "int\nvirCommandWait(virCommandPtr cmd G_GNUC_UNUSED, int *exitstatus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandWait(virCommandPtr cmd G_GNUC_UNUSED, int *exitstatus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not parse VPS ID %s\")",
            "buf"
          ],
          "line": 1396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "buf",
            "&endptr",
            "10",
            "&veid"
          ],
          "line": 1395
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvz_readline",
          "args": [
            "outfd",
            "buf",
            "32"
          ],
          "line": 1392
        },
        "resolved": true,
        "details": {
          "function_name": "openvz_readline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "875-897",
          "snippet": "int\nopenvz_readline(int fd, char *ptr, int maxlen)\n{\n    int n, rc;\n    char c;\n\n    for (n = 1; n < maxlen; n++) {\n        if ((rc = read(fd, &c, 1)) == 1) {\n            *ptr++ = c;\n            if (c == '\\n')\n                break;\n        } else if (rc == 0) {\n            if (n == 1)\n                return 0; /* EOF condition */\n            else\n                break;\n        }\n        else\n            return -1; /* error */\n    }\n    *ptr = 0;\n    return n;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nopenvz_readline(int fd, char *ptr, int maxlen)\n{\n    int n, rc;\n    char c;\n\n    for (n = 1; n < maxlen; n++) {\n        if ((rc = read(fd, &c, 1)) == 1) {\n            *ptr++ = c;\n            if (c == '\\n')\n                break;\n        } else if (rc == 0) {\n            if (n == 1)\n                return 0; /* EOF condition */\n            else\n                break;\n        }\n        else\n            return -1; /* error */\n    }\n    *ptr = 0;\n    return n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRunAsync",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputFD",
          "args": [
            "cmd",
            "&outfd"
          ],
          "line": 1387
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1958-1971",
          "snippet": "void\nvirCommandSetOutputFD(virCommandPtr cmd, int *outfd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outfdptr = outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputFD(virCommandPtr cmd, int *outfd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outfdptr = outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZLIST",
            "\"-ovpsid\"",
            "\"-H\"",
            "NULL"
          ],
          "line": 1385
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectListDomains(virConnectPtr conn G_GNUC_UNUSED,\n                                    int *ids, int nids)\n{\n    int got = 0;\n    int veid;\n    int outfd = -1;\n    int rc = -1;\n    int ret;\n    char buf[32];\n    char *endptr;\n    virCommandPtr cmd = virCommandNewArgList(VZLIST, \"-ovpsid\", \"-H\", NULL);\n\n    virCommandSetOutputFD(cmd, &outfd);\n    if (virCommandRunAsync(cmd, NULL) < 0)\n        goto cleanup;\n\n    while (got < nids) {\n        ret = openvz_readline(outfd, buf, 32);\n        if (!ret)\n            break;\n        if (virStrToLong_i(buf, &endptr, 10, &veid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse VPS ID %s\"), buf);\n            continue;\n        }\n        ids[got] = veid;\n        got ++;\n    }\n\n    if (virCommandWait(cmd, NULL) < 0)\n        goto cleanup;\n\n    if (VIR_CLOSE(outfd) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"failed to close file\"));\n        goto cleanup;\n    }\n\n    rc = got;\n cleanup:\n    VIR_FORCE_CLOSE(outfd);\n    virCommandFree(cmd);\n    return rc;\n}"
  },
  {
    "function_name": "openvzConnectGetCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1364-1373",
    "snippet": "static char *openvzConnectGetCapabilities(virConnectPtr conn) {\n    struct openvz_driver *driver = conn->privateData;\n    char *ret;\n\n    openvzDriverLock(driver);\n    ret = virCapabilitiesFormatXML(driver->caps);\n    openvzDriverUnlock(driver);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1370
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesFormatXML",
          "args": [
            "driver->caps"
          ],
          "line": 1369
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesFormatXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1335-1358",
          "snippet": "char *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 1368
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *openvzConnectGetCapabilities(virConnectPtr conn) {\n    struct openvz_driver *driver = conn->privateData;\n    char *ret;\n\n    openvzDriverLock(driver);\n    ret = virCapabilitiesFormatXML(driver->caps);\n    openvzDriverUnlock(driver);\n\n    return ret;\n}"
  },
  {
    "function_name": "openvzConnectIsAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1358-1362",
    "snippet": "static int\nopenvzConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}"
  },
  {
    "function_name": "openvzConnectIsSecure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1352-1356",
    "snippet": "static int openvzConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* We run CLI tools directly so this is secure */\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* We run CLI tools directly so this is secure */\n    return 1;\n}"
  },
  {
    "function_name": "openvzConnectIsEncrypted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1346-1350",
    "snippet": "static int openvzConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Encryption is not relevant / applicable to way we talk to openvz */\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Encryption is not relevant / applicable to way we talk to openvz */\n    return 0;\n}"
  },
  {
    "function_name": "openvzConnectGetType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1342-1344",
    "snippet": "static const char *openvzConnectGetType(virConnectPtr conn G_GNUC_UNUSED) {\n    return \"OpenVZ\";\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic const char *openvzConnectGetType(virConnectPtr conn G_GNUC_UNUSED) {\n    return \"OpenVZ\";\n}"
  },
  {
    "function_name": "openvzConnectClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1332-1340",
    "snippet": "static int openvzConnectClose(virConnectPtr conn)\n{\n    struct openvz_driver *driver = conn->privateData;\n\n    openvzFreeDriver(driver);\n    conn->privateData = NULL;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzFreeDriver",
          "args": [
            "driver"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "openvzFreeDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "478-488",
          "snippet": "void\nopenvzFreeDriver(struct openvz_driver *driver)\n{\n    if (!driver)\n        return;\n\n    virObjectUnref(driver->xmlopt);\n    virObjectUnref(driver->domains);\n    virObjectUnref(driver->caps);\n    VIR_FREE(driver);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nopenvzFreeDriver(struct openvz_driver *driver)\n{\n    if (!driver)\n        return;\n\n    virObjectUnref(driver->xmlopt);\n    virObjectUnref(driver->domains);\n    virObjectUnref(driver->caps);\n    VIR_FREE(driver);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectClose(virConnectPtr conn)\n{\n    struct openvz_driver *driver = conn->privateData;\n\n    openvzFreeDriver(driver);\n    conn->privateData = NULL;\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzConnectOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1273-1330",
    "snippet": "static virDrvOpenStatus openvzConnectOpen(virConnectPtr conn,\n                                          virConnectAuthPtr auth G_GNUC_UNUSED,\n                                          virConfPtr conf G_GNUC_UNUSED,\n                                          unsigned int flags)\n{\n    struct openvz_driver *driver;\n\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    /* If path isn't /system, then they typoed, so tell them correct path */\n    if (STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected OpenVZ URI path '%s', try openvz:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (!virFileExists(\"/proc/vz\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"OpenVZ control file /proc/vz does not exist\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (access(\"/proc/vz\", W_OK) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"OpenVZ control file /proc/vz is not accessible\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    /* We now know the URI is definitely for this driver, so beyond\n     * here, don't return DECLINED, always use ERROR */\n\n    if (VIR_ALLOC(driver) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    if (!(driver->domains = virDomainObjListNew()))\n        goto cleanup;\n\n    if (!(driver->caps = openvzCapsInit()))\n        goto cleanup;\n\n    if (!(driver->xmlopt = openvzXMLOption(driver)))\n        goto cleanup;\n\n    if (openvzLoadDomains(driver) < 0)\n        goto cleanup;\n\n    if (openvzExtractVersion(driver) < 0)\n        goto cleanup;\n\n    conn->privateData = driver;\n\n    return VIR_DRV_OPEN_SUCCESS;\n\n cleanup:\n    openvzFreeDriver(driver);\n    return VIR_DRV_OPEN_ERROR;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzFreeDriver",
          "args": [
            "driver"
          ],
          "line": 1328
        },
        "resolved": true,
        "details": {
          "function_name": "openvzFreeDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "478-488",
          "snippet": "void\nopenvzFreeDriver(struct openvz_driver *driver)\n{\n    if (!driver)\n        return;\n\n    virObjectUnref(driver->xmlopt);\n    virObjectUnref(driver->domains);\n    virObjectUnref(driver->caps);\n    VIR_FREE(driver);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nopenvzFreeDriver(struct openvz_driver *driver)\n{\n    if (!driver)\n        return;\n\n    virObjectUnref(driver->xmlopt);\n    virObjectUnref(driver->domains);\n    virObjectUnref(driver->caps);\n    VIR_FREE(driver);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzExtractVersion",
          "args": [
            "driver"
          ],
          "line": 1320
        },
        "resolved": true,
        "details": {
          "function_name": "openvzExtractVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "105-117",
          "snippet": "int openvzExtractVersion(struct openvz_driver *driver)\n{\n    if (driver->version > 0)\n        return 0;\n\n    if (openvzExtractVersionInfo(VZCTL, &driver->version) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not extract vzctl version\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint openvzExtractVersion(struct openvz_driver *driver)\n{\n    if (driver->version > 0)\n        return 0;\n\n    if (openvzExtractVersionInfo(VZCTL, &driver->version) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not extract vzctl version\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzLoadDomains",
          "args": [
            "driver"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLoadDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "492-614",
          "snippet": "int openvzLoadDomains(struct openvz_driver *driver)\n{\n    int veid, ret;\n    char *status;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainObjPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    char *temp = NULL;\n    char *outbuf = NULL;\n    char *line;\n    virCommandPtr cmd = NULL;\n    unsigned int vcpus = 0;\n\n    if (openvzAssignUUIDs() < 0)\n        return -1;\n\n    cmd = virCommandNewArgList(VZLIST, \"-a\", \"-ovpsid,status\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    line = outbuf;\n    while (line[0] != '\\0') {\n        unsigned int flags = 0;\n        if (virStrToLong_i(line, &status, 10, &veid) < 0 ||\n            *status++ != ' ' ||\n            (line = strchr(status, '\\n')) == NULL) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Failed to parse vzlist output\"));\n            goto cleanup;\n        }\n        *line++ = '\\0';\n\n        if (!(def = virDomainDefNew()))\n            goto cleanup;\n\n        def->virtType = VIR_DOMAIN_VIRT_OPENVZ;\n\n        if (STREQ(status, \"stopped\"))\n            def->id = -1;\n        else\n            def->id = veid;\n        def->name = g_strdup_printf(\"%i\", veid);\n\n        openvzGetVPSUUID(veid, uuidstr, sizeof(uuidstr));\n        ret = virUUIDParse(uuidstr, def->uuid);\n\n        if (ret == -1) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"UUID in config file malformed\"));\n            goto cleanup;\n        }\n\n        def->os.type = VIR_DOMAIN_OSTYPE_EXE;\n        def->os.init = g_strdup(\"/sbin/init\");\n\n        ret = openvzReadVPSConfigParam(veid, \"CPUS\", &temp);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read config for container %d\"),\n                           veid);\n            goto cleanup;\n        } else if (ret > 0) {\n            vcpus = strtoI(temp);\n        }\n\n        if (ret == 0 || vcpus == 0)\n            vcpus = virHostCPUGetCount();\n\n        if (virDomainDefSetVcpusMax(def, vcpus, driver->xmlopt) < 0)\n            goto cleanup;\n\n        if (virDomainDefSetVcpus(def, vcpus) < 0)\n            goto cleanup;\n\n        /* XXX load rest of VM config data .... */\n\n        openvzReadNetworkConf(def, veid);\n        openvzReadFSConf(def, veid);\n        openvzReadMemConf(def, veid);\n\n        virUUIDFormat(def->uuid, uuidstr);\n        flags = VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE;\n        if (STRNEQ(status, \"stopped\"))\n            flags |= VIR_DOMAIN_OBJ_LIST_ADD_LIVE;\n\n        if (!(dom = virDomainObjListAdd(driver->domains,\n                                        def,\n                                        driver->xmlopt,\n                                        flags,\n                                        NULL)))\n            goto cleanup;\n\n        if (STREQ(status, \"stopped\")) {\n            virDomainObjSetState(dom, VIR_DOMAIN_SHUTOFF,\n                                 VIR_DOMAIN_SHUTOFF_UNKNOWN);\n            dom->pid = -1;\n        } else {\n            virDomainObjSetState(dom, VIR_DOMAIN_RUNNING,\n                                 VIR_DOMAIN_RUNNING_UNKNOWN);\n            dom->pid = veid;\n        }\n        /* XXX OpenVZ doesn't appear to have concept of a transient domain */\n        dom->persistent = 1;\n\n        virDomainObjEndAPI(&dom);\n        dom = NULL;\n        def = NULL;\n    }\n\n    virCommandFree(cmd);\n    VIR_FREE(temp);\n    VIR_FREE(outbuf);\n\n    return 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(temp);\n    VIR_FREE(outbuf);\n    virDomainDefFree(def);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzAssignUUIDs(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzAssignUUIDs(void);\n\nint openvzLoadDomains(struct openvz_driver *driver)\n{\n    int veid, ret;\n    char *status;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainObjPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    char *temp = NULL;\n    char *outbuf = NULL;\n    char *line;\n    virCommandPtr cmd = NULL;\n    unsigned int vcpus = 0;\n\n    if (openvzAssignUUIDs() < 0)\n        return -1;\n\n    cmd = virCommandNewArgList(VZLIST, \"-a\", \"-ovpsid,status\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    line = outbuf;\n    while (line[0] != '\\0') {\n        unsigned int flags = 0;\n        if (virStrToLong_i(line, &status, 10, &veid) < 0 ||\n            *status++ != ' ' ||\n            (line = strchr(status, '\\n')) == NULL) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Failed to parse vzlist output\"));\n            goto cleanup;\n        }\n        *line++ = '\\0';\n\n        if (!(def = virDomainDefNew()))\n            goto cleanup;\n\n        def->virtType = VIR_DOMAIN_VIRT_OPENVZ;\n\n        if (STREQ(status, \"stopped\"))\n            def->id = -1;\n        else\n            def->id = veid;\n        def->name = g_strdup_printf(\"%i\", veid);\n\n        openvzGetVPSUUID(veid, uuidstr, sizeof(uuidstr));\n        ret = virUUIDParse(uuidstr, def->uuid);\n\n        if (ret == -1) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"UUID in config file malformed\"));\n            goto cleanup;\n        }\n\n        def->os.type = VIR_DOMAIN_OSTYPE_EXE;\n        def->os.init = g_strdup(\"/sbin/init\");\n\n        ret = openvzReadVPSConfigParam(veid, \"CPUS\", &temp);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read config for container %d\"),\n                           veid);\n            goto cleanup;\n        } else if (ret > 0) {\n            vcpus = strtoI(temp);\n        }\n\n        if (ret == 0 || vcpus == 0)\n            vcpus = virHostCPUGetCount();\n\n        if (virDomainDefSetVcpusMax(def, vcpus, driver->xmlopt) < 0)\n            goto cleanup;\n\n        if (virDomainDefSetVcpus(def, vcpus) < 0)\n            goto cleanup;\n\n        /* XXX load rest of VM config data .... */\n\n        openvzReadNetworkConf(def, veid);\n        openvzReadFSConf(def, veid);\n        openvzReadMemConf(def, veid);\n\n        virUUIDFormat(def->uuid, uuidstr);\n        flags = VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE;\n        if (STRNEQ(status, \"stopped\"))\n            flags |= VIR_DOMAIN_OBJ_LIST_ADD_LIVE;\n\n        if (!(dom = virDomainObjListAdd(driver->domains,\n                                        def,\n                                        driver->xmlopt,\n                                        flags,\n                                        NULL)))\n            goto cleanup;\n\n        if (STREQ(status, \"stopped\")) {\n            virDomainObjSetState(dom, VIR_DOMAIN_SHUTOFF,\n                                 VIR_DOMAIN_SHUTOFF_UNKNOWN);\n            dom->pid = -1;\n        } else {\n            virDomainObjSetState(dom, VIR_DOMAIN_RUNNING,\n                                 VIR_DOMAIN_RUNNING_UNKNOWN);\n            dom->pid = veid;\n        }\n        /* XXX OpenVZ doesn't appear to have concept of a transient domain */\n        dom->persistent = 1;\n\n        virDomainObjEndAPI(&dom);\n        dom = NULL;\n        def = NULL;\n    }\n\n    virCommandFree(cmd);\n    VIR_FREE(temp);\n    VIR_FREE(outbuf);\n\n    return 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(temp);\n    VIR_FREE(outbuf);\n    virDomainDefFree(def);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzXMLOption",
          "args": [
            "driver"
          ],
          "line": 1314
        },
        "resolved": true,
        "details": {
          "function_name": "openvzXMLOption",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "1130-1135",
          "snippet": "virDomainXMLOptionPtr openvzXMLOption(struct openvz_driver *driver)\n{\n    openvzDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&openvzDomainDefParserConfig,\n                                 NULL, NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virDomainDefParserConfig openvzDomainDefParserConfig = {\n    .domainPostParseCallback = openvzDomainDefPostParse,\n    .devicesPostParseCallback = openvzDomainDeviceDefPostParse,\n    .features = VIR_DOMAIN_DEF_FEATURE_NAME_SLASH,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirDomainDefParserConfig openvzDomainDefParserConfig = {\n    .domainPostParseCallback = openvzDomainDefPostParse,\n    .devicesPostParseCallback = openvzDomainDeviceDefPostParse,\n    .features = VIR_DOMAIN_DEF_FEATURE_NAME_SLASH,\n};\n\nvirDomainXMLOptionPtr openvzXMLOption(struct openvz_driver *driver)\n{\n    openvzDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&openvzDomainDefParserConfig,\n                                 NULL, NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzCapsInit",
          "args": [],
          "line": 1311
        },
        "resolved": true,
        "details": {
          "function_name": "openvzCapsInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "149-182",
          "snippet": "virCapsPtr openvzCapsInit(void)\n{\n    g_autoptr(virCaps) caps = NULL;\n    virCapsGuestPtr guest;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if (!(caps->host.numa = virCapabilitiesHostNUMANewHost()))\n        return NULL;\n\n    if (virCapabilitiesInitCaches(caps) < 0)\n        return NULL;\n\n    if ((guest = virCapabilitiesAddGuest(caps,\n                                         VIR_DOMAIN_OSTYPE_EXE,\n                                         caps->host.arch,\n                                         NULL,\n                                         NULL,\n                                         0,\n                                         NULL)) == NULL)\n        return NULL;\n\n    if (virCapabilitiesAddGuestDomain(guest,\n                                      VIR_DOMAIN_VIRT_OPENVZ,\n                                      NULL,\n                                      NULL,\n                                      0,\n                                      NULL) == NULL)\n        return NULL;\n\n    return g_steal_pointer(&caps);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr openvzCapsInit(void)\n{\n    g_autoptr(virCaps) caps = NULL;\n    virCapsGuestPtr guest;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if (!(caps->host.numa = virCapabilitiesHostNUMANewHost()))\n        return NULL;\n\n    if (virCapabilitiesInitCaches(caps) < 0)\n        return NULL;\n\n    if ((guest = virCapabilitiesAddGuest(caps,\n                                         VIR_DOMAIN_OSTYPE_EXE,\n                                         caps->host.arch,\n                                         NULL,\n                                         NULL,\n                                         0,\n                                         NULL)) == NULL)\n        return NULL;\n\n    if (virCapabilitiesAddGuestDomain(guest,\n                                      VIR_DOMAIN_VIRT_OPENVZ,\n                                      NULL,\n                                      NULL,\n                                      0,\n                                      NULL) == NULL)\n        return NULL;\n\n    return g_steal_pointer(&caps);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListNew",
          "args": [],
          "line": 1308
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "68-85",
          "snippet": "virDomainObjListPtr virDomainObjListNew(void)\n{\n    virDomainObjListPtr doms;\n\n    if (virDomainObjListInitialize() < 0)\n        return NULL;\n\n    if (!(doms = virObjectRWLockableNew(virDomainObjListClass)))\n        return NULL;\n\n    if (!(doms->objs = virHashCreate(50, virObjectFreeHashData)) ||\n        !(doms->objsName = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(doms);\n        return NULL;\n    }\n\n    return doms;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainObjListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainObjListClass;\n\nvirDomainObjListPtr virDomainObjListNew(void)\n{\n    virDomainObjListPtr doms;\n\n    if (virDomainObjListInitialize() < 0)\n        return NULL;\n\n    if (!(doms = virObjectRWLockableNew(virDomainObjListClass)))\n        return NULL;\n\n    if (!(doms->objs = virHashCreate(50, virObjectFreeHashData)) ||\n        !(doms->objsName = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(doms);\n        return NULL;\n    }\n\n    return doms;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "driver"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"OpenVZ control file /proc/vz is not accessible\")"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"OpenVZ control file /proc/vz is not accessible\""
          ],
          "line": 1298
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "\"/proc/vz\"",
            "W_OK"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"OpenVZ control file /proc/vz does not exist\")"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "\"/proc/vz\""
          ],
          "line": 1290
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected OpenVZ URI path '%s', try openvz:///system\")",
            "conn->uri->path"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "conn->uri->path",
            "\"/system\""
          ],
          "line": 1283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_RO",
            "VIR_DRV_OPEN_ERROR"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic virDrvOpenStatus openvzConnectOpen(virConnectPtr conn,\n                                          virConnectAuthPtr auth G_GNUC_UNUSED,\n                                          virConfPtr conf G_GNUC_UNUSED,\n                                          unsigned int flags)\n{\n    struct openvz_driver *driver;\n\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    /* If path isn't /system, then they typoed, so tell them correct path */\n    if (STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected OpenVZ URI path '%s', try openvz:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (!virFileExists(\"/proc/vz\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"OpenVZ control file /proc/vz does not exist\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (access(\"/proc/vz\", W_OK) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"OpenVZ control file /proc/vz is not accessible\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    /* We now know the URI is definitely for this driver, so beyond\n     * here, don't return DECLINED, always use ERROR */\n\n    if (VIR_ALLOC(driver) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    if (!(driver->domains = virDomainObjListNew()))\n        goto cleanup;\n\n    if (!(driver->caps = openvzCapsInit()))\n        goto cleanup;\n\n    if (!(driver->xmlopt = openvzXMLOption(driver)))\n        goto cleanup;\n\n    if (openvzLoadDomains(driver) < 0)\n        goto cleanup;\n\n    if (openvzExtractVersion(driver) < 0)\n        goto cleanup;\n\n    conn->privateData = driver;\n\n    return VIR_DRV_OPEN_SUCCESS;\n\n cleanup:\n    openvzFreeDriver(driver);\n    return VIR_DRV_OPEN_ERROR;\n}"
  },
  {
    "function_name": "openvzConnectURIProbe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1259-1270",
    "snippet": "static int\nopenvzConnectURIProbe(char **uri)\n{\n    if (!virFileExists(\"/proc/vz\"))\n        return 0;\n\n    if (access(\"/proc/vz\", W_OK) < 0)\n        return 0;\n\n    *uri = g_strdup(\"openvz:///system\");\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"openvz:///system\""
          ],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "\"/proc/vz\"",
            "W_OK"
          ],
          "line": 1265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "\"/proc/vz\""
          ],
          "line": 1262
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nopenvzConnectURIProbe(char **uri)\n{\n    if (!virFileExists(\"/proc/vz\"))\n        return 0;\n\n    if (access(\"/proc/vz\", W_OK) < 0)\n        return 0;\n\n    *uri = g_strdup(\"openvz:///system\");\n    return 1;\n}"
  },
  {
    "function_name": "openvzDomainSetVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1252-1256",
    "snippet": "static int\nopenvzDomainSetVcpus(virDomainPtr dom, unsigned int nvcpus)\n{\n    return openvzDomainSetVcpusFlags(dom, nvcpus, VIR_DOMAIN_AFFECT_LIVE);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainSetVcpusFlags",
          "args": [
            "dom",
            "nvcpus",
            "VIR_DOMAIN_AFFECT_LIVE"
          ],
          "line": 1255
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetVcpusFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1217-1250",
          "snippet": "static int openvzDomainSetVcpusFlags(virDomainPtr dom, unsigned int nvcpus,\n                                     unsigned int flags)\n{\n    virDomainObjPtr         vm;\n    struct openvz_driver   *driver = dom->conn->privateData;\n    int                     ret = -1;\n\n    if (flags != VIR_DOMAIN_AFFECT_LIVE) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported flags (0x%x)\"), flags);\n        return -1;\n    }\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (nvcpus <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Number of vCPUs should be >= 1\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetVcpusInternal(vm, nvcpus, driver->xmlopt) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set number of vCPUs\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
            "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int openvzDomainSetVcpusFlags(virDomainPtr dom, unsigned int nvcpus,\n                                     unsigned int flags)\n{\n    virDomainObjPtr         vm;\n    struct openvz_driver   *driver = dom->conn->privateData;\n    int                     ret = -1;\n\n    if (flags != VIR_DOMAIN_AFFECT_LIVE) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported flags (0x%x)\"), flags);\n        return -1;\n    }\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (nvcpus <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Number of vCPUs should be >= 1\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetVcpusInternal(vm, nvcpus, driver->xmlopt) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set number of vCPUs\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainSetVcpus(virDomainPtr dom, unsigned int nvcpus)\n{\n    return openvzDomainSetVcpusFlags(dom, nvcpus, VIR_DOMAIN_AFFECT_LIVE);\n}"
  },
  {
    "function_name": "openvzDomainSetVcpusFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1217-1250",
    "snippet": "static int openvzDomainSetVcpusFlags(virDomainPtr dom, unsigned int nvcpus,\n                                     unsigned int flags)\n{\n    virDomainObjPtr         vm;\n    struct openvz_driver   *driver = dom->conn->privateData;\n    int                     ret = -1;\n\n    if (flags != VIR_DOMAIN_AFFECT_LIVE) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported flags (0x%x)\"), flags);\n        return -1;\n    }\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (nvcpus <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Number of vCPUs should be >= 1\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetVcpusInternal(vm, nvcpus, driver->xmlopt) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set number of vCPUs\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set number of vCPUs\")"
          ],
          "line": 1240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not set number of vCPUs\""
          ],
          "line": 1241
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomainSetVcpusInternal",
          "args": [
            "vm",
            "nvcpus",
            "driver->xmlopt"
          ],
          "line": 1239
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetVcpusInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1190-1215",
          "snippet": "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt)\n{\n    char        str_vcpus[32];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--cpus\", str_vcpus, \"--save\", NULL };\n    unsigned int pcpus;\n    pcpus = virHostCPUGetCount();\n    if (pcpus > 0 && pcpus < nvcpus)\n        nvcpus = pcpus;\n\n    g_snprintf(str_vcpus, sizeof(str_vcpus), \"%d\", nvcpus);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpusMax(vm->def, nvcpus, xmlopt) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpus(vm->def, nvcpus) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt)\n{\n    char        str_vcpus[32];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--cpus\", str_vcpus, \"--save\", NULL };\n    unsigned int pcpus;\n    pcpus = virHostCPUGetCount();\n    if (pcpus > 0 && pcpus < nvcpus)\n        nvcpus = pcpus;\n\n    g_snprintf(str_vcpus, sizeof(str_vcpus), \"%d\", nvcpus);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpusMax(vm->def, nvcpus, xmlopt) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpus(vm->def, nvcpus) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Number of vCPUs should be >= 1\")"
          ],
          "line": 1234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unsupported flags (0x%x)\")",
            "flags"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int openvzDomainSetVcpusFlags(virDomainPtr dom, unsigned int nvcpus,\n                                     unsigned int flags)\n{\n    virDomainObjPtr         vm;\n    struct openvz_driver   *driver = dom->conn->privateData;\n    int                     ret = -1;\n\n    if (flags != VIR_DOMAIN_AFFECT_LIVE) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported flags (0x%x)\"), flags);\n        return -1;\n    }\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (nvcpus <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Number of vCPUs should be >= 1\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetVcpusInternal(vm, nvcpus, driver->xmlopt) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set number of vCPUs\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainSetVcpusInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1190-1215",
    "snippet": "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt)\n{\n    char        str_vcpus[32];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--cpus\", str_vcpus, \"--save\", NULL };\n    unsigned int pcpus;\n    pcpus = virHostCPUGetCount();\n    if (pcpus > 0 && pcpus < nvcpus)\n        nvcpus = pcpus;\n\n    g_snprintf(str_vcpus, sizeof(str_vcpus), \"%d\", nvcpus);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpusMax(vm->def, nvcpus, xmlopt) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpus(vm->def, nvcpus) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefSetVcpus",
          "args": [
            "vm->def",
            "nvcpus"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1889-1909",
          "snippet": "int\nvirDomainDefSetVcpus(virDomainDefPtr def,\n                     unsigned int vcpus)\n{\n    size_t i;\n\n    if (vcpus > def->maxvcpus) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"maximum vCPU count must not be less than current \"\n                         \"vCPU count\"));\n        return -1;\n    }\n\n    for (i = 0; i < vcpus; i++)\n        def->vcpus[i]->online = true;\n\n    for (i = vcpus; i < def->maxvcpus; i++)\n        def->vcpus[i]->online = false;\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSetVcpus(virDomainDefPtr def,\n                     unsigned int vcpus)\n{\n    size_t i;\n\n    if (vcpus > def->maxvcpus) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"maximum vCPU count must not be less than current \"\n                         \"vCPU count\"));\n        return -1;\n    }\n\n    for (i = 0; i < vcpus; i++)\n        def->vcpus[i]->online = true;\n\n    for (i = vcpus; i < def->maxvcpus; i++)\n        def->vcpus[i]->online = false;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSetVcpusMax",
          "args": [
            "vm->def",
            "nvcpus",
            "xmlopt"
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetVcpusMax",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1838-1865",
          "snippet": "int\nvirDomainDefSetVcpusMax(virDomainDefPtr def,\n                        unsigned int maxvcpus,\n                        virDomainXMLOptionPtr xmlopt)\n{\n    size_t oldmax = def->maxvcpus;\n    size_t i;\n\n    if (def->maxvcpus == maxvcpus)\n        return 0;\n\n    if (def->maxvcpus < maxvcpus) {\n        if (VIR_EXPAND_N(def->vcpus, def->maxvcpus, maxvcpus - def->maxvcpus) < 0)\n            return -1;\n\n        for (i = oldmax; i < def->maxvcpus; i++) {\n            if (!(def->vcpus[i] = virDomainVcpuDefNew(xmlopt)))\n                return -1;\n        }\n    } else {\n        for (i = maxvcpus; i < def->maxvcpus; i++)\n            virDomainVcpuDefFree(def->vcpus[i]);\n\n        VIR_SHRINK_N(def->vcpus, def->maxvcpus, def->maxvcpus - maxvcpus);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSetVcpusMax(virDomainDefPtr def,\n                        unsigned int maxvcpus,\n                        virDomainXMLOptionPtr xmlopt)\n{\n    size_t oldmax = def->maxvcpus;\n    size_t i;\n\n    if (def->maxvcpus == maxvcpus)\n        return 0;\n\n    if (def->maxvcpus < maxvcpus) {\n        if (VIR_EXPAND_N(def->vcpus, def->maxvcpus, maxvcpus - def->maxvcpus) < 0)\n            return -1;\n\n        for (i = oldmax; i < def->maxvcpus; i++) {\n            if (!(def->vcpus[i] = virDomainVcpuDefNew(xmlopt)))\n                return -1;\n        }\n    } else {\n        for (i = maxvcpus; i < def->maxvcpus; i++)\n            virDomainVcpuDefFree(def->vcpus[i]);\n\n        VIR_SHRINK_N(def->vcpus, def->maxvcpus, def->maxvcpus - maxvcpus);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 1205
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 1204
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "str_vcpus",
            "sizeof(str_vcpus)",
            "\"%d\"",
            "nvcpus"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHostCPUGetCount",
          "args": [],
          "line": 1198
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "1030-1042",
          "snippet": "int\nvirHostCPUGetCount(void)\n{\n#if defined(__linux__)\n    return virHostCPUParseCountLinux();\n#elif defined(__FreeBSD__) || defined(__APPLE__)\n    return virHostCPUGetCountAppleFreeBSD();\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"host cpu counting not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetCount(void)\n{\n#if defined(__linux__)\n    return virHostCPUParseCountLinux();\n#elif defined(__FreeBSD__) || defined(__APPLE__)\n    return virHostCPUGetCountAppleFreeBSD();\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"host cpu counting not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt)\n{\n    char        str_vcpus[32];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--cpus\", str_vcpus, \"--save\", NULL };\n    unsigned int pcpus;\n    pcpus = virHostCPUGetCount();\n    if (pcpus > 0 && pcpus < nvcpus)\n        nvcpus = pcpus;\n\n    g_snprintf(str_vcpus, sizeof(str_vcpus), \"%d\", nvcpus);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpusMax(vm->def, nvcpus, xmlopt) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpus(vm->def, nvcpus) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzDomainGetMaxVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1184-1188",
    "snippet": "static int openvzDomainGetMaxVcpus(virDomainPtr dom)\n{\n    return openvzDomainGetVcpusFlags(dom, (VIR_DOMAIN_AFFECT_LIVE |\n                                           VIR_DOMAIN_VCPU_MAXIMUM));\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainGetVcpusFlags",
          "args": [
            "dom",
            "(VIR_DOMAIN_AFFECT_LIVE |\n                                           VIR_DOMAIN_VCPU_MAXIMUM)"
          ],
          "line": 1186
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainGetVcpusFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1171-1182",
          "snippet": "static int\nopenvzDomainGetVcpusFlags(virDomainPtr dom G_GNUC_UNUSED,\n                          unsigned int flags)\n{\n    if (flags != (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_VCPU_MAXIMUM)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported flags (0x%x)\"), flags);\n        return -1;\n    }\n\n    return openvzConnectGetMaxVcpus(NULL, \"openvz\");\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainGetVcpusFlags(virDomainPtr dom G_GNUC_UNUSED,\n                          unsigned int flags)\n{\n    if (flags != (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_VCPU_MAXIMUM)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported flags (0x%x)\"), flags);\n        return -1;\n    }\n\n    return openvzConnectGetMaxVcpus(NULL, \"openvz\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom)\n{\n    return openvzDomainGetVcpusFlags(dom, (VIR_DOMAIN_AFFECT_LIVE |\n                                           VIR_DOMAIN_VCPU_MAXIMUM));\n}"
  },
  {
    "function_name": "openvzDomainGetVcpusFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1171-1182",
    "snippet": "static int\nopenvzDomainGetVcpusFlags(virDomainPtr dom G_GNUC_UNUSED,\n                          unsigned int flags)\n{\n    if (flags != (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_VCPU_MAXIMUM)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported flags (0x%x)\"), flags);\n        return -1;\n    }\n\n    return openvzConnectGetMaxVcpus(NULL, \"openvz\");\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzConnectGetMaxVcpus",
          "args": [
            "NULL",
            "\"openvz\""
          ],
          "line": 1181
        },
        "resolved": true,
        "details": {
          "function_name": "openvzConnectGetMaxVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1160-1169",
          "snippet": "static int openvzConnectGetMaxVcpus(virConnectPtr conn G_GNUC_UNUSED,\n                                    const char *type)\n{\n    if (type == NULL || STRCASEEQ(type, \"openvz\"))\n        return 1028; /* OpenVZ has no limitation */\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unknown type '%s'\"), type);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn G_GNUC_UNUSED,\n                                    const char *type)\n{\n    if (type == NULL || STRCASEEQ(type, \"openvz\"))\n        return 1028; /* OpenVZ has no limitation */\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unknown type '%s'\"), type);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unsupported flags (0x%x)\")",
            "flags"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unsupported flags (0x%x)\""
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainGetVcpusFlags(virDomainPtr dom G_GNUC_UNUSED,\n                          unsigned int flags)\n{\n    if (flags != (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_VCPU_MAXIMUM)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported flags (0x%x)\"), flags);\n        return -1;\n    }\n\n    return openvzConnectGetMaxVcpus(NULL, \"openvz\");\n}"
  },
  {
    "function_name": "openvzConnectGetMaxVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1160-1169",
    "snippet": "static int openvzConnectGetMaxVcpus(virConnectPtr conn G_GNUC_UNUSED,\n                                    const char *type)\n{\n    if (type == NULL || STRCASEEQ(type, \"openvz\"))\n        return 1028; /* OpenVZ has no limitation */\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unknown type '%s'\"), type);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown type '%s'\")",
            "type"
          ],
          "line": 1166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown type '%s'\""
          ],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "type",
            "\"openvz\""
          ],
          "line": 1163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn G_GNUC_UNUSED,\n                                    const char *type)\n{\n    if (type == NULL || STRCASEEQ(type, \"openvz\"))\n        return 1028; /* OpenVZ has no limitation */\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unknown type '%s'\"), type);\n    return -1;\n}"
  },
  {
    "function_name": "openvzDomainGetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1131-1158",
    "snippet": "static int\nopenvzDomainGetAutostart(virDomainPtr dom, int *autostart)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *value = NULL;\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzReadVPSConfigParam(strtoI(vm->def->name), \"ONBOOT\", &value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not read container config\"));\n        goto cleanup;\n    }\n\n    *autostart = 0;\n    if (STREQ(value, \"yes\"))\n        *autostart = 1;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(value);\n\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1156
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "\"yes\""
          ],
          "line": 1149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not read container config\")"
          ],
          "line": 1143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not read container config\""
          ],
          "line": 1144
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzReadVPSConfigParam",
          "args": [
            "strtoI(vm->def->name)",
            "\"ONBOOT\"",
            "&value"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadVPSConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "743-755",
          "snippet": "int\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoI",
          "args": [
            "vm->def->name"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "strtoI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "54-63",
          "snippet": "int\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 1139
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainGetAutostart(virDomainPtr dom, int *autostart)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *value = NULL;\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzReadVPSConfigParam(strtoI(vm->def->name), \"ONBOOT\", &value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not read container config\"));\n        goto cleanup;\n    }\n\n    *autostart = 0;\n    if (STREQ(value, \"yes\"))\n        *autostart = 1;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(value);\n\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1108-1129",
    "snippet": "static int\nopenvzDomainSetAutostart(virDomainPtr dom, int autostart)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--onboot\", autostart ? \"yes\" : \"no\",\n                           \"--save\", NULL };\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainSetAutostart(virDomainPtr dom, int autostart)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--onboot\", autostart ? \"yes\" : \"no\",\n                           \"--save\", NULL };\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1103-1107",
    "snippet": "static int\nopenvzDomainUndefine(virDomainPtr dom)\n{\n    return openvzDomainUndefineFlags(dom, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainUndefineFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainUndefineFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1067-1101",
          "snippet": "static int\nopenvzDomainUndefineFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = { VZCTL, \"--quiet\", \"destroy\", PROGRAM_SENTINEL, NULL };\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    openvzDriverLock(driver);\n    if (!(vm = openvzDomObjFromDomainLocked(driver, dom->uuid)))\n        goto cleanup;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainUndefineFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = { VZCTL, \"--quiet\", \"destroy\", PROGRAM_SENTINEL, NULL };\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    openvzDriverLock(driver);\n    if (!(vm = openvzDomObjFromDomainLocked(driver, dom->uuid)))\n        goto cleanup;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainUndefine(virDomainPtr dom)\n{\n    return openvzDomainUndefineFlags(dom, 0);\n}"
  },
  {
    "function_name": "openvzDomainUndefineFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1067-1101",
    "snippet": "static int\nopenvzDomainUndefineFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = { VZCTL, \"--quiet\", \"destroy\", PROGRAM_SENTINEL, NULL };\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    openvzDriverLock(driver);\n    if (!(vm = openvzDomObjFromDomainLocked(driver, dom->uuid)))\n        goto cleanup;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "driver->domains",
            "vm"
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 1087
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "&status",
            "NULL"
          ],
          "line": 1083
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomainLocked",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomainLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "81-97",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomainLocked(struct openvz_driver *driver,\n                             const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(vm = virDomainObjListFindByUUID(driver->domains, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomainLocked(struct openvz_driver *driver,\n                             const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(vm = virDomainObjListFindByUUID(driver->domains, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainUndefineFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = { VZCTL, \"--quiet\", \"destroy\", PROGRAM_SENTINEL, NULL };\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    openvzDriverLock(driver);\n    if (!(vm = openvzDomObjFromDomainLocked(driver, dom->uuid)))\n        goto cleanup;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1061-1065",
    "snippet": "static int\nopenvzDomainCreate(virDomainPtr dom)\n{\n    return openvzDomainCreateWithFlags(dom, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainCreateWithFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainCreateWithFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1016-1059",
          "snippet": "static int\nopenvzDomainCreateWithFlags(virDomainPtr dom, unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"start\", PROGRAM_SENTINEL, NULL };\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    openvzDriverLock(driver);\n    vm = virDomainObjListFindByName(driver->domains, dom->name);\n    openvzDriverUnlock(driver);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), dom->name);\n        goto cleanup;\n    }\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    if (status != VIR_DOMAIN_SHUTOFF) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"domain is not in shutoff state\"));\n        goto cleanup;\n    }\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->pid = strtoI(vm->def->name);\n    vm->def->id = vm->pid;\n    dom->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_BOOTED);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainCreateWithFlags(virDomainPtr dom, unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"start\", PROGRAM_SENTINEL, NULL };\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    openvzDriverLock(driver);\n    vm = virDomainObjListFindByName(driver->domains, dom->name);\n    openvzDriverUnlock(driver);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), dom->name);\n        goto cleanup;\n    }\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    if (status != VIR_DOMAIN_SHUTOFF) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"domain is not in shutoff state\"));\n        goto cleanup;\n    }\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->pid = strtoI(vm->def->name);\n    vm->def->id = vm->pid;\n    dom->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_BOOTED);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainCreate(virDomainPtr dom)\n{\n    return openvzDomainCreateWithFlags(dom, 0);\n}"
  },
  {
    "function_name": "openvzDomainCreateWithFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "1016-1059",
    "snippet": "static int\nopenvzDomainCreateWithFlags(virDomainPtr dom, unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"start\", PROGRAM_SENTINEL, NULL };\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    openvzDriverLock(driver);\n    vm = virDomainObjListFindByName(driver->domains, dom->name);\n    openvzDriverUnlock(driver);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), dom->name);\n        goto cleanup;\n    }\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    if (status != VIR_DOMAIN_SHUTOFF) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"domain is not in shutoff state\"));\n        goto cleanup;\n    }\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->pid = strtoI(vm->def->name);\n    vm->def->id = vm->pid;\n    dom->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_BOOTED);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1057
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_RUNNING",
            "VIR_DOMAIN_RUNNING_BOOTED"
          ],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoI",
          "args": [
            "vm->def->name"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "strtoI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "54-63",
          "snippet": "int\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 1047
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 1046
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"domain is not in shutoff state\")"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domain is not in shutoff state\""
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "&status",
            "NULL"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching name '%s'\")",
            "dom->name"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByName",
          "args": [
            "driver->domains",
            "dom->name"
          ],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "205-222",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainCreateWithFlags(virDomainPtr dom, unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"start\", PROGRAM_SENTINEL, NULL };\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    openvzDriverLock(driver);\n    vm = virDomainObjListFindByName(driver->domains, dom->name);\n    openvzDriverUnlock(driver);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), dom->name);\n        goto cleanup;\n    }\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    if (status != VIR_DOMAIN_SHUTOFF) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"domain is not in shutoff state\"));\n        goto cleanup;\n    }\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->pid = strtoI(vm->def->name);\n    vm->def->id = vm->pid;\n    dom->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_BOOTED);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "934-1014",
    "snippet": "static virDomainPtr\nopenvzDomainCreateXML(virConnectPtr conn, const char *xml,\n                      unsigned int flags)\n{\n    struct openvz_driver *driver =  conn->privateData;\n    virDomainDefPtr vmdef = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    const char *progstart[] = {VZCTL, \"--quiet\", \"start\", PROGRAM_SENTINEL, NULL};\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_START_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_START_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    openvzDriverLock(driver);\n    if ((vmdef = virDomainDefParseString(xml, driver->xmlopt,\n                                         NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(driver->domains,\n                                   vmdef,\n                                   driver->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE,\n                                   NULL)))\n        goto cleanup;\n    vmdef = NULL;\n    /* All OpenVZ domains seem to be persistent - this is a bit of a violation\n     * of this libvirt API which is intended for transient domain creation */\n    vm->persistent = 1;\n\n    if (openvzSetInitialConfig(vm->def) < 0) {\n        VIR_ERROR(_(\"Error creating initial configuration\"));\n        goto cleanup;\n    }\n\n    if (vm->def->nfss == 1) {\n        if (openvzSetDiskQuota(vm->def, vm->def->fss[0], true) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set disk quota\"));\n            goto cleanup;\n        }\n    }\n\n    if (openvzSetDefinedUUID(strtoI(vm->def->name), vm->def->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set UUID\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetNetworkConfig(conn, vm->def) < 0)\n        goto cleanup;\n\n    openvzSetProgramSentinal(progstart, vm->def->name);\n\n    if (virRun(progstart, NULL) < 0)\n        goto cleanup;\n\n    vm->pid = strtoI(vm->def->name);\n    vm->def->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_BOOTED);\n\n    if (virDomainDefGetVcpusMax(vm->def) > 0) {\n        if (openvzDomainSetVcpusInternal(vm, virDomainDefGetVcpusMax(vm->def),\n                                         driver->xmlopt) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set number of vCPUs\"));\n            goto cleanup;\n        }\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "vmdef"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set number of vCPUs\")"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not set number of vCPUs\""
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomainSetVcpusInternal",
          "args": [
            "vm",
            "virDomainDefGetVcpusMax(vm->def)",
            "driver->xmlopt"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetVcpusInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1190-1215",
          "snippet": "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt)\n{\n    char        str_vcpus[32];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--cpus\", str_vcpus, \"--save\", NULL };\n    unsigned int pcpus;\n    pcpus = virHostCPUGetCount();\n    if (pcpus > 0 && pcpus < nvcpus)\n        nvcpus = pcpus;\n\n    g_snprintf(str_vcpus, sizeof(str_vcpus), \"%d\", nvcpus);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpusMax(vm->def, nvcpus, xmlopt) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpus(vm->def, nvcpus) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt)\n{\n    char        str_vcpus[32];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--cpus\", str_vcpus, \"--save\", NULL };\n    unsigned int pcpus;\n    pcpus = virHostCPUGetCount();\n    if (pcpus > 0 && pcpus < nvcpus)\n        nvcpus = pcpus;\n\n    g_snprintf(str_vcpus, sizeof(str_vcpus), \"%d\", nvcpus);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpusMax(vm->def, nvcpus, xmlopt) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpus(vm->def, nvcpus) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpusMax",
          "args": [
            "vm->def"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpusMax",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1882-1886",
          "snippet": "unsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_RUNNING",
            "VIR_DOMAIN_RUNNING_BOOTED"
          ],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoI",
          "args": [
            "vm->def->name"
          ],
          "line": 994
        },
        "resolved": true,
        "details": {
          "function_name": "strtoI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "54-63",
          "snippet": "int\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "progstart",
            "NULL"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "progstart",
            "vm->def->name"
          ],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomainSetNetworkConfig",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetNetworkConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "799-843",
          "snippet": "static int\nopenvzDomainSetNetworkConfig(virConnectPtr conn,\n                             virDomainDefPtr def)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *param;\n    int first = 1;\n    struct openvz_driver *driver =  conn->privateData;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (driver->version < VZCTL_BRIDGE_MIN_VERSION &&\n            def->nets[i]->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (first)\n                first = 0;\n            else\n                virBufferAddLit(&buf, \";\");\n        }\n\n        if (openvzDomainSetNetwork(conn, def->name, def->nets[i], &buf) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not configure network\"));\n            goto exit;\n        }\n    }\n\n    if (driver->version < VZCTL_BRIDGE_MIN_VERSION && def->nnets) {\n        param = virBufferContentAndReset(&buf);\n        if (param) {\n            if (openvzWriteVPSConfigParam(strtoI(def->name), \"NETIF\", param) < 0) {\n                VIR_FREE(param);\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cannot replace NETIF config\"));\n                return -1;\n            }\n            VIR_FREE(param);\n        }\n    }\n\n    return 0;\n\n exit:\n    virBufferFreeAndReset(&buf);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzDomainSetNetworkConfig(virConnectPtr conn,\n                             virDomainDefPtr def)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *param;\n    int first = 1;\n    struct openvz_driver *driver =  conn->privateData;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (driver->version < VZCTL_BRIDGE_MIN_VERSION &&\n            def->nets[i]->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (first)\n                first = 0;\n            else\n                virBufferAddLit(&buf, \";\");\n        }\n\n        if (openvzDomainSetNetwork(conn, def->name, def->nets[i], &buf) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not configure network\"));\n            goto exit;\n        }\n    }\n\n    if (driver->version < VZCTL_BRIDGE_MIN_VERSION && def->nnets) {\n        param = virBufferContentAndReset(&buf);\n        if (param) {\n            if (openvzWriteVPSConfigParam(strtoI(def->name), \"NETIF\", param) < 0) {\n                VIR_FREE(param);\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cannot replace NETIF config\"));\n                return -1;\n            }\n            VIR_FREE(param);\n        }\n    }\n\n    return 0;\n\n exit:\n    virBufferFreeAndReset(&buf);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set UUID\")"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzSetDefinedUUID",
          "args": [
            "strtoI(vm->def->name)",
            "vm->def->uuid"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetDefinedUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "952-988",
          "snippet": "int\nopenvzSetDefinedUUID(int vpsid, unsigned char *uuid)\n{\n    char *conf_file;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    FILE *fp = NULL;\n    int ret = -1;\n\n    if (uuid == NULL)\n        return -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    if (openvzGetVPSUUID(vpsid, uuidstr, sizeof(uuidstr)))\n        goto cleanup;\n\n    if (uuidstr[0] == 0) {\n        fp = fopen(conf_file, \"a\"); /* append */\n        if (fp == NULL)\n            goto cleanup;\n\n        virUUIDFormat(uuid, uuidstr);\n\n        /* Record failure if fprintf or VIR_FCLOSE fails,\n           and be careful always to close the stream.  */\n        if ((fprintf(fp, \"\\n#UUID: %s\\n\", uuidstr) < 0) ||\n            (VIR_FCLOSE(fp) == EOF))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzSetDefinedUUID(int vpsid, unsigned char *uuid)\n{\n    char *conf_file;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    FILE *fp = NULL;\n    int ret = -1;\n\n    if (uuid == NULL)\n        return -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    if (openvzGetVPSUUID(vpsid, uuidstr, sizeof(uuidstr)))\n        goto cleanup;\n\n    if (uuidstr[0] == 0) {\n        fp = fopen(conf_file, \"a\"); /* append */\n        if (fp == NULL)\n            goto cleanup;\n\n        virUUIDFormat(uuid, uuidstr);\n\n        /* Record failure if fprintf or VIR_FCLOSE fails,\n           and be careful always to close the stream.  */\n        if ((fprintf(fp, \"\\n#UUID: %s\\n\", uuidstr) < 0) ||\n            (VIR_FCLOSE(fp) == EOF))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set disk quota\")"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzSetDiskQuota",
          "args": [
            "vm->def",
            "vm->def->fss[0]",
            "true"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetDiskQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "204-245",
          "snippet": "static int\nopenvzSetDiskQuota(virDomainDefPtr vmdef,\n                   virDomainFSDefPtr fss,\n                   bool persist)\n{\n    int ret = -1;\n    unsigned long long sl, hl;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"set\",\n                                             vmdef->name,\n                                             NULL);\n    if (persist)\n        virCommandAddArg(cmd, \"--save\");\n\n    if (fss->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        if (fss->space_hard_limit) {\n            hl = VIR_DIV_UP(fss->space_hard_limit, 1024);\n            virCommandAddArg(cmd, \"--diskspace\");\n\n            if (fss->space_soft_limit) {\n                sl = VIR_DIV_UP(fss->space_soft_limit, 1024);\n                virCommandAddArgFormat(cmd, \"%lld:%lld\", sl, hl);\n            } else {\n                virCommandAddArgFormat(cmd, \"%lld\", hl);\n            }\n        } else if (fss->space_soft_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Can't set soft limit without hard limit\"));\n            goto cleanup;\n        }\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzSetDiskQuota(virDomainDefPtr vmdef,\n                   virDomainFSDefPtr fss,\n                   bool persist)\n{\n    int ret = -1;\n    unsigned long long sl, hl;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"set\",\n                                             vmdef->name,\n                                             NULL);\n    if (persist)\n        virCommandAddArg(cmd, \"--save\");\n\n    if (fss->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        if (fss->space_hard_limit) {\n            hl = VIR_DIV_UP(fss->space_hard_limit, 1024);\n            virCommandAddArg(cmd, \"--diskspace\");\n\n            if (fss->space_soft_limit) {\n                sl = VIR_DIV_UP(fss->space_soft_limit, 1024);\n                virCommandAddArgFormat(cmd, \"%lld:%lld\", sl, hl);\n            } else {\n                virCommandAddArgFormat(cmd, \"%lld\", hl);\n            }\n        } else if (fss->space_soft_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Can't set soft limit without hard limit\"));\n            goto cleanup;\n        }\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Error creating initial configuration\")"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzSetInitialConfig",
          "args": [
            "vm->def"
          ],
          "line": 967
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetInitialConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "144-201",
          "snippet": "static int openvzSetInitialConfig(virDomainDefPtr vmdef)\n{\n    int ret = -1;\n    int vpsid;\n    char * confdir = NULL;\n    virCommandPtr cmd = NULL;\n\n    if (vmdef->nfss > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only one filesystem supported\"));\n        goto cleanup;\n    }\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_TEMPLATE &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filesystem is not of type 'template' or 'mount'\"));\n        goto cleanup;\n    }\n\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n\n        if (virStrToLong_i(vmdef->name, NULL, 10, &vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not convert domain name to VEID\"));\n            goto cleanup;\n        }\n\n        if (openvzCopyDefaultConfig(vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not copy default config\"));\n            goto cleanup;\n        }\n\n        if (openvzWriteVPSConfigParam(vpsid, \"VE_PRIVATE\", vmdef->fss[0]->src->path) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set the source dir for the filesystem\"));\n            goto cleanup;\n        }\n    } else {\n        cmd = openvzDomainDefineCmd(vmdef);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(confdir);\n    virCommandFree(cmd);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);",
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int openvzSetInitialConfig(virDomainDefPtr vmdef)\n{\n    int ret = -1;\n    int vpsid;\n    char * confdir = NULL;\n    virCommandPtr cmd = NULL;\n\n    if (vmdef->nfss > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only one filesystem supported\"));\n        goto cleanup;\n    }\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_TEMPLATE &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filesystem is not of type 'template' or 'mount'\"));\n        goto cleanup;\n    }\n\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n\n        if (virStrToLong_i(vmdef->name, NULL, 10, &vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not convert domain name to VEID\"));\n            goto cleanup;\n        }\n\n        if (openvzCopyDefaultConfig(vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not copy default config\"));\n            goto cleanup;\n        }\n\n        if (openvzWriteVPSConfigParam(vpsid, \"VE_PRIVATE\", vmdef->fss[0]->src->path) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set the source dir for the filesystem\"));\n            goto cleanup;\n        }\n    } else {\n        cmd = openvzDomainDefineCmd(vmdef);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(confdir);\n    virCommandFree(cmd);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListAdd",
          "args": [
            "driver->domains",
            "vmdef",
            "driver->xmlopt",
            "VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE",
            "NULL"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "354-366",
          "snippet": "virDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "xml",
            "driver->xmlopt",
            "NULL",
            "parse_flags"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_START_VALIDATE",
            "NULL"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic virDomainPtr\nopenvzDomainCreateXML(virConnectPtr conn, const char *xml,\n                      unsigned int flags)\n{\n    struct openvz_driver *driver =  conn->privateData;\n    virDomainDefPtr vmdef = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    const char *progstart[] = {VZCTL, \"--quiet\", \"start\", PROGRAM_SENTINEL, NULL};\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_START_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_START_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    openvzDriverLock(driver);\n    if ((vmdef = virDomainDefParseString(xml, driver->xmlopt,\n                                         NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(driver->domains,\n                                   vmdef,\n                                   driver->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE,\n                                   NULL)))\n        goto cleanup;\n    vmdef = NULL;\n    /* All OpenVZ domains seem to be persistent - this is a bit of a violation\n     * of this libvirt API which is intended for transient domain creation */\n    vm->persistent = 1;\n\n    if (openvzSetInitialConfig(vm->def) < 0) {\n        VIR_ERROR(_(\"Error creating initial configuration\"));\n        goto cleanup;\n    }\n\n    if (vm->def->nfss == 1) {\n        if (openvzSetDiskQuota(vm->def, vm->def->fss[0], true) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set disk quota\"));\n            goto cleanup;\n        }\n    }\n\n    if (openvzSetDefinedUUID(strtoI(vm->def->name), vm->def->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set UUID\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetNetworkConfig(conn, vm->def) < 0)\n        goto cleanup;\n\n    openvzSetProgramSentinal(progstart, vm->def->name);\n\n    if (virRun(progstart, NULL) < 0)\n        goto cleanup;\n\n    vm->pid = strtoI(vm->def->name);\n    vm->def->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_BOOTED);\n\n    if (virDomainDefGetVcpusMax(vm->def) > 0) {\n        if (openvzDomainSetVcpusInternal(vm, virDomainDefGetVcpusMax(vm->def),\n                                         driver->xmlopt) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set number of vCPUs\"));\n            goto cleanup;\n        }\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return dom;\n}"
  },
  {
    "function_name": "openvzDomainDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "928-932",
    "snippet": "static virDomainPtr\nopenvzDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    return openvzDomainDefineXMLFlags(conn, xml, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainDefineXMLFlags",
          "args": [
            "conn",
            "xml",
            "0"
          ],
          "line": 931
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainDefineXMLFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "846-926",
          "snippet": "static virDomainPtr\nopenvzDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    struct openvz_driver *driver =  conn->privateData;\n    virDomainDefPtr vmdef = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    openvzDriverLock(driver);\n    if ((vmdef = virDomainDefParseString(xml, driver->xmlopt,\n                                         NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", vmdef->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(driver->domains, vmdef,\n                                   driver->xmlopt,\n                                   0, NULL)))\n        goto cleanup;\n    vmdef = NULL;\n    vm->persistent = 1;\n\n    if (openvzSetInitialConfig(vm->def) < 0) {\n        VIR_ERROR(_(\"Error creating initial configuration\"));\n        goto cleanup;\n    }\n\n    if (vm->def->nfss == 1) {\n        if (openvzSetDiskQuota(vm->def, vm->def->fss[0], true) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set disk quota\"));\n            goto cleanup;\n        }\n    }\n\n    if (openvzSetDefinedUUID(strtoI(vm->def->name), vm->def->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set UUID\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetNetworkConfig(conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainDefHasVcpusOffline(vm->def)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"current vcpu count must equal maximum\"));\n        goto cleanup;\n    }\n    if (virDomainDefGetVcpusMax(vm->def)) {\n        if (openvzDomainSetVcpusInternal(vm, virDomainDefGetVcpusMax(vm->def),\n                                         driver->xmlopt) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set number of vCPUs\"));\n            goto cleanup;\n        }\n    }\n\n    if (vm->def->mem.cur_balloon > 0) {\n        if (openvzDomainSetMemoryInternal(vm, vm->def->mem.cur_balloon) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set memory size\"));\n            goto cleanup;\n        }\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, -1);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return dom;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
            "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);",
            "static int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\nstatic int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);\n\nstatic virDomainPtr\nopenvzDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    struct openvz_driver *driver =  conn->privateData;\n    virDomainDefPtr vmdef = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    openvzDriverLock(driver);\n    if ((vmdef = virDomainDefParseString(xml, driver->xmlopt,\n                                         NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", vmdef->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(driver->domains, vmdef,\n                                   driver->xmlopt,\n                                   0, NULL)))\n        goto cleanup;\n    vmdef = NULL;\n    vm->persistent = 1;\n\n    if (openvzSetInitialConfig(vm->def) < 0) {\n        VIR_ERROR(_(\"Error creating initial configuration\"));\n        goto cleanup;\n    }\n\n    if (vm->def->nfss == 1) {\n        if (openvzSetDiskQuota(vm->def, vm->def->fss[0], true) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set disk quota\"));\n            goto cleanup;\n        }\n    }\n\n    if (openvzSetDefinedUUID(strtoI(vm->def->name), vm->def->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set UUID\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetNetworkConfig(conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainDefHasVcpusOffline(vm->def)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"current vcpu count must equal maximum\"));\n        goto cleanup;\n    }\n    if (virDomainDefGetVcpusMax(vm->def)) {\n        if (openvzDomainSetVcpusInternal(vm, virDomainDefGetVcpusMax(vm->def),\n                                         driver->xmlopt) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set number of vCPUs\"));\n            goto cleanup;\n        }\n    }\n\n    if (vm->def->mem.cur_balloon > 0) {\n        if (openvzDomainSetMemoryInternal(vm, vm->def->mem.cur_balloon) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set memory size\"));\n            goto cleanup;\n        }\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, -1);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return dom;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainPtr\nopenvzDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    return openvzDomainDefineXMLFlags(conn, xml, 0);\n}"
  },
  {
    "function_name": "openvzDomainDefineXMLFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "846-926",
    "snippet": "static virDomainPtr\nopenvzDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    struct openvz_driver *driver =  conn->privateData;\n    virDomainDefPtr vmdef = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    openvzDriverLock(driver);\n    if ((vmdef = virDomainDefParseString(xml, driver->xmlopt,\n                                         NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", vmdef->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(driver->domains, vmdef,\n                                   driver->xmlopt,\n                                   0, NULL)))\n        goto cleanup;\n    vmdef = NULL;\n    vm->persistent = 1;\n\n    if (openvzSetInitialConfig(vm->def) < 0) {\n        VIR_ERROR(_(\"Error creating initial configuration\"));\n        goto cleanup;\n    }\n\n    if (vm->def->nfss == 1) {\n        if (openvzSetDiskQuota(vm->def, vm->def->fss[0], true) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set disk quota\"));\n            goto cleanup;\n        }\n    }\n\n    if (openvzSetDefinedUUID(strtoI(vm->def->name), vm->def->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set UUID\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetNetworkConfig(conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainDefHasVcpusOffline(vm->def)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"current vcpu count must equal maximum\"));\n        goto cleanup;\n    }\n    if (virDomainDefGetVcpusMax(vm->def)) {\n        if (openvzDomainSetVcpusInternal(vm, virDomainDefGetVcpusMax(vm->def),\n                                         driver->xmlopt) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set number of vCPUs\"));\n            goto cleanup;\n        }\n    }\n\n    if (vm->def->mem.cur_balloon > 0) {\n        if (openvzDomainSetMemoryInternal(vm, vm->def->mem.cur_balloon) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set memory size\"));\n            goto cleanup;\n        }\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, -1);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);",
      "static int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 923
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "vmdef"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "-1"
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set memory size\")"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not set memory size\""
          ],
          "line": 914
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomainSetMemoryInternal",
          "args": [
            "vm",
            "vm->def->mem.cur_balloon"
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetMemoryInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1543-1560",
          "snippet": "static int\nopenvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                              unsigned long long mem)\n{\n    char str_mem[16];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n        \"--kmemsize\", str_mem, \"--save\", NULL\n    };\n\n    /* memory has to be changed its format from kbyte to byte */\n    g_snprintf(str_mem, sizeof(str_mem), \"%llu\", mem * 1024);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);\n\nstatic int\nopenvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                              unsigned long long mem)\n{\n    char str_mem[16];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n        \"--kmemsize\", str_mem, \"--save\", NULL\n    };\n\n    /* memory has to be changed its format from kbyte to byte */\n    g_snprintf(str_mem, sizeof(str_mem), \"%llu\", mem * 1024);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set number of vCPUs\")"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzDomainSetVcpusInternal",
          "args": [
            "vm",
            "virDomainDefGetVcpusMax(vm->def)",
            "driver->xmlopt"
          ],
          "line": 903
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetVcpusInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1190-1215",
          "snippet": "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt)\n{\n    char        str_vcpus[32];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--cpus\", str_vcpus, \"--save\", NULL };\n    unsigned int pcpus;\n    pcpus = virHostCPUGetCount();\n    if (pcpus > 0 && pcpus < nvcpus)\n        nvcpus = pcpus;\n\n    g_snprintf(str_vcpus, sizeof(str_vcpus), \"%d\", nvcpus);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpusMax(vm->def, nvcpus, xmlopt) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpus(vm->def, nvcpus) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt)\n{\n    char        str_vcpus[32];\n    const char *prog[] = { VZCTL, \"--quiet\", \"set\", PROGRAM_SENTINEL,\n                           \"--cpus\", str_vcpus, \"--save\", NULL };\n    unsigned int pcpus;\n    pcpus = virHostCPUGetCount();\n    if (pcpus > 0 && pcpus < nvcpus)\n        nvcpus = pcpus;\n\n    g_snprintf(str_vcpus, sizeof(str_vcpus), \"%d\", nvcpus);\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (virRun(prog, NULL) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpusMax(vm->def, nvcpus, xmlopt) < 0)\n        return -1;\n\n    if (virDomainDefSetVcpus(vm->def, nvcpus) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpusMax",
          "args": [
            "vm->def"
          ],
          "line": 903
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpusMax",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1882-1886",
          "snippet": "unsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"current vcpu count must equal maximum\")"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefHasVcpusOffline",
          "args": [
            "vm->def"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefHasVcpusOffline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1868-1879",
          "snippet": "bool\nvirDomainDefHasVcpusOffline(const virDomainDef *def)\n{\n    size_t i;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (!def->vcpus[i]->online)\n            return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainDefHasVcpusOffline(const virDomainDef *def)\n{\n    size_t i;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (!def->vcpus[i]->online)\n            return true;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomainSetNetworkConfig",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetNetworkConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "799-843",
          "snippet": "static int\nopenvzDomainSetNetworkConfig(virConnectPtr conn,\n                             virDomainDefPtr def)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *param;\n    int first = 1;\n    struct openvz_driver *driver =  conn->privateData;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (driver->version < VZCTL_BRIDGE_MIN_VERSION &&\n            def->nets[i]->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (first)\n                first = 0;\n            else\n                virBufferAddLit(&buf, \";\");\n        }\n\n        if (openvzDomainSetNetwork(conn, def->name, def->nets[i], &buf) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not configure network\"));\n            goto exit;\n        }\n    }\n\n    if (driver->version < VZCTL_BRIDGE_MIN_VERSION && def->nnets) {\n        param = virBufferContentAndReset(&buf);\n        if (param) {\n            if (openvzWriteVPSConfigParam(strtoI(def->name), \"NETIF\", param) < 0) {\n                VIR_FREE(param);\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cannot replace NETIF config\"));\n                return -1;\n            }\n            VIR_FREE(param);\n        }\n    }\n\n    return 0;\n\n exit:\n    virBufferFreeAndReset(&buf);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzDomainSetNetworkConfig(virConnectPtr conn,\n                             virDomainDefPtr def)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *param;\n    int first = 1;\n    struct openvz_driver *driver =  conn->privateData;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (driver->version < VZCTL_BRIDGE_MIN_VERSION &&\n            def->nets[i]->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (first)\n                first = 0;\n            else\n                virBufferAddLit(&buf, \";\");\n        }\n\n        if (openvzDomainSetNetwork(conn, def->name, def->nets[i], &buf) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not configure network\"));\n            goto exit;\n        }\n    }\n\n    if (driver->version < VZCTL_BRIDGE_MIN_VERSION && def->nnets) {\n        param = virBufferContentAndReset(&buf);\n        if (param) {\n            if (openvzWriteVPSConfigParam(strtoI(def->name), \"NETIF\", param) < 0) {\n                VIR_FREE(param);\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cannot replace NETIF config\"));\n                return -1;\n            }\n            VIR_FREE(param);\n        }\n    }\n\n    return 0;\n\n exit:\n    virBufferFreeAndReset(&buf);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set UUID\")"
          ],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzSetDefinedUUID",
          "args": [
            "strtoI(vm->def->name)",
            "vm->def->uuid"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetDefinedUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "952-988",
          "snippet": "int\nopenvzSetDefinedUUID(int vpsid, unsigned char *uuid)\n{\n    char *conf_file;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    FILE *fp = NULL;\n    int ret = -1;\n\n    if (uuid == NULL)\n        return -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    if (openvzGetVPSUUID(vpsid, uuidstr, sizeof(uuidstr)))\n        goto cleanup;\n\n    if (uuidstr[0] == 0) {\n        fp = fopen(conf_file, \"a\"); /* append */\n        if (fp == NULL)\n            goto cleanup;\n\n        virUUIDFormat(uuid, uuidstr);\n\n        /* Record failure if fprintf or VIR_FCLOSE fails,\n           and be careful always to close the stream.  */\n        if ((fprintf(fp, \"\\n#UUID: %s\\n\", uuidstr) < 0) ||\n            (VIR_FCLOSE(fp) == EOF))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzSetDefinedUUID(int vpsid, unsigned char *uuid)\n{\n    char *conf_file;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    FILE *fp = NULL;\n    int ret = -1;\n\n    if (uuid == NULL)\n        return -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    if (openvzGetVPSUUID(vpsid, uuidstr, sizeof(uuidstr)))\n        goto cleanup;\n\n    if (uuidstr[0] == 0) {\n        fp = fopen(conf_file, \"a\"); /* append */\n        if (fp == NULL)\n            goto cleanup;\n\n        virUUIDFormat(uuid, uuidstr);\n\n        /* Record failure if fprintf or VIR_FCLOSE fails,\n           and be careful always to close the stream.  */\n        if ((fprintf(fp, \"\\n#UUID: %s\\n\", uuidstr) < 0) ||\n            (VIR_FCLOSE(fp) == EOF))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoI",
          "args": [
            "vm->def->name"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "strtoI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "54-63",
          "snippet": "int\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set disk quota\")"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzSetDiskQuota",
          "args": [
            "vm->def",
            "vm->def->fss[0]",
            "true"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetDiskQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "204-245",
          "snippet": "static int\nopenvzSetDiskQuota(virDomainDefPtr vmdef,\n                   virDomainFSDefPtr fss,\n                   bool persist)\n{\n    int ret = -1;\n    unsigned long long sl, hl;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"set\",\n                                             vmdef->name,\n                                             NULL);\n    if (persist)\n        virCommandAddArg(cmd, \"--save\");\n\n    if (fss->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        if (fss->space_hard_limit) {\n            hl = VIR_DIV_UP(fss->space_hard_limit, 1024);\n            virCommandAddArg(cmd, \"--diskspace\");\n\n            if (fss->space_soft_limit) {\n                sl = VIR_DIV_UP(fss->space_soft_limit, 1024);\n                virCommandAddArgFormat(cmd, \"%lld:%lld\", sl, hl);\n            } else {\n                virCommandAddArgFormat(cmd, \"%lld\", hl);\n            }\n        } else if (fss->space_soft_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Can't set soft limit without hard limit\"));\n            goto cleanup;\n        }\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzSetDiskQuota(virDomainDefPtr vmdef,\n                   virDomainFSDefPtr fss,\n                   bool persist)\n{\n    int ret = -1;\n    unsigned long long sl, hl;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"set\",\n                                             vmdef->name,\n                                             NULL);\n    if (persist)\n        virCommandAddArg(cmd, \"--save\");\n\n    if (fss->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        if (fss->space_hard_limit) {\n            hl = VIR_DIV_UP(fss->space_hard_limit, 1024);\n            virCommandAddArg(cmd, \"--diskspace\");\n\n            if (fss->space_soft_limit) {\n                sl = VIR_DIV_UP(fss->space_soft_limit, 1024);\n                virCommandAddArgFormat(cmd, \"%lld:%lld\", sl, hl);\n            } else {\n                virCommandAddArgFormat(cmd, \"%lld\", hl);\n            }\n        } else if (fss->space_soft_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Can't set soft limit without hard limit\"));\n            goto cleanup;\n        }\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Error creating initial configuration\")"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzSetInitialConfig",
          "args": [
            "vm->def"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetInitialConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "144-201",
          "snippet": "static int openvzSetInitialConfig(virDomainDefPtr vmdef)\n{\n    int ret = -1;\n    int vpsid;\n    char * confdir = NULL;\n    virCommandPtr cmd = NULL;\n\n    if (vmdef->nfss > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only one filesystem supported\"));\n        goto cleanup;\n    }\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_TEMPLATE &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filesystem is not of type 'template' or 'mount'\"));\n        goto cleanup;\n    }\n\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n\n        if (virStrToLong_i(vmdef->name, NULL, 10, &vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not convert domain name to VEID\"));\n            goto cleanup;\n        }\n\n        if (openvzCopyDefaultConfig(vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not copy default config\"));\n            goto cleanup;\n        }\n\n        if (openvzWriteVPSConfigParam(vpsid, \"VE_PRIVATE\", vmdef->fss[0]->src->path) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set the source dir for the filesystem\"));\n            goto cleanup;\n        }\n    } else {\n        cmd = openvzDomainDefineCmd(vmdef);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(confdir);\n    virCommandFree(cmd);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);",
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int openvzSetInitialConfig(virDomainDefPtr vmdef)\n{\n    int ret = -1;\n    int vpsid;\n    char * confdir = NULL;\n    virCommandPtr cmd = NULL;\n\n    if (vmdef->nfss > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only one filesystem supported\"));\n        goto cleanup;\n    }\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_TEMPLATE &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filesystem is not of type 'template' or 'mount'\"));\n        goto cleanup;\n    }\n\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n\n        if (virStrToLong_i(vmdef->name, NULL, 10, &vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not convert domain name to VEID\"));\n            goto cleanup;\n        }\n\n        if (openvzCopyDefaultConfig(vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not copy default config\"));\n            goto cleanup;\n        }\n\n        if (openvzWriteVPSConfigParam(vpsid, \"VE_PRIVATE\", vmdef->fss[0]->src->path) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set the source dir for the filesystem\"));\n            goto cleanup;\n        }\n    } else {\n        cmd = openvzDomainDefineCmd(vmdef);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(confdir);\n    virCommandFree(cmd);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListAdd",
          "args": [
            "driver->domains",
            "vmdef",
            "driver->xmlopt",
            "0",
            "NULL"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "354-366",
          "snippet": "virDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLCheckIllegalChars",
          "args": [
            "\"name\"",
            "vmdef->name",
            "\"\\n\""
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLCheckIllegalChars",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "490-502",
          "snippet": "int\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "xml",
            "driver->xmlopt",
            "NULL",
            "parse_flags"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 860
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_DEFINE_VALIDATE",
            "NULL"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\nstatic int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);\n\nstatic virDomainPtr\nopenvzDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    struct openvz_driver *driver =  conn->privateData;\n    virDomainDefPtr vmdef = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    openvzDriverLock(driver);\n    if ((vmdef = virDomainDefParseString(xml, driver->xmlopt,\n                                         NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", vmdef->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (!(vm = virDomainObjListAdd(driver->domains, vmdef,\n                                   driver->xmlopt,\n                                   0, NULL)))\n        goto cleanup;\n    vmdef = NULL;\n    vm->persistent = 1;\n\n    if (openvzSetInitialConfig(vm->def) < 0) {\n        VIR_ERROR(_(\"Error creating initial configuration\"));\n        goto cleanup;\n    }\n\n    if (vm->def->nfss == 1) {\n        if (openvzSetDiskQuota(vm->def, vm->def->fss[0], true) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set disk quota\"));\n            goto cleanup;\n        }\n    }\n\n    if (openvzSetDefinedUUID(strtoI(vm->def->name), vm->def->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not set UUID\"));\n        goto cleanup;\n    }\n\n    if (openvzDomainSetNetworkConfig(conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainDefHasVcpusOffline(vm->def)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"current vcpu count must equal maximum\"));\n        goto cleanup;\n    }\n    if (virDomainDefGetVcpusMax(vm->def)) {\n        if (openvzDomainSetVcpusInternal(vm, virDomainDefGetVcpusMax(vm->def),\n                                         driver->xmlopt) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set number of vCPUs\"));\n            goto cleanup;\n        }\n    }\n\n    if (vm->def->mem.cur_balloon > 0) {\n        if (openvzDomainSetMemoryInternal(vm, vm->def->mem.cur_balloon) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set memory size\"));\n            goto cleanup;\n        }\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, -1);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    virDomainObjEndAPI(&vm);\n    openvzDriverUnlock(driver);\n    return dom;\n}"
  },
  {
    "function_name": "openvzDomainSetNetworkConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "799-843",
    "snippet": "static int\nopenvzDomainSetNetworkConfig(virConnectPtr conn,\n                             virDomainDefPtr def)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *param;\n    int first = 1;\n    struct openvz_driver *driver =  conn->privateData;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (driver->version < VZCTL_BRIDGE_MIN_VERSION &&\n            def->nets[i]->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (first)\n                first = 0;\n            else\n                virBufferAddLit(&buf, \";\");\n        }\n\n        if (openvzDomainSetNetwork(conn, def->name, def->nets[i], &buf) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not configure network\"));\n            goto exit;\n        }\n    }\n\n    if (driver->version < VZCTL_BRIDGE_MIN_VERSION && def->nnets) {\n        param = virBufferContentAndReset(&buf);\n        if (param) {\n            if (openvzWriteVPSConfigParam(strtoI(def->name), \"NETIF\", param) < 0) {\n                VIR_FREE(param);\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cannot replace NETIF config\"));\n                return -1;\n            }\n            VIR_FREE(param);\n        }\n    }\n\n    return 0;\n\n exit:\n    virBufferFreeAndReset(&buf);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "param"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"cannot replace NETIF config\")"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot replace NETIF config\""
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "param"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzWriteVPSConfigParam",
          "args": [
            "strtoI(def->name)",
            "\"NETIF\"",
            "param"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "openvzWriteVPSConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "673-685",
          "snippet": "int\nopenvzWriteVPSConfigParam(int vpsid, const char *param, const char *value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzWriteConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzWriteVPSConfigParam(int vpsid, const char *param, const char *value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzWriteConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoI",
          "args": [
            "def->name"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "strtoI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "54-63",
          "snippet": "int\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not configure network\")"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzDomainSetNetwork",
          "args": [
            "conn",
            "def->name",
            "def->nets[i]",
            "&buf"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainSetNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "691-796",
          "snippet": "static int\nopenvzDomainSetNetwork(virConnectPtr conn, const char *vpsid,\n                       virDomainNetDefPtr net,\n                       virBufferPtr configBuf)\n{\n    int rc = -1;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n    virMacAddr host_mac;\n    char host_macaddr[VIR_MAC_STRING_BUFLEN];\n    struct openvz_driver *driver =  conn->privateData;\n    virCommandPtr cmd = NULL;\n    char *guest_ifname = NULL;\n\n    if (net == NULL)\n        return 0;\n\n    if (vpsid == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Container ID is not specified\"));\n        return -1;\n    }\n\n    if (net->type != VIR_DOMAIN_NET_TYPE_BRIDGE &&\n        net->type != VIR_DOMAIN_NET_TYPE_ETHERNET)\n        return 0;\n\n    cmd = virCommandNewArgList(VZCTL, \"--quiet\", \"set\", vpsid, NULL);\n\n    virMacAddrFormat(&net->mac, macaddr);\n    virDomainNetGenerateMAC(driver->xmlopt, &host_mac);\n    virMacAddrFormat(&host_mac, host_macaddr);\n\n    if (net->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n        (net->type == VIR_DOMAIN_NET_TYPE_ETHERNET &&\n         net->guestIP.nips == 0)) {\n        virBuffer buf = VIR_BUFFER_INITIALIZER;\n        int veid = openvzGetVEID(vpsid);\n\n        /* if net is ethernet and the user has specified guest interface name,\n         * let's use it; otherwise generate a new one */\n        if (net->ifname_guest) {\n            guest_ifname = g_strdup(net->ifname_guest);\n        } else {\n            guest_ifname = openvzGenerateContainerVethName(veid);\n            if (guest_ifname == NULL) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"Could not generate eth name for container\"));\n                goto cleanup;\n            }\n        }\n\n        /* if user doesn't specified host interface name,\n         * than we need to generate it */\n        if (net->ifname == NULL) {\n            net->ifname = openvzGenerateVethName(veid, guest_ifname);\n            if (net->ifname == NULL) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"Could not generate veth name\"));\n                goto cleanup;\n            }\n        }\n\n        virBufferAdd(&buf, guest_ifname, -1); /* Guest dev */\n        virBufferAsprintf(&buf, \",%s\", macaddr); /* Guest dev mac */\n        virBufferAsprintf(&buf, \",%s\", net->ifname); /* Host dev */\n        virBufferAsprintf(&buf, \",%s\", host_macaddr); /* Host dev mac */\n\n        if (net->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (driver->version >= VZCTL_BRIDGE_MIN_VERSION) {\n                virBufferAsprintf(&buf, \",%s\", net->data.bridge.brname); /* Host bridge */\n            } else {\n                virBufferAsprintf(configBuf, \"ifname=%s\", guest_ifname);\n                virBufferAsprintf(configBuf, \",mac=%s\", macaddr); /* Guest dev mac */\n                virBufferAsprintf(configBuf, \",host_ifname=%s\", net->ifname); /* Host dev */\n                virBufferAsprintf(configBuf, \",host_mac=%s\", host_macaddr); /* Host dev mac */\n                virBufferAsprintf(configBuf, \",bridge=%s\", net->data.bridge.brname); /* Host bridge */\n            }\n        }\n\n        /* --netif_add ifname[,mac,host_ifname,host_mac] */\n        virCommandAddArg(cmd, \"--netif_add\");\n        virCommandAddArgBuffer(cmd, &buf);\n    } else if (net->type == VIR_DOMAIN_NET_TYPE_ETHERNET &&\n               net->guestIP.nips > 0) {\n        size_t i;\n\n        /* --ipadd ip */\n        for (i = 0; i < net->guestIP.nips; i++) {\n            char *ipStr = virSocketAddrFormat(&net->guestIP.ips[i]->address);\n            if (!ipStr)\n                goto cleanup;\n            virCommandAddArgList(cmd, \"--ipadd\", ipStr, NULL);\n            VIR_FREE(ipStr);\n        }\n    }\n\n    /* TODO: processing NAT and physical device */\n\n    virCommandAddArg(cmd, \"--save\");\n    rc = virCommandRun(cmd, NULL);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(guest_ifname);\n    return rc;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);",
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);",
            "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int\nopenvzDomainSetNetwork(virConnectPtr conn, const char *vpsid,\n                       virDomainNetDefPtr net,\n                       virBufferPtr configBuf)\n{\n    int rc = -1;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n    virMacAddr host_mac;\n    char host_macaddr[VIR_MAC_STRING_BUFLEN];\n    struct openvz_driver *driver =  conn->privateData;\n    virCommandPtr cmd = NULL;\n    char *guest_ifname = NULL;\n\n    if (net == NULL)\n        return 0;\n\n    if (vpsid == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Container ID is not specified\"));\n        return -1;\n    }\n\n    if (net->type != VIR_DOMAIN_NET_TYPE_BRIDGE &&\n        net->type != VIR_DOMAIN_NET_TYPE_ETHERNET)\n        return 0;\n\n    cmd = virCommandNewArgList(VZCTL, \"--quiet\", \"set\", vpsid, NULL);\n\n    virMacAddrFormat(&net->mac, macaddr);\n    virDomainNetGenerateMAC(driver->xmlopt, &host_mac);\n    virMacAddrFormat(&host_mac, host_macaddr);\n\n    if (net->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n        (net->type == VIR_DOMAIN_NET_TYPE_ETHERNET &&\n         net->guestIP.nips == 0)) {\n        virBuffer buf = VIR_BUFFER_INITIALIZER;\n        int veid = openvzGetVEID(vpsid);\n\n        /* if net is ethernet and the user has specified guest interface name,\n         * let's use it; otherwise generate a new one */\n        if (net->ifname_guest) {\n            guest_ifname = g_strdup(net->ifname_guest);\n        } else {\n            guest_ifname = openvzGenerateContainerVethName(veid);\n            if (guest_ifname == NULL) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"Could not generate eth name for container\"));\n                goto cleanup;\n            }\n        }\n\n        /* if user doesn't specified host interface name,\n         * than we need to generate it */\n        if (net->ifname == NULL) {\n            net->ifname = openvzGenerateVethName(veid, guest_ifname);\n            if (net->ifname == NULL) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"Could not generate veth name\"));\n                goto cleanup;\n            }\n        }\n\n        virBufferAdd(&buf, guest_ifname, -1); /* Guest dev */\n        virBufferAsprintf(&buf, \",%s\", macaddr); /* Guest dev mac */\n        virBufferAsprintf(&buf, \",%s\", net->ifname); /* Host dev */\n        virBufferAsprintf(&buf, \",%s\", host_macaddr); /* Host dev mac */\n\n        if (net->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (driver->version >= VZCTL_BRIDGE_MIN_VERSION) {\n                virBufferAsprintf(&buf, \",%s\", net->data.bridge.brname); /* Host bridge */\n            } else {\n                virBufferAsprintf(configBuf, \"ifname=%s\", guest_ifname);\n                virBufferAsprintf(configBuf, \",mac=%s\", macaddr); /* Guest dev mac */\n                virBufferAsprintf(configBuf, \",host_ifname=%s\", net->ifname); /* Host dev */\n                virBufferAsprintf(configBuf, \",host_mac=%s\", host_macaddr); /* Host dev mac */\n                virBufferAsprintf(configBuf, \",bridge=%s\", net->data.bridge.brname); /* Host bridge */\n            }\n        }\n\n        /* --netif_add ifname[,mac,host_ifname,host_mac] */\n        virCommandAddArg(cmd, \"--netif_add\");\n        virCommandAddArgBuffer(cmd, &buf);\n    } else if (net->type == VIR_DOMAIN_NET_TYPE_ETHERNET &&\n               net->guestIP.nips > 0) {\n        size_t i;\n\n        /* --ipadd ip */\n        for (i = 0; i < net->guestIP.nips; i++) {\n            char *ipStr = virSocketAddrFormat(&net->guestIP.ips[i]->address);\n            if (!ipStr)\n                goto cleanup;\n            virCommandAddArgList(cmd, \"--ipadd\", ipStr, NULL);\n            VIR_FREE(ipStr);\n        }\n    }\n\n    /* TODO: processing NAT and physical device */\n\n    virCommandAddArg(cmd, \"--save\");\n    rc = virCommandRun(cmd, NULL);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(guest_ifname);\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\";\""
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzDomainSetNetworkConfig(virConnectPtr conn,\n                             virDomainDefPtr def)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *param;\n    int first = 1;\n    struct openvz_driver *driver =  conn->privateData;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (driver->version < VZCTL_BRIDGE_MIN_VERSION &&\n            def->nets[i]->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (first)\n                first = 0;\n            else\n                virBufferAddLit(&buf, \";\");\n        }\n\n        if (openvzDomainSetNetwork(conn, def->name, def->nets[i], &buf) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not configure network\"));\n            goto exit;\n        }\n    }\n\n    if (driver->version < VZCTL_BRIDGE_MIN_VERSION && def->nnets) {\n        param = virBufferContentAndReset(&buf);\n        if (param) {\n            if (openvzWriteVPSConfigParam(strtoI(def->name), \"NETIF\", param) < 0) {\n                VIR_FREE(param);\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cannot replace NETIF config\"));\n                return -1;\n            }\n            VIR_FREE(param);\n        }\n    }\n\n    return 0;\n\n exit:\n    virBufferFreeAndReset(&buf);\n    return -1;\n}"
  },
  {
    "function_name": "openvzDomainSetNetwork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "691-796",
    "snippet": "static int\nopenvzDomainSetNetwork(virConnectPtr conn, const char *vpsid,\n                       virDomainNetDefPtr net,\n                       virBufferPtr configBuf)\n{\n    int rc = -1;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n    virMacAddr host_mac;\n    char host_macaddr[VIR_MAC_STRING_BUFLEN];\n    struct openvz_driver *driver =  conn->privateData;\n    virCommandPtr cmd = NULL;\n    char *guest_ifname = NULL;\n\n    if (net == NULL)\n        return 0;\n\n    if (vpsid == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Container ID is not specified\"));\n        return -1;\n    }\n\n    if (net->type != VIR_DOMAIN_NET_TYPE_BRIDGE &&\n        net->type != VIR_DOMAIN_NET_TYPE_ETHERNET)\n        return 0;\n\n    cmd = virCommandNewArgList(VZCTL, \"--quiet\", \"set\", vpsid, NULL);\n\n    virMacAddrFormat(&net->mac, macaddr);\n    virDomainNetGenerateMAC(driver->xmlopt, &host_mac);\n    virMacAddrFormat(&host_mac, host_macaddr);\n\n    if (net->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n        (net->type == VIR_DOMAIN_NET_TYPE_ETHERNET &&\n         net->guestIP.nips == 0)) {\n        virBuffer buf = VIR_BUFFER_INITIALIZER;\n        int veid = openvzGetVEID(vpsid);\n\n        /* if net is ethernet and the user has specified guest interface name,\n         * let's use it; otherwise generate a new one */\n        if (net->ifname_guest) {\n            guest_ifname = g_strdup(net->ifname_guest);\n        } else {\n            guest_ifname = openvzGenerateContainerVethName(veid);\n            if (guest_ifname == NULL) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"Could not generate eth name for container\"));\n                goto cleanup;\n            }\n        }\n\n        /* if user doesn't specified host interface name,\n         * than we need to generate it */\n        if (net->ifname == NULL) {\n            net->ifname = openvzGenerateVethName(veid, guest_ifname);\n            if (net->ifname == NULL) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"Could not generate veth name\"));\n                goto cleanup;\n            }\n        }\n\n        virBufferAdd(&buf, guest_ifname, -1); /* Guest dev */\n        virBufferAsprintf(&buf, \",%s\", macaddr); /* Guest dev mac */\n        virBufferAsprintf(&buf, \",%s\", net->ifname); /* Host dev */\n        virBufferAsprintf(&buf, \",%s\", host_macaddr); /* Host dev mac */\n\n        if (net->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (driver->version >= VZCTL_BRIDGE_MIN_VERSION) {\n                virBufferAsprintf(&buf, \",%s\", net->data.bridge.brname); /* Host bridge */\n            } else {\n                virBufferAsprintf(configBuf, \"ifname=%s\", guest_ifname);\n                virBufferAsprintf(configBuf, \",mac=%s\", macaddr); /* Guest dev mac */\n                virBufferAsprintf(configBuf, \",host_ifname=%s\", net->ifname); /* Host dev */\n                virBufferAsprintf(configBuf, \",host_mac=%s\", host_macaddr); /* Host dev mac */\n                virBufferAsprintf(configBuf, \",bridge=%s\", net->data.bridge.brname); /* Host bridge */\n            }\n        }\n\n        /* --netif_add ifname[,mac,host_ifname,host_mac] */\n        virCommandAddArg(cmd, \"--netif_add\");\n        virCommandAddArgBuffer(cmd, &buf);\n    } else if (net->type == VIR_DOMAIN_NET_TYPE_ETHERNET &&\n               net->guestIP.nips > 0) {\n        size_t i;\n\n        /* --ipadd ip */\n        for (i = 0; i < net->guestIP.nips; i++) {\n            char *ipStr = virSocketAddrFormat(&net->guestIP.ips[i]->address);\n            if (!ipStr)\n                goto cleanup;\n            virCommandAddArgList(cmd, \"--ipadd\", ipStr, NULL);\n            VIR_FREE(ipStr);\n        }\n    }\n\n    /* TODO: processing NAT and physical device */\n\n    virCommandAddArg(cmd, \"--save\");\n    rc = virCommandRun(cmd, NULL);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(guest_ifname);\n    return rc;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);",
      "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);",
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "guest_ifname"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArg",
          "args": [
            "cmd",
            "\"--save\""
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1655-1684",
          "snippet": "void\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ipStr"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketAddrFormat",
          "args": [
            "&net->guestIP.ips[i]->address"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "441-445",
          "snippet": "char *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nchar *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArgBuffer",
          "args": [
            "cmd",
            "&buf"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1539-1558",
          "snippet": "void\nvirCommandAddArgBuffer(virCommandPtr cmd, virBufferPtr buf)\n{\n    if (!cmd || cmd->has_error) {\n        virBufferFreeAndReset(buf);\n        return;\n    }\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        virBufferFreeAndReset(buf);\n        return;\n    }\n\n    cmd->args[cmd->nargs] = virBufferContentAndReset(buf);\n    if (!cmd->args[cmd->nargs])\n        cmd->args[cmd->nargs] = g_strdup(\"\");\n    cmd->nargs++;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgBuffer(virCommandPtr cmd, virBufferPtr buf)\n{\n    if (!cmd || cmd->has_error) {\n        virBufferFreeAndReset(buf);\n        return;\n    }\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        virBufferFreeAndReset(buf);\n        return;\n    }\n\n    cmd->args[cmd->nargs] = virBufferContentAndReset(buf);\n    if (!cmd->args[cmd->nargs])\n        cmd->args[cmd->nargs] = g_strdup(\"\");\n    cmd->nargs++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "configBuf",
            "\",bridge=%s\"",
            "net->data.bridge.brname"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "&buf",
            "guest_ifname",
            "-1"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not generate veth name\")"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not generate veth name\""
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGenerateVethName",
          "args": [
            "veid",
            "guest_ifname"
          ],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGenerateVethName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "648-658",
          "snippet": "static char *\nopenvzGenerateVethName(int veid, char *dev_name_ve)\n{\n    int     ifNo = 0;\n    char    *ret;\n\n    if (sscanf(dev_name_ve, \"%*[^0-9]%d\", &ifNo) != 1)\n        return NULL;\n    ret = g_strdup_printf(\"veth%d.%d.\", veid, ifNo);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nopenvzGenerateVethName(int veid, char *dev_name_ve)\n{\n    int     ifNo = 0;\n    char    *ret;\n\n    if (sscanf(dev_name_ve, \"%*[^0-9]%d\", &ifNo) != 1)\n        return NULL;\n    ret = g_strdup_printf(\"veth%d.%d.\", veid, ifNo);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not generate eth name for container\")"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzGenerateContainerVethName",
          "args": [
            "veid"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGenerateContainerVethName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "660-689",
          "snippet": "static char *\nopenvzGenerateContainerVethName(int veid)\n{\n    char *temp = NULL;\n    char *name = NULL;\n\n    /* try to get line \"^NETIF=...\" from config */\n    if (openvzReadVPSConfigParam(veid, \"NETIF\", &temp) <= 0) {\n        name = g_strdup(\"eth0\");\n    } else {\n        char *saveptr = NULL;\n        char *s;\n        int max = 0;\n\n        /* get maximum interface number (actually, it is the last one) */\n        for (s = strtok_r(temp, \";\", &saveptr); s; s = strtok_r(NULL, \";\", &saveptr)) {\n            int x;\n\n            if (sscanf(s, \"ifname=eth%d\", &x) != 1) return NULL;\n            if (x > max) max = x;\n        }\n\n        /* set new name */\n        name = g_strdup_printf(\"eth%d\", max + 1);\n    }\n\n    VIR_FREE(temp);\n\n    return name;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nopenvzGenerateContainerVethName(int veid)\n{\n    char *temp = NULL;\n    char *name = NULL;\n\n    /* try to get line \"^NETIF=...\" from config */\n    if (openvzReadVPSConfigParam(veid, \"NETIF\", &temp) <= 0) {\n        name = g_strdup(\"eth0\");\n    } else {\n        char *saveptr = NULL;\n        char *s;\n        int max = 0;\n\n        /* get maximum interface number (actually, it is the last one) */\n        for (s = strtok_r(temp, \";\", &saveptr); s; s = strtok_r(NULL, \";\", &saveptr)) {\n            int x;\n\n            if (sscanf(s, \"ifname=eth%d\", &x) != 1) return NULL;\n            if (x > max) max = x;\n        }\n\n        /* set new name */\n        name = g_strdup_printf(\"eth%d\", max + 1);\n    }\n\n    VIR_FREE(temp);\n\n    return name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEID",
          "args": [
            "vpsid"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "1049-1075",
          "snippet": "int openvzGetVEID(const char *name)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *temp;\n    int veid;\n    bool ok;\n\n    cmd = virCommandNewArgList(VZLIST, name, \"-ovpsid\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0) {\n        virCommandFree(cmd);\n        VIR_FREE(outbuf);\n        return -1;\n    }\n\n    virCommandFree(cmd);\n    ok = virStrToLong_i(outbuf, &temp, 10, &veid) == 0 && *temp == '\\n';\n    VIR_FREE(outbuf);\n\n    if (ok && veid >= 0)\n        return veid;\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Failed to parse vzlist output\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint openvzGetVEID(const char *name)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *temp;\n    int veid;\n    bool ok;\n\n    cmd = virCommandNewArgList(VZLIST, name, \"-ovpsid\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0) {\n        virCommandFree(cmd);\n        VIR_FREE(outbuf);\n        return -1;\n    }\n\n    virCommandFree(cmd);\n    ok = virStrToLong_i(outbuf, &temp, 10, &veid) == 0 && *temp == '\\n';\n    VIR_FREE(outbuf);\n\n    if (ok && veid >= 0)\n        return veid;\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Failed to parse vzlist output\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&host_mac",
            "host_macaddr"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGenerateMAC",
          "args": [
            "driver->xmlopt",
            "&host_mac"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGenerateMAC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "11353-11358",
          "snippet": "void\nvirDomainNetGenerateMAC(virDomainXMLOptionPtr xmlopt,\n                        virMacAddrPtr mac)\n{\n    virMacAddrGenerate(xmlopt->config.macPrefix, mac);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainNetGenerateMAC(virDomainXMLOptionPtr xmlopt,\n                        virMacAddrPtr mac)\n{\n    virMacAddrGenerate(xmlopt->config.macPrefix, mac);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZCTL",
            "\"--quiet\"",
            "\"set\"",
            "vpsid",
            "NULL"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Container ID is not specified\")"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic int\nopenvzDomainSetNetwork(virConnectPtr conn, const char *vpsid,\n                       virDomainNetDefPtr net,\n                       virBufferPtr configBuf)\n{\n    int rc = -1;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n    virMacAddr host_mac;\n    char host_macaddr[VIR_MAC_STRING_BUFLEN];\n    struct openvz_driver *driver =  conn->privateData;\n    virCommandPtr cmd = NULL;\n    char *guest_ifname = NULL;\n\n    if (net == NULL)\n        return 0;\n\n    if (vpsid == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Container ID is not specified\"));\n        return -1;\n    }\n\n    if (net->type != VIR_DOMAIN_NET_TYPE_BRIDGE &&\n        net->type != VIR_DOMAIN_NET_TYPE_ETHERNET)\n        return 0;\n\n    cmd = virCommandNewArgList(VZCTL, \"--quiet\", \"set\", vpsid, NULL);\n\n    virMacAddrFormat(&net->mac, macaddr);\n    virDomainNetGenerateMAC(driver->xmlopt, &host_mac);\n    virMacAddrFormat(&host_mac, host_macaddr);\n\n    if (net->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n        (net->type == VIR_DOMAIN_NET_TYPE_ETHERNET &&\n         net->guestIP.nips == 0)) {\n        virBuffer buf = VIR_BUFFER_INITIALIZER;\n        int veid = openvzGetVEID(vpsid);\n\n        /* if net is ethernet and the user has specified guest interface name,\n         * let's use it; otherwise generate a new one */\n        if (net->ifname_guest) {\n            guest_ifname = g_strdup(net->ifname_guest);\n        } else {\n            guest_ifname = openvzGenerateContainerVethName(veid);\n            if (guest_ifname == NULL) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"Could not generate eth name for container\"));\n                goto cleanup;\n            }\n        }\n\n        /* if user doesn't specified host interface name,\n         * than we need to generate it */\n        if (net->ifname == NULL) {\n            net->ifname = openvzGenerateVethName(veid, guest_ifname);\n            if (net->ifname == NULL) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"Could not generate veth name\"));\n                goto cleanup;\n            }\n        }\n\n        virBufferAdd(&buf, guest_ifname, -1); /* Guest dev */\n        virBufferAsprintf(&buf, \",%s\", macaddr); /* Guest dev mac */\n        virBufferAsprintf(&buf, \",%s\", net->ifname); /* Host dev */\n        virBufferAsprintf(&buf, \",%s\", host_macaddr); /* Host dev mac */\n\n        if (net->type == VIR_DOMAIN_NET_TYPE_BRIDGE) {\n            if (driver->version >= VZCTL_BRIDGE_MIN_VERSION) {\n                virBufferAsprintf(&buf, \",%s\", net->data.bridge.brname); /* Host bridge */\n            } else {\n                virBufferAsprintf(configBuf, \"ifname=%s\", guest_ifname);\n                virBufferAsprintf(configBuf, \",mac=%s\", macaddr); /* Guest dev mac */\n                virBufferAsprintf(configBuf, \",host_ifname=%s\", net->ifname); /* Host dev */\n                virBufferAsprintf(configBuf, \",host_mac=%s\", host_macaddr); /* Host dev mac */\n                virBufferAsprintf(configBuf, \",bridge=%s\", net->data.bridge.brname); /* Host bridge */\n            }\n        }\n\n        /* --netif_add ifname[,mac,host_ifname,host_mac] */\n        virCommandAddArg(cmd, \"--netif_add\");\n        virCommandAddArgBuffer(cmd, &buf);\n    } else if (net->type == VIR_DOMAIN_NET_TYPE_ETHERNET &&\n               net->guestIP.nips > 0) {\n        size_t i;\n\n        /* --ipadd ip */\n        for (i = 0; i < net->guestIP.nips; i++) {\n            char *ipStr = virSocketAddrFormat(&net->guestIP.ips[i]->address);\n            if (!ipStr)\n                goto cleanup;\n            virCommandAddArgList(cmd, \"--ipadd\", ipStr, NULL);\n            VIR_FREE(ipStr);\n        }\n    }\n\n    /* TODO: processing NAT and physical device */\n\n    virCommandAddArg(cmd, \"--save\");\n    rc = virCommandRun(cmd, NULL);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(guest_ifname);\n    return rc;\n}"
  },
  {
    "function_name": "openvzGenerateContainerVethName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "660-689",
    "snippet": "static char *\nopenvzGenerateContainerVethName(int veid)\n{\n    char *temp = NULL;\n    char *name = NULL;\n\n    /* try to get line \"^NETIF=...\" from config */\n    if (openvzReadVPSConfigParam(veid, \"NETIF\", &temp) <= 0) {\n        name = g_strdup(\"eth0\");\n    } else {\n        char *saveptr = NULL;\n        char *s;\n        int max = 0;\n\n        /* get maximum interface number (actually, it is the last one) */\n        for (s = strtok_r(temp, \";\", &saveptr); s; s = strtok_r(NULL, \";\", &saveptr)) {\n            int x;\n\n            if (sscanf(s, \"ifname=eth%d\", &x) != 1) return NULL;\n            if (x > max) max = x;\n        }\n\n        /* set new name */\n        name = g_strdup_printf(\"eth%d\", max + 1);\n    }\n\n    VIR_FREE(temp);\n\n    return name;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"eth%d\"",
            "max + 1"
          ],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "s",
            "\"ifname=eth%d\"",
            "&x"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "NULL",
            "\";\"",
            "&saveptr"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "temp",
            "\";\"",
            "&saveptr"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzReadVPSConfigParam",
          "args": [
            "veid",
            "\"NETIF\"",
            "&temp"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadVPSConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "743-755",
          "snippet": "int\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nopenvzGenerateContainerVethName(int veid)\n{\n    char *temp = NULL;\n    char *name = NULL;\n\n    /* try to get line \"^NETIF=...\" from config */\n    if (openvzReadVPSConfigParam(veid, \"NETIF\", &temp) <= 0) {\n        name = g_strdup(\"eth0\");\n    } else {\n        char *saveptr = NULL;\n        char *s;\n        int max = 0;\n\n        /* get maximum interface number (actually, it is the last one) */\n        for (s = strtok_r(temp, \";\", &saveptr); s; s = strtok_r(NULL, \";\", &saveptr)) {\n            int x;\n\n            if (sscanf(s, \"ifname=eth%d\", &x) != 1) return NULL;\n            if (x > max) max = x;\n        }\n\n        /* set new name */\n        name = g_strdup_printf(\"eth%d\", max + 1);\n    }\n\n    VIR_FREE(temp);\n\n    return name;\n}"
  },
  {
    "function_name": "openvzGenerateVethName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "648-658",
    "snippet": "static char *\nopenvzGenerateVethName(int veid, char *dev_name_ve)\n{\n    int     ifNo = 0;\n    char    *ret;\n\n    if (sscanf(dev_name_ve, \"%*[^0-9]%d\", &ifNo) != 1)\n        return NULL;\n    ret = g_strdup_printf(\"veth%d.%d.\", veid, ifNo);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"veth%d.%d.\"",
            "veid",
            "ifNo"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "dev_name_ve",
            "\"%*[^0-9]%d\"",
            "&ifNo"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nopenvzGenerateVethName(int veid, char *dev_name_ve)\n{\n    int     ifNo = 0;\n    char    *ret;\n\n    if (sscanf(dev_name_ve, \"%*[^0-9]%d\", &ifNo) != 1)\n        return NULL;\n    ret = g_strdup_printf(\"veth%d.%d.\", veid, ifNo);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainReboot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "613-646",
    "snippet": "static int openvzDomainReboot(virDomainPtr dom,\n                              unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"restart\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n    ret = 0;\n\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_BOOTED);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_RUNNING",
            "VIR_DOMAIN_RUNNING_BOOTED"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domain is not in running state\")"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domain is not in running state\""
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "&status",
            "NULL"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int openvzDomainReboot(virDomainPtr dom,\n                              unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"restart\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n    ret = 0;\n\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_BOOTED);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainDestroyFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "607-611",
    "snippet": "static int\nopenvzDomainDestroyFlags(virDomainPtr dom, unsigned int flags)\n{\n    return openvzDomainShutdownFlags(dom, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainShutdownFlags",
          "args": [
            "dom",
            "flags"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainShutdownFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "557-593",
          "snippet": "static int\nopenvzDomainShutdownFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"stop\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->def->id = -1;\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, VIR_DOMAIN_SHUTOFF_SHUTDOWN);\n    dom->id = -1;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainShutdownFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"stop\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->def->id = -1;\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, VIR_DOMAIN_SHUTOFF_SHUTDOWN);\n    dom->id = -1;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainDestroyFlags(virDomainPtr dom, unsigned int flags)\n{\n    return openvzDomainShutdownFlags(dom, flags);\n}"
  },
  {
    "function_name": "openvzDomainDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "601-605",
    "snippet": "static int\nopenvzDomainDestroy(virDomainPtr dom)\n{\n    return openvzDomainShutdownFlags(dom, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainShutdownFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainShutdownFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "557-593",
          "snippet": "static int\nopenvzDomainShutdownFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"stop\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->def->id = -1;\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, VIR_DOMAIN_SHUTOFF_SHUTDOWN);\n    dom->id = -1;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainShutdownFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"stop\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->def->id = -1;\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, VIR_DOMAIN_SHUTOFF_SHUTDOWN);\n    dom->id = -1;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainDestroy(virDomainPtr dom)\n{\n    return openvzDomainShutdownFlags(dom, 0);\n}"
  },
  {
    "function_name": "openvzDomainShutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "595-599",
    "snippet": "static int\nopenvzDomainShutdown(virDomainPtr dom)\n{\n    return openvzDomainShutdownFlags(dom, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDomainShutdownFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainShutdownFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "557-593",
          "snippet": "static int\nopenvzDomainShutdownFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"stop\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->def->id = -1;\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, VIR_DOMAIN_SHUTOFF_SHUTDOWN);\n    dom->id = -1;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [
            "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainShutdownFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"stop\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->def->id = -1;\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, VIR_DOMAIN_SHUTOFF_SHUTDOWN);\n    dom->id = -1;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainShutdown(virDomainPtr dom)\n{\n    return openvzDomainShutdownFlags(dom, 0);\n}"
  },
  {
    "function_name": "openvzDomainShutdownFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "557-593",
    "snippet": "static int\nopenvzDomainShutdownFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"stop\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->def->id = -1;\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, VIR_DOMAIN_SHUTOFF_SHUTDOWN);\n    dom->id = -1;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_SHUTOFF",
            "VIR_DOMAIN_SHUTOFF_SHUTDOWN"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domain is not in running state\")"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domain is not in running state\""
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "&status",
            "NULL"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int\nopenvzDomainShutdownFlags(virDomainPtr dom,\n                          unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"stop\", PROGRAM_SENTINEL, NULL};\n    int ret = -1;\n    int status;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &status, NULL) == -1)\n        goto cleanup;\n\n    openvzSetProgramSentinal(prog, vm->def->name);\n    if (status != VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domain is not in running state\"));\n        goto cleanup;\n    }\n\n    if (virRun(prog, NULL) < 0)\n        goto cleanup;\n\n    vm->def->id = -1;\n    virDomainObjSetState(vm, VIR_DOMAIN_SHUTOFF, VIR_DOMAIN_SHUTOFF_SHUTDOWN);\n    dom->id = -1;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainResume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "530-555",
    "snippet": "static int openvzDomainResume(virDomainPtr dom)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"chkpnt\", PROGRAM_SENTINEL, \"--resume\", NULL};\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetState(vm, NULL) == VIR_DOMAIN_PAUSED) {\n        openvzSetProgramSentinal(prog, vm->def->name);\n        if (virRun(prog, NULL) < 0)\n            goto cleanup;\n        virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_UNPAUSED);\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_RUNNING",
            "VIR_DOMAIN_RUNNING_UNPAUSED"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "NULL"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int openvzDomainResume(virDomainPtr dom)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"chkpnt\", PROGRAM_SENTINEL, \"--resume\", NULL};\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetState(vm, NULL) == VIR_DOMAIN_PAUSED) {\n        openvzSetProgramSentinal(prog, vm->def->name);\n        if (virRun(prog, NULL) < 0)\n            goto cleanup;\n        virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, VIR_DOMAIN_RUNNING_UNPAUSED);\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainSuspend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "503-528",
    "snippet": "static int openvzDomainSuspend(virDomainPtr dom)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"chkpnt\", PROGRAM_SENTINEL, \"--suspend\", NULL};\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetState(vm, NULL) != VIR_DOMAIN_PAUSED) {\n        openvzSetProgramSentinal(prog, vm->def->name);\n        if (virRun(prog, NULL) < 0)\n            goto cleanup;\n        virDomainObjSetState(vm, VIR_DOMAIN_PAUSED, VIR_DOMAIN_PAUSED_USER);\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_PAUSED",
            "VIR_DOMAIN_PAUSED_USER"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "prog",
            "NULL"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzSetProgramSentinal",
          "args": [
            "prog",
            "vm->def->name"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetProgramSentinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "491-501",
          "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PROGRAM_SENTINEL ((char *)0x1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "NULL"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int openvzDomainSuspend(virDomainPtr dom)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    const char *prog[] = {VZCTL, \"--quiet\", \"chkpnt\", PROGRAM_SENTINEL, \"--suspend\", NULL};\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetState(vm, NULL) != VIR_DOMAIN_PAUSED) {\n        openvzSetProgramSentinal(prog, vm->def->name);\n        if (virRun(prog, NULL) < 0)\n            goto cleanup;\n        virDomainObjSetState(vm, VIR_DOMAIN_PAUSED, VIR_DOMAIN_PAUSED_USER);\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzSetProgramSentinal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "491-501",
    "snippet": "static void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PROGRAM_SENTINEL ((char *)0x1)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PROGRAM_SENTINEL ((char *)0x1)\n\nstatic void openvzSetProgramSentinal(const char **prog, const char *key)\n{\n    const char **tmp = prog;\n    while (tmp && *tmp) {\n        if (*tmp == PROGRAM_SENTINEL) {\n            *tmp = key;\n            break;\n        }\n        tmp++;\n    }\n}"
  },
  {
    "function_name": "openvzDomainGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "466-481",
    "snippet": "static char *openvzDomainGetXMLDesc(virDomainPtr dom, unsigned int flags) {\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_XML_COMMON_FLAGS, NULL);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return NULL;\n\n    ret = virDomainDefFormat(vm->def, driver->xmlopt,\n                             virDomainDefFormatConvertXMLFlags(flags));\n\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
      "static int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormat",
          "args": [
            "vm->def",
            "driver->xmlopt",
            "virDomainDefFormatConvertXMLFlags(flags)"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29496-29508",
          "snippet": "char *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)\n\nchar *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormatConvertXMLFlags",
          "args": [
            "flags"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormatConvertXMLFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29481-29493",
          "snippet": "unsigned int virDomainDefFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n    if (flags & VIR_DOMAIN_XML_INACTIVE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n    if (flags & VIR_DOMAIN_XML_MIGRATABLE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_MIGRATABLE;\n\n    return formatFlags;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int virDomainDefFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n    if (flags & VIR_DOMAIN_XML_INACTIVE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n    if (flags & VIR_DOMAIN_XML_MIGRATABLE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_MIGRATABLE;\n\n    return formatFlags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_XML_COMMON_FLAGS",
            "NULL"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzDomainSetVcpusInternal(virDomainObjPtr vm,\n                                        unsigned int nvcpus,\n                                        virDomainXMLOptionPtr xmlopt);\n\nstatic char *openvzDomainGetXMLDesc(virDomainPtr dom, unsigned int flags) {\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_XML_COMMON_FLAGS, NULL);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return NULL;\n\n    ret = virDomainDefFormat(vm->def, driver->xmlopt,\n                             virDomainDefFormatConvertXMLFlags(flags));\n\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainIsUpdated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "461-464",
    "snippet": "static int openvzDomainIsUpdated(virDomainPtr dom G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int openvzDomainIsUpdated(virDomainPtr dom G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "openvzDomainIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "446-459",
    "snippet": "static int openvzDomainIsPersistent(virDomainPtr dom)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    ret = obj->persistent;\n\n    virDomainObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int openvzDomainIsPersistent(virDomainPtr dom)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    ret = obj->persistent;\n\n    virDomainObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "430-443",
    "snippet": "static int openvzDomainIsActive(virDomainPtr dom)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    ret = virDomainObjIsActive(obj);\n\n    virDomainObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "obj"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic int openvzDomainIsActive(virDomainPtr dom)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    ret = virDomainObjIsActive(obj);\n\n    virDomainObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainGetState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "408-427",
    "snippet": "static int\nopenvzDomainGetState(virDomainPtr dom,\n                     int *state,\n                     int *reason,\n                     unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    ret = openvzGetVEStatus(vm, state, reason);\n\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
      "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "state",
            "reason"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzDomainGetState(virDomainPtr dom,\n                     int *state,\n                     int *reason,\n                     unsigned int flags)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    ret = openvzGetVEStatus(vm, state, reason);\n\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "372-405",
    "snippet": "static int openvzDomainGetInfo(virDomainPtr dom,\n                               virDomainInfoPtr info)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    int state;\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &state, NULL) == -1)\n        goto cleanup;\n    info->state = state;\n\n    if (info->state != VIR_DOMAIN_RUNNING) {\n        info->cpuTime = 0;\n    } else {\n        if (openvzGetProcessInfo(&(info->cpuTime), dom->id) < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"cannot read cputime for domain %d\"), dom->id);\n            goto cleanup;\n        }\n    }\n\n    info->maxMem = virDomainDefGetMemoryTotal(vm->def);\n    info->memory = vm->def->mem.cur_balloon;\n    info->nrVirtCpu = virDomainDefGetVcpus(vm->def);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);",
      "static int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpus",
          "args": [
            "vm->def"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1912-1924",
          "snippet": "unsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "vm->def"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"cannot read cputime for domain %d\")",
            "dom->id"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot read cputime for domain %d\""
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetProcessInfo",
          "args": [
            "&(info->cpuTime)",
            "dom->id"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetProcessInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1480-1529",
          "snippet": "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid)\n{\n    FILE *fp;\n    char *line = NULL;\n    size_t line_size = 0;\n    unsigned long long usertime, systime, nicetime;\n    int readvps = vpsid + 1;  /* ensure readvps is initially different */\n    ssize_t ret;\n    int err = 0;\n\n/* read statistic from /proc/vz/vestat.\n sample:\nVersion: 2.2\n   VEID     user      nice     system     uptime                 idle   other..\n     33       78         0       1330   59454597      142650441835148   other..\n     55      178         0       5340   59424597      542650441835148   other..\n*/\n\n    if ((fp = fopen(\"/proc/vz/vestat\", \"r\")) == NULL)\n        return -1;\n\n    /* search line with VEID=vpsid */\n    while (1) {\n        ret = getline(&line, &line_size, fp);\n        if (ret < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (sscanf(line, \"%d %llu %llu %llu\",\n                   &readvps, &usertime, &nicetime, &systime) == 4\n            && readvps == vpsid) { /* found vpsid */\n            /* convert jiffies to nanoseconds */\n            *cpuTime = (1000ull * 1000ull * 1000ull\n                        * (usertime + nicetime  + systime)\n                        / (unsigned long long)sysconf(_SC_CLK_TCK));\n            break;\n        }\n    }\n\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    if (err)\n        return -1;\n\n    if (readvps != vpsid) /*not found*/\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid)\n{\n    FILE *fp;\n    char *line = NULL;\n    size_t line_size = 0;\n    unsigned long long usertime, systime, nicetime;\n    int readvps = vpsid + 1;  /* ensure readvps is initially different */\n    ssize_t ret;\n    int err = 0;\n\n/* read statistic from /proc/vz/vestat.\n sample:\nVersion: 2.2\n   VEID     user      nice     system     uptime                 idle   other..\n     33       78         0       1330   59454597      142650441835148   other..\n     55      178         0       5340   59424597      542650441835148   other..\n*/\n\n    if ((fp = fopen(\"/proc/vz/vestat\", \"r\")) == NULL)\n        return -1;\n\n    /* search line with VEID=vpsid */\n    while (1) {\n        ret = getline(&line, &line_size, fp);\n        if (ret < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (sscanf(line, \"%d %llu %llu %llu\",\n                   &readvps, &usertime, &nicetime, &systime) == 4\n            && readvps == vpsid) { /* found vpsid */\n            /* convert jiffies to nanoseconds */\n            *cpuTime = (1000ull * 1000ull * 1000ull\n                        * (usertime + nicetime  + systime)\n                        / (unsigned long long)sysconf(_SC_CLK_TCK));\n            break;\n        }\n    }\n\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    if (err)\n        return -1;\n\n    if (readvps != vpsid) /*not found*/\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVEStatus",
          "args": [
            "vm",
            "&state",
            "NULL"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVEStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "1758-1798",
          "snippet": "static int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason);\n\nstatic int\nopenvzGetVEStatus(virDomainObjPtr vm, int *status, int *reason)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *line;\n    int state;\n    int ret = -1;\n\n    cmd = virCommandNewArgList(VZLIST, vm->def->name, \"-ostatus\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if ((line = strchr(outbuf, '\\n')) == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to parse vzlist output\"));\n        goto cleanup;\n    }\n    *line++ = '\\0';\n\n    state = virDomainObjGetState(vm, reason);\n\n    if (STREQ(outbuf, \"running\")) {\n        /* There is no way to detect whether a domain is paused or not\n         * with vzlist */\n        if (state == VIR_DOMAIN_PAUSED)\n            *status = state;\n        else\n            *status = VIR_DOMAIN_RUNNING;\n    } else {\n        *status = VIR_DOMAIN_SHUTOFF;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(outbuf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\nstatic int openvzDomainSetMemoryInternal(virDomainObjPtr vm,\n                                         unsigned long long memory);\n\nstatic int openvzDomainGetInfo(virDomainPtr dom,\n                               virDomainInfoPtr info)\n{\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    int state;\n    int ret = -1;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return -1;\n\n    if (openvzGetVEStatus(vm, &state, NULL) == -1)\n        goto cleanup;\n    info->state = state;\n\n    if (info->state != VIR_DOMAIN_RUNNING) {\n        info->cpuTime = 0;\n    } else {\n        if (openvzGetProcessInfo(&(info->cpuTime), dom->id) < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"cannot read cputime for domain %d\"), dom->id);\n            goto cleanup;\n        }\n    }\n\n    info->maxMem = virDomainDefGetMemoryTotal(vm->def);\n    info->memory = vm->def->mem.cur_balloon;\n    info->nrVirtCpu = virDomainDefGetVcpus(vm->def);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "348-370",
    "snippet": "static virDomainPtr openvzDomainLookupByName(virConnectPtr conn,\n                                             const char *name)\n{\n    struct openvz_driver *driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    openvzDriverLock(driver);\n    vm = virDomainObjListFindByName(driver->domains, name);\n    openvzDriverUnlock(driver);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), name);\n        goto cleanup;\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching name '%s'\")",
            "name"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching name '%s'\""
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByName",
          "args": [
            "driver->domains",
            "name"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "205-222",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic virDomainPtr openvzDomainLookupByName(virConnectPtr conn,\n                                             const char *name)\n{\n    struct openvz_driver *driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    openvzDriverLock(driver);\n    vm = virDomainObjListFindByName(driver->domains, name);\n    openvzDriverUnlock(driver);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), name);\n        goto cleanup;\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "openvzDomainLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "332-346",
    "snippet": "static virDomainPtr openvzDomainLookupByUUID(virConnectPtr conn,\n                                             const unsigned char *uuid)\n{\n    struct  openvz_driver *driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    if (!(vm = openvzDomObjFromDomain(driver, uuid)))\n        return NULL;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "uuid"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic virDomainPtr openvzDomainLookupByUUID(virConnectPtr conn,\n                                             const unsigned char *uuid)\n{\n    struct  openvz_driver *driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    if (!(vm = openvzDomObjFromDomain(driver, uuid)))\n        return NULL;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "openvzDomainGetOSType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "316-329",
    "snippet": "static char *openvzDomainGetOSType(virDomainPtr dom)\n{\n    struct  openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return NULL;\n\n    ret = g_strdup(virDomainOSTypeToString(vm->def->os.type));\n\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);",
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "virDomainOSTypeToString(vm->def->os.type)"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainOSTypeToString",
          "args": [
            "vm->def->os.type"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic char *openvzDomainGetOSType(virDomainPtr dom)\n{\n    struct  openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return NULL;\n\n    ret = g_strdup(virDomainOSTypeToString(vm->def->os.type));\n\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "openvzConnectGetHostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "310-313",
    "snippet": "static char *openvzConnectGetHostname(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return virGetHostname();\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetHostname",
          "args": [],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostnameQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "560-564",
          "snippet": "char *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *openvzConnectGetHostname(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return virGetHostname();\n}"
  },
  {
    "function_name": "openvzConnectGetVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "300-307",
    "snippet": "static int openvzConnectGetVersion(virConnectPtr conn, unsigned long *version)\n{\n    struct  openvz_driver *driver = conn->privateData;\n    openvzDriverLock(driver);\n    *version = driver->version;\n    openvzDriverUnlock(driver);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetVersion(virConnectPtr conn, unsigned long *version)\n{\n    struct  openvz_driver *driver = conn->privateData;\n    openvzDriverLock(driver);\n    *version = driver->version;\n    openvzDriverUnlock(driver);\n    return 0;\n}"
  },
  {
    "function_name": "openvzDomainLookupByID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "276-298",
    "snippet": "static virDomainPtr openvzDomainLookupByID(virConnectPtr conn,\n                                           int id)\n{\n    struct openvz_driver *driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    openvzDriverLock(driver);\n    vm = virDomainObjListFindByID(driver->domains, id);\n    openvzDriverUnlock(driver);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching id '%d'\"), id);\n        goto cleanup;\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching id '%d'\")",
            "id"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching id '%d'\""
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByID",
          "args": [
            "driver->domains",
            "id"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "114-134",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByID(virDomainObjListPtr doms,\n                         int id)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virHashSearch(doms->objs, virDomainObjListSearchID, &id, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(doms);\n    if (obj) {\n        virObjectLock(obj);\n        if (obj->removing) {\n            virObjectUnlock(obj);\n            virObjectUnref(obj);\n            obj = NULL;\n        }\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByID(virDomainObjListPtr doms,\n                         int id)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virHashSearch(doms->objs, virDomainObjListSearchID, &id, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(doms);\n    if (obj) {\n        virObjectLock(obj);\n        if (obj->removing) {\n            virObjectUnlock(obj);\n            virObjectUnref(obj);\n            obj = NULL;\n        }\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic virDomainPtr openvzDomainLookupByID(virConnectPtr conn,\n                                           int id)\n{\n    struct openvz_driver *driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    openvzDriverLock(driver);\n    vm = virDomainObjListFindByID(driver->domains, id);\n    openvzDriverUnlock(driver);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching id '%d'\"), id);\n        goto cleanup;\n    }\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "openvzDomainGetHostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "248-273",
    "snippet": "static char *\nopenvzDomainGetHostname(virDomainPtr dom, unsigned int flags)\n{\n    char *hostname = NULL;\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n\n    virCheckFlags(0, NULL);\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return NULL;\n\n    hostname = openvzVEGetStringParam(dom, \"hostname\");\n    if (hostname == NULL)\n        goto cleanup;\n\n    /* vzlist prints an unset hostname as '-' */\n    if (STREQ(hostname, \"-\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Hostname of '%s' is unset\"), vm->def->name);\n        VIR_FREE(hostname);\n    }\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return hostname;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzDomainGetMaxVcpus(virDomainPtr dom);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "hostname"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"Hostname of '%s' is unset\")",
            "vm->def->name"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Hostname of '%s' is unset\""
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "hostname",
            "\"-\""
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzVEGetStringParam",
          "args": [
            "dom",
            "\"hostname\""
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "openvzVEGetStringParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_util.c",
          "lines": "57-84",
          "snippet": "char*\nopenvzVEGetStringParam(virDomainPtr domain, const char* param)\n{\n    int len;\n    char *output = NULL;\n\n    virCommandPtr cmd = virCommandNewArgList(VZLIST,\n                                             \"-o\",\n                                             param,\n                                             domain->name,\n                                             \"-H\", NULL);\n\n    virCommandSetOutputBuffer(cmd, &output);\n    if (virCommandRun(cmd, NULL) < 0) {\n        VIR_FREE(output);\n        /* virCommandRun sets the virError */\n        goto cleanup;\n    }\n\n    /* delete trailing newline */\n    len = strlen(output);\n    if (len && output[len - 1] == '\\n')\n        output[len - 1] = '\\0';\n\n cleanup:\n    virCommandFree(cmd);\n    return output;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar*\nopenvzVEGetStringParam(virDomainPtr domain, const char* param)\n{\n    int len;\n    char *output = NULL;\n\n    virCommandPtr cmd = virCommandNewArgList(VZLIST,\n                                             \"-o\",\n                                             param,\n                                             domain->name,\n                                             \"-H\", NULL);\n\n    virCommandSetOutputBuffer(cmd, &output);\n    if (virCommandRun(cmd, NULL) < 0) {\n        VIR_FREE(output);\n        /* virCommandRun sets the virError */\n        goto cleanup;\n    }\n\n    /* delete trailing newline */\n    len = strlen(output);\n    if (len && output[len - 1] == '\\n')\n        output[len - 1] = '\\0';\n\n cleanup:\n    virCommandFree(cmd);\n    return output;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomain",
          "args": [
            "driver",
            "dom->uuid"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "100-110",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzDomainGetMaxVcpus(virDomainPtr dom);\n\nstatic char *\nopenvzDomainGetHostname(virDomainPtr dom, unsigned int flags)\n{\n    char *hostname = NULL;\n    struct openvz_driver *driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n\n    virCheckFlags(0, NULL);\n    if (!(vm = openvzDomObjFromDomain(driver, dom->uuid)))\n        return NULL;\n\n    hostname = openvzVEGetStringParam(dom, \"hostname\");\n    if (hostname == NULL)\n        goto cleanup;\n\n    /* vzlist prints an unset hostname as '-' */\n    if (STREQ(hostname, \"-\")) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"Hostname of '%s' is unset\"), vm->def->name);\n        VIR_FREE(hostname);\n    }\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return hostname;\n}"
  },
  {
    "function_name": "openvzSetDiskQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "204-245",
    "snippet": "static int\nopenvzSetDiskQuota(virDomainDefPtr vmdef,\n                   virDomainFSDefPtr fss,\n                   bool persist)\n{\n    int ret = -1;\n    unsigned long long sl, hl;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"set\",\n                                             vmdef->name,\n                                             NULL);\n    if (persist)\n        virCommandAddArg(cmd, \"--save\");\n\n    if (fss->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        if (fss->space_hard_limit) {\n            hl = VIR_DIV_UP(fss->space_hard_limit, 1024);\n            virCommandAddArg(cmd, \"--diskspace\");\n\n            if (fss->space_soft_limit) {\n                sl = VIR_DIV_UP(fss->space_soft_limit, 1024);\n                virCommandAddArgFormat(cmd, \"%lld:%lld\", sl, hl);\n            } else {\n                virCommandAddArgFormat(cmd, \"%lld\", hl);\n            }\n        } else if (fss->space_soft_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Can't set soft limit without hard limit\"));\n            goto cleanup;\n        }\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Can't set soft limit without hard limit\")"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Can't set soft limit without hard limit\""
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArgFormat",
          "args": [
            "cmd",
            "\"%lld\"",
            "hl"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1569-1590",
          "snippet": "void\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DIV_UP",
          "args": [
            "fss->space_soft_limit",
            "1024"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandAddArg",
          "args": [
            "cmd",
            "\"--diskspace\""
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1655-1684",
          "snippet": "void\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DIV_UP",
          "args": [
            "fss->space_hard_limit",
            "1024"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZCTL",
            "\"--quiet\"",
            "\"set\"",
            "vmdef->name",
            "NULL"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int\nopenvzSetDiskQuota(virDomainDefPtr vmdef,\n                   virDomainFSDefPtr fss,\n                   bool persist)\n{\n    int ret = -1;\n    unsigned long long sl, hl;\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"set\",\n                                             vmdef->name,\n                                             NULL);\n    if (persist)\n        virCommandAddArg(cmd, \"--save\");\n\n    if (fss->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        if (fss->space_hard_limit) {\n            hl = VIR_DIV_UP(fss->space_hard_limit, 1024);\n            virCommandAddArg(cmd, \"--diskspace\");\n\n            if (fss->space_soft_limit) {\n                sl = VIR_DIV_UP(fss->space_soft_limit, 1024);\n                virCommandAddArgFormat(cmd, \"%lld:%lld\", sl, hl);\n            } else {\n                virCommandAddArgFormat(cmd, \"%lld\", hl);\n            }\n        } else if (fss->space_soft_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Can't set soft limit without hard limit\"));\n            goto cleanup;\n        }\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virCommandFree(cmd);\n\n    return ret;\n}"
  },
  {
    "function_name": "openvzSetInitialConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "144-201",
    "snippet": "static int openvzSetInitialConfig(virDomainDefPtr vmdef)\n{\n    int ret = -1;\n    int vpsid;\n    char * confdir = NULL;\n    virCommandPtr cmd = NULL;\n\n    if (vmdef->nfss > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only one filesystem supported\"));\n        goto cleanup;\n    }\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_TEMPLATE &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filesystem is not of type 'template' or 'mount'\"));\n        goto cleanup;\n    }\n\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n\n        if (virStrToLong_i(vmdef->name, NULL, 10, &vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not convert domain name to VEID\"));\n            goto cleanup;\n        }\n\n        if (openvzCopyDefaultConfig(vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not copy default config\"));\n            goto cleanup;\n        }\n\n        if (openvzWriteVPSConfigParam(vpsid, \"VE_PRIVATE\", vmdef->fss[0]->src->path) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set the source dir for the filesystem\"));\n            goto cleanup;\n        }\n    } else {\n        cmd = openvzDomainDefineCmd(vmdef);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(confdir);\n    virCommandFree(cmd);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);",
      "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "confdir"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomainDefineCmd",
          "args": [
            "vmdef"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomainDefineCmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "118-141",
          "snippet": "static virCommandPtr\nopenvzDomainDefineCmd(virDomainDefPtr vmdef)\n{\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"create\",\n                                             NULL);\n\n    if (vmdef == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Container is not defined\"));\n        virCommandFree(cmd);\n        return NULL;\n    }\n\n    virCommandAddArgList(cmd, vmdef->name, \"--name\", vmdef->name, NULL);\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        virCommandAddArgList(cmd, \"--ostemplate\", vmdef->fss[0]->src, NULL);\n    }\n\n    return cmd;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic virCommandPtr\nopenvzDomainDefineCmd(virDomainDefPtr vmdef)\n{\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"create\",\n                                             NULL);\n\n    if (vmdef == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Container is not defined\"));\n        virCommandFree(cmd);\n        return NULL;\n    }\n\n    virCommandAddArgList(cmd, vmdef->name, \"--name\", vmdef->name, NULL);\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        virCommandAddArgList(cmd, \"--ostemplate\", vmdef->fss[0]->src, NULL);\n    }\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not set the source dir for the filesystem\")"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not set the source dir for the filesystem\""
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzWriteVPSConfigParam",
          "args": [
            "vpsid",
            "\"VE_PRIVATE\"",
            "vmdef->fss[0]->src->path"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "openvzWriteVPSConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "673-685",
          "snippet": "int\nopenvzWriteVPSConfigParam(int vpsid, const char *param, const char *value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzWriteConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzWriteVPSConfigParam(int vpsid, const char *param, const char *value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzWriteConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not copy default config\")"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzCopyDefaultConfig",
          "args": [
            "vpsid"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "openvzCopyDefaultConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "805-837",
          "snippet": "int\nopenvzCopyDefaultConfig(int vpsid)\n{\n    char *confdir = NULL;\n    char *default_conf_file = NULL;\n    char *configfile_value = NULL;\n    char *conf_file = NULL;\n    int ret = -1;\n\n    if (openvzReadConfigParam(VZ_CONF_FILE, \"CONFIGFILE\", &configfile_value) < 0)\n        goto cleanup;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        goto cleanup;\n\n    default_conf_file = g_strdup_printf(\"%s/ve-%s.conf-sample\", confdir,\n                                        configfile_value);\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        goto cleanup;\n\n    if (openvz_copyfile(default_conf_file, conf_file)<0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(confdir);\n    VIR_FREE(default_conf_file);\n    VIR_FREE(configfile_value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);",
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzCopyDefaultConfig(int vpsid)\n{\n    char *confdir = NULL;\n    char *default_conf_file = NULL;\n    char *configfile_value = NULL;\n    char *conf_file = NULL;\n    int ret = -1;\n\n    if (openvzReadConfigParam(VZ_CONF_FILE, \"CONFIGFILE\", &configfile_value) < 0)\n        goto cleanup;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        goto cleanup;\n\n    default_conf_file = g_strdup_printf(\"%s/ve-%s.conf-sample\", confdir,\n                                        configfile_value);\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        goto cleanup;\n\n    if (openvz_copyfile(default_conf_file, conf_file)<0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(confdir);\n    VIR_FREE(default_conf_file);\n    VIR_FREE(configfile_value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not convert domain name to VEID\")"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "vmdef->name",
            "NULL",
            "10",
            "&vpsid"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"filesystem is not of type 'template' or 'mount'\")"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"only one filesystem supported\")"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzGetProcessInfo(unsigned long long *cpuTime, int vpsid);\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic int openvzSetInitialConfig(virDomainDefPtr vmdef)\n{\n    int ret = -1;\n    int vpsid;\n    char * confdir = NULL;\n    virCommandPtr cmd = NULL;\n\n    if (vmdef->nfss > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"only one filesystem supported\"));\n        goto cleanup;\n    }\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_TEMPLATE &&\n        vmdef->fss[0]->type != VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"filesystem is not of type 'template' or 'mount'\"));\n        goto cleanup;\n    }\n\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_MOUNT)\n    {\n\n        if (virStrToLong_i(vmdef->name, NULL, 10, &vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not convert domain name to VEID\"));\n            goto cleanup;\n        }\n\n        if (openvzCopyDefaultConfig(vpsid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not copy default config\"));\n            goto cleanup;\n        }\n\n        if (openvzWriteVPSConfigParam(vpsid, \"VE_PRIVATE\", vmdef->fss[0]->src->path) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Could not set the source dir for the filesystem\"));\n            goto cleanup;\n        }\n    } else {\n        cmd = openvzDomainDefineCmd(vmdef);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(confdir);\n    virCommandFree(cmd);\n\n    return ret;\n}"
  },
  {
    "function_name": "openvzDomainDefineCmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "118-141",
    "snippet": "static virCommandPtr\nopenvzDomainDefineCmd(virDomainDefPtr vmdef)\n{\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"create\",\n                                             NULL);\n\n    if (vmdef == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Container is not defined\"));\n        virCommandFree(cmd);\n        return NULL;\n    }\n\n    virCommandAddArgList(cmd, vmdef->name, \"--name\", vmdef->name, NULL);\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        virCommandAddArgList(cmd, \"--ostemplate\", vmdef->fss[0]->src, NULL);\n    }\n\n    return cmd;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCommandAddArgList",
          "args": [
            "cmd",
            "\"--ostemplate\"",
            "vmdef->fss[0]->src",
            "NULL"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1655-1684",
          "snippet": "void\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Container is not defined\")"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Container is not defined\""
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZCTL",
            "\"--quiet\"",
            "\"create\"",
            "NULL"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int openvzConnectGetMaxVcpus(virConnectPtr conn, const char *type);\n\nstatic virCommandPtr\nopenvzDomainDefineCmd(virDomainDefPtr vmdef)\n{\n    virCommandPtr cmd = virCommandNewArgList(VZCTL,\n                                             \"--quiet\",\n                                             \"create\",\n                                             NULL);\n\n    if (vmdef == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Container is not defined\"));\n        virCommandFree(cmd);\n        return NULL;\n    }\n\n    virCommandAddArgList(cmd, vmdef->name, \"--name\", vmdef->name, NULL);\n\n    if (vmdef->nfss == 1 &&\n        vmdef->fss[0]->type == VIR_DOMAIN_FS_TYPE_TEMPLATE) {\n        virCommandAddArgList(cmd, \"--ostemplate\", vmdef->fss[0]->src, NULL);\n    }\n\n    return cmd;\n}"
  },
  {
    "function_name": "openvzDomObjFromDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "100-110",
    "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "73-76",
          "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDomObjFromDomainLocked",
          "args": [
            "driver",
            "uuid"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDomObjFromDomainLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "81-97",
          "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomainLocked(struct openvz_driver *driver,\n                             const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(vm = virDomainObjListFindByUUID(driver->domains, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomainLocked(struct openvz_driver *driver,\n                             const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(vm = virDomainObjListFindByUUID(driver->domains, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzDriverLock",
          "args": [
            "driver"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "openvzDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
          "lines": "68-71",
          "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"viruri.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomain(struct openvz_driver *driver,\n                       const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n\n    openvzDriverLock(driver);\n    vm = openvzDomObjFromDomainLocked(driver, uuid);\n    openvzDriverUnlock(driver);\n    return vm;\n}"
  },
  {
    "function_name": "openvzDomObjFromDomainLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "81-97",
    "snippet": "static virDomainObjPtr\nopenvzDomObjFromDomainLocked(struct openvz_driver *driver,\n                             const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(vm = virDomainObjListFindByUUID(driver->domains, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    return vm;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching uuid '%s'\")",
            "uuidstr"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching uuid '%s'\""
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByUUID",
          "args": [
            "driver->domains",
            "uuid"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "162-179",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nopenvzDomObjFromDomainLocked(struct openvz_driver *driver,\n                             const unsigned char *uuid)\n{\n    virDomainObjPtr vm;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(vm = virDomainObjListFindByUUID(driver->domains, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    return vm;\n}"
  },
  {
    "function_name": "openvzDriverUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "73-76",
    "snippet": "static void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&driver->lock"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverUnlock(struct openvz_driver *driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
  },
  {
    "function_name": "openvzDriverLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_driver.c",
    "lines": "68-71",
    "snippet": "static void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"viruri.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_driver.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&driver->lock"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virnetdevtap.h\"\n#include \"viruri.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"openvz_conf.h\"\n#include \"virbuffer.h\"\n#include \"openvz_util.h\"\n#include \"openvz_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void openvzDriverLock(struct openvz_driver *driver)\n{\n    virMutexLock(&driver->lock);\n}"
  }
]