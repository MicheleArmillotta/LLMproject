[
  {
    "function_name": "virNWFilterBindingRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "820-832",
    "snippet": "int\nvirNWFilterBindingRef(virNWFilterBindingPtr binding)\n{\n    VIR_DEBUG(\"binding=%p refs=%d\", binding,\n              binding ? binding->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, -1);\n\n    virObjectRef(binding);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "binding"
          ],
          "line": 830
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterBindingReturn",
          "args": [
            "binding",
            "-1"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"binding=%p refs=%d\"",
            "binding",
            "binding ? binding->parent.u.s.refs : 0"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingRef(virNWFilterBindingPtr binding)\n{\n    VIR_DEBUG(\"binding=%p refs=%d\", binding,\n              binding ? binding->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, -1);\n\n    virObjectRef(binding);\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterBindingGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "776-800",
    "snippet": "char *\nvirNWFilterBindingGetXMLDesc(virNWFilterBindingPtr binding, unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"binding=%p, flags=0x%x\", binding, flags);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, NULL);\n    conn = binding->conn;\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingGetXMLDesc) {\n        char *ret;\n        ret = conn->nwfilterDriver->nwfilterBindingGetXMLDesc(binding, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(binding->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "binding->conn"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterBindingGetXMLDesc",
          "args": [
            "binding",
            "flags"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterBindingGetXMLDesc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "724-751",
          "snippet": "static char *\nnwfilterBindingGetXMLDesc(virNWFilterBindingPtr binding,\n                          unsigned int flags)\n{\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings,\n                                                 binding->portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), binding->portdev);\n        goto cleanup;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingGetXMLDescEnsureACL(binding->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNWFilterBindingDefFormat(def);\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic char *\nnwfilterBindingGetXMLDesc(virNWFilterBindingPtr binding,\n                          unsigned int flags)\n{\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings,\n                                                 binding->portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), binding->portdev);\n        goto cleanup;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingGetXMLDescEnsureACL(binding->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNWFilterBindingDefFormat(def);\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterBindingReturn",
          "args": [
            "binding",
            "NULL"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"binding=%p, flags=0x%x\"",
            "binding",
            "flags"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirNWFilterBindingGetXMLDesc(virNWFilterBindingPtr binding, unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"binding=%p, flags=0x%x\", binding, flags);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, NULL);\n    conn = binding->conn;\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingGetXMLDesc) {\n        char *ret;\n        ret = conn->nwfilterDriver->nwfilterBindingGetXMLDesc(binding, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(binding->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterBindingDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "736-762",
    "snippet": "int\nvirNWFilterBindingDelete(virNWFilterBindingPtr binding)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, -1);\n    conn = binding->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingDelete) {\n        int ret;\n        ret = conn->nwfilterDriver->nwfilterBindingDelete(binding);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(binding->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "binding->conn"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterBindingDelete",
          "args": [
            "binding"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterBindingDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "810-837",
          "snippet": "static int\nnwfilterBindingDelete(virNWFilterBindingPtr binding)\n{\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n    int ret = -1;\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings, binding->portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), binding->portdev);\n        return -1;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingDeleteEnsureACL(binding->conn, def) < 0)\n        goto cleanup;\n\n    virNWFilterTeardownFilter(def);\n    virNWFilterBindingObjDelete(obj, driver->bindingDir);\n    virNWFilterBindingObjListRemove(driver->bindings, obj);\n\n    ret = 0;\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int\nnwfilterBindingDelete(virNWFilterBindingPtr binding)\n{\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n    int ret = -1;\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings, binding->portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), binding->portdev);\n        return -1;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingDeleteEnsureACL(binding->conn, def) < 0)\n        goto cleanup;\n\n    virNWFilterTeardownFilter(def);\n    virNWFilterBindingObjDelete(obj, driver->bindingDir);\n    virNWFilterBindingObjListRemove(driver->bindings, obj);\n\n    ret = 0;\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterBindingReturn",
          "args": [
            "binding",
            "-1"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"binding=%p\"",
            "binding"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingDelete(virNWFilterBindingPtr binding)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, -1);\n    conn = binding->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingDelete) {\n        int ret;\n        ret = conn->nwfilterDriver->nwfilterBindingDelete(binding);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(binding->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNWFilterBindingCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "695-719",
    "snippet": "virNWFilterBindingPtr\nvirNWFilterBindingCreateXML(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s\", conn, NULLSTR(xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingCreateXML) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingCreateXML(conn, xml, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterBindingCreateXML",
          "args": [
            "conn",
            "xml",
            "flags"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterBindingCreateXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "754-800",
          "snippet": "static virNWFilterBindingPtr\nnwfilterBindingCreateXML(virConnectPtr conn,\n                         const char *xml,\n                         unsigned int flags)\n{\n    virNWFilterBindingDefPtr def;\n    virNWFilterBindingObjPtr obj = NULL;\n    virNWFilterBindingPtr ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!driver->privileged) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Can't define NWFilter bindings in session mode\"));\n        return NULL;\n    }\n\n    def = virNWFilterBindingDefParseString(xml);\n    if (!def)\n        return NULL;\n\n    if (virNWFilterBindingCreateXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    obj = virNWFilterBindingObjListAdd(driver->bindings,\n                                       def);\n    if (!obj)\n        goto cleanup;\n\n    if (!(ret = virGetNWFilterBinding(conn, def->portdevname, def->filter)))\n        goto cleanup;\n\n    if (virNWFilterInstantiateFilter(driver, def) < 0) {\n        virNWFilterBindingObjListRemove(driver->bindings, obj);\n        virObjectUnref(ret);\n        ret = NULL;\n        goto cleanup;\n    }\n    virNWFilterBindingObjSave(obj, driver->bindingDir);\n\n cleanup:\n    if (!obj)\n        virNWFilterBindingDefFree(def);\n    virNWFilterBindingObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterBindingPtr\nnwfilterBindingCreateXML(virConnectPtr conn,\n                         const char *xml,\n                         unsigned int flags)\n{\n    virNWFilterBindingDefPtr def;\n    virNWFilterBindingObjPtr obj = NULL;\n    virNWFilterBindingPtr ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!driver->privileged) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Can't define NWFilter bindings in session mode\"));\n        return NULL;\n    }\n\n    def = virNWFilterBindingDefParseString(xml);\n    if (!def)\n        return NULL;\n\n    if (virNWFilterBindingCreateXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    obj = virNWFilterBindingObjListAdd(driver->bindings,\n                                       def);\n    if (!obj)\n        goto cleanup;\n\n    if (!(ret = virGetNWFilterBinding(conn, def->portdevname, def->filter)))\n        goto cleanup;\n\n    if (virNWFilterInstantiateFilter(driver, def) < 0) {\n        virNWFilterBindingObjListRemove(driver->bindings, obj);\n        virObjectUnref(ret);\n        ret = NULL;\n        goto cleanup;\n    }\n    virNWFilterBindingObjSave(obj, driver->bindingDir);\n\n cleanup:\n    if (!obj)\n        virNWFilterBindingDefFree(def);\n    virNWFilterBindingObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xml=%s\"",
            "conn",
            "NULLSTR(xml)"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xml"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterBindingPtr\nvirNWFilterBindingCreateXML(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s\", conn, NULLSTR(xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingCreateXML) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingCreateXML(conn, xml, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterBindingGetFilterName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "661-671",
    "snippet": "const char *\nvirNWFilterBindingGetFilterName(virNWFilterBindingPtr binding)\n{\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, NULL);\n\n    return binding->filtername;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckNWFilterBindingReturn",
          "args": [
            "binding",
            "NULL"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"binding=%p\"",
            "binding"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char *\nvirNWFilterBindingGetFilterName(virNWFilterBindingPtr binding)\n{\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, NULL);\n\n    return binding->filtername;\n}"
  },
  {
    "function_name": "virNWFilterBindingGetPortDev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "639-649",
    "snippet": "const char *\nvirNWFilterBindingGetPortDev(virNWFilterBindingPtr binding)\n{\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, NULL);\n\n    return binding->portdev;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckNWFilterBindingReturn",
          "args": [
            "binding",
            "NULL"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"binding=%p\"",
            "binding"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char *\nvirNWFilterBindingGetPortDev(virNWFilterBindingPtr binding)\n{\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, NULL);\n\n    return binding->portdev;\n}"
  },
  {
    "function_name": "virNWFilterBindingFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "616-627",
    "snippet": "int\nvirNWFilterBindingFree(virNWFilterBindingPtr binding)\n{\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, -1);\n\n    virObjectUnref(binding);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "binding"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterBindingReturn",
          "args": [
            "binding",
            "-1"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"binding=%p\"",
            "binding"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingFree(virNWFilterBindingPtr binding)\n{\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, -1);\n\n    virObjectUnref(binding);\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterBindingLookupByPortDev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "581-604",
    "snippet": "virNWFilterBindingPtr\nvirNWFilterBindingLookupByPortDev(virConnectPtr conn, const char *portdev)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(portdev));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingLookupByPortDev) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingLookupByPortDev(conn, portdev);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterBindingLookupByPortDev",
          "args": [
            "conn",
            "portdev"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterBindingLookupByPortDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "681-706",
          "snippet": "static virNWFilterBindingPtr\nnwfilterBindingLookupByPortDev(virConnectPtr conn,\n                               const char *portdev)\n{\n    virNWFilterBindingPtr ret = NULL;\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings,\n                                                 portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), portdev);\n        goto cleanup;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingLookupByPortDevEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    ret = virGetNWFilterBinding(conn, def->portdevname, def->filter);\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterBindingPtr\nnwfilterBindingLookupByPortDev(virConnectPtr conn,\n                               const char *portdev)\n{\n    virNWFilterBindingPtr ret = NULL;\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings,\n                                                 portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), portdev);\n        goto cleanup;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingLookupByPortDevEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    ret = virGetNWFilterBinding(conn, def->portdevname, def->filter);\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "portdev",
            "error"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, name=%s\"",
            "conn",
            "NULLSTR(portdev)"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "portdev"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterBindingPtr\nvirNWFilterBindingLookupByPortDev(virConnectPtr conn, const char *portdev)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(portdev));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingLookupByPortDev) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingLookupByPortDev(conn, portdev);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virConnectListAllNWFilterBindings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "535-563",
    "snippet": "int\nvirConnectListAllNWFilterBindings(virConnectPtr conn,\n                                  virNWFilterBindingPtr **bindings,\n                                  unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, bindings=%p, flags=0x%x\", conn, bindings, flags);\n\n    virResetLastError();\n\n    if (bindings)\n        *bindings = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nwfilterDriver &&\n        conn->nwfilterDriver->connectListAllNWFilterBindings) {\n        int ret;\n        ret = conn->nwfilterDriver->connectListAllNWFilterBindings(conn, bindings, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->connectListAllNWFilterBindings",
          "args": [
            "conn",
            "bindings",
            "flags"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, bindings=%p, flags=0x%x\"",
            "conn",
            "bindings",
            "flags"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListAllNWFilterBindings(virConnectPtr conn,\n                                  virNWFilterBindingPtr **bindings,\n                                  unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, bindings=%p, flags=0x%x\", conn, bindings, flags);\n\n    virResetLastError();\n\n    if (bindings)\n        *bindings = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nwfilterDriver &&\n        conn->nwfilterDriver->connectListAllNWFilterBindings) {\n        int ret;\n        ret = conn->nwfilterDriver->connectListAllNWFilterBindings(conn, bindings, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNWFilterRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "503-515",
    "snippet": "int\nvirNWFilterRef(virNWFilterPtr nwfilter)\n{\n    VIR_DEBUG(\"nwfilter=%p refs=%d\", nwfilter,\n              nwfilter ? nwfilter->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n\n    virObjectRef(nwfilter);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "nwfilter"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterReturn",
          "args": [
            "nwfilter",
            "-1"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nwfilter=%p refs=%d\"",
            "nwfilter",
            "nwfilter ? nwfilter->parent.u.s.refs : 0"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterRef(virNWFilterPtr nwfilter)\n{\n    VIR_DEBUG(\"nwfilter=%p refs=%d\", nwfilter,\n              nwfilter ? nwfilter->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n\n    virObjectRef(nwfilter);\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "459-483",
    "snippet": "char *\nvirNWFilterGetXMLDesc(virNWFilterPtr nwfilter, unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"nwfilter=%p, flags=0x%x\", nwfilter, flags);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, NULL);\n    conn = nwfilter->conn;\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterGetXMLDesc) {\n        char *ret;\n        ret = conn->nwfilterDriver->nwfilterGetXMLDesc(nwfilter, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(nwfilter->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "nwfilter->conn"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterGetXMLDesc",
          "args": [
            "nwfilter",
            "flags"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterGetXMLDesc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "652-678",
          "snippet": "static char *\nnwfilterGetXMLDesc(virNWFilterPtr nwfilter,\n                   unsigned int flags)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    nwfilterDriverLock();\n    obj = nwfilterObjFromNWFilter(nwfilter->uuid);\n    nwfilterDriverUnlock();\n\n    if (!obj)\n        return NULL;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterGetXMLDescEnsureACL(nwfilter->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNWFilterDefFormat(def);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return ret;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic char *\nnwfilterGetXMLDesc(virNWFilterPtr nwfilter,\n                   unsigned int flags)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    nwfilterDriverLock();\n    obj = nwfilterObjFromNWFilter(nwfilter->uuid);\n    nwfilterDriverUnlock();\n\n    if (!obj)\n        return NULL;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterGetXMLDescEnsureACL(nwfilter->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNWFilterDefFormat(def);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterReturn",
          "args": [
            "nwfilter",
            "NULL"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nwfilter=%p, flags=0x%x\"",
            "nwfilter",
            "flags"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirNWFilterGetXMLDesc(virNWFilterPtr nwfilter, unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"nwfilter=%p, flags=0x%x\", nwfilter, flags);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, NULL);\n    conn = nwfilter->conn;\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterGetXMLDesc) {\n        char *ret;\n        ret = conn->nwfilterDriver->nwfilterGetXMLDesc(nwfilter, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(nwfilter->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "419-445",
    "snippet": "int\nvirNWFilterUndefine(virNWFilterPtr nwfilter)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"nwfilter=%p\", nwfilter);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n    conn = nwfilter->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterUndefine) {\n        int ret;\n        ret = conn->nwfilterDriver->nwfilterUndefine(nwfilter);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(nwfilter->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "nwfilter->conn"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterUndefine",
          "args": [
            "nwfilter"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterUndefine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "611-649",
          "snippet": "static int\nnwfilterUndefine(virNWFilterPtr nwfilter)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    int ret = -1;\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    if (!(obj = nwfilterObjFromNWFilter(nwfilter->uuid)))\n        goto cleanup;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterUndefineEnsureACL(nwfilter->conn, def) < 0)\n        goto cleanup;\n\n    if (virNWFilterObjTestUnassignDef(obj) < 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\",\n                       _(\"nwfilter is in use\"));\n        goto cleanup;\n    }\n\n    if (virNWFilterDeleteDef(driver->configDir, def) < 0)\n        goto cleanup;\n\n    virNWFilterObjListRemove(driver->nwfilters, obj);\n    obj = NULL;\n    ret = 0;\n\n cleanup:\n    if (obj)\n        virNWFilterObjUnlock(obj);\n\n    virNWFilterUnlockFilterUpdates();\n    nwfilterDriverUnlock();\n    return ret;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int\nnwfilterUndefine(virNWFilterPtr nwfilter)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    int ret = -1;\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    if (!(obj = nwfilterObjFromNWFilter(nwfilter->uuid)))\n        goto cleanup;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterUndefineEnsureACL(nwfilter->conn, def) < 0)\n        goto cleanup;\n\n    if (virNWFilterObjTestUnassignDef(obj) < 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\",\n                       _(\"nwfilter is in use\"));\n        goto cleanup;\n    }\n\n    if (virNWFilterDeleteDef(driver->configDir, def) < 0)\n        goto cleanup;\n\n    virNWFilterObjListRemove(driver->nwfilters, obj);\n    obj = NULL;\n    ret = 0;\n\n cleanup:\n    if (obj)\n        virNWFilterObjUnlock(obj);\n\n    virNWFilterUnlockFilterUpdates();\n    nwfilterDriverUnlock();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterReturn",
          "args": [
            "nwfilter",
            "-1"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nwfilter=%p\"",
            "nwfilter"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterUndefine(virNWFilterPtr nwfilter)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"nwfilter=%p\", nwfilter);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n    conn = nwfilter->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterUndefine) {\n        int ret;\n        ret = conn->nwfilterDriver->nwfilterUndefine(nwfilter);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(nwfilter->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNWFilterDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "382-406",
    "snippet": "virNWFilterPtr\nvirNWFilterDefineXML(virConnectPtr conn, const char *xmlDesc)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s\", conn, NULLSTR(xmlDesc));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterDefineXML) {\n        virNWFilterPtr ret;\n        ret = conn->nwfilterDriver->nwfilterDefineXML(conn, xmlDesc);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterDefineXML",
          "args": [
            "conn",
            "xmlDesc"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDefineXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "564-608",
          "snippet": "static virNWFilterPtr\nnwfilterDefineXML(virConnectPtr conn,\n                  const char *xml)\n{\n    virNWFilterDefPtr def;\n    virNWFilterObjPtr obj = NULL;\n    virNWFilterDefPtr objdef;\n    virNWFilterPtr nwfilter = NULL;\n\n    if (!driver->privileged) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Can't define NWFilters in session mode\"));\n        return NULL;\n    }\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    if (!(def = virNWFilterDefParseString(xml)))\n        goto cleanup;\n\n    if (virNWFilterDefineXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (!(obj = virNWFilterObjListAssignDef(driver->nwfilters, def)))\n        goto cleanup;\n    def = NULL;\n    objdef = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterSaveConfig(driver->configDir, objdef) < 0) {\n        virNWFilterObjListRemove(driver->nwfilters, obj);\n        goto cleanup;\n    }\n\n    nwfilter = virGetNWFilter(conn, objdef->name, objdef->uuid);\n\n cleanup:\n    virNWFilterDefFree(def);\n    if (obj)\n        virNWFilterObjUnlock(obj);\n\n    virNWFilterUnlockFilterUpdates();\n    nwfilterDriverUnlock();\n    return nwfilter;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterPtr\nnwfilterDefineXML(virConnectPtr conn,\n                  const char *xml)\n{\n    virNWFilterDefPtr def;\n    virNWFilterObjPtr obj = NULL;\n    virNWFilterDefPtr objdef;\n    virNWFilterPtr nwfilter = NULL;\n\n    if (!driver->privileged) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Can't define NWFilters in session mode\"));\n        return NULL;\n    }\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    if (!(def = virNWFilterDefParseString(xml)))\n        goto cleanup;\n\n    if (virNWFilterDefineXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (!(obj = virNWFilterObjListAssignDef(driver->nwfilters, def)))\n        goto cleanup;\n    def = NULL;\n    objdef = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterSaveConfig(driver->configDir, objdef) < 0) {\n        virNWFilterObjListRemove(driver->nwfilters, obj);\n        goto cleanup;\n    }\n\n    nwfilter = virGetNWFilter(conn, objdef->name, objdef->uuid);\n\n cleanup:\n    virNWFilterDefFree(def);\n    if (obj)\n        virNWFilterObjUnlock(obj);\n\n    virNWFilterUnlockFilterUpdates();\n    nwfilterDriverUnlock();\n    return nwfilter;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmlDesc",
            "error"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xmlDesc=%s\"",
            "conn",
            "NULLSTR(xmlDesc)"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlDesc"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterPtr\nvirNWFilterDefineXML(virConnectPtr conn, const char *xmlDesc)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s\", conn, NULLSTR(xmlDesc));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterDefineXML) {\n        virNWFilterPtr ret;\n        ret = conn->nwfilterDriver->nwfilterDefineXML(conn, xmlDesc);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterGetUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "350-366",
    "snippet": "int\nvirNWFilterGetUUIDString(virNWFilterPtr nwfilter, char *buf)\n{\n    VIR_DEBUG(\"nwfilter=%p, buf=%p\", nwfilter, buf);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(nwfilter->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(nwfilter->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "nwfilter->conn"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "nwfilter->uuid",
            "buf"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "buf",
            "error"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterReturn",
          "args": [
            "nwfilter",
            "-1"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nwfilter=%p, buf=%p\"",
            "nwfilter",
            "buf"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterGetUUIDString(virNWFilterPtr nwfilter, char *buf)\n{\n    VIR_DEBUG(\"nwfilter=%p, buf=%p\", nwfilter, buf);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(nwfilter->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(nwfilter->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNWFilterGetUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "320-337",
    "snippet": "int\nvirNWFilterGetUUID(virNWFilterPtr nwfilter, unsigned char *uuid)\n{\n    VIR_DEBUG(\"nwfilter=%p, uuid=%p\", nwfilter, uuid);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &nwfilter->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(nwfilter->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "nwfilter->conn"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "uuid",
            "&nwfilter->uuid[0]",
            "VIR_UUID_BUFLEN"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterReturn",
          "args": [
            "nwfilter",
            "-1"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nwfilter=%p, uuid=%p\"",
            "nwfilter",
            "uuid"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterGetUUID(virNWFilterPtr nwfilter, unsigned char *uuid)\n{\n    VIR_DEBUG(\"nwfilter=%p, uuid=%p\", nwfilter, uuid);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &nwfilter->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(nwfilter->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNWFilterGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "298-308",
    "snippet": "const char *\nvirNWFilterGetName(virNWFilterPtr nwfilter)\n{\n    VIR_DEBUG(\"nwfilter=%p\", nwfilter);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, NULL);\n\n    return nwfilter->name;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckNWFilterReturn",
          "args": [
            "nwfilter",
            "NULL"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nwfilter=%p\"",
            "nwfilter"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char *\nvirNWFilterGetName(virNWFilterPtr nwfilter)\n{\n    VIR_DEBUG(\"nwfilter=%p\", nwfilter);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, NULL);\n\n    return nwfilter->name;\n}"
  },
  {
    "function_name": "virNWFilterFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "275-286",
    "snippet": "int\nvirNWFilterFree(virNWFilterPtr nwfilter)\n{\n    VIR_DEBUG(\"nwfilter=%p\", nwfilter);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n\n    virObjectUnref(nwfilter);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "nwfilter"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNWFilterReturn",
          "args": [
            "nwfilter",
            "-1"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nwfilter=%p\"",
            "nwfilter"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterFree(virNWFilterPtr nwfilter)\n{\n    VIR_DEBUG(\"nwfilter=%p\", nwfilter);\n\n    virResetLastError();\n\n    virCheckNWFilterReturn(nwfilter, -1);\n\n    virObjectUnref(nwfilter);\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterLookupByUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "240-263",
    "snippet": "virNWFilterPtr\nvirNWFilterLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNWFilterLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterLookupByUUID",
          "args": [
            "conn",
            "&uuid[0]"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterLookupByUUIDString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
          "lines": "240-263",
          "snippet": "virNWFilterPtr\nvirNWFilterLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNWFilterLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "uuidstr",
            "_(\"uuidstr in %s must be a valid UUID\")",
            "__FUNCTION__"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"uuidstr in %s must be a valid UUID\""
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "uuidstr",
            "uuid"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuidstr",
            "error"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, uuidstr=%s\"",
            "conn",
            "NULLSTR(uuidstr)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uuidstr"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterPtr\nvirNWFilterLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNWFilterLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "201-224",
    "snippet": "virNWFilterPtr\nvirNWFilterLookupByUUID(virConnectPtr conn, const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(conn, uuid);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterLookupByUUID) {\n        virNWFilterPtr ret;\n        ret = conn->nwfilterDriver->nwfilterLookupByUUID(conn, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterLookupByUUID",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterLookupByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "457-481",
          "snippet": "static virNWFilterPtr\nnwfilterLookupByUUID(virConnectPtr conn,\n                     const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    virNWFilterPtr nwfilter = NULL;\n\n    nwfilterDriverLock();\n    obj = nwfilterObjFromNWFilter(uuid);\n    nwfilterDriverUnlock();\n\n    if (!obj)\n        return NULL;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    nwfilter = virGetNWFilter(conn, def->name, def->uuid);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return nwfilter;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterPtr\nnwfilterLookupByUUID(virConnectPtr conn,\n                     const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    virNWFilterPtr nwfilter = NULL;\n\n    nwfilterDriverLock();\n    obj = nwfilterObjFromNWFilter(uuid);\n    nwfilterDriverUnlock();\n\n    if (!obj)\n        return NULL;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    nwfilter = virGetNWFilter(conn, def->name, def->uuid);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return nwfilter;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_UUID_DEBUG",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterPtr\nvirNWFilterLookupByUUID(virConnectPtr conn, const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(conn, uuid);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterLookupByUUID) {\n        virNWFilterPtr ret;\n        ret = conn->nwfilterDriver->nwfilterLookupByUUID(conn, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "162-185",
    "snippet": "virNWFilterPtr\nvirNWFilterLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterLookupByName) {\n        virNWFilterPtr ret;\n        ret = conn->nwfilterDriver->nwfilterLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->nwfilterLookupByName",
          "args": [
            "conn",
            "name"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "484-511",
          "snippet": "static virNWFilterPtr\nnwfilterLookupByName(virConnectPtr conn,\n                     const char *name)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    virNWFilterPtr nwfilter = NULL;\n\n    nwfilterDriverLock();\n    obj = virNWFilterObjListFindByName(driver->nwfilters, name);\n    nwfilterDriverUnlock();\n\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching name '%s'\"), name);\n        return NULL;\n    }\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    nwfilter = virGetNWFilter(conn, def->name, def->uuid);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return nwfilter;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterPtr\nnwfilterLookupByName(virConnectPtr conn,\n                     const char *name)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    virNWFilterPtr nwfilter = NULL;\n\n    nwfilterDriverLock();\n    obj = virNWFilterObjListFindByName(driver->nwfilters, name);\n    nwfilterDriverUnlock();\n\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching name '%s'\"), name);\n        return NULL;\n    }\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    nwfilter = virGetNWFilter(conn, def->name, def->uuid);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return nwfilter;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "name",
            "error"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, name=%s\"",
            "conn",
            "NULLSTR(name)"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterPtr\nvirNWFilterLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterLookupByName) {\n        virNWFilterPtr ret;\n        ret = conn->nwfilterDriver->nwfilterLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virConnectListNWFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "122-146",
    "snippet": "int\nvirConnectListNWFilters(virConnectPtr conn, char **const names, int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->connectListNWFilters) {\n        int ret;\n        ret = conn->nwfilterDriver->connectListNWFilters(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->connectListNWFilters",
          "args": [
            "conn",
            "names",
            "maxnames"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, names=%p, maxnames=%d\"",
            "conn",
            "names",
            "maxnames"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListNWFilters(virConnectPtr conn, char **const names, int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->connectListNWFilters) {\n        int ret;\n        ret = conn->nwfilterDriver->connectListNWFilters(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListAllNWFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "81-109",
    "snippet": "int\nvirConnectListAllNWFilters(virConnectPtr conn,\n                           virNWFilterPtr **filters,\n                           unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, filters=%p, flags=0x%x\", conn, filters, flags);\n\n    virResetLastError();\n\n    if (filters)\n        *filters = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nwfilterDriver &&\n        conn->nwfilterDriver->connectListAllNWFilters) {\n        int ret;\n        ret = conn->nwfilterDriver->connectListAllNWFilters(conn, filters, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->connectListAllNWFilters",
          "args": [
            "conn",
            "filters",
            "flags"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, filters=%p, flags=0x%x\"",
            "conn",
            "filters",
            "flags"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListAllNWFilters(virConnectPtr conn,\n                           virNWFilterPtr **filters,\n                           unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, filters=%p, flags=0x%x\", conn, filters, flags);\n\n    virResetLastError();\n\n    if (filters)\n        *filters = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nwfilterDriver &&\n        conn->nwfilterDriver->connectListAllNWFilters) {\n        int ret;\n        ret = conn->nwfilterDriver->connectListAllNWFilters(conn, filters, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNumOfNWFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
    "lines": "39-61",
    "snippet": "int\nvirConnectNumOfNWFilters(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->connectNumOfNWFilters) {\n        int ret;\n        ret = conn->nwfilterDriver->connectNumOfNWFilters(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nwfilterDriver->connectNumOfNWFilters",
          "args": [
            "conn"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNumOfNWFilters(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->connectNumOfNWFilters) {\n        int ret;\n        ret = conn->nwfilterDriver->connectNumOfNWFilters(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  }
]