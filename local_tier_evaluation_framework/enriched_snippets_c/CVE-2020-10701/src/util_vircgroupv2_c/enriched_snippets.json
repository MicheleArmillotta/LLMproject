[
  {
    "function_name": "virCgroupV2Register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1923-1927",
    "snippet": "void\nvirCgroupV2Register(void)\n{\n    VIR_INFO(\"Control groups not supported on this platform\");\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 1926
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirCgroupV2Register(void)\n{\n    VIR_INFO(\"Control groups not supported on this platform\");\n}"
  },
  {
    "function_name": "virCgroupV2Register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1915-1919",
    "snippet": "void\nvirCgroupV2Register(void)\n{\n    virCgroupBackendRegister(&virCgroupV2Backend);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupBackendRegister",
          "args": [
            "&virCgroupV2Backend"
          ],
          "line": 1918
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupBackendRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
          "lines": "42-53",
          "snippet": "void\nvirCgroupBackendRegister(virCgroupBackendPtr backend)\n{\n    if (virCgroupBackends[backend->type]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cgroup backend '%s' already registered.\"),\n                       virCgroupBackendTypeToString(backend->type));\n        return;\n    }\n\n    virCgroupBackends[backend->type] = backend;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nstatic virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };\n\nvoid\nvirCgroupBackendRegister(virCgroupBackendPtr backend)\n{\n    if (virCgroupBackends[backend->type]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cgroup backend '%s' already registered.\"),\n                       virCgroupBackendTypeToString(backend->type));\n        return;\n    }\n\n    virCgroupBackends[backend->type] = backend;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirCgroupV2Register(void)\n{\n    virCgroupBackendRegister(&virCgroupV2Backend);\n}"
  },
  {
    "function_name": "virCgroupV2DenyAllDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1831-1838",
    "snippet": "static int\nvirCgroupV2DenyAllDevices(virCgroupPtr group)\n{\n    if (virCgroupV2DevicesDetectProg(group) < 0)\n        return -1;\n\n    return virCgroupV2DevicesCreateProg(group);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV2DevicesCreateProg",
          "args": [
            "group"
          ],
          "line": 1837
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesCreateProg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "602-609",
          "snippet": "int\nvirCgroupV2DevicesCreateProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nint\nvirCgroupV2DevicesCreateProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesDetectProg",
          "args": [
            "group"
          ],
          "line": 1834
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesDetectProg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "592-599",
          "snippet": "int\nvirCgroupV2DevicesDetectProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nint\nvirCgroupV2DevicesDetectProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2DenyAllDevices(virCgroupPtr group)\n{\n    if (virCgroupV2DevicesDetectProg(group) < 0)\n        return -1;\n\n    return virCgroupV2DevicesCreateProg(group);\n}"
  },
  {
    "function_name": "virCgroupV2AllowAllDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1814-1828",
    "snippet": "static int\nvirCgroupV2AllowAllDevices(virCgroupPtr group,\n                           int perms)\n{\n    if (virCgroupV2DevicesPrepareProg(group) < 0)\n        return -1;\n\n    if (group->unified.devices.count > 0 &&\n        perms == VIR_CGROUP_DEVICE_RWM &&\n        virCgroupV2DevicesCreateProg(group) < 0) {\n        return -1;\n    }\n\n    return virCgroupV2AllowDevice(group, 'a', -1, -1, perms);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV2AllowDevice",
          "args": [
            "group",
            "'a'",
            "-1",
            "-1",
            "perms"
          ],
          "line": 1827
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2AllowDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "1745-1771",
          "snippet": "static int\nvirCgroupV2AllowDevice(virCgroupPtr group,\n                       char type,\n                       int major,\n                       int minor,\n                       int perms)\n{\n    uint64_t key = virCgroupV2DevicesGetKey(major, minor);\n    uint32_t val = virCgroupV2DevicesGetPerms(perms, type);\n    int rc;\n\n    if (virCgroupV2DevicesPrepareProg(group) < 0)\n        return -1;\n\n    rc = virBPFLookupElem(group->unified.devices.mapfd, &key, NULL);\n\n    if (virBPFUpdateElem(group->unified.devices.mapfd, &key, &val) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"failed to update device in BPF cgroup map\"));\n        return -1;\n    }\n\n    if (rc < 0)\n        group->unified.devices.count++;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2AllowDevice(virCgroupPtr group,\n                       char type,\n                       int major,\n                       int minor,\n                       int perms)\n{\n    uint64_t key = virCgroupV2DevicesGetKey(major, minor);\n    uint32_t val = virCgroupV2DevicesGetPerms(perms, type);\n    int rc;\n\n    if (virCgroupV2DevicesPrepareProg(group) < 0)\n        return -1;\n\n    rc = virBPFLookupElem(group->unified.devices.mapfd, &key, NULL);\n\n    if (virBPFUpdateElem(group->unified.devices.mapfd, &key, &val) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"failed to update device in BPF cgroup map\"));\n        return -1;\n    }\n\n    if (rc < 0)\n        group->unified.devices.count++;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesCreateProg",
          "args": [
            "group"
          ],
          "line": 1823
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesCreateProg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "602-609",
          "snippet": "int\nvirCgroupV2DevicesCreateProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nint\nvirCgroupV2DevicesCreateProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesPrepareProg",
          "args": [
            "group"
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesPrepareProg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "612-619",
          "snippet": "int\nvirCgroupV2DevicesPrepareProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nint\nvirCgroupV2DevicesPrepareProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2AllowAllDevices(virCgroupPtr group,\n                           int perms)\n{\n    if (virCgroupV2DevicesPrepareProg(group) < 0)\n        return -1;\n\n    if (group->unified.devices.count > 0 &&\n        perms == VIR_CGROUP_DEVICE_RWM &&\n        virCgroupV2DevicesCreateProg(group) < 0) {\n        return -1;\n    }\n\n    return virCgroupV2AllowDevice(group, 'a', -1, -1, perms);\n}"
  },
  {
    "function_name": "virCgroupV2DenyDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1774-1811",
    "snippet": "static int\nvirCgroupV2DenyDevice(virCgroupPtr group,\n                      char type,\n                      int major,\n                      int minor,\n                      int perms)\n{\n    uint64_t key = virCgroupV2DevicesGetKey(major, minor);\n    uint32_t newval = virCgroupV2DevicesGetPerms(perms, type);\n    uint32_t val = 0;\n\n    if (virCgroupV2DevicesPrepareProg(group) < 0)\n        return -1;\n\n    if (group->unified.devices.count <= 0 ||\n        virBPFLookupElem(group->unified.devices.mapfd, &key, &val) < 0) {\n        VIR_DEBUG(\"nothing to do, device is not allowed\");\n        return 0;\n    }\n\n    if (newval == val) {\n        if (virBPFDeleteElem(group->unified.devices.mapfd, &key) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"failed to remove device from BPF cgroup map\"));\n            return -1;\n        }\n        group->unified.devices.count--;\n    } else {\n        val ^= val & newval;\n        if (virBPFUpdateElem(group->unified.devices.mapfd, &key, &val) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"failed to update device in BPF cgroup map\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"failed to update device in BPF cgroup map\")"
          ],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to update device in BPF cgroup map\""
          ],
          "line": 1805
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBPFUpdateElem",
          "args": [
            "group->unified.devices.mapfd",
            "&key",
            "&val"
          ],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "virBPFUpdateElem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
          "lines": "407-414",
          "snippet": "int\nvirBPFUpdateElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "# include <unistd.h>",
            "# include <sys/syscall.h>",
            "#include \"virbpf.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFUpdateElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"failed to remove device from BPF cgroup map\")"
          ],
          "line": 1796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBPFDeleteElem",
          "args": [
            "group->unified.devices.mapfd",
            "&key"
          ],
          "line": 1795
        },
        "resolved": true,
        "details": {
          "function_name": "virBPFDeleteElem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
          "lines": "417-423",
          "snippet": "int\nvirBPFDeleteElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "# include <unistd.h>",
            "# include <sys/syscall.h>",
            "#include \"virbpf.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFDeleteElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nothing to do, device is not allowed\""
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBPFLookupElem",
          "args": [
            "group->unified.devices.mapfd",
            "&key",
            "&val"
          ],
          "line": 1789
        },
        "resolved": true,
        "details": {
          "function_name": "virBPFLookupElem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
          "lines": "387-394",
          "snippet": "int\nvirBPFLookupElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "# include <unistd.h>",
            "# include <sys/syscall.h>",
            "#include \"virbpf.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFLookupElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesPrepareProg",
          "args": [
            "group"
          ],
          "line": 1785
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesPrepareProg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "612-619",
          "snippet": "int\nvirCgroupV2DevicesPrepareProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nint\nvirCgroupV2DevicesPrepareProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesGetPerms",
          "args": [
            "perms",
            "type"
          ],
          "line": 1782
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesGetPerms",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "629-634",
          "snippet": "uint32_t\nvirCgroupV2DevicesGetPerms(int perms G_GNUC_UNUSED,\n                           char type G_GNUC_UNUSED)\n{\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nuint32_t\nvirCgroupV2DevicesGetPerms(int perms G_GNUC_UNUSED,\n                           char type G_GNUC_UNUSED)\n{\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesGetKey",
          "args": [
            "major",
            "minor"
          ],
          "line": 1781
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesGetKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "638-643",
          "snippet": "uint64_t\nvirCgroupV2DevicesGetKey(int major,\n                         int minor)\n{\n    return (uint64_t)major << 32 | ((uint64_t)minor & 0x00000000ffffffff);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nuint64_t\nvirCgroupV2DevicesGetKey(int major,\n                         int minor)\n{\n    return (uint64_t)major << 32 | ((uint64_t)minor & 0x00000000ffffffff);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2DenyDevice(virCgroupPtr group,\n                      char type,\n                      int major,\n                      int minor,\n                      int perms)\n{\n    uint64_t key = virCgroupV2DevicesGetKey(major, minor);\n    uint32_t newval = virCgroupV2DevicesGetPerms(perms, type);\n    uint32_t val = 0;\n\n    if (virCgroupV2DevicesPrepareProg(group) < 0)\n        return -1;\n\n    if (group->unified.devices.count <= 0 ||\n        virBPFLookupElem(group->unified.devices.mapfd, &key, &val) < 0) {\n        VIR_DEBUG(\"nothing to do, device is not allowed\");\n        return 0;\n    }\n\n    if (newval == val) {\n        if (virBPFDeleteElem(group->unified.devices.mapfd, &key) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"failed to remove device from BPF cgroup map\"));\n            return -1;\n        }\n        group->unified.devices.count--;\n    } else {\n        val ^= val & newval;\n        if (virBPFUpdateElem(group->unified.devices.mapfd, &key, &val) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"failed to update device in BPF cgroup map\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2AllowDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1745-1771",
    "snippet": "static int\nvirCgroupV2AllowDevice(virCgroupPtr group,\n                       char type,\n                       int major,\n                       int minor,\n                       int perms)\n{\n    uint64_t key = virCgroupV2DevicesGetKey(major, minor);\n    uint32_t val = virCgroupV2DevicesGetPerms(perms, type);\n    int rc;\n\n    if (virCgroupV2DevicesPrepareProg(group) < 0)\n        return -1;\n\n    rc = virBPFLookupElem(group->unified.devices.mapfd, &key, NULL);\n\n    if (virBPFUpdateElem(group->unified.devices.mapfd, &key, &val) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"failed to update device in BPF cgroup map\"));\n        return -1;\n    }\n\n    if (rc < 0)\n        group->unified.devices.count++;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"failed to update device in BPF cgroup map\")"
          ],
          "line": 1762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to update device in BPF cgroup map\""
          ],
          "line": 1763
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBPFUpdateElem",
          "args": [
            "group->unified.devices.mapfd",
            "&key",
            "&val"
          ],
          "line": 1761
        },
        "resolved": true,
        "details": {
          "function_name": "virBPFUpdateElem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
          "lines": "407-414",
          "snippet": "int\nvirBPFUpdateElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "# include <unistd.h>",
            "# include <sys/syscall.h>",
            "#include \"virbpf.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFUpdateElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBPFLookupElem",
          "args": [
            "group->unified.devices.mapfd",
            "&key",
            "NULL"
          ],
          "line": 1759
        },
        "resolved": true,
        "details": {
          "function_name": "virBPFLookupElem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
          "lines": "387-394",
          "snippet": "int\nvirBPFLookupElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "# include <unistd.h>",
            "# include <sys/syscall.h>",
            "#include \"virbpf.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFLookupElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesPrepareProg",
          "args": [
            "group"
          ],
          "line": 1756
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesPrepareProg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "612-619",
          "snippet": "int\nvirCgroupV2DevicesPrepareProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nint\nvirCgroupV2DevicesPrepareProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"cgroups v2 BPF devices not supported \"\n                           \"with this kernel\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesGetPerms",
          "args": [
            "perms",
            "type"
          ],
          "line": 1753
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesGetPerms",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "629-634",
          "snippet": "uint32_t\nvirCgroupV2DevicesGetPerms(int perms G_GNUC_UNUSED,\n                           char type G_GNUC_UNUSED)\n{\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nuint32_t\nvirCgroupV2DevicesGetPerms(int perms G_GNUC_UNUSED,\n                           char type G_GNUC_UNUSED)\n{\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesGetKey",
          "args": [
            "major",
            "minor"
          ],
          "line": 1752
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesGetKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "638-643",
          "snippet": "uint64_t\nvirCgroupV2DevicesGetKey(int major,\n                         int minor)\n{\n    return (uint64_t)major << 32 | ((uint64_t)minor & 0x00000000ffffffff);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nuint64_t\nvirCgroupV2DevicesGetKey(int major,\n                         int minor)\n{\n    return (uint64_t)major << 32 | ((uint64_t)minor & 0x00000000ffffffff);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2AllowDevice(virCgroupPtr group,\n                       char type,\n                       int major,\n                       int minor,\n                       int perms)\n{\n    uint64_t key = virCgroupV2DevicesGetKey(major, minor);\n    uint32_t val = virCgroupV2DevicesGetPerms(perms, type);\n    int rc;\n\n    if (virCgroupV2DevicesPrepareProg(group) < 0)\n        return -1;\n\n    rc = virBPFLookupElem(group->unified.devices.mapfd, &key, NULL);\n\n    if (virBPFUpdateElem(group->unified.devices.mapfd, &key, &val) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"failed to update device in BPF cgroup map\"));\n        return -1;\n    }\n\n    if (rc < 0)\n        group->unified.devices.count++;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2GetCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1734-1742",
    "snippet": "static int\nvirCgroupV2GetCpusetCpus(virCgroupPtr group,\n                         char **cpus)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.cpus\",\n                                cpus);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.cpus\"",
            "cpus"
          ],
          "line": 1738
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetCpusetCpus(virCgroupPtr group,\n                         char **cpus)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.cpus\",\n                                cpus);\n}"
  },
  {
    "function_name": "virCgroupV2SetCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1723-1731",
    "snippet": "static int\nvirCgroupV2SetCpusetCpus(virCgroupPtr group,\n                         const char *cpus)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.cpus\",\n                                cpus);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.cpus\"",
            "cpus"
          ],
          "line": 1727
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetCpusetCpus(virCgroupPtr group,\n                         const char *cpus)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.cpus\",\n                                cpus);\n}"
  },
  {
    "function_name": "virCgroupV2GetCpusetMemoryMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1714-1720",
    "snippet": "static int\nvirCgroupV2GetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                  bool *migrate)\n{\n    *migrate = true;\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                  bool *migrate)\n{\n    *migrate = true;\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetCpusetMemoryMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1706-1711",
    "snippet": "static int\nvirCgroupV2SetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                  bool migrate G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                  bool migrate G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2GetCpusetMems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1695-1703",
    "snippet": "static int\nvirCgroupV2GetCpusetMems(virCgroupPtr group,\n                         char **mems)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.mems\",\n                                mems);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.mems\"",
            "mems"
          ],
          "line": 1699
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetCpusetMems(virCgroupPtr group,\n                         char **mems)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.mems\",\n                                mems);\n}"
  },
  {
    "function_name": "virCgroupV2SetCpusetMems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1684-1692",
    "snippet": "static int\nvirCgroupV2SetCpusetMems(virCgroupPtr group,\n                         const char *mems)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.mems\",\n                                mems);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.mems\"",
            "mems"
          ],
          "line": 1688
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetCpusetMems(virCgroupPtr group,\n                         const char *mems)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.mems\",\n                                mems);\n}"
  },
  {
    "function_name": "virCgroupV2GetCpuacctStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1636-1681",
    "snippet": "static int\nvirCgroupV2GetCpuacctStat(virCgroupPtr group,\n                          unsigned long long *user,\n                          unsigned long long *sys)\n{\n    g_autofree char *str = NULL;\n    char *tmp;\n    unsigned long long userVal = 0;\n    unsigned long long sysVal = 0;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                             \"cpu.stat\", &str) < 0) {\n        return -1;\n    }\n\n    if (!(tmp = strstr(str, \"user_usec \"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse cpu user stat '%s'\"), str);\n        return -1;\n    }\n    tmp += strlen(\"user_usec \");\n\n    if (virStrToLong_ull(tmp, &tmp, 10, &userVal) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"), tmp);\n        return -1;\n    }\n\n    if (!(tmp = strstr(str, \"system_usec \"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse cpu sys stat '%s'\"), str);\n        return -1;\n    }\n    tmp += strlen(\"system_usec \");\n\n    if (virStrToLong_ull(tmp, &tmp, 10, &sysVal) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"), tmp);\n        return -1;\n    }\n\n    *user = userVal * 1000;\n    *sys = sysVal * 1000;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse value '%s' as number.\")",
            "tmp"
          ],
          "line": 1672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse value '%s' as number.\""
          ],
          "line": 1673
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "&sysVal"
          ],
          "line": 1671
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"system_usec \""
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse cpu sys stat '%s'\")",
            "str"
          ],
          "line": 1665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str",
            "\"system_usec \""
          ],
          "line": 1664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse value '%s' as number.\")",
            "tmp"
          ],
          "line": 1659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"user_usec \""
          ],
          "line": 1656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse cpu user stat '%s'\")",
            "str"
          ],
          "line": 1652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str",
            "\"user_usec \""
          ],
          "line": 1651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUACCT",
            "\"cpu.stat\"",
            "&str"
          ],
          "line": 1646
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetCpuacctStat(virCgroupPtr group,\n                          unsigned long long *user,\n                          unsigned long long *sys)\n{\n    g_autofree char *str = NULL;\n    char *tmp;\n    unsigned long long userVal = 0;\n    unsigned long long sysVal = 0;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                             \"cpu.stat\", &str) < 0) {\n        return -1;\n    }\n\n    if (!(tmp = strstr(str, \"user_usec \"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse cpu user stat '%s'\"), str);\n        return -1;\n    }\n    tmp += strlen(\"user_usec \");\n\n    if (virStrToLong_ull(tmp, &tmp, 10, &userVal) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"), tmp);\n        return -1;\n    }\n\n    if (!(tmp = strstr(str, \"system_usec \"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse cpu sys stat '%s'\"), str);\n        return -1;\n    }\n    tmp += strlen(\"system_usec \");\n\n    if (virStrToLong_ull(tmp, &tmp, 10, &sysVal) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"), tmp);\n        return -1;\n    }\n\n    *user = userVal * 1000;\n    *sys = sysVal * 1000;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2GetCpuacctUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1605-1633",
    "snippet": "static int\nvirCgroupV2GetCpuacctUsage(virCgroupPtr group,\n                           unsigned long long *usage)\n{\n    g_autofree char *str = NULL;\n    char *tmp;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                             \"cpu.stat\", &str) < 0) {\n        return -1;\n    }\n\n    if (!(tmp = strstr(str, \"usage_usec \"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse cpu usage stat '%s'\"), str);\n        return -1;\n    }\n    tmp += strlen(\"usage_usec \");\n\n    if (virStrToLong_ull(tmp, &tmp, 10, usage) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"), tmp);\n        return -1;\n    }\n\n    *usage *= 1000;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse value '%s' as number.\")",
            "tmp"
          ],
          "line": 1625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse value '%s' as number.\""
          ],
          "line": 1626
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "usage"
          ],
          "line": 1624
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"usage_usec \""
          ],
          "line": 1622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse cpu usage stat '%s'\")",
            "str"
          ],
          "line": 1618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str",
            "\"usage_usec \""
          ],
          "line": 1617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUACCT",
            "\"cpu.stat\"",
            "&str"
          ],
          "line": 1612
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetCpuacctUsage(virCgroupPtr group,\n                           unsigned long long *usage)\n{\n    g_autofree char *str = NULL;\n    char *tmp;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                             \"cpu.stat\", &str) < 0) {\n        return -1;\n    }\n\n    if (!(tmp = strstr(str, \"usage_usec \"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot parse cpu usage stat '%s'\"), str);\n        return -1;\n    }\n    tmp += strlen(\"usage_usec \");\n\n    if (virStrToLong_ull(tmp, &tmp, 10, usage) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"), tmp);\n        return -1;\n    }\n\n    *usage *= 1000;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SupportsCpuBW",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1590-1602",
    "snippet": "static bool\nvirCgroupV2SupportsCpuBW(virCgroupPtr cgroup)\n{\n    g_autofree char *path = NULL;\n\n    if (virCgroupV2PathOfController(cgroup, VIR_CGROUP_CONTROLLER_CPU,\n                                    \"cpu.max\", &path) < 0) {\n        virResetLastError();\n        return false;\n    }\n\n    return virFileExists(path);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 1601
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1597
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2PathOfController",
          "args": [
            "cgroup",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.max\"",
            "&path"
          ],
          "line": 1595
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "341-358",
          "snippet": "static int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV2SupportsCpuBW(virCgroupPtr cgroup)\n{\n    g_autofree char *path = NULL;\n\n    if (virCgroupV2PathOfController(cgroup, VIR_CGROUP_CONTROLLER_CPU,\n                                    \"cpu.max\", &path) < 0) {\n        virResetLastError();\n        return false;\n    }\n\n    return virFileExists(path);\n}"
  },
  {
    "function_name": "virCgroupV2GetCpuCfsQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1563-1587",
    "snippet": "static int\nvirCgroupV2GetCpuCfsQuota(virCgroupPtr group,\n                          long long *cfs_quota)\n{\n    g_autofree char *str = NULL;\n    char *tmp;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPU,\n                             \"cpu.max\", &str) < 0) {\n        return -1;\n    }\n\n    if (STREQLEN(str, \"max\", 3)) {\n        *cfs_quota = ULLONG_MAX / 1000;\n        return 0;\n    }\n\n    if (virStrToLong_ll(str, &tmp, 10, cfs_quota) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' from cpu.max.\"), str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse value '%s' from cpu.max.\")",
            "str"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse value '%s' from cpu.max.\""
          ],
          "line": 1582
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "str",
            "&tmp",
            "10",
            "cfs_quota"
          ],
          "line": 1580
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQLEN",
          "args": [
            "str",
            "\"max\"",
            "3"
          ],
          "line": 1575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.max\"",
            "&str"
          ],
          "line": 1570
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetCpuCfsQuota(virCgroupPtr group,\n                          long long *cfs_quota)\n{\n    g_autofree char *str = NULL;\n    char *tmp;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPU,\n                             \"cpu.max\", &str) < 0) {\n        return -1;\n    }\n\n    if (STREQLEN(str, \"max\", 3)) {\n        *cfs_quota = ULLONG_MAX / 1000;\n        return 0;\n    }\n\n    if (virStrToLong_ll(str, &tmp, 10, cfs_quota) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' from cpu.max.\"), str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetCpuCfsQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1537-1560",
    "snippet": "static int\nvirCgroupV2SetCpuCfsQuota(virCgroupPtr group,\n                          long long cfs_quota)\n{\n    /* The cfs_quota should be greater or equal than 1ms */\n    if (cfs_quota >= 0 &&\n        (cfs_quota < 1000 ||\n         cfs_quota > ULLONG_MAX / 1000)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"cfs_quota '%lld' must be in range (1000, %llu)\"),\n                       cfs_quota, ULLONG_MAX / 1000);\n        return -1;\n    }\n\n    if (cfs_quota == ULLONG_MAX / 1000) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_CPU,\n                                    \"cpu.max\", \"max\");\n    }\n\n    return virCgroupSetValueI64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.max\", cfs_quota);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueI64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.max\"",
            "cfs_quota"
          ],
          "line": 1557
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueI64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "567-578",
          "snippet": "int\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.max\"",
            "\"max\""
          ],
          "line": 1552
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"cfs_quota '%lld' must be in range (1000, %llu)\")",
            "cfs_quota",
            "ULLONG_MAX / 1000"
          ],
          "line": 1545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cfs_quota '%lld' must be in range (1000, %llu)\""
          ],
          "line": 1546
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetCpuCfsQuota(virCgroupPtr group,\n                          long long cfs_quota)\n{\n    /* The cfs_quota should be greater or equal than 1ms */\n    if (cfs_quota >= 0 &&\n        (cfs_quota < 1000 ||\n         cfs_quota > ULLONG_MAX / 1000)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"cfs_quota '%lld' must be in range (1000, %llu)\"),\n                       cfs_quota, ULLONG_MAX / 1000);\n        return -1;\n    }\n\n    if (cfs_quota == ULLONG_MAX / 1000) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_CPU,\n                                    \"cpu.max\", \"max\");\n    }\n\n    return virCgroupSetValueI64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.max\", cfs_quota);\n}"
  },
  {
    "function_name": "virCgroupV2GetCpuCfsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1509-1534",
    "snippet": "static int\nvirCgroupV2GetCpuCfsPeriod(virCgroupPtr group,\n                           unsigned long long *cfs_period)\n{\n    g_autofree char *str = NULL;\n    char *tmp;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPU,\n                             \"cpu.max\", &str) < 0) {\n        return -1;\n    }\n\n    if (!(tmp = strchr(str, ' '))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid 'cpu.max' data.\"));\n        return -1;\n    }\n\n    if (virStrToLong_ull(tmp, &tmp, 10, cfs_period) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' from cpu.max.\"), str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse value '%s' from cpu.max.\")",
            "str"
          ],
          "line": 1528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse value '%s' from cpu.max.\""
          ],
          "line": 1529
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "cfs_period"
          ],
          "line": 1527
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid 'cpu.max' data.\")"
          ],
          "line": 1522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "str",
            "' '"
          ],
          "line": 1521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.max\"",
            "&str"
          ],
          "line": 1516
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetCpuCfsPeriod(virCgroupPtr group,\n                           unsigned long long *cfs_period)\n{\n    g_autofree char *str = NULL;\n    char *tmp;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPU,\n                             \"cpu.max\", &str) < 0) {\n        return -1;\n    }\n\n    if (!(tmp = strchr(str, ' '))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid 'cpu.max' data.\"));\n        return -1;\n    }\n\n    if (virStrToLong_ull(tmp, &tmp, 10, cfs_period) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' from cpu.max.\"), str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetCpuCfsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1472-1506",
    "snippet": "static int\nvirCgroupV2SetCpuCfsPeriod(virCgroupPtr group,\n                           unsigned long long cfs_period)\n{\n    g_autofree char *value = NULL;\n    g_autofree char *str = NULL;\n    char *tmp;\n\n    /* The cfs_period should be greater or equal than 1ms, and less or equal\n     * than 1s.\n     */\n    if (cfs_period < 1000 || cfs_period > 1000000) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"cfs_period '%llu' must be in range (1000, 1000000)\"),\n                       cfs_period);\n        return -1;\n    }\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPU,\n                             \"cpu.max\", &str) < 0) {\n        return -1;\n    }\n\n    if (!(tmp = strchr(str, ' '))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid 'cpu.max' data.\"));\n        return -1;\n    }\n    *tmp = '\\0';\n\n    value = g_strdup_printf(\"%s %llu\", str, cfs_period);\n\n    return virCgroupSetValueStr(group, VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.max\", value);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.max\"",
            "value"
          ],
          "line": 1504
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s %llu\"",
            "str",
            "cfs_period"
          ],
          "line": 1502
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid 'cpu.max' data.\")"
          ],
          "line": 1496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "str",
            "' '"
          ],
          "line": 1495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.max\"",
            "&str"
          ],
          "line": 1490
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"cfs_period '%llu' must be in range (1000, 1000000)\")",
            "cfs_period"
          ],
          "line": 1484
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetCpuCfsPeriod(virCgroupPtr group,\n                           unsigned long long cfs_period)\n{\n    g_autofree char *value = NULL;\n    g_autofree char *str = NULL;\n    char *tmp;\n\n    /* The cfs_period should be greater or equal than 1ms, and less or equal\n     * than 1s.\n     */\n    if (cfs_period < 1000 || cfs_period > 1000000) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"cfs_period '%llu' must be in range (1000, 1000000)\"),\n                       cfs_period);\n        return -1;\n    }\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPU,\n                             \"cpu.max\", &str) < 0) {\n        return -1;\n    }\n\n    if (!(tmp = strchr(str, ' '))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid 'cpu.max' data.\"));\n        return -1;\n    }\n    *tmp = '\\0';\n\n    value = g_strdup_printf(\"%s %llu\", str, cfs_period);\n\n    return virCgroupSetValueStr(group, VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.max\", value);\n}"
  },
  {
    "function_name": "virCgroupV2GetCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1462-1469",
    "snippet": "static int\nvirCgroupV2GetCpuShares(virCgroupPtr group,\n                        unsigned long long *shares)\n{\n    return virCgroupGetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.weight\", shares);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.weight\"",
            "shares"
          ],
          "line": 1466
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetCpuShares(virCgroupPtr group,\n                        unsigned long long *shares)\n{\n    return virCgroupGetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.weight\", shares);\n}"
  },
  {
    "function_name": "virCgroupV2SetCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1452-1459",
    "snippet": "static int\nvirCgroupV2SetCpuShares(virCgroupPtr group,\n                        unsigned long long shares)\n{\n    return virCgroupSetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.weight\", shares);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.weight\"",
            "shares"
          ],
          "line": 1456
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetCpuShares(virCgroupPtr group,\n                        unsigned long long shares)\n{\n    return virCgroupSetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.weight\", shares);\n}"
  },
  {
    "function_name": "virCgroupV2GetMemSwapUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1437-1449",
    "snippet": "static int\nvirCgroupV2GetMemSwapUsage(virCgroupPtr group,\n                           unsigned long long *kb)\n{\n    unsigned long long usage_in_bytes;\n    int ret;\n    ret = virCgroupGetValueU64(group,\n                               VIR_CGROUP_CONTROLLER_MEMORY,\n                               \"memory.swap.current\", &usage_in_bytes);\n    if (ret == 0)\n        *kb = (unsigned long) usage_in_bytes >> 10;\n    return ret;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.swap.current\"",
            "&usage_in_bytes"
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetMemSwapUsage(virCgroupPtr group,\n                           unsigned long long *kb)\n{\n    unsigned long long usage_in_bytes;\n    int ret;\n    ret = virCgroupGetValueU64(group,\n                               VIR_CGROUP_CONTROLLER_MEMORY,\n                               \"memory.swap.current\", &usage_in_bytes);\n    if (ret == 0)\n        *kb = (unsigned long) usage_in_bytes >> 10;\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV2GetMemSwapHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1404-1434",
    "snippet": "static int\nvirCgroupV2GetMemSwapHardLimit(virCgroupPtr group,\n                               unsigned long long *kb)\n{\n    g_autofree char *value = NULL;\n    unsigned long long max;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.swap.max\", &value) < 0) {\n        return -1;\n    }\n\n    if (STREQ(value, \"max\")) {\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        return 0;\n    }\n\n    if (virStrToLong_ull(value, NULL, 10, &max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"),\n                       value);\n        return -1;\n    }\n\n    *kb = max >> 10;\n    if (*kb >= VIR_DOMAIN_MEMORY_PARAM_UNLIMITED)\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse value '%s' as number.\")",
            "value"
          ],
          "line": 1423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse value '%s' as number.\""
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "value",
            "NULL",
            "10",
            "&max"
          ],
          "line": 1422
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "\"max\""
          ],
          "line": 1417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.swap.max\"",
            "&value"
          ],
          "line": 1411
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetMemSwapHardLimit(virCgroupPtr group,\n                               unsigned long long *kb)\n{\n    g_autofree char *value = NULL;\n    unsigned long long max;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.swap.max\", &value) < 0) {\n        return -1;\n    }\n\n    if (STREQ(value, \"max\")) {\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        return 0;\n    }\n\n    if (virStrToLong_ull(value, NULL, 10, &max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"),\n                       value);\n        return -1;\n    }\n\n    *kb = max >> 10;\n    if (*kb >= VIR_DOMAIN_MEMORY_PARAM_UNLIMITED)\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetMemSwapHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1377-1401",
    "snippet": "static int\nvirCgroupV2SetMemSwapHardLimit(virCgroupPtr group,\n                               unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.swap.max\",\n                                    \"max\");\n    } else {\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.swap.max\",\n                                    kb << 10);\n    }\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.swap.max\"",
            "kb << 10"
          ],
          "line": 1396
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.swap.max\"",
            "\"max\""
          ],
          "line": 1391
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Memory '%llu' must be less than %llu\")",
            "kb",
            "maxkb"
          ],
          "line": 1384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Memory '%llu' must be less than %llu\""
          ],
          "line": 1385
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetMemSwapHardLimit(virCgroupPtr group,\n                               unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.swap.max\",\n                                    \"max\");\n    } else {\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.swap.max\",\n                                    kb << 10);\n    }\n}"
  },
  {
    "function_name": "virCgroupV2GetMemorySoftLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1345-1374",
    "snippet": "static int\nvirCgroupV2GetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long *kb)\n{\n    g_autofree char *value = NULL;\n    unsigned long long high;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.high\", &value) < 0)\n        return -1;\n\n    if (STREQ(value, \"max\")) {\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        return 0;\n    }\n\n    if (virStrToLong_ull(value, NULL, 10, &high) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"),\n                       value);\n        return -1;\n    }\n\n    *kb = high >> 10;\n    if (*kb >= VIR_DOMAIN_MEMORY_PARAM_UNLIMITED)\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse value '%s' as number.\")",
            "value"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse value '%s' as number.\""
          ],
          "line": 1364
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "value",
            "NULL",
            "10",
            "&high"
          ],
          "line": 1362
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "\"max\""
          ],
          "line": 1357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.high\"",
            "&value"
          ],
          "line": 1352
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long *kb)\n{\n    g_autofree char *value = NULL;\n    unsigned long long high;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.high\", &value) < 0)\n        return -1;\n\n    if (STREQ(value, \"max\")) {\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        return 0;\n    }\n\n    if (virStrToLong_ull(value, NULL, 10, &high) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"),\n                       value);\n        return -1;\n    }\n\n    *kb = high >> 10;\n    if (*kb >= VIR_DOMAIN_MEMORY_PARAM_UNLIMITED)\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetMemorySoftLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1318-1342",
    "snippet": "static int\nvirCgroupV2SetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.high\",\n                                    \"max\");\n    } else {\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.high\",\n                                    kb << 10);\n    }\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.high\"",
            "kb << 10"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.high\"",
            "\"max\""
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Memory '%llu' must be less than %llu\")",
            "kb",
            "maxkb"
          ],
          "line": 1325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Memory '%llu' must be less than %llu\""
          ],
          "line": 1326
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.high\",\n                                    \"max\");\n    } else {\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.high\",\n                                    kb << 10);\n    }\n}"
  },
  {
    "function_name": "virCgroupV2GetMemoryHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1285-1315",
    "snippet": "static int\nvirCgroupV2GetMemoryHardLimit(virCgroupPtr group,\n                              unsigned long long *kb)\n{\n    g_autofree char *value = NULL;\n    unsigned long long max;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.max\", &value) < 0) {\n        return -1;\n    }\n\n    if (STREQ(value, \"max\")) {\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        return 0;\n    }\n\n    if (virStrToLong_ull(value, NULL, 10, &max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"),\n                       value);\n        return -1;\n    }\n\n    *kb = max >> 10;\n    if (*kb >= VIR_DOMAIN_MEMORY_PARAM_UNLIMITED)\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to parse value '%s' as number.\")",
            "value"
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse value '%s' as number.\""
          ],
          "line": 1305
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "value",
            "NULL",
            "10",
            "&max"
          ],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "\"max\""
          ],
          "line": 1298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.max\"",
            "&value"
          ],
          "line": 1292
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetMemoryHardLimit(virCgroupPtr group,\n                              unsigned long long *kb)\n{\n    g_autofree char *value = NULL;\n    unsigned long long max;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.max\", &value) < 0) {\n        return -1;\n    }\n\n    if (STREQ(value, \"max\")) {\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        return 0;\n    }\n\n    if (virStrToLong_ull(value, NULL, 10, &max) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to parse value '%s' as number.\"),\n                       value);\n        return -1;\n    }\n\n    *kb = max >> 10;\n    if (*kb >= VIR_DOMAIN_MEMORY_PARAM_UNLIMITED)\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetMemoryHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1277-1282",
    "snippet": "static int\nvirCgroupV2SetMemoryHardLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    return virCgroupV2SetMemory(group, kb);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV2SetMemory",
          "args": [
            "group",
            "kb"
          ],
          "line": 1281
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2SetMemorySoftLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "1318-1342",
          "snippet": "static int\nvirCgroupV2SetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.high\",\n                                    \"max\");\n    } else {\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.high\",\n                                    kb << 10);\n    }\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.high\",\n                                    \"max\");\n    } else {\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.high\",\n                                    kb << 10);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetMemoryHardLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    return virCgroupV2SetMemory(group, kb);\n}"
  },
  {
    "function_name": "virCgroupV2GetMemoryUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1263-1274",
    "snippet": "static int\nvirCgroupV2GetMemoryUsage(virCgroupPtr group,\n                          unsigned long *kb)\n{\n    unsigned long long usage_in_bytes;\n    int ret = virCgroupGetValueU64(group,\n                                   VIR_CGROUP_CONTROLLER_MEMORY,\n                                   \"memory.current\", &usage_in_bytes);\n    if (ret == 0)\n        *kb = (unsigned long) usage_in_bytes >> 10;\n    return ret;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.current\"",
            "&usage_in_bytes"
          ],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetMemoryUsage(virCgroupPtr group,\n                          unsigned long *kb)\n{\n    unsigned long long usage_in_bytes;\n    int ret = virCgroupGetValueU64(group,\n                                   VIR_CGROUP_CONTROLLER_MEMORY,\n                                   \"memory.current\", &usage_in_bytes);\n    if (ret == 0)\n        *kb = (unsigned long) usage_in_bytes >> 10;\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV2GetMemoryStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1184-1260",
    "snippet": "static int\nvirCgroupV2GetMemoryStat(virCgroupPtr group,\n                         unsigned long long *cache,\n                         unsigned long long *activeAnon,\n                         unsigned long long *inactiveAnon,\n                         unsigned long long *activeFile,\n                         unsigned long long *inactiveFile,\n                         unsigned long long *unevictable)\n{\n    g_autofree char *stat = NULL;\n    char *line = NULL;\n    unsigned long long cacheVal = 0;\n    unsigned long long activeAnonVal = 0;\n    unsigned long long inactiveAnonVal = 0;\n    unsigned long long activeFileVal = 0;\n    unsigned long long inactiveFileVal = 0;\n    unsigned long long unevictableVal = 0;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.stat\",\n                             &stat) < 0) {\n        return -1;\n    }\n\n    line = stat;\n\n    while (*line) {\n        char *newLine = strchr(line, '\\n');\n        char *valueStr = strchr(line, ' ');\n        unsigned long long value;\n\n        if (newLine)\n            *newLine = '\\0';\n\n        if (!valueStr) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse 'memory.stat' cgroup file.\"));\n            return -1;\n        }\n        *valueStr = '\\0';\n\n        if (virStrToLong_ull(valueStr + 1, NULL, 10, &value) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           valueStr + 1);\n            return -1;\n        }\n\n        if (STREQ(line, \"file\"))\n            cacheVal = value >> 10;\n        else if (STREQ(line, \"active_anon\"))\n            activeAnonVal = value >> 10;\n        else if (STREQ(line, \"inactive_anon\"))\n            inactiveAnonVal = value >> 10;\n        else if (STREQ(line, \"active_file\"))\n            activeFileVal = value >> 10;\n        else if (STREQ(line, \"inactive_file\"))\n            inactiveFileVal = value >> 10;\n        else if (STREQ(line, \"unevictable\"))\n            unevictableVal = value >> 10;\n\n        if (newLine)\n            line = newLine + 1;\n        else\n            break;\n    }\n\n    *cache = cacheVal;\n    *activeAnon = activeAnonVal;\n    *inactiveAnon = inactiveAnonVal;\n    *activeFile = activeFileVal;\n    *inactiveFile = inactiveFileVal;\n    *unevictable = unevictableVal;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"unevictable\""
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"inactive_file\""
          ],
          "line": 1241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"active_file\""
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"inactive_anon\""
          ],
          "line": 1237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"active_anon\""
          ],
          "line": 1235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"file\""
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "valueStr + 1"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1228
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "valueStr + 1",
            "NULL",
            "10",
            "&value"
          ],
          "line": 1226
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse 'memory.stat' cgroup file.\")"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "line",
            "' '"
          ],
          "line": 1213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "line",
            "'\\n'"
          ],
          "line": 1212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.stat\"",
            "&stat"
          ],
          "line": 1202
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetMemoryStat(virCgroupPtr group,\n                         unsigned long long *cache,\n                         unsigned long long *activeAnon,\n                         unsigned long long *inactiveAnon,\n                         unsigned long long *activeFile,\n                         unsigned long long *inactiveFile,\n                         unsigned long long *unevictable)\n{\n    g_autofree char *stat = NULL;\n    char *line = NULL;\n    unsigned long long cacheVal = 0;\n    unsigned long long activeAnonVal = 0;\n    unsigned long long inactiveAnonVal = 0;\n    unsigned long long activeFileVal = 0;\n    unsigned long long inactiveFileVal = 0;\n    unsigned long long unevictableVal = 0;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.stat\",\n                             &stat) < 0) {\n        return -1;\n    }\n\n    line = stat;\n\n    while (*line) {\n        char *newLine = strchr(line, '\\n');\n        char *valueStr = strchr(line, ' ');\n        unsigned long long value;\n\n        if (newLine)\n            *newLine = '\\0';\n\n        if (!valueStr) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse 'memory.stat' cgroup file.\"));\n            return -1;\n        }\n        *valueStr = '\\0';\n\n        if (virStrToLong_ull(valueStr + 1, NULL, 10, &value) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           valueStr + 1);\n            return -1;\n        }\n\n        if (STREQ(line, \"file\"))\n            cacheVal = value >> 10;\n        else if (STREQ(line, \"active_anon\"))\n            activeAnonVal = value >> 10;\n        else if (STREQ(line, \"inactive_anon\"))\n            inactiveAnonVal = value >> 10;\n        else if (STREQ(line, \"active_file\"))\n            activeFileVal = value >> 10;\n        else if (STREQ(line, \"inactive_file\"))\n            inactiveFileVal = value >> 10;\n        else if (STREQ(line, \"unevictable\"))\n            unevictableVal = value >> 10;\n\n        if (newLine)\n            line = newLine + 1;\n        else\n            break;\n    }\n\n    *cache = cacheVal;\n    *activeAnon = activeAnonVal;\n    *inactiveAnon = inactiveAnonVal;\n    *activeFile = activeFileVal;\n    *inactiveFile = inactiveFileVal;\n    *unevictable = unevictableVal;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1157-1181",
    "snippet": "static int\nvirCgroupV2SetMemory(virCgroupPtr group,\n                     unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.max\",\n                                    \"max\");\n    } else {\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.max\",\n                                    kb << 10);\n    }\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.max\"",
            "kb << 10"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.max\"",
            "\"max\""
          ],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Memory '%llu' must be less than %llu\")",
            "kb",
            "maxkb"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Memory '%llu' must be less than %llu\""
          ],
          "line": 1165
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetMemory(virCgroupPtr group,\n                     unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb) {\n        return virCgroupSetValueStr(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.max\",\n                                    \"max\");\n    } else {\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.max\",\n                                    kb << 10);\n    }\n}"
  },
  {
    "function_name": "virCgroupV2GetBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1112-1154",
    "snippet": "static int\nvirCgroupV2GetBlkioDeviceWriteBps(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned long long *wbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    const char *name = \"wbps=\";\n    char *tmp;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.max\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *wbps = 0;\n    } else {\n        if (!(tmp = strstr(str, name))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to find '%s' limit for block device '%s'\"),\n                           name, path);\n            return -1;\n        }\n        tmp += strlen(name);\n\n        if (STREQLEN(tmp, \"max\", 3)) {\n            *wbps = 0;\n        } else if (virStrToLong_ull(tmp, &tmp, 10, wbps) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           str);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1147
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "wbps"
          ],
          "line": 1145
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQLEN",
          "args": [
            "tmp",
            "\"max\"",
            "3"
          ],
          "line": 1143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to find '%s' limit for block device '%s'\")",
            "name",
            "path"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str",
            "name"
          ],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "path",
            "&str"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.max\"",
            "&value"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetBlkioDeviceWriteBps(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned long long *wbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    const char *name = \"wbps=\";\n    char *tmp;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.max\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *wbps = 0;\n    } else {\n        if (!(tmp = strstr(str, name))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to find '%s' limit for block device '%s'\"),\n                           name, path);\n            return -1;\n        }\n        tmp += strlen(name);\n\n        if (STREQLEN(tmp, \"max\", 3)) {\n            *wbps = 0;\n        } else if (virStrToLong_ull(tmp, &tmp, 10, wbps) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           str);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1088-1109",
    "snippet": "static int\nvirCgroupV2SetBlkioDeviceWriteBps(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned long long wbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (wbps == 0) {\n        str = g_strdup_printf(\"%swbps=max\", blkstr);\n    } else {\n        str = g_strdup_printf(\"%swbps=%llu\", blkstr, wbps);\n    }\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"io.max\",\n                                str);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.max\"",
            "str"
          ],
          "line": 1105
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%swbps=%llu\"",
            "blkstr",
            "wbps"
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 1096
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetBlkioDeviceWriteBps(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned long long wbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (wbps == 0) {\n        str = g_strdup_printf(\"%swbps=max\", blkstr);\n    } else {\n        str = g_strdup_printf(\"%swbps=%llu\", blkstr, wbps);\n    }\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"io.max\",\n                                str);\n}"
  },
  {
    "function_name": "virCgroupV2GetBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1043-1085",
    "snippet": "static int\nvirCgroupV2GetBlkioDeviceReadBps(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned long long *rbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    const char *name = \"rbps=\";\n    char *tmp;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.max\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *rbps = 0;\n    } else {\n        if (!(tmp = strstr(str, name))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to find '%s' limit for block device '%s'\"),\n                           name, path);\n            return -1;\n        }\n        tmp += strlen(name);\n\n        if (STREQLEN(tmp, \"max\", 3)) {\n            *rbps = 0;\n        } else if (virStrToLong_ull(tmp, &tmp, 10, rbps) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           str);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "rbps"
          ],
          "line": 1076
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQLEN",
          "args": [
            "tmp",
            "\"max\"",
            "3"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to find '%s' limit for block device '%s'\")",
            "name",
            "path"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str",
            "name"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "path",
            "&str"
          ],
          "line": 1060
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.max\"",
            "&value"
          ],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetBlkioDeviceReadBps(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned long long *rbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    const char *name = \"rbps=\";\n    char *tmp;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.max\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *rbps = 0;\n    } else {\n        if (!(tmp = strstr(str, name))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to find '%s' limit for block device '%s'\"),\n                           name, path);\n            return -1;\n        }\n        tmp += strlen(name);\n\n        if (STREQLEN(tmp, \"max\", 3)) {\n            *rbps = 0;\n        } else if (virStrToLong_ull(tmp, &tmp, 10, rbps) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           str);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "1019-1040",
    "snippet": "static int\nvirCgroupV2SetBlkioDeviceReadBps(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned long long rbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (rbps == 0) {\n        str = g_strdup_printf(\"%srbps=max\", blkstr);\n    } else {\n        str = g_strdup_printf(\"%srbps=%llu\", blkstr, rbps);\n    }\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"io.max\",\n                                str);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.max\"",
            "str"
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%srbps=%llu\"",
            "blkstr",
            "rbps"
          ],
          "line": 1033
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetBlkioDeviceReadBps(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned long long rbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (rbps == 0) {\n        str = g_strdup_printf(\"%srbps=max\", blkstr);\n    } else {\n        str = g_strdup_printf(\"%srbps=%llu\", blkstr, rbps);\n    }\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"io.max\",\n                                str);\n}"
  },
  {
    "function_name": "virCgroupV2GetBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "974-1016",
    "snippet": "static int\nvirCgroupV2GetBlkioDeviceWriteIops(virCgroupPtr group,\n                                   const char *path,\n                                   unsigned int *wiops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    const char *name = \"wiops=\";\n    char *tmp;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.max\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *wiops = 0;\n    } else {\n        if (!(tmp = strstr(str, name))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to find '%s' limit for block device '%s'\"),\n                           name, path);\n            return -1;\n        }\n        tmp += strlen(name);\n\n        if (STREQLEN(tmp, \"max\", 3)) {\n            *wiops = 0;\n        } else if (virStrToLong_ui(tmp, &tmp, 10, wiops) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           str);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "wiops"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQLEN",
          "args": [
            "tmp",
            "\"max\"",
            "3"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to find '%s' limit for block device '%s'\")",
            "name",
            "path"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str",
            "name"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "path",
            "&str"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.max\"",
            "&value"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetBlkioDeviceWriteIops(virCgroupPtr group,\n                                   const char *path,\n                                   unsigned int *wiops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    const char *name = \"wiops=\";\n    char *tmp;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.max\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *wiops = 0;\n    } else {\n        if (!(tmp = strstr(str, name))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to find '%s' limit for block device '%s'\"),\n                           name, path);\n            return -1;\n        }\n        tmp += strlen(name);\n\n        if (STREQLEN(tmp, \"max\", 3)) {\n            *wiops = 0;\n        } else if (virStrToLong_ui(tmp, &tmp, 10, wiops) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           str);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "950-971",
    "snippet": "static int\nvirCgroupV2SetBlkioDeviceWriteIops(virCgroupPtr group,\n                                   const char *path,\n                                   unsigned int wiops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (wiops == 0) {\n        str = g_strdup_printf(\"%swiops=max\", blkstr);\n    } else {\n        str = g_strdup_printf(\"%swiops=%u\", blkstr, wiops);\n    }\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"io.max\",\n                                str);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.max\"",
            "str"
          ],
          "line": 967
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%swiops=%u\"",
            "blkstr",
            "wiops"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetBlkioDeviceWriteIops(virCgroupPtr group,\n                                   const char *path,\n                                   unsigned int wiops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (wiops == 0) {\n        str = g_strdup_printf(\"%swiops=max\", blkstr);\n    } else {\n        str = g_strdup_printf(\"%swiops=%u\", blkstr, wiops);\n    }\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"io.max\",\n                                str);\n}"
  },
  {
    "function_name": "virCgroupV2GetBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "905-947",
    "snippet": "static int\nvirCgroupV2GetBlkioDeviceReadIops(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned int *riops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    const char *name = \"riops=\";\n    char *tmp;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.max\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *riops = 0;\n    } else {\n        if (!(tmp = strstr(str, name))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to find '%s' limit for block device '%s'\"),\n                           name, path);\n            return -1;\n        }\n        tmp += strlen(name);\n\n        if (STREQLEN(tmp, \"max\", 3)) {\n            *riops = 0;\n        } else if (virStrToLong_ui(tmp, &tmp, 10, riops) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           str);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "riops"
          ],
          "line": 938
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQLEN",
          "args": [
            "tmp",
            "\"max\"",
            "3"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to find '%s' limit for block device '%s'\")",
            "name",
            "path"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str",
            "name"
          ],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "path",
            "&str"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.max\"",
            "&value"
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetBlkioDeviceReadIops(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned int *riops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    const char *name = \"riops=\";\n    char *tmp;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.max\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *riops = 0;\n    } else {\n        if (!(tmp = strstr(str, name))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to find '%s' limit for block device '%s'\"),\n                           name, path);\n            return -1;\n        }\n        tmp += strlen(name);\n\n        if (STREQLEN(tmp, \"max\", 3)) {\n            *riops = 0;\n        } else if (virStrToLong_ui(tmp, &tmp, 10, riops) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse '%s' as an integer\"),\n                           str);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "881-902",
    "snippet": "static int\nvirCgroupV2SetBlkioDeviceReadIops(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned int riops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (riops == 0) {\n        str = g_strdup_printf(\"%sriops=max\", blkstr);\n    } else {\n        str = g_strdup_printf(\"%sriops=%u\", blkstr, riops);\n    }\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"io.max\",\n                                str);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.max\"",
            "str"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%sriops=%u\"",
            "blkstr",
            "riops"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetBlkioDeviceReadIops(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned int riops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (riops == 0) {\n        str = g_strdup_printf(\"%sriops=max\", blkstr);\n    } else {\n        str = g_strdup_printf(\"%sriops=%u\", blkstr, riops);\n    }\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"io.max\",\n                                str);\n}"
  },
  {
    "function_name": "virCgroupV2GetBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "841-878",
    "snippet": "static int\nvirCgroupV2GetBlkioDeviceWeight(virCgroupPtr group,\n                                const char *devPath,\n                                unsigned int *weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    char *tmp;\n\n    if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"io.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for cfq scheduler\"));\n        return -1;\n    }\n\n    if (virCgroupGetValueRaw(path, &value) < 0)\n        return -1;\n\n    if (virCgroupGetValueForBlkDev(value, devPath, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *weight = 0;\n    } else if (virStrToLong_ui(str, &tmp, 10, weight) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "str",
            "&tmp",
            "10",
            "weight"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "devPath",
            "&str"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueRaw",
          "args": [
            "path",
            "&value"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "475-496",
          "snippet": "int\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio device weight is valid only for cfq scheduler\")"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 856
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2PathOfController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.weight\"",
            "&path"
          ],
          "line": 851
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "341-358",
          "snippet": "static int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetBlkioDeviceWeight(virCgroupPtr group,\n                                const char *devPath,\n                                unsigned int *weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    char *tmp;\n\n    if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"io.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for cfq scheduler\"));\n        return -1;\n    }\n\n    if (virCgroupGetValueRaw(path, &value) < 0)\n        return -1;\n\n    if (virCgroupGetValueForBlkDev(value, devPath, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *weight = 0;\n    } else if (virStrToLong_ui(str, &tmp, 10, weight) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "812-838",
    "snippet": "static int\nvirCgroupV2SetBlkioDeviceWeight(virCgroupPtr group,\n                                const char *devPath,\n                                unsigned int weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(devPath)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%d\", blkstr, weight);\n\n    if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"io.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for cfq scheduler\"));\n        return -1;\n    }\n\n    return virCgroupSetValueRaw(path, str);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueRaw",
          "args": [
            "path",
            "str"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "451-472",
          "snippet": "int\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio device weight is valid only for cfq scheduler\")"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"blkio device weight is valid only for cfq scheduler\""
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2PathOfController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.weight\"",
            "&path"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "341-358",
          "snippet": "static int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "devPath"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetBlkioDeviceWeight(virCgroupPtr group,\n                                const char *devPath,\n                                unsigned int weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(devPath)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%d\", blkstr, weight);\n\n    if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"io.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for cfq scheduler\"));\n        return -1;\n    }\n\n    return virCgroupSetValueRaw(path, str);\n}"
  },
  {
    "function_name": "virCgroupV2GetBlkioIoDeviceServiced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "749-809",
    "snippet": "static int\nvirCgroupV2GetBlkioIoDeviceServiced(virCgroupPtr group,\n                                    const char *path,\n                                    long long *bytes_read,\n                                    long long *bytes_write,\n                                    long long *requests_read,\n                                    long long *requests_write)\n{\n    g_autofree char *str1 = NULL;\n    g_autofree char *str2 = NULL;\n    char *p1;\n    size_t i;\n\n    const char *value_names[] = {\n        \"rbytes=\",\n        \"wbytes=\",\n        \"rios=\",\n        \"wios=\",\n    };\n    long long *value_ptrs[] = {\n        bytes_read,\n        bytes_write,\n        requests_read,\n        requests_write\n    };\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.stat\", &str1) < 0) {\n        return -1;\n    }\n\n    if (!(str2 = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (!(p1 = strstr(str1, str2))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find byte stats for block device '%s'\"),\n                       str2);\n        return -1;\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(value_names); i++) {\n        if (!(p1 = strstr(p1, value_names[i]))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot find byte '%s' stats for block device '%s'\"),\n                           value_names[i], str2);\n            return -1;\n        }\n\n        p1 += strlen(value_names[i]);\n        if (virStrToLong_ll(p1, &p1, 10, value_ptrs[i]) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot parse '%s' stat '%s'\"),\n                           value_names[i], p1);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse '%s' stat '%s'\")",
            "value_names[i]",
            "p1"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse '%s' stat '%s'\""
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "p1",
            "&p1",
            "10",
            "value_ptrs[i]"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value_names[i]"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find byte '%s' stats for block device '%s'\")",
            "value_names[i]",
            "str2"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p1",
            "value_names[i]"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "value_names"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find byte stats for block device '%s'\")",
            "str2"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str1",
            "str2"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.stat\"",
            "&str1"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetBlkioIoDeviceServiced(virCgroupPtr group,\n                                    const char *path,\n                                    long long *bytes_read,\n                                    long long *bytes_write,\n                                    long long *requests_read,\n                                    long long *requests_write)\n{\n    g_autofree char *str1 = NULL;\n    g_autofree char *str2 = NULL;\n    char *p1;\n    size_t i;\n\n    const char *value_names[] = {\n        \"rbytes=\",\n        \"wbytes=\",\n        \"rios=\",\n        \"wios=\",\n    };\n    long long *value_ptrs[] = {\n        bytes_read,\n        bytes_write,\n        requests_read,\n        requests_write\n    };\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.stat\", &str1) < 0) {\n        return -1;\n    }\n\n    if (!(str2 = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (!(p1 = strstr(str1, str2))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find byte stats for block device '%s'\"),\n                       str2);\n        return -1;\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(value_names); i++) {\n        if (!(p1 = strstr(p1, value_names[i]))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot find byte '%s' stats for block device '%s'\"),\n                           value_names[i], str2);\n            return -1;\n        }\n\n        p1 += strlen(value_names[i]);\n        if (virStrToLong_ll(p1, &p1, 10, value_ptrs[i]) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot parse '%s' stat '%s'\"),\n                           value_names[i], p1);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2GetBlkioIoServiced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "685-746",
    "snippet": "static int\nvirCgroupV2GetBlkioIoServiced(virCgroupPtr group,\n                              long long *bytes_read,\n                              long long *bytes_write,\n                              long long *requests_read,\n                              long long *requests_write)\n{\n    long long stats_val;\n    g_autofree char *str1 = NULL;\n    char *p1;\n    size_t i;\n\n    const char *value_names[] = {\n        \"rbytes=\",\n        \"wbytes=\",\n        \"rios=\",\n        \"wios=\",\n    };\n    long long *value_ptrs[] = {\n        bytes_read,\n        bytes_write,\n        requests_read,\n        requests_write\n    };\n\n    *bytes_read = 0;\n    *bytes_write = 0;\n    *requests_read = 0;\n    *requests_write = 0;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.stat\", &str1) < 0) {\n        return -1;\n    }\n\n    /* sum up all entries of the same kind, from all devices */\n    for (i = 0; i < G_N_ELEMENTS(value_names); i++) {\n        p1 = str1;\n\n        while ((p1 = strstr(p1, value_names[i]))) {\n            p1 += strlen(value_names[i]);\n            if (virStrToLong_ll(p1, &p1, 10, &stats_val) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Cannot parse byte '%s' stat '%s'\"),\n                               value_names[i], p1);\n                return -1;\n            }\n\n            if (stats_val < 0 ||\n                (stats_val > 0 && *value_ptrs[i] > (LLONG_MAX - stats_val))) {\n                virReportError(VIR_ERR_OVERFLOW,\n                               _(\"Sum of byte '%s' stat overflows\"),\n                               value_names[i]);\n                return -1;\n            }\n            *value_ptrs[i] += stats_val;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"Sum of byte '%s' stat overflows\")",
            "value_names[i]"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Sum of byte '%s' stat overflows\""
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse byte '%s' stat '%s'\")",
            "value_names[i]",
            "p1"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "p1",
            "&p1",
            "10",
            "&stats_val"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value_names[i]"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p1",
            "value_names[i]"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "value_names"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.stat\"",
            "&str1"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetBlkioIoServiced(virCgroupPtr group,\n                              long long *bytes_read,\n                              long long *bytes_write,\n                              long long *requests_read,\n                              long long *requests_write)\n{\n    long long stats_val;\n    g_autofree char *str1 = NULL;\n    char *p1;\n    size_t i;\n\n    const char *value_names[] = {\n        \"rbytes=\",\n        \"wbytes=\",\n        \"rios=\",\n        \"wios=\",\n    };\n    long long *value_ptrs[] = {\n        bytes_read,\n        bytes_write,\n        requests_read,\n        requests_write\n    };\n\n    *bytes_read = 0;\n    *bytes_write = 0;\n    *requests_read = 0;\n    *requests_write = 0;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"io.stat\", &str1) < 0) {\n        return -1;\n    }\n\n    /* sum up all entries of the same kind, from all devices */\n    for (i = 0; i < G_N_ELEMENTS(value_names); i++) {\n        p1 = str1;\n\n        while ((p1 = strstr(p1, value_names[i]))) {\n            p1 += strlen(value_names[i]);\n            if (virStrToLong_ll(p1, &p1, 10, &stats_val) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Cannot parse byte '%s' stat '%s'\"),\n                               value_names[i], p1);\n                return -1;\n            }\n\n            if (stats_val < 0 ||\n                (stats_val > 0 && *value_ptrs[i] > (LLONG_MAX - stats_val))) {\n                virReportError(VIR_ERR_OVERFLOW,\n                               _(\"Sum of byte '%s' stat overflows\"),\n                               value_names[i]);\n                return -1;\n            }\n            *value_ptrs[i] += stats_val;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2GetBlkioWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "637-682",
    "snippet": "static int\nvirCgroupV2GetBlkioWeight(virCgroupPtr group,\n                          unsigned int *weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *value = NULL;\n    char *tmp;\n\n    if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"io.bfq.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        VIR_FREE(path);\n\n        if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                        \"io.weight\", &path) < 0) {\n            return -1;\n        }\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio weight is valid only for bfq or cfq scheduler\"));\n        return -1;\n    }\n\n    if (virCgroupGetValueRaw(path, &value) < 0)\n        return -1;\n\n    if ((tmp = strstr(value, \"default \"))) {\n        tmp += strlen(\"default \");\n    } else {\n        tmp = value;\n    }\n\n    if (virStrToLong_ui(tmp, &tmp, 10, weight) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       tmp);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "tmp"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "weight"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"default \""
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "value",
            "\"default \""
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueRaw",
          "args": [
            "path",
            "&value"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "475-496",
          "snippet": "int\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio weight is valid only for bfq or cfq scheduler\")"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2PathOfController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.weight\"",
            "&path"
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "341-358",
          "snippet": "static int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetBlkioWeight(virCgroupPtr group,\n                          unsigned int *weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *value = NULL;\n    char *tmp;\n\n    if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"io.bfq.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        VIR_FREE(path);\n\n        if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                        \"io.weight\", &path) < 0) {\n            return -1;\n        }\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio weight is valid only for bfq or cfq scheduler\"));\n        return -1;\n    }\n\n    if (virCgroupGetValueRaw(path, &value) < 0)\n        return -1;\n\n    if ((tmp = strstr(value, \"default \"))) {\n        tmp += strlen(\"default \");\n    } else {\n        tmp = value;\n    }\n\n    if (virStrToLong_ui(tmp, &tmp, 10, weight) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       tmp);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2SetBlkioWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "602-634",
    "snippet": "static int\nvirCgroupV2SetBlkioWeight(virCgroupPtr group,\n                          unsigned int weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *value = NULL;\n    const char *format = \"%u\";\n\n    if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"io.bfq.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        VIR_FREE(path);\n        format = \"default %u\";\n\n        if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                        \"io.weight\", &path) < 0) {\n            return -1;\n        }\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio weight is valid only for bfq or cfq scheduler\"));\n        return -1;\n    }\n\n    value = g_strdup_printf(format, weight);\n\n    return virCgroupSetValueRaw(path, value);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueRaw",
          "args": [
            "path",
            "value"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "451-472",
          "snippet": "int\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "format",
            "weight"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio weight is valid only for bfq or cfq scheduler\")"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2PathOfController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"io.weight\"",
            "&path"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "341-358",
          "snippet": "static int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetBlkioWeight(virCgroupPtr group,\n                          unsigned int weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *value = NULL;\n    const char *format = \"%u\";\n\n    if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"io.bfq.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        VIR_FREE(path);\n        format = \"default %u\";\n\n        if (virCgroupV2PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                        \"io.weight\", &path) < 0) {\n            return -1;\n        }\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio weight is valid only for bfq or cfq scheduler\"));\n        return -1;\n    }\n\n    value = g_strdup_printf(format, weight);\n\n    return virCgroupSetValueRaw(path, value);\n}"
  },
  {
    "function_name": "virCgroupV2SetOwner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "578-599",
    "snippet": "static int\nvirCgroupV2SetOwner(virCgroupPtr cgroup,\n                    uid_t uid,\n                    gid_t gid,\n                    int controllers G_GNUC_UNUSED)\n{\n    g_autofree char *base = NULL;\n\n    base = g_strdup_printf(\"%s%s\", cgroup->unified.mountPoint,\n                           cgroup->unified.placement);\n\n    if (virFileChownFiles(base, uid, gid) < 0)\n        return -1;\n\n    if (chown(base, uid, gid) < 0) {\n        virReportSystemError(errno, _(\"cannot chown '%s' to (%u, %u)\"),\n                             base, uid, gid);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot chown '%s' to (%u, %u)\")",
            "base",
            "uid",
            "gid"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot chown '%s' to (%u, %u)\""
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chown",
          "args": [
            "base",
            "uid",
            "gid"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileChownFiles",
          "args": [
            "base",
            "uid",
            "gid"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "virFileChownFiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3019-3028",
          "snippet": "int virFileChownFiles(const char *name,\n                      uid_t uid,\n                      gid_t gid)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"cannot chown '%s' to (%u, %u)\"),\n                         name, (unsigned int) uid,\n                         (unsigned int) gid);\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileChownFiles(const char *name,\n                      uid_t uid,\n                      gid_t gid)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"cannot chown '%s' to (%u, %u)\"),\n                         name, (unsigned int) uid,\n                         (unsigned int) gid);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2SetOwner(virCgroupPtr cgroup,\n                    uid_t uid,\n                    gid_t gid,\n                    int controllers G_GNUC_UNUSED)\n{\n    g_autofree char *base = NULL;\n\n    base = g_strdup_printf(\"%s%s\", cgroup->unified.mountPoint,\n                           cgroup->unified.placement);\n\n    if (virFileChownFiles(base, uid, gid) < 0)\n        return -1;\n\n    if (chown(base, uid, gid) < 0) {\n        virReportSystemError(errno, _(\"cannot chown '%s' to (%u, %u)\"),\n                             base, uid, gid);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2BindMount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "548-575",
    "snippet": "static int\nvirCgroupV2BindMount(virCgroupPtr group,\n                     const char *oldroot,\n                     const char *mountopts)\n{\n    g_autofree char *opts = NULL;\n    g_autofree char *src = NULL;\n\n    VIR_DEBUG(\"Mounting cgroups at '%s'\", group->unified.mountPoint);\n\n    if (virFileMakePath(group->unified.mountPoint) < 0) {\n        virReportSystemError(errno, _(\"Unable to create directory %s\"),\n                             group->unified.mountPoint);\n        return -1;\n    }\n\n    opts = g_strdup_printf(\"mode=755,size=65536%s\", mountopts);\n\n    src = g_strdup_printf(\"%s%s\", oldroot, group->unified.mountPoint);\n\n    if (mount(src, group->unified.mountPoint, \"none\", MS_BIND, NULL) < 0) {\n        virReportSystemError(errno, _(\"Failed to bind cgroup '%s' on '%s'\"),\n                             src, group->unified.mountPoint);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to bind cgroup '%s' on '%s'\")",
            "src",
            "group->unified.mountPoint"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to bind cgroup '%s' on '%s'\""
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "src",
            "group->unified.mountPoint",
            "\"none\"",
            "MS_BIND",
            "NULL"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to create directory %s\")",
            "group->unified.mountPoint"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "group->unified.mountPoint"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Mounting cgroups at '%s'\"",
            "group->unified.mountPoint"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2BindMount(virCgroupPtr group,\n                     const char *oldroot,\n                     const char *mountopts)\n{\n    g_autofree char *opts = NULL;\n    g_autofree char *src = NULL;\n\n    VIR_DEBUG(\"Mounting cgroups at '%s'\", group->unified.mountPoint);\n\n    if (virFileMakePath(group->unified.mountPoint) < 0) {\n        virReportSystemError(errno, _(\"Unable to create directory %s\"),\n                             group->unified.mountPoint);\n        return -1;\n    }\n\n    opts = g_strdup_printf(\"mode=755,size=65536%s\", mountopts);\n\n    src = g_strdup_printf(\"%s%s\", oldroot, group->unified.mountPoint);\n\n    if (mount(src, group->unified.mountPoint, \"none\", MS_BIND, NULL) < 0) {\n        virReportSystemError(errno, _(\"Failed to bind cgroup '%s' on '%s'\"),\n                             src, group->unified.mountPoint);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2KillRecursive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "533-545",
    "snippet": "static int\nvirCgroupV2KillRecursive(virCgroupPtr group,\n                         int signum,\n                         virHashTablePtr pids)\n{\n    int controller = virCgroupV2GetAnyController(group);\n\n    if (controller < 0)\n        return -1;\n\n    return virCgroupKillRecursiveInternal(group, signum, pids, controller,\n                                          \"cgroup.threads\", false);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupKillRecursiveInternal",
          "args": [
            "group",
            "signum",
            "pids",
            "controller",
            "\"cgroup.threads\"",
            "false"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupKillRecursiveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2510-2579",
          "snippet": "int\nvirCgroupKillRecursiveInternal(virCgroupPtr group,\n                               int signum,\n                               virHashTablePtr pids,\n                               int controller,\n                               const char *taskFile,\n                               bool dormdir)\n{\n    int ret = -1;\n    int rc;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    DIR *dp = NULL;\n    virCgroupPtr subgroup = NULL;\n    struct dirent *ent;\n    int direrr;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, \"\", &keypath) < 0)\n        return -1;\n\n    if ((rc = virCgroupKillInternal(group, signum, pids,\n                                    controller, taskFile)) < 0) {\n        goto cleanup;\n    }\n    if (rc == 1)\n        killedAny = true;\n\n    VIR_DEBUG(\"Iterate over children of %s (killedAny=%d)\", keypath, killedAny);\n    if ((rc = virDirOpenIfExists(&dp, keypath)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        VIR_DEBUG(\"Path %s does not exist, assuming done\", keypath);\n        killedAny = false;\n        goto done;\n    }\n\n    while ((direrr = virDirRead(dp, &ent, keypath)) > 0) {\n        if (ent->d_type != DT_DIR)\n            continue;\n\n        VIR_DEBUG(\"Process subdir %s\", ent->d_name);\n\n        if (virCgroupNew(-1, ent->d_name, group, -1, &subgroup) < 0)\n            goto cleanup;\n\n        if ((rc = virCgroupKillRecursiveInternal(subgroup, signum, pids,\n                                                 controller, taskFile, true)) < 0)\n            goto cleanup;\n        if (rc == 1)\n            killedAny = true;\n\n        if (dormdir)\n            virCgroupRemove(subgroup);\n\n        virCgroupFree(&subgroup);\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    virCgroupFree(&subgroup);\n    VIR_DIR_CLOSE(dp);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupKillRecursiveInternal(virCgroupPtr group,\n                               int signum,\n                               virHashTablePtr pids,\n                               int controller,\n                               const char *taskFile,\n                               bool dormdir)\n{\n    int ret = -1;\n    int rc;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    DIR *dp = NULL;\n    virCgroupPtr subgroup = NULL;\n    struct dirent *ent;\n    int direrr;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, \"\", &keypath) < 0)\n        return -1;\n\n    if ((rc = virCgroupKillInternal(group, signum, pids,\n                                    controller, taskFile)) < 0) {\n        goto cleanup;\n    }\n    if (rc == 1)\n        killedAny = true;\n\n    VIR_DEBUG(\"Iterate over children of %s (killedAny=%d)\", keypath, killedAny);\n    if ((rc = virDirOpenIfExists(&dp, keypath)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        VIR_DEBUG(\"Path %s does not exist, assuming done\", keypath);\n        killedAny = false;\n        goto done;\n    }\n\n    while ((direrr = virDirRead(dp, &ent, keypath)) > 0) {\n        if (ent->d_type != DT_DIR)\n            continue;\n\n        VIR_DEBUG(\"Process subdir %s\", ent->d_name);\n\n        if (virCgroupNew(-1, ent->d_name, group, -1, &subgroup) < 0)\n            goto cleanup;\n\n        if ((rc = virCgroupKillRecursiveInternal(subgroup, signum, pids,\n                                                 controller, taskFile, true)) < 0)\n            goto cleanup;\n        if (rc == 1)\n            killedAny = true;\n\n        if (dormdir)\n            virCgroupRemove(subgroup);\n\n        virCgroupFree(&subgroup);\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    virCgroupFree(&subgroup);\n    VIR_DIR_CLOSE(dp);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2GetAnyController",
          "args": [
            "group"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2GetAnyController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "333-338",
          "snippet": "static int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2KillRecursive(virCgroupPtr group,\n                         int signum,\n                         virHashTablePtr pids)\n{\n    int controller = virCgroupV2GetAnyController(group);\n\n    if (controller < 0)\n        return -1;\n\n    return virCgroupKillRecursiveInternal(group, signum, pids, controller,\n                                          \"cgroup.threads\", false);\n}"
  },
  {
    "function_name": "virCgroupV2HasEmptyTasks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "517-530",
    "snippet": "static int\nvirCgroupV2HasEmptyTasks(virCgroupPtr cgroup,\n                         int controller)\n{\n    int ret = -1;\n    g_autofree char *content = NULL;\n\n    ret = virCgroupGetValueStr(cgroup, controller, \"cgroup.procs\", &content);\n\n    if (ret == 0 && content[0] == '\\0')\n        ret = 1;\n\n    return ret;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "cgroup",
            "controller",
            "\"cgroup.procs\"",
            "&content"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2HasEmptyTasks(virCgroupPtr cgroup,\n                         int controller)\n{\n    int ret = -1;\n    g_autofree char *content = NULL;\n\n    ret = virCgroupGetValueStr(cgroup, controller, \"cgroup.procs\", &content);\n\n    if (ret == 0 && content[0] == '\\0')\n        ret = 1;\n\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV2AddTask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "503-514",
    "snippet": "static int\nvirCgroupV2AddTask(virCgroupPtr group,\n                   pid_t pid,\n                   unsigned int flags)\n{\n    int controller = virCgroupV2GetAnyController(group);\n\n    if (flags & VIR_CGROUP_TASK_THREAD)\n        return virCgroupSetValueI64(group, controller, \"cgroup.threads\", pid);\n    else\n        return virCgroupSetValueI64(group, controller, \"cgroup.procs\", pid);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueI64",
          "args": [
            "group",
            "controller",
            "\"cgroup.procs\"",
            "pid"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueI64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "567-578",
          "snippet": "int\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2GetAnyController",
          "args": [
            "group"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2GetAnyController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "333-338",
          "snippet": "static int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2AddTask(virCgroupPtr group,\n                   pid_t pid,\n                   unsigned int flags)\n{\n    int controller = virCgroupV2GetAnyController(group);\n\n    if (flags & VIR_CGROUP_TASK_THREAD)\n        return virCgroupSetValueI64(group, controller, \"cgroup.threads\", pid);\n    else\n        return virCgroupSetValueI64(group, controller, \"cgroup.procs\", pid);\n}"
  },
  {
    "function_name": "virCgroupV2Remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "481-500",
    "snippet": "static int\nvirCgroupV2Remove(virCgroupPtr group)\n{\n    g_autofree char *grppath = NULL;\n    int controller;\n\n    /* Don't delete the root group, if we accidentally\n       ended up in it for some reason */\n    if (STREQ(group->unified.placement, \"/\"))\n        return 0;\n\n    controller = virCgroupV2GetAnyController(group);\n    if (virCgroupV2PathOfController(group, controller, \"\", &grppath) < 0)\n        return 0;\n\n    if (virCgroupV2DevicesRemoveProg(group) < 0)\n        return -1;\n\n    return virCgroupRemoveRecursively(grppath);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupRemoveRecursively",
          "args": [
            "grppath"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemoveRecursively",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2324-2367",
          "snippet": "int\nvirCgroupRemoveRecursively(char *grppath)\n{\n    DIR *grpdir;\n    struct dirent *ent;\n    int rc = 0;\n    int direrr;\n\n    if (virDirOpenQuiet(&grpdir, grppath) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to open %s (%d)\"), grppath, errno);\n        return rc;\n    }\n\n    /* This is best-effort cleanup: we want to log failures with just\n     * VIR_ERROR instead of normal virReportError */\n    while ((direrr = virDirRead(grpdir, &ent, NULL)) > 0) {\n        g_autofree char *path = NULL;\n\n        if (ent->d_type != DT_DIR) continue;\n\n        path = g_strdup_printf(\"%s/%s\", grppath, ent->d_name);\n\n        rc = virCgroupRemoveRecursively(path);\n        if (rc != 0)\n            break;\n    }\n    if (direrr < 0) {\n        rc = -errno;\n        VIR_ERROR(_(\"Failed to readdir for %s (%d)\"), grppath, errno);\n    }\n\n    VIR_DIR_CLOSE(grpdir);\n\n    VIR_DEBUG(\"Removing cgroup %s\", grppath);\n    if (rmdir(grppath) != 0 && errno != ENOENT) {\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to remove %s (%d)\"), grppath, errno);\n    }\n\n    return rc;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemoveRecursively(char *grppath)\n{\n    DIR *grpdir;\n    struct dirent *ent;\n    int rc = 0;\n    int direrr;\n\n    if (virDirOpenQuiet(&grpdir, grppath) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to open %s (%d)\"), grppath, errno);\n        return rc;\n    }\n\n    /* This is best-effort cleanup: we want to log failures with just\n     * VIR_ERROR instead of normal virReportError */\n    while ((direrr = virDirRead(grpdir, &ent, NULL)) > 0) {\n        g_autofree char *path = NULL;\n\n        if (ent->d_type != DT_DIR) continue;\n\n        path = g_strdup_printf(\"%s/%s\", grppath, ent->d_name);\n\n        rc = virCgroupRemoveRecursively(path);\n        if (rc != 0)\n            break;\n    }\n    if (direrr < 0) {\n        rc = -errno;\n        VIR_ERROR(_(\"Failed to readdir for %s (%d)\"), grppath, errno);\n    }\n\n    VIR_DIR_CLOSE(grpdir);\n\n    VIR_DEBUG(\"Removing cgroup %s\", grppath);\n    if (rmdir(grppath) != 0 && errno != ENOENT) {\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to remove %s (%d)\"), grppath, errno);\n    }\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesRemoveProg",
          "args": [
            "group"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesRemoveProg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "622-626",
          "snippet": "int\nvirCgroupV2DevicesRemoveProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nint\nvirCgroupV2DevicesRemoveProg(virCgroupPtr group G_GNUC_UNUSED)\n{\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2PathOfController",
          "args": [
            "group",
            "controller",
            "\"\"",
            "&grppath"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "341-358",
          "snippet": "static int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2GetAnyController",
          "args": [
            "group"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2GetAnyController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "333-338",
          "snippet": "static int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "group->unified.placement",
            "\"/\""
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2Remove(virCgroupPtr group)\n{\n    g_autofree char *grppath = NULL;\n    int controller;\n\n    /* Don't delete the root group, if we accidentally\n       ended up in it for some reason */\n    if (STREQ(group->unified.placement, \"/\"))\n        return 0;\n\n    controller = virCgroupV2GetAnyController(group);\n    if (virCgroupV2PathOfController(group, controller, \"\", &grppath) < 0)\n        return 0;\n\n    if (virCgroupV2DevicesRemoveProg(group) < 0)\n        return -1;\n\n    return virCgroupRemoveRecursively(grppath);\n}"
  },
  {
    "function_name": "virCgroupV2MakeGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "399-478",
    "snippet": "static int\nvirCgroupV2MakeGroup(virCgroupPtr parent,\n                     virCgroupPtr group,\n                     bool create,\n                     unsigned int flags)\n{\n    g_autofree char *path = NULL;\n    int controller;\n\n    if (flags & VIR_CGROUP_SYSTEMD) {\n        VIR_DEBUG(\"Running with systemd so we should not create cgroups ourselves.\");\n        return 0;\n    }\n\n    VIR_DEBUG(\"Make group %s\", group->path);\n\n    controller = virCgroupV2GetAnyController(group);\n    if (virCgroupV2PathOfController(group, controller, \"\", &path) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Make controller %s\", path);\n\n    if (!virFileExists(path) &&\n        (!create || (mkdir(path, 0755) < 0 && errno != EEXIST))) {\n        virReportSystemError(errno, _(\"Failed to create v2 cgroup '%s'\"),\n                             group->path);\n        return -1;\n    }\n\n    if (create) {\n        if (flags & VIR_CGROUP_THREAD) {\n            if (virCgroupSetValueStr(group, controller,\n                                     \"cgroup.type\", \"threaded\") < 0) {\n                return -1;\n            }\n\n            if (virCgroupV2HasController(parent, VIR_CGROUP_CONTROLLER_CPU) &&\n                virCgroupV2EnableController(group, parent,\n                                            VIR_CGROUP_CONTROLLER_CPU,\n                                            true) < 0) {\n                return -1;\n            }\n\n            if (virCgroupV2HasController(parent, VIR_CGROUP_CONTROLLER_CPUSET) &&\n                virCgroupV2EnableController(group, parent,\n                                            VIR_CGROUP_CONTROLLER_CPUSET,\n                                            true) < 0) {\n                return -1;\n            }\n        } else {\n            size_t i;\n            for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n                int rc;\n\n                if (!virCgroupV2HasController(parent, i))\n                    continue;\n\n                /* Controllers that are implicitly enabled if available. */\n                if (i == VIR_CGROUP_CONTROLLER_CPUACCT ||\n                    i == VIR_CGROUP_CONTROLLER_DEVICES) {\n                    continue;\n                }\n\n                rc = virCgroupV2EnableController(group, parent, i, false);\n                if (rc < 0) {\n                    if (rc == -2) {\n                        virResetLastError();\n                        VIR_DEBUG(\"failed to enable '%s' controller, skipping\",\n                                  virCgroupV2ControllerTypeToString(i));\n                        group->unified.controllers &= ~(1 << i);\n                        continue;\n                    }\n                    return -1;\n                }\n            }\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"failed to enable '%s' controller, skipping\"",
            "virCgroupV2ControllerTypeToString(i)"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV2ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2EnableController",
          "args": [
            "group",
            "parent",
            "i",
            "false"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2EnableController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "368-396",
          "snippet": "static int\nvirCgroupV2EnableController(virCgroupPtr group,\n                            virCgroupPtr parent,\n                            int controller,\n                            bool report)\n{\n    g_autofree char *val = NULL;\n    g_autofree char *path = NULL;\n\n    val = g_strdup_printf(\"+%s\", virCgroupV2ControllerTypeToString(controller));\n\n    if (virCgroupPathOfController(parent, controller,\n                                  \"cgroup.subtree_control\", &path) < 0) {\n        return -1;\n    }\n\n    if (virFileWriteStr(path, val, 0) < 0) {\n        if (report) {\n            virReportSystemError(errno,\n                                 _(\"Failed to enable controller '%s' for '%s'\"),\n                                 val, path);\n        }\n        return -2;\n    }\n\n    group->unified.controllers |= 1 << controller;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2EnableController(virCgroupPtr group,\n                            virCgroupPtr parent,\n                            int controller,\n                            bool report)\n{\n    g_autofree char *val = NULL;\n    g_autofree char *path = NULL;\n\n    val = g_strdup_printf(\"+%s\", virCgroupV2ControllerTypeToString(controller));\n\n    if (virCgroupPathOfController(parent, controller,\n                                  \"cgroup.subtree_control\", &path) < 0) {\n        return -1;\n    }\n\n    if (virFileWriteStr(path, val, 0) < 0) {\n        if (report) {\n            virReportSystemError(errno,\n                                 _(\"Failed to enable controller '%s' for '%s'\"),\n                                 val, path);\n        }\n        return -2;\n    }\n\n    group->unified.controllers |= 1 << controller;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2HasController",
          "args": [
            "parent",
            "i"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2HasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "325-330",
          "snippet": "static bool\nvirCgroupV2HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->unified.controllers & (1 << controller);\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV2HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->unified.controllers & (1 << controller);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "controller",
            "\"cgroup.type\"",
            "\"threaded\""
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to create v2 cgroup '%s'\")",
            "group->path"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to create v2 cgroup '%s'\""
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "path",
            "0755"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Make controller %s\"",
            "path"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV2PathOfController",
          "args": [
            "group",
            "controller",
            "\"\"",
            "&path"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "341-358",
          "snippet": "static int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2GetAnyController",
          "args": [
            "group"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2GetAnyController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "333-338",
          "snippet": "static int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Make group %s\"",
            "group->path"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Running with systemd so we should not create cgroups ourselves.\""
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2MakeGroup(virCgroupPtr parent,\n                     virCgroupPtr group,\n                     bool create,\n                     unsigned int flags)\n{\n    g_autofree char *path = NULL;\n    int controller;\n\n    if (flags & VIR_CGROUP_SYSTEMD) {\n        VIR_DEBUG(\"Running with systemd so we should not create cgroups ourselves.\");\n        return 0;\n    }\n\n    VIR_DEBUG(\"Make group %s\", group->path);\n\n    controller = virCgroupV2GetAnyController(group);\n    if (virCgroupV2PathOfController(group, controller, \"\", &path) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Make controller %s\", path);\n\n    if (!virFileExists(path) &&\n        (!create || (mkdir(path, 0755) < 0 && errno != EEXIST))) {\n        virReportSystemError(errno, _(\"Failed to create v2 cgroup '%s'\"),\n                             group->path);\n        return -1;\n    }\n\n    if (create) {\n        if (flags & VIR_CGROUP_THREAD) {\n            if (virCgroupSetValueStr(group, controller,\n                                     \"cgroup.type\", \"threaded\") < 0) {\n                return -1;\n            }\n\n            if (virCgroupV2HasController(parent, VIR_CGROUP_CONTROLLER_CPU) &&\n                virCgroupV2EnableController(group, parent,\n                                            VIR_CGROUP_CONTROLLER_CPU,\n                                            true) < 0) {\n                return -1;\n            }\n\n            if (virCgroupV2HasController(parent, VIR_CGROUP_CONTROLLER_CPUSET) &&\n                virCgroupV2EnableController(group, parent,\n                                            VIR_CGROUP_CONTROLLER_CPUSET,\n                                            true) < 0) {\n                return -1;\n            }\n        } else {\n            size_t i;\n            for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n                int rc;\n\n                if (!virCgroupV2HasController(parent, i))\n                    continue;\n\n                /* Controllers that are implicitly enabled if available. */\n                if (i == VIR_CGROUP_CONTROLLER_CPUACCT ||\n                    i == VIR_CGROUP_CONTROLLER_DEVICES) {\n                    continue;\n                }\n\n                rc = virCgroupV2EnableController(group, parent, i, false);\n                if (rc < 0) {\n                    if (rc == -2) {\n                        virResetLastError();\n                        VIR_DEBUG(\"failed to enable '%s' controller, skipping\",\n                                  virCgroupV2ControllerTypeToString(i));\n                        group->unified.controllers &= ~(1 << i);\n                        continue;\n                    }\n                    return -1;\n                }\n            }\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2EnableController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "368-396",
    "snippet": "static int\nvirCgroupV2EnableController(virCgroupPtr group,\n                            virCgroupPtr parent,\n                            int controller,\n                            bool report)\n{\n    g_autofree char *val = NULL;\n    g_autofree char *path = NULL;\n\n    val = g_strdup_printf(\"+%s\", virCgroupV2ControllerTypeToString(controller));\n\n    if (virCgroupPathOfController(parent, controller,\n                                  \"cgroup.subtree_control\", &path) < 0) {\n        return -1;\n    }\n\n    if (virFileWriteStr(path, val, 0) < 0) {\n        if (report) {\n            virReportSystemError(errno,\n                                 _(\"Failed to enable controller '%s' for '%s'\"),\n                                 val, path);\n        }\n        return -2;\n    }\n\n    group->unified.controllers |= 1 << controller;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to enable controller '%s' for '%s'\")",
            "val",
            "path"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to enable controller '%s' for '%s'\""
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileWriteStr",
          "args": [
            "path",
            "val",
            "0"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "virFileWriteStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1502-1524",
          "snippet": "int\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupPathOfController",
          "args": [
            "parent",
            "controller",
            "\"cgroup.subtree_control\"",
            "&path"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2907-2916",
          "snippet": "int\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2ControllerTypeToString",
          "args": [
            "controller"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2EnableController(virCgroupPtr group,\n                            virCgroupPtr parent,\n                            int controller,\n                            bool report)\n{\n    g_autofree char *val = NULL;\n    g_autofree char *path = NULL;\n\n    val = g_strdup_printf(\"+%s\", virCgroupV2ControllerTypeToString(controller));\n\n    if (virCgroupPathOfController(parent, controller,\n                                  \"cgroup.subtree_control\", &path) < 0) {\n        return -1;\n    }\n\n    if (virFileWriteStr(path, val, 0) < 0) {\n        if (report) {\n            virReportSystemError(errno,\n                                 _(\"Failed to enable controller '%s' for '%s'\"),\n                                 val, path);\n        }\n        return -2;\n    }\n\n    group->unified.controllers |= 1 << controller;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2PathOfController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "341-358",
    "snippet": "static int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s/%s\"",
            "group->unified.mountPoint",
            "group->unified.placement",
            "NULLSTR_EMPTY(key)"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NULLSTR_EMPTY",
          "args": [
            "key"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"v2 controller '%s' is not available\")",
            "virCgroupV2ControllerTypeToString(controller)"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV2ControllerTypeToString",
          "args": [
            "controller"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV2HasController",
          "args": [
            "group",
            "controller"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2HasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "325-330",
          "snippet": "static bool\nvirCgroupV2HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->unified.controllers & (1 << controller);\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV2HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->unified.controllers & (1 << controller);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (!virCgroupV2HasController(group, controller)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v2 controller '%s' is not available\"),\n                       virCgroupV2ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->unified.mountPoint,\n                            group->unified.placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2GetAnyController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "333-338",
    "snippet": "static int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__builtin_ffs",
          "args": [
            "group->unified.controllers"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2GetAnyController(virCgroupPtr group)\n{\n    /* The least significant bit is position 1. */\n    return __builtin_ffs(group->unified.controllers) - 1;\n}"
  },
  {
    "function_name": "virCgroupV2HasController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "325-330",
    "snippet": "static bool\nvirCgroupV2HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->unified.controllers & (1 << controller);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV2HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->unified.controllers & (1 << controller);\n}"
  },
  {
    "function_name": "virCgroupV2DetectControllers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "293-322",
    "snippet": "static int\nvirCgroupV2DetectControllers(virCgroupPtr group,\n                             int controllers,\n                             virCgroupPtr parent,\n                             int detected)\n{\n    size_t i;\n\n    if (virCgroupV2ParseControllersFile(group, parent) < 0)\n        return -1;\n\n    /* In cgroup v2 there is no cpuacct controller, the cpu.stat file always\n     * exists with usage stats. */\n    group->unified.controllers |= 1 << VIR_CGROUP_CONTROLLER_CPUACCT;\n\n    if (virCgroupV2DevicesAvailable(group))\n        group->unified.controllers |= 1 << VIR_CGROUP_CONTROLLER_DEVICES;\n\n    if (controllers >= 0)\n        group->unified.controllers &= controllers;\n\n    group->unified.controllers &= ~detected;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++)\n        VIR_DEBUG(\"Controller '%s' present=%s\",\n                  virCgroupV2ControllerTypeToString(i),\n                  (group->unified.controllers & 1 << i) ? \"yes\" : \"no\");\n\n    return group->unified.controllers;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Controller '%s' present=%s\"",
            "virCgroupV2ControllerTypeToString(i)",
            "(group->unified.controllers & 1 << i) ? \"yes\" : \"no\""
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV2ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV2DevicesAvailable",
          "args": [
            "group"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2DevicesAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2devices.c",
          "lines": "585-589",
          "snippet": "bool\nvirCgroupV2DevicesAvailable(virCgroupPtr group G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/types.h>",
            "# include <sys/syscall.h>",
            "# include <sys/stat.h>",
            "# include <linux/bpf.h>",
            "# include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/types.h>\n# include <sys/syscall.h>\n# include <sys/stat.h>\n# include <linux/bpf.h>\n# include <fcntl.h>\n#include <config.h>\n\nbool\nvirCgroupV2DevicesAvailable(virCgroupPtr group G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2ParseControllersFile",
          "args": [
            "group",
            "parent"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2ParseControllersFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "244-290",
          "snippet": "static int\nvirCgroupV2ParseControllersFile(virCgroupPtr group,\n                                virCgroupPtr parent)\n{\n    int rc;\n    g_autofree char *contStr = NULL;\n    g_autofree char *contFile = NULL;\n    char **contList = NULL;\n    char **tmp;\n\n    if (parent) {\n        contFile = g_strdup_printf(\"%s%s/cgroup.subtree_control\",\n                                   parent->unified.mountPoint,\n                                   NULLSTR_EMPTY(parent->unified.placement));\n    } else {\n        contFile = g_strdup_printf(\"%s%s/cgroup.controllers\",\n                                   group->unified.mountPoint,\n                                   NULLSTR_EMPTY(group->unified.placement));\n    }\n\n    rc = virFileReadAll(contFile, 1024 * 1024, &contStr);\n    if (rc < 0) {\n        virReportSystemError(errno, _(\"Unable to read from '%s'\"), contFile);\n        return -1;\n    }\n\n    virTrimSpaces(contStr, NULL);\n\n    contList = virStringSplit(contStr, \" \", 20);\n    if (!contList)\n        return -1;\n\n    tmp = contList;\n\n    while (*tmp) {\n        int type = virCgroupV2ControllerTypeFromString(*tmp);\n\n        if (type >= 0)\n            group->unified.controllers |= 1 << type;\n\n        tmp++;\n    }\n\n    virStringListFree(contList);\n\n    return 0;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2ParseControllersFile(virCgroupPtr group,\n                                virCgroupPtr parent)\n{\n    int rc;\n    g_autofree char *contStr = NULL;\n    g_autofree char *contFile = NULL;\n    char **contList = NULL;\n    char **tmp;\n\n    if (parent) {\n        contFile = g_strdup_printf(\"%s%s/cgroup.subtree_control\",\n                                   parent->unified.mountPoint,\n                                   NULLSTR_EMPTY(parent->unified.placement));\n    } else {\n        contFile = g_strdup_printf(\"%s%s/cgroup.controllers\",\n                                   group->unified.mountPoint,\n                                   NULLSTR_EMPTY(group->unified.placement));\n    }\n\n    rc = virFileReadAll(contFile, 1024 * 1024, &contStr);\n    if (rc < 0) {\n        virReportSystemError(errno, _(\"Unable to read from '%s'\"), contFile);\n        return -1;\n    }\n\n    virTrimSpaces(contStr, NULL);\n\n    contList = virStringSplit(contStr, \" \", 20);\n    if (!contList)\n        return -1;\n\n    tmp = contList;\n\n    while (*tmp) {\n        int type = virCgroupV2ControllerTypeFromString(*tmp);\n\n        if (type >= 0)\n            group->unified.controllers |= 1 << type;\n\n        tmp++;\n    }\n\n    virStringListFree(contList);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2DetectControllers(virCgroupPtr group,\n                             int controllers,\n                             virCgroupPtr parent,\n                             int detected)\n{\n    size_t i;\n\n    if (virCgroupV2ParseControllersFile(group, parent) < 0)\n        return -1;\n\n    /* In cgroup v2 there is no cpuacct controller, the cpu.stat file always\n     * exists with usage stats. */\n    group->unified.controllers |= 1 << VIR_CGROUP_CONTROLLER_CPUACCT;\n\n    if (virCgroupV2DevicesAvailable(group))\n        group->unified.controllers |= 1 << VIR_CGROUP_CONTROLLER_DEVICES;\n\n    if (controllers >= 0)\n        group->unified.controllers &= controllers;\n\n    group->unified.controllers &= ~detected;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++)\n        VIR_DEBUG(\"Controller '%s' present=%s\",\n                  virCgroupV2ControllerTypeToString(i),\n                  (group->unified.controllers & 1 << i) ? \"yes\" : \"no\");\n\n    return group->unified.controllers;\n}"
  },
  {
    "function_name": "virCgroupV2ParseControllersFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "244-290",
    "snippet": "static int\nvirCgroupV2ParseControllersFile(virCgroupPtr group,\n                                virCgroupPtr parent)\n{\n    int rc;\n    g_autofree char *contStr = NULL;\n    g_autofree char *contFile = NULL;\n    char **contList = NULL;\n    char **tmp;\n\n    if (parent) {\n        contFile = g_strdup_printf(\"%s%s/cgroup.subtree_control\",\n                                   parent->unified.mountPoint,\n                                   NULLSTR_EMPTY(parent->unified.placement));\n    } else {\n        contFile = g_strdup_printf(\"%s%s/cgroup.controllers\",\n                                   group->unified.mountPoint,\n                                   NULLSTR_EMPTY(group->unified.placement));\n    }\n\n    rc = virFileReadAll(contFile, 1024 * 1024, &contStr);\n    if (rc < 0) {\n        virReportSystemError(errno, _(\"Unable to read from '%s'\"), contFile);\n        return -1;\n    }\n\n    virTrimSpaces(contStr, NULL);\n\n    contList = virStringSplit(contStr, \" \", 20);\n    if (!contList)\n        return -1;\n\n    tmp = contList;\n\n    while (*tmp) {\n        int type = virCgroupV2ControllerTypeFromString(*tmp);\n\n        if (type >= 0)\n            group->unified.controllers |= 1 << type;\n\n        tmp++;\n    }\n\n    virStringListFree(contList);\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "contList"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2ControllerTypeFromString",
          "args": [
            "*tmp"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "contStr",
            "\" \"",
            "20"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTrimSpaces",
          "args": [
            "contStr",
            "NULL"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "virTrimSpaces",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "835-853",
          "snippet": "void\nvirTrimSpaces(char *str, char **endp)\n{\n    char *end;\n\n    if (!endp || !*endp)\n        end = str + strlen(str);\n    else\n        end = *endp;\n    while (end > str && g_ascii_isspace(end[-1]))\n        end--;\n    if (endp) {\n        if (!*endp)\n            *end = '\\0';\n        *endp = end;\n    } else {\n        *end = '\\0';\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirTrimSpaces(char *str, char **endp)\n{\n    char *end;\n\n    if (!endp || !*endp)\n        end = str + strlen(str);\n    else\n        end = *endp;\n    while (end > str && g_ascii_isspace(end[-1]))\n        end--;\n    if (endp) {\n        if (!*endp)\n            *end = '\\0';\n        *endp = end;\n    } else {\n        *end = '\\0';\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to read from '%s'\")",
            "contFile"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to read from '%s'\""
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "contFile",
            "1024 * 1024",
            "&contStr"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NULLSTR_EMPTY",
          "args": [
            "group->unified.placement"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR_EMPTY",
          "args": [
            "parent->unified.placement"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2ParseControllersFile(virCgroupPtr group,\n                                virCgroupPtr parent)\n{\n    int rc;\n    g_autofree char *contStr = NULL;\n    g_autofree char *contFile = NULL;\n    char **contList = NULL;\n    char **tmp;\n\n    if (parent) {\n        contFile = g_strdup_printf(\"%s%s/cgroup.subtree_control\",\n                                   parent->unified.mountPoint,\n                                   NULLSTR_EMPTY(parent->unified.placement));\n    } else {\n        contFile = g_strdup_printf(\"%s%s/cgroup.controllers\",\n                                   group->unified.mountPoint,\n                                   NULLSTR_EMPTY(group->unified.placement));\n    }\n\n    rc = virFileReadAll(contFile, 1024 * 1024, &contStr);\n    if (rc < 0) {\n        virReportSystemError(errno, _(\"Unable to read from '%s'\"), contFile);\n        return -1;\n    }\n\n    virTrimSpaces(contStr, NULL);\n\n    contList = virStringSplit(contStr, \" \", 20);\n    if (!contList)\n        return -1;\n\n    tmp = contList;\n\n    while (*tmp) {\n        int type = virCgroupV2ControllerTypeFromString(*tmp);\n\n        if (type >= 0)\n            group->unified.controllers |= 1 << type;\n\n        tmp++;\n    }\n\n    virStringListFree(contList);\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2StealPlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "237-241",
    "snippet": "static char *\nvirCgroupV2StealPlacement(virCgroupPtr group)\n{\n    return g_steal_pointer(&group->unified.placement);\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&group->unified.placement"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirCgroupV2StealPlacement(virCgroupPtr group)\n{\n    return g_steal_pointer(&group->unified.placement);\n}"
  },
  {
    "function_name": "virCgroupV2ValidatePlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "223-234",
    "snippet": "static int\nvirCgroupV2ValidatePlacement(virCgroupPtr group,\n                             pid_t pid G_GNUC_UNUSED)\n{\n    if (!group->unified.placement) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find placement for v2 controller\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not find placement for v2 controller\")"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not find placement for v2 controller\""
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2ValidatePlacement(virCgroupPtr group,\n                             pid_t pid G_GNUC_UNUSED)\n{\n    if (!group->unified.placement) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find placement for v2 controller\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2DetectPlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "195-220",
    "snippet": "static int\nvirCgroupV2DetectPlacement(virCgroupPtr group,\n                           const char *path,\n                           const char *controllers,\n                           const char *selfpath)\n{\n    if (group->unified.placement)\n        return 0;\n\n    VIR_DEBUG(\"group=%p path=%s controllers=%s selfpath=%s\",\n              group, path, controllers, selfpath);\n\n    /* controllers == \"\" indicates the cgroupv2 controller path */\n    if (STRNEQ(controllers, \"\"))\n        return 0;\n\n    /*\n     * selfpath == \"/\" + path=\"\" -> \"/\"\n     * selfpath == \"/libvirt.service\" + path == \"\" -> \"/libvirt.service\"\n     * selfpath == \"/libvirt.service\" + path == \"foo\" -> \"/libvirt.service/foo\"\n     */\n    group->unified.placement = g_strdup_printf(\"%s%s%s\", selfpath,\n                                               (STREQ(selfpath, \"/\") || STREQ(path, \"\") ? \"\" : \"/\"), path);\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s%s\"",
            "selfpath",
            "(STREQ(selfpath, \"/\") || STREQ(path, \"\") ? \"\" : \"/\")",
            "path"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "path",
            "\"\""
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "selfpath",
            "\"/\""
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "controllers",
            "\"\""
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"group=%p path=%s controllers=%s selfpath=%s\"",
            "group",
            "path",
            "controllers",
            "selfpath"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2DetectPlacement(virCgroupPtr group,\n                           const char *path,\n                           const char *controllers,\n                           const char *selfpath)\n{\n    if (group->unified.placement)\n        return 0;\n\n    VIR_DEBUG(\"group=%p path=%s controllers=%s selfpath=%s\",\n              group, path, controllers, selfpath);\n\n    /* controllers == \"\" indicates the cgroupv2 controller path */\n    if (STRNEQ(controllers, \"\"))\n        return 0;\n\n    /*\n     * selfpath == \"/\" + path=\"\" -> \"/\"\n     * selfpath == \"/libvirt.service\" + path == \"\" -> \"/libvirt.service\"\n     * selfpath == \"/libvirt.service\" + path == \"foo\" -> \"/libvirt.service/foo\"\n     */\n    group->unified.placement = g_strdup_printf(\"%s%s%s\", selfpath,\n                                               (STREQ(selfpath, \"/\") || STREQ(path, \"\") ? \"\" : \"/\"), path);\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2DetectMounts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "179-192",
    "snippet": "static int\nvirCgroupV2DetectMounts(virCgroupPtr group,\n                        const char *mntType,\n                        const char *mntOpts G_GNUC_UNUSED,\n                        const char *mntDir)\n{\n    if (STRNEQ(mntType, \"cgroup2\"))\n        return 0;\n\n    VIR_FREE(group->unified.mountPoint);\n\n    group->unified.mountPoint = g_strdup(mntDir);\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "mntDir"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "group->unified.mountPoint"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "mntType",
            "\"cgroup2\""
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2DetectMounts(virCgroupPtr group,\n                        const char *mntType,\n                        const char *mntOpts G_GNUC_UNUSED,\n                        const char *mntDir)\n{\n    if (STRNEQ(mntType, \"cgroup2\"))\n        return 0;\n\n    VIR_FREE(group->unified.mountPoint);\n\n    group->unified.mountPoint = g_strdup(mntDir);\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2CopyPlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "153-176",
    "snippet": "static int\nvirCgroupV2CopyPlacement(virCgroupPtr group,\n                         const char *path,\n                         virCgroupPtr parent)\n{\n    VIR_DEBUG(\"group=%p path=%s parent=%p\", group, path, parent);\n\n    if (path[0] == '/') {\n        group->unified.placement = g_strdup(path);\n    } else {\n        bool delim = STREQ(parent->unified.placement, \"/\") || STREQ(path, \"\");\n        /*\n         * parent == \"/\" + path=\"\" => \"/\"\n         * parent == \"/libvirt.service\" + path == \"\" => \"/libvirt.service\"\n         * parent == \"/libvirt.service\" + path == \"foo\" => \"/libvirt.service/foo\"\n         */\n        group->unified.placement = g_strdup_printf(\"%s%s%s\",\n                                                   parent->unified.placement,\n                                                   delim ? \"\" : \"/\",\n                                                   path);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s%s\"",
            "parent->unified.placement",
            "delim ? \"\" : \"/\"",
            "path"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "path",
            "\"\""
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "parent->unified.placement",
            "\"/\""
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"group=%p path=%s parent=%p\"",
            "group",
            "path",
            "parent"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2CopyPlacement(virCgroupPtr group,\n                         const char *path,\n                         virCgroupPtr parent)\n{\n    VIR_DEBUG(\"group=%p path=%s parent=%p\", group, path, parent);\n\n    if (path[0] == '/') {\n        group->unified.placement = g_strdup(path);\n    } else {\n        bool delim = STREQ(parent->unified.placement, \"/\") || STREQ(path, \"\");\n        /*\n         * parent == \"/\" + path=\"\" => \"/\"\n         * parent == \"/libvirt.service\" + path == \"\" => \"/libvirt.service\"\n         * parent == \"/libvirt.service\" + path == \"foo\" => \"/libvirt.service/foo\"\n         */\n        group->unified.placement = g_strdup_printf(\"%s%s%s\",\n                                                   parent->unified.placement,\n                                                   delim ? \"\" : \"/\",\n                                                   path);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2CopyMounts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "144-150",
    "snippet": "static int\nvirCgroupV2CopyMounts(virCgroupPtr group,\n                      virCgroupPtr parent)\n{\n    group->unified.mountPoint = g_strdup(parent->unified.mountPoint);\n    return 0;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "parent->unified.mountPoint"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV2CopyMounts(virCgroupPtr group,\n                      virCgroupPtr parent)\n{\n    group->unified.mountPoint = g_strdup(parent->unified.mountPoint);\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV2ValidateMachineGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "99-141",
    "snippet": "static bool\nvirCgroupV2ValidateMachineGroup(virCgroupPtr group,\n                                const char *name G_GNUC_UNUSED,\n                                const char *drivername,\n                                const char *machinename)\n{\n    g_autofree char *partmachinename = NULL;\n    g_autofree char *scopename = NULL;\n    char *tmp;\n\n    partmachinename = g_strdup_printf(\"%s.libvirt-%s\", machinename, drivername);\n\n    if (virCgroupPartitionEscape(&partmachinename) < 0)\n        return false;\n\n    if (!(scopename = virSystemdMakeScopeName(machinename, drivername,\n                                              false))) {\n        return false;\n    }\n\n    if (virCgroupPartitionEscape(&scopename) < 0)\n        return false;\n\n    if (!(tmp = strrchr(group->unified.placement, '/')))\n        return false;\n\n    if (STREQ(tmp, \"/emulator\")) {\n        *tmp = '\\0';\n\n        if (!(tmp = strrchr(group->unified.placement, '/')))\n            return false;\n    }\n    tmp++;\n\n    if (STRNEQ(tmp, partmachinename) &&\n        STRNEQ(tmp, scopename)) {\n        VIR_DEBUG(\"Name '%s' for unified does not match '%s' or '%s'\",\n                  tmp, partmachinename, scopename);\n        return false;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Name '%s' for unified does not match '%s' or '%s'\"",
            "tmp",
            "partmachinename",
            "scopename"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tmp",
            "scopename"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tmp",
            "partmachinename"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "group->unified.placement",
            "'/'"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "tmp",
            "\"/emulator\""
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "group->unified.placement",
            "'/'"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupPartitionEscape",
          "args": [
            "&scopename"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPartitionEscape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "198-213",
          "snippet": "int\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSystemdMakeScopeName",
          "args": [
            "machinename",
            "drivername",
            "false"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "virSystemdMakeScopeName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsystemd.c",
          "lines": "99-114",
          "snippet": "char *virSystemdMakeScopeName(const char *name,\n                              const char *drivername,\n                              bool legacy_behaviour)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"machine-\");\n    if (legacy_behaviour) {\n        virSystemdEscapeName(&buf, drivername);\n        virBufferAddLit(&buf, \"\\\\x2d\");\n    }\n    virSystemdEscapeName(&buf, name);\n    virBufferAddLit(&buf, \".scope\");\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virdbus.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virsystemdpriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virdbus.h\"\n#include \"virbuffer.h\"\n#include \"virsystemd.h\"\n#include \"virsystemdpriv.h\"\n#include <config.h>\n\nchar *virSystemdMakeScopeName(const char *name,\n                              const char *drivername,\n                              bool legacy_behaviour)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"machine-\");\n    if (legacy_behaviour) {\n        virSystemdEscapeName(&buf, drivername);\n        virBufferAddLit(&buf, \"\\\\x2d\");\n    }\n    virSystemdEscapeName(&buf, name);\n    virBufferAddLit(&buf, \".scope\");\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s.libvirt-%s\"",
            "machinename",
            "drivername"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV2ValidateMachineGroup(virCgroupPtr group,\n                                const char *name G_GNUC_UNUSED,\n                                const char *drivername,\n                                const char *machinename)\n{\n    g_autofree char *partmachinename = NULL;\n    g_autofree char *scopename = NULL;\n    char *tmp;\n\n    partmachinename = g_strdup_printf(\"%s.libvirt-%s\", machinename, drivername);\n\n    if (virCgroupPartitionEscape(&partmachinename) < 0)\n        return false;\n\n    if (!(scopename = virSystemdMakeScopeName(machinename, drivername,\n                                              false))) {\n        return false;\n    }\n\n    if (virCgroupPartitionEscape(&scopename) < 0)\n        return false;\n\n    if (!(tmp = strrchr(group->unified.placement, '/')))\n        return false;\n\n    if (STREQ(tmp, \"/emulator\")) {\n        *tmp = '\\0';\n\n        if (!(tmp = strrchr(group->unified.placement, '/')))\n            return false;\n    }\n    tmp++;\n\n    if (STRNEQ(tmp, partmachinename) &&\n        STRNEQ(tmp, scopename)) {\n        VIR_DEBUG(\"Name '%s' for unified does not match '%s' or '%s'\",\n                  tmp, partmachinename, scopename);\n        return false;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virCgroupV2Available",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
    "lines": "60-96",
    "snippet": "static bool\nvirCgroupV2Available(void)\n{\n    bool ret = false;\n    FILE *mounts = NULL;\n    struct mntent entry;\n    char buf[CGROUP_MAX_VAL];\n\n    if (!(mounts = fopen(\"/proc/mounts\", \"r\")))\n        return false;\n\n    while (getmntent_r(mounts, &entry, buf, sizeof(buf)) != NULL) {\n        g_autofree char *contFile = NULL;\n        g_autofree char *contStr = NULL;\n\n        if (STRNEQ(entry.mnt_type, \"cgroup2\"))\n            continue;\n\n        /* Systemd uses cgroup v2 for process tracking but no controller is\n         * available. We should consider this configuration as cgroup v2 is\n         * not available. */\n        contFile = g_strdup_printf(\"%s/cgroup.controllers\", entry.mnt_dir);\n\n        if (virFileReadAll(contFile, 1024 * 1024, &contStr) < 0)\n            goto cleanup;\n\n        if (STREQ(contStr, \"\"))\n            continue;\n\n        ret = true;\n        break;\n    }\n\n cleanup:\n    VIR_FORCE_FCLOSE(mounts);\n    return ret;\n}",
    "includes": [
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2devices.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"virbpf.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "mounts"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "contStr",
            "\"\""
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "contFile",
            "1024 * 1024",
            "&contStr"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/cgroup.controllers\"",
            "entry.mnt_dir"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "entry.mnt_type",
            "\"cgroup2\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getmntent_r",
          "args": [
            "mounts",
            "&entry",
            "buf",
            "sizeof(buf)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "\"/proc/mounts\"",
            "\"r\""
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV2Available(void)\n{\n    bool ret = false;\n    FILE *mounts = NULL;\n    struct mntent entry;\n    char buf[CGROUP_MAX_VAL];\n\n    if (!(mounts = fopen(\"/proc/mounts\", \"r\")))\n        return false;\n\n    while (getmntent_r(mounts, &entry, buf, sizeof(buf)) != NULL) {\n        g_autofree char *contFile = NULL;\n        g_autofree char *contStr = NULL;\n\n        if (STRNEQ(entry.mnt_type, \"cgroup2\"))\n            continue;\n\n        /* Systemd uses cgroup v2 for process tracking but no controller is\n         * available. We should consider this configuration as cgroup v2 is\n         * not available. */\n        contFile = g_strdup_printf(\"%s/cgroup.controllers\", entry.mnt_dir);\n\n        if (virFileReadAll(contFile, 1024 * 1024, &contStr) < 0)\n            goto cleanup;\n\n        if (STREQ(contStr, \"\"))\n            continue;\n\n        ret = true;\n        break;\n    }\n\n cleanup:\n    VIR_FORCE_FCLOSE(mounts);\n    return ret;\n}"
  }
]