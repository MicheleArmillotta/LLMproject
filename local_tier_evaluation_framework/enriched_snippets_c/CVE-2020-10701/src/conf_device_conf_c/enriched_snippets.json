[
  {
    "function_name": "virInterfaceLinkFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "646-663",
    "snippet": "int\nvirInterfaceLinkFormat(virBufferPtr buf,\n                       const virNetDevIfLink *lnk)\n{\n    if (!lnk->speed && !lnk->state) {\n        /* If there's nothing to format, return early. */\n        return 0;\n    }\n\n    virBufferAddLit(buf, \"<link\");\n    if (lnk->speed)\n        virBufferAsprintf(buf, \" speed='%u'\", lnk->speed);\n    if (lnk->state)\n        virBufferAsprintf(buf, \" state='%s'\",\n                          virNetDevIfStateTypeToString(lnk->state));\n    virBufferAddLit(buf, \"/>\\n\");\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\" state='%s'\"",
            "virNetDevIfStateTypeToString(lnk->state)"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevIfStateTypeToString",
          "args": [
            "lnk->state"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<link\""
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirInterfaceLinkFormat(virBufferPtr buf,\n                       const virNetDevIfLink *lnk)\n{\n    if (!lnk->speed && !lnk->state) {\n        /* If there's nothing to format, return early. */\n        return 0;\n    }\n\n    virBufferAddLit(buf, \"<link\");\n    if (lnk->speed)\n        virBufferAsprintf(buf, \" speed='%u'\", lnk->speed);\n    if (lnk->state)\n        virBufferAsprintf(buf, \" state='%s'\",\n                          virNetDevIfStateTypeToString(lnk->state));\n    virBufferAddLit(buf, \"/>\\n\");\n    return 0;\n}"
  },
  {
    "function_name": "virInterfaceLinkParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "610-644",
    "snippet": "int\nvirInterfaceLinkParseXML(xmlNodePtr node,\n                         virNetDevIfLinkPtr lnk)\n{\n    int ret = -1;\n    char *stateStr, *speedStr;\n    int state;\n\n    stateStr = virXMLPropString(node, \"state\");\n    speedStr = virXMLPropString(node, \"speed\");\n\n    if (stateStr) {\n        if ((state = virNetDevIfStateTypeFromString(stateStr)) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"unknown link state: %s\"),\n                           stateStr);\n            goto cleanup;\n        }\n        lnk->state = state;\n    }\n\n    if (speedStr &&\n        virStrToLong_ui(speedStr, NULL, 10, &lnk->speed) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Unable to parse link speed: %s\"),\n                       speedStr);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(stateStr);\n    VIR_FREE(speedStr);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "speedStr"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "stateStr"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"Unable to parse link speed: %s\")",
            "speedStr"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse link speed: %s\""
          ],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "speedStr",
            "NULL",
            "10",
            "&lnk->speed"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"unknown link state: %s\")",
            "stateStr"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevIfStateTypeFromString",
          "args": [
            "stateStr"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"speed\""
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirInterfaceLinkParseXML(xmlNodePtr node,\n                         virNetDevIfLinkPtr lnk)\n{\n    int ret = -1;\n    char *stateStr, *speedStr;\n    int state;\n\n    stateStr = virXMLPropString(node, \"state\");\n    speedStr = virXMLPropString(node, \"speed\");\n\n    if (stateStr) {\n        if ((state = virNetDevIfStateTypeFromString(stateStr)) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"unknown link state: %s\"),\n                           stateStr);\n            goto cleanup;\n        }\n        lnk->state = state;\n    }\n\n    if (speedStr &&\n        virStrToLong_ui(speedStr, NULL, 10, &lnk->speed) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Unable to parse link speed: %s\"),\n                       speedStr);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(stateStr);\n    VIR_FREE(speedStr);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainDeviceAddressIsValid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "582-608",
    "snippet": "bool\nvirDomainDeviceAddressIsValid(virDomainDeviceInfoPtr info,\n                              int type)\n{\n    if (info->type != type)\n        return false;\n\n    switch (info->type) {\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI:\n        return virPCIDeviceAddressIsValid(&info->addr.pci, false);\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE:\n        return true;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_S390:\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_MMIO:\n        return true;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_CCW:\n        return virDomainDeviceCCWAddressIsValid(&info->addr.ccw);\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_USB:\n        return true;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDeviceCCWAddressIsValid",
          "args": [
            "&info->addr.ccw"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceCCWAddressIsValid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
          "lines": "307-313",
          "snippet": "bool\nvirDomainDeviceCCWAddressIsValid(virDomainDeviceCCWAddressPtr addr)\n{\n    return addr->cssid <= VIR_DOMAIN_DEVICE_CCW_MAX_CSSID &&\n           addr->ssid <= VIR_DOMAIN_DEVICE_CCW_MAX_SSID &&\n           addr->devno <= VIR_DOMAIN_DEVICE_CCW_MAX_DEVNO;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"domain_addr.h\"",
            "#include \"device_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDomainDeviceCCWAddressIsValid(virDomainDeviceCCWAddressPtr addr)\n{\n    return addr->cssid <= VIR_DOMAIN_DEVICE_CCW_MAX_CSSID &&\n           addr->ssid <= VIR_DOMAIN_DEVICE_CCW_MAX_SSID &&\n           addr->devno <= VIR_DOMAIN_DEVICE_CCW_MAX_DEVNO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressIsValid",
          "args": [
            "&info->addr.pci",
            "false"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressIsValid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1280-1316",
          "snippet": "bool\nvirPCIDeviceAddressIsValid(virPCIDeviceAddressPtr addr,\n                           bool report)\n{\n    if (addr->bus > 0xFF) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address bus='0x%x', \"\n                             \"must be <= 0xFF\"),\n                           addr->bus);\n        return false;\n    }\n    if (addr->slot > 0x1F) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address slot='0x%x', \"\n                             \"must be <= 0x1F\"),\n                           addr->slot);\n        return false;\n    }\n    if (addr->function > 7) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address function=0x%x, \"\n                             \"must be <= 7\"),\n                           addr->function);\n        return false;\n    }\n    if (virPCIDeviceAddressIsEmpty(addr)) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Invalid PCI address 0000:00:00, at least \"\n                             \"one of domain, bus, or slot must be > 0\"));\n        return false;\n    }\n    return true;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirPCIDeviceAddressIsValid(virPCIDeviceAddressPtr addr,\n                           bool report)\n{\n    if (addr->bus > 0xFF) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address bus='0x%x', \"\n                             \"must be <= 0xFF\"),\n                           addr->bus);\n        return false;\n    }\n    if (addr->slot > 0x1F) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address slot='0x%x', \"\n                             \"must be <= 0x1F\"),\n                           addr->slot);\n        return false;\n    }\n    if (addr->function > 7) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address function=0x%x, \"\n                             \"must be <= 7\"),\n                           addr->function);\n        return false;\n    }\n    if (virPCIDeviceAddressIsEmpty(addr)) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Invalid PCI address 0000:00:00, at least \"\n                             \"one of domain, bus, or slot must be > 0\"));\n        return false;\n    }\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDomainDeviceAddressIsValid(virDomainDeviceInfoPtr info,\n                              int type)\n{\n    if (info->type != type)\n        return false;\n\n    switch (info->type) {\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI:\n        return virPCIDeviceAddressIsValid(&info->addr.pci, false);\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE:\n        return true;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_S390:\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_MMIO:\n        return true;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_CCW:\n        return virDomainDeviceCCWAddressIsValid(&info->addr.ccw);\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_USB:\n        return true;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "virDomainDeviceSpaprVioAddressParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "555-580",
    "snippet": "int\nvirDomainDeviceSpaprVioAddressParseXML(xmlNodePtr node,\n                                      virDomainDeviceSpaprVioAddressPtr addr)\n{\n    char *reg;\n    int ret;\n\n    memset(addr, 0, sizeof(*addr));\n\n    reg = virXMLPropString(node, \"reg\");\n    if (reg) {\n        if (virStrToLong_ull(reg, NULL, 16, &addr->reg) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse <address> 'reg' attribute\"));\n            ret = -1;\n            goto cleanup;\n        }\n\n        addr->has_reg = true;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(reg);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "reg"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'reg' attribute\")"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse <address> 'reg' attribute\""
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "reg",
            "NULL",
            "16",
            "&addr->reg"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"reg\""
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "addr",
            "0",
            "sizeof(*addr)"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirDomainDeviceSpaprVioAddressParseXML(xmlNodePtr node,\n                                      virDomainDeviceSpaprVioAddressPtr addr)\n{\n    char *reg;\n    int ret;\n\n    memset(addr, 0, sizeof(*addr));\n\n    reg = virXMLPropString(node, \"reg\");\n    if (reg) {\n        if (virStrToLong_ull(reg, NULL, 16, &addr->reg) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse <address> 'reg' attribute\"));\n            ret = -1;\n            goto cleanup;\n        }\n\n        addr->has_reg = true;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(reg);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainDeviceUSBAddressParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "525-553",
    "snippet": "int\nvirDomainDeviceUSBAddressParseXML(xmlNodePtr node,\n                                  virDomainDeviceUSBAddressPtr addr)\n{\n    char *port, *bus;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    port = virXMLPropString(node, \"port\");\n    bus = virXMLPropString(node, \"bus\");\n\n    if (port && virDomainDeviceUSBAddressParsePort(addr, port) < 0)\n        goto cleanup;\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 10, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(bus);\n    VIR_FREE(port);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "port"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bus"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'bus' attribute\")"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse <address> 'bus' attribute\""
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "bus",
            "NULL",
            "10",
            "&addr->bus"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceUSBAddressParsePort",
          "args": [
            "addr",
            "port"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceUSBAddressParsePort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
          "lines": "502-523",
          "snippet": "static int\nvirDomainDeviceUSBAddressParsePort(virDomainDeviceUSBAddressPtr addr,\n                                   char *port)\n{\n    char *tmp = port;\n    size_t i;\n\n    for (i = 0; i < VIR_DOMAIN_DEVICE_USB_MAX_PORT_DEPTH; i++) {\n        if (virStrToLong_uip(tmp, &tmp, 10, &addr->port[i]) < 0)\n            break;\n\n        if (*tmp == '\\0')\n            return 0;\n\n        if (*tmp == '.')\n            tmp++;\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Cannot parse <address> 'port' attribute\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"domain_addr.h\"",
            "#include \"device_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirDomainDeviceUSBAddressParsePort(virDomainDeviceUSBAddressPtr addr,\n                                   char *port)\n{\n    char *tmp = port;\n    size_t i;\n\n    for (i = 0; i < VIR_DOMAIN_DEVICE_USB_MAX_PORT_DEPTH; i++) {\n        if (virStrToLong_uip(tmp, &tmp, 10, &addr->port[i]) < 0)\n            break;\n\n        if (*tmp == '\\0')\n            return 0;\n\n        if (*tmp == '.')\n            tmp++;\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Cannot parse <address> 'port' attribute\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"bus\""
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "addr",
            "0",
            "sizeof(*addr)"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirDomainDeviceUSBAddressParseXML(xmlNodePtr node,\n                                  virDomainDeviceUSBAddressPtr addr)\n{\n    char *port, *bus;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    port = virXMLPropString(node, \"port\");\n    bus = virXMLPropString(node, \"bus\");\n\n    if (port && virDomainDeviceUSBAddressParsePort(addr, port) < 0)\n        goto cleanup;\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 10, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(bus);\n    VIR_FREE(port);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainDeviceUSBAddressParsePort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "502-523",
    "snippet": "static int\nvirDomainDeviceUSBAddressParsePort(virDomainDeviceUSBAddressPtr addr,\n                                   char *port)\n{\n    char *tmp = port;\n    size_t i;\n\n    for (i = 0; i < VIR_DOMAIN_DEVICE_USB_MAX_PORT_DEPTH; i++) {\n        if (virStrToLong_uip(tmp, &tmp, 10, &addr->port[i]) < 0)\n            break;\n\n        if (*tmp == '\\0')\n            return 0;\n\n        if (*tmp == '.')\n            tmp++;\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Cannot parse <address> 'port' attribute\"));\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'port' attribute\")"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse <address> 'port' attribute\""
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "tmp",
            "&tmp",
            "10",
            "&addr->port[i]"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirDomainDeviceUSBAddressParsePort(virDomainDeviceUSBAddressPtr addr,\n                                   char *port)\n{\n    char *tmp = port;\n    size_t i;\n\n    for (i = 0; i < VIR_DOMAIN_DEVICE_USB_MAX_PORT_DEPTH; i++) {\n        if (virStrToLong_uip(tmp, &tmp, 10, &addr->port[i]) < 0)\n            break;\n\n        if (*tmp == '\\0')\n            return 0;\n\n        if (*tmp == '.')\n            tmp++;\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Cannot parse <address> 'port' attribute\"));\n    return -1;\n}"
  },
  {
    "function_name": "virDomainDeviceCcidAddressParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "468-500",
    "snippet": "int\nvirDomainDeviceCcidAddressParseXML(xmlNodePtr node,\n                                   virDomainDeviceCcidAddressPtr addr)\n{\n    char *controller, *slot;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    controller = virXMLPropString(node, \"controller\");\n    slot = virXMLPropString(node, \"slot\");\n\n    if (controller &&\n        virStrToLong_uip(controller, NULL, 10, &addr->controller) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'controller' attribute\"));\n        goto cleanup;\n    }\n\n    if (slot &&\n        virStrToLong_uip(slot, NULL, 10, &addr->slot) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'slot' attribute\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(controller);\n    VIR_FREE(slot);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "slot"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "controller"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'slot' attribute\")"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse <address> 'slot' attribute\""
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "slot",
            "NULL",
            "10",
            "&addr->slot"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'controller' attribute\")"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"slot\""
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "addr",
            "0",
            "sizeof(*addr)"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirDomainDeviceCcidAddressParseXML(xmlNodePtr node,\n                                   virDomainDeviceCcidAddressPtr addr)\n{\n    char *controller, *slot;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    controller = virXMLPropString(node, \"controller\");\n    slot = virXMLPropString(node, \"slot\");\n\n    if (controller &&\n        virStrToLong_uip(controller, NULL, 10, &addr->controller) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'controller' attribute\"));\n        goto cleanup;\n    }\n\n    if (slot &&\n        virStrToLong_uip(slot, NULL, 10, &addr->slot) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'slot' attribute\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(controller);\n    VIR_FREE(slot);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainDeviceVirtioSerialAddressParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "425-466",
    "snippet": "int\nvirDomainDeviceVirtioSerialAddressParseXML(xmlNodePtr node,\n                                           virDomainDeviceVirtioSerialAddressPtr addr)\n{\n    char *controller, *bus, *port;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    controller = virXMLPropString(node, \"controller\");\n    bus = virXMLPropString(node, \"bus\");\n    port = virXMLPropString(node, \"port\");\n\n    if (controller &&\n        virStrToLong_uip(controller, NULL, 10, &addr->controller) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'controller' attribute\"));\n        goto cleanup;\n    }\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 10, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    if (port &&\n        virStrToLong_uip(port, NULL, 10, &addr->port) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'port' attribute\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(controller);\n    VIR_FREE(bus);\n    VIR_FREE(port);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "port"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bus"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "controller"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'port' attribute\")"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse <address> 'port' attribute\""
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "port",
            "NULL",
            "10",
            "&addr->port"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'bus' attribute\")"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'controller' attribute\")"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"port\""
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "addr",
            "0",
            "sizeof(*addr)"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirDomainDeviceVirtioSerialAddressParseXML(xmlNodePtr node,\n                                           virDomainDeviceVirtioSerialAddressPtr addr)\n{\n    char *controller, *bus, *port;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    controller = virXMLPropString(node, \"controller\");\n    bus = virXMLPropString(node, \"bus\");\n    port = virXMLPropString(node, \"port\");\n\n    if (controller &&\n        virStrToLong_uip(controller, NULL, 10, &addr->controller) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'controller' attribute\"));\n        goto cleanup;\n    }\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 10, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    if (port &&\n        virStrToLong_uip(port, NULL, 10, &addr->port) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'port' attribute\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(controller);\n    VIR_FREE(bus);\n    VIR_FREE(port);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainDeviceDriveAddressParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "373-423",
    "snippet": "int\nvirDomainDeviceDriveAddressParseXML(xmlNodePtr node,\n                                    virDomainDeviceDriveAddressPtr addr)\n{\n    char *bus, *unit, *controller, *target;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    controller = virXMLPropString(node, \"controller\");\n    bus = virXMLPropString(node, \"bus\");\n    target = virXMLPropString(node, \"target\");\n    unit = virXMLPropString(node, \"unit\");\n\n    if (controller &&\n        virStrToLong_uip(controller, NULL, 10, &addr->controller) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'controller' attribute\"));\n        goto cleanup;\n    }\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 10, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    if (target &&\n        virStrToLong_uip(target, NULL, 10, &addr->target) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'target' attribute\"));\n        goto cleanup;\n    }\n\n    if (unit &&\n        virStrToLong_uip(unit, NULL, 10, &addr->unit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'unit' attribute\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(controller);\n    VIR_FREE(bus);\n    VIR_FREE(target);\n    VIR_FREE(unit);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "unit"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "target"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bus"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "controller"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'unit' attribute\")"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse <address> 'unit' attribute\""
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "unit",
            "NULL",
            "10",
            "&addr->unit"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'target' attribute\")"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'bus' attribute\")"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'controller' attribute\")"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"unit\""
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "addr",
            "0",
            "sizeof(*addr)"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirDomainDeviceDriveAddressParseXML(xmlNodePtr node,\n                                    virDomainDeviceDriveAddressPtr addr)\n{\n    char *bus, *unit, *controller, *target;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    controller = virXMLPropString(node, \"controller\");\n    bus = virXMLPropString(node, \"bus\");\n    target = virXMLPropString(node, \"target\");\n    unit = virXMLPropString(node, \"unit\");\n\n    if (controller &&\n        virStrToLong_uip(controller, NULL, 10, &addr->controller) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'controller' attribute\"));\n        goto cleanup;\n    }\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 10, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    if (target &&\n        virStrToLong_uip(target, NULL, 10, &addr->target) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'target' attribute\"));\n        goto cleanup;\n    }\n\n    if (unit &&\n        virStrToLong_uip(unit, NULL, 10, &addr->unit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'unit' attribute\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(controller);\n    VIR_FREE(bus);\n    VIR_FREE(target);\n    VIR_FREE(unit);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainDeviceCCWAddressParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "315-371",
    "snippet": "int\nvirDomainDeviceCCWAddressParseXML(xmlNodePtr node,\n                                  virDomainDeviceCCWAddressPtr addr)\n{\n    int   ret = -1;\n    char *cssid;\n    char *ssid;\n    char *devno;\n\n    memset(addr, 0, sizeof(*addr));\n\n    cssid = virXMLPropString(node, \"cssid\");\n    ssid = virXMLPropString(node, \"ssid\");\n    devno = virXMLPropString(node, \"devno\");\n\n    if (cssid && ssid && devno) {\n        if (cssid &&\n            virStrToLong_uip(cssid, NULL, 0, &addr->cssid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse <address> 'cssid' attribute\"));\n            goto cleanup;\n        }\n        if (ssid &&\n            virStrToLong_uip(ssid, NULL, 0, &addr->ssid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse <address> 'ssid' attribute\"));\n            goto cleanup;\n        }\n        if (devno &&\n            virStrToLong_uip(devno, NULL, 0, &addr->devno) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse <address> 'devno' attribute\"));\n            goto cleanup;\n        }\n        if (!virDomainDeviceCCWAddressIsValid(addr)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid specification for virtio ccw\"\n                             \" address: cssid='%s' ssid='%s' devno='%s'\"),\n                           cssid, ssid, devno);\n            goto cleanup;\n        }\n        addr->assigned = true;\n    } else if (cssid || ssid || devno) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid partial specification for virtio ccw\"\n                         \" address\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cssid);\n    VIR_FREE(ssid);\n    VIR_FREE(devno);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "devno"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ssid"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cssid"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid partial specification for virtio ccw\"\n                         \" address\")"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid partial specification for virtio ccw\"\n                         \" address\""
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Invalid specification for virtio ccw\"\n                             \" address: cssid='%s' ssid='%s' devno='%s'\")",
            "cssid",
            "ssid",
            "devno"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDeviceCCWAddressIsValid",
          "args": [
            "addr"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceCCWAddressIsValid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
          "lines": "307-313",
          "snippet": "bool\nvirDomainDeviceCCWAddressIsValid(virDomainDeviceCCWAddressPtr addr)\n{\n    return addr->cssid <= VIR_DOMAIN_DEVICE_CCW_MAX_CSSID &&\n           addr->ssid <= VIR_DOMAIN_DEVICE_CCW_MAX_SSID &&\n           addr->devno <= VIR_DOMAIN_DEVICE_CCW_MAX_DEVNO;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"domain_addr.h\"",
            "#include \"device_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDomainDeviceCCWAddressIsValid(virDomainDeviceCCWAddressPtr addr)\n{\n    return addr->cssid <= VIR_DOMAIN_DEVICE_CCW_MAX_CSSID &&\n           addr->ssid <= VIR_DOMAIN_DEVICE_CCW_MAX_SSID &&\n           addr->devno <= VIR_DOMAIN_DEVICE_CCW_MAX_DEVNO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'devno' attribute\")"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "devno",
            "NULL",
            "0",
            "&addr->devno"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'ssid' attribute\")"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'cssid' attribute\")"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"devno\""
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "addr",
            "0",
            "sizeof(*addr)"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirDomainDeviceCCWAddressParseXML(xmlNodePtr node,\n                                  virDomainDeviceCCWAddressPtr addr)\n{\n    int   ret = -1;\n    char *cssid;\n    char *ssid;\n    char *devno;\n\n    memset(addr, 0, sizeof(*addr));\n\n    cssid = virXMLPropString(node, \"cssid\");\n    ssid = virXMLPropString(node, \"ssid\");\n    devno = virXMLPropString(node, \"devno\");\n\n    if (cssid && ssid && devno) {\n        if (cssid &&\n            virStrToLong_uip(cssid, NULL, 0, &addr->cssid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse <address> 'cssid' attribute\"));\n            goto cleanup;\n        }\n        if (ssid &&\n            virStrToLong_uip(ssid, NULL, 0, &addr->ssid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse <address> 'ssid' attribute\"));\n            goto cleanup;\n        }\n        if (devno &&\n            virStrToLong_uip(devno, NULL, 0, &addr->devno) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse <address> 'devno' attribute\"));\n            goto cleanup;\n        }\n        if (!virDomainDeviceCCWAddressIsValid(addr)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid specification for virtio ccw\"\n                             \" address: cssid='%s' ssid='%s' devno='%s'\"),\n                           cssid, ssid, devno);\n            goto cleanup;\n        }\n        addr->assigned = true;\n    } else if (cssid || ssid || devno) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid partial specification for virtio ccw\"\n                         \" address\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(cssid);\n    VIR_FREE(ssid);\n    VIR_FREE(devno);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainDeviceCCWAddressIsValid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "307-313",
    "snippet": "bool\nvirDomainDeviceCCWAddressIsValid(virDomainDeviceCCWAddressPtr addr)\n{\n    return addr->cssid <= VIR_DOMAIN_DEVICE_CCW_MAX_CSSID &&\n           addr->ssid <= VIR_DOMAIN_DEVICE_CCW_MAX_SSID &&\n           addr->devno <= VIR_DOMAIN_DEVICE_CCW_MAX_DEVNO;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDomainDeviceCCWAddressIsValid(virDomainDeviceCCWAddressPtr addr)\n{\n    return addr->cssid <= VIR_DOMAIN_DEVICE_CCW_MAX_CSSID &&\n           addr->ssid <= VIR_DOMAIN_DEVICE_CCW_MAX_SSID &&\n           addr->devno <= VIR_DOMAIN_DEVICE_CCW_MAX_DEVNO;\n}"
  },
  {
    "function_name": "virPCIDeviceAddressFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "293-305",
    "snippet": "void\nvirPCIDeviceAddressFormat(virBufferPtr buf,\n                          virPCIDeviceAddress addr,\n                          bool includeTypeInAddr)\n{\n    virBufferAsprintf(buf, \"<address %sdomain='0x%04x' bus='0x%02x' \"\n                      \"slot='0x%02x' function='0x%d'/>\\n\",\n                      includeTypeInAddr ? \"type='pci' \" : \"\",\n                      addr.domain,\n                      addr.bus,\n                      addr.slot,\n                      addr.function);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<address %sdomain='0x%04x' bus='0x%02x' \"\n                      \"slot='0x%02x' function='0x%d'/>\\n\"",
            "includeTypeInAddr ? \"type='pci' \" : \"\"",
            "addr.domain",
            "addr.bus",
            "addr.slot",
            "addr.function"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirPCIDeviceAddressFormat(virBufferPtr buf,\n                          virPCIDeviceAddress addr,\n                          bool includeTypeInAddr)\n{\n    virBufferAsprintf(buf, \"<address %sdomain='0x%04x' bus='0x%02x' \"\n                      \"slot='0x%02x' function='0x%d'/>\\n\",\n                      includeTypeInAddr ? \"type='pci' \" : \"\",\n                      addr.domain,\n                      addr.bus,\n                      addr.slot,\n                      addr.function);\n}"
  },
  {
    "function_name": "virPCIDeviceAddressParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "214-291",
    "snippet": "int\nvirPCIDeviceAddressParseXML(xmlNodePtr node,\n                            virPCIDeviceAddressPtr addr)\n{\n    char *domain, *slot, *bus, *function, *multi;\n    xmlNodePtr cur;\n    xmlNodePtr zpci = NULL;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    domain   = virXMLPropString(node, \"domain\");\n    bus      = virXMLPropString(node, \"bus\");\n    slot     = virXMLPropString(node, \"slot\");\n    function = virXMLPropString(node, \"function\");\n    multi    = virXMLPropString(node, \"multifunction\");\n\n    if (domain &&\n        virStrToLong_uip(domain, NULL, 0, &addr->domain) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'domain' attribute\"));\n        goto cleanup;\n    }\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 0, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    if (slot &&\n        virStrToLong_uip(slot, NULL, 0, &addr->slot) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'slot' attribute\"));\n        goto cleanup;\n    }\n\n    if (function &&\n        virStrToLong_uip(function, NULL, 0, &addr->function) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'function' attribute\"));\n        goto cleanup;\n    }\n\n    if (multi &&\n        ((addr->multi = virTristateSwitchTypeFromString(multi)) <= 0)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unknown value '%s' for <address> 'multifunction' attribute\"),\n                       multi);\n        goto cleanup;\n\n    }\n    if (!virPCIDeviceAddressIsEmpty(addr) && !virPCIDeviceAddressIsValid(addr, true))\n        goto cleanup;\n\n    cur = node->children;\n    while (cur) {\n        if (cur->type == XML_ELEMENT_NODE &&\n            virXMLNodeNameEqual(cur, \"zpci\")) {\n            zpci = cur;\n        }\n        cur = cur->next;\n    }\n\n    if (zpci && virZPCIDeviceAddressParseXML(zpci, addr) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(domain);\n    VIR_FREE(bus);\n    VIR_FREE(slot);\n    VIR_FREE(function);\n    VIR_FREE(multi);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "multi"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "function"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "slot"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bus"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "domain"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virZPCIDeviceAddressParseXML",
          "args": [
            "zpci",
            "addr"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "virZPCIDeviceAddressParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
          "lines": "51-88",
          "snippet": "static int\nvirZPCIDeviceAddressParseXML(xmlNodePtr node,\n                             virPCIDeviceAddressPtr addr)\n{\n    virZPCIDeviceAddress def = { 0 };\n    char *uid;\n    char *fid;\n    int ret = -1;\n\n    uid = virXMLPropString(node, \"uid\");\n    fid = virXMLPropString(node, \"fid\");\n\n    if (uid &&\n        virStrToLong_uip(uid, NULL, 0, &def.uid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'uid' attribute\"));\n        goto cleanup;\n    }\n\n    if (fid &&\n        virStrToLong_uip(fid, NULL, 0, &def.fid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'fid' attribute\"));\n        goto cleanup;\n    }\n\n    if (!virZPCIDeviceAddressIsEmpty(&def) &&\n        !virZPCIDeviceAddressIsValid(&def))\n        goto cleanup;\n\n    addr->zpci = def;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(uid);\n    VIR_FREE(fid);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"domain_addr.h\"",
            "#include \"device_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirZPCIDeviceAddressParseXML(xmlNodePtr node,\n                             virPCIDeviceAddressPtr addr)\n{\n    virZPCIDeviceAddress def = { 0 };\n    char *uid;\n    char *fid;\n    int ret = -1;\n\n    uid = virXMLPropString(node, \"uid\");\n    fid = virXMLPropString(node, \"fid\");\n\n    if (uid &&\n        virStrToLong_uip(uid, NULL, 0, &def.uid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'uid' attribute\"));\n        goto cleanup;\n    }\n\n    if (fid &&\n        virStrToLong_uip(fid, NULL, 0, &def.fid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'fid' attribute\"));\n        goto cleanup;\n    }\n\n    if (!virZPCIDeviceAddressIsEmpty(&def) &&\n        !virZPCIDeviceAddressIsValid(&def))\n        goto cleanup;\n\n    addr->zpci = def;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(uid);\n    VIR_FREE(fid);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLNodeNameEqual",
          "args": [
            "cur",
            "\"zpci\""
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeNameEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1013-1018",
          "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressIsValid",
          "args": [
            "addr",
            "true"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressIsValid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1280-1316",
          "snippet": "bool\nvirPCIDeviceAddressIsValid(virPCIDeviceAddressPtr addr,\n                           bool report)\n{\n    if (addr->bus > 0xFF) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address bus='0x%x', \"\n                             \"must be <= 0xFF\"),\n                           addr->bus);\n        return false;\n    }\n    if (addr->slot > 0x1F) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address slot='0x%x', \"\n                             \"must be <= 0x1F\"),\n                           addr->slot);\n        return false;\n    }\n    if (addr->function > 7) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address function=0x%x, \"\n                             \"must be <= 7\"),\n                           addr->function);\n        return false;\n    }\n    if (virPCIDeviceAddressIsEmpty(addr)) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Invalid PCI address 0000:00:00, at least \"\n                             \"one of domain, bus, or slot must be > 0\"));\n        return false;\n    }\n    return true;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirPCIDeviceAddressIsValid(virPCIDeviceAddressPtr addr,\n                           bool report)\n{\n    if (addr->bus > 0xFF) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address bus='0x%x', \"\n                             \"must be <= 0xFF\"),\n                           addr->bus);\n        return false;\n    }\n    if (addr->slot > 0x1F) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address slot='0x%x', \"\n                             \"must be <= 0x1F\"),\n                           addr->slot);\n        return false;\n    }\n    if (addr->function > 7) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid PCI address function=0x%x, \"\n                             \"must be <= 7\"),\n                           addr->function);\n        return false;\n    }\n    if (virPCIDeviceAddressIsEmpty(addr)) {\n        if (report)\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Invalid PCI address 0000:00:00, at least \"\n                             \"one of domain, bus, or slot must be > 0\"));\n        return false;\n    }\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressIsEmpty",
          "args": [
            "addr"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1318-1322",
          "snippet": "bool\nvirPCIDeviceAddressIsEmpty(const virPCIDeviceAddress *addr)\n{\n    return !(addr->domain || addr->bus || addr->slot);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirPCIDeviceAddressIsEmpty(const virPCIDeviceAddress *addr)\n{\n    return !(addr->domain || addr->bus || addr->slot);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unknown value '%s' for <address> 'multifunction' attribute\")",
            "multi"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown value '%s' for <address> 'multifunction' attribute\""
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTristateSwitchTypeFromString",
          "args": [
            "multi"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'function' attribute\")"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "function",
            "NULL",
            "0",
            "&addr->function"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'slot' attribute\")"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'bus' attribute\")"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'domain' attribute\")"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"multifunction\""
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "addr",
            "0",
            "sizeof(*addr)"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirPCIDeviceAddressParseXML(xmlNodePtr node,\n                            virPCIDeviceAddressPtr addr)\n{\n    char *domain, *slot, *bus, *function, *multi;\n    xmlNodePtr cur;\n    xmlNodePtr zpci = NULL;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    domain   = virXMLPropString(node, \"domain\");\n    bus      = virXMLPropString(node, \"bus\");\n    slot     = virXMLPropString(node, \"slot\");\n    function = virXMLPropString(node, \"function\");\n    multi    = virXMLPropString(node, \"multifunction\");\n\n    if (domain &&\n        virStrToLong_uip(domain, NULL, 0, &addr->domain) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'domain' attribute\"));\n        goto cleanup;\n    }\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 0, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    if (slot &&\n        virStrToLong_uip(slot, NULL, 0, &addr->slot) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'slot' attribute\"));\n        goto cleanup;\n    }\n\n    if (function &&\n        virStrToLong_uip(function, NULL, 0, &addr->function) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'function' attribute\"));\n        goto cleanup;\n    }\n\n    if (multi &&\n        ((addr->multi = virTristateSwitchTypeFromString(multi)) <= 0)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unknown value '%s' for <address> 'multifunction' attribute\"),\n                       multi);\n        goto cleanup;\n\n    }\n    if (!virPCIDeviceAddressIsEmpty(addr) && !virPCIDeviceAddressIsValid(addr, true))\n        goto cleanup;\n\n    cur = node->children;\n    while (cur) {\n        if (cur->type == XML_ELEMENT_NODE &&\n            virXMLNodeNameEqual(cur, \"zpci\")) {\n            zpci = cur;\n        }\n        cur = cur->next;\n    }\n\n    if (zpci && virZPCIDeviceAddressParseXML(zpci, addr) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(domain);\n    VIR_FREE(bus);\n    VIR_FREE(slot);\n    VIR_FREE(function);\n    VIR_FREE(multi);\n    return ret;\n}"
  },
  {
    "function_name": "virDeviceInfoPCIAddressExtensionIsPresent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "206-211",
    "snippet": "bool\nvirDeviceInfoPCIAddressExtensionIsPresent(const virDomainDeviceInfo *info)\n{\n    return (info->addr.pci.extFlags & VIR_PCI_ADDRESS_EXTENSION_ZPCI) &&\n           !virZPCIDeviceAddressIsEmpty(&info->addr.pci.zpci);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virZPCIDeviceAddressIsEmpty",
          "args": [
            "&info->addr.pci.zpci"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "virZPCIDeviceAddressIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2188-2192",
          "snippet": "bool\nvirZPCIDeviceAddressIsEmpty(const virZPCIDeviceAddress *addr)\n{\n    return !(addr->uid || addr->fid);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirZPCIDeviceAddressIsEmpty(const virZPCIDeviceAddress *addr)\n{\n    return !(addr->uid || addr->fid);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDeviceInfoPCIAddressExtensionIsPresent(const virDomainDeviceInfo *info)\n{\n    return (info->addr.pci.extFlags & VIR_PCI_ADDRESS_EXTENSION_ZPCI) &&\n           !virZPCIDeviceAddressIsEmpty(&info->addr.pci.zpci);\n}"
  },
  {
    "function_name": "virDeviceInfoPCIAddressExtensionIsWanted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "199-204",
    "snippet": "bool\nvirDeviceInfoPCIAddressExtensionIsWanted(const virDomainDeviceInfo *info)\n{\n    return (info->addr.pci.extFlags & VIR_PCI_ADDRESS_EXTENSION_ZPCI) &&\n           virZPCIDeviceAddressIsEmpty(&info->addr.pci.zpci);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virZPCIDeviceAddressIsEmpty",
          "args": [
            "&info->addr.pci.zpci"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "virZPCIDeviceAddressIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2188-2192",
          "snippet": "bool\nvirZPCIDeviceAddressIsEmpty(const virZPCIDeviceAddress *addr)\n{\n    return !(addr->uid || addr->fid);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirZPCIDeviceAddressIsEmpty(const virZPCIDeviceAddress *addr)\n{\n    return !(addr->uid || addr->fid);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDeviceInfoPCIAddressExtensionIsWanted(const virDomainDeviceInfo *info)\n{\n    return (info->addr.pci.extFlags & VIR_PCI_ADDRESS_EXTENSION_ZPCI) &&\n           virZPCIDeviceAddressIsEmpty(&info->addr.pci.zpci);\n}"
  },
  {
    "function_name": "virDeviceInfoPCIAddressIsPresent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "191-196",
    "snippet": "bool\nvirDeviceInfoPCIAddressIsPresent(const virDomainDeviceInfo *info)\n{\n    return info->type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI &&\n           !virPCIDeviceAddressIsEmpty(&info->addr.pci);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPCIDeviceAddressIsEmpty",
          "args": [
            "&info->addr.pci"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1318-1322",
          "snippet": "bool\nvirPCIDeviceAddressIsEmpty(const virPCIDeviceAddress *addr)\n{\n    return !(addr->domain || addr->bus || addr->slot);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirPCIDeviceAddressIsEmpty(const virPCIDeviceAddress *addr)\n{\n    return !(addr->domain || addr->bus || addr->slot);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDeviceInfoPCIAddressIsPresent(const virDomainDeviceInfo *info)\n{\n    return info->type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI &&\n           !virPCIDeviceAddressIsEmpty(&info->addr.pci);\n}"
  },
  {
    "function_name": "virDeviceInfoPCIAddressIsWanted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "183-189",
    "snippet": "bool\nvirDeviceInfoPCIAddressIsWanted(const virDomainDeviceInfo *info)\n{\n    return info->type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE ||\n           (info->type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI &&\n            virPCIDeviceAddressIsEmpty(&info->addr.pci));\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPCIDeviceAddressIsEmpty",
          "args": [
            "&info->addr.pci"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1318-1322",
          "snippet": "bool\nvirPCIDeviceAddressIsEmpty(const virPCIDeviceAddress *addr)\n{\n    return !(addr->domain || addr->bus || addr->slot);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirPCIDeviceAddressIsEmpty(const virPCIDeviceAddress *addr)\n{\n    return !(addr->domain || addr->bus || addr->slot);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDeviceInfoPCIAddressIsWanted(const virDomainDeviceInfo *info)\n{\n    return info->type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE ||\n           (info->type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI &&\n            virPCIDeviceAddressIsEmpty(&info->addr.pci));\n}"
  },
  {
    "function_name": "virDomainDeviceInfoAddressIsEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "111-181",
    "snippet": "bool\nvirDomainDeviceInfoAddressIsEqual(const virDomainDeviceInfo *a,\n                                  const virDomainDeviceInfo *b)\n{\n    if (a->type != b->type)\n        return false;\n\n    switch ((virDomainDeviceAddressType) a->type) {\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE:\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_LAST:\n    /* address types below don't have any specific data */\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_MMIO:\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_S390:\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_UNASSIGNED:\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI:\n        /* the 'multi' field shouldn't be checked */\n        if (a->addr.pci.domain != b->addr.pci.domain ||\n            a->addr.pci.bus != b->addr.pci.bus ||\n            a->addr.pci.slot != b->addr.pci.slot ||\n            a->addr.pci.function != b->addr.pci.function)\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE:\n        if (memcmp(&a->addr.drive, &b->addr.drive, sizeof(a->addr.drive)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_SERIAL:\n        if (memcmp(&a->addr.vioserial, &b->addr.vioserial, sizeof(a->addr.vioserial)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_CCID:\n        if (memcmp(&a->addr.ccid, &b->addr.ccid, sizeof(a->addr.ccid)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_USB:\n        if (memcmp(&a->addr.usb, &b->addr.usb, sizeof(a->addr.usb)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_SPAPRVIO:\n        if (memcmp(&a->addr.spaprvio, &b->addr.spaprvio, sizeof(a->addr.spaprvio)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_CCW:\n        /* the 'assigned' field denotes that the address was generated */\n        if (a->addr.ccw.cssid != b->addr.ccw.cssid ||\n            a->addr.ccw.ssid != b->addr.ccw.ssid ||\n            a->addr.ccw.devno != b->addr.ccw.devno)\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_ISA:\n        if (memcmp(&a->addr.isa, &b->addr.isa, sizeof(a->addr.isa)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DIMM:\n        if (memcmp(&a->addr.dimm, &b->addr.dimm, sizeof(a->addr.dimm)))\n            return false;\n        break;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&a->addr.dimm",
            "&b->addr.dimm",
            "sizeof(a->addr.dimm)"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&a->addr.isa",
            "&b->addr.isa",
            "sizeof(a->addr.isa)"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&a->addr.spaprvio",
            "&b->addr.spaprvio",
            "sizeof(a->addr.spaprvio)"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&a->addr.usb",
            "&b->addr.usb",
            "sizeof(a->addr.usb)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&a->addr.ccid",
            "&b->addr.ccid",
            "sizeof(a->addr.ccid)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&a->addr.vioserial",
            "&b->addr.vioserial",
            "sizeof(a->addr.vioserial)"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&a->addr.drive",
            "&b->addr.drive",
            "sizeof(a->addr.drive)"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool\nvirDomainDeviceInfoAddressIsEqual(const virDomainDeviceInfo *a,\n                                  const virDomainDeviceInfo *b)\n{\n    if (a->type != b->type)\n        return false;\n\n    switch ((virDomainDeviceAddressType) a->type) {\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE:\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_LAST:\n    /* address types below don't have any specific data */\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_MMIO:\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_S390:\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_UNASSIGNED:\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI:\n        /* the 'multi' field shouldn't be checked */\n        if (a->addr.pci.domain != b->addr.pci.domain ||\n            a->addr.pci.bus != b->addr.pci.bus ||\n            a->addr.pci.slot != b->addr.pci.slot ||\n            a->addr.pci.function != b->addr.pci.function)\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE:\n        if (memcmp(&a->addr.drive, &b->addr.drive, sizeof(a->addr.drive)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_SERIAL:\n        if (memcmp(&a->addr.vioserial, &b->addr.vioserial, sizeof(a->addr.vioserial)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_CCID:\n        if (memcmp(&a->addr.ccid, &b->addr.ccid, sizeof(a->addr.ccid)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_USB:\n        if (memcmp(&a->addr.usb, &b->addr.usb, sizeof(a->addr.usb)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_SPAPRVIO:\n        if (memcmp(&a->addr.spaprvio, &b->addr.spaprvio, sizeof(a->addr.spaprvio)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_CCW:\n        /* the 'assigned' field denotes that the address was generated */\n        if (a->addr.ccw.cssid != b->addr.ccw.cssid ||\n            a->addr.ccw.ssid != b->addr.ccw.ssid ||\n            a->addr.ccw.devno != b->addr.ccw.devno)\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_ISA:\n        if (memcmp(&a->addr.isa, &b->addr.isa, sizeof(a->addr.isa)))\n            return false;\n        break;\n\n    case VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DIMM:\n        if (memcmp(&a->addr.dimm, &b->addr.dimm, sizeof(a->addr.dimm)))\n            return false;\n        break;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virDomainDeviceInfoFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "102-109",
    "snippet": "void\nvirDomainDeviceInfoFree(virDomainDeviceInfoPtr info)\n{\n    if (info) {\n        virDomainDeviceInfoClear(info);\n        VIR_FREE(info);\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "info"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDeviceInfoClear",
          "args": [
            "info"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceInfoClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
          "lines": "90-100",
          "snippet": "void\nvirDomainDeviceInfoClear(virDomainDeviceInfoPtr info)\n{\n    VIR_FREE(info->alias);\n    memset(&info->addr, 0, sizeof(info->addr));\n    info->type = VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE;\n    VIR_FREE(info->romfile);\n    VIR_FREE(info->loadparm);\n    info->isolationGroup = 0;\n    info->isolationGroupLocked = false;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"domain_addr.h\"",
            "#include \"device_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirDomainDeviceInfoClear(virDomainDeviceInfoPtr info)\n{\n    VIR_FREE(info->alias);\n    memset(&info->addr, 0, sizeof(info->addr));\n    info->type = VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE;\n    VIR_FREE(info->romfile);\n    VIR_FREE(info->loadparm);\n    info->isolationGroup = 0;\n    info->isolationGroupLocked = false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirDomainDeviceInfoFree(virDomainDeviceInfoPtr info)\n{\n    if (info) {\n        virDomainDeviceInfoClear(info);\n        VIR_FREE(info);\n    }\n}"
  },
  {
    "function_name": "virDomainDeviceInfoClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "90-100",
    "snippet": "void\nvirDomainDeviceInfoClear(virDomainDeviceInfoPtr info)\n{\n    VIR_FREE(info->alias);\n    memset(&info->addr, 0, sizeof(info->addr));\n    info->type = VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE;\n    VIR_FREE(info->romfile);\n    VIR_FREE(info->loadparm);\n    info->isolationGroup = 0;\n    info->isolationGroupLocked = false;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "info->loadparm"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "info->romfile"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&info->addr",
            "0",
            "sizeof(info->addr)"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "info->alias"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirDomainDeviceInfoClear(virDomainDeviceInfoPtr info)\n{\n    VIR_FREE(info->alias);\n    memset(&info->addr, 0, sizeof(info->addr));\n    info->type = VIR_DOMAIN_DEVICE_ADDRESS_TYPE_NONE;\n    VIR_FREE(info->romfile);\n    VIR_FREE(info->loadparm);\n    info->isolationGroup = 0;\n    info->isolationGroupLocked = false;\n}"
  },
  {
    "function_name": "virZPCIDeviceAddressParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
    "lines": "51-88",
    "snippet": "static int\nvirZPCIDeviceAddressParseXML(xmlNodePtr node,\n                             virPCIDeviceAddressPtr addr)\n{\n    virZPCIDeviceAddress def = { 0 };\n    char *uid;\n    char *fid;\n    int ret = -1;\n\n    uid = virXMLPropString(node, \"uid\");\n    fid = virXMLPropString(node, \"fid\");\n\n    if (uid &&\n        virStrToLong_uip(uid, NULL, 0, &def.uid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'uid' attribute\"));\n        goto cleanup;\n    }\n\n    if (fid &&\n        virStrToLong_uip(fid, NULL, 0, &def.fid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'fid' attribute\"));\n        goto cleanup;\n    }\n\n    if (!virZPCIDeviceAddressIsEmpty(&def) &&\n        !virZPCIDeviceAddressIsValid(&def))\n        goto cleanup;\n\n    addr->zpci = def;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(uid);\n    VIR_FREE(fid);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"domain_addr.h\"",
      "#include \"device_conf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fid"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "uid"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virZPCIDeviceAddressIsValid",
          "args": [
            "&def"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virZPCIDeviceAddressIsValid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2169-2186",
          "snippet": "bool\nvirZPCIDeviceAddressIsValid(virZPCIDeviceAddressPtr zpci)\n{\n    /* We don't need to check fid because fid covers\n     * all range of uint32 type.\n     */\n    if (zpci->uid > VIR_DOMAIN_DEVICE_ZPCI_MAX_UID ||\n        zpci->uid == 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Invalid PCI address uid='0x%.4x', \"\n                         \"must be > 0x0000 and <= 0x%.4x\"),\n                       zpci->uid,\n                       VIR_DOMAIN_DEVICE_ZPCI_MAX_UID);\n        return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirZPCIDeviceAddressIsValid(virZPCIDeviceAddressPtr zpci)\n{\n    /* We don't need to check fid because fid covers\n     * all range of uint32 type.\n     */\n    if (zpci->uid > VIR_DOMAIN_DEVICE_ZPCI_MAX_UID ||\n        zpci->uid == 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"Invalid PCI address uid='0x%.4x', \"\n                         \"must be > 0x0000 and <= 0x%.4x\"),\n                       zpci->uid,\n                       VIR_DOMAIN_DEVICE_ZPCI_MAX_UID);\n        return false;\n    }\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virZPCIDeviceAddressIsEmpty",
          "args": [
            "&def"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "virZPCIDeviceAddressIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2188-2192",
          "snippet": "bool\nvirZPCIDeviceAddressIsEmpty(const virZPCIDeviceAddress *addr)\n{\n    return !(addr->uid || addr->fid);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nbool\nvirZPCIDeviceAddressIsEmpty(const virZPCIDeviceAddress *addr)\n{\n    return !(addr->uid || addr->fid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'fid' attribute\")"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse <address> 'fid' attribute\""
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "fid",
            "NULL",
            "0",
            "&def.fid"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse <address> 'uid' attribute\")"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"fid\""
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirZPCIDeviceAddressParseXML(xmlNodePtr node,\n                             virPCIDeviceAddressPtr addr)\n{\n    virZPCIDeviceAddress def = { 0 };\n    char *uid;\n    char *fid;\n    int ret = -1;\n\n    uid = virXMLPropString(node, \"uid\");\n    fid = virXMLPropString(node, \"fid\");\n\n    if (uid &&\n        virStrToLong_uip(uid, NULL, 0, &def.uid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'uid' attribute\"));\n        goto cleanup;\n    }\n\n    if (fid &&\n        virStrToLong_uip(fid, NULL, 0, &def.fid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'fid' attribute\"));\n        goto cleanup;\n    }\n\n    if (!virZPCIDeviceAddressIsEmpty(&def) &&\n        !virZPCIDeviceAddressIsValid(&def))\n        goto cleanup;\n\n    addr->zpci = def;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(uid);\n    VIR_FREE(fid);\n    return ret;\n}"
  }
]