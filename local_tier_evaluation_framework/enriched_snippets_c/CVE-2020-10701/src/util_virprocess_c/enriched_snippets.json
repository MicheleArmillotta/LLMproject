[
  {
    "function_name": "virProcessSetScheduler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1519-1531",
    "snippet": "int\nvirProcessSetScheduler(pid_t pid G_GNUC_UNUSED,\n                       virProcessSchedPolicy policy,\n                       int priority G_GNUC_UNUSED)\n{\n    if (!policy)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process CPU scheduling is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Process CPU scheduling is not supported \"\n                           \"on this platform\")"
          ],
          "line": 1527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Process CPU scheduling is not supported \"\n                           \"on this platform\""
          ],
          "line": 1528
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetScheduler(pid_t pid G_GNUC_UNUSED,\n                       virProcessSchedPolicy policy,\n                       int priority G_GNUC_UNUSED)\n{\n    if (!policy)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process CPU scheduling is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessSetScheduler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1458-1515",
    "snippet": "int\nvirProcessSetScheduler(pid_t pid,\n                       virProcessSchedPolicy policy,\n                       int priority)\n{\n    struct sched_param param = {0};\n    int pol = virProcessSchedTranslatePolicy(policy);\n\n    VIR_DEBUG(\"pid=%lld, policy=%d, priority=%u\",\n              (long long) pid, policy, priority);\n\n    if (!policy)\n        return 0;\n\n    if (pol < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Scheduler '%s' is not supported on this platform\"),\n                       virProcessSchedPolicyTypeToString(policy));\n        return -1;\n    }\n\n    if (pol == SCHED_FIFO || pol == SCHED_RR) {\n        int min = 0;\n        int max = 0;\n\n        if ((min = sched_get_priority_min(pol)) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Cannot get minimum scheduler \"\n                                   \"priority value\"));\n            return -1;\n        }\n\n        if ((max = sched_get_priority_max(pol)) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Cannot get maximum scheduler \"\n                                   \"priority value\"));\n            return -1;\n        }\n\n        if (priority < min || priority > max) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Scheduler priority %d out of range [%d, %d]\"),\n                           priority, min, max);\n            return -1;\n        }\n\n        param.sched_priority = priority;\n    }\n\n    if (sched_setscheduler(pid, pol, &param) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot set scheduler parameters for pid %lld\"),\n                             (long long) pid);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot set scheduler parameters for pid %lld\")",
            "(long long) pid"
          ],
          "line": 1508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set scheduler parameters for pid %lld\""
          ],
          "line": 1509
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sched_setscheduler",
          "args": [
            "pid",
            "pol",
            "&param"
          ],
          "line": 1507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Scheduler priority %d out of range [%d, %d]\")",
            "priority",
            "min",
            "max"
          ],
          "line": 1498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Cannot get maximum scheduler \"\n                                   \"priority value\")"
          ],
          "line": 1491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_get_priority_max",
          "args": [
            "pol"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Cannot get minimum scheduler \"\n                                   \"priority value\")"
          ],
          "line": 1484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_get_priority_min",
          "args": [
            "pol"
          ],
          "line": 1483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Scheduler '%s' is not supported on this platform\")",
            "virProcessSchedPolicyTypeToString(policy)"
          ],
          "line": 1473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virProcessSchedPolicyTypeToString",
          "args": [
            "policy"
          ],
          "line": 1475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pid=%lld, policy=%d, priority=%u\"",
            "(long long) pid",
            "policy",
            "priority"
          ],
          "line": 1466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virProcessSchedTranslatePolicy",
          "args": [
            "policy"
          ],
          "line": 1464
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessSchedTranslatePolicy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "1423-1456",
          "snippet": "static int\nvirProcessSchedTranslatePolicy(virProcessSchedPolicy policy)\n{\n    switch (policy) {\n    case VIR_PROC_POLICY_NONE:\n        return SCHED_OTHER;\n\n    case VIR_PROC_POLICY_BATCH:\n# ifdef SCHED_BATCH\n        return SCHED_BATCH;\n# else\n        return -1;\n# endif\n\n    case VIR_PROC_POLICY_IDLE:\n# ifdef SCHED_IDLE\n        return SCHED_IDLE;\n# else\n        return -1;\n# endif\n\n    case VIR_PROC_POLICY_FIFO:\n        return SCHED_FIFO;\n\n    case VIR_PROC_POLICY_RR:\n        return SCHED_RR;\n\n    case VIR_PROC_POLICY_LAST:\n        /* nada */\n        break;\n    }\n\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessSchedTranslatePolicy(virProcessSchedPolicy policy)\n{\n    switch (policy) {\n    case VIR_PROC_POLICY_NONE:\n        return SCHED_OTHER;\n\n    case VIR_PROC_POLICY_BATCH:\n# ifdef SCHED_BATCH\n        return SCHED_BATCH;\n# else\n        return -1;\n# endif\n\n    case VIR_PROC_POLICY_IDLE:\n# ifdef SCHED_IDLE\n        return SCHED_IDLE;\n# else\n        return -1;\n# endif\n\n    case VIR_PROC_POLICY_FIFO:\n        return SCHED_FIFO;\n\n    case VIR_PROC_POLICY_RR:\n        return SCHED_RR;\n\n    case VIR_PROC_POLICY_LAST:\n        /* nada */\n        break;\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetScheduler(pid_t pid,\n                       virProcessSchedPolicy policy,\n                       int priority)\n{\n    struct sched_param param = {0};\n    int pol = virProcessSchedTranslatePolicy(policy);\n\n    VIR_DEBUG(\"pid=%lld, policy=%d, priority=%u\",\n              (long long) pid, policy, priority);\n\n    if (!policy)\n        return 0;\n\n    if (pol < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Scheduler '%s' is not supported on this platform\"),\n                       virProcessSchedPolicyTypeToString(policy));\n        return -1;\n    }\n\n    if (pol == SCHED_FIFO || pol == SCHED_RR) {\n        int min = 0;\n        int max = 0;\n\n        if ((min = sched_get_priority_min(pol)) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Cannot get minimum scheduler \"\n                                   \"priority value\"));\n            return -1;\n        }\n\n        if ((max = sched_get_priority_max(pol)) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Cannot get maximum scheduler \"\n                                   \"priority value\"));\n            return -1;\n        }\n\n        if (priority < min || priority > max) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Scheduler priority %d out of range [%d, %d]\"),\n                           priority, min, max);\n            return -1;\n        }\n\n        param.sched_priority = priority;\n    }\n\n    if (sched_setscheduler(pid, pol, &param) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot set scheduler parameters for pid %lld\"),\n                             (long long) pid);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessSchedTranslatePolicy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1423-1456",
    "snippet": "static int\nvirProcessSchedTranslatePolicy(virProcessSchedPolicy policy)\n{\n    switch (policy) {\n    case VIR_PROC_POLICY_NONE:\n        return SCHED_OTHER;\n\n    case VIR_PROC_POLICY_BATCH:\n# ifdef SCHED_BATCH\n        return SCHED_BATCH;\n# else\n        return -1;\n# endif\n\n    case VIR_PROC_POLICY_IDLE:\n# ifdef SCHED_IDLE\n        return SCHED_IDLE;\n# else\n        return -1;\n# endif\n\n    case VIR_PROC_POLICY_FIFO:\n        return SCHED_FIFO;\n\n    case VIR_PROC_POLICY_RR:\n        return SCHED_RR;\n\n    case VIR_PROC_POLICY_LAST:\n        /* nada */\n        break;\n    }\n\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessSchedTranslatePolicy(virProcessSchedPolicy policy)\n{\n    switch (policy) {\n    case VIR_PROC_POLICY_NONE:\n        return SCHED_OTHER;\n\n    case VIR_PROC_POLICY_BATCH:\n# ifdef SCHED_BATCH\n        return SCHED_BATCH;\n# else\n        return -1;\n# endif\n\n    case VIR_PROC_POLICY_IDLE:\n# ifdef SCHED_IDLE\n        return SCHED_IDLE;\n# else\n        return -1;\n# endif\n\n    case VIR_PROC_POLICY_FIFO:\n        return SCHED_FIFO;\n\n    case VIR_PROC_POLICY_RR:\n        return SCHED_RR;\n\n    case VIR_PROC_POLICY_LAST:\n        /* nada */\n        break;\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virProcessExitWithStatus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1393-1419",
    "snippet": "void\nvirProcessExitWithStatus(int status)\n{\n    int value = EXIT_CANNOT_INVOKE;\n\n#ifndef WIN32\n    if (WIFEXITED(status)) {\n        value = WEXITSTATUS(status);\n    } else if (WIFSIGNALED(status)) {\n        struct sigaction act;\n        sigset_t sigs;\n\n        if (sigemptyset(&sigs) == 0 &&\n            sigaddset(&sigs, WTERMSIG(status)) == 0)\n            sigprocmask(SIG_UNBLOCK, &sigs, NULL);\n        memset(&act, 0, sizeof(act));\n        act.sa_handler = SIG_DFL;\n        sigfillset(&act.sa_mask);\n        sigaction(WTERMSIG(status), &act, NULL);\n        raise(WTERMSIG(status));\n        value = 128 + WTERMSIG(status);\n    }\n#else /* WIN32 */\n    (void)status;\n#endif /* WIN32 */\n    exit(value);\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "value"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WTERMSIG",
          "args": [
            "status"
          ],
          "line": 1413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raise",
          "args": [
            "WTERMSIG(status)"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WTERMSIG",
          "args": [
            "status"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaction",
          "args": [
            "WTERMSIG(status)",
            "&act",
            "NULL"
          ],
          "line": 1411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WTERMSIG",
          "args": [
            "status"
          ],
          "line": 1411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigfillset",
          "args": [
            "&act.sa_mask"
          ],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&act",
            "0",
            "sizeof(act)"
          ],
          "line": 1408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigprocmask",
          "args": [
            "SIG_UNBLOCK",
            "&sigs",
            "NULL"
          ],
          "line": 1407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&sigs",
            "WTERMSIG(status)"
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WTERMSIG",
          "args": [
            "status"
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigemptyset",
          "args": [
            "&sigs"
          ],
          "line": 1405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WIFSIGNALED",
          "args": [
            "status"
          ],
          "line": 1401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WEXITSTATUS",
          "args": [
            "status"
          ],
          "line": 1400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WIFEXITED",
          "args": [
            "status"
          ],
          "line": 1399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirProcessExitWithStatus(int status)\n{\n    int value = EXIT_CANNOT_INVOKE;\n\n#ifndef WIN32\n    if (WIFEXITED(status)) {\n        value = WEXITSTATUS(status);\n    } else if (WIFSIGNALED(status)) {\n        struct sigaction act;\n        sigset_t sigs;\n\n        if (sigemptyset(&sigs) == 0 &&\n            sigaddset(&sigs, WTERMSIG(status)) == 0)\n            sigprocmask(SIG_UNBLOCK, &sigs, NULL);\n        memset(&act, 0, sizeof(act));\n        act.sa_handler = SIG_DFL;\n        sigfillset(&act.sa_mask);\n        sigaction(WTERMSIG(status), &act, NULL);\n        raise(WTERMSIG(status));\n        value = 128 + WTERMSIG(status);\n    }\n#else /* WIN32 */\n    (void)status;\n#endif /* WIN32 */\n    exit(value);\n}"
  },
  {
    "function_name": "virProcessNamespaceAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1370-1376",
    "snippet": "int\nvirProcessNamespaceAvailable(unsigned int ns G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Namespaces are not supported on this platform.\")"
          ],
          "line": 1373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Namespaces are not supported on this platform.\""
          ],
          "line": 1374
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessNamespaceAvailable(unsigned int ns G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessSetupPrivateMountNS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1362-1368",
    "snippet": "int\nvirProcessSetupPrivateMountNS(void)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Namespaces are not supported on this platform.\")"
          ],
          "line": 1365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Namespaces are not supported on this platform.\""
          ],
          "line": 1366
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetupPrivateMountNS(void)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessNamespaceAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1316-1358",
    "snippet": "int\nvirProcessNamespaceAvailable(unsigned int ns)\n{\n    int flags = 0;\n    int cpid;\n    char *childStack;\n    int stacksize = getpagesize() * 4;\n    g_autofree char *stack = NULL;\n\n    if (ns & VIR_PROCESS_NAMESPACE_MNT)\n        flags |= CLONE_NEWNS;\n    if (ns & VIR_PROCESS_NAMESPACE_IPC)\n        flags |= CLONE_NEWIPC;\n    if (ns & VIR_PROCESS_NAMESPACE_NET)\n        flags |= CLONE_NEWNET;\n    if (ns & VIR_PROCESS_NAMESPACE_PID)\n        flags |= CLONE_NEWPID;\n    if (ns & VIR_PROCESS_NAMESPACE_USER)\n        flags |= CLONE_NEWUSER;\n    if (ns & VIR_PROCESS_NAMESPACE_UTS)\n        flags |= CLONE_NEWUTS;\n\n    /* Signal parent as soon as the child dies. RIP. */\n    flags |= SIGCHLD;\n\n    if (VIR_ALLOC_N(stack, stacksize) < 0)\n        return -1;\n\n    childStack = stack + stacksize;\n\n    cpid = clone(virProcessDummyChild, childStack, flags, NULL);\n\n    if (cpid < 0) {\n        VIR_DEBUG(\"clone call returned %s, container support is not enabled\",\n                  g_strerror(errno));\n        return -1;\n    } else if (virProcessWait(cpid, NULL, false) < 0) {\n        return -1;\n    }\n\n    VIR_DEBUG(\"All namespaces (%x) are enabled\", ns);\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"All namespaces (%x) are enabled\"",
            "ns"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virProcessWait",
          "args": [
            "cpid",
            "NULL",
            "false"
          ],
          "line": 1352
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "296-302",
          "snippet": "int\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"clone call returned %s, container support is not enabled\"",
            "g_strerror(errno)"
          ],
          "line": 1349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strerror",
          "args": [
            "errno"
          ],
          "line": 1350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clone",
          "args": [
            "virProcessDummyChild",
            "childStack",
            "flags",
            "NULL"
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "stack",
            "stacksize"
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpagesize",
          "args": [],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessNamespaceAvailable(unsigned int ns)\n{\n    int flags = 0;\n    int cpid;\n    char *childStack;\n    int stacksize = getpagesize() * 4;\n    g_autofree char *stack = NULL;\n\n    if (ns & VIR_PROCESS_NAMESPACE_MNT)\n        flags |= CLONE_NEWNS;\n    if (ns & VIR_PROCESS_NAMESPACE_IPC)\n        flags |= CLONE_NEWIPC;\n    if (ns & VIR_PROCESS_NAMESPACE_NET)\n        flags |= CLONE_NEWNET;\n    if (ns & VIR_PROCESS_NAMESPACE_PID)\n        flags |= CLONE_NEWPID;\n    if (ns & VIR_PROCESS_NAMESPACE_USER)\n        flags |= CLONE_NEWUSER;\n    if (ns & VIR_PROCESS_NAMESPACE_UTS)\n        flags |= CLONE_NEWUTS;\n\n    /* Signal parent as soon as the child dies. RIP. */\n    flags |= SIGCHLD;\n\n    if (VIR_ALLOC_N(stack, stacksize) < 0)\n        return -1;\n\n    childStack = stack + stacksize;\n\n    cpid = clone(virProcessDummyChild, childStack, flags, NULL);\n\n    if (cpid < 0) {\n        VIR_DEBUG(\"clone call returned %s, container support is not enabled\",\n                  g_strerror(errno));\n        return -1;\n    } else if (virProcessWait(cpid, NULL, false) < 0) {\n        return -1;\n    }\n\n    VIR_DEBUG(\"All namespaces (%x) are enabled\", ns);\n    return 0;\n}"
  },
  {
    "function_name": "virProcessDummyChild",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1299-1303",
    "snippet": "G_GNUC_NORETURN static int\nvirProcessDummyChild(void *argv G_GNUC_UNUSED)\n{\n    _exit(0);\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_exit",
          "args": [
            "0"
          ],
          "line": 1302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nG_GNUC_NORETURN static int\nvirProcessDummyChild(void *argv G_GNUC_UNUSED)\n{\n    _exit(0);\n}"
  },
  {
    "function_name": "virProcessSetupPrivateMountNS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1280-1296",
    "snippet": "int\nvirProcessSetupPrivateMountNS(void)\n{\n    if (unshare(CLONE_NEWNS) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot unshare mount namespace\"));\n        return -1;\n    }\n\n    if (mount(\"\", \"/\", \"none\", MS_SLAVE|MS_REC, NULL) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Failed to switch root mount into slave mode\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Failed to switch root mount into slave mode\")"
          ],
          "line": 1290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to switch root mount into slave mode\""
          ],
          "line": 1291
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "\"\"",
            "\"/\"",
            "\"none\"",
            "MS_SLAVE|MS_REC",
            "NULL"
          ],
          "line": 1289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Cannot unshare mount namespace\")"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unshare",
          "args": [
            "CLONE_NEWNS"
          ],
          "line": 1283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetupPrivateMountNS(void)\n{\n    if (unshare(CLONE_NEWNS) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot unshare mount namespace\"));\n        return -1;\n    }\n\n    if (mount(\"\", \"/\", \"none\", MS_SLAVE|MS_REC, NULL) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Failed to switch root mount into slave mode\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessRunInFork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1267-1274",
    "snippet": "int\nvirProcessRunInFork(virProcessForkCallback cb G_GNUC_UNUSED,\n                    void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process spawning is not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Process spawning is not supported on this platform\")"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Process spawning is not supported on this platform\""
          ],
          "line": 1272
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessRunInFork(virProcessForkCallback cb G_GNUC_UNUSED,\n                    void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process spawning is not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessRunInFork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1200-1263",
    "snippet": "int\nvirProcessRunInFork(virProcessForkCallback cb,\n                    void *opaque)\n{\n    int ret = -1;\n    pid_t child = -1;\n    pid_t parent = getpid();\n    int errfd[2] = { -1, -1 };\n\n    if (virPipe(errfd) < 0)\n        return -1;\n\n    if ((child = virFork()) < 0)\n        goto cleanup;\n\n    if (child == 0) {\n        VIR_FORCE_CLOSE(errfd[0]);\n        ret = virProcessRunInForkHelper(errfd[1], parent, cb, opaque);\n        VIR_FORCE_CLOSE(errfd[1]);\n        _exit(ret < 0 ? EXIT_CANCELED : ret);\n    } else {\n        int status;\n        g_autofree char *buf = NULL;\n        g_autofree errorDataBin *bin = NULL;\n        int nread;\n\n        VIR_FORCE_CLOSE(errfd[1]);\n        nread = virFileReadHeaderFD(errfd[0], sizeof(*bin), &buf);\n        ret = virProcessWait(child, &status, false);\n        if (ret == 0) {\n            ret = status == EXIT_CANCELED ? -1 : status;\n            if (ret) {\n                if (nread == sizeof(*bin)) {\n                    bin = g_new0(errorDataBin, 1);\n                    memcpy(bin->bindata, buf, sizeof(*bin));\n\n                    virReportError(VIR_ERR_INTERNAL_ERROR,\n                                   _(\"child reported (status=%d): %s\"),\n                                   status, NULLSTR(bin->data.message));\n\n                    virRaiseErrorFull(__FILE__, __FUNCTION__, __LINE__,\n                                      bin->data.domain,\n                                      bin->data.code,\n                                      bin->data.level,\n                                      bin->data.str1,\n                                      bin->data.str2,\n                                      bin->data.str3,\n                                      bin->data.int1,\n                                      bin->data.int2,\n                                      \"%s\", bin->data.message);\n                } else {\n                    virReportError(VIR_ERR_INTERNAL_ERROR,\n                                   _(\"child didn't write error (status=%d)\"),\n                                   status);\n                }\n            }\n        }\n    }\n\n cleanup:\n    VIR_FORCE_CLOSE(errfd[0]);\n    VIR_FORCE_CLOSE(errfd[1]);\n    return ret;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "errfd[1]"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "errfd[0]"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"child didn't write error (status=%d)\")",
            "status"
          ],
          "line": 1251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"child didn't write error (status=%d)\""
          ],
          "line": 1252
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRaiseErrorFull",
          "args": [
            "__FILE__",
            "__FUNCTION__",
            "__LINE__",
            "bin->data.domain",
            "bin->data.code",
            "bin->data.level",
            "bin->data.str1",
            "bin->data.str2",
            "bin->data.str3",
            "bin->data.int1",
            "bin->data.int2",
            "\"%s\"",
            "bin->data.message"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "virRaiseErrorFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "784-858",
          "snippet": "void\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"child reported (status=%d): %s\")",
            "status",
            "NULLSTR(bin->data.message)"
          ],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "bin->data.message"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "bin->bindata",
            "buf",
            "sizeof(*bin)"
          ],
          "line": 1234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "errorDataBin",
            "1"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virProcessWait",
          "args": [
            "child",
            "&status",
            "false"
          ],
          "line": 1228
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "296-302",
          "snippet": "int\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadHeaderFD",
          "args": [
            "errfd[0]",
            "sizeof(*bin)",
            "&buf"
          ],
          "line": 1227
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadHeaderFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1377-1392",
          "snippet": "int\nvirFileReadHeaderFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen, &len);\n    if (s == NULL)\n        return -1;\n    *buf = s;\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadHeaderFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen, &len);\n    if (s == NULL)\n        return -1;\n    *buf = s;\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "errfd[1]"
          ],
          "line": 1226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_exit",
          "args": [
            "ret < 0 ? EXIT_CANCELED : ret"
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "errfd[1]"
          ],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virProcessRunInForkHelper",
          "args": [
            "errfd[1]",
            "parent",
            "cb",
            "opaque"
          ],
          "line": 1217
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessRunInForkHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "1146-1178",
          "snippet": "static int\nvirProcessRunInForkHelper(int errfd,\n                          pid_t ppid,\n                          virProcessForkCallback cb,\n                          void *opaque)\n{\n    if (cb(ppid, opaque) < 0) {\n        virErrorPtr err = virGetLastError();\n\n        if (err) {\n            g_autofree errorDataBin *bin = g_new0(errorDataBin, 1);\n\n            bin->data.code = err->code;\n            bin->data.domain = err->domain;\n            ignore_value(virStrcpy(bin->data.message, err->message, sizeof(bin->data.message)));\n            bin->data.level = err->level;\n            if (err->str1)\n                ignore_value(virStrcpy(bin->data.str1, err->str1, sizeof(bin->data.str1)));\n            if (err->str2)\n                ignore_value(virStrcpy(bin->data.str2, err->str2, sizeof(bin->data.str2)));\n            if (err->str3)\n                ignore_value(virStrcpy(bin->data.str3, err->str3, sizeof(bin->data.str3)));\n            bin->data.int1 = err->int1;\n            bin->data.int2 = err->int2;\n\n            ignore_value(safewrite(errfd, bin->bindata, sizeof(*bin)));\n        }\n\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessRunInForkHelper(int errfd,\n                          pid_t ppid,\n                          virProcessForkCallback cb,\n                          void *opaque)\n{\n    if (cb(ppid, opaque) < 0) {\n        virErrorPtr err = virGetLastError();\n\n        if (err) {\n            g_autofree errorDataBin *bin = g_new0(errorDataBin, 1);\n\n            bin->data.code = err->code;\n            bin->data.domain = err->domain;\n            ignore_value(virStrcpy(bin->data.message, err->message, sizeof(bin->data.message)));\n            bin->data.level = err->level;\n            if (err->str1)\n                ignore_value(virStrcpy(bin->data.str1, err->str1, sizeof(bin->data.str1)));\n            if (err->str2)\n                ignore_value(virStrcpy(bin->data.str2, err->str2, sizeof(bin->data.str2)));\n            if (err->str3)\n                ignore_value(virStrcpy(bin->data.str3, err->str3, sizeof(bin->data.str3)));\n            bin->data.int1 = err->int1;\n            bin->data.int2 = err->int2;\n\n            ignore_value(safewrite(errfd, bin->bindata, sizeof(*bin)));\n        }\n\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "errfd[0]"
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFork",
          "args": [],
          "line": 1212
        },
        "resolved": true,
        "details": {
          "function_name": "virFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "902-908",
          "snippet": "pid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\npid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPipe",
          "args": [
            "errfd"
          ],
          "line": 1209
        },
        "resolved": true,
        "details": {
          "function_name": "virPipeNonBlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1813-1817",
          "snippet": "int\nvirPipeNonBlock(int fds[2])\n{\n    return virPipeImpl(fds, true, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirPipeNonBlock(int fds[2])\n{\n    return virPipeImpl(fds, true, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessRunInFork(virProcessForkCallback cb,\n                    void *opaque)\n{\n    int ret = -1;\n    pid_t child = -1;\n    pid_t parent = getpid();\n    int errfd[2] = { -1, -1 };\n\n    if (virPipe(errfd) < 0)\n        return -1;\n\n    if ((child = virFork()) < 0)\n        goto cleanup;\n\n    if (child == 0) {\n        VIR_FORCE_CLOSE(errfd[0]);\n        ret = virProcessRunInForkHelper(errfd[1], parent, cb, opaque);\n        VIR_FORCE_CLOSE(errfd[1]);\n        _exit(ret < 0 ? EXIT_CANCELED : ret);\n    } else {\n        int status;\n        g_autofree char *buf = NULL;\n        g_autofree errorDataBin *bin = NULL;\n        int nread;\n\n        VIR_FORCE_CLOSE(errfd[1]);\n        nread = virFileReadHeaderFD(errfd[0], sizeof(*bin), &buf);\n        ret = virProcessWait(child, &status, false);\n        if (ret == 0) {\n            ret = status == EXIT_CANCELED ? -1 : status;\n            if (ret) {\n                if (nread == sizeof(*bin)) {\n                    bin = g_new0(errorDataBin, 1);\n                    memcpy(bin->bindata, buf, sizeof(*bin));\n\n                    virReportError(VIR_ERR_INTERNAL_ERROR,\n                                   _(\"child reported (status=%d): %s\"),\n                                   status, NULLSTR(bin->data.message));\n\n                    virRaiseErrorFull(__FILE__, __FUNCTION__, __LINE__,\n                                      bin->data.domain,\n                                      bin->data.code,\n                                      bin->data.level,\n                                      bin->data.str1,\n                                      bin->data.str2,\n                                      bin->data.str3,\n                                      bin->data.int1,\n                                      bin->data.int2,\n                                      \"%s\", bin->data.message);\n                } else {\n                    virReportError(VIR_ERR_INTERNAL_ERROR,\n                                   _(\"child didn't write error (status=%d)\"),\n                                   status);\n                }\n            }\n        }\n    }\n\n cleanup:\n    VIR_FORCE_CLOSE(errfd[0]);\n    VIR_FORCE_CLOSE(errfd[1]);\n    return ret;\n}"
  },
  {
    "function_name": "virProcessRunInForkHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1146-1178",
    "snippet": "static int\nvirProcessRunInForkHelper(int errfd,\n                          pid_t ppid,\n                          virProcessForkCallback cb,\n                          void *opaque)\n{\n    if (cb(ppid, opaque) < 0) {\n        virErrorPtr err = virGetLastError();\n\n        if (err) {\n            g_autofree errorDataBin *bin = g_new0(errorDataBin, 1);\n\n            bin->data.code = err->code;\n            bin->data.domain = err->domain;\n            ignore_value(virStrcpy(bin->data.message, err->message, sizeof(bin->data.message)));\n            bin->data.level = err->level;\n            if (err->str1)\n                ignore_value(virStrcpy(bin->data.str1, err->str1, sizeof(bin->data.str1)));\n            if (err->str2)\n                ignore_value(virStrcpy(bin->data.str2, err->str2, sizeof(bin->data.str2)));\n            if (err->str3)\n                ignore_value(virStrcpy(bin->data.str3, err->str3, sizeof(bin->data.str3)));\n            bin->data.int1 = err->int1;\n            bin->data.int2 = err->int2;\n\n            ignore_value(safewrite(errfd, bin->bindata, sizeof(*bin)));\n        }\n\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "safewrite(errfd, bin->bindata, sizeof(*bin))"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "errfd",
            "bin->bindata",
            "sizeof(*bin)"
          ],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virStrcpy(bin->data.str3, err->str3, sizeof(bin->data.str3))"
          ],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpy",
          "args": [
            "bin->data.str3",
            "err->str3",
            "sizeof(bin->data.str3)"
          ],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "virStrcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "780-784",
          "snippet": "int\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virStrcpy(bin->data.str2, err->str2, sizeof(bin->data.str2))"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virStrcpy(bin->data.str1, err->str1, sizeof(bin->data.str1))"
          ],
          "line": 1163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virStrcpy(bin->data.message, err->message, sizeof(bin->data.message))"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "errorDataBin",
            "1"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastError",
          "args": [],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cb",
          "args": [
            "ppid",
            "opaque"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessRunInForkHelper(int errfd,\n                          pid_t ppid,\n                          virProcessForkCallback cb,\n                          void *opaque)\n{\n    if (cb(ppid, opaque) < 0) {\n        virErrorPtr err = virGetLastError();\n\n        if (err) {\n            g_autofree errorDataBin *bin = g_new0(errorDataBin, 1);\n\n            bin->data.code = err->code;\n            bin->data.domain = err->domain;\n            ignore_value(virStrcpy(bin->data.message, err->message, sizeof(bin->data.message)));\n            bin->data.level = err->level;\n            if (err->str1)\n                ignore_value(virStrcpy(bin->data.str1, err->str1, sizeof(bin->data.str1)));\n            if (err->str2)\n                ignore_value(virStrcpy(bin->data.str2, err->str2, sizeof(bin->data.str2)));\n            if (err->str3)\n                ignore_value(virStrcpy(bin->data.str3, err->str3, sizeof(bin->data.str3)));\n            bin->data.int1 = err->int1;\n            bin->data.int2 = err->int2;\n\n            ignore_value(safewrite(errfd, bin->bindata, sizeof(*bin)));\n        }\n\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessRunInMountNamespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1115-1123",
    "snippet": "int\nvirProcessRunInMountNamespace(pid_t pid G_GNUC_UNUSED,\n                              virProcessNamespaceCallback cb G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Namespaces are not supported on this platform\")"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Namespaces are not supported on this platform\""
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessRunInMountNamespace(pid_t pid G_GNUC_UNUSED,\n                              virProcessNamespaceCallback cb G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessRunInMountNamespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1103-1111",
    "snippet": "int\nvirProcessRunInMountNamespace(pid_t pid,\n                              virProcessNamespaceCallback cb,\n                              void *opaque)\n{\n    virProcessNamespaceHelperData data = {.pid = pid, .cb = cb, .opaque = opaque};\n\n    return virProcessRunInFork(virProcessNamespaceHelper, &data);\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virProcessRunInFork",
          "args": [
            "virProcessNamespaceHelper",
            "&data"
          ],
          "line": 1110
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessRunInFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "1267-1274",
          "snippet": "int\nvirProcessRunInFork(virProcessForkCallback cb G_GNUC_UNUSED,\n                    void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process spawning is not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessRunInFork(virProcessForkCallback cb G_GNUC_UNUSED,\n                    void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process spawning is not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessRunInMountNamespace(pid_t pid,\n                              virProcessNamespaceCallback cb,\n                              void *opaque)\n{\n    virProcessNamespaceHelperData data = {.pid = pid, .cb = cb, .opaque = opaque};\n\n    return virProcessRunInFork(virProcessNamespaceHelper, &data);\n}"
  },
  {
    "function_name": "virProcessNamespaceHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1068-1095",
    "snippet": "static int virProcessNamespaceHelper(pid_t pid G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virProcessNamespaceHelperData *data = opaque;\n    int fd = -1;\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(\"/proc/%lld/ns/mnt\", (long long)data->pid);\n\n    if ((fd = open(path, O_RDONLY)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Kernel does not provide mount namespace\"));\n        goto cleanup;\n    }\n\n    if (setns(fd, 0) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to enter mount namespace\"));\n        goto cleanup;\n    }\n\n    ret = data->cb(data->pid, data->opaque);\n\n cleanup:\n    VIR_FORCE_CLOSE(fd);\n    return ret;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 1093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data->cb",
          "args": [
            "data->pid",
            "data->opaque"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to enter mount namespace\")"
          ],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to enter mount namespace\""
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setns",
          "args": [
            "fd",
            "0"
          ],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "setns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "108-113",
          "snippet": "static inline int setns(int fd G_GNUC_UNUSED, int nstype G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic inline int setns(int fd G_GNUC_UNUSED, int nstype G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Kernel does not provide mount namespace\")"
          ],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_RDONLY"
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int virProcessNamespaceHelper(pid_t pid G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virProcessNamespaceHelperData *data = opaque;\n    int fd = -1;\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(\"/proc/%lld/ns/mnt\", (long long)data->pid);\n\n    if ((fd = open(path, O_RDONLY)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Kernel does not provide mount namespace\"));\n        goto cleanup;\n    }\n\n    if (setns(fd, 0) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to enter mount namespace\"));\n        goto cleanup;\n    }\n\n    ret = data->cb(data->pid, data->opaque);\n\n cleanup:\n    VIR_FORCE_CLOSE(fd);\n    return ret;\n}"
  },
  {
    "function_name": "virProcessGetStartTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1046-1056",
    "snippet": "int virProcessGetStartTime(pid_t pid,\n                           unsigned long long *timestamp)\n{\n    static int warned;\n    if (g_atomic_int_add(&warned, 1) == 0) {\n        VIR_WARN(\"Process start time of pid %lld not available on this platform\",\n                 (long long) pid);\n    }\n    *timestamp = 0;\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Process start time of pid %lld not available on this platform\"",
            "(long long) pid"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_atomic_int_add",
          "args": [
            "&warned",
            "1"
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessGetStartTime(pid_t pid,\n                           unsigned long long *timestamp)\n{\n    static int warned;\n    if (g_atomic_int_add(&warned, 1) == 0) {\n        VIR_WARN(\"Process start time of pid %lld not available on this platform\",\n                 (long long) pid);\n    }\n    *timestamp = 0;\n    return 0;\n}"
  },
  {
    "function_name": "virProcessGetStartTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "1022-1044",
    "snippet": "int virProcessGetStartTime(pid_t pid,\n                           unsigned long long *timestamp)\n{\n    struct kinfo_proc p;\n    int mib[4];\n    size_t len = 4;\n\n    sysctlnametomib(\"kern.proc.pid\", mib, &len);\n\n    len = sizeof(struct kinfo_proc);\n    mib[3] = pid;\n\n    if (sysctl(mib, 4, &p, &len, NULL, 0) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to query process ID start time\"));\n        return -1;\n    }\n\n    *timestamp = (unsigned long long)p.ki_start.tv_sec;\n\n    return 0;\n\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to query process ID start time\")"
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to query process ID start time\""
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysctl",
          "args": [
            "mib",
            "4",
            "&p",
            "&len",
            "NULL",
            "0"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysctlnametomib",
          "args": [
            "\"kern.proc.pid\"",
            "mib",
            "&len"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessGetStartTime(pid_t pid,\n                           unsigned long long *timestamp)\n{\n    struct kinfo_proc p;\n    int mib[4];\n    size_t len = 4;\n\n    sysctlnametomib(\"kern.proc.pid\", mib, &len);\n\n    len = sizeof(struct kinfo_proc);\n    mib[3] = pid;\n\n    if (sysctl(mib, 4, &p, &len, NULL, 0) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to query process ID start time\"));\n        return -1;\n    }\n\n    *timestamp = (unsigned long long)p.ki_start.tv_sec;\n\n    return 0;\n\n}"
  },
  {
    "function_name": "virProcessGetStartTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "967-1020",
    "snippet": "int virProcessGetStartTime(pid_t pid,\n                           unsigned long long *timestamp)\n{\n    char *tmp;\n    int len;\n    g_autofree char *filename = NULL;\n    g_autofree char *buf = NULL;\n    VIR_AUTOSTRINGLIST tokens = NULL;\n\n    filename = g_strdup_printf(\"/proc/%llu/stat\", (long long)pid);\n\n    if ((len = virFileReadAll(filename, 1024, &buf)) < 0)\n        return -1;\n\n    /* start time is the token at index 19 after the '(process name)' entry - since only this\n     * field can contain the ')' character, search backwards for this to avoid malicious\n     * processes trying to fool us\n     */\n\n    if (!(tmp = strrchr(buf, ')'))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find start time in %s\"),\n                       filename);\n        return -1;\n    }\n    tmp += 2; /* skip ') ' */\n    if ((tmp - buf) >= len) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find start time in %s\"),\n                       filename);\n        return -1;\n    }\n\n    tokens = virStringSplit(tmp, \" \", 0);\n\n    if (virStringListLength((const char * const *)tokens) < 20) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find start time in %s\"),\n                       filename);\n        return -1;\n    }\n\n    if (virStrToLong_ull(tokens[19],\n                         NULL,\n                         10,\n                         timestamp) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot parse start time %s in %s\"),\n                       tokens[19], filename);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse start time %s in %s\")",
            "tokens[19]",
            "filename"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse start time %s in %s\""
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "tokens[19]",
            "NULL",
            "10",
            "timestamp"
          ],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find start time in %s\")",
            "filename"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListLength",
          "args": [
            "(const char * const *)tokens"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "893-901",
          "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "tmp",
            "\" \"",
            "0"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find start time in %s\")",
            "filename"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find start time in %s\")",
            "filename"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "buf",
            "')'"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "filename",
            "1024",
            "&buf"
          ],
          "line": 978
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessGetStartTime(pid_t pid,\n                           unsigned long long *timestamp)\n{\n    char *tmp;\n    int len;\n    g_autofree char *filename = NULL;\n    g_autofree char *buf = NULL;\n    VIR_AUTOSTRINGLIST tokens = NULL;\n\n    filename = g_strdup_printf(\"/proc/%llu/stat\", (long long)pid);\n\n    if ((len = virFileReadAll(filename, 1024, &buf)) < 0)\n        return -1;\n\n    /* start time is the token at index 19 after the '(process name)' entry - since only this\n     * field can contain the ')' character, search backwards for this to avoid malicious\n     * processes trying to fool us\n     */\n\n    if (!(tmp = strrchr(buf, ')'))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find start time in %s\"),\n                       filename);\n        return -1;\n    }\n    tmp += 2; /* skip ') ' */\n    if ((tmp - buf) >= len) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find start time in %s\"),\n                       filename);\n        return -1;\n    }\n\n    tokens = virStringSplit(tmp, \" \", 0);\n\n    if (virStringListLength((const char * const *)tokens) < 20) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find start time in %s\"),\n                       filename);\n        return -1;\n    }\n\n    if (virStrToLong_ull(tokens[19],\n                         NULL,\n                         10,\n                         timestamp) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot parse start time %s in %s\"),\n                       tokens[19], filename);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessSetMaxCoreSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "949-958",
    "snippet": "int\nvirProcessSetMaxCoreSize(pid_t pid G_GNUC_UNUSED,\n                         unsigned long long bytes)\n{\n    if (bytes == 0)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Not supported on this platform\")"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Not supported on this platform\""
          ],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetMaxCoreSize(pid_t pid G_GNUC_UNUSED,\n                         unsigned long long bytes)\n{\n    if (bytes == 0)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessSetMaxCoreSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "924-947",
    "snippet": "int\nvirProcessSetMaxCoreSize(pid_t pid, unsigned long long bytes)\n{\n    struct rlimit rlim;\n\n    rlim.rlim_cur = rlim.rlim_max = bytes;\n    if (pid == 0) {\n        if (setrlimit(RLIMIT_CORE, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit core file size to %llu\"),\n                                 bytes);\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_CORE, &rlim, NULL) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit core file size \"\n                                   \"of process %lld to %llu\"),\n                                 (long long int)pid, bytes);\n            return -1;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot limit core file size \"\n                                   \"of process %lld to %llu\")",
            "(long long int)pid",
            "bytes"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot limit core file size \"\n                                   \"of process %lld to %llu\""
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessPrLimit",
          "args": [
            "pid",
            "RLIMIT_CORE",
            "&rlim",
            "NULL"
          ],
          "line": 938
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessPrLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "720-728",
          "snippet": "static int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot limit core file size to %llu\")",
            "bytes"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setrlimit",
          "args": [
            "RLIMIT_CORE",
            "&rlim"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetMaxCoreSize(pid_t pid, unsigned long long bytes)\n{\n    struct rlimit rlim;\n\n    rlim.rlim_cur = rlim.rlim_max = bytes;\n    if (pid == 0) {\n        if (setrlimit(RLIMIT_CORE, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit core file size to %llu\"),\n                                 bytes);\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_CORE, &rlim, NULL) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit core file size \"\n                                   \"of process %lld to %llu\"),\n                                 (long long int)pid, bytes);\n            return -1;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virProcessSetMaxFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "912-920",
    "snippet": "int\nvirProcessSetMaxFiles(pid_t pid G_GNUC_UNUSED, unsigned int files)\n{\n    if (files == 0)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Not supported on this platform\")"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Not supported on this platform\""
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetMaxFiles(pid_t pid G_GNUC_UNUSED, unsigned int files)\n{\n    if (files == 0)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessSetMaxFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "876-910",
    "snippet": "int\nvirProcessSetMaxFiles(pid_t pid, unsigned int files)\n{\n    struct rlimit rlim;\n\n    if (files == 0)\n        return 0;\n\n   /* Max number of opened files is one greater than actual limit. See\n    * man setrlimit.\n    *\n    * NB: That indicates to me that we would want the following code\n    * to say \"files - 1\", but the original of this code in\n    * qemu_process.c also had files + 1, so this preserves current\n    * behavior.\n    */\n    rlim.rlim_cur = rlim.rlim_max = files + 1;\n    if (pid == 0) {\n        if (setrlimit(RLIMIT_NOFILE, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit number of open files to %u\"),\n                                 files);\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_NOFILE, &rlim, NULL) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit number of open files \"\n                                   \"of process %lld to %u\"),\n                                 (long long int)pid, files);\n            return -1;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot limit number of open files \"\n                                   \"of process %lld to %u\")",
            "(long long int)pid",
            "files"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot limit number of open files \"\n                                   \"of process %lld to %u\""
          ],
          "line": 903
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessPrLimit",
          "args": [
            "pid",
            "RLIMIT_NOFILE",
            "&rlim",
            "NULL"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessPrLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "720-728",
          "snippet": "static int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot limit number of open files to %u\")",
            "files"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setrlimit",
          "args": [
            "RLIMIT_NOFILE",
            "&rlim"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetMaxFiles(pid_t pid, unsigned int files)\n{\n    struct rlimit rlim;\n\n    if (files == 0)\n        return 0;\n\n   /* Max number of opened files is one greater than actual limit. See\n    * man setrlimit.\n    *\n    * NB: That indicates to me that we would want the following code\n    * to say \"files - 1\", but the original of this code in\n    * qemu_process.c also had files + 1, so this preserves current\n    * behavior.\n    */\n    rlim.rlim_cur = rlim.rlim_max = files + 1;\n    if (pid == 0) {\n        if (setrlimit(RLIMIT_NOFILE, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit number of open files to %u\"),\n                                 files);\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_NOFILE, &rlim, NULL) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit number of open files \"\n                                   \"of process %lld to %u\"),\n                                 (long long int)pid, files);\n            return -1;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virProcessSetMaxProcesses",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "864-872",
    "snippet": "int\nvirProcessSetMaxProcesses(pid_t pid G_GNUC_UNUSED, unsigned int procs)\n{\n    if (procs == 0)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Not supported on this platform\")"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Not supported on this platform\""
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetMaxProcesses(pid_t pid G_GNUC_UNUSED, unsigned int procs)\n{\n    if (procs == 0)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessSetMaxProcesses",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "836-862",
    "snippet": "int\nvirProcessSetMaxProcesses(pid_t pid, unsigned int procs)\n{\n    struct rlimit rlim;\n\n    if (procs == 0)\n        return 0;\n\n    rlim.rlim_cur = rlim.rlim_max = procs;\n    if (pid == 0) {\n        if (setrlimit(RLIMIT_NPROC, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit number of subprocesses to %u\"),\n                                 procs);\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_NPROC, &rlim, NULL) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit number of subprocesses \"\n                                   \"of process %lld to %u\"),\n                                 (long long int)pid, procs);\n            return -1;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot limit number of subprocesses \"\n                                   \"of process %lld to %u\")",
            "(long long int)pid",
            "procs"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot limit number of subprocesses \"\n                                   \"of process %lld to %u\""
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessPrLimit",
          "args": [
            "pid",
            "RLIMIT_NPROC",
            "&rlim",
            "NULL"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessPrLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "720-728",
          "snippet": "static int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot limit number of subprocesses to %u\")",
            "procs"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setrlimit",
          "args": [
            "RLIMIT_NPROC",
            "&rlim"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetMaxProcesses(pid_t pid, unsigned int procs)\n{\n    struct rlimit rlim;\n\n    if (procs == 0)\n        return 0;\n\n    rlim.rlim_cur = rlim.rlim_max = procs;\n    if (pid == 0) {\n        if (setrlimit(RLIMIT_NPROC, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit number of subprocesses to %u\"),\n                                 procs);\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_NPROC, &rlim, NULL) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit number of subprocesses \"\n                                   \"of process %lld to %u\"),\n                                 (long long int)pid, procs);\n            return -1;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virProcessGetMaxMemLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "823-832",
    "snippet": "int\nvirProcessGetMaxMemLock(pid_t pid G_GNUC_UNUSED,\n                        unsigned long long *bytes)\n{\n    if (!bytes)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Not supported on this platform\")"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Not supported on this platform\""
          ],
          "line": 830
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessGetMaxMemLock(pid_t pid G_GNUC_UNUSED,\n                        unsigned long long *bytes)\n{\n    if (!bytes)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessGetMaxMemLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "784-821",
    "snippet": "int\nvirProcessGetMaxMemLock(pid_t pid,\n                        unsigned long long *bytes)\n{\n    struct rlimit rlim;\n\n    if (!bytes)\n        return 0;\n\n    if (pid == 0) {\n        if (getrlimit(RLIMIT_MEMLOCK, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 \"%s\",\n                                 _(\"cannot get locked memory limit\"));\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_MEMLOCK, NULL, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot get locked memory limit \"\n                                   \"of process %lld\"),\n                                 (long long int) pid);\n            return -1;\n        }\n    }\n\n    /* virProcessSetMaxMemLock() sets both rlim_cur and rlim_max to the\n     * same value, so we can retrieve just rlim_max here. We use\n     * VIR_DOMAIN_MEMORY_PARAM_UNLIMITED internally to represent unlimited\n     * memory amounts, but setrlimit() and prlimit() use RLIM_INFINITY for the\n     * same purpose, so we need to translate between the two conventions */\n    if (rlim.rlim_max == RLIM_INFINITY)\n        *bytes = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    else\n        *bytes = rlim.rlim_max;\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot get locked memory limit \"\n                                   \"of process %lld\")",
            "(long long int) pid"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot get locked memory limit \"\n                                   \"of process %lld\""
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessPrLimit",
          "args": [
            "pid",
            "RLIMIT_MEMLOCK",
            "NULL",
            "&rlim"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessPrLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "720-728",
          "snippet": "static int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"cannot get locked memory limit\")"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getrlimit",
          "args": [
            "RLIMIT_MEMLOCK",
            "&rlim"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessGetMaxMemLock(pid_t pid,\n                        unsigned long long *bytes)\n{\n    struct rlimit rlim;\n\n    if (!bytes)\n        return 0;\n\n    if (pid == 0) {\n        if (getrlimit(RLIMIT_MEMLOCK, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 \"%s\",\n                                 _(\"cannot get locked memory limit\"));\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_MEMLOCK, NULL, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot get locked memory limit \"\n                                   \"of process %lld\"),\n                                 (long long int) pid);\n            return -1;\n        }\n    }\n\n    /* virProcessSetMaxMemLock() sets both rlim_cur and rlim_max to the\n     * same value, so we can retrieve just rlim_max here. We use\n     * VIR_DOMAIN_MEMORY_PARAM_UNLIMITED internally to represent unlimited\n     * memory amounts, but setrlimit() and prlimit() use RLIM_INFINITY for the\n     * same purpose, so we need to translate between the two conventions */\n    if (rlim.rlim_max == RLIM_INFINITY)\n        *bytes = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    else\n        *bytes = rlim.rlim_max;\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessSetMaxMemLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "772-780",
    "snippet": "int\nvirProcessSetMaxMemLock(pid_t pid G_GNUC_UNUSED, unsigned long long bytes)\n{\n    if (bytes == 0)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Not supported on this platform\")"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Not supported on this platform\""
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetMaxMemLock(pid_t pid G_GNUC_UNUSED, unsigned long long bytes)\n{\n    if (bytes == 0)\n        return 0;\n\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessSetMaxMemLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "732-770",
    "snippet": "int\nvirProcessSetMaxMemLock(pid_t pid, unsigned long long bytes)\n{\n    struct rlimit rlim;\n\n    if (bytes == 0)\n        return 0;\n\n    /* We use VIR_DOMAIN_MEMORY_PARAM_UNLIMITED internally to represent\n     * unlimited memory amounts, but setrlimit() and prlimit() use\n     * RLIM_INFINITY for the same purpose, so we need to translate between\n     * the two conventions */\n    if (virMemoryLimitIsSet(bytes))\n        rlim.rlim_cur = rlim.rlim_max = bytes;\n    else\n        rlim.rlim_cur = rlim.rlim_max = RLIM_INFINITY;\n\n    if (pid == 0) {\n        if (setrlimit(RLIMIT_MEMLOCK, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit locked memory to %llu\"),\n                                 bytes);\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_MEMLOCK, &rlim, NULL) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit locked memory \"\n                                   \"of process %lld to %llu\"),\n                                 (long long int)pid, bytes);\n            return -1;\n        }\n    }\n\n    VIR_DEBUG(\"Locked memory for process %lld limited to %llu bytes\",\n              (long long int) pid, bytes);\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Locked memory for process %lld limited to %llu bytes\"",
            "(long long int) pid",
            "bytes"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot limit locked memory \"\n                                   \"of process %lld to %llu\")",
            "(long long int)pid",
            "bytes"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot limit locked memory \"\n                                   \"of process %lld to %llu\""
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessPrLimit",
          "args": [
            "pid",
            "RLIMIT_MEMLOCK",
            "&rlim",
            "NULL"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessPrLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "720-728",
          "snippet": "static int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot limit locked memory to %llu\")",
            "bytes"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setrlimit",
          "args": [
            "RLIMIT_MEMLOCK",
            "&rlim"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMemoryLimitIsSet",
          "args": [
            "bytes"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "virMemoryLimitIsSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1628-1632",
          "snippet": "bool\nvirMemoryLimitIsSet(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirMemoryLimitIsSet(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessSetMaxMemLock(pid_t pid, unsigned long long bytes)\n{\n    struct rlimit rlim;\n\n    if (bytes == 0)\n        return 0;\n\n    /* We use VIR_DOMAIN_MEMORY_PARAM_UNLIMITED internally to represent\n     * unlimited memory amounts, but setrlimit() and prlimit() use\n     * RLIM_INFINITY for the same purpose, so we need to translate between\n     * the two conventions */\n    if (virMemoryLimitIsSet(bytes))\n        rlim.rlim_cur = rlim.rlim_max = bytes;\n    else\n        rlim.rlim_cur = rlim.rlim_max = RLIM_INFINITY;\n\n    if (pid == 0) {\n        if (setrlimit(RLIMIT_MEMLOCK, &rlim) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit locked memory to %llu\"),\n                                 bytes);\n            return -1;\n        }\n    } else {\n        if (virProcessPrLimit(pid, RLIMIT_MEMLOCK, &rlim, NULL) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot limit locked memory \"\n                                   \"of process %lld to %llu\"),\n                                 (long long int)pid, bytes);\n            return -1;\n        }\n    }\n\n    VIR_DEBUG(\"Locked memory for process %lld limited to %llu bytes\",\n              (long long int) pid, bytes);\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessPrLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "720-728",
    "snippet": "static int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessPrLimit(pid_t pid G_GNUC_UNUSED,\n                  int resource G_GNUC_UNUSED,\n                  const struct rlimit *new_limit G_GNUC_UNUSED,\n                  struct rlimit *old_limit G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virProcessPrLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "711-718",
    "snippet": "static int\nvirProcessPrLimit(pid_t pid,\n                  int resource,\n                  const struct rlimit *new_limit,\n                  struct rlimit *old_limit)\n{\n    return prlimit(pid, resource, new_limit, old_limit);\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prlimit",
          "args": [
            "pid",
            "resource",
            "new_limit",
            "old_limit"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nvirProcessPrLimit(pid_t pid,\n                  int resource,\n                  const struct rlimit *new_limit,\n                  struct rlimit *old_limit)\n{\n    return prlimit(pid, resource, new_limit, old_limit);\n}"
  },
  {
    "function_name": "virProcessSetNamespaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "681-708",
    "snippet": "int virProcessSetNamespaces(size_t nfdlist,\n                            int *fdlist)\n{\n    size_t i;\n\n    if (nfdlist == 0) {\n        virReportInvalidArg(nfdlist, \"%s\",\n                            _(\"Expected at least one file descriptor\"));\n        return -1;\n    }\n    for (i = 0; i < nfdlist; i++) {\n        if (fdlist[i] < 0)\n            continue;\n\n        /* We get EINVAL if new NS is same as the current\n         * NS, or if the fd namespace doesn't match the\n         * type passed to setns()'s second param. Since we\n         * pass 0, we know the EINVAL is harmless\n         */\n        if (setns(fdlist[i], 0) < 0 &&\n            errno != EINVAL) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to join domain namespace\"));\n            return -1;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to join domain namespace\")"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to join domain namespace\""
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setns",
          "args": [
            "fdlist[i]",
            "0"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "setns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "108-113",
          "snippet": "static inline int setns(int fd G_GNUC_UNUSED, int nstype G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic inline int setns(int fd G_GNUC_UNUSED, int nstype G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "nfdlist",
            "\"%s\"",
            "_(\"Expected at least one file descriptor\")"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessSetNamespaces(size_t nfdlist,\n                            int *fdlist)\n{\n    size_t i;\n\n    if (nfdlist == 0) {\n        virReportInvalidArg(nfdlist, \"%s\",\n                            _(\"Expected at least one file descriptor\"));\n        return -1;\n    }\n    for (i = 0; i < nfdlist; i++) {\n        if (fdlist[i] < 0)\n            continue;\n\n        /* We get EINVAL if new NS is same as the current\n         * NS, or if the fd namespace doesn't match the\n         * type passed to setns()'s second param. Since we\n         * pass 0, we know the EINVAL is harmless\n         */\n        if (setns(fdlist[i], 0) < 0 &&\n            errno != EINVAL) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to join domain namespace\"));\n            return -1;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virProcessGetNamespaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "642-678",
    "snippet": "int virProcessGetNamespaces(pid_t pid,\n                            size_t *nfdlist,\n                            int **fdlist)\n{\n    int ret = -1;\n    size_t i = 0;\n    const char *ns[] = { \"user\", \"ipc\", \"uts\", \"net\", \"pid\", \"mnt\" };\n\n    *nfdlist = 0;\n    *fdlist = NULL;\n\n    for (i = 0; i < G_N_ELEMENTS(ns); i++) {\n        int fd;\n        g_autofree char *nsfile = NULL;\n\n        nsfile = g_strdup_printf(\"/proc/%llu/ns/%s\", (long long)pid, ns[i]);\n\n        if ((fd = open(nsfile, O_RDONLY)) >= 0) {\n            if (VIR_EXPAND_N(*fdlist, *nfdlist, 1) < 0) {\n                VIR_FORCE_CLOSE(fd);\n                goto cleanup;\n            }\n\n            (*fdlist)[(*nfdlist)-1] = fd;\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        for (i = 0; i < *nfdlist; i++)\n            VIR_FORCE_CLOSE((*fdlist)[i]);\n        VIR_FREE(*fdlist);\n    }\n    return ret;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*fdlist"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "(*fdlist)[i]"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "*fdlist",
            "*nfdlist",
            "1"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "nsfile",
            "O_RDONLY"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/proc/%llu/ns/%s\"",
            "(long long)pid",
            "ns[i]"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "ns"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessGetNamespaces(pid_t pid,\n                            size_t *nfdlist,\n                            int **fdlist)\n{\n    int ret = -1;\n    size_t i = 0;\n    const char *ns[] = { \"user\", \"ipc\", \"uts\", \"net\", \"pid\", \"mnt\" };\n\n    *nfdlist = 0;\n    *fdlist = NULL;\n\n    for (i = 0; i < G_N_ELEMENTS(ns); i++) {\n        int fd;\n        g_autofree char *nsfile = NULL;\n\n        nsfile = g_strdup_printf(\"/proc/%llu/ns/%s\", (long long)pid, ns[i]);\n\n        if ((fd = open(nsfile, O_RDONLY)) >= 0) {\n            if (VIR_EXPAND_N(*fdlist, *nfdlist, 1) < 0) {\n                VIR_FORCE_CLOSE(fd);\n                goto cleanup;\n            }\n\n            (*fdlist)[(*nfdlist)-1] = fd;\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        for (i = 0; i < *nfdlist; i++)\n            VIR_FORCE_CLOSE((*fdlist)[i]);\n        VIR_FREE(*fdlist);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virProcessGetPids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "601-639",
    "snippet": "int virProcessGetPids(pid_t pid, size_t *npids, pid_t **pids)\n{\n    int ret = -1;\n    DIR *dir = NULL;\n    int value;\n    struct dirent *ent;\n    g_autofree char *taskPath = NULL;\n\n    *npids = 0;\n    *pids = NULL;\n\n    taskPath = g_strdup_printf(\"/proc/%llu/task\", (long long)pid);\n\n    if (virDirOpen(&dir, taskPath) < 0)\n        goto cleanup;\n\n    while ((value = virDirRead(dir, &ent, taskPath)) > 0) {\n        long long tmp;\n        pid_t tmp_pid;\n\n        if (virStrToLong_ll(ent->d_name, NULL, 10, &tmp) < 0)\n            goto cleanup;\n        tmp_pid = tmp;\n\n        if (VIR_APPEND_ELEMENT(*pids, *npids, tmp_pid) < 0)\n            goto cleanup;\n    }\n\n    if (value < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dir);\n    if (ret < 0)\n        VIR_FREE(*pids);\n    return ret;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*pids"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dir"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "*pids",
            "*npids",
            "tmp_pid"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "ent->d_name",
            "NULL",
            "10",
            "&tmp"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&ent",
            "taskPath"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpen",
          "args": [
            "&dir",
            "taskPath"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/proc/%llu/task\"",
            "(long long)pid"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessGetPids(pid_t pid, size_t *npids, pid_t **pids)\n{\n    int ret = -1;\n    DIR *dir = NULL;\n    int value;\n    struct dirent *ent;\n    g_autofree char *taskPath = NULL;\n\n    *npids = 0;\n    *pids = NULL;\n\n    taskPath = g_strdup_printf(\"/proc/%llu/task\", (long long)pid);\n\n    if (virDirOpen(&dir, taskPath) < 0)\n        goto cleanup;\n\n    while ((value = virDirRead(dir, &ent, taskPath)) > 0) {\n        long long tmp;\n        pid_t tmp_pid;\n\n        if (virStrToLong_ll(ent->d_name, NULL, 10, &tmp) < 0)\n            goto cleanup;\n        tmp_pid = tmp;\n\n        if (VIR_APPEND_ELEMENT(*pids, *npids, tmp_pid) < 0)\n            goto cleanup;\n    }\n\n    if (value < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dir);\n    if (ret < 0)\n        VIR_FREE(*pids);\n    return ret;\n}"
  },
  {
    "function_name": "virProcessGetAffinity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "591-597",
    "snippet": "virBitmapPtr\nvirProcessGetAffinity(pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process CPU affinity is not supported on this platform\"));\n    return NULL;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Process CPU affinity is not supported on this platform\")"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Process CPU affinity is not supported on this platform\""
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirBitmapPtr\nvirProcessGetAffinity(pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process CPU affinity is not supported on this platform\"));\n    return NULL;\n}"
  },
  {
    "function_name": "virProcessSetAffinity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "583-589",
    "snippet": "int virProcessSetAffinity(pid_t pid G_GNUC_UNUSED,\n                          virBitmapPtr map G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process CPU affinity is not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Process CPU affinity is not supported on this platform\")"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Process CPU affinity is not supported on this platform\""
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessSetAffinity(pid_t pid G_GNUC_UNUSED,\n                          virBitmapPtr map G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Process CPU affinity is not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessGetAffinity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "556-579",
    "snippet": "virBitmapPtr\nvirProcessGetAffinity(pid_t pid)\n{\n    size_t i;\n    cpuset_t mask;\n    virBitmapPtr ret = NULL;\n\n    CPU_ZERO(&mask);\n    if (cpuset_getaffinity(CPU_LEVEL_WHICH, CPU_WHICH_PID, pid,\n                           sizeof(mask), &mask) != 0) {\n        virReportSystemError(errno,\n                             _(\"cannot get CPU affinity of process %d\"), pid);\n        return NULL;\n    }\n\n    if (!(ret = virBitmapNew(sizeof(mask) * 8)))\n        return NULL;\n\n    for (i = 0; i < sizeof(mask) * 8; i++)\n        if (CPU_ISSET(i, &mask))\n            ignore_value(virBitmapSetBit(ret, i));\n\n    return ret;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(ret, i)"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "ret",
            "i"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CPU_ISSET",
          "args": [
            "i",
            "&mask"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "sizeof(mask) * 8"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot get CPU affinity of process %d\")",
            "pid"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot get CPU affinity of process %d\""
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuset_getaffinity",
          "args": [
            "CPU_LEVEL_WHICH",
            "CPU_WHICH_PID",
            "pid",
            "sizeof(mask)",
            "&mask"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPU_ZERO",
          "args": [
            "&mask"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirBitmapPtr\nvirProcessGetAffinity(pid_t pid)\n{\n    size_t i;\n    cpuset_t mask;\n    virBitmapPtr ret = NULL;\n\n    CPU_ZERO(&mask);\n    if (cpuset_getaffinity(CPU_LEVEL_WHICH, CPU_WHICH_PID, pid,\n                           sizeof(mask), &mask) != 0) {\n        virReportSystemError(errno,\n                             _(\"cannot get CPU affinity of process %d\"), pid);\n        return NULL;\n    }\n\n    if (!(ret = virBitmapNew(sizeof(mask) * 8)))\n        return NULL;\n\n    for (i = 0; i < sizeof(mask) * 8; i++)\n        if (CPU_ISSET(i, &mask))\n            ignore_value(virBitmapSetBit(ret, i));\n\n    return ret;\n}"
  },
  {
    "function_name": "virProcessSetAffinity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "534-554",
    "snippet": "int virProcessSetAffinity(pid_t pid,\n                          virBitmapPtr map)\n{\n    size_t i;\n    cpuset_t mask;\n\n    CPU_ZERO(&mask);\n    for (i = 0; i < virBitmapSize(map); i++) {\n        if (virBitmapIsBitSet(map, i))\n            CPU_SET(i, &mask);\n    }\n\n    if (cpuset_setaffinity(CPU_LEVEL_WHICH, CPU_WHICH_PID, pid,\n                           sizeof(mask), &mask) != 0) {\n        virReportSystemError(errno,\n                             _(\"cannot set CPU affinity on process %d\"), pid);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot set CPU affinity on process %d\")",
            "pid"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set CPU affinity on process %d\""
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuset_setaffinity",
          "args": [
            "CPU_LEVEL_WHICH",
            "CPU_WHICH_PID",
            "pid",
            "sizeof(mask)",
            "&mask"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPU_SET",
          "args": [
            "i",
            "&mask"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapIsBitSet",
          "args": [
            "map",
            "i"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsBitSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "298-306",
          "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapSize",
          "args": [
            "map"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "882-886",
          "snippet": "size_t\nvirBitmapSize(virBitmapPtr bitmap)\n{\n    return bitmap->nbits;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nsize_t\nvirBitmapSize(virBitmapPtr bitmap)\n{\n    return bitmap->nbits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CPU_ZERO",
          "args": [
            "&mask"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessSetAffinity(pid_t pid,\n                          virBitmapPtr map)\n{\n    size_t i;\n    cpuset_t mask;\n\n    CPU_ZERO(&mask);\n    for (i = 0; i < virBitmapSize(map); i++) {\n        if (virBitmapIsBitSet(map, i))\n            CPU_SET(i, &mask);\n    }\n\n    if (cpuset_setaffinity(CPU_LEVEL_WHICH, CPU_WHICH_PID, pid,\n                           sizeof(mask), &mask) != 0) {\n        virReportSystemError(errno,\n                             _(\"cannot set CPU affinity on process %d\"), pid);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessGetAffinity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "490-530",
    "snippet": "virBitmapPtr\nvirProcessGetAffinity(pid_t pid)\n{\n    size_t i;\n    cpu_set_t *mask;\n    size_t masklen;\n    size_t ncpus;\n    virBitmapPtr ret = NULL;\n\n    /* 262144 cpus ought to be enough for anyone */\n    ncpus = 1024 << 8;\n    masklen = CPU_ALLOC_SIZE(ncpus);\n    mask = CPU_ALLOC(ncpus);\n\n    if (!mask) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    CPU_ZERO_S(masklen, mask);\n\n    if (sched_getaffinity(pid, masklen, mask) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot get CPU affinity of process %d\"), pid);\n        goto cleanup;\n    }\n\n    if (!(ret = virBitmapNew(ncpus)))\n          goto cleanup;\n\n    for (i = 0; i < ncpus; i++) {\n         /* coverity[overrun-local] */\n        if (CPU_ISSET_S(i, masklen, mask))\n            ignore_value(virBitmapSetBit(ret, i));\n    }\n\n cleanup:\n    CPU_FREE(mask);\n\n    return ret;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CPU_FREE",
          "args": [
            "mask"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(ret, i)"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "ret",
            "i"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CPU_ISSET_S",
          "args": [
            "i",
            "masklen",
            "mask"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "ncpus"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot get CPU affinity of process %d\")",
            "pid"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot get CPU affinity of process %d\""
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sched_getaffinity",
          "args": [
            "pid",
            "masklen",
            "mask"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPU_ZERO_S",
          "args": [
            "masklen",
            "mask"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPU_ALLOC",
          "args": [
            "ncpus"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPU_ALLOC_SIZE",
          "args": [
            "ncpus"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirBitmapPtr\nvirProcessGetAffinity(pid_t pid)\n{\n    size_t i;\n    cpu_set_t *mask;\n    size_t masklen;\n    size_t ncpus;\n    virBitmapPtr ret = NULL;\n\n    /* 262144 cpus ought to be enough for anyone */\n    ncpus = 1024 << 8;\n    masklen = CPU_ALLOC_SIZE(ncpus);\n    mask = CPU_ALLOC(ncpus);\n\n    if (!mask) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    CPU_ZERO_S(masklen, mask);\n\n    if (sched_getaffinity(pid, masklen, mask) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot get CPU affinity of process %d\"), pid);\n        goto cleanup;\n    }\n\n    if (!(ret = virBitmapNew(ncpus)))\n          goto cleanup;\n\n    for (i = 0; i < ncpus; i++) {\n         /* coverity[overrun-local] */\n        if (CPU_ISSET_S(i, masklen, mask))\n            ignore_value(virBitmapSetBit(ret, i));\n    }\n\n cleanup:\n    CPU_FREE(mask);\n\n    return ret;\n}"
  },
  {
    "function_name": "virProcessSetAffinity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "444-488",
    "snippet": "int virProcessSetAffinity(pid_t pid, virBitmapPtr map)\n{\n    size_t i;\n    VIR_DEBUG(\"Set process affinity on %lld\", (long long)pid);\n    int numcpus = 1024;\n    size_t masklen;\n    cpu_set_t *mask;\n\n    /* Not only may the statically allocated cpu_set_t be too small,\n     * but there is no way to ask the kernel what size is large enough.\n     * So you have no option but to pick a size, try, catch EINVAL,\n     * enlarge, and re-try.\n     *\n     * http://lkml.org/lkml/2009/7/28/620\n     */\n realloc:\n    masklen = CPU_ALLOC_SIZE(numcpus);\n    mask = CPU_ALLOC(numcpus);\n\n    if (!mask) {\n        virReportOOMError();\n        return -1;\n    }\n\n    CPU_ZERO_S(masklen, mask);\n    for (i = 0; i < virBitmapSize(map); i++) {\n        if (virBitmapIsBitSet(map, i))\n            CPU_SET_S(i, masklen, mask);\n    }\n\n    if (sched_setaffinity(pid, masklen, mask) < 0) {\n        CPU_FREE(mask);\n        if (errno == EINVAL &&\n            numcpus < (1024 << 8)) { /* 262144 cpus ought to be enough for anyone */\n            numcpus = numcpus << 2;\n            goto realloc;\n        }\n        virReportSystemError(errno,\n                             _(\"cannot set CPU affinity on process %d\"), pid);\n        return -1;\n    }\n    CPU_FREE(mask);\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CPU_FREE",
          "args": [
            "mask"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot set CPU affinity on process %d\")",
            "pid"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set CPU affinity on process %d\""
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CPU_FREE",
          "args": [
            "mask"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_setaffinity",
          "args": [
            "pid",
            "masklen",
            "mask"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPU_SET_S",
          "args": [
            "i",
            "masklen",
            "mask"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapIsBitSet",
          "args": [
            "map",
            "i"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsBitSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "298-306",
          "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapSize",
          "args": [
            "map"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "882-886",
          "snippet": "size_t\nvirBitmapSize(virBitmapPtr bitmap)\n{\n    return bitmap->nbits;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nsize_t\nvirBitmapSize(virBitmapPtr bitmap)\n{\n    return bitmap->nbits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CPU_ZERO_S",
          "args": [
            "masklen",
            "mask"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPU_ALLOC",
          "args": [
            "numcpus"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPU_ALLOC_SIZE",
          "args": [
            "numcpus"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Set process affinity on %lld\"",
            "(long long)pid"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessSetAffinity(pid_t pid, virBitmapPtr map)\n{\n    size_t i;\n    VIR_DEBUG(\"Set process affinity on %lld\", (long long)pid);\n    int numcpus = 1024;\n    size_t masklen;\n    cpu_set_t *mask;\n\n    /* Not only may the statically allocated cpu_set_t be too small,\n     * but there is no way to ask the kernel what size is large enough.\n     * So you have no option but to pick a size, try, catch EINVAL,\n     * enlarge, and re-try.\n     *\n     * http://lkml.org/lkml/2009/7/28/620\n     */\n realloc:\n    masklen = CPU_ALLOC_SIZE(numcpus);\n    mask = CPU_ALLOC(numcpus);\n\n    if (!mask) {\n        virReportOOMError();\n        return -1;\n    }\n\n    CPU_ZERO_S(masklen, mask);\n    for (i = 0; i < virBitmapSize(map); i++) {\n        if (virBitmapIsBitSet(map, i))\n            CPU_SET_S(i, masklen, mask);\n    }\n\n    if (sched_setaffinity(pid, masklen, mask) < 0) {\n        CPU_FREE(mask);\n        if (errno == EINVAL &&\n            numcpus < (1024 << 8)) { /* 262144 cpus ought to be enough for anyone */\n            numcpus = numcpus << 2;\n            goto realloc;\n        }\n        virReportSystemError(errno,\n                             _(\"cannot set CPU affinity on process %d\"), pid);\n        return -1;\n    }\n    CPU_FREE(mask);\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessKillPainfully",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "437-440",
    "snippet": "int virProcessKillPainfully(pid_t pid, bool force)\n{\n    return virProcessKillPainfullyDelay(pid, force, 0);\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virProcessKillPainfullyDelay",
          "args": [
            "pid",
            "force",
            "0"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessKillPainfullyDelay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "374-434",
          "snippet": "int\nvirProcessKillPainfullyDelay(pid_t pid, bool force, unsigned int extradelay)\n{\n    size_t i;\n    /* This is in 1/5th seconds since polling is on a 0.2s interval */\n    unsigned int polldelay = (force ? 200 : 75) + (extradelay*5);\n    const char *signame = \"TERM\";\n\n    VIR_DEBUG(\"vpid=%lld force=%d extradelay=%u\",\n              (long long)pid, force, extradelay);\n\n    /* This loop sends SIGTERM, then waits a few iterations (10 seconds)\n     * to see if it dies. If the process still hasn't exited, and\n     * @force is requested, a SIGKILL will be sent, and this will\n     * wait up to 30 seconds more for the process to exit before\n     * returning.\n     *\n     * An extra delay can be passed by the caller for cases that are\n     * expected to clean up slower than usual.\n     *\n     * Note that setting @force could result in dataloss for the process.\n     */\n    for (i = 0; i < polldelay; i++) {\n        int signum;\n        if (i == 0) {\n            signum = SIGTERM; /* kindly suggest it should exit */\n        } else if (i == 50 && force) {\n            VIR_DEBUG(\"Timed out waiting after SIGTERM to process %lld, \"\n                      \"sending SIGKILL\", (long long)pid);\n            /* No SIGKILL kill on Win32 ! Use SIGABRT instead which our\n             * virProcessKill proc will handle more or less like SIGKILL */\n#ifdef WIN32\n            signum = SIGABRT; /* kill it after a grace period */\n            signame = \"ABRT\";\n#else\n            signum = SIGKILL; /* kill it after a grace period */\n            signame = \"KILL\";\n#endif\n        } else {\n            signum = 0; /* Just check for existence */\n        }\n\n        if (virProcessKill(pid, signum) < 0) {\n            if (errno != ESRCH) {\n                virReportSystemError(errno,\n                                     _(\"Failed to terminate process %lld with SIG%s\"),\n                                     (long long)pid, signame);\n                return -1;\n            }\n            return signum == SIGTERM ? 0 : 1;\n        }\n\n        g_usleep(200 * 1000);\n    }\n\n    virReportSystemError(EBUSY,\n                         _(\"Failed to terminate process %lld with SIG%s\"),\n                         (long long)pid, signame);\n\n    return 0;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessKillPainfullyDelay(pid_t pid, bool force, unsigned int extradelay)\n{\n    size_t i;\n    /* This is in 1/5th seconds since polling is on a 0.2s interval */\n    unsigned int polldelay = (force ? 200 : 75) + (extradelay*5);\n    const char *signame = \"TERM\";\n\n    VIR_DEBUG(\"vpid=%lld force=%d extradelay=%u\",\n              (long long)pid, force, extradelay);\n\n    /* This loop sends SIGTERM, then waits a few iterations (10 seconds)\n     * to see if it dies. If the process still hasn't exited, and\n     * @force is requested, a SIGKILL will be sent, and this will\n     * wait up to 30 seconds more for the process to exit before\n     * returning.\n     *\n     * An extra delay can be passed by the caller for cases that are\n     * expected to clean up slower than usual.\n     *\n     * Note that setting @force could result in dataloss for the process.\n     */\n    for (i = 0; i < polldelay; i++) {\n        int signum;\n        if (i == 0) {\n            signum = SIGTERM; /* kindly suggest it should exit */\n        } else if (i == 50 && force) {\n            VIR_DEBUG(\"Timed out waiting after SIGTERM to process %lld, \"\n                      \"sending SIGKILL\", (long long)pid);\n            /* No SIGKILL kill on Win32 ! Use SIGABRT instead which our\n             * virProcessKill proc will handle more or less like SIGKILL */\n#ifdef WIN32\n            signum = SIGABRT; /* kill it after a grace period */\n            signame = \"ABRT\";\n#else\n            signum = SIGKILL; /* kill it after a grace period */\n            signame = \"KILL\";\n#endif\n        } else {\n            signum = 0; /* Just check for existence */\n        }\n\n        if (virProcessKill(pid, signum) < 0) {\n            if (errno != ESRCH) {\n                virReportSystemError(errno,\n                                     _(\"Failed to terminate process %lld with SIG%s\"),\n                                     (long long)pid, signame);\n                return -1;\n            }\n            return signum == SIGTERM ? 0 : 1;\n        }\n\n        g_usleep(200 * 1000);\n    }\n\n    virReportSystemError(EBUSY,\n                         _(\"Failed to terminate process %lld with SIG%s\"),\n                         (long long)pid, signame);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessKillPainfully(pid_t pid, bool force)\n{\n    return virProcessKillPainfullyDelay(pid, force, 0);\n}"
  },
  {
    "function_name": "virProcessKillPainfullyDelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "374-434",
    "snippet": "int\nvirProcessKillPainfullyDelay(pid_t pid, bool force, unsigned int extradelay)\n{\n    size_t i;\n    /* This is in 1/5th seconds since polling is on a 0.2s interval */\n    unsigned int polldelay = (force ? 200 : 75) + (extradelay*5);\n    const char *signame = \"TERM\";\n\n    VIR_DEBUG(\"vpid=%lld force=%d extradelay=%u\",\n              (long long)pid, force, extradelay);\n\n    /* This loop sends SIGTERM, then waits a few iterations (10 seconds)\n     * to see if it dies. If the process still hasn't exited, and\n     * @force is requested, a SIGKILL will be sent, and this will\n     * wait up to 30 seconds more for the process to exit before\n     * returning.\n     *\n     * An extra delay can be passed by the caller for cases that are\n     * expected to clean up slower than usual.\n     *\n     * Note that setting @force could result in dataloss for the process.\n     */\n    for (i = 0; i < polldelay; i++) {\n        int signum;\n        if (i == 0) {\n            signum = SIGTERM; /* kindly suggest it should exit */\n        } else if (i == 50 && force) {\n            VIR_DEBUG(\"Timed out waiting after SIGTERM to process %lld, \"\n                      \"sending SIGKILL\", (long long)pid);\n            /* No SIGKILL kill on Win32 ! Use SIGABRT instead which our\n             * virProcessKill proc will handle more or less like SIGKILL */\n#ifdef WIN32\n            signum = SIGABRT; /* kill it after a grace period */\n            signame = \"ABRT\";\n#else\n            signum = SIGKILL; /* kill it after a grace period */\n            signame = \"KILL\";\n#endif\n        } else {\n            signum = 0; /* Just check for existence */\n        }\n\n        if (virProcessKill(pid, signum) < 0) {\n            if (errno != ESRCH) {\n                virReportSystemError(errno,\n                                     _(\"Failed to terminate process %lld with SIG%s\"),\n                                     (long long)pid, signame);\n                return -1;\n            }\n            return signum == SIGTERM ? 0 : 1;\n        }\n\n        g_usleep(200 * 1000);\n    }\n\n    virReportSystemError(EBUSY,\n                         _(\"Failed to terminate process %lld with SIG%s\"),\n                         (long long)pid, signame);\n\n    return 0;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EBUSY",
            "_(\"Failed to terminate process %lld with SIG%s\")",
            "(long long)pid",
            "signame"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to terminate process %lld with SIG%s\""
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_usleep",
          "args": [
            "200 * 1000"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to terminate process %lld with SIG%s\")",
            "(long long)pid",
            "signame"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virProcessKill",
          "args": [
            "pid",
            "signum"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessKillPainfully",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "437-440",
          "snippet": "int virProcessKillPainfully(pid_t pid, bool force)\n{\n    return virProcessKillPainfullyDelay(pid, force, 0);\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessKillPainfully(pid_t pid, bool force)\n{\n    return virProcessKillPainfullyDelay(pid, force, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Timed out waiting after SIGTERM to process %lld, \"\n                      \"sending SIGKILL\"",
            "(long long)pid"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vpid=%lld force=%d extradelay=%u\"",
            "(long long)pid",
            "force",
            "extradelay"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessKillPainfullyDelay(pid_t pid, bool force, unsigned int extradelay)\n{\n    size_t i;\n    /* This is in 1/5th seconds since polling is on a 0.2s interval */\n    unsigned int polldelay = (force ? 200 : 75) + (extradelay*5);\n    const char *signame = \"TERM\";\n\n    VIR_DEBUG(\"vpid=%lld force=%d extradelay=%u\",\n              (long long)pid, force, extradelay);\n\n    /* This loop sends SIGTERM, then waits a few iterations (10 seconds)\n     * to see if it dies. If the process still hasn't exited, and\n     * @force is requested, a SIGKILL will be sent, and this will\n     * wait up to 30 seconds more for the process to exit before\n     * returning.\n     *\n     * An extra delay can be passed by the caller for cases that are\n     * expected to clean up slower than usual.\n     *\n     * Note that setting @force could result in dataloss for the process.\n     */\n    for (i = 0; i < polldelay; i++) {\n        int signum;\n        if (i == 0) {\n            signum = SIGTERM; /* kindly suggest it should exit */\n        } else if (i == 50 && force) {\n            VIR_DEBUG(\"Timed out waiting after SIGTERM to process %lld, \"\n                      \"sending SIGKILL\", (long long)pid);\n            /* No SIGKILL kill on Win32 ! Use SIGABRT instead which our\n             * virProcessKill proc will handle more or less like SIGKILL */\n#ifdef WIN32\n            signum = SIGABRT; /* kill it after a grace period */\n            signame = \"ABRT\";\n#else\n            signum = SIGKILL; /* kill it after a grace period */\n            signame = \"KILL\";\n#endif\n        } else {\n            signum = 0; /* Just check for existence */\n        }\n\n        if (virProcessKill(pid, signum) < 0) {\n            if (errno != ESRCH) {\n                virReportSystemError(errno,\n                                     _(\"Failed to terminate process %lld with SIG%s\"),\n                                     (long long)pid, signame);\n                return -1;\n            }\n            return signum == SIGTERM ? 0 : 1;\n        }\n\n        g_usleep(200 * 1000);\n    }\n\n    virReportSystemError(EBUSY,\n                         _(\"Failed to terminate process %lld with SIG%s\"),\n                         (long long)pid, signame);\n\n    return 0;\n}"
  },
  {
    "function_name": "virProcessKill",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "308-361",
    "snippet": "int virProcessKill(pid_t pid, int sig)\n{\n    if (pid <= 1) {\n        errno = ESRCH;\n        return -1;\n    }\n\n#ifdef WIN32\n    /* Mingw / Windows don't have many signals (AFAIK) */\n    switch (sig) {\n    case SIGINT:\n        /* This does a Ctrl+C equiv */\n        if (!GenerateConsoleCtrlEvent(CTRL_C_EVENT, pid)) {\n            errno = ESRCH;\n            return -1;\n        }\n        break;\n\n    case SIGTERM:\n        /* Since TerminateProcess is closer to SIG_KILL, we do\n         * a Ctrl+Break equiv which is more pleasant like the\n         * good old unix SIGTERM/HUP\n         */\n        if (!GenerateConsoleCtrlEvent(CTRL_BREAK_EVENT, pid)) {\n            errno = ESRCH;\n            return -1;\n        }\n        break;\n\n    default:\n    {\n        HANDLE proc;\n        proc = OpenProcess(PROCESS_TERMINATE, FALSE, pid);\n        if (!proc) {\n            errno = ESRCH; /* Not entirely accurate, but close enough */\n            return -1;\n        }\n\n        /*\n         * TerminateProcess is more or less equiv to SIG_KILL, in that\n         * a process can't trap / block it\n         */\n        if (sig != 0 && !TerminateProcess(proc, sig)) {\n            errno = ESRCH;\n            return -1;\n        }\n        CloseHandle(proc);\n    }\n    }\n    return 0;\n#else\n    return kill(pid, sig);\n#endif\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "pid",
            "sig"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CloseHandle",
          "args": [
            "proc"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TerminateProcess",
          "args": [
            "proc",
            "sig"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OpenProcess",
          "args": [
            "PROCESS_TERMINATE",
            "FALSE",
            "pid"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenerateConsoleCtrlEvent",
          "args": [
            "CTRL_BREAK_EVENT",
            "pid"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenerateConsoleCtrlEvent",
          "args": [
            "CTRL_C_EVENT",
            "pid"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessKill(pid_t pid, int sig)\n{\n    if (pid <= 1) {\n        errno = ESRCH;\n        return -1;\n    }\n\n#ifdef WIN32\n    /* Mingw / Windows don't have many signals (AFAIK) */\n    switch (sig) {\n    case SIGINT:\n        /* This does a Ctrl+C equiv */\n        if (!GenerateConsoleCtrlEvent(CTRL_C_EVENT, pid)) {\n            errno = ESRCH;\n            return -1;\n        }\n        break;\n\n    case SIGTERM:\n        /* Since TerminateProcess is closer to SIG_KILL, we do\n         * a Ctrl+Break equiv which is more pleasant like the\n         * good old unix SIGTERM/HUP\n         */\n        if (!GenerateConsoleCtrlEvent(CTRL_BREAK_EVENT, pid)) {\n            errno = ESRCH;\n            return -1;\n        }\n        break;\n\n    default:\n    {\n        HANDLE proc;\n        proc = OpenProcess(PROCESS_TERMINATE, FALSE, pid);\n        if (!proc) {\n            errno = ESRCH; /* Not entirely accurate, but close enough */\n            return -1;\n        }\n\n        /*\n         * TerminateProcess is more or less equiv to SIG_KILL, in that\n         * a process can't trap / block it\n         */\n        if (sig != 0 && !TerminateProcess(proc, sig)) {\n            errno = ESRCH;\n            return -1;\n        }\n        CloseHandle(proc);\n    }\n    }\n    return 0;\n#else\n    return kill(pid, sig);\n#endif\n}"
  },
  {
    "function_name": "virProcessWait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "296-302",
    "snippet": "int\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"unable to wait for process %lld\")",
            "(long long) pid"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unable to wait for process %lld\""
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}"
  },
  {
    "function_name": "virProcessAbort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "288-293",
    "snippet": "void\nvirProcessAbort(pid_t pid)\n{\n    /* Not yet ported to mingw.  Any volunteers?  */\n    VIR_DEBUG(\"failed to reap child %lld, abandoning it\", (long long)pid);\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"failed to reap child %lld, abandoning it\"",
            "(long long)pid"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirProcessAbort(pid_t pid)\n{\n    /* Not yet ported to mingw.  Any volunteers?  */\n    VIR_DEBUG(\"failed to reap child %lld, abandoning it\", (long long)pid);\n}"
  },
  {
    "function_name": "virProcessTranslateStatus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "281-285",
    "snippet": "char *\nvirProcessTranslateStatus(int status)\n{\n    return g_strdup_printf(_(\"invalid value %d\"), status);\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "_(\"invalid value %d\")",
            "status"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar *\nvirProcessTranslateStatus(int status)\n{\n    return g_strdup_printf(_(\"invalid value %d\"), status);\n}"
  },
  {
    "function_name": "virProcessWait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "234-277",
    "snippet": "int\nvirProcessWait(pid_t pid, int *exitstatus, bool raw)\n{\n    int ret;\n    int status;\n    g_autofree char *st = NULL;\n\n    if (pid <= 0) {\n        if (pid != -1)\n            virReportSystemError(EINVAL, _(\"unable to wait for process %lld\"),\n                                 (long long) pid);\n        return -1;\n    }\n\n    /* Wait for intermediate process to exit */\n    while ((ret = waitpid(pid, &status, 0)) == -1 &&\n           errno == EINTR);\n\n    if (ret == -1) {\n        virReportSystemError(errno, _(\"unable to wait for process %lld\"),\n                             (long long) pid);\n        return -1;\n    }\n\n    if (exitstatus == NULL) {\n        if (status != 0)\n            goto error;\n    } else if (raw) {\n        *exitstatus = status;\n    } else if (WIFEXITED(status)) {\n        *exitstatus = WEXITSTATUS(status);\n    } else {\n        goto error;\n    }\n\n    return 0;\n\n error:\n    st = virProcessTranslateStatus(status);\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"Child process (%lld) unexpected %s\"),\n                   (long long) pid, NULLSTR(st));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Child process (%lld) unexpected %s\")",
            "(long long) pid",
            "NULLSTR(st)"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "st"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Child process (%lld) unexpected %s\""
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessTranslateStatus",
          "args": [
            "status"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessTranslateStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "281-285",
          "snippet": "char *\nvirProcessTranslateStatus(int status)\n{\n    return g_strdup_printf(_(\"invalid value %d\"), status);\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar *\nvirProcessTranslateStatus(int status)\n{\n    return g_strdup_printf(_(\"invalid value %d\"), status);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WEXITSTATUS",
          "args": [
            "status"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WIFEXITED",
          "args": [
            "status"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"unable to wait for process %lld\")",
            "(long long) pid"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "waitpid",
          "args": [
            "pid",
            "&status",
            "0"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"unable to wait for process %lld\")",
            "(long long) pid"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessWait(pid_t pid, int *exitstatus, bool raw)\n{\n    int ret;\n    int status;\n    g_autofree char *st = NULL;\n\n    if (pid <= 0) {\n        if (pid != -1)\n            virReportSystemError(EINVAL, _(\"unable to wait for process %lld\"),\n                                 (long long) pid);\n        return -1;\n    }\n\n    /* Wait for intermediate process to exit */\n    while ((ret = waitpid(pid, &status, 0)) == -1 &&\n           errno == EINTR);\n\n    if (ret == -1) {\n        virReportSystemError(errno, _(\"unable to wait for process %lld\"),\n                             (long long) pid);\n        return -1;\n    }\n\n    if (exitstatus == NULL) {\n        if (status != 0)\n            goto error;\n    } else if (raw) {\n        *exitstatus = status;\n    } else if (WIFEXITED(status)) {\n        *exitstatus = WEXITSTATUS(status);\n    } else {\n        goto error;\n    }\n\n    return 0;\n\n error:\n    st = virProcessTranslateStatus(status);\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"Child process (%lld) unexpected %s\"),\n                   (long long) pid, NULLSTR(st));\n    return -1;\n}"
  },
  {
    "function_name": "virProcessAbort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "162-210",
    "snippet": "void\nvirProcessAbort(pid_t pid)\n{\n    int saved_errno;\n    int ret;\n    int status;\n    g_autofree char *tmp = NULL;\n\n    if (pid <= 0)\n        return;\n\n    /* See if intermediate process has exited; if not, try a nice\n     * SIGTERM followed by a more severe SIGKILL.\n     */\n    saved_errno = errno;\n    VIR_DEBUG(\"aborting child process %d\", pid);\n    while ((ret = waitpid(pid, &status, WNOHANG)) == -1 &&\n           errno == EINTR);\n    if (ret == pid) {\n        tmp = virProcessTranslateStatus(status);\n        VIR_DEBUG(\"process has ended: %s\", tmp);\n        goto cleanup;\n    } else if (ret == 0) {\n        VIR_DEBUG(\"trying SIGTERM to child process %d\", pid);\n        kill(pid, SIGTERM);\n        g_usleep(10 * 1000);\n        while ((ret = waitpid(pid, &status, WNOHANG)) == -1 &&\n               errno == EINTR);\n        if (ret == pid) {\n            tmp = virProcessTranslateStatus(status);\n            VIR_DEBUG(\"process has ended: %s\", tmp);\n            goto cleanup;\n        } else if (ret == 0) {\n            VIR_DEBUG(\"trying SIGKILL to child process %d\", pid);\n            kill(pid, SIGKILL);\n            while ((ret = waitpid(pid, &status, 0)) == -1 &&\n                   errno == EINTR);\n            if (ret == pid) {\n                tmp = virProcessTranslateStatus(status);\n                VIR_DEBUG(\"process has ended: %s\", tmp);\n                goto cleanup;\n            }\n        }\n    }\n    VIR_DEBUG(\"failed to reap child %lld, abandoning it\", (long long) pid);\n\n cleanup:\n    errno = saved_errno;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"failed to reap child %lld, abandoning it\"",
            "(long long) pid"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"process has ended: %s\"",
            "tmp"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virProcessTranslateStatus",
          "args": [
            "status"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessTranslateStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "281-285",
          "snippet": "char *\nvirProcessTranslateStatus(int status)\n{\n    return g_strdup_printf(_(\"invalid value %d\"), status);\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar *\nvirProcessTranslateStatus(int status)\n{\n    return g_strdup_printf(_(\"invalid value %d\"), status);\n}"
        }
      },
      {
        "call_info": {
          "callee": "waitpid",
          "args": [
            "pid",
            "&status",
            "0"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "pid",
            "SIGKILL"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"trying SIGKILL to child process %d\"",
            "pid"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"process has ended: %s\"",
            "tmp"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "waitpid",
          "args": [
            "pid",
            "&status",
            "WNOHANG"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_usleep",
          "args": [
            "10 * 1000"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "pid",
            "SIGTERM"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"trying SIGTERM to child process %d\"",
            "pid"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"process has ended: %s\"",
            "tmp"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "waitpid",
          "args": [
            "pid",
            "&status",
            "WNOHANG"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"aborting child process %d\"",
            "pid"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirProcessAbort(pid_t pid)\n{\n    int saved_errno;\n    int ret;\n    int status;\n    g_autofree char *tmp = NULL;\n\n    if (pid <= 0)\n        return;\n\n    /* See if intermediate process has exited; if not, try a nice\n     * SIGTERM followed by a more severe SIGKILL.\n     */\n    saved_errno = errno;\n    VIR_DEBUG(\"aborting child process %d\", pid);\n    while ((ret = waitpid(pid, &status, WNOHANG)) == -1 &&\n           errno == EINTR);\n    if (ret == pid) {\n        tmp = virProcessTranslateStatus(status);\n        VIR_DEBUG(\"process has ended: %s\", tmp);\n        goto cleanup;\n    } else if (ret == 0) {\n        VIR_DEBUG(\"trying SIGTERM to child process %d\", pid);\n        kill(pid, SIGTERM);\n        g_usleep(10 * 1000);\n        while ((ret = waitpid(pid, &status, WNOHANG)) == -1 &&\n               errno == EINTR);\n        if (ret == pid) {\n            tmp = virProcessTranslateStatus(status);\n            VIR_DEBUG(\"process has ended: %s\", tmp);\n            goto cleanup;\n        } else if (ret == 0) {\n            VIR_DEBUG(\"trying SIGKILL to child process %d\", pid);\n            kill(pid, SIGKILL);\n            while ((ret = waitpid(pid, &status, 0)) == -1 &&\n                   errno == EINTR);\n            if (ret == pid) {\n                tmp = virProcessTranslateStatus(status);\n                VIR_DEBUG(\"process has ended: %s\", tmp);\n                goto cleanup;\n            }\n        }\n    }\n    VIR_DEBUG(\"failed to reap child %lld, abandoning it\", (long long) pid);\n\n cleanup:\n    errno = saved_errno;\n}"
  },
  {
    "function_name": "virProcessTranslateStatus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "135-149",
    "snippet": "char *\nvirProcessTranslateStatus(int status)\n{\n    char *buf;\n    if (WIFEXITED(status)) {\n        buf = g_strdup_printf(_(\"exit status %d\"),\n                              WEXITSTATUS(status));\n    } else if (WIFSIGNALED(status)) {\n        buf = g_strdup_printf(_(\"fatal signal %d\"),\n                              WTERMSIG(status));\n    } else {\n        buf = g_strdup_printf(_(\"invalid value %d\"), status);\n    }\n    return buf;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "_(\"invalid value %d\")",
            "status"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WTERMSIG",
          "args": [
            "status"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WIFSIGNALED",
          "args": [
            "status"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WEXITSTATUS",
          "args": [
            "status"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WIFEXITED",
          "args": [
            "status"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar *\nvirProcessTranslateStatus(int status)\n{\n    char *buf;\n    if (WIFEXITED(status)) {\n        buf = g_strdup_printf(_(\"exit status %d\"),\n                              WEXITSTATUS(status));\n    } else if (WIFSIGNALED(status)) {\n        buf = g_strdup_printf(_(\"fatal signal %d\"),\n                              WTERMSIG(status));\n    } else {\n        buf = g_strdup_printf(_(\"invalid value %d\"), status);\n    }\n    return buf;\n}"
  },
  {
    "function_name": "setns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "108-113",
    "snippet": "static inline int setns(int fd G_GNUC_UNUSED, int nstype G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Namespaces are not supported on this platform.\")"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Namespaces are not supported on this platform.\""
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic inline int setns(int fd G_GNUC_UNUSED, int nstype G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}"
  },
  {
    "function_name": "setns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
    "lines": "99-102",
    "snippet": "static inline int setns(int fd, int nstype)\n{\n    return syscall(__NR_setns, fd, nstype);\n}",
    "includes": [
      "#   include <sys/syscall.h>",
      "#include \"vircommand.h\"",
      "#include \"virstring.h\"",
      "#include \"virutil.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "# include <windows.h>",
      "# include <sys/cpuset.h>",
      "# include <sys/user.h>",
      "# include <sys/sysctl.h>",
      "# include <sys/param.h>",
      "# include <sched.h>",
      "# include <sys/resource.h>",
      "# include <sys/time.h>",
      "# include <sys/mount.h>",
      "#include <unistd.h>",
      "# include <sys/wait.h>",
      "#include <signal.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "__NR_setns",
            "fd",
            "nstype"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic inline int setns(int fd, int nstype)\n{\n    return syscall(__NR_setns, fd, nstype);\n}"
  }
]