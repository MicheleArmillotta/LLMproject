[
  {
    "function_name": "virAuthConfigLookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virauthconfig.c",
    "lines": "99-148",
    "snippet": "int virAuthConfigLookup(virAuthConfigPtr auth,\n                        const char *service,\n                        const char *hostname,\n                        const char *credname,\n                        const char **value)\n{\n    g_autofree char *authgroup = NULL;\n    g_autofree char *credgroup = NULL;\n    const char *authcred;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Lookup '%s' '%s' '%s'\", service, NULLSTR(hostname), credname);\n\n    if (!hostname)\n        hostname = \"localhost\";\n\n    authgroup = g_strdup_printf(\"auth-%s-%s\", service, hostname);\n\n    if (!virKeyFileHasGroup(auth->keyfile, authgroup)) {\n       VIR_FREE(authgroup);\n       authgroup = g_strdup_printf(\"auth-%s-%s\", service, \"default\");\n    }\n\n    if (!virKeyFileHasGroup(auth->keyfile, authgroup))\n        return 0;\n\n    if (!(authcred = virKeyFileGetValueString(auth->keyfile, authgroup, \"credentials\"))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"Missing item 'credentials' in group '%s' in '%s'\"),\n                       authgroup, auth->path);\n        return -1;\n    }\n\n    credgroup = g_strdup_printf(\"credentials-%s\", authcred);\n\n    if (!virKeyFileHasGroup(auth->keyfile, credgroup)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"Missing group 'credentials-%s' referenced from group '%s' in '%s'\"),\n                       authcred, authgroup, auth->path);\n        return -1;\n    }\n\n    if (!virKeyFileHasValue(auth->keyfile, credgroup, credname))\n        return 0;\n\n    *value = virKeyFileGetValueString(auth->keyfile, credgroup, credname);\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virauthconfig.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virKeyFileGetValueString",
          "args": [
            "auth->keyfile",
            "credgroup",
            "credname"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "347-354",
          "snippet": "const char *virKeyFileGetValueString(virKeyFilePtr conf,\n                                     const char *groupname,\n                                     const char *valuename)\n{\n    virHashTablePtr group = virHashLookup(conf->groups, groupname);\n    VIR_DEBUG(\"conf=%p groupname=%s valuename=%s\", conf, groupname, valuename);\n    return virHashLookup(group, valuename);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nconst char *virKeyFileGetValueString(virKeyFilePtr conf,\n                                     const char *groupname,\n                                     const char *valuename)\n{\n    virHashTablePtr group = virHashLookup(conf->groups, groupname);\n    VIR_DEBUG(\"conf=%p groupname=%s valuename=%s\", conf, groupname, valuename);\n    return virHashLookup(group, valuename);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeyFileHasValue",
          "args": [
            "auth->keyfile",
            "credgroup",
            "credname"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileHasValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "338-345",
          "snippet": "bool virKeyFileHasValue(virKeyFilePtr conf,\n                        const char *groupname,\n                        const char *valuename)\n{\n    virHashTablePtr group = virHashLookup(conf->groups, groupname);\n    VIR_DEBUG(\"conf=%p groupname=%s valuename=%s\", conf, groupname, valuename);\n    return group && virHashLookup(group, valuename) != NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nbool virKeyFileHasValue(virKeyFilePtr conf,\n                        const char *groupname,\n                        const char *valuename)\n{\n    virHashTablePtr group = virHashLookup(conf->groups, groupname);\n    VIR_DEBUG(\"conf=%p groupname=%s valuename=%s\", conf, groupname, valuename);\n    return group && virHashLookup(group, valuename) != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"Missing group 'credentials-%s' referenced from group '%s' in '%s'\")",
            "authcred",
            "authgroup",
            "auth->path"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Missing group 'credentials-%s' referenced from group '%s' in '%s'\""
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeyFileHasGroup",
          "args": [
            "auth->keyfile",
            "credgroup"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileHasGroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "330-335",
          "snippet": "bool virKeyFileHasGroup(virKeyFilePtr conf,\n                        const char *groupname)\n{\n    VIR_DEBUG(\"conf=%p groupname=%s\", conf, groupname);\n    return virHashLookup(conf->groups, groupname) != NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nbool virKeyFileHasGroup(virKeyFilePtr conf,\n                        const char *groupname)\n{\n    VIR_DEBUG(\"conf=%p groupname=%s\", conf, groupname);\n    return virHashLookup(conf->groups, groupname) != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"Missing item 'credentials' in group '%s' in '%s'\")",
            "authgroup",
            "auth->path"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "authgroup"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Lookup '%s' '%s' '%s'\"",
            "service",
            "NULLSTR(hostname)",
            "credname"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "hostname"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virkeyfile.h\"\n#include \"virauthconfig.h\"\n#include <config.h>\n\nint virAuthConfigLookup(virAuthConfigPtr auth,\n                        const char *service,\n                        const char *hostname,\n                        const char *credname,\n                        const char **value)\n{\n    g_autofree char *authgroup = NULL;\n    g_autofree char *credgroup = NULL;\n    const char *authcred;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Lookup '%s' '%s' '%s'\", service, NULLSTR(hostname), credname);\n\n    if (!hostname)\n        hostname = \"localhost\";\n\n    authgroup = g_strdup_printf(\"auth-%s-%s\", service, hostname);\n\n    if (!virKeyFileHasGroup(auth->keyfile, authgroup)) {\n       VIR_FREE(authgroup);\n       authgroup = g_strdup_printf(\"auth-%s-%s\", service, \"default\");\n    }\n\n    if (!virKeyFileHasGroup(auth->keyfile, authgroup))\n        return 0;\n\n    if (!(authcred = virKeyFileGetValueString(auth->keyfile, authgroup, \"credentials\"))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"Missing item 'credentials' in group '%s' in '%s'\"),\n                       authgroup, auth->path);\n        return -1;\n    }\n\n    credgroup = g_strdup_printf(\"credentials-%s\", authcred);\n\n    if (!virKeyFileHasGroup(auth->keyfile, credgroup)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"Missing group 'credentials-%s' referenced from group '%s' in '%s'\"),\n                       authcred, authgroup, auth->path);\n        return -1;\n    }\n\n    if (!virKeyFileHasValue(auth->keyfile, credgroup, credname))\n        return 0;\n\n    *value = virKeyFileGetValueString(auth->keyfile, credgroup, credname);\n\n    return 0;\n}"
  },
  {
    "function_name": "virAuthConfigFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virauthconfig.c",
    "lines": "88-96",
    "snippet": "void virAuthConfigFree(virAuthConfigPtr auth)\n{\n    if (!auth)\n        return;\n\n    virKeyFileFree(auth->keyfile);\n    VIR_FREE(auth->path);\n    VIR_FREE(auth);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virauthconfig.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "auth"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "auth->path"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKeyFileFree",
          "args": [
            "auth->keyfile"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "320-327",
          "snippet": "void virKeyFileFree(virKeyFilePtr conf)\n{\n    if (!conf)\n        return;\n\n    virHashFree(conf->groups);\n    VIR_FREE(conf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvoid virKeyFileFree(virKeyFilePtr conf)\n{\n    if (!conf)\n        return;\n\n    virHashFree(conf->groups);\n    VIR_FREE(conf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virkeyfile.h\"\n#include \"virauthconfig.h\"\n#include <config.h>\n\nvoid virAuthConfigFree(virAuthConfigPtr auth)\n{\n    if (!auth)\n        return;\n\n    virKeyFileFree(auth->keyfile);\n    VIR_FREE(auth->path);\n    VIR_FREE(auth);\n}"
  },
  {
    "function_name": "virAuthConfigNewData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virauthconfig.c",
    "lines": "63-85",
    "snippet": "virAuthConfigPtr virAuthConfigNewData(const char *path,\n                                      const char *data,\n                                      size_t len)\n{\n    virAuthConfigPtr auth;\n\n    if (VIR_ALLOC(auth) < 0)\n        goto error;\n\n    auth->path = g_strdup(path);\n\n    if (!(auth->keyfile = virKeyFileNew()))\n        goto error;\n\n    if (virKeyFileLoadData(auth->keyfile, path, data, len) < 0)\n        goto error;\n\n    return auth;\n\n error:\n    virAuthConfigFree(auth);\n    return NULL;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virauthconfig.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAuthConfigFree",
          "args": [
            "auth"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "virAuthConfigFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virauthconfig.c",
          "lines": "88-96",
          "snippet": "void virAuthConfigFree(virAuthConfigPtr auth)\n{\n    if (!auth)\n        return;\n\n    virKeyFileFree(auth->keyfile);\n    VIR_FREE(auth->path);\n    VIR_FREE(auth);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virauthconfig.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virkeyfile.h\"\n#include \"virauthconfig.h\"\n#include <config.h>\n\nvoid virAuthConfigFree(virAuthConfigPtr auth)\n{\n    if (!auth)\n        return;\n\n    virKeyFileFree(auth->keyfile);\n    VIR_FREE(auth->path);\n    VIR_FREE(auth);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeyFileLoadData",
          "args": [
            "auth->keyfile",
            "path",
            "data",
            "len"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileLoadData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "311-317",
          "snippet": "int virKeyFileLoadData(virKeyFilePtr conf,\n                       const char *path,\n                       const char *data,\n                       size_t len)\n{\n    return virKeyFileParse(conf, path, data, len);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint virKeyFileLoadData(virKeyFilePtr conf,\n                       const char *path,\n                       const char *data,\n                       size_t len)\n{\n    return virKeyFileParse(conf, path, data, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeyFileNew",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "272-288",
          "snippet": "virKeyFilePtr virKeyFileNew(void)\n{\n    virKeyFilePtr conf;\n\n    if (VIR_ALLOC(conf) < 0)\n        goto error;\n\n    if (!(conf->groups = virHashCreate(10,\n                                       virKeyFileEntryFree)))\n        goto error;\n\n    return conf;\n\n error:\n    virKeyFileFree(conf);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirKeyFilePtr virKeyFileNew(void)\n{\n    virKeyFilePtr conf;\n\n    if (VIR_ALLOC(conf) < 0)\n        goto error;\n\n    if (!(conf->groups = virHashCreate(10,\n                                       virKeyFileEntryFree)))\n        goto error;\n\n    return conf;\n\n error:\n    virKeyFileFree(conf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "path"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "auth"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virkeyfile.h\"\n#include \"virauthconfig.h\"\n#include <config.h>\n\nvirAuthConfigPtr virAuthConfigNewData(const char *path,\n                                      const char *data,\n                                      size_t len)\n{\n    virAuthConfigPtr auth;\n\n    if (VIR_ALLOC(auth) < 0)\n        goto error;\n\n    auth->path = g_strdup(path);\n\n    if (!(auth->keyfile = virKeyFileNew()))\n        goto error;\n\n    if (virKeyFileLoadData(auth->keyfile, path, data, len) < 0)\n        goto error;\n\n    return auth;\n\n error:\n    virAuthConfigFree(auth);\n    return NULL;\n}"
  },
  {
    "function_name": "virAuthConfigNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virauthconfig.c",
    "lines": "40-60",
    "snippet": "virAuthConfigPtr virAuthConfigNew(const char *path)\n{\n    virAuthConfigPtr auth;\n\n    if (VIR_ALLOC(auth) < 0)\n        goto error;\n\n    auth->path = g_strdup(path);\n\n    if (!(auth->keyfile = virKeyFileNew()))\n        goto error;\n\n    if (virKeyFileLoadFile(auth->keyfile, path) < 0)\n        goto error;\n\n    return auth;\n\n error:\n    virAuthConfigFree(auth);\n    return NULL;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virkeyfile.h\"",
      "#include \"virauthconfig.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAuthConfigFree",
          "args": [
            "auth"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virAuthConfigFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virauthconfig.c",
          "lines": "88-96",
          "snippet": "void virAuthConfigFree(virAuthConfigPtr auth)\n{\n    if (!auth)\n        return;\n\n    virKeyFileFree(auth->keyfile);\n    VIR_FREE(auth->path);\n    VIR_FREE(auth);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virauthconfig.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virkeyfile.h\"\n#include \"virauthconfig.h\"\n#include <config.h>\n\nvoid virAuthConfigFree(virAuthConfigPtr auth)\n{\n    if (!auth)\n        return;\n\n    virKeyFileFree(auth->keyfile);\n    VIR_FREE(auth->path);\n    VIR_FREE(auth);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeyFileLoadFile",
          "args": [
            "auth->keyfile",
            "path"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileLoadFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "293-308",
          "snippet": "int virKeyFileLoadFile(virKeyFilePtr conf,\n                       const char *filename)\n{\n    char *data = NULL;\n    ssize_t len;\n    int ret;\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &data)) < 0)\n        return -1;\n\n    ret = virKeyFileParse(conf, filename, data, len);\n\n    VIR_FREE(data);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_CONFIG_FILE_SIZE (1024 * 1024)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\n#define MAX_CONFIG_FILE_SIZE (1024 * 1024)\n\nint virKeyFileLoadFile(virKeyFilePtr conf,\n                       const char *filename)\n{\n    char *data = NULL;\n    ssize_t len;\n    int ret;\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &data)) < 0)\n        return -1;\n\n    ret = virKeyFileParse(conf, filename, data, len);\n\n    VIR_FREE(data);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKeyFileNew",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "virKeyFileNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkeyfile.c",
          "lines": "272-288",
          "snippet": "virKeyFilePtr virKeyFileNew(void)\n{\n    virKeyFilePtr conf;\n\n    if (VIR_ALLOC(conf) < 0)\n        goto error;\n\n    if (!(conf->groups = virHashCreate(10,\n                                       virKeyFileEntryFree)))\n        goto error;\n\n    return conf;\n\n error:\n    virKeyFileFree(conf);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virkeyfile.h\"",
            "#include \"virhash.h\"",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virkeyfile.h\"\n#include \"virhash.h\"\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirKeyFilePtr virKeyFileNew(void)\n{\n    virKeyFilePtr conf;\n\n    if (VIR_ALLOC(conf) < 0)\n        goto error;\n\n    if (!(conf->groups = virHashCreate(10,\n                                       virKeyFileEntryFree)))\n        goto error;\n\n    return conf;\n\n error:\n    virKeyFileFree(conf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "path"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "auth"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virkeyfile.h\"\n#include \"virauthconfig.h\"\n#include <config.h>\n\nvirAuthConfigPtr virAuthConfigNew(const char *path)\n{\n    virAuthConfigPtr auth;\n\n    if (VIR_ALLOC(auth) < 0)\n        goto error;\n\n    auth->path = g_strdup(path);\n\n    if (!(auth->keyfile = virKeyFileNew()))\n        goto error;\n\n    if (virKeyFileLoadFile(auth->keyfile, path) < 0)\n        goto error;\n\n    return auth;\n\n error:\n    virAuthConfigFree(auth);\n    return NULL;\n}"
  }
]