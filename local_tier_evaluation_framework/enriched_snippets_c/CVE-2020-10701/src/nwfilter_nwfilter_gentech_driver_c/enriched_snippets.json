[
  {
    "function_name": "virNWFilterBuildAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "1006-1048",
    "snippet": "int\nvirNWFilterBuildAll(virNWFilterDriverStatePtr driver,\n                    bool newFilters)\n{\n    struct virNWFilterBuildData data = {\n        .driver = driver,\n    };\n    int ret = 0;\n\n    VIR_DEBUG(\"Build all filters newFilters=%d\", newFilters);\n\n    if (newFilters) {\n        if (!(data.skipInterfaces = virHashCreate(0, NULL)))\n            return -1;\n\n        data.step = STEP_APPLY_NEW;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n\n        if (ret == -1) {\n            data.step = STEP_ROLLBACK;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        } else  {\n            data.step = STEP_SWITCH;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        }\n\n        virHashFree(data.skipInterfaces);\n    } else {\n        data.step = STEP_APPLY_CURRENT;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListForEach",
          "args": [
            "driver->bindings",
            "virNWFilterBuildIter",
            "&data"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "359-371",
          "snippet": "int\nvirNWFilterBindingObjListForEach(virNWFilterBindingObjListPtr bindings,\n                                 virNWFilterBindingObjListIterator callback,\n                                 void *opaque)\n{\n    struct virNWFilterBindingListIterData data = {\n        callback, opaque, 0,\n    };\n    virObjectRWLockRead(bindings);\n    virHashForEach(bindings->objs, virNWFilterBindingObjListHelper, &data);\n    virObjectRWUnlock(bindings);\n    return data.ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingObjListForEach(virNWFilterBindingObjListPtr bindings,\n                                 virNWFilterBindingObjListIterator callback,\n                                 void *opaque)\n{\n    struct virNWFilterBindingListIterData data = {\n        callback, opaque, 0,\n    };\n    virObjectRWLockRead(bindings);\n    virHashForEach(bindings->objs, virNWFilterBindingObjListHelper, &data);\n    virObjectRWUnlock(bindings);\n    return data.ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "data.skipInterfaces"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "0",
            "NULL"
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Build all filters newFilters=%d\"",
            "newFilters"
          ],
          "line": 1015
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBuildAll(virNWFilterDriverStatePtr driver,\n                    bool newFilters)\n{\n    struct virNWFilterBuildData data = {\n        .driver = driver,\n    };\n    int ret = 0;\n\n    VIR_DEBUG(\"Build all filters newFilters=%d\", newFilters);\n\n    if (newFilters) {\n        if (!(data.skipInterfaces = virHashCreate(0, NULL)))\n            return -1;\n\n        data.step = STEP_APPLY_NEW;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n\n        if (ret == -1) {\n            data.step = STEP_ROLLBACK;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        } else  {\n            data.step = STEP_SWITCH;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        }\n\n        virHashFree(data.skipInterfaces);\n    } else {\n        data.step = STEP_APPLY_CURRENT;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterBuildIter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "996-1004",
    "snippet": "static int\nvirNWFilterBuildIter(virNWFilterBindingObjPtr binding, void *opaque)\n{\n    struct virNWFilterBuildData *data = opaque;\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n\n    return virNWFilterBuildOne(data->driver, def,\n                               data->skipInterfaces, data->step);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBuildOne",
          "args": [
            "data->driver",
            "def",
            "data->skipInterfaces",
            "data->step"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBuildOne",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "947-987",
          "snippet": "static int\nvirNWFilterBuildOne(virNWFilterDriverStatePtr driver,\n                    virNWFilterBindingDefPtr binding,\n                    virHashTablePtr skipInterfaces,\n                    int step)\n{\n    bool skipIface;\n    int ret = 0;\n    VIR_DEBUG(\"Building filter for portdev=%s step=%d\", binding->portdevname, step);\n\n    switch (step) {\n    case STEP_APPLY_NEW:\n        ret = virNWFilterUpdateInstantiateFilter(driver,\n                                                 binding,\n                                                 &skipIface);\n        if (ret == 0 && skipIface) {\n            /* filter tree unchanged -- no update needed */\n            ret = virHashAddEntry(skipInterfaces,\n                                  binding->portdevname,\n                                  (void *)~0);\n        }\n        break;\n\n    case STEP_ROLLBACK:\n        if (!virHashLookup(skipInterfaces, binding->portdevname))\n            ret = virNWFilterRollbackUpdateFilter(binding);\n        break;\n\n    case STEP_SWITCH:\n        if (!virHashLookup(skipInterfaces, binding->portdevname))\n            ret = virNWFilterTearOldFilter(binding);\n        break;\n\n    case STEP_APPLY_CURRENT:\n        ret = virNWFilterInstantiateFilter(driver,\n                                           binding);\n        break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBuildOne(virNWFilterDriverStatePtr driver,\n                    virNWFilterBindingDefPtr binding,\n                    virHashTablePtr skipInterfaces,\n                    int step)\n{\n    bool skipIface;\n    int ret = 0;\n    VIR_DEBUG(\"Building filter for portdev=%s step=%d\", binding->portdevname, step);\n\n    switch (step) {\n    case STEP_APPLY_NEW:\n        ret = virNWFilterUpdateInstantiateFilter(driver,\n                                                 binding,\n                                                 &skipIface);\n        if (ret == 0 && skipIface) {\n            /* filter tree unchanged -- no update needed */\n            ret = virHashAddEntry(skipInterfaces,\n                                  binding->portdevname,\n                                  (void *)~0);\n        }\n        break;\n\n    case STEP_ROLLBACK:\n        if (!virHashLookup(skipInterfaces, binding->portdevname))\n            ret = virNWFilterRollbackUpdateFilter(binding);\n        break;\n\n    case STEP_SWITCH:\n        if (!virHashLookup(skipInterfaces, binding->portdevname))\n            ret = virNWFilterTearOldFilter(binding);\n        break;\n\n    case STEP_APPLY_CURRENT:\n        ret = virNWFilterInstantiateFilter(driver,\n                                           binding);\n        break;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "binding"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBuildIter(virNWFilterBindingObjPtr binding, void *opaque)\n{\n    struct virNWFilterBuildData *data = opaque;\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n\n    return virNWFilterBuildOne(data->driver, def,\n                               data->skipInterfaces, data->step);\n}"
  },
  {
    "function_name": "virNWFilterBuildOne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "947-987",
    "snippet": "static int\nvirNWFilterBuildOne(virNWFilterDriverStatePtr driver,\n                    virNWFilterBindingDefPtr binding,\n                    virHashTablePtr skipInterfaces,\n                    int step)\n{\n    bool skipIface;\n    int ret = 0;\n    VIR_DEBUG(\"Building filter for portdev=%s step=%d\", binding->portdevname, step);\n\n    switch (step) {\n    case STEP_APPLY_NEW:\n        ret = virNWFilterUpdateInstantiateFilter(driver,\n                                                 binding,\n                                                 &skipIface);\n        if (ret == 0 && skipIface) {\n            /* filter tree unchanged -- no update needed */\n            ret = virHashAddEntry(skipInterfaces,\n                                  binding->portdevname,\n                                  (void *)~0);\n        }\n        break;\n\n    case STEP_ROLLBACK:\n        if (!virHashLookup(skipInterfaces, binding->portdevname))\n            ret = virNWFilterRollbackUpdateFilter(binding);\n        break;\n\n    case STEP_SWITCH:\n        if (!virHashLookup(skipInterfaces, binding->portdevname))\n            ret = virNWFilterTearOldFilter(binding);\n        break;\n\n    case STEP_APPLY_CURRENT:\n        ret = virNWFilterInstantiateFilter(driver,\n                                           binding);\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterInstantiateFilter",
          "args": [
            "driver",
            "binding"
          ],
          "line": 981
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstantiateFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "817-827",
          "snippet": "int\nvirNWFilterInstantiateFilter(virNWFilterDriverStatePtr driver,\n                             virNWFilterBindingDefPtr binding)\n{\n    bool foundNewFilter = false;\n\n    return virNWFilterInstantiateFilterInternal(driver, binding,\n                                                1,\n                                                INSTANTIATE_ALWAYS,\n                                                &foundNewFilter);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterInstantiateFilter(virNWFilterDriverStatePtr driver,\n                             virNWFilterBindingDefPtr binding)\n{\n    bool foundNewFilter = false;\n\n    return virNWFilterInstantiateFilterInternal(driver, binding,\n                                                1,\n                                                INSTANTIATE_ALWAYS,\n                                                &foundNewFilter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTearOldFilter",
          "args": [
            "binding"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTearOldFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "872-895",
          "snippet": "static int\nvirNWFilterTearOldFilter(virNWFilterBindingDefPtr binding)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    int ifindex;\n    virNWFilterTechDriverPtr techdriver;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    /* don't tear anything while the address is being learned */\n    if (virNetDevGetIndex(binding->portdevname, &ifindex) < 0)\n        virResetLastError();\n    else if (virNWFilterHasLearnReq(ifindex))\n        return 0;\n\n    return techdriver->tearOldRules(binding->portdevname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterTearOldFilter(virNWFilterBindingDefPtr binding)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    int ifindex;\n    virNWFilterTechDriverPtr techdriver;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    /* don't tear anything while the address is being learned */\n    if (virNetDevGetIndex(binding->portdevname, &ifindex) < 0)\n        virResetLastError();\n    else if (virNWFilterHasLearnReq(ifindex))\n        return 0;\n\n    return techdriver->tearOldRules(binding->portdevname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "skipInterfaces",
            "binding->portdevname"
          ],
          "line": 976
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterRollbackUpdateFilter",
          "args": [
            "binding"
          ],
          "line": 972
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterRollbackUpdateFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "846-869",
          "snippet": "static int\nvirNWFilterRollbackUpdateFilter(virNWFilterBindingDefPtr binding)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    int ifindex;\n    virNWFilterTechDriverPtr techdriver;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    /* don't tear anything while the address is being learned */\n    if (virNetDevGetIndex(binding->portdevname, &ifindex) < 0)\n        virResetLastError();\n    else if (virNWFilterHasLearnReq(ifindex))\n        return 0;\n\n    return techdriver->tearNewRules(binding->portdevname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterRollbackUpdateFilter(virNWFilterBindingDefPtr binding)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    int ifindex;\n    virNWFilterTechDriverPtr techdriver;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    /* don't tear anything while the address is being learned */\n    if (virNetDevGetIndex(binding->portdevname, &ifindex) < 0)\n        virResetLastError();\n    else if (virNWFilterHasLearnReq(ifindex))\n        return 0;\n\n    return techdriver->tearNewRules(binding->portdevname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "skipInterfaces",
            "binding->portdevname",
            "(void *)~0"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterUpdateInstantiateFilter",
          "args": [
            "driver",
            "binding",
            "&skipIface"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUpdateInstantiateFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "830-844",
          "snippet": "int\nvirNWFilterUpdateInstantiateFilter(virNWFilterDriverStatePtr driver,\n                                   virNWFilterBindingDefPtr binding,\n                                   bool *skipIface)\n{\n    bool foundNewFilter = false;\n\n    int rc = virNWFilterInstantiateFilterInternal(driver, binding,\n                                                  0,\n                                                  INSTANTIATE_FOLLOW_NEWFILTER,\n                                                  &foundNewFilter);\n\n    *skipIface = !foundNewFilter;\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterUpdateInstantiateFilter(virNWFilterDriverStatePtr driver,\n                                   virNWFilterBindingDefPtr binding,\n                                   bool *skipIface)\n{\n    bool foundNewFilter = false;\n\n    int rc = virNWFilterInstantiateFilterInternal(driver, binding,\n                                                  0,\n                                                  INSTANTIATE_FOLLOW_NEWFILTER,\n                                                  &foundNewFilter);\n\n    *skipIface = !foundNewFilter;\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Building filter for portdev=%s step=%d\"",
            "binding->portdevname",
            "step"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBuildOne(virNWFilterDriverStatePtr driver,\n                    virNWFilterBindingDefPtr binding,\n                    virHashTablePtr skipInterfaces,\n                    int step)\n{\n    bool skipIface;\n    int ret = 0;\n    VIR_DEBUG(\"Building filter for portdev=%s step=%d\", binding->portdevname, step);\n\n    switch (step) {\n    case STEP_APPLY_NEW:\n        ret = virNWFilterUpdateInstantiateFilter(driver,\n                                                 binding,\n                                                 &skipIface);\n        if (ret == 0 && skipIface) {\n            /* filter tree unchanged -- no update needed */\n            ret = virHashAddEntry(skipInterfaces,\n                                  binding->portdevname,\n                                  (void *)~0);\n        }\n        break;\n\n    case STEP_ROLLBACK:\n        if (!virHashLookup(skipInterfaces, binding->portdevname))\n            ret = virNWFilterRollbackUpdateFilter(binding);\n        break;\n\n    case STEP_SWITCH:\n        if (!virHashLookup(skipInterfaces, binding->portdevname))\n            ret = virNWFilterTearOldFilter(binding);\n        break;\n\n    case STEP_APPLY_CURRENT:\n        ret = virNWFilterInstantiateFilter(driver,\n                                           binding);\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterTeardownFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "930-938",
    "snippet": "int\nvirNWFilterTeardownFilter(virNWFilterBindingDefPtr binding)\n{\n    int ret;\n    virMutexLock(&updateMutex);\n    ret = _virNWFilterTeardownFilter(binding->portdevname);\n    virMutexUnlock(&updateMutex);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virMutex updateMutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&updateMutex"
          ],
          "line": 936
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_virNWFilterTeardownFilter",
          "args": [
            "binding->portdevname"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&updateMutex"
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virMutex updateMutex;\n\nint\nvirNWFilterTeardownFilter(virNWFilterBindingDefPtr binding)\n{\n    int ret;\n    virMutexLock(&updateMutex);\n    ret = _virNWFilterTeardownFilter(binding->portdevname);\n    virMutexUnlock(&updateMutex);\n    return ret;\n}"
  },
  {
    "function_name": "_virNWFilterTeardownFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "898-927",
    "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int _virNWFilterTeardownFilter(const char *ifname);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterUnlockIface",
          "args": [
            "ifname"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUnlockIface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "196-214",
          "snippet": "void\nvirNWFilterUnlockIface(const char *ifname)\n{\n    virNWFilterIfaceLockPtr ifaceLock;\n\n    virMutexLock(&ifaceMapLock);\n\n    ifaceLock = virHashLookup(ifaceLockMap, ifname);\n\n    if (ifaceLock) {\n        virMutexUnlock(&ifaceLock->lock);\n\n        ifaceLock->refctr--;\n        if (ifaceLock->refctr == 0)\n            virHashRemoveEntry(ifaceLockMap, ifname);\n    }\n\n    virMutexUnlock(&ifaceMapLock);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex ifaceMapLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr ifaceLockMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virMutex ifaceMapLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr ifaceLockMap;\n\nvoid\nvirNWFilterUnlockIface(const char *ifname)\n{\n    virNWFilterIfaceLockPtr ifaceLock;\n\n    virMutexLock(&ifaceMapLock);\n\n    ifaceLock = virHashLookup(ifaceLockMap, ifname);\n\n    if (ifaceLock) {\n        virMutexUnlock(&ifaceLock->lock);\n\n        ifaceLock->refctr--;\n        if (ifaceLock->refctr == 0)\n            virHashRemoveEntry(ifaceLockMap, ifname);\n    }\n\n    virMutexUnlock(&ifaceMapLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterIPAddrMapDelIPAddr",
          "args": [
            "ifname",
            "NULL"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterIPAddrMapDelIPAddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_ipaddrmap.c",
          "lines": "99-127",
          "snippet": "int\nvirNWFilterIPAddrMapDelIPAddr(const char *ifname, const char *ipaddr)\n{\n    int ret = -1;\n    virNWFilterVarValuePtr val = NULL;\n\n    virMutexLock(&ipAddressMapLock);\n\n    if (ipaddr != NULL) {\n        val = virHashLookup(ipAddressMap, ifname);\n        if (val) {\n            if (virNWFilterVarValueGetCardinality(val) == 1 &&\n                STREQ(ipaddr,\n                      virNWFilterVarValueGetNthValue(val, 0)))\n                goto remove_entry;\n            virNWFilterVarValueDelValue(val, ipaddr);\n            ret = virNWFilterVarValueGetCardinality(val);\n        }\n    } else {\n remove_entry:\n        /* remove whole entry */\n        virHashRemoveEntry(ipAddressMap, ifname);\n        ret = 0;\n    }\n\n    virMutexUnlock(&ipAddressMapLock);\n\n    return ret;\n}",
          "includes": [
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex ipAddressMapLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr ipAddressMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virMutex ipAddressMapLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr ipAddressMap;\n\nint\nvirNWFilterIPAddrMapDelIPAddr(const char *ifname, const char *ipaddr)\n{\n    int ret = -1;\n    virNWFilterVarValuePtr val = NULL;\n\n    virMutexLock(&ipAddressMapLock);\n\n    if (ipaddr != NULL) {\n        val = virHashLookup(ipAddressMap, ifname);\n        if (val) {\n            if (virNWFilterVarValueGetCardinality(val) == 1 &&\n                STREQ(ipaddr,\n                      virNWFilterVarValueGetNthValue(val, 0)))\n                goto remove_entry;\n            virNWFilterVarValueDelValue(val, ipaddr);\n            ret = virNWFilterVarValueGetCardinality(val);\n        }\n    } else {\n remove_entry:\n        /* remove whole entry */\n        virHashRemoveEntry(ipAddressMap, ifname);\n        ret = 0;\n    }\n\n    virMutexUnlock(&ipAddressMapLock);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "techdriver->allTeardown",
          "args": [
            "ifname"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterLockIface",
          "args": [
            "ifname"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterLockIface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "145-193",
          "snippet": "int\nvirNWFilterLockIface(const char *ifname)\n{\n    virNWFilterIfaceLockPtr ifaceLock;\n\n    virMutexLock(&ifaceMapLock);\n\n    ifaceLock = virHashLookup(ifaceLockMap, ifname);\n    if (!ifaceLock) {\n        if (VIR_ALLOC(ifaceLock) < 0)\n            goto err_exit;\n\n        if (virMutexInitRecursive(&ifaceLock->lock) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"mutex initialization failed\"));\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        if (virStrcpyStatic(ifaceLock->ifname, ifname) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"interface name %s does not fit into \"\n                             \"buffer \"),\n                           ifaceLock->ifname);\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        while (virHashAddEntry(ifaceLockMap, ifname, ifaceLock)) {\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        ifaceLock->refctr = 0;\n    }\n\n    ifaceLock->refctr++;\n\n    virMutexUnlock(&ifaceMapLock);\n\n    virMutexLock(&ifaceLock->lock);\n\n    return 0;\n\n err_exit:\n    virMutexUnlock(&ifaceMapLock);\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex ifaceMapLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr ifaceLockMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virMutex ifaceMapLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr ifaceLockMap;\n\nint\nvirNWFilterLockIface(const char *ifname)\n{\n    virNWFilterIfaceLockPtr ifaceLock;\n\n    virMutexLock(&ifaceMapLock);\n\n    ifaceLock = virHashLookup(ifaceLockMap, ifname);\n    if (!ifaceLock) {\n        if (VIR_ALLOC(ifaceLock) < 0)\n            goto err_exit;\n\n        if (virMutexInitRecursive(&ifaceLock->lock) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"mutex initialization failed\"));\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        if (virStrcpyStatic(ifaceLock->ifname, ifname) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"interface name %s does not fit into \"\n                             \"buffer \"),\n                           ifaceLock->ifname);\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        while (virHashAddEntry(ifaceLockMap, ifname, ifaceLock)) {\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        ifaceLock->refctr = 0;\n    }\n\n    ifaceLock->refctr++;\n\n    virMutexUnlock(&ifaceMapLock);\n\n    virMutexLock(&ifaceLock->lock);\n\n    return 0;\n\n err_exit:\n    virMutexUnlock(&ifaceMapLock);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTerminateLearnReq",
          "args": [
            "ifname"
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTerminateLearnReq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "250-284",
          "snippet": "int\nvirNWFilterTerminateLearnReq(const char *ifname)\n{\n    int rc = -1;\n    int ifindex;\n    virNWFilterIPAddrLearnReqPtr req;\n    g_autofree char *ifindex_str = NULL;\n\n    /* It's possible that it's already been removed as a result of\n     * virNWFilterDeregisterLearnReq during learnIPAddressThread() exit\n     */\n    if (virNetDevExists(ifname) != 1) {\n        virResetLastError();\n        return 0;\n    }\n\n    if (virNetDevGetIndex(ifname, &ifindex) < 0) {\n        virResetLastError();\n        return rc;\n    }\n\n    ifindex_str = g_strdup_printf(\"%d\", ifindex);\n\n    virMutexLock(&pendingLearnReqLock);\n\n    req = virHashLookup(pendingLearnReq, ifindex_str);\n    if (req) {\n        rc = 0;\n        req->terminate = true;\n    }\n\n    virMutexUnlock(&pendingLearnReqLock);\n\n    return rc;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex pendingLearnReqLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr pendingLearnReq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virMutex pendingLearnReqLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr pendingLearnReq;\n\nint\nvirNWFilterTerminateLearnReq(const char *ifname)\n{\n    int rc = -1;\n    int ifindex;\n    virNWFilterIPAddrLearnReqPtr req;\n    g_autofree char *ifindex_str = NULL;\n\n    /* It's possible that it's already been removed as a result of\n     * virNWFilterDeregisterLearnReq during learnIPAddressThread() exit\n     */\n    if (virNetDevExists(ifname) != 1) {\n        virResetLastError();\n        return 0;\n    }\n\n    if (virNetDevGetIndex(ifname, &ifindex) < 0) {\n        virResetLastError();\n        return rc;\n    }\n\n    ifindex_str = g_strdup_printf(\"%d\", ifindex);\n\n    virMutexLock(&pendingLearnReqLock);\n\n    req = virHashLookup(pendingLearnReq, ifindex_str);\n    if (req) {\n        rc = 0;\n        req->terminate = true;\n    }\n\n    virMutexUnlock(&pendingLearnReqLock);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDHCPSnoopEnd",
          "args": [
            "ifname"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDHCPSnoopEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_dhcpsnoop.c",
          "lines": "2168-2172",
          "snippet": "void\nvirNWFilterDHCPSnoopEnd(const char *ifname G_GNUC_UNUSED)\n{\n    return;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <net/if.h>",
            "#include <poll.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"configmake.h\"\n#include \"virthreadpool.h\"\n#include \"virsocketaddr.h\"\n#include \"virfile.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <net/if.h>\n#include <poll.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nvoid\nvirNWFilterDHCPSnoopEnd(const char *ifname G_GNUC_UNUSED)\n{\n    return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not get access to ACL tech \"\n                         \"driver '%s'\")",
            "drvname"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not get access to ACL tech \"\n                         \"driver '%s'\""
          ],
          "line": 907
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTechDriverForName",
          "args": [
            "drvname"
          ],
          "line": 903
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTechDriverForName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "102-115",
          "snippet": "virNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\n\nvirNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterTearOldFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "872-895",
    "snippet": "static int\nvirNWFilterTearOldFilter(virNWFilterBindingDefPtr binding)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    int ifindex;\n    virNWFilterTechDriverPtr techdriver;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    /* don't tear anything while the address is being learned */\n    if (virNetDevGetIndex(binding->portdevname, &ifindex) < 0)\n        virResetLastError();\n    else if (virNWFilterHasLearnReq(ifindex))\n        return 0;\n\n    return techdriver->tearOldRules(binding->portdevname);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "techdriver->tearOldRules",
          "args": [
            "binding->portdevname"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterHasLearnReq",
          "args": [
            "ifindex"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHasLearnReq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "287-300",
          "snippet": "bool\nvirNWFilterHasLearnReq(int ifindex)\n{\n    void *res;\n    g_autofree char *ifindex_str = g_strdup_printf(\"%d\", ifindex);\n\n    virMutexLock(&pendingLearnReqLock);\n\n    res = virHashLookup(pendingLearnReq, ifindex_str);\n\n    virMutexUnlock(&pendingLearnReqLock);\n\n    return res != NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex pendingLearnReqLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr pendingLearnReq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virMutex pendingLearnReqLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr pendingLearnReq;\n\nbool\nvirNWFilterHasLearnReq(int ifindex)\n{\n    void *res;\n    g_autofree char *ifindex_str = g_strdup_printf(\"%d\", ifindex);\n\n    virMutexLock(&pendingLearnReqLock);\n\n    res = virHashLookup(pendingLearnReq, ifindex_str);\n\n    virMutexUnlock(&pendingLearnReqLock);\n\n    return res != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetIndex",
          "args": [
            "binding->portdevname",
            "&ifindex"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "893-899",
          "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not get access to ACL tech \"\n                         \"driver '%s'\")",
            "drvname"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not get access to ACL tech \"\n                         \"driver '%s'\""
          ],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTechDriverForName",
          "args": [
            "drvname"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTechDriverForName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "102-115",
          "snippet": "virNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\n\nvirNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterTearOldFilter(virNWFilterBindingDefPtr binding)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    int ifindex;\n    virNWFilterTechDriverPtr techdriver;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    /* don't tear anything while the address is being learned */\n    if (virNetDevGetIndex(binding->portdevname, &ifindex) < 0)\n        virResetLastError();\n    else if (virNWFilterHasLearnReq(ifindex))\n        return 0;\n\n    return techdriver->tearOldRules(binding->portdevname);\n}"
  },
  {
    "function_name": "virNWFilterRollbackUpdateFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "846-869",
    "snippet": "static int\nvirNWFilterRollbackUpdateFilter(virNWFilterBindingDefPtr binding)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    int ifindex;\n    virNWFilterTechDriverPtr techdriver;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    /* don't tear anything while the address is being learned */\n    if (virNetDevGetIndex(binding->portdevname, &ifindex) < 0)\n        virResetLastError();\n    else if (virNWFilterHasLearnReq(ifindex))\n        return 0;\n\n    return techdriver->tearNewRules(binding->portdevname);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "techdriver->tearNewRules",
          "args": [
            "binding->portdevname"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterHasLearnReq",
          "args": [
            "ifindex"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHasLearnReq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "287-300",
          "snippet": "bool\nvirNWFilterHasLearnReq(int ifindex)\n{\n    void *res;\n    g_autofree char *ifindex_str = g_strdup_printf(\"%d\", ifindex);\n\n    virMutexLock(&pendingLearnReqLock);\n\n    res = virHashLookup(pendingLearnReq, ifindex_str);\n\n    virMutexUnlock(&pendingLearnReqLock);\n\n    return res != NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex pendingLearnReqLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr pendingLearnReq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virMutex pendingLearnReqLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr pendingLearnReq;\n\nbool\nvirNWFilterHasLearnReq(int ifindex)\n{\n    void *res;\n    g_autofree char *ifindex_str = g_strdup_printf(\"%d\", ifindex);\n\n    virMutexLock(&pendingLearnReqLock);\n\n    res = virHashLookup(pendingLearnReq, ifindex_str);\n\n    virMutexUnlock(&pendingLearnReqLock);\n\n    return res != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetIndex",
          "args": [
            "binding->portdevname",
            "&ifindex"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "893-899",
          "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not get access to ACL tech \"\n                         \"driver '%s'\")",
            "drvname"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not get access to ACL tech \"\n                         \"driver '%s'\""
          ],
          "line": 856
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTechDriverForName",
          "args": [
            "drvname"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTechDriverForName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "102-115",
          "snippet": "virNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\n\nvirNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterRollbackUpdateFilter(virNWFilterBindingDefPtr binding)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    int ifindex;\n    virNWFilterTechDriverPtr techdriver;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    /* don't tear anything while the address is being learned */\n    if (virNetDevGetIndex(binding->portdevname, &ifindex) < 0)\n        virResetLastError();\n    else if (virNWFilterHasLearnReq(ifindex))\n        return 0;\n\n    return techdriver->tearNewRules(binding->portdevname);\n}"
  },
  {
    "function_name": "virNWFilterUpdateInstantiateFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "830-844",
    "snippet": "int\nvirNWFilterUpdateInstantiateFilter(virNWFilterDriverStatePtr driver,\n                                   virNWFilterBindingDefPtr binding,\n                                   bool *skipIface)\n{\n    bool foundNewFilter = false;\n\n    int rc = virNWFilterInstantiateFilterInternal(driver, binding,\n                                                  0,\n                                                  INSTANTIATE_FOLLOW_NEWFILTER,\n                                                  &foundNewFilter);\n\n    *skipIface = !foundNewFilter;\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterInstantiateFilterInternal",
          "args": [
            "driver",
            "binding",
            "0",
            "INSTANTIATE_FOLLOW_NEWFILTER",
            "&foundNewFilter"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstantiateFilterInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "748-782",
          "snippet": "static int\nvirNWFilterInstantiateFilterInternal(virNWFilterDriverStatePtr driver,\n                                     virNWFilterBindingDefPtr binding,\n                                     bool teardownOld,\n                                     enum instCase useNewFilter,\n                                     bool *foundNewFilter)\n{\n    int ifindex;\n    int rc;\n\n    virMutexLock(&updateMutex);\n\n    /* after grabbing the filter update lock check for the interface; if\n       it's not there anymore its filters will be or are being removed\n       (while holding the lock) and we don't want to build new ones */\n    if (virNetDevExists(binding->portdevname) != 1 ||\n        virNetDevGetIndex(binding->portdevname, &ifindex) < 0) {\n        /* interfaces / VMs can disappear during filter instantiation;\n           don't mark it as an error */\n        virResetLastError();\n        rc = 0;\n        goto cleanup;\n    }\n\n    rc = virNWFilterInstantiateFilterUpdate(driver, teardownOld,\n                                            binding,\n                                            ifindex,\n                                            useNewFilter,\n                                            false, foundNewFilter);\n\n cleanup:\n    virMutexUnlock(&updateMutex);\n\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex updateMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virMutex updateMutex;\n\nstatic int\nvirNWFilterInstantiateFilterInternal(virNWFilterDriverStatePtr driver,\n                                     virNWFilterBindingDefPtr binding,\n                                     bool teardownOld,\n                                     enum instCase useNewFilter,\n                                     bool *foundNewFilter)\n{\n    int ifindex;\n    int rc;\n\n    virMutexLock(&updateMutex);\n\n    /* after grabbing the filter update lock check for the interface; if\n       it's not there anymore its filters will be or are being removed\n       (while holding the lock) and we don't want to build new ones */\n    if (virNetDevExists(binding->portdevname) != 1 ||\n        virNetDevGetIndex(binding->portdevname, &ifindex) < 0) {\n        /* interfaces / VMs can disappear during filter instantiation;\n           don't mark it as an error */\n        virResetLastError();\n        rc = 0;\n        goto cleanup;\n    }\n\n    rc = virNWFilterInstantiateFilterUpdate(driver, teardownOld,\n                                            binding,\n                                            ifindex,\n                                            useNewFilter,\n                                            false, foundNewFilter);\n\n cleanup:\n    virMutexUnlock(&updateMutex);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterUpdateInstantiateFilter(virNWFilterDriverStatePtr driver,\n                                   virNWFilterBindingDefPtr binding,\n                                   bool *skipIface)\n{\n    bool foundNewFilter = false;\n\n    int rc = virNWFilterInstantiateFilterInternal(driver, binding,\n                                                  0,\n                                                  INSTANTIATE_FOLLOW_NEWFILTER,\n                                                  &foundNewFilter);\n\n    *skipIface = !foundNewFilter;\n    return rc;\n}"
  },
  {
    "function_name": "virNWFilterInstantiateFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "817-827",
    "snippet": "int\nvirNWFilterInstantiateFilter(virNWFilterDriverStatePtr driver,\n                             virNWFilterBindingDefPtr binding)\n{\n    bool foundNewFilter = false;\n\n    return virNWFilterInstantiateFilterInternal(driver, binding,\n                                                1,\n                                                INSTANTIATE_ALWAYS,\n                                                &foundNewFilter);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterInstantiateFilterInternal",
          "args": [
            "driver",
            "binding",
            "1",
            "INSTANTIATE_ALWAYS",
            "&foundNewFilter"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstantiateFilterInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "748-782",
          "snippet": "static int\nvirNWFilterInstantiateFilterInternal(virNWFilterDriverStatePtr driver,\n                                     virNWFilterBindingDefPtr binding,\n                                     bool teardownOld,\n                                     enum instCase useNewFilter,\n                                     bool *foundNewFilter)\n{\n    int ifindex;\n    int rc;\n\n    virMutexLock(&updateMutex);\n\n    /* after grabbing the filter update lock check for the interface; if\n       it's not there anymore its filters will be or are being removed\n       (while holding the lock) and we don't want to build new ones */\n    if (virNetDevExists(binding->portdevname) != 1 ||\n        virNetDevGetIndex(binding->portdevname, &ifindex) < 0) {\n        /* interfaces / VMs can disappear during filter instantiation;\n           don't mark it as an error */\n        virResetLastError();\n        rc = 0;\n        goto cleanup;\n    }\n\n    rc = virNWFilterInstantiateFilterUpdate(driver, teardownOld,\n                                            binding,\n                                            ifindex,\n                                            useNewFilter,\n                                            false, foundNewFilter);\n\n cleanup:\n    virMutexUnlock(&updateMutex);\n\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex updateMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virMutex updateMutex;\n\nstatic int\nvirNWFilterInstantiateFilterInternal(virNWFilterDriverStatePtr driver,\n                                     virNWFilterBindingDefPtr binding,\n                                     bool teardownOld,\n                                     enum instCase useNewFilter,\n                                     bool *foundNewFilter)\n{\n    int ifindex;\n    int rc;\n\n    virMutexLock(&updateMutex);\n\n    /* after grabbing the filter update lock check for the interface; if\n       it's not there anymore its filters will be or are being removed\n       (while holding the lock) and we don't want to build new ones */\n    if (virNetDevExists(binding->portdevname) != 1 ||\n        virNetDevGetIndex(binding->portdevname, &ifindex) < 0) {\n        /* interfaces / VMs can disappear during filter instantiation;\n           don't mark it as an error */\n        virResetLastError();\n        rc = 0;\n        goto cleanup;\n    }\n\n    rc = virNWFilterInstantiateFilterUpdate(driver, teardownOld,\n                                            binding,\n                                            ifindex,\n                                            useNewFilter,\n                                            false, foundNewFilter);\n\n cleanup:\n    virMutexUnlock(&updateMutex);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterInstantiateFilter(virNWFilterDriverStatePtr driver,\n                             virNWFilterBindingDefPtr binding)\n{\n    bool foundNewFilter = false;\n\n    return virNWFilterInstantiateFilterInternal(driver, binding,\n                                                1,\n                                                INSTANTIATE_ALWAYS,\n                                                &foundNewFilter);\n}"
  },
  {
    "function_name": "virNWFilterInstantiateFilterLate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "785-814",
    "snippet": "int\nvirNWFilterInstantiateFilterLate(virNWFilterDriverStatePtr driver,\n                                 virNWFilterBindingDefPtr binding,\n                                 int ifindex)\n{\n    int rc;\n    bool foundNewFilter = false;\n\n    virNWFilterReadLockFilterUpdates();\n    virMutexLock(&updateMutex);\n\n    rc = virNWFilterInstantiateFilterUpdate(driver, true,\n                                            binding, ifindex,\n                                            INSTANTIATE_ALWAYS, true,\n                                            &foundNewFilter);\n    if (rc < 0) {\n        /* something went wrong... 'DOWN' the interface */\n        if ((virNetDevValidateConfig(binding->portdevname, NULL, ifindex) <= 0) ||\n            (virNetDevSetOnline(binding->portdevname, false) < 0)) {\n            virResetLastError();\n            /* assuming interface disappeared... */\n            _virNWFilterTeardownFilter(binding->portdevname);\n        }\n    }\n\n    virNWFilterUnlockFilterUpdates();\n    virMutexUnlock(&updateMutex);\n\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virMutex updateMutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&updateMutex"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterUnlockFilterUpdates",
          "args": [],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUnlockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "174-178",
          "snippet": "void\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_virNWFilterTeardownFilter",
          "args": [
            "binding->portdevname"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetOnline",
          "args": [
            "binding->portdevname",
            "false"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetOnline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "660-665",
          "snippet": "int\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevValidateConfig",
          "args": [
            "binding->portdevname",
            "NULL",
            "ifindex"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevValidateConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1050-1057",
          "snippet": "int virNetDevValidateConfig(const char *ifname G_GNUC_UNUSED,\n                            const virMacAddr *macaddr G_GNUC_UNUSED,\n                            int ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check interface config on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevValidateConfig(const char *ifname G_GNUC_UNUSED,\n                            const virMacAddr *macaddr G_GNUC_UNUSED,\n                            int ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check interface config on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterInstantiateFilterUpdate",
          "args": [
            "driver",
            "true",
            "binding",
            "ifindex",
            "INSTANTIATE_ALWAYS",
            "true",
            "&foundNewFilter"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstantiateFilterUpdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "673-745",
          "snippet": "static int\nvirNWFilterInstantiateFilterUpdate(virNWFilterDriverStatePtr driver,\n                                   bool teardownOld,\n                                   virNWFilterBindingDefPtr binding,\n                                   int ifindex,\n                                   enum instCase useNewFilter,\n                                   bool forceWithPendingReq,\n                                   bool *foundNewFilter)\n{\n    int rc = -1;\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr filter;\n    virNWFilterDefPtr newFilter;\n    char vmmacaddr[VIR_MAC_STRING_BUFLEN] = {0};\n    virNWFilterVarValuePtr ipaddr;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"filter name: %s\", binding->filter);\n\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        binding->filter)))\n        return -1;\n\n    virMacAddrFormat(&binding->mac, vmmacaddr);\n    if (virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_MAC,\n                                         vmmacaddr) < 0)\n        goto err_exit;\n\n    ipaddr = virNWFilterIPAddrMapGetIPAddr(binding->portdevname);\n    if (ipaddr &&\n        virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_IP,\n                                         virNWFilterVarValueGetSimple(ipaddr)) < 0)\n        goto err_exit;\n\n\n    filter = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newFilter = virNWFilterObjGetNewDef(obj);\n        if (newFilter) {\n            filter = newFilter;\n            *foundNewFilter = true;\n        }\n        break;\n\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    rc = virNWFilterDoInstantiate(techdriver, binding, filter,\n                                  ifindex, useNewFilter, foundNewFilter,\n                                  teardownOld, driver,\n                                  forceWithPendingReq);\n\n err_exit:\n    virNWFilterObjUnlock(obj);\n\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP",
            "#define NWFILTER_STD_VAR_MAC NWFILTER_VARNAME_MAC"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP\n#define NWFILTER_STD_VAR_MAC NWFILTER_VARNAME_MAC\n\nstatic int\nvirNWFilterInstantiateFilterUpdate(virNWFilterDriverStatePtr driver,\n                                   bool teardownOld,\n                                   virNWFilterBindingDefPtr binding,\n                                   int ifindex,\n                                   enum instCase useNewFilter,\n                                   bool forceWithPendingReq,\n                                   bool *foundNewFilter)\n{\n    int rc = -1;\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr filter;\n    virNWFilterDefPtr newFilter;\n    char vmmacaddr[VIR_MAC_STRING_BUFLEN] = {0};\n    virNWFilterVarValuePtr ipaddr;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"filter name: %s\", binding->filter);\n\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        binding->filter)))\n        return -1;\n\n    virMacAddrFormat(&binding->mac, vmmacaddr);\n    if (virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_MAC,\n                                         vmmacaddr) < 0)\n        goto err_exit;\n\n    ipaddr = virNWFilterIPAddrMapGetIPAddr(binding->portdevname);\n    if (ipaddr &&\n        virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_IP,\n                                         virNWFilterVarValueGetSimple(ipaddr)) < 0)\n        goto err_exit;\n\n\n    filter = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newFilter = virNWFilterObjGetNewDef(obj);\n        if (newFilter) {\n            filter = newFilter;\n            *foundNewFilter = true;\n        }\n        break;\n\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    rc = virNWFilterDoInstantiate(techdriver, binding, filter,\n                                  ifindex, useNewFilter, foundNewFilter,\n                                  teardownOld, driver,\n                                  forceWithPendingReq);\n\n err_exit:\n    virNWFilterObjUnlock(obj);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&updateMutex"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterReadLockFilterUpdates",
          "args": [],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterReadLockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "160-164",
          "snippet": "void\nvirNWFilterReadLockFilterUpdates(void)\n{\n    virRWLockRead(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterReadLockFilterUpdates(void)\n{\n    virRWLockRead(&updateLock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virMutex updateMutex;\n\nint\nvirNWFilterInstantiateFilterLate(virNWFilterDriverStatePtr driver,\n                                 virNWFilterBindingDefPtr binding,\n                                 int ifindex)\n{\n    int rc;\n    bool foundNewFilter = false;\n\n    virNWFilterReadLockFilterUpdates();\n    virMutexLock(&updateMutex);\n\n    rc = virNWFilterInstantiateFilterUpdate(driver, true,\n                                            binding, ifindex,\n                                            INSTANTIATE_ALWAYS, true,\n                                            &foundNewFilter);\n    if (rc < 0) {\n        /* something went wrong... 'DOWN' the interface */\n        if ((virNetDevValidateConfig(binding->portdevname, NULL, ifindex) <= 0) ||\n            (virNetDevSetOnline(binding->portdevname, false) < 0)) {\n            virResetLastError();\n            /* assuming interface disappeared... */\n            _virNWFilterTeardownFilter(binding->portdevname);\n        }\n    }\n\n    virNWFilterUnlockFilterUpdates();\n    virMutexUnlock(&updateMutex);\n\n    return rc;\n}"
  },
  {
    "function_name": "virNWFilterInstantiateFilterInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "748-782",
    "snippet": "static int\nvirNWFilterInstantiateFilterInternal(virNWFilterDriverStatePtr driver,\n                                     virNWFilterBindingDefPtr binding,\n                                     bool teardownOld,\n                                     enum instCase useNewFilter,\n                                     bool *foundNewFilter)\n{\n    int ifindex;\n    int rc;\n\n    virMutexLock(&updateMutex);\n\n    /* after grabbing the filter update lock check for the interface; if\n       it's not there anymore its filters will be or are being removed\n       (while holding the lock) and we don't want to build new ones */\n    if (virNetDevExists(binding->portdevname) != 1 ||\n        virNetDevGetIndex(binding->portdevname, &ifindex) < 0) {\n        /* interfaces / VMs can disappear during filter instantiation;\n           don't mark it as an error */\n        virResetLastError();\n        rc = 0;\n        goto cleanup;\n    }\n\n    rc = virNWFilterInstantiateFilterUpdate(driver, teardownOld,\n                                            binding,\n                                            ifindex,\n                                            useNewFilter,\n                                            false, foundNewFilter);\n\n cleanup:\n    virMutexUnlock(&updateMutex);\n\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virMutex updateMutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&updateMutex"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterInstantiateFilterUpdate",
          "args": [
            "driver",
            "teardownOld",
            "binding",
            "ifindex",
            "useNewFilter",
            "false",
            "foundNewFilter"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstantiateFilterUpdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "673-745",
          "snippet": "static int\nvirNWFilterInstantiateFilterUpdate(virNWFilterDriverStatePtr driver,\n                                   bool teardownOld,\n                                   virNWFilterBindingDefPtr binding,\n                                   int ifindex,\n                                   enum instCase useNewFilter,\n                                   bool forceWithPendingReq,\n                                   bool *foundNewFilter)\n{\n    int rc = -1;\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr filter;\n    virNWFilterDefPtr newFilter;\n    char vmmacaddr[VIR_MAC_STRING_BUFLEN] = {0};\n    virNWFilterVarValuePtr ipaddr;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"filter name: %s\", binding->filter);\n\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        binding->filter)))\n        return -1;\n\n    virMacAddrFormat(&binding->mac, vmmacaddr);\n    if (virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_MAC,\n                                         vmmacaddr) < 0)\n        goto err_exit;\n\n    ipaddr = virNWFilterIPAddrMapGetIPAddr(binding->portdevname);\n    if (ipaddr &&\n        virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_IP,\n                                         virNWFilterVarValueGetSimple(ipaddr)) < 0)\n        goto err_exit;\n\n\n    filter = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newFilter = virNWFilterObjGetNewDef(obj);\n        if (newFilter) {\n            filter = newFilter;\n            *foundNewFilter = true;\n        }\n        break;\n\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    rc = virNWFilterDoInstantiate(techdriver, binding, filter,\n                                  ifindex, useNewFilter, foundNewFilter,\n                                  teardownOld, driver,\n                                  forceWithPendingReq);\n\n err_exit:\n    virNWFilterObjUnlock(obj);\n\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP",
            "#define NWFILTER_STD_VAR_MAC NWFILTER_VARNAME_MAC"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP\n#define NWFILTER_STD_VAR_MAC NWFILTER_VARNAME_MAC\n\nstatic int\nvirNWFilterInstantiateFilterUpdate(virNWFilterDriverStatePtr driver,\n                                   bool teardownOld,\n                                   virNWFilterBindingDefPtr binding,\n                                   int ifindex,\n                                   enum instCase useNewFilter,\n                                   bool forceWithPendingReq,\n                                   bool *foundNewFilter)\n{\n    int rc = -1;\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr filter;\n    virNWFilterDefPtr newFilter;\n    char vmmacaddr[VIR_MAC_STRING_BUFLEN] = {0};\n    virNWFilterVarValuePtr ipaddr;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"filter name: %s\", binding->filter);\n\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        binding->filter)))\n        return -1;\n\n    virMacAddrFormat(&binding->mac, vmmacaddr);\n    if (virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_MAC,\n                                         vmmacaddr) < 0)\n        goto err_exit;\n\n    ipaddr = virNWFilterIPAddrMapGetIPAddr(binding->portdevname);\n    if (ipaddr &&\n        virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_IP,\n                                         virNWFilterVarValueGetSimple(ipaddr)) < 0)\n        goto err_exit;\n\n\n    filter = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newFilter = virNWFilterObjGetNewDef(obj);\n        if (newFilter) {\n            filter = newFilter;\n            *foundNewFilter = true;\n        }\n        break;\n\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    rc = virNWFilterDoInstantiate(techdriver, binding, filter,\n                                  ifindex, useNewFilter, foundNewFilter,\n                                  teardownOld, driver,\n                                  forceWithPendingReq);\n\n err_exit:\n    virNWFilterObjUnlock(obj);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetIndex",
          "args": [
            "binding->portdevname",
            "&ifindex"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "893-899",
          "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevExists",
          "args": [
            "binding->portdevname"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "218-223",
          "snippet": "int virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&updateMutex"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virMutex updateMutex;\n\nstatic int\nvirNWFilterInstantiateFilterInternal(virNWFilterDriverStatePtr driver,\n                                     virNWFilterBindingDefPtr binding,\n                                     bool teardownOld,\n                                     enum instCase useNewFilter,\n                                     bool *foundNewFilter)\n{\n    int ifindex;\n    int rc;\n\n    virMutexLock(&updateMutex);\n\n    /* after grabbing the filter update lock check for the interface; if\n       it's not there anymore its filters will be or are being removed\n       (while holding the lock) and we don't want to build new ones */\n    if (virNetDevExists(binding->portdevname) != 1 ||\n        virNetDevGetIndex(binding->portdevname, &ifindex) < 0) {\n        /* interfaces / VMs can disappear during filter instantiation;\n           don't mark it as an error */\n        virResetLastError();\n        rc = 0;\n        goto cleanup;\n    }\n\n    rc = virNWFilterInstantiateFilterUpdate(driver, teardownOld,\n                                            binding,\n                                            ifindex,\n                                            useNewFilter,\n                                            false, foundNewFilter);\n\n cleanup:\n    virMutexUnlock(&updateMutex);\n\n    return rc;\n}"
  },
  {
    "function_name": "virNWFilterInstantiateFilterUpdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "673-745",
    "snippet": "static int\nvirNWFilterInstantiateFilterUpdate(virNWFilterDriverStatePtr driver,\n                                   bool teardownOld,\n                                   virNWFilterBindingDefPtr binding,\n                                   int ifindex,\n                                   enum instCase useNewFilter,\n                                   bool forceWithPendingReq,\n                                   bool *foundNewFilter)\n{\n    int rc = -1;\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr filter;\n    virNWFilterDefPtr newFilter;\n    char vmmacaddr[VIR_MAC_STRING_BUFLEN] = {0};\n    virNWFilterVarValuePtr ipaddr;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"filter name: %s\", binding->filter);\n\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        binding->filter)))\n        return -1;\n\n    virMacAddrFormat(&binding->mac, vmmacaddr);\n    if (virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_MAC,\n                                         vmmacaddr) < 0)\n        goto err_exit;\n\n    ipaddr = virNWFilterIPAddrMapGetIPAddr(binding->portdevname);\n    if (ipaddr &&\n        virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_IP,\n                                         virNWFilterVarValueGetSimple(ipaddr)) < 0)\n        goto err_exit;\n\n\n    filter = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newFilter = virNWFilterObjGetNewDef(obj);\n        if (newFilter) {\n            filter = newFilter;\n            *foundNewFilter = true;\n        }\n        break;\n\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    rc = virNWFilterDoInstantiate(techdriver, binding, filter,\n                                  ifindex, useNewFilter, foundNewFilter,\n                                  teardownOld, driver,\n                                  forceWithPendingReq);\n\n err_exit:\n    virNWFilterObjUnlock(obj);\n\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP",
      "#define NWFILTER_STD_VAR_MAC NWFILTER_VARNAME_MAC"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDoInstantiate",
          "args": [
            "techdriver",
            "binding",
            "filter",
            "ifindex",
            "useNewFilter",
            "foundNewFilter",
            "teardownOld",
            "driver",
            "forceWithPendingReq"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDoInstantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "506-645",
          "snippet": "static int\nvirNWFilterDoInstantiate(virNWFilterTechDriverPtr techdriver,\n                         virNWFilterBindingDefPtr binding,\n                         virNWFilterDefPtr filter,\n                         int ifindex,\n                         enum instCase useNewFilter,\n                         bool *foundNewFilter,\n                         bool teardownOld,\n                         virNWFilterDriverStatePtr driver,\n                         bool forceWithPendingReq)\n{\n    int rc;\n    virNWFilterInst inst;\n    bool instantiate = true;\n    char *buf;\n    virNWFilterVarValuePtr lv;\n    const char *learning;\n    bool reportIP = false;\n\n    virHashTablePtr missing_vars = virNWFilterHashTableCreate(0);\n\n    memset(&inst, 0, sizeof(inst));\n\n    if (!missing_vars) {\n        rc = -1;\n        goto err_exit;\n    }\n\n    rc = virNWFilterDetermineMissingVarsRec(filter,\n                                            binding->filterparams,\n                                            missing_vars,\n                                            useNewFilter,\n                                            driver);\n    if (rc < 0)\n        goto err_exit;\n\n    lv = virHashLookup(binding->filterparams, NWFILTER_VARNAME_CTRL_IP_LEARNING);\n    if (lv)\n        learning = virNWFilterVarValueGetNthValue(lv, 0);\n    else\n        learning = NULL;\n\n    if (learning == NULL)\n        learning = NWFILTER_DFLT_LEARN;\n\n    if (virHashSize(missing_vars) == 1) {\n        if (virHashLookup(missing_vars,\n                          NWFILTER_STD_VAR_IP) != NULL) {\n            if (STRCASEEQ(learning, \"none\")) {        /* no learning */\n                reportIP = true;\n                goto err_unresolvable_vars;\n            }\n            if (STRCASEEQ(learning, \"dhcp\")) {\n                rc = virNWFilterDHCPSnoopReq(techdriver,\n                                             binding,\n                                             driver);\n                goto err_exit;\n            } else if (STRCASEEQ(learning, \"any\")) {\n                if (!virNWFilterHasLearnReq(ifindex)) {\n                    rc = virNWFilterLearnIPAddress(techdriver,\n                                                   binding,\n                                                   ifindex,\n                                                   driver,\n                                                   DETECT_DHCP|DETECT_STATIC);\n                }\n                goto err_exit;\n            } else {\n                rc = -1;\n                virReportError(VIR_ERR_PARSE_FAILED,\n                               _(\"filter '%s' \"\n                                 \"learning value '%s' invalid.\"),\n                               filter->name, learning);\n                goto err_exit;\n            }\n        } else {\n            goto err_unresolvable_vars;\n        }\n    } else if (virHashSize(missing_vars) > 1) {\n        goto err_unresolvable_vars;\n    } else if (!forceWithPendingReq &&\n               virNWFilterHasLearnReq(ifindex)) {\n        goto err_exit;\n    }\n\n    rc = virNWFilterDefToInst(driver,\n                              filter,\n                              binding->filterparams,\n                              useNewFilter, foundNewFilter,\n                              &inst);\n\n    if (rc < 0)\n        goto err_exit;\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        instantiate = *foundNewFilter;\n        break;\n    case INSTANTIATE_ALWAYS:\n        instantiate = true;\n        break;\n    }\n\n    if (instantiate) {\n        if (virNWFilterLockIface(binding->portdevname) < 0)\n            goto err_exit;\n\n        rc = techdriver->applyNewRules(binding->portdevname, inst.rules, inst.nrules);\n\n        if (teardownOld && rc == 0)\n            techdriver->tearOldRules(binding->portdevname);\n\n        if (rc == 0 && (virNetDevValidateConfig(binding->portdevname, NULL, ifindex) <= 0)) {\n            virResetLastError();\n            /* interface changed/disappeared */\n            techdriver->allTeardown(binding->portdevname);\n            rc = -1;\n        }\n\n        virNWFilterUnlockIface(binding->portdevname);\n    }\n\n err_exit:\n    virNWFilterInstReset(&inst);\n    virHashFree(missing_vars);\n\n    return rc;\n\n err_unresolvable_vars:\n\n    buf = virNWFilterPrintVars(missing_vars, \", \", false, reportIP);\n    if (buf) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot instantiate filter due to unresolvable \"\n                         \"variables or unavailable list elements: %s\"), buf);\n        VIR_FREE(buf);\n    }\n\n    rc = -1;\n    goto err_exit;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NWFILTER_DFLT_LEARN  \"any\"",
            "#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP"
          ],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define NWFILTER_DFLT_LEARN  \"any\"\n#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterDoInstantiate(virNWFilterTechDriverPtr techdriver,\n                         virNWFilterBindingDefPtr binding,\n                         virNWFilterDefPtr filter,\n                         int ifindex,\n                         enum instCase useNewFilter,\n                         bool *foundNewFilter,\n                         bool teardownOld,\n                         virNWFilterDriverStatePtr driver,\n                         bool forceWithPendingReq)\n{\n    int rc;\n    virNWFilterInst inst;\n    bool instantiate = true;\n    char *buf;\n    virNWFilterVarValuePtr lv;\n    const char *learning;\n    bool reportIP = false;\n\n    virHashTablePtr missing_vars = virNWFilterHashTableCreate(0);\n\n    memset(&inst, 0, sizeof(inst));\n\n    if (!missing_vars) {\n        rc = -1;\n        goto err_exit;\n    }\n\n    rc = virNWFilterDetermineMissingVarsRec(filter,\n                                            binding->filterparams,\n                                            missing_vars,\n                                            useNewFilter,\n                                            driver);\n    if (rc < 0)\n        goto err_exit;\n\n    lv = virHashLookup(binding->filterparams, NWFILTER_VARNAME_CTRL_IP_LEARNING);\n    if (lv)\n        learning = virNWFilterVarValueGetNthValue(lv, 0);\n    else\n        learning = NULL;\n\n    if (learning == NULL)\n        learning = NWFILTER_DFLT_LEARN;\n\n    if (virHashSize(missing_vars) == 1) {\n        if (virHashLookup(missing_vars,\n                          NWFILTER_STD_VAR_IP) != NULL) {\n            if (STRCASEEQ(learning, \"none\")) {        /* no learning */\n                reportIP = true;\n                goto err_unresolvable_vars;\n            }\n            if (STRCASEEQ(learning, \"dhcp\")) {\n                rc = virNWFilterDHCPSnoopReq(techdriver,\n                                             binding,\n                                             driver);\n                goto err_exit;\n            } else if (STRCASEEQ(learning, \"any\")) {\n                if (!virNWFilterHasLearnReq(ifindex)) {\n                    rc = virNWFilterLearnIPAddress(techdriver,\n                                                   binding,\n                                                   ifindex,\n                                                   driver,\n                                                   DETECT_DHCP|DETECT_STATIC);\n                }\n                goto err_exit;\n            } else {\n                rc = -1;\n                virReportError(VIR_ERR_PARSE_FAILED,\n                               _(\"filter '%s' \"\n                                 \"learning value '%s' invalid.\"),\n                               filter->name, learning);\n                goto err_exit;\n            }\n        } else {\n            goto err_unresolvable_vars;\n        }\n    } else if (virHashSize(missing_vars) > 1) {\n        goto err_unresolvable_vars;\n    } else if (!forceWithPendingReq &&\n               virNWFilterHasLearnReq(ifindex)) {\n        goto err_exit;\n    }\n\n    rc = virNWFilterDefToInst(driver,\n                              filter,\n                              binding->filterparams,\n                              useNewFilter, foundNewFilter,\n                              &inst);\n\n    if (rc < 0)\n        goto err_exit;\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        instantiate = *foundNewFilter;\n        break;\n    case INSTANTIATE_ALWAYS:\n        instantiate = true;\n        break;\n    }\n\n    if (instantiate) {\n        if (virNWFilterLockIface(binding->portdevname) < 0)\n            goto err_exit;\n\n        rc = techdriver->applyNewRules(binding->portdevname, inst.rules, inst.nrules);\n\n        if (teardownOld && rc == 0)\n            techdriver->tearOldRules(binding->portdevname);\n\n        if (rc == 0 && (virNetDevValidateConfig(binding->portdevname, NULL, ifindex) <= 0)) {\n            virResetLastError();\n            /* interface changed/disappeared */\n            techdriver->allTeardown(binding->portdevname);\n            rc = -1;\n        }\n\n        virNWFilterUnlockIface(binding->portdevname);\n    }\n\n err_exit:\n    virNWFilterInstReset(&inst);\n    virHashFree(missing_vars);\n\n    return rc;\n\n err_unresolvable_vars:\n\n    buf = virNWFilterPrintVars(missing_vars, \", \", false, reportIP);\n    if (buf) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot instantiate filter due to unresolvable \"\n                         \"variables or unavailable list elements: %s\"), buf);\n        VIR_FREE(buf);\n    }\n\n    rc = -1;\n    goto err_exit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetNewDef",
          "args": [
            "obj"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetNewDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "78-82",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetNewDef(virNWFilterObjPtr obj)\n{\n    return obj->newDef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetNewDef(virNWFilterObjPtr obj)\n{\n    return obj->newDef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetDef",
          "args": [
            "obj"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "71-75",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarHashmapAddStdValue",
          "args": [
            "binding->filterparams",
            "NWFILTER_STD_VAR_IP",
            "virNWFilterVarValueGetSimple(ipaddr)"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarHashmapAddStdValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "648-667",
          "snippet": "static int\nvirNWFilterVarHashmapAddStdValue(virHashTablePtr table,\n                                 const char *var,\n                                 const char *value)\n{\n    virNWFilterVarValue *val;\n\n    if (virHashLookup(table, var))\n        return 0;\n\n    if (!(val = virNWFilterVarValueCreateSimpleCopyValue(value)))\n        return -1;\n\n    if (virHashAddEntry(table, var, val) < 0) {\n        virNWFilterVarValueFree(val);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterVarHashmapAddStdValue(virHashTablePtr table,\n                                 const char *var,\n                                 const char *value)\n{\n    virNWFilterVarValue *val;\n\n    if (virHashLookup(table, var))\n        return 0;\n\n    if (!(val = virNWFilterVarValueCreateSimpleCopyValue(value)))\n        return -1;\n\n    if (virHashAddEntry(table, var, val) < 0) {\n        virNWFilterVarValueFree(val);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetSimple",
          "args": [
            "ipaddr"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetSimple",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "134-140",
          "snippet": "const char *\nvirNWFilterVarValueGetSimple(const virNWFilterVarValue *val)\n{\n    if (val->valType == NWFILTER_VALUE_TYPE_SIMPLE)\n        return val->u.simple.value;\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetSimple(const virNWFilterVarValue *val)\n{\n    if (val->valType == NWFILTER_VALUE_TYPE_SIMPLE)\n        return val->u.simple.value;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterIPAddrMapGetIPAddr",
          "args": [
            "binding->portdevname"
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterIPAddrMapGetIPAddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_ipaddrmap.c",
          "lines": "135-147",
          "snippet": "virNWFilterVarValuePtr\nvirNWFilterIPAddrMapGetIPAddr(const char *ifname)\n{\n    virNWFilterVarValuePtr res;\n\n    virMutexLock(&ipAddressMapLock);\n\n    res = virHashLookup(ipAddressMap, ifname);\n\n    virMutexUnlock(&ipAddressMapLock);\n\n    return res;\n}",
          "includes": [
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex ipAddressMapLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr ipAddressMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virMutex ipAddressMapLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr ipAddressMap;\n\nvirNWFilterVarValuePtr\nvirNWFilterIPAddrMapGetIPAddr(const char *ifname)\n{\n    virNWFilterVarValuePtr res;\n\n    virMutexLock(&ipAddressMapLock);\n\n    res = virHashLookup(ipAddressMap, ifname);\n\n    virMutexUnlock(&ipAddressMapLock);\n\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&binding->mac",
            "vmmacaddr"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindInstantiateFilter",
          "args": [
            "driver->nwfilters",
            "binding->filter"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindInstantiateFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "193-213",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindInstantiateFilter(virNWFilterObjListPtr nwfilters,\n                                        const char *filtername)\n{\n    virNWFilterObjPtr obj;\n\n    if (!(obj = virNWFilterObjListFindByName(nwfilters, filtername))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"referenced filter '%s' is missing\"), filtername);\n        return NULL;\n    }\n\n    if (virNWFilterObjWantRemoved(obj)) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"Filter '%s' is in use.\"), filtername);\n        virNWFilterObjUnlock(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindInstantiateFilter(virNWFilterObjListPtr nwfilters,\n                                        const char *filtername)\n{\n    virNWFilterObjPtr obj;\n\n    if (!(obj = virNWFilterObjListFindByName(nwfilters, filtername))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"referenced filter '%s' is missing\"), filtername);\n        return NULL;\n    }\n\n    if (virNWFilterObjWantRemoved(obj)) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"Filter '%s' is in use.\"), filtername);\n        virNWFilterObjUnlock(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"filter name: %s\"",
            "binding->filter"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not get access to ACL tech \"\n                         \"driver '%s'\")",
            "drvname"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not get access to ACL tech \"\n                         \"driver '%s'\""
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTechDriverForName",
          "args": [
            "drvname"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTechDriverForName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "102-115",
          "snippet": "virNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\n\nvirNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP\n#define NWFILTER_STD_VAR_MAC NWFILTER_VARNAME_MAC\n\nstatic int\nvirNWFilterInstantiateFilterUpdate(virNWFilterDriverStatePtr driver,\n                                   bool teardownOld,\n                                   virNWFilterBindingDefPtr binding,\n                                   int ifindex,\n                                   enum instCase useNewFilter,\n                                   bool forceWithPendingReq,\n                                   bool *foundNewFilter)\n{\n    int rc = -1;\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr filter;\n    virNWFilterDefPtr newFilter;\n    char vmmacaddr[VIR_MAC_STRING_BUFLEN] = {0};\n    virNWFilterVarValuePtr ipaddr;\n\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"filter name: %s\", binding->filter);\n\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        binding->filter)))\n        return -1;\n\n    virMacAddrFormat(&binding->mac, vmmacaddr);\n    if (virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_MAC,\n                                         vmmacaddr) < 0)\n        goto err_exit;\n\n    ipaddr = virNWFilterIPAddrMapGetIPAddr(binding->portdevname);\n    if (ipaddr &&\n        virNWFilterVarHashmapAddStdValue(binding->filterparams,\n                                         NWFILTER_STD_VAR_IP,\n                                         virNWFilterVarValueGetSimple(ipaddr)) < 0)\n        goto err_exit;\n\n\n    filter = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newFilter = virNWFilterObjGetNewDef(obj);\n        if (newFilter) {\n            filter = newFilter;\n            *foundNewFilter = true;\n        }\n        break;\n\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    rc = virNWFilterDoInstantiate(techdriver, binding, filter,\n                                  ifindex, useNewFilter, foundNewFilter,\n                                  teardownOld, driver,\n                                  forceWithPendingReq);\n\n err_exit:\n    virNWFilterObjUnlock(obj);\n\n    return rc;\n}"
  },
  {
    "function_name": "virNWFilterVarHashmapAddStdValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "648-667",
    "snippet": "static int\nvirNWFilterVarHashmapAddStdValue(virHashTablePtr table,\n                                 const char *var,\n                                 const char *value)\n{\n    virNWFilterVarValue *val;\n\n    if (virHashLookup(table, var))\n        return 0;\n\n    if (!(val = virNWFilterVarValueCreateSimpleCopyValue(value)))\n        return -1;\n\n    if (virHashAddEntry(table, var, val) < 0) {\n        virNWFilterVarValueFree(val);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarValueFree",
          "args": [
            "val"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "43-64",
          "snippet": "void\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvoid\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "table",
            "var",
            "val"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueCreateSimpleCopyValue",
          "args": [
            "value"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueCreateSimpleCopyValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "121-132",
          "snippet": "virNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "table",
            "var"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterVarHashmapAddStdValue(virHashTablePtr table,\n                                 const char *var,\n                                 const char *value)\n{\n    virNWFilterVarValue *val;\n\n    if (virHashLookup(table, var))\n        return 0;\n\n    if (!(val = virNWFilterVarValueCreateSimpleCopyValue(value)))\n        return -1;\n\n    if (virHashAddEntry(table, var, val) < 0) {\n        virNWFilterVarValueFree(val);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterDoInstantiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "506-645",
    "snippet": "static int\nvirNWFilterDoInstantiate(virNWFilterTechDriverPtr techdriver,\n                         virNWFilterBindingDefPtr binding,\n                         virNWFilterDefPtr filter,\n                         int ifindex,\n                         enum instCase useNewFilter,\n                         bool *foundNewFilter,\n                         bool teardownOld,\n                         virNWFilterDriverStatePtr driver,\n                         bool forceWithPendingReq)\n{\n    int rc;\n    virNWFilterInst inst;\n    bool instantiate = true;\n    char *buf;\n    virNWFilterVarValuePtr lv;\n    const char *learning;\n    bool reportIP = false;\n\n    virHashTablePtr missing_vars = virNWFilterHashTableCreate(0);\n\n    memset(&inst, 0, sizeof(inst));\n\n    if (!missing_vars) {\n        rc = -1;\n        goto err_exit;\n    }\n\n    rc = virNWFilterDetermineMissingVarsRec(filter,\n                                            binding->filterparams,\n                                            missing_vars,\n                                            useNewFilter,\n                                            driver);\n    if (rc < 0)\n        goto err_exit;\n\n    lv = virHashLookup(binding->filterparams, NWFILTER_VARNAME_CTRL_IP_LEARNING);\n    if (lv)\n        learning = virNWFilterVarValueGetNthValue(lv, 0);\n    else\n        learning = NULL;\n\n    if (learning == NULL)\n        learning = NWFILTER_DFLT_LEARN;\n\n    if (virHashSize(missing_vars) == 1) {\n        if (virHashLookup(missing_vars,\n                          NWFILTER_STD_VAR_IP) != NULL) {\n            if (STRCASEEQ(learning, \"none\")) {        /* no learning */\n                reportIP = true;\n                goto err_unresolvable_vars;\n            }\n            if (STRCASEEQ(learning, \"dhcp\")) {\n                rc = virNWFilterDHCPSnoopReq(techdriver,\n                                             binding,\n                                             driver);\n                goto err_exit;\n            } else if (STRCASEEQ(learning, \"any\")) {\n                if (!virNWFilterHasLearnReq(ifindex)) {\n                    rc = virNWFilterLearnIPAddress(techdriver,\n                                                   binding,\n                                                   ifindex,\n                                                   driver,\n                                                   DETECT_DHCP|DETECT_STATIC);\n                }\n                goto err_exit;\n            } else {\n                rc = -1;\n                virReportError(VIR_ERR_PARSE_FAILED,\n                               _(\"filter '%s' \"\n                                 \"learning value '%s' invalid.\"),\n                               filter->name, learning);\n                goto err_exit;\n            }\n        } else {\n            goto err_unresolvable_vars;\n        }\n    } else if (virHashSize(missing_vars) > 1) {\n        goto err_unresolvable_vars;\n    } else if (!forceWithPendingReq &&\n               virNWFilterHasLearnReq(ifindex)) {\n        goto err_exit;\n    }\n\n    rc = virNWFilterDefToInst(driver,\n                              filter,\n                              binding->filterparams,\n                              useNewFilter, foundNewFilter,\n                              &inst);\n\n    if (rc < 0)\n        goto err_exit;\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        instantiate = *foundNewFilter;\n        break;\n    case INSTANTIATE_ALWAYS:\n        instantiate = true;\n        break;\n    }\n\n    if (instantiate) {\n        if (virNWFilterLockIface(binding->portdevname) < 0)\n            goto err_exit;\n\n        rc = techdriver->applyNewRules(binding->portdevname, inst.rules, inst.nrules);\n\n        if (teardownOld && rc == 0)\n            techdriver->tearOldRules(binding->portdevname);\n\n        if (rc == 0 && (virNetDevValidateConfig(binding->portdevname, NULL, ifindex) <= 0)) {\n            virResetLastError();\n            /* interface changed/disappeared */\n            techdriver->allTeardown(binding->portdevname);\n            rc = -1;\n        }\n\n        virNWFilterUnlockIface(binding->portdevname);\n    }\n\n err_exit:\n    virNWFilterInstReset(&inst);\n    virHashFree(missing_vars);\n\n    return rc;\n\n err_unresolvable_vars:\n\n    buf = virNWFilterPrintVars(missing_vars, \", \", false, reportIP);\n    if (buf) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot instantiate filter due to unresolvable \"\n                         \"variables or unavailable list elements: %s\"), buf);\n        VIR_FREE(buf);\n    }\n\n    rc = -1;\n    goto err_exit;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NWFILTER_DFLT_LEARN  \"any\"",
      "#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP"
    ],
    "globals_used": [
      "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buf"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot instantiate filter due to unresolvable \"\n                         \"variables or unavailable list elements: %s\")",
            "buf"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot instantiate filter due to unresolvable \"\n                         \"variables or unavailable list elements: %s\""
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterPrintVars",
          "args": [
            "missing_vars",
            "\", \"",
            "false",
            "reportIP"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterPrintVars",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "168-184",
          "snippet": "static char *\nvirNWFilterPrintVars(virHashTablePtr vars,\n                     const char *separator,\n                     bool reportMAC,\n                     bool reportIP)\n{\n    struct printString ps = {\n        .buf       = VIR_BUFFER_INITIALIZER,\n        .separator = separator,\n        .reportMAC = reportMAC,\n        .reportIP  = reportIP,\n    };\n\n    virHashForEach(vars, printString, &ps);\n\n    return virBufferContentAndReset(&ps.buf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvirNWFilterPrintVars(virHashTablePtr vars,\n                     const char *separator,\n                     bool reportMAC,\n                     bool reportIP)\n{\n    struct printString ps = {\n        .buf       = VIR_BUFFER_INITIALIZER,\n        .separator = separator,\n        .reportMAC = reportMAC,\n        .reportIP  = reportIP,\n    };\n\n    virHashForEach(vars, printString, &ps);\n\n    return virBufferContentAndReset(&ps.buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "missing_vars"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterInstReset",
          "args": [
            "&inst"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "230-243",
          "snippet": "static void\nvirNWFilterInstReset(virNWFilterInstPtr inst)\n{\n    size_t i;\n\n    for (i = 0; i < inst->nfilters; i++)\n        virNWFilterObjUnlock(inst->filters[i]);\n    VIR_FREE(inst->filters);\n    inst->nfilters = 0;\n\n    for (i = 0; i < inst->nrules; i++)\n        virNWFilterRuleInstFree(inst->rules[i]);\n    VIR_FREE(inst->rules);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic void\nvirNWFilterInstReset(virNWFilterInstPtr inst)\n{\n    size_t i;\n\n    for (i = 0; i < inst->nfilters; i++)\n        virNWFilterObjUnlock(inst->filters[i]);\n    VIR_FREE(inst->filters);\n    inst->nfilters = 0;\n\n    for (i = 0; i < inst->nrules; i++)\n        virNWFilterRuleInstFree(inst->rules[i]);\n    VIR_FREE(inst->rules);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterUnlockIface",
          "args": [
            "binding->portdevname"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUnlockIface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "196-214",
          "snippet": "void\nvirNWFilterUnlockIface(const char *ifname)\n{\n    virNWFilterIfaceLockPtr ifaceLock;\n\n    virMutexLock(&ifaceMapLock);\n\n    ifaceLock = virHashLookup(ifaceLockMap, ifname);\n\n    if (ifaceLock) {\n        virMutexUnlock(&ifaceLock->lock);\n\n        ifaceLock->refctr--;\n        if (ifaceLock->refctr == 0)\n            virHashRemoveEntry(ifaceLockMap, ifname);\n    }\n\n    virMutexUnlock(&ifaceMapLock);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex ifaceMapLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr ifaceLockMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virMutex ifaceMapLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr ifaceLockMap;\n\nvoid\nvirNWFilterUnlockIface(const char *ifname)\n{\n    virNWFilterIfaceLockPtr ifaceLock;\n\n    virMutexLock(&ifaceMapLock);\n\n    ifaceLock = virHashLookup(ifaceLockMap, ifname);\n\n    if (ifaceLock) {\n        virMutexUnlock(&ifaceLock->lock);\n\n        ifaceLock->refctr--;\n        if (ifaceLock->refctr == 0)\n            virHashRemoveEntry(ifaceLockMap, ifname);\n    }\n\n    virMutexUnlock(&ifaceMapLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "techdriver->allTeardown",
          "args": [
            "binding->portdevname"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevValidateConfig",
          "args": [
            "binding->portdevname",
            "NULL",
            "ifindex"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevValidateConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1050-1057",
          "snippet": "int virNetDevValidateConfig(const char *ifname G_GNUC_UNUSED,\n                            const virMacAddr *macaddr G_GNUC_UNUSED,\n                            int ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check interface config on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevValidateConfig(const char *ifname G_GNUC_UNUSED,\n                            const virMacAddr *macaddr G_GNUC_UNUSED,\n                            int ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check interface config on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "techdriver->tearOldRules",
          "args": [
            "binding->portdevname"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "techdriver->applyNewRules",
          "args": [
            "binding->portdevname",
            "inst.rules",
            "inst.nrules"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterLockIface",
          "args": [
            "binding->portdevname"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterLockIface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "145-193",
          "snippet": "int\nvirNWFilterLockIface(const char *ifname)\n{\n    virNWFilterIfaceLockPtr ifaceLock;\n\n    virMutexLock(&ifaceMapLock);\n\n    ifaceLock = virHashLookup(ifaceLockMap, ifname);\n    if (!ifaceLock) {\n        if (VIR_ALLOC(ifaceLock) < 0)\n            goto err_exit;\n\n        if (virMutexInitRecursive(&ifaceLock->lock) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"mutex initialization failed\"));\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        if (virStrcpyStatic(ifaceLock->ifname, ifname) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"interface name %s does not fit into \"\n                             \"buffer \"),\n                           ifaceLock->ifname);\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        while (virHashAddEntry(ifaceLockMap, ifname, ifaceLock)) {\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        ifaceLock->refctr = 0;\n    }\n\n    ifaceLock->refctr++;\n\n    virMutexUnlock(&ifaceMapLock);\n\n    virMutexLock(&ifaceLock->lock);\n\n    return 0;\n\n err_exit:\n    virMutexUnlock(&ifaceMapLock);\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex ifaceMapLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr ifaceLockMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virMutex ifaceMapLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr ifaceLockMap;\n\nint\nvirNWFilterLockIface(const char *ifname)\n{\n    virNWFilterIfaceLockPtr ifaceLock;\n\n    virMutexLock(&ifaceMapLock);\n\n    ifaceLock = virHashLookup(ifaceLockMap, ifname);\n    if (!ifaceLock) {\n        if (VIR_ALLOC(ifaceLock) < 0)\n            goto err_exit;\n\n        if (virMutexInitRecursive(&ifaceLock->lock) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"mutex initialization failed\"));\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        if (virStrcpyStatic(ifaceLock->ifname, ifname) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"interface name %s does not fit into \"\n                             \"buffer \"),\n                           ifaceLock->ifname);\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        while (virHashAddEntry(ifaceLockMap, ifname, ifaceLock)) {\n            VIR_FREE(ifaceLock);\n            goto err_exit;\n        }\n\n        ifaceLock->refctr = 0;\n    }\n\n    ifaceLock->refctr++;\n\n    virMutexUnlock(&ifaceMapLock);\n\n    virMutexLock(&ifaceLock->lock);\n\n    return 0;\n\n err_exit:\n    virMutexUnlock(&ifaceMapLock);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDefToInst",
          "args": [
            "driver",
            "filter",
            "binding->filterparams",
            "useNewFilter",
            "foundNewFilter",
            "&inst"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefToInst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "369-402",
          "snippet": "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst)\n{\n    size_t i;\n    int ret = -1;\n\n    for (i = 0; i < def->nentries; i++) {\n        if (def->filterEntries[i]->rule) {\n            if (virNWFilterRuleDefToRuleInst(def,\n                                             def->filterEntries[i]->rule,\n                                             vars,\n                                             inst) < 0)\n                goto cleanup;\n        } else if (def->filterEntries[i]->include) {\n            if (virNWFilterIncludeDefToRuleInst(driver,\n                                                def->filterEntries[i]->include,\n                                                vars,\n                                                useNewFilter, foundNewFilter,\n                                                inst) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst)\n{\n    size_t i;\n    int ret = -1;\n\n    for (i = 0; i < def->nentries; i++) {\n        if (def->filterEntries[i]->rule) {\n            if (virNWFilterRuleDefToRuleInst(def,\n                                             def->filterEntries[i]->rule,\n                                             vars,\n                                             inst) < 0)\n                goto cleanup;\n        } else if (def->filterEntries[i]->include) {\n            if (virNWFilterIncludeDefToRuleInst(driver,\n                                                def->filterEntries[i]->include,\n                                                vars,\n                                                useNewFilter, foundNewFilter,\n                                                inst) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHasLearnReq",
          "args": [
            "ifindex"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHasLearnReq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "287-300",
          "snippet": "bool\nvirNWFilterHasLearnReq(int ifindex)\n{\n    void *res;\n    g_autofree char *ifindex_str = g_strdup_printf(\"%d\", ifindex);\n\n    virMutexLock(&pendingLearnReqLock);\n\n    res = virHashLookup(pendingLearnReq, ifindex_str);\n\n    virMutexUnlock(&pendingLearnReqLock);\n\n    return res != NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex pendingLearnReqLock = VIR_MUTEX_INITIALIZER;",
            "static virHashTablePtr pendingLearnReq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virMutex pendingLearnReqLock = VIR_MUTEX_INITIALIZER;\nstatic virHashTablePtr pendingLearnReq;\n\nbool\nvirNWFilterHasLearnReq(int ifindex)\n{\n    void *res;\n    g_autofree char *ifindex_str = g_strdup_printf(\"%d\", ifindex);\n\n    virMutexLock(&pendingLearnReqLock);\n\n    res = virHashLookup(pendingLearnReq, ifindex_str);\n\n    virMutexUnlock(&pendingLearnReqLock);\n\n    return res != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "missing_vars"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_PARSE_FAILED",
            "_(\"filter '%s' \"\n                                 \"learning value '%s' invalid.\")",
            "filter->name",
            "learning"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterLearnIPAddress",
          "args": [
            "techdriver",
            "binding",
            "ifindex",
            "driver",
            "DETECT_DHCP|DETECT_STATIC"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterLearnIPAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "756-768",
          "snippet": "int\nvirNWFilterLearnIPAddress(virNWFilterTechDriverPtr techdriver G_GNUC_UNUSED,\n                          virNWFilterBindingDefPtr binding G_GNUC_UNUSED,\n                          int ifindex G_GNUC_UNUSED,\n                          virNWFilterDriverStatePtr driver G_GNUC_UNUSED,\n                          int howDetect G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"IP parameter must be given since libvirt \"\n                     \"was not compiled with IP address learning \"\n                     \"support\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nint\nvirNWFilterLearnIPAddress(virNWFilterTechDriverPtr techdriver G_GNUC_UNUSED,\n                          virNWFilterBindingDefPtr binding G_GNUC_UNUSED,\n                          int ifindex G_GNUC_UNUSED,\n                          virNWFilterDriverStatePtr driver G_GNUC_UNUSED,\n                          int howDetect G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"IP parameter must be given since libvirt \"\n                     \"was not compiled with IP address learning \"\n                     \"support\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "learning",
            "\"any\""
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterDHCPSnoopReq",
          "args": [
            "techdriver",
            "binding",
            "driver"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDHCPSnoopReq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_dhcpsnoop.c",
          "lines": "2180-2190",
          "snippet": "int\nvirNWFilterDHCPSnoopReq(virNWFilterTechDriverPtr techdriver G_GNUC_UNUSED,\n                        virNWFilterBindingDefPtr binding G_GNUC_UNUSED,\n                        virNWFilterDriverStatePtr driver G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"libvirt was not compiled with libpcap and \\\"\"\n                     NWFILTER_VARNAME_CTRL_IP_LEARNING\n                     \"='dhcp'\\\" requires it.\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <net/if.h>",
            "#include <poll.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"configmake.h\"\n#include \"virthreadpool.h\"\n#include \"virsocketaddr.h\"\n#include \"virfile.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <net/if.h>\n#include <poll.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nint\nvirNWFilterDHCPSnoopReq(virNWFilterTechDriverPtr techdriver G_GNUC_UNUSED,\n                        virNWFilterBindingDefPtr binding G_GNUC_UNUSED,\n                        virNWFilterDriverStatePtr driver G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"libvirt was not compiled with libpcap and \\\"\"\n                     NWFILTER_VARNAME_CTRL_IP_LEARNING\n                     \"='dhcp'\\\" requires it.\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "learning",
            "\"dhcp\""
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "learning",
            "\"none\""
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "missing_vars",
            "NWFILTER_STD_VAR_IP"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetNthValue",
          "args": [
            "lv",
            "0"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetNthValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "142-164",
          "snippet": "const char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDetermineMissingVarsRec",
          "args": [
            "filter",
            "binding->filterparams",
            "missing_vars",
            "useNewFilter",
            "driver"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDetermineMissingVarsRec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "405-486",
          "snippet": "static int\nvirNWFilterDetermineMissingVarsRec(virNWFilterDefPtr filter,\n                                   virHashTablePtr vars,\n                                   virHashTablePtr missing_vars,\n                                   int useNewFilter,\n                                   virNWFilterDriverStatePtr driver)\n{\n    virNWFilterObjPtr obj;\n    int rc = 0;\n    size_t i, j;\n    virNWFilterDefPtr next_filter;\n    virNWFilterDefPtr newNext_filter;\n    virNWFilterVarValuePtr val;\n    virHashTablePtr tmpvars;\n\n    for (i = 0; i < filter->nentries; i++) {\n        virNWFilterRuleDefPtr    rule = filter->filterEntries[i]->rule;\n        virNWFilterIncludeDefPtr inc  = filter->filterEntries[i]->include;\n        if (rule) {\n            /* check all variables of this rule */\n            for (j = 0; j < rule->nVarAccess; j++) {\n                if (!virNWFilterVarAccessIsAvailable(rule->varAccess[j],\n                                                     vars)) {\n                    char *varAccess;\n                    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n                    virNWFilterVarAccessPrint(rule->varAccess[j], &buf);\n\n                    val = virNWFilterVarValueCreateSimpleCopyValue(\"1\");\n                    if (!val) {\n                        virBufferFreeAndReset(&buf);\n                        return -1;\n                    }\n\n                    varAccess = virBufferContentAndReset(&buf);\n                    rc = virHashUpdateEntry(missing_vars, varAccess, val);\n                    VIR_FREE(varAccess);\n                    if (rc < 0) {\n                        virNWFilterVarValueFree(val);\n                        return -1;\n                    }\n                }\n            }\n        } else if (inc) {\n            VIR_DEBUG(\"Following filter %s\", inc->filterref);\n            if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                                inc->filterref)))\n                return -1;\n\n            /* create a temporary hashmap for depth-first tree traversal */\n            if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params, vars))) {\n                virNWFilterObjUnlock(obj);\n                return -1;\n            }\n\n            next_filter = virNWFilterObjGetDef(obj);\n\n            switch (useNewFilter) {\n            case INSTANTIATE_FOLLOW_NEWFILTER:\n                newNext_filter = virNWFilterObjGetNewDef(obj);\n                if (newNext_filter)\n                    next_filter = newNext_filter;\n                break;\n            case INSTANTIATE_ALWAYS:\n                break;\n            }\n\n            rc = virNWFilterDetermineMissingVarsRec(next_filter,\n                                                    tmpvars,\n                                                    missing_vars,\n                                                    useNewFilter,\n                                                    driver);\n\n            virHashFree(tmpvars);\n\n            virNWFilterObjUnlock(obj);\n            if (rc < 0)\n                return -1;\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDetermineMissingVarsRec(virNWFilterDefPtr filter,\n                                   virHashTablePtr vars,\n                                   virHashTablePtr missing_vars,\n                                   int useNewFilter,\n                                   virNWFilterDriverStatePtr driver)\n{\n    virNWFilterObjPtr obj;\n    int rc = 0;\n    size_t i, j;\n    virNWFilterDefPtr next_filter;\n    virNWFilterDefPtr newNext_filter;\n    virNWFilterVarValuePtr val;\n    virHashTablePtr tmpvars;\n\n    for (i = 0; i < filter->nentries; i++) {\n        virNWFilterRuleDefPtr    rule = filter->filterEntries[i]->rule;\n        virNWFilterIncludeDefPtr inc  = filter->filterEntries[i]->include;\n        if (rule) {\n            /* check all variables of this rule */\n            for (j = 0; j < rule->nVarAccess; j++) {\n                if (!virNWFilterVarAccessIsAvailable(rule->varAccess[j],\n                                                     vars)) {\n                    char *varAccess;\n                    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n                    virNWFilterVarAccessPrint(rule->varAccess[j], &buf);\n\n                    val = virNWFilterVarValueCreateSimpleCopyValue(\"1\");\n                    if (!val) {\n                        virBufferFreeAndReset(&buf);\n                        return -1;\n                    }\n\n                    varAccess = virBufferContentAndReset(&buf);\n                    rc = virHashUpdateEntry(missing_vars, varAccess, val);\n                    VIR_FREE(varAccess);\n                    if (rc < 0) {\n                        virNWFilterVarValueFree(val);\n                        return -1;\n                    }\n                }\n            }\n        } else if (inc) {\n            VIR_DEBUG(\"Following filter %s\", inc->filterref);\n            if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                                inc->filterref)))\n                return -1;\n\n            /* create a temporary hashmap for depth-first tree traversal */\n            if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params, vars))) {\n                virNWFilterObjUnlock(obj);\n                return -1;\n            }\n\n            next_filter = virNWFilterObjGetDef(obj);\n\n            switch (useNewFilter) {\n            case INSTANTIATE_FOLLOW_NEWFILTER:\n                newNext_filter = virNWFilterObjGetNewDef(obj);\n                if (newNext_filter)\n                    next_filter = newNext_filter;\n                break;\n            case INSTANTIATE_ALWAYS:\n                break;\n            }\n\n            rc = virNWFilterDetermineMissingVarsRec(next_filter,\n                                                    tmpvars,\n                                                    missing_vars,\n                                                    useNewFilter,\n                                                    driver);\n\n            virHashFree(tmpvars);\n\n            virNWFilterObjUnlock(obj);\n            if (rc < 0)\n                return -1;\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&inst",
            "0",
            "sizeof(inst)"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTableCreate",
          "args": [
            "0"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTableCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "628-632",
          "snippet": "virHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define NWFILTER_DFLT_LEARN  \"any\"\n#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterDoInstantiate(virNWFilterTechDriverPtr techdriver,\n                         virNWFilterBindingDefPtr binding,\n                         virNWFilterDefPtr filter,\n                         int ifindex,\n                         enum instCase useNewFilter,\n                         bool *foundNewFilter,\n                         bool teardownOld,\n                         virNWFilterDriverStatePtr driver,\n                         bool forceWithPendingReq)\n{\n    int rc;\n    virNWFilterInst inst;\n    bool instantiate = true;\n    char *buf;\n    virNWFilterVarValuePtr lv;\n    const char *learning;\n    bool reportIP = false;\n\n    virHashTablePtr missing_vars = virNWFilterHashTableCreate(0);\n\n    memset(&inst, 0, sizeof(inst));\n\n    if (!missing_vars) {\n        rc = -1;\n        goto err_exit;\n    }\n\n    rc = virNWFilterDetermineMissingVarsRec(filter,\n                                            binding->filterparams,\n                                            missing_vars,\n                                            useNewFilter,\n                                            driver);\n    if (rc < 0)\n        goto err_exit;\n\n    lv = virHashLookup(binding->filterparams, NWFILTER_VARNAME_CTRL_IP_LEARNING);\n    if (lv)\n        learning = virNWFilterVarValueGetNthValue(lv, 0);\n    else\n        learning = NULL;\n\n    if (learning == NULL)\n        learning = NWFILTER_DFLT_LEARN;\n\n    if (virHashSize(missing_vars) == 1) {\n        if (virHashLookup(missing_vars,\n                          NWFILTER_STD_VAR_IP) != NULL) {\n            if (STRCASEEQ(learning, \"none\")) {        /* no learning */\n                reportIP = true;\n                goto err_unresolvable_vars;\n            }\n            if (STRCASEEQ(learning, \"dhcp\")) {\n                rc = virNWFilterDHCPSnoopReq(techdriver,\n                                             binding,\n                                             driver);\n                goto err_exit;\n            } else if (STRCASEEQ(learning, \"any\")) {\n                if (!virNWFilterHasLearnReq(ifindex)) {\n                    rc = virNWFilterLearnIPAddress(techdriver,\n                                                   binding,\n                                                   ifindex,\n                                                   driver,\n                                                   DETECT_DHCP|DETECT_STATIC);\n                }\n                goto err_exit;\n            } else {\n                rc = -1;\n                virReportError(VIR_ERR_PARSE_FAILED,\n                               _(\"filter '%s' \"\n                                 \"learning value '%s' invalid.\"),\n                               filter->name, learning);\n                goto err_exit;\n            }\n        } else {\n            goto err_unresolvable_vars;\n        }\n    } else if (virHashSize(missing_vars) > 1) {\n        goto err_unresolvable_vars;\n    } else if (!forceWithPendingReq &&\n               virNWFilterHasLearnReq(ifindex)) {\n        goto err_exit;\n    }\n\n    rc = virNWFilterDefToInst(driver,\n                              filter,\n                              binding->filterparams,\n                              useNewFilter, foundNewFilter,\n                              &inst);\n\n    if (rc < 0)\n        goto err_exit;\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        instantiate = *foundNewFilter;\n        break;\n    case INSTANTIATE_ALWAYS:\n        instantiate = true;\n        break;\n    }\n\n    if (instantiate) {\n        if (virNWFilterLockIface(binding->portdevname) < 0)\n            goto err_exit;\n\n        rc = techdriver->applyNewRules(binding->portdevname, inst.rules, inst.nrules);\n\n        if (teardownOld && rc == 0)\n            techdriver->tearOldRules(binding->portdevname);\n\n        if (rc == 0 && (virNetDevValidateConfig(binding->portdevname, NULL, ifindex) <= 0)) {\n            virResetLastError();\n            /* interface changed/disappeared */\n            techdriver->allTeardown(binding->portdevname);\n            rc = -1;\n        }\n\n        virNWFilterUnlockIface(binding->portdevname);\n    }\n\n err_exit:\n    virNWFilterInstReset(&inst);\n    virHashFree(missing_vars);\n\n    return rc;\n\n err_unresolvable_vars:\n\n    buf = virNWFilterPrintVars(missing_vars, \", \", false, reportIP);\n    if (buf) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot instantiate filter due to unresolvable \"\n                         \"variables or unavailable list elements: %s\"), buf);\n        VIR_FREE(buf);\n    }\n\n    rc = -1;\n    goto err_exit;\n}"
  },
  {
    "function_name": "virNWFilterDetermineMissingVarsRec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "405-486",
    "snippet": "static int\nvirNWFilterDetermineMissingVarsRec(virNWFilterDefPtr filter,\n                                   virHashTablePtr vars,\n                                   virHashTablePtr missing_vars,\n                                   int useNewFilter,\n                                   virNWFilterDriverStatePtr driver)\n{\n    virNWFilterObjPtr obj;\n    int rc = 0;\n    size_t i, j;\n    virNWFilterDefPtr next_filter;\n    virNWFilterDefPtr newNext_filter;\n    virNWFilterVarValuePtr val;\n    virHashTablePtr tmpvars;\n\n    for (i = 0; i < filter->nentries; i++) {\n        virNWFilterRuleDefPtr    rule = filter->filterEntries[i]->rule;\n        virNWFilterIncludeDefPtr inc  = filter->filterEntries[i]->include;\n        if (rule) {\n            /* check all variables of this rule */\n            for (j = 0; j < rule->nVarAccess; j++) {\n                if (!virNWFilterVarAccessIsAvailable(rule->varAccess[j],\n                                                     vars)) {\n                    char *varAccess;\n                    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n                    virNWFilterVarAccessPrint(rule->varAccess[j], &buf);\n\n                    val = virNWFilterVarValueCreateSimpleCopyValue(\"1\");\n                    if (!val) {\n                        virBufferFreeAndReset(&buf);\n                        return -1;\n                    }\n\n                    varAccess = virBufferContentAndReset(&buf);\n                    rc = virHashUpdateEntry(missing_vars, varAccess, val);\n                    VIR_FREE(varAccess);\n                    if (rc < 0) {\n                        virNWFilterVarValueFree(val);\n                        return -1;\n                    }\n                }\n            }\n        } else if (inc) {\n            VIR_DEBUG(\"Following filter %s\", inc->filterref);\n            if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                                inc->filterref)))\n                return -1;\n\n            /* create a temporary hashmap for depth-first tree traversal */\n            if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params, vars))) {\n                virNWFilterObjUnlock(obj);\n                return -1;\n            }\n\n            next_filter = virNWFilterObjGetDef(obj);\n\n            switch (useNewFilter) {\n            case INSTANTIATE_FOLLOW_NEWFILTER:\n                newNext_filter = virNWFilterObjGetNewDef(obj);\n                if (newNext_filter)\n                    next_filter = newNext_filter;\n                break;\n            case INSTANTIATE_ALWAYS:\n                break;\n            }\n\n            rc = virNWFilterDetermineMissingVarsRec(next_filter,\n                                                    tmpvars,\n                                                    missing_vars,\n                                                    useNewFilter,\n                                                    driver);\n\n            virHashFree(tmpvars);\n\n            virNWFilterObjUnlock(obj);\n            if (rc < 0)\n                return -1;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "tmpvars"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDetermineMissingVarsRec",
          "args": [
            "next_filter",
            "tmpvars",
            "missing_vars",
            "useNewFilter",
            "driver"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDetermineMissingVarsRec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "405-486",
          "snippet": "static int\nvirNWFilterDetermineMissingVarsRec(virNWFilterDefPtr filter,\n                                   virHashTablePtr vars,\n                                   virHashTablePtr missing_vars,\n                                   int useNewFilter,\n                                   virNWFilterDriverStatePtr driver)\n{\n    virNWFilterObjPtr obj;\n    int rc = 0;\n    size_t i, j;\n    virNWFilterDefPtr next_filter;\n    virNWFilterDefPtr newNext_filter;\n    virNWFilterVarValuePtr val;\n    virHashTablePtr tmpvars;\n\n    for (i = 0; i < filter->nentries; i++) {\n        virNWFilterRuleDefPtr    rule = filter->filterEntries[i]->rule;\n        virNWFilterIncludeDefPtr inc  = filter->filterEntries[i]->include;\n        if (rule) {\n            /* check all variables of this rule */\n            for (j = 0; j < rule->nVarAccess; j++) {\n                if (!virNWFilterVarAccessIsAvailable(rule->varAccess[j],\n                                                     vars)) {\n                    char *varAccess;\n                    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n                    virNWFilterVarAccessPrint(rule->varAccess[j], &buf);\n\n                    val = virNWFilterVarValueCreateSimpleCopyValue(\"1\");\n                    if (!val) {\n                        virBufferFreeAndReset(&buf);\n                        return -1;\n                    }\n\n                    varAccess = virBufferContentAndReset(&buf);\n                    rc = virHashUpdateEntry(missing_vars, varAccess, val);\n                    VIR_FREE(varAccess);\n                    if (rc < 0) {\n                        virNWFilterVarValueFree(val);\n                        return -1;\n                    }\n                }\n            }\n        } else if (inc) {\n            VIR_DEBUG(\"Following filter %s\", inc->filterref);\n            if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                                inc->filterref)))\n                return -1;\n\n            /* create a temporary hashmap for depth-first tree traversal */\n            if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params, vars))) {\n                virNWFilterObjUnlock(obj);\n                return -1;\n            }\n\n            next_filter = virNWFilterObjGetDef(obj);\n\n            switch (useNewFilter) {\n            case INSTANTIATE_FOLLOW_NEWFILTER:\n                newNext_filter = virNWFilterObjGetNewDef(obj);\n                if (newNext_filter)\n                    next_filter = newNext_filter;\n                break;\n            case INSTANTIATE_ALWAYS:\n                break;\n            }\n\n            rc = virNWFilterDetermineMissingVarsRec(next_filter,\n                                                    tmpvars,\n                                                    missing_vars,\n                                                    useNewFilter,\n                                                    driver);\n\n            virHashFree(tmpvars);\n\n            virNWFilterObjUnlock(obj);\n            if (rc < 0)\n                return -1;\n        }\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetNewDef",
          "args": [
            "obj"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetNewDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "78-82",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetNewDef(virNWFilterObjPtr obj)\n{\n    return obj->newDef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetNewDef(virNWFilterObjPtr obj)\n{\n    return obj->newDef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetDef",
          "args": [
            "obj"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "71-75",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterCreateVarsFrom",
          "args": [
            "inc->params",
            "vars"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterCreateVarsFrom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "198-217",
          "snippet": "static virHashTablePtr\nvirNWFilterCreateVarsFrom(virHashTablePtr vars1,\n                          virHashTablePtr vars2)\n{\n    virHashTablePtr res = virNWFilterHashTableCreate(0);\n    if (!res)\n        return NULL;\n\n    if (virNWFilterHashTablePutAll(vars1, res) < 0)\n        goto err_exit;\n\n    if (virNWFilterHashTablePutAll(vars2, res) < 0)\n        goto err_exit;\n\n    return res;\n\n err_exit:\n    virHashFree(res);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virHashTablePtr\nvirNWFilterCreateVarsFrom(virHashTablePtr vars1,\n                          virHashTablePtr vars2)\n{\n    virHashTablePtr res = virNWFilterHashTableCreate(0);\n    if (!res)\n        return NULL;\n\n    if (virNWFilterHashTablePutAll(vars1, res) < 0)\n        goto err_exit;\n\n    if (virNWFilterHashTablePutAll(vars2, res) < 0)\n        goto err_exit;\n\n    return res;\n\n err_exit:\n    virHashFree(res);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindInstantiateFilter",
          "args": [
            "driver->nwfilters",
            "inc->filterref"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindInstantiateFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "193-213",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindInstantiateFilter(virNWFilterObjListPtr nwfilters,\n                                        const char *filtername)\n{\n    virNWFilterObjPtr obj;\n\n    if (!(obj = virNWFilterObjListFindByName(nwfilters, filtername))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"referenced filter '%s' is missing\"), filtername);\n        return NULL;\n    }\n\n    if (virNWFilterObjWantRemoved(obj)) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"Filter '%s' is in use.\"), filtername);\n        virNWFilterObjUnlock(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindInstantiateFilter(virNWFilterObjListPtr nwfilters,\n                                        const char *filtername)\n{\n    virNWFilterObjPtr obj;\n\n    if (!(obj = virNWFilterObjListFindByName(nwfilters, filtername))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"referenced filter '%s' is missing\"), filtername);\n        return NULL;\n    }\n\n    if (virNWFilterObjWantRemoved(obj)) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"Filter '%s' is in use.\"), filtername);\n        virNWFilterObjUnlock(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Following filter %s\"",
            "inc->filterref"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueFree",
          "args": [
            "val"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "43-64",
          "snippet": "void\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvoid\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "varAccess"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashUpdateEntry",
          "args": [
            "missing_vars",
            "varAccess",
            "val"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "virHashUpdateEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "422-427",
          "snippet": "int\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueCreateSimpleCopyValue",
          "args": [
            "\"1\""
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueCreateSimpleCopyValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "121-132",
          "snippet": "virNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessPrint",
          "args": [
            "rule->varAccess[j]",
            "&buf"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessPrint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "959-974",
          "snippet": "void\nvirNWFilterVarAccessPrint(virNWFilterVarAccessPtr vap, virBufferPtr buf)\n{\n    virBufferAdd(buf, vap->varName, -1);\n    switch (vap->accessType) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        virBufferAsprintf(buf, \"[%u]\", vap->u.index.idx);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        if (vap->u.iterId != 0)\n            virBufferAsprintf(buf, \"[@%u]\", vap->u.iterId);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        break;\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);\n\nvoid\nvirNWFilterVarAccessPrint(virNWFilterVarAccessPtr vap, virBufferPtr buf)\n{\n    virBufferAdd(buf, vap->varName, -1);\n    switch (vap->accessType) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        virBufferAsprintf(buf, \"[%u]\", vap->u.index.idx);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        if (vap->u.iterId != 0)\n            virBufferAsprintf(buf, \"[@%u]\", vap->u.iterId);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        break;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessIsAvailable",
          "args": [
            "rule->varAccess[j]",
            "vars"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessIsAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "1013-1040",
          "snippet": "bool\nvirNWFilterVarAccessIsAvailable(const virNWFilterVarAccess *varAccess,\n                                const virHashTable *hash)\n{\n    const char *varName = virNWFilterVarAccessGetVarName(varAccess);\n    const char *res;\n    unsigned int idx;\n    virNWFilterVarValuePtr varValue;\n\n    varValue = virHashLookup(hash, varName);\n    if (!varValue)\n        return false;\n\n    switch (virNWFilterVarAccessGetType(varAccess)) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        idx = virNWFilterVarAccessGetIndex(varAccess);\n        res = virNWFilterVarValueGetNthValue(varValue, idx);\n        if (res == NULL)\n            return false;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nbool\nvirNWFilterVarAccessIsAvailable(const virNWFilterVarAccess *varAccess,\n                                const virHashTable *hash)\n{\n    const char *varName = virNWFilterVarAccessGetVarName(varAccess);\n    const char *res;\n    unsigned int idx;\n    virNWFilterVarValuePtr varValue;\n\n    varValue = virHashLookup(hash, varName);\n    if (!varValue)\n        return false;\n\n    switch (virNWFilterVarAccessGetType(varAccess)) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        idx = virNWFilterVarAccessGetIndex(varAccess);\n        res = virNWFilterVarValueGetNthValue(varValue, idx);\n        if (res == NULL)\n            return false;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return false;\n    }\n\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDetermineMissingVarsRec(virNWFilterDefPtr filter,\n                                   virHashTablePtr vars,\n                                   virHashTablePtr missing_vars,\n                                   int useNewFilter,\n                                   virNWFilterDriverStatePtr driver)\n{\n    virNWFilterObjPtr obj;\n    int rc = 0;\n    size_t i, j;\n    virNWFilterDefPtr next_filter;\n    virNWFilterDefPtr newNext_filter;\n    virNWFilterVarValuePtr val;\n    virHashTablePtr tmpvars;\n\n    for (i = 0; i < filter->nentries; i++) {\n        virNWFilterRuleDefPtr    rule = filter->filterEntries[i]->rule;\n        virNWFilterIncludeDefPtr inc  = filter->filterEntries[i]->include;\n        if (rule) {\n            /* check all variables of this rule */\n            for (j = 0; j < rule->nVarAccess; j++) {\n                if (!virNWFilterVarAccessIsAvailable(rule->varAccess[j],\n                                                     vars)) {\n                    char *varAccess;\n                    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n                    virNWFilterVarAccessPrint(rule->varAccess[j], &buf);\n\n                    val = virNWFilterVarValueCreateSimpleCopyValue(\"1\");\n                    if (!val) {\n                        virBufferFreeAndReset(&buf);\n                        return -1;\n                    }\n\n                    varAccess = virBufferContentAndReset(&buf);\n                    rc = virHashUpdateEntry(missing_vars, varAccess, val);\n                    VIR_FREE(varAccess);\n                    if (rc < 0) {\n                        virNWFilterVarValueFree(val);\n                        return -1;\n                    }\n                }\n            }\n        } else if (inc) {\n            VIR_DEBUG(\"Following filter %s\", inc->filterref);\n            if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                                inc->filterref)))\n                return -1;\n\n            /* create a temporary hashmap for depth-first tree traversal */\n            if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params, vars))) {\n                virNWFilterObjUnlock(obj);\n                return -1;\n            }\n\n            next_filter = virNWFilterObjGetDef(obj);\n\n            switch (useNewFilter) {\n            case INSTANTIATE_FOLLOW_NEWFILTER:\n                newNext_filter = virNWFilterObjGetNewDef(obj);\n                if (newNext_filter)\n                    next_filter = newNext_filter;\n                break;\n            case INSTANTIATE_ALWAYS:\n                break;\n            }\n\n            rc = virNWFilterDetermineMissingVarsRec(next_filter,\n                                                    tmpvars,\n                                                    missing_vars,\n                                                    useNewFilter,\n                                                    driver);\n\n            virHashFree(tmpvars);\n\n            virNWFilterObjUnlock(obj);\n            if (rc < 0)\n                return -1;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterDefToInst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "369-402",
    "snippet": "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst)\n{\n    size_t i;\n    int ret = -1;\n\n    for (i = 0; i < def->nentries; i++) {\n        if (def->filterEntries[i]->rule) {\n            if (virNWFilterRuleDefToRuleInst(def,\n                                             def->filterEntries[i]->rule,\n                                             vars,\n                                             inst) < 0)\n                goto cleanup;\n        } else if (def->filterEntries[i]->include) {\n            if (virNWFilterIncludeDefToRuleInst(driver,\n                                                def->filterEntries[i]->include,\n                                                vars,\n                                                useNewFilter, foundNewFilter,\n                                                inst) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterInstReset",
          "args": [
            "inst"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "230-243",
          "snippet": "static void\nvirNWFilterInstReset(virNWFilterInstPtr inst)\n{\n    size_t i;\n\n    for (i = 0; i < inst->nfilters; i++)\n        virNWFilterObjUnlock(inst->filters[i]);\n    VIR_FREE(inst->filters);\n    inst->nfilters = 0;\n\n    for (i = 0; i < inst->nrules; i++)\n        virNWFilterRuleInstFree(inst->rules[i]);\n    VIR_FREE(inst->rules);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic void\nvirNWFilterInstReset(virNWFilterInstPtr inst)\n{\n    size_t i;\n\n    for (i = 0; i < inst->nfilters; i++)\n        virNWFilterObjUnlock(inst->filters[i]);\n    VIR_FREE(inst->filters);\n    inst->nfilters = 0;\n\n    for (i = 0; i < inst->nrules; i++)\n        virNWFilterRuleInstFree(inst->rules[i]);\n    VIR_FREE(inst->rules);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterIncludeDefToRuleInst",
          "args": [
            "driver",
            "def->filterEntries[i]->include",
            "vars",
            "useNewFilter",
            "foundNewFilter",
            "inst"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterIncludeDefToRuleInst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "288-348",
          "snippet": "static int\nvirNWFilterIncludeDefToRuleInst(virNWFilterDriverStatePtr driver,\n                                virNWFilterIncludeDefPtr inc,\n                                virHashTablePtr vars,\n                                enum instCase useNewFilter,\n                                bool *foundNewFilter,\n                                virNWFilterInstPtr inst)\n{\n    virNWFilterObjPtr obj;\n    virHashTablePtr tmpvars = NULL;\n    virNWFilterDefPtr childdef;\n    virNWFilterDefPtr newChilddef;\n    int ret = -1;\n\n    VIR_DEBUG(\"Instantiating filter %s\", inc->filterref);\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        inc->filterref)))\n        goto cleanup;\n\n    /* create a temporary hashmap for depth-first tree traversal */\n    if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params,\n                                              vars)))\n        goto cleanup;\n\n    childdef = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newChilddef = virNWFilterObjGetNewDef(obj);\n        if (newChilddef) {\n            childdef = newChilddef;\n            *foundNewFilter = true;\n        }\n        break;\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    if (VIR_APPEND_ELEMENT(inst->filters,\n                           inst->nfilters,\n                           obj) < 0)\n        goto cleanup;\n    obj = NULL;\n\n    if (virNWFilterDefToInst(driver,\n                             childdef,\n                             tmpvars,\n                             useNewFilter,\n                             foundNewFilter,\n                             inst) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    virHashFree(tmpvars);\n    if (obj)\n        virNWFilterObjUnlock(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterIncludeDefToRuleInst(virNWFilterDriverStatePtr driver,\n                                virNWFilterIncludeDefPtr inc,\n                                virHashTablePtr vars,\n                                enum instCase useNewFilter,\n                                bool *foundNewFilter,\n                                virNWFilterInstPtr inst)\n{\n    virNWFilterObjPtr obj;\n    virHashTablePtr tmpvars = NULL;\n    virNWFilterDefPtr childdef;\n    virNWFilterDefPtr newChilddef;\n    int ret = -1;\n\n    VIR_DEBUG(\"Instantiating filter %s\", inc->filterref);\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        inc->filterref)))\n        goto cleanup;\n\n    /* create a temporary hashmap for depth-first tree traversal */\n    if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params,\n                                              vars)))\n        goto cleanup;\n\n    childdef = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newChilddef = virNWFilterObjGetNewDef(obj);\n        if (newChilddef) {\n            childdef = newChilddef;\n            *foundNewFilter = true;\n        }\n        break;\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    if (VIR_APPEND_ELEMENT(inst->filters,\n                           inst->nfilters,\n                           obj) < 0)\n        goto cleanup;\n    obj = NULL;\n\n    if (virNWFilterDefToInst(driver,\n                             childdef,\n                             tmpvars,\n                             useNewFilter,\n                             foundNewFilter,\n                             inst) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    virHashFree(tmpvars);\n    if (obj)\n        virNWFilterObjUnlock(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterRuleDefToRuleInst",
          "args": [
            "def",
            "def->filterEntries[i]->rule",
            "vars",
            "inst"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterRuleDefToRuleInst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "255-285",
          "snippet": "static int\nvirNWFilterRuleDefToRuleInst(virNWFilterDefPtr def,\n                             virNWFilterRuleDefPtr rule,\n                             virHashTablePtr vars,\n                             virNWFilterInstPtr inst)\n{\n    virNWFilterRuleInstPtr ruleinst;\n    int ret = -1;\n\n    if (VIR_ALLOC(ruleinst) < 0)\n        goto cleanup;\n\n    ruleinst->chainSuffix = def->chainsuffix;\n    ruleinst->chainPriority = def->chainPriority;\n    ruleinst->def = rule;\n    ruleinst->priority = rule->priority;\n    if (!(ruleinst->vars = virNWFilterHashTableCreate(0)))\n        goto cleanup;\n    if (virNWFilterHashTablePutAll(vars, ruleinst->vars) < 0)\n        goto cleanup;\n\n    if (VIR_APPEND_ELEMENT(inst->rules,\n                           inst->nrules,\n                           ruleinst) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virNWFilterRuleInstFree(ruleinst);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterRuleDefToRuleInst(virNWFilterDefPtr def,\n                             virNWFilterRuleDefPtr rule,\n                             virHashTablePtr vars,\n                             virNWFilterInstPtr inst)\n{\n    virNWFilterRuleInstPtr ruleinst;\n    int ret = -1;\n\n    if (VIR_ALLOC(ruleinst) < 0)\n        goto cleanup;\n\n    ruleinst->chainSuffix = def->chainsuffix;\n    ruleinst->chainPriority = def->chainPriority;\n    ruleinst->def = rule;\n    ruleinst->priority = rule->priority;\n    if (!(ruleinst->vars = virNWFilterHashTableCreate(0)))\n        goto cleanup;\n    if (virNWFilterHashTablePutAll(vars, ruleinst->vars) < 0)\n        goto cleanup;\n\n    if (VIR_APPEND_ELEMENT(inst->rules,\n                           inst->nrules,\n                           ruleinst) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virNWFilterRuleInstFree(ruleinst);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst)\n{\n    size_t i;\n    int ret = -1;\n\n    for (i = 0; i < def->nentries; i++) {\n        if (def->filterEntries[i]->rule) {\n            if (virNWFilterRuleDefToRuleInst(def,\n                                             def->filterEntries[i]->rule,\n                                             vars,\n                                             inst) < 0)\n                goto cleanup;\n        } else if (def->filterEntries[i]->include) {\n            if (virNWFilterIncludeDefToRuleInst(driver,\n                                                def->filterEntries[i]->include,\n                                                vars,\n                                                useNewFilter, foundNewFilter,\n                                                inst) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterIncludeDefToRuleInst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "288-348",
    "snippet": "static int\nvirNWFilterIncludeDefToRuleInst(virNWFilterDriverStatePtr driver,\n                                virNWFilterIncludeDefPtr inc,\n                                virHashTablePtr vars,\n                                enum instCase useNewFilter,\n                                bool *foundNewFilter,\n                                virNWFilterInstPtr inst)\n{\n    virNWFilterObjPtr obj;\n    virHashTablePtr tmpvars = NULL;\n    virNWFilterDefPtr childdef;\n    virNWFilterDefPtr newChilddef;\n    int ret = -1;\n\n    VIR_DEBUG(\"Instantiating filter %s\", inc->filterref);\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        inc->filterref)))\n        goto cleanup;\n\n    /* create a temporary hashmap for depth-first tree traversal */\n    if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params,\n                                              vars)))\n        goto cleanup;\n\n    childdef = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newChilddef = virNWFilterObjGetNewDef(obj);\n        if (newChilddef) {\n            childdef = newChilddef;\n            *foundNewFilter = true;\n        }\n        break;\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    if (VIR_APPEND_ELEMENT(inst->filters,\n                           inst->nfilters,\n                           obj) < 0)\n        goto cleanup;\n    obj = NULL;\n\n    if (virNWFilterDefToInst(driver,\n                             childdef,\n                             tmpvars,\n                             useNewFilter,\n                             foundNewFilter,\n                             inst) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    virHashFree(tmpvars);\n    if (obj)\n        virNWFilterObjUnlock(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "tmpvars"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterInstReset",
          "args": [
            "inst"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "230-243",
          "snippet": "static void\nvirNWFilterInstReset(virNWFilterInstPtr inst)\n{\n    size_t i;\n\n    for (i = 0; i < inst->nfilters; i++)\n        virNWFilterObjUnlock(inst->filters[i]);\n    VIR_FREE(inst->filters);\n    inst->nfilters = 0;\n\n    for (i = 0; i < inst->nrules; i++)\n        virNWFilterRuleInstFree(inst->rules[i]);\n    VIR_FREE(inst->rules);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic void\nvirNWFilterInstReset(virNWFilterInstPtr inst)\n{\n    size_t i;\n\n    for (i = 0; i < inst->nfilters; i++)\n        virNWFilterObjUnlock(inst->filters[i]);\n    VIR_FREE(inst->filters);\n    inst->nfilters = 0;\n\n    for (i = 0; i < inst->nrules; i++)\n        virNWFilterRuleInstFree(inst->rules[i]);\n    VIR_FREE(inst->rules);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDefToInst",
          "args": [
            "driver",
            "childdef",
            "tmpvars",
            "useNewFilter",
            "foundNewFilter",
            "inst"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefToInst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "369-402",
          "snippet": "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst)\n{\n    size_t i;\n    int ret = -1;\n\n    for (i = 0; i < def->nentries; i++) {\n        if (def->filterEntries[i]->rule) {\n            if (virNWFilterRuleDefToRuleInst(def,\n                                             def->filterEntries[i]->rule,\n                                             vars,\n                                             inst) < 0)\n                goto cleanup;\n        } else if (def->filterEntries[i]->include) {\n            if (virNWFilterIncludeDefToRuleInst(driver,\n                                                def->filterEntries[i]->include,\n                                                vars,\n                                                useNewFilter, foundNewFilter,\n                                                inst) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst)\n{\n    size_t i;\n    int ret = -1;\n\n    for (i = 0; i < def->nentries; i++) {\n        if (def->filterEntries[i]->rule) {\n            if (virNWFilterRuleDefToRuleInst(def,\n                                             def->filterEntries[i]->rule,\n                                             vars,\n                                             inst) < 0)\n                goto cleanup;\n        } else if (def->filterEntries[i]->include) {\n            if (virNWFilterIncludeDefToRuleInst(driver,\n                                                def->filterEntries[i]->include,\n                                                vars,\n                                                useNewFilter, foundNewFilter,\n                                                inst) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "inst->filters",
            "inst->nfilters",
            "obj"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetNewDef",
          "args": [
            "obj"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetNewDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "78-82",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetNewDef(virNWFilterObjPtr obj)\n{\n    return obj->newDef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetNewDef(virNWFilterObjPtr obj)\n{\n    return obj->newDef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetDef",
          "args": [
            "obj"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "71-75",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterCreateVarsFrom",
          "args": [
            "inc->params",
            "vars"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterCreateVarsFrom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "198-217",
          "snippet": "static virHashTablePtr\nvirNWFilterCreateVarsFrom(virHashTablePtr vars1,\n                          virHashTablePtr vars2)\n{\n    virHashTablePtr res = virNWFilterHashTableCreate(0);\n    if (!res)\n        return NULL;\n\n    if (virNWFilterHashTablePutAll(vars1, res) < 0)\n        goto err_exit;\n\n    if (virNWFilterHashTablePutAll(vars2, res) < 0)\n        goto err_exit;\n\n    return res;\n\n err_exit:\n    virHashFree(res);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virHashTablePtr\nvirNWFilterCreateVarsFrom(virHashTablePtr vars1,\n                          virHashTablePtr vars2)\n{\n    virHashTablePtr res = virNWFilterHashTableCreate(0);\n    if (!res)\n        return NULL;\n\n    if (virNWFilterHashTablePutAll(vars1, res) < 0)\n        goto err_exit;\n\n    if (virNWFilterHashTablePutAll(vars2, res) < 0)\n        goto err_exit;\n\n    return res;\n\n err_exit:\n    virHashFree(res);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindInstantiateFilter",
          "args": [
            "driver->nwfilters",
            "inc->filterref"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindInstantiateFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "193-213",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindInstantiateFilter(virNWFilterObjListPtr nwfilters,\n                                        const char *filtername)\n{\n    virNWFilterObjPtr obj;\n\n    if (!(obj = virNWFilterObjListFindByName(nwfilters, filtername))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"referenced filter '%s' is missing\"), filtername);\n        return NULL;\n    }\n\n    if (virNWFilterObjWantRemoved(obj)) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"Filter '%s' is in use.\"), filtername);\n        virNWFilterObjUnlock(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindInstantiateFilter(virNWFilterObjListPtr nwfilters,\n                                        const char *filtername)\n{\n    virNWFilterObjPtr obj;\n\n    if (!(obj = virNWFilterObjListFindByName(nwfilters, filtername))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"referenced filter '%s' is missing\"), filtername);\n        return NULL;\n    }\n\n    if (virNWFilterObjWantRemoved(obj)) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"Filter '%s' is in use.\"), filtername);\n        virNWFilterObjUnlock(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Instantiating filter %s\"",
            "inc->filterref"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterIncludeDefToRuleInst(virNWFilterDriverStatePtr driver,\n                                virNWFilterIncludeDefPtr inc,\n                                virHashTablePtr vars,\n                                enum instCase useNewFilter,\n                                bool *foundNewFilter,\n                                virNWFilterInstPtr inst)\n{\n    virNWFilterObjPtr obj;\n    virHashTablePtr tmpvars = NULL;\n    virNWFilterDefPtr childdef;\n    virNWFilterDefPtr newChilddef;\n    int ret = -1;\n\n    VIR_DEBUG(\"Instantiating filter %s\", inc->filterref);\n    if (!(obj = virNWFilterObjListFindInstantiateFilter(driver->nwfilters,\n                                                        inc->filterref)))\n        goto cleanup;\n\n    /* create a temporary hashmap for depth-first tree traversal */\n    if (!(tmpvars = virNWFilterCreateVarsFrom(inc->params,\n                                              vars)))\n        goto cleanup;\n\n    childdef = virNWFilterObjGetDef(obj);\n\n    switch (useNewFilter) {\n    case INSTANTIATE_FOLLOW_NEWFILTER:\n        newChilddef = virNWFilterObjGetNewDef(obj);\n        if (newChilddef) {\n            childdef = newChilddef;\n            *foundNewFilter = true;\n        }\n        break;\n    case INSTANTIATE_ALWAYS:\n        break;\n    }\n\n    if (VIR_APPEND_ELEMENT(inst->filters,\n                           inst->nfilters,\n                           obj) < 0)\n        goto cleanup;\n    obj = NULL;\n\n    if (virNWFilterDefToInst(driver,\n                             childdef,\n                             tmpvars,\n                             useNewFilter,\n                             foundNewFilter,\n                             inst) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        virNWFilterInstReset(inst);\n    virHashFree(tmpvars);\n    if (obj)\n        virNWFilterObjUnlock(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterRuleDefToRuleInst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "255-285",
    "snippet": "static int\nvirNWFilterRuleDefToRuleInst(virNWFilterDefPtr def,\n                             virNWFilterRuleDefPtr rule,\n                             virHashTablePtr vars,\n                             virNWFilterInstPtr inst)\n{\n    virNWFilterRuleInstPtr ruleinst;\n    int ret = -1;\n\n    if (VIR_ALLOC(ruleinst) < 0)\n        goto cleanup;\n\n    ruleinst->chainSuffix = def->chainsuffix;\n    ruleinst->chainPriority = def->chainPriority;\n    ruleinst->def = rule;\n    ruleinst->priority = rule->priority;\n    if (!(ruleinst->vars = virNWFilterHashTableCreate(0)))\n        goto cleanup;\n    if (virNWFilterHashTablePutAll(vars, ruleinst->vars) < 0)\n        goto cleanup;\n\n    if (VIR_APPEND_ELEMENT(inst->rules,\n                           inst->nrules,\n                           ruleinst) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virNWFilterRuleInstFree(ruleinst);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterRuleInstFree",
          "args": [
            "ruleinst"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterRuleInstFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "118-126",
          "snippet": "static void\nvirNWFilterRuleInstFree(virNWFilterRuleInstPtr inst)\n{\n    if (!inst)\n        return;\n\n    virHashFree(inst->vars);\n    VIR_FREE(inst);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic void\nvirNWFilterRuleInstFree(virNWFilterRuleInstPtr inst)\n{\n    if (!inst)\n        return;\n\n    virHashFree(inst->vars);\n    VIR_FREE(inst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "inst->rules",
            "inst->nrules",
            "ruleinst"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTablePutAll",
          "args": [
            "vars",
            "ruleinst->vars"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTablePutAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "664-678",
          "snippet": "int\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTableCreate",
          "args": [
            "0"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTableCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "628-632",
          "snippet": "virHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ruleinst"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic int\nvirNWFilterRuleDefToRuleInst(virNWFilterDefPtr def,\n                             virNWFilterRuleDefPtr rule,\n                             virHashTablePtr vars,\n                             virNWFilterInstPtr inst)\n{\n    virNWFilterRuleInstPtr ruleinst;\n    int ret = -1;\n\n    if (VIR_ALLOC(ruleinst) < 0)\n        goto cleanup;\n\n    ruleinst->chainSuffix = def->chainsuffix;\n    ruleinst->chainPriority = def->chainPriority;\n    ruleinst->def = rule;\n    ruleinst->priority = rule->priority;\n    if (!(ruleinst->vars = virNWFilterHashTableCreate(0)))\n        goto cleanup;\n    if (virNWFilterHashTablePutAll(vars, ruleinst->vars) < 0)\n        goto cleanup;\n\n    if (VIR_APPEND_ELEMENT(inst->rules,\n                           inst->nrules,\n                           ruleinst) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virNWFilterRuleInstFree(ruleinst);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterInstReset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "230-243",
    "snippet": "static void\nvirNWFilterInstReset(virNWFilterInstPtr inst)\n{\n    size_t i;\n\n    for (i = 0; i < inst->nfilters; i++)\n        virNWFilterObjUnlock(inst->filters[i]);\n    VIR_FREE(inst->filters);\n    inst->nfilters = 0;\n\n    for (i = 0; i < inst->nrules; i++)\n        virNWFilterRuleInstFree(inst->rules[i]);\n    VIR_FREE(inst->rules);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "inst->rules"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterRuleInstFree",
          "args": [
            "inst->rules[i]"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterRuleInstFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "118-126",
          "snippet": "static void\nvirNWFilterRuleInstFree(virNWFilterRuleInstPtr inst)\n{\n    if (!inst)\n        return;\n\n    virHashFree(inst->vars);\n    VIR_FREE(inst);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic void\nvirNWFilterRuleInstFree(virNWFilterRuleInstPtr inst)\n{\n    if (!inst)\n        return;\n\n    virHashFree(inst->vars);\n    VIR_FREE(inst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "inst->filters"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "inst->filters[i]"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic void\nvirNWFilterInstReset(virNWFilterInstPtr inst)\n{\n    size_t i;\n\n    for (i = 0; i < inst->nfilters; i++)\n        virNWFilterObjUnlock(inst->filters[i]);\n    VIR_FREE(inst->filters);\n    inst->nfilters = 0;\n\n    for (i = 0; i < inst->nrules; i++)\n        virNWFilterRuleInstFree(inst->rules[i]);\n    VIR_FREE(inst->rules);\n}"
  },
  {
    "function_name": "virNWFilterCreateVarsFrom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "198-217",
    "snippet": "static virHashTablePtr\nvirNWFilterCreateVarsFrom(virHashTablePtr vars1,\n                          virHashTablePtr vars2)\n{\n    virHashTablePtr res = virNWFilterHashTableCreate(0);\n    if (!res)\n        return NULL;\n\n    if (virNWFilterHashTablePutAll(vars1, res) < 0)\n        goto err_exit;\n\n    if (virNWFilterHashTablePutAll(vars2, res) < 0)\n        goto err_exit;\n\n    return res;\n\n err_exit:\n    virHashFree(res);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "res"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTablePutAll",
          "args": [
            "vars2",
            "res"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTablePutAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "664-678",
          "snippet": "int\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTableCreate",
          "args": [
            "0"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTableCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "628-632",
          "snippet": "virHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virHashTablePtr\nvirNWFilterCreateVarsFrom(virHashTablePtr vars1,\n                          virHashTablePtr vars2)\n{\n    virHashTablePtr res = virNWFilterHashTableCreate(0);\n    if (!res)\n        return NULL;\n\n    if (virNWFilterHashTablePutAll(vars1, res) < 0)\n        goto err_exit;\n\n    if (virNWFilterHashTablePutAll(vars2, res) < 0)\n        goto err_exit;\n\n    return res;\n\n err_exit:\n    virHashFree(res);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterPrintVars",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "168-184",
    "snippet": "static char *\nvirNWFilterPrintVars(virHashTablePtr vars,\n                     const char *separator,\n                     bool reportMAC,\n                     bool reportIP)\n{\n    struct printString ps = {\n        .buf       = VIR_BUFFER_INITIALIZER,\n        .separator = separator,\n        .reportMAC = reportMAC,\n        .reportIP  = reportIP,\n    };\n\n    virHashForEach(vars, printString, &ps);\n\n    return virBufferContentAndReset(&ps.buf);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&ps.buf"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "vars",
            "printString",
            "&ps"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvirNWFilterPrintVars(virHashTablePtr vars,\n                     const char *separator,\n                     bool reportMAC,\n                     bool reportIP)\n{\n    struct printString ps = {\n        .buf       = VIR_BUFFER_INITIALIZER,\n        .separator = separator,\n        .reportMAC = reportMAC,\n        .reportIP  = reportIP,\n    };\n\n    virHashForEach(vars, printString, &ps);\n\n    return virBufferContentAndReset(&ps.buf);\n}"
  },
  {
    "function_name": "printString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "142-156",
    "snippet": "static int\nprintString(void *payload G_GNUC_UNUSED, const void *name, void *data)\n{\n    struct printString *ps = data;\n\n    if ((STREQ((char *)name, NWFILTER_STD_VAR_IP) && !ps->reportIP) ||\n        (STREQ((char *)name, NWFILTER_STD_VAR_MAC) && !ps->reportMAC))\n        return 0;\n\n    if (virBufferUse(&ps->buf) && ps->separator)\n        virBufferAdd(&ps->buf, ps->separator, -1);\n\n    virBufferAdd(&ps->buf, name, -1);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP",
      "#define NWFILTER_STD_VAR_MAC NWFILTER_VARNAME_MAC"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "&ps->buf",
            "name",
            "-1"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferUse",
          "args": [
            "&ps->buf"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferUse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "285-292",
          "snippet": "size_t\nvirBufferUse(const virBuffer *buf)\n{\n    if (!buf || !buf->str)\n        return 0;\n\n    return buf->str->len;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nsize_t\nvirBufferUse(const virBuffer *buf)\n{\n    if (!buf || !buf->str)\n        return 0;\n\n    return buf->str->len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "(char *)name",
            "NWFILTER_STD_VAR_MAC"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "(char *)name",
            "NWFILTER_STD_VAR_IP"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define NWFILTER_STD_VAR_IP  NWFILTER_VARNAME_IP\n#define NWFILTER_STD_VAR_MAC NWFILTER_VARNAME_MAC\n\nstatic int\nprintString(void *payload G_GNUC_UNUSED, const void *name, void *data)\n{\n    struct printString *ps = data;\n\n    if ((STREQ((char *)name, NWFILTER_STD_VAR_IP) && !ps->reportIP) ||\n        (STREQ((char *)name, NWFILTER_STD_VAR_MAC) && !ps->reportMAC))\n        return 0;\n\n    if (virBufferUse(&ps->buf) && ps->separator)\n        virBufferAdd(&ps->buf, ps->separator, -1);\n\n    virBufferAdd(&ps->buf, name, -1);\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterRuleInstFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "118-126",
    "snippet": "static void\nvirNWFilterRuleInstFree(virNWFilterRuleInstPtr inst)\n{\n    if (!inst)\n        return;\n\n    virHashFree(inst->vars);\n    VIR_FREE(inst);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "inst"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "inst->vars"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterDefToInst(virNWFilterDriverStatePtr driver,\n                     virNWFilterDefPtr def,\n                     virHashTablePtr vars,\n                     enum instCase useNewFilter,\n                     bool *foundNewFilter,\n                     virNWFilterInstPtr inst);\n\nstatic void\nvirNWFilterRuleInstFree(virNWFilterRuleInstPtr inst)\n{\n    if (!inst)\n        return;\n\n    virHashFree(inst->vars);\n    VIR_FREE(inst);\n}"
  },
  {
    "function_name": "virNWFilterTechDriverForName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "102-115",
    "snippet": "virNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "filter_tech_drivers[i]->name",
            "name"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\n\nvirNWFilterTechDriverPtr\nvirNWFilterTechDriverForName(const char *name)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if (STREQ(filter_tech_drivers[i]->name, name)) {\n            if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED) == 0)\n                break;\n            return filter_tech_drivers[i];\n        }\n        i++;\n    }\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterTechDriversShutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "90-99",
    "snippet": "void virNWFilterTechDriversShutdown(void)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->shutdown();\n        i++;\n    }\n    virMutexDestroy(&updateMutex);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};",
      "static virMutex updateMutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexDestroy",
          "args": [
            "&updateMutex"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "76-79",
          "snippet": "void virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter_tech_drivers[i]->shutdown",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\nstatic virMutex updateMutex;\n\nvoid virNWFilterTechDriversShutdown(void)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->shutdown();\n        i++;\n    }\n    virMutexDestroy(&updateMutex);\n}"
  },
  {
    "function_name": "virNWFilterTechDriversInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
    "lines": "74-87",
    "snippet": "int virNWFilterTechDriversInit(bool privileged)\n{\n    size_t i = 0;\n    VIR_DEBUG(\"Initializing NWFilter technology drivers\");\n    if (virMutexInitRecursive(&updateMutex) < 0)\n        return -1;\n\n    while (filter_tech_drivers[i]) {\n        if (!(filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->init(privileged);\n        i++;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"datatypes.h\"",
      "#include \"virnetdev.h\"",
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ebiptables_driver.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"virerror.h\"",
      "#include \"domain_conf.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};",
      "static virMutex updateMutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "filter_tech_drivers[i]->init",
          "args": [
            "privileged"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexInitRecursive",
          "args": [
            "&updateMutex"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexInitRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "61-74",
          "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Initializing NWFilter technology drivers\""
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\nstatic virMutex updateMutex;\n\nint virNWFilterTechDriversInit(bool privileged)\n{\n    size_t i = 0;\n    VIR_DEBUG(\"Initializing NWFilter technology drivers\");\n    if (virMutexInitRecursive(&updateMutex) < 0)\n        return -1;\n\n    while (filter_tech_drivers[i]) {\n        if (!(filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->init(privileged);\n        i++;\n    }\n    return 0;\n}"
  }
]