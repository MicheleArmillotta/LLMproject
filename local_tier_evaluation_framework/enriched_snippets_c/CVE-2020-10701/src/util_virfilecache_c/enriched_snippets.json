[
  {
    "function_name": "virFileCacheInsertData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "401-415",
    "snippet": "int\nvirFileCacheInsertData(virFileCachePtr cache,\n                       const char *name,\n                       void *data)\n{\n    int ret;\n\n    virObjectLock(cache);\n\n    ret = virHashUpdateEntry(cache->table, name, data);\n\n    virObjectUnlock(cache);\n\n    return ret;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "cache"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashUpdateEntry",
          "args": [
            "cache->table",
            "name",
            "data"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "virHashUpdateEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "422-427",
          "snippet": "int\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "cache"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileCacheInsertData(virFileCachePtr cache,\n                       const char *name,\n                       void *data)\n{\n    int ret;\n\n    virObjectLock(cache);\n\n    ret = virHashUpdateEntry(cache->table, name, data);\n\n    virObjectUnlock(cache);\n\n    return ret;\n}"
  },
  {
    "function_name": "virFileCacheSetPriv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "376-387",
    "snippet": "void\nvirFileCacheSetPriv(virFileCachePtr cache,\n                    void *priv)\n{\n    virObjectLock(cache);\n\n    virFileCachePrivFree(cache);\n\n    cache->priv = priv;\n\n    virObjectUnlock(cache);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "cache"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileCachePrivFree",
          "args": [
            "cache"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCachePrivFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "64-69",
          "snippet": "static void\nvirFileCachePrivFree(virFileCachePtr cache)\n{\n    if (cache->priv && cache->handlers.privFree)\n        cache->handlers.privFree(cache->priv);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirFileCachePrivFree(virFileCachePtr cache)\n{\n    if (cache->priv && cache->handlers.privFree)\n        cache->handlers.privFree(cache->priv);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "cache"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirFileCacheSetPriv(virFileCachePtr cache,\n                    void *priv)\n{\n    virObjectLock(cache);\n\n    virFileCachePrivFree(cache);\n\n    cache->priv = priv;\n\n    virObjectUnlock(cache);\n}"
  },
  {
    "function_name": "virFileCacheGetPriv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "353-365",
    "snippet": "void *\nvirFileCacheGetPriv(virFileCachePtr cache)\n{\n    void *priv;\n\n    virObjectLock(cache);\n\n    priv = cache->priv;\n\n    virObjectUnlock(cache);\n\n    return priv;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "cache"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "cache"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid *\nvirFileCacheGetPriv(virFileCachePtr cache)\n{\n    void *priv;\n\n    virObjectLock(cache);\n\n    priv = cache->priv;\n\n    virObjectUnlock(cache);\n\n    return priv;\n}"
  },
  {
    "function_name": "virFileCacheLookupByFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "327-344",
    "snippet": "void *\nvirFileCacheLookupByFunc(virFileCachePtr cache,\n                         virHashSearcher iter,\n                         const void *iterData)\n{\n    void *data = NULL;\n    g_autofree char *name = NULL;\n\n    virObjectLock(cache);\n\n    data = virHashSearch(cache->table, iter, iterData, (void **)&name);\n    virFileCacheValidate(cache, name, &data);\n\n    virObjectRef(data);\n    virObjectUnlock(cache);\n\n    return data;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "cache"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "data"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileCacheValidate",
          "args": [
            "cache",
            "name",
            "&data"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCacheValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "259-283",
          "snippet": "static void\nvirFileCacheValidate(virFileCachePtr cache,\n                     const char *name,\n                     void **data)\n{\n    if (*data && !cache->handlers.isValid(*data, cache->priv)) {\n        VIR_DEBUG(\"Cached data '%p' no longer valid for '%s'\",\n                  *data, NULLSTR(name));\n        if (name)\n            virHashRemoveEntry(cache->table, name);\n        *data = NULL;\n    }\n\n    if (!*data && name) {\n        VIR_DEBUG(\"Creating data for '%s'\", name);\n        *data = virFileCacheNewData(cache, name);\n        if (*data) {\n            VIR_DEBUG(\"Caching data '%p' for '%s'\", *data, name);\n            if (virHashAddEntry(cache->table, name, *data) < 0) {\n                virObjectUnref(*data);\n                *data = NULL;\n            }\n        }\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirFileCacheValidate(virFileCachePtr cache,\n                     const char *name,\n                     void **data)\n{\n    if (*data && !cache->handlers.isValid(*data, cache->priv)) {\n        VIR_DEBUG(\"Cached data '%p' no longer valid for '%s'\",\n                  *data, NULLSTR(name));\n        if (name)\n            virHashRemoveEntry(cache->table, name);\n        *data = NULL;\n    }\n\n    if (!*data && name) {\n        VIR_DEBUG(\"Creating data for '%s'\", name);\n        *data = virFileCacheNewData(cache, name);\n        if (*data) {\n            VIR_DEBUG(\"Caching data '%p' for '%s'\", *data, name);\n            if (virHashAddEntry(cache->table, name, *data) < 0) {\n                virObjectUnref(*data);\n                *data = NULL;\n            }\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSearch",
          "args": [
            "cache->table",
            "iter",
            "iterData",
            "(void **)&name"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "736-761",
          "snippet": "void *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "cache"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid *\nvirFileCacheLookupByFunc(virFileCachePtr cache,\n                         virHashSearcher iter,\n                         const void *iterData)\n{\n    void *data = NULL;\n    g_autofree char *name = NULL;\n\n    virObjectLock(cache);\n\n    data = virHashSearch(cache->table, iter, iterData, (void **)&name);\n    virFileCacheValidate(cache, name, &data);\n\n    virObjectRef(data);\n    virObjectUnlock(cache);\n\n    return data;\n}"
  },
  {
    "function_name": "virFileCacheLookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "298-313",
    "snippet": "void *\nvirFileCacheLookup(virFileCachePtr cache,\n                   const char *name)\n{\n    void *data = NULL;\n\n    virObjectLock(cache);\n\n    data = virHashLookup(cache->table, name);\n    virFileCacheValidate(cache, name, &data);\n\n    virObjectRef(data);\n    virObjectUnlock(cache);\n\n    return data;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "cache"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "data"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileCacheValidate",
          "args": [
            "cache",
            "name",
            "&data"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCacheValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "259-283",
          "snippet": "static void\nvirFileCacheValidate(virFileCachePtr cache,\n                     const char *name,\n                     void **data)\n{\n    if (*data && !cache->handlers.isValid(*data, cache->priv)) {\n        VIR_DEBUG(\"Cached data '%p' no longer valid for '%s'\",\n                  *data, NULLSTR(name));\n        if (name)\n            virHashRemoveEntry(cache->table, name);\n        *data = NULL;\n    }\n\n    if (!*data && name) {\n        VIR_DEBUG(\"Creating data for '%s'\", name);\n        *data = virFileCacheNewData(cache, name);\n        if (*data) {\n            VIR_DEBUG(\"Caching data '%p' for '%s'\", *data, name);\n            if (virHashAddEntry(cache->table, name, *data) < 0) {\n                virObjectUnref(*data);\n                *data = NULL;\n            }\n        }\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirFileCacheValidate(virFileCachePtr cache,\n                     const char *name,\n                     void **data)\n{\n    if (*data && !cache->handlers.isValid(*data, cache->priv)) {\n        VIR_DEBUG(\"Cached data '%p' no longer valid for '%s'\",\n                  *data, NULLSTR(name));\n        if (name)\n            virHashRemoveEntry(cache->table, name);\n        *data = NULL;\n    }\n\n    if (!*data && name) {\n        VIR_DEBUG(\"Creating data for '%s'\", name);\n        *data = virFileCacheNewData(cache, name);\n        if (*data) {\n            VIR_DEBUG(\"Caching data '%p' for '%s'\", *data, name);\n            if (virHashAddEntry(cache->table, name, *data) < 0) {\n                virObjectUnref(*data);\n                *data = NULL;\n            }\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "cache->table",
            "name"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "cache"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid *\nvirFileCacheLookup(virFileCachePtr cache,\n                   const char *name)\n{\n    void *data = NULL;\n\n    virObjectLock(cache);\n\n    data = virHashLookup(cache->table, name);\n    virFileCacheValidate(cache, name, &data);\n\n    virObjectRef(data);\n    virObjectUnlock(cache);\n\n    return data;\n}"
  },
  {
    "function_name": "virFileCacheValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "259-283",
    "snippet": "static void\nvirFileCacheValidate(virFileCachePtr cache,\n                     const char *name,\n                     void **data)\n{\n    if (*data && !cache->handlers.isValid(*data, cache->priv)) {\n        VIR_DEBUG(\"Cached data '%p' no longer valid for '%s'\",\n                  *data, NULLSTR(name));\n        if (name)\n            virHashRemoveEntry(cache->table, name);\n        *data = NULL;\n    }\n\n    if (!*data && name) {\n        VIR_DEBUG(\"Creating data for '%s'\", name);\n        *data = virFileCacheNewData(cache, name);\n        if (*data) {\n            VIR_DEBUG(\"Caching data '%p' for '%s'\", *data, name);\n            if (virHashAddEntry(cache->table, name, *data) < 0) {\n                virObjectUnref(*data);\n                *data = NULL;\n            }\n        }\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "*data"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "cache->table",
            "name",
            "*data"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Caching data '%p' for '%s'\"",
            "*data",
            "name"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileCacheNewData",
          "args": [
            "cache",
            "name"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCacheNewData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "194-215",
          "snippet": "static void *\nvirFileCacheNewData(virFileCachePtr cache,\n                    const char *name)\n{\n    void *data = NULL;\n    int rv;\n\n    if ((rv = virFileCacheLoad(cache, name, &data)) < 0)\n        return NULL;\n\n    if (rv == 0) {\n        if (!(data = cache->handlers.newData(name, cache->priv)))\n            return NULL;\n\n        if (virFileCacheSave(cache, name, data) < 0) {\n            virObjectUnref(data);\n            data = NULL;\n        }\n    }\n\n    return data;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void *\nvirFileCacheNewData(virFileCachePtr cache,\n                    const char *name)\n{\n    void *data = NULL;\n    int rv;\n\n    if ((rv = virFileCacheLoad(cache, name, &data)) < 0)\n        return NULL;\n\n    if (rv == 0) {\n        if (!(data = cache->handlers.newData(name, cache->priv)))\n            return NULL;\n\n        if (virFileCacheSave(cache, name, data) < 0) {\n            virObjectUnref(data);\n            data = NULL;\n        }\n    }\n\n    return data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Creating data for '%s'\"",
            "name"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "cache->table",
            "name"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Cached data '%p' no longer valid for '%s'\"",
            "*data",
            "NULLSTR(name)"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache->handlers.isValid",
          "args": [
            "*data",
            "cache->priv"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirFileCacheValidate(virFileCachePtr cache,\n                     const char *name,\n                     void **data)\n{\n    if (*data && !cache->handlers.isValid(*data, cache->priv)) {\n        VIR_DEBUG(\"Cached data '%p' no longer valid for '%s'\",\n                  *data, NULLSTR(name));\n        if (name)\n            virHashRemoveEntry(cache->table, name);\n        *data = NULL;\n    }\n\n    if (!*data && name) {\n        VIR_DEBUG(\"Creating data for '%s'\", name);\n        *data = virFileCacheNewData(cache, name);\n        if (*data) {\n            VIR_DEBUG(\"Caching data '%p' for '%s'\", *data, name);\n            if (virHashAddEntry(cache->table, name, *data) < 0) {\n                virObjectUnref(*data);\n                *data = NULL;\n            }\n        }\n    }\n}"
  },
  {
    "function_name": "virFileCacheNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "229-256",
    "snippet": "virFileCachePtr\nvirFileCacheNew(const char *dir,\n                const char *suffix,\n                virFileCacheHandlers *handlers)\n{\n    virFileCachePtr cache;\n\n    if (virFileCacheInitialize() < 0)\n        return NULL;\n\n    if (!(cache = virObjectNew(virFileCacheClass)))\n        return NULL;\n\n    if (!(cache->table = virHashCreate(10, virObjectFreeHashData)))\n        goto cleanup;\n\n    cache->dir = g_strdup(dir);\n\n    cache->suffix = g_strdup(suffix);\n\n    cache->handlers = *handlers;\n\n    return cache;\n\n cleanup:\n    virObjectUnref(cache);\n    return NULL;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virFileCacheClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cache"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "suffix"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "10",
            "virObjectFreeHashData"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectNew",
          "args": [
            "virFileCacheClass"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "236-253",
          "snippet": "void *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileCacheInitialize",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virFileCacheClass;\n\nvirFileCachePtr\nvirFileCacheNew(const char *dir,\n                const char *suffix,\n                virFileCacheHandlers *handlers)\n{\n    virFileCachePtr cache;\n\n    if (virFileCacheInitialize() < 0)\n        return NULL;\n\n    if (!(cache = virObjectNew(virFileCacheClass)))\n        return NULL;\n\n    if (!(cache->table = virHashCreate(10, virObjectFreeHashData)))\n        goto cleanup;\n\n    cache->dir = g_strdup(dir);\n\n    cache->suffix = g_strdup(suffix);\n\n    cache->handlers = *handlers;\n\n    return cache;\n\n cleanup:\n    virObjectUnref(cache);\n    return NULL;\n}"
  },
  {
    "function_name": "virFileCacheNewData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "194-215",
    "snippet": "static void *\nvirFileCacheNewData(virFileCachePtr cache,\n                    const char *name)\n{\n    void *data = NULL;\n    int rv;\n\n    if ((rv = virFileCacheLoad(cache, name, &data)) < 0)\n        return NULL;\n\n    if (rv == 0) {\n        if (!(data = cache->handlers.newData(name, cache->priv)))\n            return NULL;\n\n        if (virFileCacheSave(cache, name, data) < 0) {\n            virObjectUnref(data);\n            data = NULL;\n        }\n    }\n\n    return data;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "data"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileCacheSave",
          "args": [
            "cache",
            "name",
            "data"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCacheSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "177-191",
          "snippet": "static int\nvirFileCacheSave(virFileCachePtr cache,\n                 const char *name,\n                 void *data)\n{\n    g_autofree char *file = NULL;\n\n    if (!(file = virFileCacheGetFileName(cache, name)))\n        return -1;\n\n    if (cache->handlers.saveFile(data, file, cache->priv) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileCacheSave(virFileCachePtr cache,\n                 const char *name,\n                 void *data)\n{\n    g_autofree char *file = NULL;\n\n    if (!(file = virFileCacheGetFileName(cache, name)))\n        return -1;\n\n    if (cache->handlers.saveFile(data, file, cache->priv) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache->handlers.newData",
          "args": [
            "name",
            "cache->priv"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileCacheLoad",
          "args": [
            "cache",
            "name",
            "&data"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCacheLoad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "125-174",
          "snippet": "static int\nvirFileCacheLoad(virFileCachePtr cache,\n                 const char *name,\n                 void **data)\n{\n    g_autofree char *file = NULL;\n    int ret = -1;\n    void *loadData = NULL;\n\n    *data = NULL;\n\n    if (!(file = virFileCacheGetFileName(cache, name)))\n        return ret;\n\n    if (!virFileExists(file)) {\n        if (errno == ENOENT) {\n            VIR_DEBUG(\"No cached data '%s' for '%s'\", file, name);\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to access cache '%s' for '%s'\"),\n                             file, name);\n        goto cleanup;\n    }\n\n    if (!(loadData = cache->handlers.loadFile(file, name, cache->priv))) {\n        VIR_WARN(\"Failed to load cached data from '%s' for '%s': %s\",\n                 file, name, virGetLastErrorMessage());\n        virResetLastError();\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!cache->handlers.isValid(loadData, cache->priv)) {\n        VIR_DEBUG(\"Outdated cached capabilities '%s' for '%s'\", file, name);\n        unlink(file);\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Loaded cached data '%s' for '%s'\", file, name);\n\n    ret = 1;\n    *data = g_steal_pointer(&loadData);\n\n cleanup:\n    virObjectUnref(loadData);\n    return ret;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileCacheLoad(virFileCachePtr cache,\n                 const char *name,\n                 void **data)\n{\n    g_autofree char *file = NULL;\n    int ret = -1;\n    void *loadData = NULL;\n\n    *data = NULL;\n\n    if (!(file = virFileCacheGetFileName(cache, name)))\n        return ret;\n\n    if (!virFileExists(file)) {\n        if (errno == ENOENT) {\n            VIR_DEBUG(\"No cached data '%s' for '%s'\", file, name);\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to access cache '%s' for '%s'\"),\n                             file, name);\n        goto cleanup;\n    }\n\n    if (!(loadData = cache->handlers.loadFile(file, name, cache->priv))) {\n        VIR_WARN(\"Failed to load cached data from '%s' for '%s': %s\",\n                 file, name, virGetLastErrorMessage());\n        virResetLastError();\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!cache->handlers.isValid(loadData, cache->priv)) {\n        VIR_DEBUG(\"Outdated cached capabilities '%s' for '%s'\", file, name);\n        unlink(file);\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Loaded cached data '%s' for '%s'\", file, name);\n\n    ret = 1;\n    *data = g_steal_pointer(&loadData);\n\n cleanup:\n    virObjectUnref(loadData);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void *\nvirFileCacheNewData(virFileCachePtr cache,\n                    const char *name)\n{\n    void *data = NULL;\n    int rv;\n\n    if ((rv = virFileCacheLoad(cache, name, &data)) < 0)\n        return NULL;\n\n    if (rv == 0) {\n        if (!(data = cache->handlers.newData(name, cache->priv)))\n            return NULL;\n\n        if (virFileCacheSave(cache, name, data) < 0) {\n            virObjectUnref(data);\n            data = NULL;\n        }\n    }\n\n    return data;\n}"
  },
  {
    "function_name": "virFileCacheSave",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "177-191",
    "snippet": "static int\nvirFileCacheSave(virFileCachePtr cache,\n                 const char *name,\n                 void *data)\n{\n    g_autofree char *file = NULL;\n\n    if (!(file = virFileCacheGetFileName(cache, name)))\n        return -1;\n\n    if (cache->handlers.saveFile(data, file, cache->priv) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache->handlers.saveFile",
          "args": [
            "data",
            "file",
            "cache->priv"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileCacheGetFileName",
          "args": [
            "cache",
            "name"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCacheGetFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "99-122",
          "snippet": "static char *\nvirFileCacheGetFileName(virFileCachePtr cache,\n                        const char *name)\n{\n    g_autofree char *namehash = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virCryptoHashString(VIR_CRYPTO_HASH_SHA256, name, &namehash) < 0)\n        return NULL;\n\n    if (virFileMakePath(cache->dir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create directory '%s'\"),\n                             cache->dir);\n        return NULL;\n    }\n\n    virBufferAsprintf(&buf, \"%s/%s\", cache->dir, namehash);\n\n    if (cache->suffix)\n        virBufferAsprintf(&buf, \".%s\", cache->suffix);\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvirFileCacheGetFileName(virFileCachePtr cache,\n                        const char *name)\n{\n    g_autofree char *namehash = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virCryptoHashString(VIR_CRYPTO_HASH_SHA256, name, &namehash) < 0)\n        return NULL;\n\n    if (virFileMakePath(cache->dir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create directory '%s'\"),\n                             cache->dir);\n        return NULL;\n    }\n\n    virBufferAsprintf(&buf, \"%s/%s\", cache->dir, namehash);\n\n    if (cache->suffix)\n        virBufferAsprintf(&buf, \".%s\", cache->suffix);\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileCacheSave(virFileCachePtr cache,\n                 const char *name,\n                 void *data)\n{\n    g_autofree char *file = NULL;\n\n    if (!(file = virFileCacheGetFileName(cache, name)))\n        return -1;\n\n    if (cache->handlers.saveFile(data, file, cache->priv) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileCacheLoad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "125-174",
    "snippet": "static int\nvirFileCacheLoad(virFileCachePtr cache,\n                 const char *name,\n                 void **data)\n{\n    g_autofree char *file = NULL;\n    int ret = -1;\n    void *loadData = NULL;\n\n    *data = NULL;\n\n    if (!(file = virFileCacheGetFileName(cache, name)))\n        return ret;\n\n    if (!virFileExists(file)) {\n        if (errno == ENOENT) {\n            VIR_DEBUG(\"No cached data '%s' for '%s'\", file, name);\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to access cache '%s' for '%s'\"),\n                             file, name);\n        goto cleanup;\n    }\n\n    if (!(loadData = cache->handlers.loadFile(file, name, cache->priv))) {\n        VIR_WARN(\"Failed to load cached data from '%s' for '%s': %s\",\n                 file, name, virGetLastErrorMessage());\n        virResetLastError();\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!cache->handlers.isValid(loadData, cache->priv)) {\n        VIR_DEBUG(\"Outdated cached capabilities '%s' for '%s'\", file, name);\n        unlink(file);\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Loaded cached data '%s' for '%s'\", file, name);\n\n    ret = 1;\n    *data = g_steal_pointer(&loadData);\n\n cleanup:\n    virObjectUnref(loadData);\n    return ret;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "loadData"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&loadData"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Loaded cached data '%s' for '%s'\"",
            "file",
            "name"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "file"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Outdated cached capabilities '%s' for '%s'\"",
            "file",
            "name"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache->handlers.isValid",
          "args": [
            "loadData",
            "cache->priv"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Failed to load cached data from '%s' for '%s': %s\"",
            "file",
            "name",
            "virGetLastErrorMessage()"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache->handlers.loadFile",
          "args": [
            "file",
            "name",
            "cache->priv"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to access cache '%s' for '%s'\")",
            "file",
            "name"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to access cache '%s' for '%s'\""
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"No cached data '%s' for '%s'\"",
            "file",
            "name"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "file"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileCacheGetFileName",
          "args": [
            "cache",
            "name"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCacheGetFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "99-122",
          "snippet": "static char *\nvirFileCacheGetFileName(virFileCachePtr cache,\n                        const char *name)\n{\n    g_autofree char *namehash = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virCryptoHashString(VIR_CRYPTO_HASH_SHA256, name, &namehash) < 0)\n        return NULL;\n\n    if (virFileMakePath(cache->dir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create directory '%s'\"),\n                             cache->dir);\n        return NULL;\n    }\n\n    virBufferAsprintf(&buf, \"%s/%s\", cache->dir, namehash);\n\n    if (cache->suffix)\n        virBufferAsprintf(&buf, \".%s\", cache->suffix);\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvirFileCacheGetFileName(virFileCachePtr cache,\n                        const char *name)\n{\n    g_autofree char *namehash = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virCryptoHashString(VIR_CRYPTO_HASH_SHA256, name, &namehash) < 0)\n        return NULL;\n\n    if (virFileMakePath(cache->dir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create directory '%s'\"),\n                             cache->dir);\n        return NULL;\n    }\n\n    virBufferAsprintf(&buf, \"%s/%s\", cache->dir, namehash);\n\n    if (cache->suffix)\n        virBufferAsprintf(&buf, \".%s\", cache->suffix);\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileCacheLoad(virFileCachePtr cache,\n                 const char *name,\n                 void **data)\n{\n    g_autofree char *file = NULL;\n    int ret = -1;\n    void *loadData = NULL;\n\n    *data = NULL;\n\n    if (!(file = virFileCacheGetFileName(cache, name)))\n        return ret;\n\n    if (!virFileExists(file)) {\n        if (errno == ENOENT) {\n            VIR_DEBUG(\"No cached data '%s' for '%s'\", file, name);\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to access cache '%s' for '%s'\"),\n                             file, name);\n        goto cleanup;\n    }\n\n    if (!(loadData = cache->handlers.loadFile(file, name, cache->priv))) {\n        VIR_WARN(\"Failed to load cached data from '%s' for '%s': %s\",\n                 file, name, virGetLastErrorMessage());\n        virResetLastError();\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!cache->handlers.isValid(loadData, cache->priv)) {\n        VIR_DEBUG(\"Outdated cached capabilities '%s' for '%s'\", file, name);\n        unlink(file);\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Loaded cached data '%s' for '%s'\", file, name);\n\n    ret = 1;\n    *data = g_steal_pointer(&loadData);\n\n cleanup:\n    virObjectUnref(loadData);\n    return ret;\n}"
  },
  {
    "function_name": "virFileCacheGetFileName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "99-122",
    "snippet": "static char *\nvirFileCacheGetFileName(virFileCachePtr cache,\n                        const char *name)\n{\n    g_autofree char *namehash = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virCryptoHashString(VIR_CRYPTO_HASH_SHA256, name, &namehash) < 0)\n        return NULL;\n\n    if (virFileMakePath(cache->dir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create directory '%s'\"),\n                             cache->dir);\n        return NULL;\n    }\n\n    virBufferAsprintf(&buf, \"%s/%s\", cache->dir, namehash);\n\n    if (cache->suffix)\n        virBufferAsprintf(&buf, \".%s\", cache->suffix);\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\".%s\"",
            "cache->suffix"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to create directory '%s'\")",
            "cache->dir"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to create directory '%s'\""
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "cache->dir"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCryptoHashString",
          "args": [
            "VIR_CRYPTO_HASH_SHA256",
            "name",
            "&namehash"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "virCryptoHashString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircrypto.c",
          "lines": "76-100",
          "snippet": "int\nvirCryptoHashString(virCryptoHash hash,\n                    const char *input,\n                    char **output)\n{\n    unsigned char buf[VIR_CRYPTO_LARGEST_DIGEST_SIZE];\n    ssize_t rc;\n    size_t hashstrlen;\n    size_t i;\n\n    if ((rc = virCryptoHashBuf(hash, input, buf)) < 0)\n        return -1;\n\n    hashstrlen = (rc * 2) + 1;\n\n    if (VIR_ALLOC_N(*output, hashstrlen) < 0)\n        return -1;\n\n    for (i = 0; i < rc; i++) {\n        (*output)[i * 2] = hex[(buf[i] >> 4) & 0xf];\n        (*output)[(i * 2) + 1] = hex[buf[i] & 0xf];\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"virrandom.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_CRYPTO_LARGEST_DIGEST_SIZE VIR_CRYPTO_HASH_SIZE_SHA256"
          ],
          "globals_used": [
            "static const char hex[] = \"0123456789abcdef\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"virrandom.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include <config.h>\n\n#define VIR_CRYPTO_LARGEST_DIGEST_SIZE VIR_CRYPTO_HASH_SIZE_SHA256\n\nstatic const char hex[] = \"0123456789abcdef\";\n\nint\nvirCryptoHashString(virCryptoHash hash,\n                    const char *input,\n                    char **output)\n{\n    unsigned char buf[VIR_CRYPTO_LARGEST_DIGEST_SIZE];\n    ssize_t rc;\n    size_t hashstrlen;\n    size_t i;\n\n    if ((rc = virCryptoHashBuf(hash, input, buf)) < 0)\n        return -1;\n\n    hashstrlen = (rc * 2) + 1;\n\n    if (VIR_ALLOC_N(*output, hashstrlen) < 0)\n        return -1;\n\n    for (i = 0; i < rc; i++) {\n        (*output)[i * 2] = hex[(buf[i] >> 4) & 0xf];\n        (*output)[(i * 2) + 1] = hex[buf[i] & 0xf];\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvirFileCacheGetFileName(virFileCachePtr cache,\n                        const char *name)\n{\n    g_autofree char *namehash = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virCryptoHashString(VIR_CRYPTO_HASH_SHA256, name, &namehash) < 0)\n        return NULL;\n\n    if (virFileMakePath(cache->dir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create directory '%s'\"),\n                             cache->dir);\n        return NULL;\n    }\n\n    virBufferAsprintf(&buf, \"%s/%s\", cache->dir, namehash);\n\n    if (cache->suffix)\n        virBufferAsprintf(&buf, \".%s\", cache->suffix);\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virFileCacheOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "86-93",
    "snippet": "static int\nvirFileCacheOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virFileCache, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virFileCache",
            "virClassForObjectLockable()"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileCacheOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virFileCache, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileCacheDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "72-83",
    "snippet": "static void\nvirFileCacheDispose(void *obj)\n{\n    virFileCachePtr cache = obj;\n\n    VIR_FREE(cache->dir);\n    VIR_FREE(cache->suffix);\n\n    virHashFree(cache->table);\n\n    virFileCachePrivFree(cache);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileCachePrivFree",
          "args": [
            "cache"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCachePrivFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
          "lines": "64-69",
          "snippet": "static void\nvirFileCachePrivFree(virFileCachePtr cache)\n{\n    if (cache->priv && cache->handlers.privFree)\n        cache->handlers.privFree(cache->priv);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirFileCachePrivFree(virFileCachePtr cache)\n{\n    if (cache->priv && cache->handlers.privFree)\n        cache->handlers.privFree(cache->priv);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "cache->table"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cache->suffix"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cache->dir"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirFileCacheDispose(void *obj)\n{\n    virFileCachePtr cache = obj;\n\n    VIR_FREE(cache->dir);\n    VIR_FREE(cache->suffix);\n\n    virHashFree(cache->table);\n\n    virFileCachePrivFree(cache);\n}"
  },
  {
    "function_name": "virFileCachePrivFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfilecache.c",
    "lines": "64-69",
    "snippet": "static void\nvirFileCachePrivFree(virFileCachePtr cache)\n{\n    if (cache->priv && cache->handlers.privFree)\n        cache->handlers.privFree(cache->priv);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfilecache.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircrypto.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache->handlers.privFree",
          "args": [
            "cache->priv"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircrypto.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirFileCachePrivFree(virFileCachePtr cache)\n{\n    if (cache->priv && cache->handlers.privFree)\n        cache->handlers.privFree(cache->priv);\n}"
  }
]