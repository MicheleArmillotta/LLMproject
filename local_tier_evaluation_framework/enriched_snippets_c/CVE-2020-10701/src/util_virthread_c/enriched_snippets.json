[
  {
    "function_name": "virThreadLocalSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "352-360",
    "snippet": "int virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_setspecific",
          "args": [
            "l->key",
            "val"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virThreadLocalGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "347-350",
    "snippet": "void *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_getspecific",
          "args": [
            "l->key"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}"
  },
  {
    "function_name": "virThreadLocalInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "336-345",
    "snippet": "int virThreadLocalInit(virThreadLocalPtr l,\n                       virThreadLocalCleanup c)\n{\n    int ret;\n    if ((ret = pthread_key_create(&l->key, c)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_key_create",
          "args": [
            "&l->key",
            "c"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalInit(virThreadLocalPtr l,\n                       virThreadLocalCleanup c)\n{\n    int ret;\n    if ((ret = pthread_key_create(&l->key, c)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virThreadCancel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "331-334",
    "snippet": "void virThreadCancel(virThreadPtr thread)\n{\n    pthread_cancel(thread->thread);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_cancel",
          "args": [
            "thread->thread"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virThreadCancel(virThreadPtr thread)\n{\n    pthread_cancel(thread->thread);\n}"
  },
  {
    "function_name": "virThreadJoin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "326-329",
    "snippet": "void virThreadJoin(virThreadPtr thread)\n{\n    pthread_join(thread->thread, NULL);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_join",
          "args": [
            "thread->thread",
            "NULL"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virThreadJoin(virThreadPtr thread)\n{\n    pthread_join(thread->thread, NULL);\n}"
  },
  {
    "function_name": "virThreadID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "316-324",
    "snippet": "unsigned long long virThreadID(virThreadPtr thread)\n{\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = thread->thread;\n    return u.l;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nunsigned long long virThreadID(virThreadPtr thread)\n{\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = thread->thread;\n    return u.l;\n}"
  },
  {
    "function_name": "virThreadSelfID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "298-311",
    "snippet": "unsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_gettid"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nunsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}"
  },
  {
    "function_name": "virThreadIsSelf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "290-293",
    "snippet": "bool virThreadIsSelf(virThreadPtr thread)\n{\n    return pthread_equal(pthread_self(), thread->thread) ? true : false;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_equal",
          "args": [
            "pthread_self()",
            "thread->thread"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nbool virThreadIsSelf(virThreadPtr thread)\n{\n    return pthread_equal(pthread_self(), thread->thread) ? true : false;\n}"
  },
  {
    "function_name": "virThreadSelf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "285-288",
    "snippet": "void virThreadSelf(virThreadPtr thread)\n{\n    thread->thread = pthread_self();\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virThreadSelf(virThreadPtr thread)\n{\n    thread->thread = pthread_self();\n}"
  },
  {
    "function_name": "virThreadCreateFull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "242-283",
    "snippet": "int virThreadCreateFull(virThreadPtr thread,\n                        bool joinable,\n                        virThreadFunc func,\n                        const char *name,\n                        bool worker,\n                        void *opaque)\n{\n    struct virThreadArgs *args;\n    pthread_attr_t attr;\n    int ret = -1;\n    int err;\n\n    if ((err = pthread_attr_init(&attr)) != 0)\n        goto cleanup;\n    if (VIR_ALLOC_QUIET(args) < 0) {\n        err = ENOMEM;\n        goto cleanup;\n    }\n\n    args->func = func;\n    args->name = g_strdup(name);\n    args->worker = worker;\n    args->opaque = opaque;\n\n    if (!joinable)\n        pthread_attr_setdetachstate(&attr, 1);\n\n    err = pthread_create(&thread->thread, &attr, virThreadHelper, args);\n    if (err != 0) {\n        g_free(args->name);\n        g_free(args);\n        goto cleanup;\n    }\n    /* New thread owns 'args' in success case, so don't free */\n\n    ret = 0;\n cleanup:\n    pthread_attr_destroy(&attr);\n    if (ret < 0)\n        errno = err;\n    return ret;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_attr_destroy",
          "args": [
            "&attr"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "args"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "args->name"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_create",
          "args": [
            "&thread->thread",
            "&attr",
            "virThreadHelper",
            "args"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_attr_setdetachstate",
          "args": [
            "&attr",
            "1"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_QUIET",
          "args": [
            "args"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_attr_init",
          "args": [
            "&attr"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadCreateFull(virThreadPtr thread,\n                        bool joinable,\n                        virThreadFunc func,\n                        const char *name,\n                        bool worker,\n                        void *opaque)\n{\n    struct virThreadArgs *args;\n    pthread_attr_t attr;\n    int ret = -1;\n    int err;\n\n    if ((err = pthread_attr_init(&attr)) != 0)\n        goto cleanup;\n    if (VIR_ALLOC_QUIET(args) < 0) {\n        err = ENOMEM;\n        goto cleanup;\n    }\n\n    args->func = func;\n    args->name = g_strdup(name);\n    args->worker = worker;\n    args->opaque = opaque;\n\n    if (!joinable)\n        pthread_attr_setdetachstate(&attr, 1);\n\n    err = pthread_create(&thread->thread, &attr, virThreadHelper, args);\n    if (err != 0) {\n        g_free(args->name);\n        g_free(args);\n        goto cleanup;\n    }\n    /* New thread owns 'args' in success case, so don't free */\n\n    ret = 0;\n cleanup:\n    pthread_attr_destroy(&attr);\n    if (ret < 0)\n        errno = err;\n    return ret;\n}"
  },
  {
    "function_name": "virThreadHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "200-240",
    "snippet": "static void *virThreadHelper(void *data)\n{\n    struct virThreadArgs *args = data;\n    struct virThreadArgs local = *args;\n    g_autofree char *thname = NULL;\n    size_t maxname = virThreadMaxName();\n\n    /* Free args early, rather than tying it up during the entire thread.  */\n    g_free(args);\n\n    if (local.worker)\n        virThreadJobSetWorker(local.name);\n    else\n        virThreadJobSet(local.name);\n\n    if (maxname) {\n        thname = g_strndup(local.name, maxname);\n    } else {\n        thname = g_strdup(local.name);\n    }\n\n#if defined(__linux__) || defined(WIN32)\n    pthread_setname_np(pthread_self(), thname);\n#else\n# ifdef __FreeBSD__\n    pthread_set_name_np(pthread_self(), thname);\n# else\n#  ifdef __APPLE__\n    pthread_setname_np(thname);\n#  endif\n# endif\n#endif\n\n    local.func(local.opaque);\n\n    if (!local.worker)\n        virThreadJobClear(0);\n\n    g_free(local.name);\n    return NULL;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "local.name"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadJobClear",
          "args": [
            "0"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadJobClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthreadjob.c",
          "lines": "102-124",
          "snippet": "void\nvirThreadJobClear(int rv)\n{\n    const char *old;\n    const char *worker;\n\n    if (virThreadJobInitialize() < 0)\n        return;\n\n    if (!(old = virThreadLocalGet(&virThreadJobName)))\n        return;\n\n    if (virThreadLocalSet(&virThreadJobName, NULL) < 0)\n        virReportSystemError(errno, \"%s\", _(\"cannot reset current job\"));\n\n    if ((worker = virThreadLocalGet(&virThreadJobWorker))) {\n        VIR_DEBUG(\"Thread %llu (%s) finished job %s with ret=%d\",\n                  virThreadSelfID(), worker, old, rv);\n    } else {\n        VIR_DEBUG(\"Thread %llu finished job %s with ret=%d\",\n                  virThreadSelfID(), old, rv);\n    }\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virThreadJobWorker;",
            "virThreadLocal virThreadJobName;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirThreadLocal virThreadJobWorker;\nvirThreadLocal virThreadJobName;\n\nvoid\nvirThreadJobClear(int rv)\n{\n    const char *old;\n    const char *worker;\n\n    if (virThreadJobInitialize() < 0)\n        return;\n\n    if (!(old = virThreadLocalGet(&virThreadJobName)))\n        return;\n\n    if (virThreadLocalSet(&virThreadJobName, NULL) < 0)\n        virReportSystemError(errno, \"%s\", _(\"cannot reset current job\"));\n\n    if ((worker = virThreadLocalGet(&virThreadJobWorker))) {\n        VIR_DEBUG(\"Thread %llu (%s) finished job %s with ret=%d\",\n                  virThreadSelfID(), worker, old, rv);\n    } else {\n        VIR_DEBUG(\"Thread %llu finished job %s with ret=%d\",\n                  virThreadSelfID(), old, rv);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "local.func",
          "args": [
            "local.opaque"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_setname_np",
          "args": [
            "thname"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_set_name_np",
          "args": [
            "pthread_self()",
            "thname"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_setname_np",
          "args": [
            "pthread_self()",
            "thname"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "local.name"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "local.name",
            "maxname"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadJobSet",
          "args": [
            "local.name"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadJobSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthreadjob.c",
          "lines": "79-99",
          "snippet": "void\nvirThreadJobSet(const char *caller)\n{\n    const char *worker;\n\n    if (!caller || virThreadJobInitialize() < 0)\n        return;\n\n    if (virThreadLocalSet(&virThreadJobName, (void *) caller) < 0)\n        virReportSystemError(errno,\n                             _(\"cannot set current job to %s\"),\n                             caller);\n\n    if ((worker = virThreadLocalGet(&virThreadJobWorker))) {\n        VIR_DEBUG(\"Thread %llu (%s) is now running job %s\",\n                  virThreadSelfID(), worker, caller);\n    } else {\n        VIR_DEBUG(\"Thread %llu is now running job %s\",\n                  virThreadSelfID(), caller);\n    }\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virThreadJobWorker;",
            "virThreadLocal virThreadJobName;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirThreadLocal virThreadJobWorker;\nvirThreadLocal virThreadJobName;\n\nvoid\nvirThreadJobSet(const char *caller)\n{\n    const char *worker;\n\n    if (!caller || virThreadJobInitialize() < 0)\n        return;\n\n    if (virThreadLocalSet(&virThreadJobName, (void *) caller) < 0)\n        virReportSystemError(errno,\n                             _(\"cannot set current job to %s\"),\n                             caller);\n\n    if ((worker = virThreadLocalGet(&virThreadJobWorker))) {\n        VIR_DEBUG(\"Thread %llu (%s) is now running job %s\",\n                  virThreadSelfID(), worker, caller);\n    } else {\n        VIR_DEBUG(\"Thread %llu is now running job %s\",\n                  virThreadSelfID(), caller);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadJobSetWorker",
          "args": [
            "local.name"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadJobSetWorker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthreadjob.c",
          "lines": "64-76",
          "snippet": "void\nvirThreadJobSetWorker(const char *worker)\n{\n    if (!worker || virThreadJobInitialize() < 0)\n        return;\n\n    if (virThreadLocalSet(&virThreadJobWorker, (void *) worker) < 0)\n        virReportSystemError(errno,\n                             _(\"cannot set worker name to %s\"),\n                             worker);\n\n    VIR_DEBUG(\"Thread %llu is running worker %s\", virThreadSelfID(), worker);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virThreadJobWorker;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirThreadLocal virThreadJobWorker;\n\nvoid\nvirThreadJobSetWorker(const char *worker)\n{\n    if (!worker || virThreadJobInitialize() < 0)\n        return;\n\n    if (virThreadLocalSet(&virThreadJobWorker, (void *) worker) < 0)\n        virReportSystemError(errno,\n                             _(\"cannot set worker name to %s\"),\n                             worker);\n\n    VIR_DEBUG(\"Thread %llu is running worker %s\", virThreadSelfID(), worker);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "args"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadMaxName",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadMaxName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "187-198",
          "snippet": "size_t virThreadMaxName(void)\n{\n#if defined(__FreeBSD__) || defined(__APPLE__)\n    return 63;\n#else\n# ifdef __linux__\n    return 15;\n# else\n    return 0; /* unlimited */\n# endif\n#endif\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nsize_t virThreadMaxName(void)\n{\n#if defined(__FreeBSD__) || defined(__APPLE__)\n    return 63;\n#else\n# ifdef __linux__\n    return 15;\n# else\n    return 0; /* unlimited */\n# endif\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nstatic void *virThreadHelper(void *data)\n{\n    struct virThreadArgs *args = data;\n    struct virThreadArgs local = *args;\n    g_autofree char *thname = NULL;\n    size_t maxname = virThreadMaxName();\n\n    /* Free args early, rather than tying it up during the entire thread.  */\n    g_free(args);\n\n    if (local.worker)\n        virThreadJobSetWorker(local.name);\n    else\n        virThreadJobSet(local.name);\n\n    if (maxname) {\n        thname = g_strndup(local.name, maxname);\n    } else {\n        thname = g_strdup(local.name);\n    }\n\n#if defined(__linux__) || defined(WIN32)\n    pthread_setname_np(pthread_self(), thname);\n#else\n# ifdef __FreeBSD__\n    pthread_set_name_np(pthread_self(), thname);\n# else\n#  ifdef __APPLE__\n    pthread_setname_np(thname);\n#  endif\n# endif\n#endif\n\n    local.func(local.opaque);\n\n    if (!local.worker)\n        virThreadJobClear(0);\n\n    g_free(local.name);\n    return NULL;\n}"
  },
  {
    "function_name": "virThreadMaxName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "187-198",
    "snippet": "size_t virThreadMaxName(void)\n{\n#if defined(__FreeBSD__) || defined(__APPLE__)\n    return 63;\n#else\n# ifdef __linux__\n    return 15;\n# else\n    return 0; /* unlimited */\n# endif\n#endif\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nsize_t virThreadMaxName(void)\n{\n#if defined(__FreeBSD__) || defined(__APPLE__)\n    return 63;\n#else\n# ifdef __linux__\n    return 15;\n# else\n    return 0; /* unlimited */\n# endif\n#endif\n}"
  },
  {
    "function_name": "virCondBroadcast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "175-178",
    "snippet": "void virCondBroadcast(virCondPtr c)\n{\n    pthread_cond_broadcast(&c->cond);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_cond_broadcast",
          "args": [
            "&c->cond"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virCondBroadcast(virCondPtr c)\n{\n    pthread_cond_broadcast(&c->cond);\n}"
  },
  {
    "function_name": "virCondSignal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "170-173",
    "snippet": "void virCondSignal(virCondPtr c)\n{\n    pthread_cond_signal(&c->cond);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_cond_signal",
          "args": [
            "&c->cond"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virCondSignal(virCondPtr c)\n{\n    pthread_cond_signal(&c->cond);\n}"
  },
  {
    "function_name": "virCondWaitUntil",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "155-168",
    "snippet": "int virCondWaitUntil(virCondPtr c, virMutexPtr m, unsigned long long whenms)\n{\n    int ret;\n    struct timespec ts;\n\n    ts.tv_sec = whenms / 1000;\n    ts.tv_nsec = (whenms % 1000) * 1000000;\n\n    if ((ret = pthread_cond_timedwait(&c->cond, &m->lock, &ts)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_cond_timedwait",
          "args": [
            "&c->cond",
            "&m->lock",
            "&ts"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virCondWaitUntil(virCondPtr c, virMutexPtr m, unsigned long long whenms)\n{\n    int ret;\n    struct timespec ts;\n\n    ts.tv_sec = whenms / 1000;\n    ts.tv_nsec = (whenms % 1000) * 1000000;\n\n    if ((ret = pthread_cond_timedwait(&c->cond, &m->lock, &ts)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virCondWait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "145-153",
    "snippet": "int virCondWait(virCondPtr c, virMutexPtr m)\n{\n    int ret;\n    if ((ret = pthread_cond_wait(&c->cond, &m->lock)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_cond_wait",
          "args": [
            "&c->cond",
            "&m->lock"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virCondWait(virCondPtr c, virMutexPtr m)\n{\n    int ret;\n    if ((ret = pthread_cond_wait(&c->cond, &m->lock)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virCondDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "135-143",
    "snippet": "int virCondDestroy(virCondPtr c)\n{\n    int ret;\n    if ((ret = pthread_cond_destroy(&c->cond)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_cond_destroy",
          "args": [
            "&c->cond"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virCondDestroy(virCondPtr c)\n{\n    int ret;\n    if ((ret = pthread_cond_destroy(&c->cond)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virCondInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "125-133",
    "snippet": "int virCondInit(virCondPtr c)\n{\n    int ret;\n    if ((ret = pthread_cond_init(&c->cond, NULL)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_cond_init",
          "args": [
            "&c->cond",
            "NULL"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virCondInit(virCondPtr c)\n{\n    int ret;\n    if ((ret = pthread_cond_init(&c->cond, NULL)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virRWLockUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "120-123",
    "snippet": "void virRWLockUnlock(virRWLockPtr m)\n{\n    pthread_rwlock_unlock(&m->lock);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_rwlock_unlock",
          "args": [
            "&m->lock"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virRWLockUnlock(virRWLockPtr m)\n{\n    pthread_rwlock_unlock(&m->lock);\n}"
  },
  {
    "function_name": "virRWLockWrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "114-117",
    "snippet": "void virRWLockWrite(virRWLockPtr m)\n{\n    pthread_rwlock_wrlock(&m->lock);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_rwlock_wrlock",
          "args": [
            "&m->lock"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virRWLockWrite(virRWLockPtr m)\n{\n    pthread_rwlock_wrlock(&m->lock);\n}"
  },
  {
    "function_name": "virRWLockRead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "109-112",
    "snippet": "void virRWLockRead(virRWLockPtr m)\n{\n    pthread_rwlock_rdlock(&m->lock);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_rwlock_rdlock",
          "args": [
            "&m->lock"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virRWLockRead(virRWLockPtr m)\n{\n    pthread_rwlock_rdlock(&m->lock);\n}"
  },
  {
    "function_name": "virRWLockDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "103-106",
    "snippet": "void virRWLockDestroy(virRWLockPtr m)\n{\n    pthread_rwlock_destroy(&m->lock);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_rwlock_destroy",
          "args": [
            "&m->lock"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virRWLockDestroy(virRWLockPtr m)\n{\n    pthread_rwlock_destroy(&m->lock);\n}"
  },
  {
    "function_name": "virRWLockInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "92-101",
    "snippet": "int virRWLockInit(virRWLockPtr m)\n{\n    int ret;\n    ret = pthread_rwlock_init(&m->lock, NULL);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_rwlock_init",
          "args": [
            "&m->lock",
            "NULL"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virRWLockInit(virRWLockPtr m)\n{\n    int ret;\n    ret = pthread_rwlock_init(&m->lock, NULL);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virMutexUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "86-89",
    "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&m->lock"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
  },
  {
    "function_name": "virMutexLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "81-84",
    "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&m->lock"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
  },
  {
    "function_name": "virMutexDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "76-79",
    "snippet": "void virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_mutex_destroy",
          "args": [
            "&m->lock"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}"
  },
  {
    "function_name": "virMutexInitRecursive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "61-74",
    "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_mutexattr_destroy",
          "args": [
            "&attr"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_init",
          "args": [
            "&m->lock",
            "&attr"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutexattr_settype",
          "args": [
            "&attr",
            "PTHREAD_MUTEX_RECURSIVE"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutexattr_init",
          "args": [
            "&attr"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virMutexInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "46-59",
    "snippet": "int virMutexInit(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_NORMAL);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_mutexattr_destroy",
          "args": [
            "&attr"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_init",
          "args": [
            "&m->lock",
            "&attr"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutexattr_settype",
          "args": [
            "&attr",
            "PTHREAD_MUTEX_NORMAL"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutexattr_init",
          "args": [
            "&attr"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInit(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_NORMAL);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virOnce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
    "lines": "40-43",
    "snippet": "int virOnce(virOnceControlPtr once, virOnceFunc init)\n{\n    return pthread_once(&once->once, init);\n}",
    "includes": [
      "#include \"virthreadjob.h\"",
      "#include \"viralloc.h\"",
      "# include <sys/syscall.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "# include <pthread_np.h>",
      "#include \"virthread.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_once",
          "args": [
            "&once->once",
            "init"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virOnce(virOnceControlPtr once, virOnceFunc init)\n{\n    return pthread_once(&once->once, init);\n}"
  }
]