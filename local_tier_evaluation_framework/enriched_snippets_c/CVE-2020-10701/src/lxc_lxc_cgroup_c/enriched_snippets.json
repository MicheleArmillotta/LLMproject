[
  {
    "function_name": "virLXCCgroupSetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "434-454",
    "snippet": "int virLXCCgroupSetup(virDomainDefPtr def,\n                      virCgroupPtr cgroup,\n                      virBitmapPtr nodemask)\n{\n    if (virLXCCgroupSetupCpuTune(def, cgroup) < 0)\n        return -1;\n\n    if (virLXCCgroupSetupCpusetTune(def, cgroup, nodemask) < 0)\n        return -1;\n\n    if (virLXCCgroupSetupBlkioTune(def, cgroup) < 0)\n        return -1;\n\n    if (virLXCCgroupSetupMemTune(def, cgroup) < 0)\n        return -1;\n\n    if (virLXCCgroupSetupDeviceACL(def, cgroup) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLXCCgroupSetupDeviceACL",
          "args": [
            "def",
            "cgroup"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupSetupDeviceACL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "220-381",
          "snippet": "static int virLXCCgroupSetupDeviceACL(virDomainDefPtr def,\n                                      virCgroupPtr cgroup)\n{\n    int capMknod = def->caps_features[VIR_DOMAIN_PROCES_CAPS_FEATURE_MKNOD];\n    size_t i;\n    static virLXCCgroupDevicePolicy devices[] = {\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_NULL},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_ZERO},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_FULL},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_RANDOM},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_URANDOM},\n        {'c', LXC_DEV_MAJ_TTY, LXC_DEV_MIN_TTY},\n        {'c', LXC_DEV_MAJ_TTY, LXC_DEV_MIN_PTMX},\n        {'c', LXC_DEV_MAJ_FUSE, LXC_DEV_MIN_FUSE},\n        {0,   0, 0}};\n\n    if (virCgroupDenyAllDevices(cgroup) < 0)\n        return -1;\n\n    /* white list mknod if CAP_MKNOD has to be kept */\n    if (capMknod == VIR_TRISTATE_SWITCH_ON) {\n        if (virCgroupAllowAllDevices(cgroup,\n                                    VIR_CGROUP_DEVICE_MKNOD) < 0)\n            return -1;\n    }\n\n    for (i = 0; devices[i].type != 0; i++) {\n        virLXCCgroupDevicePolicyPtr dev = &devices[i];\n        if (virCgroupAllowDevice(cgroup,\n                                 dev->type,\n                                 dev->major,\n                                 dev->minor,\n                                 VIR_CGROUP_DEVICE_RWM) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any disk block devs\");\n    for (i = 0; i < def->ndisks; i++) {\n        if (virStorageSourceIsEmpty(def->disks[i]->src) ||\n            !virStorageSourceIsBlockLocal(def->disks[i]->src))\n            continue;\n\n        if (virCgroupAllowDevicePath(cgroup,\n                                     virDomainDiskGetSource(def->disks[i]),\n                                     (def->disks[i]->src->readonly ?\n                                      VIR_CGROUP_DEVICE_READ :\n                                      VIR_CGROUP_DEVICE_RW) |\n                                     VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any filesystem block devs\");\n    for (i = 0; i < def->nfss; i++) {\n        if (def->fss[i]->type != VIR_DOMAIN_FS_TYPE_BLOCK)\n            continue;\n\n        if (virCgroupAllowDevicePath(cgroup,\n                                     def->fss[i]->src->path,\n                                     def->fss[i]->readonly ?\n                                     VIR_CGROUP_DEVICE_READ :\n                                     VIR_CGROUP_DEVICE_RW, false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any hostdev block devs\");\n    for (i = 0; i < def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n        virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n        virUSBDevicePtr usb;\n\n        switch (hostdev->mode) {\n        case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n            if (hostdev->source.subsys.type != VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB)\n                continue;\n            if (hostdev->missing)\n                continue;\n\n            if ((usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device,\n                                       NULL)) == NULL)\n                return -1;\n\n            if (virUSBDeviceFileIterate(usb, virLXCSetupHostUSBDeviceCgroup,\n                                        cgroup) < 0) {\n                virUSBDeviceFree(usb);\n                return -1;\n            }\n            virUSBDeviceFree(usb);\n            break;\n        case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n            switch (hostdev->source.caps.type) {\n            case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n                if (virCgroupAllowDevicePath(cgroup,\n                                             hostdev->source.caps.u.storage.block,\n                                             VIR_CGROUP_DEVICE_RW |\n                                             VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n                    return -1;\n                break;\n            case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n                if (virCgroupAllowDevicePath(cgroup,\n                                             hostdev->source.caps.u.misc.chardev,\n                                             VIR_CGROUP_DEVICE_RW |\n                                             VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n                    return -1;\n                break;\n            default:\n                break;\n            }\n        default:\n            break;\n        }\n    }\n\n    if (virCgroupAllowDevice(cgroup, 'c', LXC_DEV_MAJ_PTY, -1,\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Allowing timers char devices\");\n\n    /* Sync'ed with Host clock */\n    for (i = 0; i < def->clock.ntimers; i++) {\n        virDomainTimerDefPtr timer = def->clock.timers[i];\n        const char *dev = NULL;\n\n        /* Check if \"present\" is set to \"no\" otherwise enable it. */\n        if (!timer->present)\n            continue;\n\n        switch ((virDomainTimerNameType)timer->name) {\n        case VIR_DOMAIN_TIMER_NAME_PLATFORM:\n        case VIR_DOMAIN_TIMER_NAME_TSC:\n        case VIR_DOMAIN_TIMER_NAME_KVMCLOCK:\n        case VIR_DOMAIN_TIMER_NAME_HYPERVCLOCK:\n        case VIR_DOMAIN_TIMER_NAME_PIT:\n        case VIR_DOMAIN_TIMER_NAME_ARMVTIMER:\n        case VIR_DOMAIN_TIMER_NAME_LAST:\n            break;\n        case VIR_DOMAIN_TIMER_NAME_RTC:\n            dev = \"/dev/rtc0\";\n            break;\n        case VIR_DOMAIN_TIMER_NAME_HPET:\n            dev = \"/dev/hpet\";\n            break;\n        }\n\n        if (!dev)\n            continue;\n\n        if (!virFileExists(dev)) {\n            VIR_DEBUG(\"Ignoring non-existent device %s\", dev);\n            continue;\n        }\n\n        if (virCgroupAllowDevicePath(cgroup, dev,\n                                     VIR_CGROUP_DEVICE_READ,\n                                     false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Device whitelist complete\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupDeviceACL(virDomainDefPtr def,\n                                      virCgroupPtr cgroup)\n{\n    int capMknod = def->caps_features[VIR_DOMAIN_PROCES_CAPS_FEATURE_MKNOD];\n    size_t i;\n    static virLXCCgroupDevicePolicy devices[] = {\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_NULL},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_ZERO},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_FULL},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_RANDOM},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_URANDOM},\n        {'c', LXC_DEV_MAJ_TTY, LXC_DEV_MIN_TTY},\n        {'c', LXC_DEV_MAJ_TTY, LXC_DEV_MIN_PTMX},\n        {'c', LXC_DEV_MAJ_FUSE, LXC_DEV_MIN_FUSE},\n        {0,   0, 0}};\n\n    if (virCgroupDenyAllDevices(cgroup) < 0)\n        return -1;\n\n    /* white list mknod if CAP_MKNOD has to be kept */\n    if (capMknod == VIR_TRISTATE_SWITCH_ON) {\n        if (virCgroupAllowAllDevices(cgroup,\n                                    VIR_CGROUP_DEVICE_MKNOD) < 0)\n            return -1;\n    }\n\n    for (i = 0; devices[i].type != 0; i++) {\n        virLXCCgroupDevicePolicyPtr dev = &devices[i];\n        if (virCgroupAllowDevice(cgroup,\n                                 dev->type,\n                                 dev->major,\n                                 dev->minor,\n                                 VIR_CGROUP_DEVICE_RWM) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any disk block devs\");\n    for (i = 0; i < def->ndisks; i++) {\n        if (virStorageSourceIsEmpty(def->disks[i]->src) ||\n            !virStorageSourceIsBlockLocal(def->disks[i]->src))\n            continue;\n\n        if (virCgroupAllowDevicePath(cgroup,\n                                     virDomainDiskGetSource(def->disks[i]),\n                                     (def->disks[i]->src->readonly ?\n                                      VIR_CGROUP_DEVICE_READ :\n                                      VIR_CGROUP_DEVICE_RW) |\n                                     VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any filesystem block devs\");\n    for (i = 0; i < def->nfss; i++) {\n        if (def->fss[i]->type != VIR_DOMAIN_FS_TYPE_BLOCK)\n            continue;\n\n        if (virCgroupAllowDevicePath(cgroup,\n                                     def->fss[i]->src->path,\n                                     def->fss[i]->readonly ?\n                                     VIR_CGROUP_DEVICE_READ :\n                                     VIR_CGROUP_DEVICE_RW, false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any hostdev block devs\");\n    for (i = 0; i < def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n        virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n        virUSBDevicePtr usb;\n\n        switch (hostdev->mode) {\n        case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n            if (hostdev->source.subsys.type != VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB)\n                continue;\n            if (hostdev->missing)\n                continue;\n\n            if ((usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device,\n                                       NULL)) == NULL)\n                return -1;\n\n            if (virUSBDeviceFileIterate(usb, virLXCSetupHostUSBDeviceCgroup,\n                                        cgroup) < 0) {\n                virUSBDeviceFree(usb);\n                return -1;\n            }\n            virUSBDeviceFree(usb);\n            break;\n        case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n            switch (hostdev->source.caps.type) {\n            case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n                if (virCgroupAllowDevicePath(cgroup,\n                                             hostdev->source.caps.u.storage.block,\n                                             VIR_CGROUP_DEVICE_RW |\n                                             VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n                    return -1;\n                break;\n            case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n                if (virCgroupAllowDevicePath(cgroup,\n                                             hostdev->source.caps.u.misc.chardev,\n                                             VIR_CGROUP_DEVICE_RW |\n                                             VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n                    return -1;\n                break;\n            default:\n                break;\n            }\n        default:\n            break;\n        }\n    }\n\n    if (virCgroupAllowDevice(cgroup, 'c', LXC_DEV_MAJ_PTY, -1,\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Allowing timers char devices\");\n\n    /* Sync'ed with Host clock */\n    for (i = 0; i < def->clock.ntimers; i++) {\n        virDomainTimerDefPtr timer = def->clock.timers[i];\n        const char *dev = NULL;\n\n        /* Check if \"present\" is set to \"no\" otherwise enable it. */\n        if (!timer->present)\n            continue;\n\n        switch ((virDomainTimerNameType)timer->name) {\n        case VIR_DOMAIN_TIMER_NAME_PLATFORM:\n        case VIR_DOMAIN_TIMER_NAME_TSC:\n        case VIR_DOMAIN_TIMER_NAME_KVMCLOCK:\n        case VIR_DOMAIN_TIMER_NAME_HYPERVCLOCK:\n        case VIR_DOMAIN_TIMER_NAME_PIT:\n        case VIR_DOMAIN_TIMER_NAME_ARMVTIMER:\n        case VIR_DOMAIN_TIMER_NAME_LAST:\n            break;\n        case VIR_DOMAIN_TIMER_NAME_RTC:\n            dev = \"/dev/rtc0\";\n            break;\n        case VIR_DOMAIN_TIMER_NAME_HPET:\n            dev = \"/dev/hpet\";\n            break;\n        }\n\n        if (!dev)\n            continue;\n\n        if (!virFileExists(dev)) {\n            VIR_DEBUG(\"Ignoring non-existent device %s\", dev);\n            continue;\n        }\n\n        if (virCgroupAllowDevicePath(cgroup, dev,\n                                     VIR_CGROUP_DEVICE_READ,\n                                     false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Device whitelist complete\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupSetupMemTune",
          "args": [
            "def",
            "cgroup"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupSetupMemTune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "90-97",
          "snippet": "static int virLXCCgroupSetupMemTune(virDomainDefPtr def,\n                                    virCgroupPtr cgroup)\n{\n    if (virCgroupSetMemory(cgroup, virDomainDefGetMemoryInitial(def)) < 0)\n        return -1;\n\n    return virDomainCgroupSetupMemtune(cgroup, def->mem);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupMemTune(virDomainDefPtr def,\n                                    virCgroupPtr cgroup)\n{\n    if (virCgroupSetMemory(cgroup, virDomainDefGetMemoryInitial(def)) < 0)\n        return -1;\n\n    return virDomainCgroupSetupMemtune(cgroup, def->mem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupSetupBlkioTune",
          "args": [
            "def",
            "cgroup"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupSetupBlkioTune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "83-87",
          "snippet": "static int virLXCCgroupSetupBlkioTune(virDomainDefPtr def,\n                                      virCgroupPtr cgroup)\n{\n    return virDomainCgroupSetupBlkio(cgroup, def->blkio);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupBlkioTune(virDomainDefPtr def,\n                                      virCgroupPtr cgroup)\n{\n    return virDomainCgroupSetupBlkio(cgroup, def->blkio);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupSetupCpusetTune",
          "args": [
            "def",
            "cgroup",
            "nodemask"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupSetupCpusetTune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "54-80",
          "snippet": "static int virLXCCgroupSetupCpusetTune(virDomainDefPtr def,\n                                       virCgroupPtr cgroup,\n                                       virBitmapPtr nodemask)\n{\n    g_autofree char *mask = NULL;\n    virDomainNumatuneMemMode mode;\n\n    if (def->placement_mode != VIR_DOMAIN_CPU_PLACEMENT_MODE_AUTO &&\n        def->cpumask &&\n        virCgroupSetupCpusetCpus(cgroup, def->cpumask) < 0) {\n        return -1;\n    }\n\n    if (virDomainNumatuneGetMode(def->numa, -1, &mode) < 0 ||\n        mode == VIR_DOMAIN_NUMATUNE_MEM_STRICT) {\n        return 0;\n    }\n\n    if (virDomainNumatuneMaybeFormatNodeset(def->numa, nodemask,\n                                            &mask, -1) < 0)\n        return -1;\n\n    if (mask && virCgroupSetCpusetMems(cgroup, mask) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupCpusetTune(virDomainDefPtr def,\n                                       virCgroupPtr cgroup,\n                                       virBitmapPtr nodemask)\n{\n    g_autofree char *mask = NULL;\n    virDomainNumatuneMemMode mode;\n\n    if (def->placement_mode != VIR_DOMAIN_CPU_PLACEMENT_MODE_AUTO &&\n        def->cpumask &&\n        virCgroupSetupCpusetCpus(cgroup, def->cpumask) < 0) {\n        return -1;\n    }\n\n    if (virDomainNumatuneGetMode(def->numa, -1, &mode) < 0 ||\n        mode == VIR_DOMAIN_NUMATUNE_MEM_STRICT) {\n        return 0;\n    }\n\n    if (virDomainNumatuneMaybeFormatNodeset(def->numa, nodemask,\n                                            &mask, -1) < 0)\n        return -1;\n\n    if (mask && virCgroupSetCpusetMems(cgroup, mask) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupSetupCpuTune",
          "args": [
            "def",
            "cgroup"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupSetupCpuTune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "39-51",
          "snippet": "static int virLXCCgroupSetupCpuTune(virDomainDefPtr def,\n                                    virCgroupPtr cgroup)\n{\n    if (def->cputune.sharesSpecified) {\n        unsigned long long val;\n        if (virCgroupSetupCpuShares(cgroup, def->cputune.shares, &val) < 0)\n            return -1;\n        def->cputune.shares = val;\n    }\n\n    return virCgroupSetupCpuPeriodQuota(cgroup, def->cputune.period,\n                                        def->cputune.quota);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupCpuTune(virDomainDefPtr def,\n                                    virCgroupPtr cgroup)\n{\n    if (def->cputune.sharesSpecified) {\n        unsigned long long val;\n        if (virCgroupSetupCpuShares(cgroup, def->cputune.shares, &val) < 0)\n            return -1;\n        def->cputune.shares = val;\n    }\n\n    return virCgroupSetupCpuPeriodQuota(cgroup, def->cputune.period,\n                                        def->cputune.quota);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nint virLXCCgroupSetup(virDomainDefPtr def,\n                      virCgroupPtr cgroup,\n                      virBitmapPtr nodemask)\n{\n    if (virLXCCgroupSetupCpuTune(def, cgroup) < 0)\n        return -1;\n\n    if (virLXCCgroupSetupCpusetTune(def, cgroup, nodemask) < 0)\n        return -1;\n\n    if (virLXCCgroupSetupBlkioTune(def, cgroup) < 0)\n        return -1;\n\n    if (virLXCCgroupSetupMemTune(def, cgroup) < 0)\n        return -1;\n\n    if (virLXCCgroupSetupDeviceACL(def, cgroup) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virLXCCgroupCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "384-431",
    "snippet": "virCgroupPtr virLXCCgroupCreate(virDomainDefPtr def,\n                                pid_t initpid,\n                                size_t nnicindexes,\n                                int *nicindexes)\n{\n    virCgroupPtr cgroup = NULL;\n    char *machineName = virLXCDomainGetMachineName(def, 0);\n\n    if (!machineName)\n        goto cleanup;\n\n    if (def->resource->partition[0] != '/') {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Resource partition '%s' must start with '/'\"),\n                       def->resource->partition);\n        goto cleanup;\n    }\n\n    if (virCgroupNewMachine(machineName,\n                            \"lxc\",\n                            def->uuid,\n                            NULL,\n                            initpid,\n                            true,\n                            nnicindexes, nicindexes,\n                            def->resource->partition,\n                            -1,\n                            0,\n                            &cgroup) < 0)\n        goto cleanup;\n\n    /* setup control group permissions for user namespace */\n    if (def->idmap.uidmap) {\n        if (virCgroupSetOwner(cgroup,\n                              def->idmap.uidmap[0].target,\n                              def->idmap.gidmap[0].target,\n                              (1 << VIR_CGROUP_CONTROLLER_SYSTEMD)) < 0) {\n            virCgroupFree(&cgroup);\n            cgroup = NULL;\n            goto cleanup;\n        }\n    }\n\n cleanup:\n    VIR_FREE(machineName);\n\n    return cgroup;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "machineName"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&cgroup"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetOwner",
          "args": [
            "cgroup",
            "def->idmap.uidmap[0].target",
            "def->idmap.gidmap[0].target",
            "(1 << VIR_CGROUP_CONTROLLER_SYSTEMD)"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetOwner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3511-3520",
          "snippet": "int\nvirCgroupSetOwner(virCgroupPtr cgroup G_GNUC_UNUSED,\n                  uid_t uid G_GNUC_UNUSED,\n                  gid_t gid G_GNUC_UNUSED,\n                  int controllers G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetOwner(virCgroupPtr cgroup G_GNUC_UNUSED,\n                  uid_t uid G_GNUC_UNUSED,\n                  gid_t gid G_GNUC_UNUSED,\n                  int controllers G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewMachine",
          "args": [
            "machineName",
            "\"lxc\"",
            "def->uuid",
            "NULL",
            "initpid",
            "true",
            "nnicindexes",
            "nicindexes",
            "def->resource->partition",
            "-1",
            "0",
            "&cgroup"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2871-2888",
          "snippet": "int\nvirCgroupNewMachine(const char *name G_GNUC_UNUSED,\n                    const char *drivername G_GNUC_UNUSED,\n                    const unsigned char *uuid G_GNUC_UNUSED,\n                    const char *rootdir G_GNUC_UNUSED,\n                    pid_t pidleader G_GNUC_UNUSED,\n                    bool isContainer G_GNUC_UNUSED,\n                    size_t nnicindexes G_GNUC_UNUSED,\n                    int *nicindexes G_GNUC_UNUSED,\n                    const char *partition G_GNUC_UNUSED,\n                    int controllers G_GNUC_UNUSED,\n                    unsigned int maxthreads G_GNUC_UNUSED,\n                    virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewMachine(const char *name G_GNUC_UNUSED,\n                    const char *drivername G_GNUC_UNUSED,\n                    const unsigned char *uuid G_GNUC_UNUSED,\n                    const char *rootdir G_GNUC_UNUSED,\n                    pid_t pidleader G_GNUC_UNUSED,\n                    bool isContainer G_GNUC_UNUSED,\n                    size_t nnicindexes G_GNUC_UNUSED,\n                    int *nicindexes G_GNUC_UNUSED,\n                    const char *partition G_GNUC_UNUSED,\n                    int controllers G_GNUC_UNUSED,\n                    unsigned int maxthreads G_GNUC_UNUSED,\n                    virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Resource partition '%s' must start with '/'\")",
            "def->resource->partition"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Resource partition '%s' must start with '/'\""
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainGetMachineName",
          "args": [
            "def",
            "0"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainGetMachineName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "397-412",
          "snippet": "char *\nvirLXCDomainGetMachineName(virDomainDefPtr def, pid_t pid)\n{\n    char *ret = NULL;\n\n    if (pid) {\n        ret = virSystemdGetMachineNameByPID(pid);\n        if (!ret)\n            virResetLastError();\n    }\n\n    if (!ret)\n        ret = virDomainGenerateMachineName(\"lxc\", NULL, def->id, def->name, true);\n\n    return ret;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nchar *\nvirLXCDomainGetMachineName(virDomainDefPtr def, pid_t pid)\n{\n    char *ret = NULL;\n\n    if (pid) {\n        ret = virSystemdGetMachineNameByPID(pid);\n        if (!ret)\n            virResetLastError();\n    }\n\n    if (!ret)\n        ret = virDomainGenerateMachineName(\"lxc\", NULL, def->id, def->name, true);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nvirCgroupPtr virLXCCgroupCreate(virDomainDefPtr def,\n                                pid_t initpid,\n                                size_t nnicindexes,\n                                int *nicindexes)\n{\n    virCgroupPtr cgroup = NULL;\n    char *machineName = virLXCDomainGetMachineName(def, 0);\n\n    if (!machineName)\n        goto cleanup;\n\n    if (def->resource->partition[0] != '/') {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Resource partition '%s' must start with '/'\"),\n                       def->resource->partition);\n        goto cleanup;\n    }\n\n    if (virCgroupNewMachine(machineName,\n                            \"lxc\",\n                            def->uuid,\n                            NULL,\n                            initpid,\n                            true,\n                            nnicindexes, nicindexes,\n                            def->resource->partition,\n                            -1,\n                            0,\n                            &cgroup) < 0)\n        goto cleanup;\n\n    /* setup control group permissions for user namespace */\n    if (def->idmap.uidmap) {\n        if (virCgroupSetOwner(cgroup,\n                              def->idmap.uidmap[0].target,\n                              def->idmap.gidmap[0].target,\n                              (1 << VIR_CGROUP_CONTROLLER_SYSTEMD)) < 0) {\n            virCgroupFree(&cgroup);\n            cgroup = NULL;\n            goto cleanup;\n        }\n    }\n\n cleanup:\n    VIR_FREE(machineName);\n\n    return cgroup;\n}"
  },
  {
    "function_name": "virLXCCgroupSetupDeviceACL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "220-381",
    "snippet": "static int virLXCCgroupSetupDeviceACL(virDomainDefPtr def,\n                                      virCgroupPtr cgroup)\n{\n    int capMknod = def->caps_features[VIR_DOMAIN_PROCES_CAPS_FEATURE_MKNOD];\n    size_t i;\n    static virLXCCgroupDevicePolicy devices[] = {\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_NULL},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_ZERO},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_FULL},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_RANDOM},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_URANDOM},\n        {'c', LXC_DEV_MAJ_TTY, LXC_DEV_MIN_TTY},\n        {'c', LXC_DEV_MAJ_TTY, LXC_DEV_MIN_PTMX},\n        {'c', LXC_DEV_MAJ_FUSE, LXC_DEV_MIN_FUSE},\n        {0,   0, 0}};\n\n    if (virCgroupDenyAllDevices(cgroup) < 0)\n        return -1;\n\n    /* white list mknod if CAP_MKNOD has to be kept */\n    if (capMknod == VIR_TRISTATE_SWITCH_ON) {\n        if (virCgroupAllowAllDevices(cgroup,\n                                    VIR_CGROUP_DEVICE_MKNOD) < 0)\n            return -1;\n    }\n\n    for (i = 0; devices[i].type != 0; i++) {\n        virLXCCgroupDevicePolicyPtr dev = &devices[i];\n        if (virCgroupAllowDevice(cgroup,\n                                 dev->type,\n                                 dev->major,\n                                 dev->minor,\n                                 VIR_CGROUP_DEVICE_RWM) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any disk block devs\");\n    for (i = 0; i < def->ndisks; i++) {\n        if (virStorageSourceIsEmpty(def->disks[i]->src) ||\n            !virStorageSourceIsBlockLocal(def->disks[i]->src))\n            continue;\n\n        if (virCgroupAllowDevicePath(cgroup,\n                                     virDomainDiskGetSource(def->disks[i]),\n                                     (def->disks[i]->src->readonly ?\n                                      VIR_CGROUP_DEVICE_READ :\n                                      VIR_CGROUP_DEVICE_RW) |\n                                     VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any filesystem block devs\");\n    for (i = 0; i < def->nfss; i++) {\n        if (def->fss[i]->type != VIR_DOMAIN_FS_TYPE_BLOCK)\n            continue;\n\n        if (virCgroupAllowDevicePath(cgroup,\n                                     def->fss[i]->src->path,\n                                     def->fss[i]->readonly ?\n                                     VIR_CGROUP_DEVICE_READ :\n                                     VIR_CGROUP_DEVICE_RW, false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any hostdev block devs\");\n    for (i = 0; i < def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n        virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n        virUSBDevicePtr usb;\n\n        switch (hostdev->mode) {\n        case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n            if (hostdev->source.subsys.type != VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB)\n                continue;\n            if (hostdev->missing)\n                continue;\n\n            if ((usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device,\n                                       NULL)) == NULL)\n                return -1;\n\n            if (virUSBDeviceFileIterate(usb, virLXCSetupHostUSBDeviceCgroup,\n                                        cgroup) < 0) {\n                virUSBDeviceFree(usb);\n                return -1;\n            }\n            virUSBDeviceFree(usb);\n            break;\n        case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n            switch (hostdev->source.caps.type) {\n            case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n                if (virCgroupAllowDevicePath(cgroup,\n                                             hostdev->source.caps.u.storage.block,\n                                             VIR_CGROUP_DEVICE_RW |\n                                             VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n                    return -1;\n                break;\n            case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n                if (virCgroupAllowDevicePath(cgroup,\n                                             hostdev->source.caps.u.misc.chardev,\n                                             VIR_CGROUP_DEVICE_RW |\n                                             VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n                    return -1;\n                break;\n            default:\n                break;\n            }\n        default:\n            break;\n        }\n    }\n\n    if (virCgroupAllowDevice(cgroup, 'c', LXC_DEV_MAJ_PTY, -1,\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Allowing timers char devices\");\n\n    /* Sync'ed with Host clock */\n    for (i = 0; i < def->clock.ntimers; i++) {\n        virDomainTimerDefPtr timer = def->clock.timers[i];\n        const char *dev = NULL;\n\n        /* Check if \"present\" is set to \"no\" otherwise enable it. */\n        if (!timer->present)\n            continue;\n\n        switch ((virDomainTimerNameType)timer->name) {\n        case VIR_DOMAIN_TIMER_NAME_PLATFORM:\n        case VIR_DOMAIN_TIMER_NAME_TSC:\n        case VIR_DOMAIN_TIMER_NAME_KVMCLOCK:\n        case VIR_DOMAIN_TIMER_NAME_HYPERVCLOCK:\n        case VIR_DOMAIN_TIMER_NAME_PIT:\n        case VIR_DOMAIN_TIMER_NAME_ARMVTIMER:\n        case VIR_DOMAIN_TIMER_NAME_LAST:\n            break;\n        case VIR_DOMAIN_TIMER_NAME_RTC:\n            dev = \"/dev/rtc0\";\n            break;\n        case VIR_DOMAIN_TIMER_NAME_HPET:\n            dev = \"/dev/hpet\";\n            break;\n        }\n\n        if (!dev)\n            continue;\n\n        if (!virFileExists(dev)) {\n            VIR_DEBUG(\"Ignoring non-existent device %s\", dev);\n            continue;\n        }\n\n        if (virCgroupAllowDevicePath(cgroup, dev,\n                                     VIR_CGROUP_DEVICE_READ,\n                                     false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Device whitelist complete\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Device whitelist complete\""
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "cgroup",
            "dev",
            "VIR_CGROUP_DEVICE_READ",
            "false"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Ignoring non-existent device %s\"",
            "dev"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "dev"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Allowing timers char devices\""
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevice",
          "args": [
            "cgroup",
            "'c'",
            "LXC_DEV_MAJ_PTY",
            "-1",
            "VIR_CGROUP_DEVICE_RWM"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3278-3288",
          "snippet": "int\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUSBDeviceFree",
          "args": [
            "usb"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "353-363",
          "snippet": "void\nvirUSBDeviceFree(virUSBDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirUSBDeviceFree(virUSBDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUSBDeviceFileIterate",
          "args": [
            "usb",
            "virLXCSetupHostUSBDeviceCgroup",
            "cgroup"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceFileIterate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "409-414",
          "snippet": "int virUSBDeviceFileIterate(virUSBDevicePtr dev,\n                            virUSBDeviceFileActor actor,\n                            void *opaque)\n{\n    return (actor)(dev, dev->path, opaque);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint virUSBDeviceFileIterate(virUSBDevicePtr dev,\n                            virUSBDeviceFileActor actor,\n                            void *opaque)\n{\n    return (actor)(dev, dev->path, opaque);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUSBDeviceNew",
          "args": [
            "usbsrc->bus",
            "usbsrc->device",
            "NULL"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "308-351",
          "snippet": "virUSBDevicePtr\nvirUSBDeviceNew(unsigned int bus,\n                unsigned int devno,\n                const char *vroot)\n{\n    virUSBDevicePtr dev;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->bus     = bus;\n    dev->dev     = devno;\n\n    if (g_snprintf(dev->name, sizeof(dev->name), \"%.3d:%.3d\",\n                   dev->bus, dev->dev) >= sizeof(dev->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->name buffer overflow: %.3d:%.3d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    if (vroot) {\n        dev->path = g_strdup_printf(\"%s/%03d/%03d\",\n                                    vroot, dev->bus, dev->dev);\n    } else {\n        dev->path = g_strdup_printf(USB_DEVFS \"%03d/%03d\",\n                                    dev->bus, dev->dev);\n    }\n\n    /* XXX fixme. this should be product/vendor */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%d %d\", dev->bus,\n                   dev->dev) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %d %d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return dev;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nvirUSBDevicePtr\nvirUSBDeviceNew(unsigned int bus,\n                unsigned int devno,\n                const char *vroot)\n{\n    virUSBDevicePtr dev;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->bus     = bus;\n    dev->dev     = devno;\n\n    if (g_snprintf(dev->name, sizeof(dev->name), \"%.3d:%.3d\",\n                   dev->bus, dev->dev) >= sizeof(dev->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->name buffer overflow: %.3d:%.3d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    if (vroot) {\n        dev->path = g_strdup_printf(\"%s/%03d/%03d\",\n                                    vroot, dev->bus, dev->dev);\n    } else {\n        dev->path = g_strdup_printf(USB_DEVFS \"%03d/%03d\",\n                                    dev->bus, dev->dev);\n    }\n\n    /* XXX fixme. this should be product/vendor */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%d %d\", dev->bus,\n                   dev->dev) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %d %d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return dev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Allowing any hostdev block devs\""
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Allowing any filesystem block devs\""
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetSource",
          "args": [
            "def->disks[i]"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2155-2159",
          "snippet": "const char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBlockLocal",
          "args": [
            "def->disks[i]->src"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBlockLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2643-2647",
          "snippet": "bool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsEmpty",
          "args": [
            "def->disks[i]->src"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2619-2633",
          "snippet": "bool\nvirStorageSourceIsEmpty(virStorageSourcePtr src)\n{\n    if (virStorageSourceIsLocalStorage(src) && !src->path)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NONE)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NETWORK &&\n        src->protocol == VIR_STORAGE_NET_PROTOCOL_NONE)\n        return true;\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsEmpty(virStorageSourcePtr src)\n{\n    if (virStorageSourceIsLocalStorage(src) && !src->path)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NONE)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NETWORK &&\n        src->protocol == VIR_STORAGE_NET_PROTOCOL_NONE)\n        return true;\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Allowing any disk block devs\""
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupAllowAllDevices",
          "args": [
            "cgroup",
            "VIR_CGROUP_DEVICE_MKNOD"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowAllDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3260-3267",
          "snippet": "int\nvirCgroupAllowAllDevices(virCgroupPtr group G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowAllDevices(virCgroupPtr group G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyAllDevices",
          "args": [
            "cgroup"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyAllDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3269-3275",
          "snippet": "int\nvirCgroupDenyAllDevices(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyAllDevices(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupDeviceACL(virDomainDefPtr def,\n                                      virCgroupPtr cgroup)\n{\n    int capMknod = def->caps_features[VIR_DOMAIN_PROCES_CAPS_FEATURE_MKNOD];\n    size_t i;\n    static virLXCCgroupDevicePolicy devices[] = {\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_NULL},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_ZERO},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_FULL},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_RANDOM},\n        {'c', LXC_DEV_MAJ_MEMORY, LXC_DEV_MIN_URANDOM},\n        {'c', LXC_DEV_MAJ_TTY, LXC_DEV_MIN_TTY},\n        {'c', LXC_DEV_MAJ_TTY, LXC_DEV_MIN_PTMX},\n        {'c', LXC_DEV_MAJ_FUSE, LXC_DEV_MIN_FUSE},\n        {0,   0, 0}};\n\n    if (virCgroupDenyAllDevices(cgroup) < 0)\n        return -1;\n\n    /* white list mknod if CAP_MKNOD has to be kept */\n    if (capMknod == VIR_TRISTATE_SWITCH_ON) {\n        if (virCgroupAllowAllDevices(cgroup,\n                                    VIR_CGROUP_DEVICE_MKNOD) < 0)\n            return -1;\n    }\n\n    for (i = 0; devices[i].type != 0; i++) {\n        virLXCCgroupDevicePolicyPtr dev = &devices[i];\n        if (virCgroupAllowDevice(cgroup,\n                                 dev->type,\n                                 dev->major,\n                                 dev->minor,\n                                 VIR_CGROUP_DEVICE_RWM) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any disk block devs\");\n    for (i = 0; i < def->ndisks; i++) {\n        if (virStorageSourceIsEmpty(def->disks[i]->src) ||\n            !virStorageSourceIsBlockLocal(def->disks[i]->src))\n            continue;\n\n        if (virCgroupAllowDevicePath(cgroup,\n                                     virDomainDiskGetSource(def->disks[i]),\n                                     (def->disks[i]->src->readonly ?\n                                      VIR_CGROUP_DEVICE_READ :\n                                      VIR_CGROUP_DEVICE_RW) |\n                                     VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any filesystem block devs\");\n    for (i = 0; i < def->nfss; i++) {\n        if (def->fss[i]->type != VIR_DOMAIN_FS_TYPE_BLOCK)\n            continue;\n\n        if (virCgroupAllowDevicePath(cgroup,\n                                     def->fss[i]->src->path,\n                                     def->fss[i]->readonly ?\n                                     VIR_CGROUP_DEVICE_READ :\n                                     VIR_CGROUP_DEVICE_RW, false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Allowing any hostdev block devs\");\n    for (i = 0; i < def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n        virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n        virUSBDevicePtr usb;\n\n        switch (hostdev->mode) {\n        case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n            if (hostdev->source.subsys.type != VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB)\n                continue;\n            if (hostdev->missing)\n                continue;\n\n            if ((usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device,\n                                       NULL)) == NULL)\n                return -1;\n\n            if (virUSBDeviceFileIterate(usb, virLXCSetupHostUSBDeviceCgroup,\n                                        cgroup) < 0) {\n                virUSBDeviceFree(usb);\n                return -1;\n            }\n            virUSBDeviceFree(usb);\n            break;\n        case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n            switch (hostdev->source.caps.type) {\n            case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n                if (virCgroupAllowDevicePath(cgroup,\n                                             hostdev->source.caps.u.storage.block,\n                                             VIR_CGROUP_DEVICE_RW |\n                                             VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n                    return -1;\n                break;\n            case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n                if (virCgroupAllowDevicePath(cgroup,\n                                             hostdev->source.caps.u.misc.chardev,\n                                             VIR_CGROUP_DEVICE_RW |\n                                             VIR_CGROUP_DEVICE_MKNOD, false) < 0)\n                    return -1;\n                break;\n            default:\n                break;\n            }\n        default:\n            break;\n        }\n    }\n\n    if (virCgroupAllowDevice(cgroup, 'c', LXC_DEV_MAJ_PTY, -1,\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Allowing timers char devices\");\n\n    /* Sync'ed with Host clock */\n    for (i = 0; i < def->clock.ntimers; i++) {\n        virDomainTimerDefPtr timer = def->clock.timers[i];\n        const char *dev = NULL;\n\n        /* Check if \"present\" is set to \"no\" otherwise enable it. */\n        if (!timer->present)\n            continue;\n\n        switch ((virDomainTimerNameType)timer->name) {\n        case VIR_DOMAIN_TIMER_NAME_PLATFORM:\n        case VIR_DOMAIN_TIMER_NAME_TSC:\n        case VIR_DOMAIN_TIMER_NAME_KVMCLOCK:\n        case VIR_DOMAIN_TIMER_NAME_HYPERVCLOCK:\n        case VIR_DOMAIN_TIMER_NAME_PIT:\n        case VIR_DOMAIN_TIMER_NAME_ARMVTIMER:\n        case VIR_DOMAIN_TIMER_NAME_LAST:\n            break;\n        case VIR_DOMAIN_TIMER_NAME_RTC:\n            dev = \"/dev/rtc0\";\n            break;\n        case VIR_DOMAIN_TIMER_NAME_HPET:\n            dev = \"/dev/hpet\";\n            break;\n        }\n\n        if (!dev)\n            continue;\n\n        if (!virFileExists(dev)) {\n            VIR_DEBUG(\"Ignoring non-existent device %s\", dev);\n            continue;\n        }\n\n        if (virCgroupAllowDevicePath(cgroup, dev,\n                                     VIR_CGROUP_DEVICE_READ,\n                                     false) < 0)\n            return -1;\n    }\n\n    VIR_DEBUG(\"Device whitelist complete\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virLXCTeardownHostUSBDeviceCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "204-217",
    "snippet": "int\nvirLXCTeardownHostUSBDeviceCgroup(virUSBDevicePtr dev G_GNUC_UNUSED,\n                                  const char *path,\n                                  void *opaque)\n{\n    virCgroupPtr cgroup = opaque;\n\n    VIR_DEBUG(\"Process path '%s' for USB device\", path);\n    if (virCgroupDenyDevicePath(cgroup, path,\n                                VIR_CGROUP_DEVICE_RWM, false) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "cgroup",
            "path",
            "VIR_CGROUP_DEVICE_RWM",
            "false"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Process path '%s' for USB device\"",
            "path"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nint\nvirLXCTeardownHostUSBDeviceCgroup(virUSBDevicePtr dev G_GNUC_UNUSED,\n                                  const char *path,\n                                  void *opaque)\n{\n    virCgroupPtr cgroup = opaque;\n\n    VIR_DEBUG(\"Process path '%s' for USB device\", path);\n    if (virCgroupDenyDevicePath(cgroup, path,\n                                VIR_CGROUP_DEVICE_RWM, false) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virLXCSetupHostUSBDeviceCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "188-201",
    "snippet": "int\nvirLXCSetupHostUSBDeviceCgroup(virUSBDevicePtr dev G_GNUC_UNUSED,\n                               const char *path,\n                               void *opaque)\n{\n    virCgroupPtr cgroup = opaque;\n\n    VIR_DEBUG(\"Process path '%s' for USB device\", path);\n    if (virCgroupAllowDevicePath(cgroup, path,\n                                 VIR_CGROUP_DEVICE_RWM, false) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupAllowDevicePath",
          "args": [
            "cgroup",
            "path",
            "VIR_CGROUP_DEVICE_RWM",
            "false"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3291-3300",
          "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Process path '%s' for USB device\"",
            "path"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nint\nvirLXCSetupHostUSBDeviceCgroup(virUSBDevicePtr dev G_GNUC_UNUSED,\n                               const char *path,\n                               void *opaque)\n{\n    virCgroupPtr cgroup = opaque;\n\n    VIR_DEBUG(\"Process path '%s' for USB device\", path);\n    if (virCgroupAllowDevicePath(cgroup, path,\n                                 VIR_CGROUP_DEVICE_RWM, false) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virLXCCgroupGetMeminfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "147-174",
    "snippet": "int virLXCCgroupGetMeminfo(virLXCMeminfoPtr meminfo)\n{\n    int ret = -1;\n    virCgroupPtr cgroup;\n\n    if (virCgroupNewSelf(&cgroup) < 0)\n        return -1;\n\n    if (virLXCCgroupGetMemStat(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    if (virLXCCgroupGetMemTotal(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    if (virLXCCgroupGetMemUsage(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    if (virLXCCgroupGetMemSwapTotal(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    if (virLXCCgroupGetMemSwapUsage(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&cgroup);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&cgroup"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupGetMemSwapUsage",
          "args": [
            "cgroup",
            "meminfo"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupGetMemSwapUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "100-104",
          "snippet": "static int virLXCCgroupGetMemSwapUsage(virCgroupPtr cgroup,\n                                       virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemSwapUsage(cgroup, &meminfo->swapusage);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemSwapUsage(virCgroupPtr cgroup,\n                                       virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemSwapUsage(cgroup, &meminfo->swapusage);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupGetMemSwapTotal",
          "args": [
            "cgroup",
            "meminfo"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupGetMemSwapTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "107-111",
          "snippet": "static int virLXCCgroupGetMemSwapTotal(virCgroupPtr cgroup,\n                                       virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemSwapHardLimit(cgroup, &meminfo->swaptotal);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemSwapTotal(virCgroupPtr cgroup,\n                                       virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemSwapHardLimit(cgroup, &meminfo->swaptotal);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupGetMemUsage",
          "args": [
            "cgroup",
            "meminfo"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupGetMemUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "114-124",
          "snippet": "static int virLXCCgroupGetMemUsage(virCgroupPtr cgroup,\n                                   virLXCMeminfoPtr meminfo)\n{\n    int ret;\n    unsigned long memUsage;\n\n    ret = virCgroupGetMemoryUsage(cgroup, &memUsage);\n    meminfo->memusage = (unsigned long long)memUsage;\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemUsage(virCgroupPtr cgroup,\n                                   virLXCMeminfoPtr meminfo)\n{\n    int ret;\n    unsigned long memUsage;\n\n    ret = virCgroupGetMemoryUsage(cgroup, &memUsage);\n    meminfo->memusage = (unsigned long long)memUsage;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupGetMemTotal",
          "args": [
            "cgroup",
            "meminfo"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupGetMemTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "127-131",
          "snippet": "static int virLXCCgroupGetMemTotal(virCgroupPtr cgroup,\n                                   virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemoryHardLimit(cgroup, &meminfo->memtotal);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemTotal(virCgroupPtr cgroup,\n                                   virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemoryHardLimit(cgroup, &meminfo->memtotal);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCCgroupGetMemStat",
          "args": [
            "cgroup",
            "meminfo"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCCgroupGetMemStat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
          "lines": "134-144",
          "snippet": "static int virLXCCgroupGetMemStat(virCgroupPtr cgroup,\n                                  virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemoryStat(cgroup,\n                                  &meminfo->cached,\n                                  &meminfo->inactive_anon,\n                                  &meminfo->active_anon,\n                                  &meminfo->inactive_file,\n                                  &meminfo->active_file,\n                                  &meminfo->unevictable);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemStat(virCgroupPtr cgroup,\n                                  virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemoryStat(cgroup,\n                                  &meminfo->cached,\n                                  &meminfo->inactive_anon,\n                                  &meminfo->active_anon,\n                                  &meminfo->inactive_file,\n                                  &meminfo->active_file,\n                                  &meminfo->unevictable);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewSelf",
          "args": [
            "&cgroup"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewSelf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2803-2809",
          "snippet": "int\nvirCgroupNewSelf(virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewSelf(virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nint virLXCCgroupGetMeminfo(virLXCMeminfoPtr meminfo)\n{\n    int ret = -1;\n    virCgroupPtr cgroup;\n\n    if (virCgroupNewSelf(&cgroup) < 0)\n        return -1;\n\n    if (virLXCCgroupGetMemStat(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    if (virLXCCgroupGetMemTotal(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    if (virLXCCgroupGetMemUsage(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    if (virLXCCgroupGetMemSwapTotal(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    if (virLXCCgroupGetMemSwapUsage(cgroup, meminfo) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&cgroup);\n    return ret;\n}"
  },
  {
    "function_name": "virLXCCgroupGetMemStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "134-144",
    "snippet": "static int virLXCCgroupGetMemStat(virCgroupPtr cgroup,\n                                  virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemoryStat(cgroup,\n                                  &meminfo->cached,\n                                  &meminfo->inactive_anon,\n                                  &meminfo->active_anon,\n                                  &meminfo->inactive_file,\n                                  &meminfo->active_file,\n                                  &meminfo->unevictable);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetMemoryStat",
          "args": [
            "cgroup",
            "&meminfo->cached",
            "&meminfo->inactive_anon",
            "&meminfo->active_anon",
            "&meminfo->inactive_file",
            "&meminfo->active_file",
            "&meminfo->unevictable"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemoryStat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3106-3118",
          "snippet": "int\nvirCgroupGetMemoryStat(virCgroupPtr group G_GNUC_UNUSED,\n                       unsigned long long *cache G_GNUC_UNUSED,\n                       unsigned long long *activeAnon G_GNUC_UNUSED,\n                       unsigned long long *inactiveAnon G_GNUC_UNUSED,\n                       unsigned long long *activeFile G_GNUC_UNUSED,\n                       unsigned long long *inactiveFile G_GNUC_UNUSED,\n                       unsigned long long *unevictable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryStat(virCgroupPtr group G_GNUC_UNUSED,\n                       unsigned long long *cache G_GNUC_UNUSED,\n                       unsigned long long *activeAnon G_GNUC_UNUSED,\n                       unsigned long long *inactiveAnon G_GNUC_UNUSED,\n                       unsigned long long *activeFile G_GNUC_UNUSED,\n                       unsigned long long *inactiveFile G_GNUC_UNUSED,\n                       unsigned long long *unevictable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemStat(virCgroupPtr cgroup,\n                                  virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemoryStat(cgroup,\n                                  &meminfo->cached,\n                                  &meminfo->inactive_anon,\n                                  &meminfo->active_anon,\n                                  &meminfo->inactive_file,\n                                  &meminfo->active_file,\n                                  &meminfo->unevictable);\n}"
  },
  {
    "function_name": "virLXCCgroupGetMemTotal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "127-131",
    "snippet": "static int virLXCCgroupGetMemTotal(virCgroupPtr cgroup,\n                                   virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemoryHardLimit(cgroup, &meminfo->memtotal);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetMemoryHardLimit",
          "args": [
            "cgroup",
            "&meminfo->memtotal"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemoryHardLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3141-3148",
          "snippet": "int\nvirCgroupGetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemTotal(virCgroupPtr cgroup,\n                                   virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemoryHardLimit(cgroup, &meminfo->memtotal);\n}"
  },
  {
    "function_name": "virLXCCgroupGetMemUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "114-124",
    "snippet": "static int virLXCCgroupGetMemUsage(virCgroupPtr cgroup,\n                                   virLXCMeminfoPtr meminfo)\n{\n    int ret;\n    unsigned long memUsage;\n\n    ret = virCgroupGetMemoryUsage(cgroup, &memUsage);\n    meminfo->memusage = (unsigned long long)memUsage;\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetMemoryUsage",
          "args": [
            "cgroup",
            "&memUsage"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemoryUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3121-3128",
          "snippet": "int\nvirCgroupGetMemoryUsage(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryUsage(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemUsage(virCgroupPtr cgroup,\n                                   virLXCMeminfoPtr meminfo)\n{\n    int ret;\n    unsigned long memUsage;\n\n    ret = virCgroupGetMemoryUsage(cgroup, &memUsage);\n    meminfo->memusage = (unsigned long long)memUsage;\n\n    return ret;\n}"
  },
  {
    "function_name": "virLXCCgroupGetMemSwapTotal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "107-111",
    "snippet": "static int virLXCCgroupGetMemSwapTotal(virCgroupPtr cgroup,\n                                       virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemSwapHardLimit(cgroup, &meminfo->swaptotal);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetMemSwapHardLimit",
          "args": [
            "cgroup",
            "&meminfo->swaptotal"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemSwapHardLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3181-3188",
          "snippet": "int\nvirCgroupGetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemSwapTotal(virCgroupPtr cgroup,\n                                       virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemSwapHardLimit(cgroup, &meminfo->swaptotal);\n}"
  },
  {
    "function_name": "virLXCCgroupGetMemSwapUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "100-104",
    "snippet": "static int virLXCCgroupGetMemSwapUsage(virCgroupPtr cgroup,\n                                       virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemSwapUsage(cgroup, &meminfo->swapusage);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetMemSwapUsage",
          "args": [
            "cgroup",
            "&meminfo->swapusage"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemSwapUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3191-3198",
          "snippet": "int\nvirCgroupGetMemSwapUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemSwapUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupGetMemSwapUsage(virCgroupPtr cgroup,\n                                       virLXCMeminfoPtr meminfo)\n{\n    return virCgroupGetMemSwapUsage(cgroup, &meminfo->swapusage);\n}"
  },
  {
    "function_name": "virLXCCgroupSetupMemTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "90-97",
    "snippet": "static int virLXCCgroupSetupMemTune(virDomainDefPtr def,\n                                    virCgroupPtr cgroup)\n{\n    if (virCgroupSetMemory(cgroup, virDomainDefGetMemoryInitial(def)) < 0)\n        return -1;\n\n    return virDomainCgroupSetupMemtune(cgroup, def->mem);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainCgroupSetupMemtune",
          "args": [
            "cgroup",
            "def->mem"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCgroupSetupMemtune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
          "lines": "75-91",
          "snippet": "int\nvirDomainCgroupSetupMemtune(virCgroupPtr cgroup, virDomainMemtune mem)\n{\n    if (virMemoryLimitIsSet(mem.hard_limit))\n        if (virCgroupSetMemoryHardLimit(cgroup, mem.hard_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.soft_limit))\n        if (virCgroupSetMemorySoftLimit(cgroup, mem.soft_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.swap_hard_limit))\n        if (virCgroupSetMemSwapHardLimit(cgroup, mem.swap_hard_limit) < 0)\n            return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetupMemtune(virCgroupPtr cgroup, virDomainMemtune mem)\n{\n    if (virMemoryLimitIsSet(mem.hard_limit))\n        if (virCgroupSetMemoryHardLimit(cgroup, mem.hard_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.soft_limit))\n        if (virCgroupSetMemorySoftLimit(cgroup, mem.soft_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.swap_hard_limit))\n        if (virCgroupSetMemSwapHardLimit(cgroup, mem.swap_hard_limit) < 0)\n            return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetMemory",
          "args": [
            "cgroup",
            "virDomainDefGetMemoryInitial(def)"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetMemorySoftLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3151-3158",
          "snippet": "int\nvirCgroupSetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryInitial",
          "args": [
            "def"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryInitial",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10910-10920",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryInitial(const virDomainDef *def)\n{\n    size_t i;\n    unsigned long long ret = def->mem.total_memory;\n\n    for (i = 0; i < def->nmems; i++)\n        ret -= def->mems[i]->size;\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryInitial(const virDomainDef *def)\n{\n    size_t i;\n    unsigned long long ret = def->mem.total_memory;\n\n    for (i = 0; i < def->nmems; i++)\n        ret -= def->mems[i]->size;\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupMemTune(virDomainDefPtr def,\n                                    virCgroupPtr cgroup)\n{\n    if (virCgroupSetMemory(cgroup, virDomainDefGetMemoryInitial(def)) < 0)\n        return -1;\n\n    return virDomainCgroupSetupMemtune(cgroup, def->mem);\n}"
  },
  {
    "function_name": "virLXCCgroupSetupBlkioTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "83-87",
    "snippet": "static int virLXCCgroupSetupBlkioTune(virDomainDefPtr def,\n                                      virCgroupPtr cgroup)\n{\n    return virDomainCgroupSetupBlkio(cgroup, def->blkio);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainCgroupSetupBlkio",
          "args": [
            "cgroup",
            "def->blkio"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCgroupSetupBlkio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
          "lines": "31-72",
          "snippet": "int\nvirDomainCgroupSetupBlkio(virCgroupPtr cgroup, virDomainBlkiotune blkio)\n{\n    size_t i;\n\n    if (blkio.weight != 0 &&\n        virCgroupSetBlkioWeight(cgroup, blkio.weight) < 0)\n        return -1;\n\n    if (blkio.ndevices) {\n        for (i = 0; i < blkio.ndevices; i++) {\n            virBlkioDevicePtr dev = &blkio.devices[i];\n\n            if (dev->weight &&\n                virCgroupSetupBlkioDeviceWeight(cgroup, dev->path,\n                                                &dev->weight) < 0)\n                return -1;\n\n            if (dev->riops &&\n                virCgroupSetupBlkioDeviceReadIops(cgroup, dev->path,\n                                                  &dev->riops) < 0)\n                return -1;\n\n            if (dev->wiops &&\n                virCgroupSetupBlkioDeviceWriteIops(cgroup, dev->path,\n                                                   &dev->wiops) < 0)\n                return -1;\n\n            if (dev->rbps &&\n                virCgroupSetupBlkioDeviceReadBps(cgroup, dev->path,\n                                                 &dev->rbps) < 0)\n                return -1;\n\n            if (dev->wbps &&\n                virCgroupSetupBlkioDeviceWriteBps(cgroup, dev->path,\n                                                  &dev->wbps) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetupBlkio(virCgroupPtr cgroup, virDomainBlkiotune blkio)\n{\n    size_t i;\n\n    if (blkio.weight != 0 &&\n        virCgroupSetBlkioWeight(cgroup, blkio.weight) < 0)\n        return -1;\n\n    if (blkio.ndevices) {\n        for (i = 0; i < blkio.ndevices; i++) {\n            virBlkioDevicePtr dev = &blkio.devices[i];\n\n            if (dev->weight &&\n                virCgroupSetupBlkioDeviceWeight(cgroup, dev->path,\n                                                &dev->weight) < 0)\n                return -1;\n\n            if (dev->riops &&\n                virCgroupSetupBlkioDeviceReadIops(cgroup, dev->path,\n                                                  &dev->riops) < 0)\n                return -1;\n\n            if (dev->wiops &&\n                virCgroupSetupBlkioDeviceWriteIops(cgroup, dev->path,\n                                                   &dev->wiops) < 0)\n                return -1;\n\n            if (dev->rbps &&\n                virCgroupSetupBlkioDeviceReadBps(cgroup, dev->path,\n                                                 &dev->rbps) < 0)\n                return -1;\n\n            if (dev->wbps &&\n                virCgroupSetupBlkioDeviceWriteBps(cgroup, dev->path,\n                                                  &dev->wbps) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupBlkioTune(virDomainDefPtr def,\n                                      virCgroupPtr cgroup)\n{\n    return virDomainCgroupSetupBlkio(cgroup, def->blkio);\n}"
  },
  {
    "function_name": "virLXCCgroupSetupCpusetTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "54-80",
    "snippet": "static int virLXCCgroupSetupCpusetTune(virDomainDefPtr def,\n                                       virCgroupPtr cgroup,\n                                       virBitmapPtr nodemask)\n{\n    g_autofree char *mask = NULL;\n    virDomainNumatuneMemMode mode;\n\n    if (def->placement_mode != VIR_DOMAIN_CPU_PLACEMENT_MODE_AUTO &&\n        def->cpumask &&\n        virCgroupSetupCpusetCpus(cgroup, def->cpumask) < 0) {\n        return -1;\n    }\n\n    if (virDomainNumatuneGetMode(def->numa, -1, &mode) < 0 ||\n        mode == VIR_DOMAIN_NUMATUNE_MEM_STRICT) {\n        return 0;\n    }\n\n    if (virDomainNumatuneMaybeFormatNodeset(def->numa, nodemask,\n                                            &mask, -1) < 0)\n        return -1;\n\n    if (mask && virCgroupSetCpusetMems(cgroup, mask) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetCpusetMems",
          "args": [
            "cgroup",
            "mask"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpusetMems",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3201-3208",
          "snippet": "int\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNumatuneMaybeFormatNodeset",
          "args": [
            "def->numa",
            "nodemask",
            "&mask",
            "-1"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNumatuneMaybeFormatNodeset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/numa_conf.c",
          "lines": "473-490",
          "snippet": "int\nvirDomainNumatuneMaybeFormatNodeset(virDomainNumaPtr numatune,\n                                    virBitmapPtr auto_nodeset,\n                                    char **mask,\n                                    int cellid)\n{\n    virBitmapPtr nodeset;\n\n    if (virDomainNumatuneMaybeGetNodeset(numatune, auto_nodeset, &nodeset,\n                                         cellid) < 0)\n        return -1;\n\n    if (nodeset &&\n        !(*mask = virBitmapFormat(nodeset)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"numa_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"numa_conf.h\"\n#include <config.h>\n\nint\nvirDomainNumatuneMaybeFormatNodeset(virDomainNumaPtr numatune,\n                                    virBitmapPtr auto_nodeset,\n                                    char **mask,\n                                    int cellid)\n{\n    virBitmapPtr nodeset;\n\n    if (virDomainNumatuneMaybeGetNodeset(numatune, auto_nodeset, &nodeset,\n                                         cellid) < 0)\n        return -1;\n\n    if (nodeset &&\n        !(*mask = virBitmapFormat(nodeset)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNumatuneGetMode",
          "args": [
            "def->numa",
            "-1",
            "&mode"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNumatuneGetMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/numa_conf.c",
          "lines": "389-409",
          "snippet": "int virDomainNumatuneGetMode(virDomainNumaPtr numatune,\n                             int cellid,\n                             virDomainNumatuneMemMode *mode)\n{\n    virDomainNumatuneMemMode tmp_mode;\n\n    if (!numatune)\n        return -1;\n\n    if (virDomainNumatuneNodeSpecified(numatune, cellid))\n        tmp_mode = numatune->mem_nodes[cellid].mode;\n    else if (numatune->memory.specified)\n        tmp_mode = numatune->memory.mode;\n    else\n        return -1;\n\n    if (mode)\n        *mode = tmp_mode;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"numa_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"numa_conf.h\"\n#include <config.h>\n\nint virDomainNumatuneGetMode(virDomainNumaPtr numatune,\n                             int cellid,\n                             virDomainNumatuneMemMode *mode)\n{\n    virDomainNumatuneMemMode tmp_mode;\n\n    if (!numatune)\n        return -1;\n\n    if (virDomainNumatuneNodeSpecified(numatune, cellid))\n        tmp_mode = numatune->mem_nodes[cellid].mode;\n    else if (numatune->memory.specified)\n        tmp_mode = numatune->memory.mode;\n    else\n        return -1;\n\n    if (mode)\n        *mode = tmp_mode;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetupCpusetCpus",
          "args": [
            "cgroup",
            "def->cpumask"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupCpusetCpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3671-3683",
          "snippet": "int\nvirCgroupSetupCpusetCpus(virCgroupPtr cgroup, virBitmapPtr cpumask)\n{\n    g_autofree char *new_cpus = NULL;\n\n    if (!(new_cpus = virBitmapFormat(cpumask)))\n        return -1;\n\n    if (virCgroupSetCpusetCpus(cgroup, new_cpus) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpusetCpus(virCgroupPtr cgroup, virBitmapPtr cpumask)\n{\n    g_autofree char *new_cpus = NULL;\n\n    if (!(new_cpus = virBitmapFormat(cpumask)))\n        return -1;\n\n    if (virCgroupSetCpusetCpus(cgroup, new_cpus) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupCpusetTune(virDomainDefPtr def,\n                                       virCgroupPtr cgroup,\n                                       virBitmapPtr nodemask)\n{\n    g_autofree char *mask = NULL;\n    virDomainNumatuneMemMode mode;\n\n    if (def->placement_mode != VIR_DOMAIN_CPU_PLACEMENT_MODE_AUTO &&\n        def->cpumask &&\n        virCgroupSetupCpusetCpus(cgroup, def->cpumask) < 0) {\n        return -1;\n    }\n\n    if (virDomainNumatuneGetMode(def->numa, -1, &mode) < 0 ||\n        mode == VIR_DOMAIN_NUMATUNE_MEM_STRICT) {\n        return 0;\n    }\n\n    if (virDomainNumatuneMaybeFormatNodeset(def->numa, nodemask,\n                                            &mask, -1) < 0)\n        return -1;\n\n    if (mask && virCgroupSetCpusetMems(cgroup, mask) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virLXCCgroupSetupCpuTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_cgroup.c",
    "lines": "39-51",
    "snippet": "static int virLXCCgroupSetupCpuTune(virDomainDefPtr def,\n                                    virCgroupPtr cgroup)\n{\n    if (def->cputune.sharesSpecified) {\n        unsigned long long val;\n        if (virCgroupSetupCpuShares(cgroup, def->cputune.shares, &val) < 0)\n            return -1;\n        def->cputune.shares = val;\n    }\n\n    return virCgroupSetupCpuPeriodQuota(cgroup, def->cputune.period,\n                                        def->cputune.quota);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetupCpuPeriodQuota",
          "args": [
            "cgroup",
            "def->cputune.period",
            "def->cputune.quota"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupCpuPeriodQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3706-3741",
          "snippet": "int\nvirCgroupSetupCpuPeriodQuota(virCgroupPtr cgroup,\n                             unsigned long long period,\n                             long long quota)\n{\n    unsigned long long old_period;\n\n    if (period == 0 && quota == 0)\n        return 0;\n\n    if (period) {\n        /* get old period, and we can rollback if set quota failed */\n        if (virCgroupGetCpuCfsPeriod(cgroup, &old_period) < 0)\n            return -1;\n\n        if (virCgroupSetCpuCfsPeriod(cgroup, period) < 0)\n            return -1;\n    }\n\n    if (quota &&\n        virCgroupSetCpuCfsQuota(cgroup, quota) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    if (period) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        ignore_value(virCgroupSetCpuCfsPeriod(cgroup, old_period));\n        virErrorRestore(&saved);\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpuPeriodQuota(virCgroupPtr cgroup,\n                             unsigned long long period,\n                             long long quota)\n{\n    unsigned long long old_period;\n\n    if (period == 0 && quota == 0)\n        return 0;\n\n    if (period) {\n        /* get old period, and we can rollback if set quota failed */\n        if (virCgroupGetCpuCfsPeriod(cgroup, &old_period) < 0)\n            return -1;\n\n        if (virCgroupSetCpuCfsPeriod(cgroup, period) < 0)\n            return -1;\n    }\n\n    if (quota &&\n        virCgroupSetCpuCfsQuota(cgroup, quota) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    if (period) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        ignore_value(virCgroupSetCpuCfsPeriod(cgroup, old_period));\n        virErrorRestore(&saved);\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetupCpuShares",
          "args": [
            "cgroup",
            "def->cputune.shares",
            "&val"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupCpuShares",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3692-3703",
          "snippet": "int\nvirCgroupSetupCpuShares(virCgroupPtr cgroup, unsigned long long shares,\n                        unsigned long long *realValue)\n{\n    if (virCgroupSetCpuShares(cgroup, shares) < 0)\n        return -1;\n\n    if (virCgroupGetCpuShares(cgroup, realValue) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpuShares(virCgroupPtr cgroup, unsigned long long shares,\n                        unsigned long long *realValue)\n{\n    if (virCgroupSetCpuShares(cgroup, shares) < 0)\n        return -1;\n\n    if (virCgroupGetCpuShares(cgroup, realValue) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"domain_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_cgroup.h\"\n#include <config.h>\n\nstatic int virLXCCgroupSetupCpuTune(virDomainDefPtr def,\n                                    virCgroupPtr cgroup)\n{\n    if (def->cputune.sharesSpecified) {\n        unsigned long long val;\n        if (virCgroupSetupCpuShares(cgroup, def->cputune.shares, &val) < 0)\n            return -1;\n        def->cputune.shares = val;\n    }\n\n    return virCgroupSetupCpuPeriodQuota(cgroup, def->cputune.period,\n                                        def->cputune.quota);\n}"
  }
]