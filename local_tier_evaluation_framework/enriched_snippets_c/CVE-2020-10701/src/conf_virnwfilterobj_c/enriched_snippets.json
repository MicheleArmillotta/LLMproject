[
  {
    "function_name": "virNWFilterObjUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "561-565",
    "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&obj->lock"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
  },
  {
    "function_name": "virNWFilterObjLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "554-558",
    "snippet": "void\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&obj->lock"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}"
  },
  {
    "function_name": "virNWFilterObjListLoadAllConfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "526-551",
    "snippet": "int\nvirNWFilterObjListLoadAllConfigs(virNWFilterObjListPtr nwfilters,\n                                 const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        obj = virNWFilterObjListLoadConfig(nwfilters, configDir, entry->d_name);\n        if (obj)\n            virNWFilterObjUnlock(obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dir"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListLoadConfig",
          "args": [
            "nwfilters",
            "configDir",
            "entry->d_name"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListLoadConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "485-523",
          "snippet": "static virNWFilterObjPtr\nvirNWFilterObjListLoadConfig(virNWFilterObjListPtr nwfilters,\n                             const char *configDir,\n                             const char *name)\n{\n    virNWFilterDefPtr def = NULL;\n    virNWFilterObjPtr obj;\n    char *configFile = NULL;\n\n    if (!(configFile = virFileBuildPath(configDir, name, \".xml\")))\n        goto error;\n\n    if (!(def = virNWFilterDefParseFile(configFile)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"network filter config filename '%s' \"\n                         \"does not match name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    /* We generated a UUID, make it permanent by saving the config to disk */\n    if (!def->uuid_specified &&\n        virNWFilterSaveConfig(configDir, def) < 0)\n        goto error;\n\n    if (!(obj = virNWFilterObjListAssignDef(nwfilters, def)))\n        goto error;\n\n    VIR_FREE(configFile);\n    return obj;\n\n error:\n    VIR_FREE(configFile);\n    virNWFilterDefFree(def);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virNWFilterObjPtr\nvirNWFilterObjListLoadConfig(virNWFilterObjListPtr nwfilters,\n                             const char *configDir,\n                             const char *name)\n{\n    virNWFilterDefPtr def = NULL;\n    virNWFilterObjPtr obj;\n    char *configFile = NULL;\n\n    if (!(configFile = virFileBuildPath(configDir, name, \".xml\")))\n        goto error;\n\n    if (!(def = virNWFilterDefParseFile(configFile)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"network filter config filename '%s' \"\n                         \"does not match name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    /* We generated a UUID, make it permanent by saving the config to disk */\n    if (!def->uuid_specified &&\n        virNWFilterSaveConfig(configDir, def) < 0)\n        goto error;\n\n    if (!(obj = virNWFilterObjListAssignDef(nwfilters, def)))\n        goto error;\n\n    VIR_FREE(configFile);\n    return obj;\n\n error:\n    VIR_FREE(configFile);\n    virNWFilterDefFree(def);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringStripSuffix",
          "args": [
            "entry->d_name",
            "\".xml\""
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "virStringStripSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1123-1139",
          "snippet": "bool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&entry",
            "configDir"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dir",
            "configDir"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListLoadAllConfigs(virNWFilterObjListPtr nwfilters,\n                                 const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        obj = virNWFilterObjListLoadConfig(nwfilters, configDir, entry->d_name);\n        if (obj)\n            virNWFilterObjUnlock(obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterObjListLoadConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "485-523",
    "snippet": "static virNWFilterObjPtr\nvirNWFilterObjListLoadConfig(virNWFilterObjListPtr nwfilters,\n                             const char *configDir,\n                             const char *name)\n{\n    virNWFilterDefPtr def = NULL;\n    virNWFilterObjPtr obj;\n    char *configFile = NULL;\n\n    if (!(configFile = virFileBuildPath(configDir, name, \".xml\")))\n        goto error;\n\n    if (!(def = virNWFilterDefParseFile(configFile)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"network filter config filename '%s' \"\n                         \"does not match name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    /* We generated a UUID, make it permanent by saving the config to disk */\n    if (!def->uuid_specified &&\n        virNWFilterSaveConfig(configDir, def) < 0)\n        goto error;\n\n    if (!(obj = virNWFilterObjListAssignDef(nwfilters, def)))\n        goto error;\n\n    VIR_FREE(configFile);\n    return obj;\n\n error:\n    VIR_FREE(configFile);\n    virNWFilterDefFree(def);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterDefFree",
          "args": [
            "def"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "344-360",
          "snippet": "void\nvirNWFilterDefFree(virNWFilterDefPtr def)\n{\n    size_t i;\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    for (i = 0; i < def->nentries; i++)\n        virNWFilterEntryFree(def->filterEntries[i]);\n\n    VIR_FREE(def->filterEntries);\n    VIR_FREE(def->chainsuffix);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirNWFilterDefFree(virNWFilterDefPtr def)\n{\n    size_t i;\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    for (i = 0; i < def->nentries; i++)\n        virNWFilterEntryFree(def->filterEntries[i]);\n\n    VIR_FREE(def->filterEntries);\n    VIR_FREE(def->chainsuffix);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListAssignDef",
          "args": [
            "nwfilters",
            "def"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "310-385",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListAssignDef(virNWFilterObjListPtr nwfilters,\n                            virNWFilterDefPtr def)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr objdef;\n\n    if ((obj = virNWFilterObjListFindByUUID(nwfilters, def->uuid))) {\n        objdef = obj->def;\n\n        if (STRNEQ(def->name, objdef->name)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter with same UUID but different name \"\n                             \"('%s') already exists\"),\n                           objdef->name);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n        virNWFilterObjUnlock(obj);\n    } else {\n        if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n    }\n\n    if (virNWFilterObjListDefLoopDetect(nwfilters, def) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       \"%s\", _(\"filter would introduce a loop\"));\n        return NULL;\n    }\n\n\n    if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n\n        objdef = obj->def;\n        if (virNWFilterDefEqual(def, objdef)) {\n            virNWFilterDefFree(objdef);\n            obj->def = def;\n            return obj;\n        }\n\n        obj->newDef = def;\n        /* trigger the update on VMs referencing the filter */\n        if (virNWFilterTriggerRebuild() < 0) {\n            obj->newDef = NULL;\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n\n        virNWFilterDefFree(objdef);\n        obj->def = def;\n        obj->newDef = NULL;\n        return obj;\n    }\n\n    if (!(obj = virNWFilterObjNew()))\n        return NULL;\n\n    if (VIR_APPEND_ELEMENT_COPY(nwfilters->objs,\n                                nwfilters->count, obj) < 0) {\n        virNWFilterObjUnlock(obj);\n        virNWFilterObjFree(obj);\n        return NULL;\n    }\n    obj->def = def;\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListAssignDef(virNWFilterObjListPtr nwfilters,\n                            virNWFilterDefPtr def)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr objdef;\n\n    if ((obj = virNWFilterObjListFindByUUID(nwfilters, def->uuid))) {\n        objdef = obj->def;\n\n        if (STRNEQ(def->name, objdef->name)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter with same UUID but different name \"\n                             \"('%s') already exists\"),\n                           objdef->name);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n        virNWFilterObjUnlock(obj);\n    } else {\n        if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n    }\n\n    if (virNWFilterObjListDefLoopDetect(nwfilters, def) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       \"%s\", _(\"filter would introduce a loop\"));\n        return NULL;\n    }\n\n\n    if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n\n        objdef = obj->def;\n        if (virNWFilterDefEqual(def, objdef)) {\n            virNWFilterDefFree(objdef);\n            obj->def = def;\n            return obj;\n        }\n\n        obj->newDef = def;\n        /* trigger the update on VMs referencing the filter */\n        if (virNWFilterTriggerRebuild() < 0) {\n            obj->newDef = NULL;\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n\n        virNWFilterDefFree(objdef);\n        obj->def = def;\n        obj->newDef = NULL;\n        return obj;\n    }\n\n    if (!(obj = virNWFilterObjNew()))\n        return NULL;\n\n    if (VIR_APPEND_ELEMENT_COPY(nwfilters->objs,\n                                nwfilters->count, obj) < 0) {\n        virNWFilterObjUnlock(obj);\n        virNWFilterObjFree(obj);\n        return NULL;\n    }\n    obj->def = def;\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterSaveConfig",
          "args": [
            "configDir",
            "def"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterSaveConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "2785-2809",
          "snippet": "int\nvirNWFilterSaveConfig(const char *configDir,\n                      virNWFilterDefPtr def)\n{\n    int ret = -1;\n    char *xml;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *configFile = NULL;\n\n    if (!(xml = virNWFilterDefFormat(def)))\n        goto cleanup;\n\n    if (!(configFile = virFileBuildPath(configDir, def->name, \".xml\")))\n        goto cleanup;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    ret = virXMLSaveFile(configFile,\n                         virXMLPickShellSafeComment(def->name, uuidstr),\n                         \"nwfilter-edit\", xml);\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(xml);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirNWFilterSaveConfig(const char *configDir,\n                      virNWFilterDefPtr def)\n{\n    int ret = -1;\n    char *xml;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *configFile = NULL;\n\n    if (!(xml = virNWFilterDefFormat(def)))\n        goto cleanup;\n\n    if (!(configFile = virFileBuildPath(configDir, def->name, \".xml\")))\n        goto cleanup;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    ret = virXMLSaveFile(configFile,\n                         virXMLPickShellSafeComment(def->name, uuidstr),\n                         \"nwfilter-edit\", xml);\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(xml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"network filter config filename '%s' \"\n                         \"does not match name '%s'\")",
            "configFile",
            "def->name"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"network filter config filename '%s' \"\n                         \"does not match name '%s'\""
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "name",
            "def->name"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterDefParseFile",
          "args": [
            "configFile"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefParseFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "2778-2782",
          "snippet": "virNWFilterDefPtr\nvirNWFilterDefParseFile(const char *filename)\n{\n    return virNWFilterDefParse(NULL, filename);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterDefParseFile(const char *filename)\n{\n    return virNWFilterDefParse(NULL, filename);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "configDir",
            "name",
            "\".xml\""
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virNWFilterObjPtr\nvirNWFilterObjListLoadConfig(virNWFilterObjListPtr nwfilters,\n                             const char *configDir,\n                             const char *name)\n{\n    virNWFilterDefPtr def = NULL;\n    virNWFilterObjPtr obj;\n    char *configFile = NULL;\n\n    if (!(configFile = virFileBuildPath(configDir, name, \".xml\")))\n        goto error;\n\n    if (!(def = virNWFilterDefParseFile(configFile)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"network filter config filename '%s' \"\n                         \"does not match name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    /* We generated a UUID, make it permanent by saving the config to disk */\n    if (!def->uuid_specified &&\n        virNWFilterSaveConfig(configDir, def) < 0)\n        goto error;\n\n    if (!(obj = virNWFilterObjListAssignDef(nwfilters, def)))\n        goto error;\n\n    VIR_FREE(configFile);\n    return obj;\n\n error:\n    VIR_FREE(configFile);\n    virNWFilterDefFree(def);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterObjListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "434-482",
    "snippet": "int\nvirNWFilterObjListExport(virConnectPtr conn,\n                         virNWFilterObjListPtr nwfilters,\n                         virNWFilterPtr **filters,\n                         virNWFilterObjListFilter filter)\n{\n    virNWFilterPtr *tmp_filters = NULL;\n    int nfilters = 0;\n    virNWFilterPtr nwfilter = NULL;\n    virNWFilterObjPtr obj = NULL;\n    virNWFilterDefPtr def;\n    size_t i;\n    int ret = -1;\n\n    if (!filters) {\n        ret = nwfilters->count;\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(tmp_filters, nwfilters->count + 1) < 0)\n        goto cleanup;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!filter || filter(conn, def)) {\n            if (!(nwfilter = virGetNWFilter(conn, def->name, def->uuid))) {\n                virNWFilterObjUnlock(obj);\n                goto cleanup;\n            }\n            tmp_filters[nfilters++] = nwfilter;\n        }\n        virNWFilterObjUnlock(obj);\n    }\n\n    *filters = tmp_filters;\n    tmp_filters = NULL;\n    ret = nfilters;\n\n cleanup:\n    if (tmp_filters) {\n        for (i = 0; i < nfilters; i ++)\n            virObjectUnref(tmp_filters[i]);\n    }\n    VIR_FREE(tmp_filters);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp_filters"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "tmp_filters[i]"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNWFilter",
          "args": [
            "conn",
            "def->name",
            "def->uuid"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "904-930",
          "snippet": "virNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNWFilterBindingClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNWFilterBindingClass;\n\nvirNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter",
          "args": [
            "conn",
            "def"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "make_nonnull_nwfilter_binding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_dispatch.c",
          "lines": "7368-7373",
          "snippet": "static void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}",
          "includes": [
            "#include \"lxc_daemon_dispatch_stubs.h\"",
            "#include \"qemu_daemon_dispatch_stubs.h\"",
            "#include \"remote_daemon_dispatch_stubs.h\"",
            "#include \"access/viraccessapicheck.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virpolkit.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virprobe.h\"",
            "#include \"network_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"object_event.h\"",
            "#include \"virstring.h\"",
            "#include \"lxc_protocol.h\"",
            "#include \"qemu_protocol.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"virprocess.h\"",
            "#include \"virdbus.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virnetserverservice.h\"",
            "#include \"vircommand.h\"",
            "#include \"viruuid.h\"",
            "#include \"remote_daemon_stream.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"remote_daemon.h\"",
            "#include \"remote_daemon_dispatch.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc_daemon_dispatch_stubs.h\"\n#include \"qemu_daemon_dispatch_stubs.h\"\n#include \"remote_daemon_dispatch_stubs.h\"\n#include \"access/viraccessapicheck.h\"\n#include \"configmake.h\"\n#include \"virthreadjob.h\"\n#include \"virpolkit.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virprobe.h\"\n#include \"network_conf.h\"\n#include \"domain_conf.h\"\n#include \"object_event.h\"\n#include \"virstring.h\"\n#include \"lxc_protocol.h\"\n#include \"qemu_protocol.h\"\n#include \"remote_protocol.h\"\n#include \"virprocess.h\"\n#include \"virdbus.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virnetserver.h\"\n#include \"virnetserverservice.h\"\n#include \"vircommand.h\"\n#include \"viruuid.h\"\n#include \"remote_daemon_stream.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"libvirt_internal.h\"\n#include \"remote_daemon.h\"\n#include \"remote_daemon_dispatch.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);\n\nstatic void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjLock",
          "args": [
            "obj"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "554-558",
          "snippet": "void\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "tmp_filters",
            "nwfilters->count + 1"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListExport(virConnectPtr conn,\n                         virNWFilterObjListPtr nwfilters,\n                         virNWFilterPtr **filters,\n                         virNWFilterObjListFilter filter)\n{\n    virNWFilterPtr *tmp_filters = NULL;\n    int nfilters = 0;\n    virNWFilterPtr nwfilter = NULL;\n    virNWFilterObjPtr obj = NULL;\n    virNWFilterDefPtr def;\n    size_t i;\n    int ret = -1;\n\n    if (!filters) {\n        ret = nwfilters->count;\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(tmp_filters, nwfilters->count + 1) < 0)\n        goto cleanup;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!filter || filter(conn, def)) {\n            if (!(nwfilter = virGetNWFilter(conn, def->name, def->uuid))) {\n                virNWFilterObjUnlock(obj);\n                goto cleanup;\n            }\n            tmp_filters[nfilters++] = nwfilter;\n        }\n        virNWFilterObjUnlock(obj);\n    }\n\n    *filters = tmp_filters;\n    tmp_filters = NULL;\n    ret = nfilters;\n\n cleanup:\n    if (tmp_filters) {\n        for (i = 0; i < nfilters; i ++)\n            virObjectUnref(tmp_filters[i]);\n    }\n    VIR_FREE(tmp_filters);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterObjListGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "408-431",
    "snippet": "int\nvirNWFilterObjListGetNames(virNWFilterObjListPtr nwfilters,\n                           virConnectPtr conn,\n                           virNWFilterObjListFilter filter,\n                           char **const names,\n                           int maxnames)\n{\n    int nnames = 0;\n    size_t i;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count && nnames < maxnames; i++) {\n        virNWFilterObjPtr obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!filter || filter(conn, def)) {\n            names[nnames] = g_strdup(def->name);\n            nnames++;\n        }\n        virNWFilterObjUnlock(obj);\n    }\n\n    return nnames;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "def->name"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter",
          "args": [
            "conn",
            "def"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "make_nonnull_nwfilter_binding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_dispatch.c",
          "lines": "7368-7373",
          "snippet": "static void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}",
          "includes": [
            "#include \"lxc_daemon_dispatch_stubs.h\"",
            "#include \"qemu_daemon_dispatch_stubs.h\"",
            "#include \"remote_daemon_dispatch_stubs.h\"",
            "#include \"access/viraccessapicheck.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virpolkit.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virprobe.h\"",
            "#include \"network_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"object_event.h\"",
            "#include \"virstring.h\"",
            "#include \"lxc_protocol.h\"",
            "#include \"qemu_protocol.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"virprocess.h\"",
            "#include \"virdbus.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virnetserverservice.h\"",
            "#include \"vircommand.h\"",
            "#include \"viruuid.h\"",
            "#include \"remote_daemon_stream.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"remote_daemon.h\"",
            "#include \"remote_daemon_dispatch.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc_daemon_dispatch_stubs.h\"\n#include \"qemu_daemon_dispatch_stubs.h\"\n#include \"remote_daemon_dispatch_stubs.h\"\n#include \"access/viraccessapicheck.h\"\n#include \"configmake.h\"\n#include \"virthreadjob.h\"\n#include \"virpolkit.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virprobe.h\"\n#include \"network_conf.h\"\n#include \"domain_conf.h\"\n#include \"object_event.h\"\n#include \"virstring.h\"\n#include \"lxc_protocol.h\"\n#include \"qemu_protocol.h\"\n#include \"remote_protocol.h\"\n#include \"virprocess.h\"\n#include \"virdbus.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virnetserver.h\"\n#include \"virnetserverservice.h\"\n#include \"vircommand.h\"\n#include \"viruuid.h\"\n#include \"remote_daemon_stream.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"libvirt_internal.h\"\n#include \"remote_daemon.h\"\n#include \"remote_daemon_dispatch.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);\n\nstatic void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjLock",
          "args": [
            "obj"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "554-558",
          "snippet": "void\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListGetNames(virNWFilterObjListPtr nwfilters,\n                           virConnectPtr conn,\n                           virNWFilterObjListFilter filter,\n                           char **const names,\n                           int maxnames)\n{\n    int nnames = 0;\n    size_t i;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count && nnames < maxnames; i++) {\n        virNWFilterObjPtr obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!filter || filter(conn, def)) {\n            names[nnames] = g_strdup(def->name);\n            nnames++;\n        }\n        virNWFilterObjUnlock(obj);\n    }\n\n    return nnames;\n}"
  },
  {
    "function_name": "virNWFilterObjListNumOfNWFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "388-405",
    "snippet": "int\nvirNWFilterObjListNumOfNWFilters(virNWFilterObjListPtr nwfilters,\n                                 virConnectPtr conn,\n                                 virNWFilterObjListFilter filter)\n{\n    size_t i;\n    int nfilters = 0;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjPtr obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        if (!filter || filter(conn, obj->def))\n            nfilters++;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return nfilters;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter",
          "args": [
            "conn",
            "obj->def"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "make_nonnull_nwfilter_binding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_dispatch.c",
          "lines": "7368-7373",
          "snippet": "static void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}",
          "includes": [
            "#include \"lxc_daemon_dispatch_stubs.h\"",
            "#include \"qemu_daemon_dispatch_stubs.h\"",
            "#include \"remote_daemon_dispatch_stubs.h\"",
            "#include \"access/viraccessapicheck.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virpolkit.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virprobe.h\"",
            "#include \"network_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"object_event.h\"",
            "#include \"virstring.h\"",
            "#include \"lxc_protocol.h\"",
            "#include \"qemu_protocol.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"virprocess.h\"",
            "#include \"virdbus.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virnetserverservice.h\"",
            "#include \"vircommand.h\"",
            "#include \"viruuid.h\"",
            "#include \"remote_daemon_stream.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"remote_daemon.h\"",
            "#include \"remote_daemon_dispatch.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc_daemon_dispatch_stubs.h\"\n#include \"qemu_daemon_dispatch_stubs.h\"\n#include \"remote_daemon_dispatch_stubs.h\"\n#include \"access/viraccessapicheck.h\"\n#include \"configmake.h\"\n#include \"virthreadjob.h\"\n#include \"virpolkit.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virprobe.h\"\n#include \"network_conf.h\"\n#include \"domain_conf.h\"\n#include \"object_event.h\"\n#include \"virstring.h\"\n#include \"lxc_protocol.h\"\n#include \"qemu_protocol.h\"\n#include \"remote_protocol.h\"\n#include \"virprocess.h\"\n#include \"virdbus.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virnetserver.h\"\n#include \"virnetserverservice.h\"\n#include \"vircommand.h\"\n#include \"viruuid.h\"\n#include \"remote_daemon_stream.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"libvirt_internal.h\"\n#include \"remote_daemon.h\"\n#include \"remote_daemon_dispatch.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);\n\nstatic void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjLock",
          "args": [
            "obj"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "554-558",
          "snippet": "void\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListNumOfNWFilters(virNWFilterObjListPtr nwfilters,\n                                 virConnectPtr conn,\n                                 virNWFilterObjListFilter filter)\n{\n    size_t i;\n    int nfilters = 0;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjPtr obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        if (!filter || filter(conn, obj->def))\n            nfilters++;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return nfilters;\n}"
  },
  {
    "function_name": "virNWFilterObjListAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "310-385",
    "snippet": "virNWFilterObjPtr\nvirNWFilterObjListAssignDef(virNWFilterObjListPtr nwfilters,\n                            virNWFilterDefPtr def)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr objdef;\n\n    if ((obj = virNWFilterObjListFindByUUID(nwfilters, def->uuid))) {\n        objdef = obj->def;\n\n        if (STRNEQ(def->name, objdef->name)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter with same UUID but different name \"\n                             \"('%s') already exists\"),\n                           objdef->name);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n        virNWFilterObjUnlock(obj);\n    } else {\n        if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n    }\n\n    if (virNWFilterObjListDefLoopDetect(nwfilters, def) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       \"%s\", _(\"filter would introduce a loop\"));\n        return NULL;\n    }\n\n\n    if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n\n        objdef = obj->def;\n        if (virNWFilterDefEqual(def, objdef)) {\n            virNWFilterDefFree(objdef);\n            obj->def = def;\n            return obj;\n        }\n\n        obj->newDef = def;\n        /* trigger the update on VMs referencing the filter */\n        if (virNWFilterTriggerRebuild() < 0) {\n            obj->newDef = NULL;\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n\n        virNWFilterDefFree(objdef);\n        obj->def = def;\n        obj->newDef = NULL;\n        return obj;\n    }\n\n    if (!(obj = virNWFilterObjNew()))\n        return NULL;\n\n    if (VIR_APPEND_ELEMENT_COPY(nwfilters->objs,\n                                nwfilters->count, obj) < 0) {\n        virNWFilterObjUnlock(obj);\n        virNWFilterObjFree(obj);\n        return NULL;\n    }\n    obj->def = def;\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjFree",
          "args": [
            "obj"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "92-104",
          "snippet": "static void\nvirNWFilterObjFree(virNWFilterObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virNWFilterDefFree(obj->def);\n    virNWFilterDefFree(obj->newDef);\n\n    virMutexDestroy(&obj->lock);\n\n    VIR_FREE(obj);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirNWFilterObjFree(virNWFilterObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virNWFilterDefFree(obj->def);\n    virNWFilterDefFree(obj->newDef);\n\n    virMutexDestroy(&obj->lock);\n\n    VIR_FREE(obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT_COPY",
          "args": [
            "nwfilters->objs",
            "nwfilters->count",
            "obj"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjNew",
          "args": [],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "51-68",
          "snippet": "static virNWFilterObjPtr\nvirNWFilterObjNew(void)\n{\n    virNWFilterObjPtr obj;\n\n    if (VIR_ALLOC(obj) < 0)\n        return NULL;\n\n    if (virMutexInitRecursive(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"cannot initialize mutex\"));\n        VIR_FREE(obj);\n        return NULL;\n    }\n\n    virNWFilterObjLock(obj);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virNWFilterObjPtr\nvirNWFilterObjNew(void)\n{\n    virNWFilterObjPtr obj;\n\n    if (VIR_ALLOC(obj) < 0)\n        return NULL;\n\n    if (virMutexInitRecursive(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"cannot initialize mutex\"));\n        VIR_FREE(obj);\n        return NULL;\n    }\n\n    virNWFilterObjLock(obj);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDefFree",
          "args": [
            "objdef"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "344-360",
          "snippet": "void\nvirNWFilterDefFree(virNWFilterDefPtr def)\n{\n    size_t i;\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    for (i = 0; i < def->nentries; i++)\n        virNWFilterEntryFree(def->filterEntries[i]);\n\n    VIR_FREE(def->filterEntries);\n    VIR_FREE(def->chainsuffix);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirNWFilterDefFree(virNWFilterDefPtr def)\n{\n    size_t i;\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    for (i = 0; i < def->nentries; i++)\n        virNWFilterEntryFree(def->filterEntries[i]);\n\n    VIR_FREE(def->filterEntries);\n    VIR_FREE(def->chainsuffix);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTriggerRebuild",
          "args": [],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTriggerRebuild",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "3114-3120",
          "snippet": "int\nvirNWFilterTriggerRebuild(void)\n{\n    if (rebuildCallback)\n        return rebuildCallback(rebuildOpaque);\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTriggerRebuildCallback rebuildCallback;",
            "static void *rebuildOpaque;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virNWFilterTriggerRebuildCallback rebuildCallback;\nstatic void *rebuildOpaque;\n\nint\nvirNWFilterTriggerRebuild(void)\n{\n    if (rebuildCallback)\n        return rebuildCallback(rebuildOpaque);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDefEqual",
          "args": [
            "def",
            "objdef"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "288-307",
          "snippet": "static bool\nvirNWFilterDefEqual(const virNWFilterDef *def1,\n                    virNWFilterDefPtr def2)\n{\n    bool ret = false;\n    char *xml1 = NULL;\n    char *xml2 = NULL;\n\n    if (!(xml1 = virNWFilterDefFormat(def1)) ||\n        !(xml2 = virNWFilterDefFormat(def2)))\n        goto cleanup;\n\n    ret = STREQ(xml1, xml2);\n\n cleanup:\n    VIR_FREE(xml1);\n    VIR_FREE(xml2);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirNWFilterDefEqual(const virNWFilterDef *def1,\n                    virNWFilterDefPtr def2)\n{\n    bool ret = false;\n    char *xml1 = NULL;\n    char *xml2 = NULL;\n\n    if (!(xml1 = virNWFilterDefFormat(def1)) ||\n        !(xml2 = virNWFilterDefFormat(def2)))\n        goto cleanup;\n\n    ret = STREQ(xml1, xml2);\n\n cleanup:\n    VIR_FREE(xml1);\n    VIR_FREE(xml2);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindByName",
          "args": [
            "nwfilters",
            "def->name"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "172-190",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"filter would introduce a loop\")"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"filter would introduce a loop\""
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListDefLoopDetect",
          "args": [
            "nwfilters",
            "def"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListDefLoopDetect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "264-269",
          "snippet": "static int\nvirNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                virNWFilterDefPtr def)\n{\n    return _virNWFilterObjListDefLoopDetect(nwfilters, def, def->name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                virNWFilterDefPtr def)\n{\n    return _virNWFilterObjListDefLoopDetect(nwfilters, def, def->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"filter '%s' already exists with uuid %s\")",
            "def->name",
            "uuidstr"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "objdef->uuid",
            "uuidstr"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"filter with same UUID but different name \"\n                             \"('%s') already exists\")",
            "objdef->name"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "def->name",
            "objdef->name"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindByUUID",
          "args": [
            "nwfilters",
            "def->uuid"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "151-169",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindByUUID(virNWFilterObjListPtr nwfilters,\n                             const unsigned char *uuid)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!memcmp(def->uuid, uuid, VIR_UUID_BUFLEN))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindByUUID(virNWFilterObjListPtr nwfilters,\n                             const unsigned char *uuid)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!memcmp(def->uuid, uuid, VIR_UUID_BUFLEN))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListAssignDef(virNWFilterObjListPtr nwfilters,\n                            virNWFilterDefPtr def)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr objdef;\n\n    if ((obj = virNWFilterObjListFindByUUID(nwfilters, def->uuid))) {\n        objdef = obj->def;\n\n        if (STRNEQ(def->name, objdef->name)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter with same UUID but different name \"\n                             \"('%s') already exists\"),\n                           objdef->name);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n        virNWFilterObjUnlock(obj);\n    } else {\n        if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n    }\n\n    if (virNWFilterObjListDefLoopDetect(nwfilters, def) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       \"%s\", _(\"filter would introduce a loop\"));\n        return NULL;\n    }\n\n\n    if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n\n        objdef = obj->def;\n        if (virNWFilterDefEqual(def, objdef)) {\n            virNWFilterDefFree(objdef);\n            obj->def = def;\n            return obj;\n        }\n\n        obj->newDef = def;\n        /* trigger the update on VMs referencing the filter */\n        if (virNWFilterTriggerRebuild() < 0) {\n            obj->newDef = NULL;\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n\n        virNWFilterDefFree(objdef);\n        obj->def = def;\n        obj->newDef = NULL;\n        return obj;\n    }\n\n    if (!(obj = virNWFilterObjNew()))\n        return NULL;\n\n    if (VIR_APPEND_ELEMENT_COPY(nwfilters->objs,\n                                nwfilters->count, obj) < 0) {\n        virNWFilterObjUnlock(obj);\n        virNWFilterObjFree(obj);\n        return NULL;\n    }\n    obj->def = def;\n\n    return obj;\n}"
  },
  {
    "function_name": "virNWFilterDefEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "288-307",
    "snippet": "static bool\nvirNWFilterDefEqual(const virNWFilterDef *def1,\n                    virNWFilterDefPtr def2)\n{\n    bool ret = false;\n    char *xml1 = NULL;\n    char *xml2 = NULL;\n\n    if (!(xml1 = virNWFilterDefFormat(def1)) ||\n        !(xml2 = virNWFilterDefFormat(def2)))\n        goto cleanup;\n\n    ret = STREQ(xml1, xml2);\n\n cleanup:\n    VIR_FREE(xml1);\n    VIR_FREE(xml2);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "xml2"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "xml1"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "xml1",
            "xml2"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterDefFormat",
          "args": [
            "def2"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "3044-3076",
          "snippet": "char *\nvirNWFilterDefFormat(const virNWFilterDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    size_t i;\n\n    virBufferAsprintf(&buf, \"<filter name='%s' chain='%s'\",\n                      def->name,\n                      def->chainsuffix);\n    if (def->chainPriority != 0)\n        virBufferAsprintf(&buf, \" priority='%d'\",\n                          def->chainPriority);\n    virBufferAddLit(&buf, \">\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    for (i = 0; i < def->nentries; i++) {\n        if (virNWFilterEntryFormat(&buf, def->filterEntries[i]) < 0)\n            goto err_exit;\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</filter>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n err_exit:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirNWFilterDefFormat(const virNWFilterDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    size_t i;\n\n    virBufferAsprintf(&buf, \"<filter name='%s' chain='%s'\",\n                      def->name,\n                      def->chainsuffix);\n    if (def->chainPriority != 0)\n        virBufferAsprintf(&buf, \" priority='%d'\",\n                          def->chainPriority);\n    virBufferAddLit(&buf, \">\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    for (i = 0; i < def->nentries; i++) {\n        if (virNWFilterEntryFormat(&buf, def->filterEntries[i]) < 0)\n            goto err_exit;\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</filter>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n err_exit:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic bool\nvirNWFilterDefEqual(const virNWFilterDef *def1,\n                    virNWFilterDefPtr def2)\n{\n    bool ret = false;\n    char *xml1 = NULL;\n    char *xml2 = NULL;\n\n    if (!(xml1 = virNWFilterDefFormat(def1)) ||\n        !(xml2 = virNWFilterDefFormat(def2)))\n        goto cleanup;\n\n    ret = STREQ(xml1, xml2);\n\n cleanup:\n    VIR_FREE(xml1);\n    VIR_FREE(xml2);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterObjTestUnassignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "272-285",
    "snippet": "int\nvirNWFilterObjTestUnassignDef(virNWFilterObjPtr obj)\n{\n    int rc = 0;\n\n    obj->wantRemoved = true;\n    /* trigger the update on VMs referencing the filter */\n    if (virNWFilterTriggerRebuild() < 0)\n        rc = -1;\n\n    obj->wantRemoved = false;\n\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterTriggerRebuild",
          "args": [],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTriggerRebuild",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "3114-3120",
          "snippet": "int\nvirNWFilterTriggerRebuild(void)\n{\n    if (rebuildCallback)\n        return rebuildCallback(rebuildOpaque);\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTriggerRebuildCallback rebuildCallback;",
            "static void *rebuildOpaque;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virNWFilterTriggerRebuildCallback rebuildCallback;\nstatic void *rebuildOpaque;\n\nint\nvirNWFilterTriggerRebuild(void)\n{\n    if (rebuildCallback)\n        return rebuildCallback(rebuildOpaque);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjTestUnassignDef(virNWFilterObjPtr obj)\n{\n    int rc = 0;\n\n    obj->wantRemoved = true;\n    /* trigger the update on VMs referencing the filter */\n    if (virNWFilterTriggerRebuild() < 0)\n        rc = -1;\n\n    obj->wantRemoved = false;\n\n    return rc;\n}"
  },
  {
    "function_name": "virNWFilterObjListDefLoopDetect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "264-269",
    "snippet": "static int\nvirNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                virNWFilterDefPtr def)\n{\n    return _virNWFilterObjListDefLoopDetect(nwfilters, def, def->name);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_virNWFilterObjListDefLoopDetect",
          "args": [
            "nwfilters",
            "def",
            "def->name"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterObjListDefLoopDetect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "216-251",
          "snippet": "static int\n_virNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                 virNWFilterDefPtr def,\n                                 const char *filtername)\n{\n    int rc = 0;\n    size_t i;\n    virNWFilterEntryPtr entry;\n    virNWFilterObjPtr obj;\n\n    if (!def)\n        return 0;\n\n    for (i = 0; i < def->nentries; i++) {\n        entry = def->filterEntries[i];\n        if (entry->include) {\n\n            if (STREQ(filtername, entry->include->filterref)) {\n                rc = -1;\n                break;\n            }\n\n            obj = virNWFilterObjListFindByName(nwfilters,\n                                               entry->include->filterref);\n            if (obj) {\n                rc = _virNWFilterObjListDefLoopDetect(nwfilters, obj->def,\n                                                      filtername);\n                virNWFilterObjUnlock(obj);\n                if (rc < 0)\n                    break;\n            }\n        }\n    }\n\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\n_virNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                 virNWFilterDefPtr def,\n                                 const char *filtername)\n{\n    int rc = 0;\n    size_t i;\n    virNWFilterEntryPtr entry;\n    virNWFilterObjPtr obj;\n\n    if (!def)\n        return 0;\n\n    for (i = 0; i < def->nentries; i++) {\n        entry = def->filterEntries[i];\n        if (entry->include) {\n\n            if (STREQ(filtername, entry->include->filterref)) {\n                rc = -1;\n                break;\n            }\n\n            obj = virNWFilterObjListFindByName(nwfilters,\n                                               entry->include->filterref);\n            if (obj) {\n                rc = _virNWFilterObjListDefLoopDetect(nwfilters, obj->def,\n                                                      filtername);\n                virNWFilterObjUnlock(obj);\n                if (rc < 0)\n                    break;\n            }\n        }\n    }\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                virNWFilterDefPtr def)\n{\n    return _virNWFilterObjListDefLoopDetect(nwfilters, def, def->name);\n}"
  },
  {
    "function_name": "_virNWFilterObjListDefLoopDetect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "216-251",
    "snippet": "static int\n_virNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                 virNWFilterDefPtr def,\n                                 const char *filtername)\n{\n    int rc = 0;\n    size_t i;\n    virNWFilterEntryPtr entry;\n    virNWFilterObjPtr obj;\n\n    if (!def)\n        return 0;\n\n    for (i = 0; i < def->nentries; i++) {\n        entry = def->filterEntries[i];\n        if (entry->include) {\n\n            if (STREQ(filtername, entry->include->filterref)) {\n                rc = -1;\n                break;\n            }\n\n            obj = virNWFilterObjListFindByName(nwfilters,\n                                               entry->include->filterref);\n            if (obj) {\n                rc = _virNWFilterObjListDefLoopDetect(nwfilters, obj->def,\n                                                      filtername);\n                virNWFilterObjUnlock(obj);\n                if (rc < 0)\n                    break;\n            }\n        }\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_virNWFilterObjListDefLoopDetect",
          "args": [
            "nwfilters",
            "obj->def",
            "filtername"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterObjListDefLoopDetect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "216-251",
          "snippet": "static int\n_virNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                 virNWFilterDefPtr def,\n                                 const char *filtername)\n{\n    int rc = 0;\n    size_t i;\n    virNWFilterEntryPtr entry;\n    virNWFilterObjPtr obj;\n\n    if (!def)\n        return 0;\n\n    for (i = 0; i < def->nentries; i++) {\n        entry = def->filterEntries[i];\n        if (entry->include) {\n\n            if (STREQ(filtername, entry->include->filterref)) {\n                rc = -1;\n                break;\n            }\n\n            obj = virNWFilterObjListFindByName(nwfilters,\n                                               entry->include->filterref);\n            if (obj) {\n                rc = _virNWFilterObjListDefLoopDetect(nwfilters, obj->def,\n                                                      filtername);\n                virNWFilterObjUnlock(obj);\n                if (rc < 0)\n                    break;\n            }\n        }\n    }\n\n    return rc;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindByName",
          "args": [
            "nwfilters",
            "entry->include->filterref"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "172-190",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "filtername",
            "entry->include->filterref"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\n_virNWFilterObjListDefLoopDetect(virNWFilterObjListPtr nwfilters,\n                                 virNWFilterDefPtr def,\n                                 const char *filtername)\n{\n    int rc = 0;\n    size_t i;\n    virNWFilterEntryPtr entry;\n    virNWFilterObjPtr obj;\n\n    if (!def)\n        return 0;\n\n    for (i = 0; i < def->nentries; i++) {\n        entry = def->filterEntries[i];\n        if (entry->include) {\n\n            if (STREQ(filtername, entry->include->filterref)) {\n                rc = -1;\n                break;\n            }\n\n            obj = virNWFilterObjListFindByName(nwfilters,\n                                               entry->include->filterref);\n            if (obj) {\n                rc = _virNWFilterObjListDefLoopDetect(nwfilters, obj->def,\n                                                      filtername);\n                virNWFilterObjUnlock(obj);\n                if (rc < 0)\n                    break;\n            }\n        }\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virNWFilterObjListFindInstantiateFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "193-213",
    "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindInstantiateFilter(virNWFilterObjListPtr nwfilters,\n                                        const char *filtername)\n{\n    virNWFilterObjPtr obj;\n\n    if (!(obj = virNWFilterObjListFindByName(nwfilters, filtername))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"referenced filter '%s' is missing\"), filtername);\n        return NULL;\n    }\n\n    if (virNWFilterObjWantRemoved(obj)) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"Filter '%s' is in use.\"), filtername);\n        virNWFilterObjUnlock(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_NWFILTER",
            "_(\"Filter '%s' is in use.\")",
            "filtername"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Filter '%s' is in use.\""
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjWantRemoved",
          "args": [
            "obj"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjWantRemoved",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "85-89",
          "snippet": "bool\nvirNWFilterObjWantRemoved(virNWFilterObjPtr obj)\n{\n    return obj->wantRemoved;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirNWFilterObjWantRemoved(virNWFilterObjPtr obj)\n{\n    return obj->wantRemoved;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"referenced filter '%s' is missing\")",
            "filtername"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindByName",
          "args": [
            "nwfilters",
            "filtername"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "172-190",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindInstantiateFilter(virNWFilterObjListPtr nwfilters,\n                                        const char *filtername)\n{\n    virNWFilterObjPtr obj;\n\n    if (!(obj = virNWFilterObjListFindByName(nwfilters, filtername))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"referenced filter '%s' is missing\"), filtername);\n        return NULL;\n    }\n\n    if (virNWFilterObjWantRemoved(obj)) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"Filter '%s' is in use.\"), filtername);\n        virNWFilterObjUnlock(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
  },
  {
    "function_name": "virNWFilterObjListFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "172-190",
    "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "def->name",
            "name"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjLock",
          "args": [
            "obj"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "554-558",
          "snippet": "void\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterObjListFindByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "151-169",
    "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindByUUID(virNWFilterObjListPtr nwfilters,\n                             const unsigned char *uuid)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!memcmp(def->uuid, uuid, VIR_UUID_BUFLEN))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "def->uuid",
            "uuid",
            "VIR_UUID_BUFLEN"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjLock",
          "args": [
            "obj"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "554-558",
          "snippet": "void\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindByUUID(virNWFilterObjListPtr nwfilters,\n                             const unsigned char *uuid)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!memcmp(def->uuid, uuid, VIR_UUID_BUFLEN))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterObjListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "129-148",
    "snippet": "void\nvirNWFilterObjListRemove(virNWFilterObjListPtr nwfilters,\n                         virNWFilterObjPtr obj)\n{\n    size_t i;\n\n    virNWFilterObjUnlock(obj);\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjLock(nwfilters->objs[i]);\n        if (nwfilters->objs[i] == obj) {\n            virNWFilterObjUnlock(nwfilters->objs[i]);\n            virNWFilterObjFree(nwfilters->objs[i]);\n\n            VIR_DELETE_ELEMENT(nwfilters->objs, i, nwfilters->count);\n            break;\n        }\n        virNWFilterObjUnlock(nwfilters->objs[i]);\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "nwfilters->objs[i]"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "nwfilters->objs",
            "i",
            "nwfilters->count"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjFree",
          "args": [
            "nwfilters->objs[i]"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "92-104",
          "snippet": "static void\nvirNWFilterObjFree(virNWFilterObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virNWFilterDefFree(obj->def);\n    virNWFilterDefFree(obj->newDef);\n\n    virMutexDestroy(&obj->lock);\n\n    VIR_FREE(obj);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirNWFilterObjFree(virNWFilterObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virNWFilterDefFree(obj->def);\n    virNWFilterDefFree(obj->newDef);\n\n    virMutexDestroy(&obj->lock);\n\n    VIR_FREE(obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjLock",
          "args": [
            "nwfilters->objs[i]"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "554-558",
          "snippet": "void\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjListRemove(virNWFilterObjListPtr nwfilters,\n                         virNWFilterObjPtr obj)\n{\n    size_t i;\n\n    virNWFilterObjUnlock(obj);\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjLock(nwfilters->objs[i]);\n        if (nwfilters->objs[i] == obj) {\n            virNWFilterObjUnlock(nwfilters->objs[i]);\n            virNWFilterObjFree(nwfilters->objs[i]);\n\n            VIR_DELETE_ELEMENT(nwfilters->objs, i, nwfilters->count);\n            break;\n        }\n        virNWFilterObjUnlock(nwfilters->objs[i]);\n    }\n}"
  },
  {
    "function_name": "virNWFilterObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "118-126",
    "snippet": "virNWFilterObjListPtr\nvirNWFilterObjListNew(void)\n{\n    virNWFilterObjListPtr nwfilters;\n\n    if (VIR_ALLOC(nwfilters) < 0)\n        return NULL;\n    return nwfilters;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "nwfilters"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjListPtr\nvirNWFilterObjListNew(void)\n{\n    virNWFilterObjListPtr nwfilters;\n\n    if (VIR_ALLOC(nwfilters) < 0)\n        return NULL;\n    return nwfilters;\n}"
  },
  {
    "function_name": "virNWFilterObjListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "107-115",
    "snippet": "void\nvirNWFilterObjListFree(virNWFilterObjListPtr nwfilters)\n{\n    size_t i;\n    for (i = 0; i < nwfilters->count; i++)\n        virNWFilterObjFree(nwfilters->objs[i]);\n    VIR_FREE(nwfilters->objs);\n    VIR_FREE(nwfilters);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nwfilters"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nwfilters->objs"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjFree",
          "args": [
            "nwfilters->objs[i]"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "92-104",
          "snippet": "static void\nvirNWFilterObjFree(virNWFilterObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virNWFilterDefFree(obj->def);\n    virNWFilterDefFree(obj->newDef);\n\n    virMutexDestroy(&obj->lock);\n\n    VIR_FREE(obj);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirNWFilterObjFree(virNWFilterObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virNWFilterDefFree(obj->def);\n    virNWFilterDefFree(obj->newDef);\n\n    virMutexDestroy(&obj->lock);\n\n    VIR_FREE(obj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjListFree(virNWFilterObjListPtr nwfilters)\n{\n    size_t i;\n    for (i = 0; i < nwfilters->count; i++)\n        virNWFilterObjFree(nwfilters->objs[i]);\n    VIR_FREE(nwfilters->objs);\n    VIR_FREE(nwfilters);\n}"
  },
  {
    "function_name": "virNWFilterObjFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "92-104",
    "snippet": "static void\nvirNWFilterObjFree(virNWFilterObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virNWFilterDefFree(obj->def);\n    virNWFilterDefFree(obj->newDef);\n\n    virMutexDestroy(&obj->lock);\n\n    VIR_FREE(obj);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexDestroy",
          "args": [
            "&obj->lock"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "76-79",
          "snippet": "void virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDefFree",
          "args": [
            "obj->newDef"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "344-360",
          "snippet": "void\nvirNWFilterDefFree(virNWFilterDefPtr def)\n{\n    size_t i;\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    for (i = 0; i < def->nentries; i++)\n        virNWFilterEntryFree(def->filterEntries[i]);\n\n    VIR_FREE(def->filterEntries);\n    VIR_FREE(def->chainsuffix);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirNWFilterDefFree(virNWFilterDefPtr def)\n{\n    size_t i;\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    for (i = 0; i < def->nentries; i++)\n        virNWFilterEntryFree(def->filterEntries[i]);\n\n    VIR_FREE(def->filterEntries);\n    VIR_FREE(def->chainsuffix);\n\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirNWFilterObjFree(virNWFilterObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virNWFilterDefFree(obj->def);\n    virNWFilterDefFree(obj->newDef);\n\n    virMutexDestroy(&obj->lock);\n\n    VIR_FREE(obj);\n}"
  },
  {
    "function_name": "virNWFilterObjWantRemoved",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "85-89",
    "snippet": "bool\nvirNWFilterObjWantRemoved(virNWFilterObjPtr obj)\n{\n    return obj->wantRemoved;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nbool\nvirNWFilterObjWantRemoved(virNWFilterObjPtr obj)\n{\n    return obj->wantRemoved;\n}"
  },
  {
    "function_name": "virNWFilterObjGetNewDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "78-82",
    "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetNewDef(virNWFilterObjPtr obj)\n{\n    return obj->newDef;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetNewDef(virNWFilterObjPtr obj)\n{\n    return obj->newDef;\n}"
  },
  {
    "function_name": "virNWFilterObjGetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "71-75",
    "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
  },
  {
    "function_name": "virNWFilterObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
    "lines": "51-68",
    "snippet": "static virNWFilterObjPtr\nvirNWFilterObjNew(void)\n{\n    virNWFilterObjPtr obj;\n\n    if (VIR_ALLOC(obj) < 0)\n        return NULL;\n\n    if (virMutexInitRecursive(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"cannot initialize mutex\"));\n        VIR_FREE(obj);\n        return NULL;\n    }\n\n    virNWFilterObjLock(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virnwfilterobj.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjLock",
          "args": [
            "obj"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "554-558",
          "snippet": "void\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjLock(virNWFilterObjPtr obj)\n{\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"cannot initialize mutex\")"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot initialize mutex\""
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexInitRecursive",
          "args": [
            "&obj->lock"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexInitRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "61-74",
          "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "obj"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virNWFilterObjPtr\nvirNWFilterObjNew(void)\n{\n    virNWFilterObjPtr obj;\n\n    if (VIR_ALLOC(obj) < 0)\n        return NULL;\n\n    if (virMutexInitRecursive(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"cannot initialize mutex\"));\n        VIR_FREE(obj);\n        return NULL;\n    }\n\n    virNWFilterObjLock(obj);\n    return obj;\n}"
  }
]