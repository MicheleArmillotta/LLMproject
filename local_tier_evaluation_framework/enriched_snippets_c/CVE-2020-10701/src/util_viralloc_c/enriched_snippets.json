[
  {
    "function_name": "virDisposeString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "379-386",
    "snippet": "void\nvirDisposeString(char **strptr)\n{\n    if (!*strptr)\n        return;\n\n    virDispose(strptr, strlen(*strptr), sizeof(char), NULL);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispose",
          "args": [
            "strptr",
            "strlen(*strptr)",
            "sizeof(char)",
            "NULL"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "virDispose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
          "lines": "351-370",
          "snippet": "void virDispose(void *ptrptr,\n                size_t count,\n                size_t element_size,\n                size_t *countptr)\n{\n    int save_errno = errno;\n\n    if (countptr)\n        count = *countptr;\n\n    if (*(void**)ptrptr && count > 0)\n        memset(*(void **)ptrptr, 0, count * element_size);\n\n    g_free(*(void**)ptrptr);\n    *(void**)ptrptr = NULL;\n\n    if (countptr)\n        *countptr = 0;\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid virDispose(void *ptrptr,\n                size_t count,\n                size_t element_size,\n                size_t *countptr)\n{\n    int save_errno = errno;\n\n    if (countptr)\n        count = *countptr;\n\n    if (*(void**)ptrptr && count > 0)\n        memset(*(void **)ptrptr, 0, count * element_size);\n\n    g_free(*(void**)ptrptr);\n    *(void**)ptrptr = NULL;\n\n    if (countptr)\n        *countptr = 0;\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "*strptr"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirDisposeString(char **strptr)\n{\n    if (!*strptr)\n        return;\n\n    virDispose(strptr, strlen(*strptr), sizeof(char), NULL);\n}"
  },
  {
    "function_name": "virDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "351-370",
    "snippet": "void virDispose(void *ptrptr,\n                size_t count,\n                size_t element_size,\n                size_t *countptr)\n{\n    int save_errno = errno;\n\n    if (countptr)\n        count = *countptr;\n\n    if (*(void**)ptrptr && count > 0)\n        memset(*(void **)ptrptr, 0, count * element_size);\n\n    g_free(*(void**)ptrptr);\n    *(void**)ptrptr = NULL;\n\n    if (countptr)\n        *countptr = 0;\n    errno = save_errno;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "*(void**)ptrptr"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "*(void **)ptrptr",
            "0",
            "count * element_size"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid virDispose(void *ptrptr,\n                size_t count,\n                size_t element_size,\n                size_t *countptr)\n{\n    int save_errno = errno;\n\n    if (countptr)\n        count = *countptr;\n\n    if (*(void**)ptrptr && count > 0)\n        memset(*(void **)ptrptr, 0, count * element_size);\n\n    g_free(*(void**)ptrptr);\n    *(void**)ptrptr = NULL;\n\n    if (countptr)\n        *countptr = 0;\n    errno = save_errno;\n}"
  },
  {
    "function_name": "virAllocVar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "321-334",
    "snippet": "int virAllocVar(void *ptrptr,\n                size_t struct_size,\n                size_t element_size,\n                size_t count)\n{\n    size_t alloc_size = 0;\n\n    if (VIR_ALLOC_VAR_OVERSIZED(struct_size, count, element_size))\n        abort();\n\n    alloc_size = struct_size + (element_size * count);\n    *(void **)ptrptr = g_malloc0(alloc_size);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_malloc0",
          "args": [
            "alloc_size"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_VAR_OVERSIZED",
          "args": [
            "struct_size",
            "count",
            "element_size"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virAllocVar(void *ptrptr,\n                size_t struct_size,\n                size_t element_size,\n                size_t count)\n{\n    size_t alloc_size = 0;\n\n    if (VIR_ALLOC_VAR_OVERSIZED(struct_size, count, element_size))\n        abort();\n\n    alloc_size = struct_size + (element_size * count);\n    *(void **)ptrptr = g_malloc0(alloc_size);\n    return 0;\n}"
  },
  {
    "function_name": "virDeleteElementsN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "278-301",
    "snippet": "int\nvirDeleteElementsN(void *ptrptr, size_t size, size_t at,\n                   size_t *countptr, size_t toremove,\n                   bool inPlace)\n{\n    if (at + toremove > *countptr) {\n        VIR_WARN(\"out of bounds index - count %zu at %zu toremove %zu\",\n                 *countptr, at, toremove);\n        return -1;\n    }\n\n    /* First move down the elements at the end that won't be deleted,\n     * then realloc. We assume that the items being deleted have\n     * already been cleared.\n    */\n    memmove(*(char**)ptrptr + (size * at),\n            *(char**)ptrptr + (size * (at + toremove)),\n            size * (*countptr - toremove - at));\n    if (inPlace)\n        *countptr -= toremove;\n    else\n        virShrinkN(ptrptr, size, countptr, toremove);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virShrinkN",
          "args": [
            "ptrptr",
            "size",
            "countptr",
            "toremove"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "virShrinkN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
          "lines": "175-185",
          "snippet": "void virShrinkN(void *ptrptr, size_t size, size_t *countptr, size_t toremove)\n{\n    if (toremove < *countptr) {\n        if (virReallocN(ptrptr, size, *countptr -= toremove) < 0)\n            abort();\n    } else {\n        g_free(*((void **)ptrptr));\n        *((void **)ptrptr) = NULL;\n        *countptr = 0;\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid virShrinkN(void *ptrptr, size_t size, size_t *countptr, size_t toremove)\n{\n    if (toremove < *countptr) {\n        if (virReallocN(ptrptr, size, *countptr -= toremove) < 0)\n            abort();\n    } else {\n        g_free(*((void **)ptrptr));\n        *((void **)ptrptr) = NULL;\n        *countptr = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "*(char**)ptrptr + (size * at)",
            "*(char**)ptrptr + (size * (at + toremove))",
            "size * (*countptr - toremove - at)"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"out of bounds index - count %zu at %zu toremove %zu\"",
            "*countptr",
            "at",
            "toremove"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirDeleteElementsN(void *ptrptr, size_t size, size_t at,\n                   size_t *countptr, size_t toremove,\n                   bool inPlace)\n{\n    if (at + toremove > *countptr) {\n        VIR_WARN(\"out of bounds index - count %zu at %zu toremove %zu\",\n                 *countptr, at, toremove);\n        return -1;\n    }\n\n    /* First move down the elements at the end that won't be deleted,\n     * then realloc. We assume that the items being deleted have\n     * already been cleared.\n    */\n    memmove(*(char**)ptrptr + (size * at),\n            *(char**)ptrptr + (size * (at + toremove)),\n            size * (*countptr - toremove - at));\n    if (inPlace)\n        *countptr -= toremove;\n    else\n        virShrinkN(ptrptr, size, countptr, toremove);\n    return 0;\n}"
  },
  {
    "function_name": "virInsertElementsN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "215-259",
    "snippet": "int\nvirInsertElementsN(void *ptrptr, size_t size, size_t at,\n                   size_t *countptr,\n                   size_t add, void *newelems,\n                   bool clearOriginal, bool inPlace)\n{\n    if (at == -1) {\n        at = *countptr;\n    } else if (at > *countptr) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"out of bounds index - count %zu at %zu add %zu\"),\n                       *countptr, at, add);\n        return -1;\n    }\n\n    if (inPlace) {\n        *countptr += add;\n    } else {\n        if (virExpandN(ptrptr, size, countptr, add) < 0)\n            abort();\n    }\n\n    /* memory was successfully re-allocated. Move up all elements from\n     * ptrptr[at] to the end (if we're not \"inserting\" at the end\n     * already), memcpy in the new elements, and clear the elements\n     * from their original location. Remember that *countptr has\n     * already been updated with new element count!\n     */\n    if (at < *countptr - add) {\n        memmove(*(char**)ptrptr + (size * (at + add)),\n                *(char**)ptrptr + (size * at),\n                size * (*countptr - add - at));\n    }\n\n    if (newelems) {\n        memcpy(*(char**)ptrptr + (size * at), newelems, size * add);\n        if (clearOriginal)\n           memset((char*)newelems, 0, size * add);\n    } else if (inPlace || (at < *countptr - add)) {\n        /* NB: if inPlace, assume memory at the end wasn't initialized */\n        memset(*(char**)ptrptr + (size * at), 0, size * add);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "*(char**)ptrptr + (size * at)",
            "0",
            "size * add"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "(char*)newelems",
            "0",
            "size * add"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "*(char**)ptrptr + (size * at)",
            "newelems",
            "size * add"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "*(char**)ptrptr + (size * (at + add))",
            "*(char**)ptrptr + (size * at)",
            "size * (*countptr - add - at)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virExpandN",
          "args": [
            "ptrptr",
            "size",
            "countptr",
            "add"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "virExpandN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
          "lines": "110-123",
          "snippet": "int virExpandN(void *ptrptr,\n               size_t size,\n               size_t *countptr,\n               size_t add)\n{\n    if (*countptr + add < *countptr)\n        abort();\n\n    if (virReallocN(ptrptr, size, *countptr + add) < 0)\n        abort();\n    memset(*(char **)ptrptr + (size * *countptr), 0, size * add);\n    *countptr += add;\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virExpandN(void *ptrptr,\n               size_t size,\n               size_t *countptr,\n               size_t add)\n{\n    if (*countptr + add < *countptr)\n        abort();\n\n    if (virReallocN(ptrptr, size, *countptr + add) < 0)\n        abort();\n    memset(*(char **)ptrptr + (size * *countptr), 0, size * add);\n    *countptr += add;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"out of bounds index - count %zu at %zu add %zu\")",
            "*countptr",
            "at",
            "add"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"out of bounds index - count %zu at %zu add %zu\""
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirInsertElementsN(void *ptrptr, size_t size, size_t at,\n                   size_t *countptr,\n                   size_t add, void *newelems,\n                   bool clearOriginal, bool inPlace)\n{\n    if (at == -1) {\n        at = *countptr;\n    } else if (at > *countptr) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"out of bounds index - count %zu at %zu add %zu\"),\n                       *countptr, at, add);\n        return -1;\n    }\n\n    if (inPlace) {\n        *countptr += add;\n    } else {\n        if (virExpandN(ptrptr, size, countptr, add) < 0)\n            abort();\n    }\n\n    /* memory was successfully re-allocated. Move up all elements from\n     * ptrptr[at] to the end (if we're not \"inserting\" at the end\n     * already), memcpy in the new elements, and clear the elements\n     * from their original location. Remember that *countptr has\n     * already been updated with new element count!\n     */\n    if (at < *countptr - add) {\n        memmove(*(char**)ptrptr + (size * (at + add)),\n                *(char**)ptrptr + (size * at),\n                size * (*countptr - add - at));\n    }\n\n    if (newelems) {\n        memcpy(*(char**)ptrptr + (size * at), newelems, size * add);\n        if (clearOriginal)\n           memset((char*)newelems, 0, size * add);\n    } else if (inPlace || (at < *countptr - add)) {\n        /* NB: if inPlace, assume memory at the end wasn't initialized */\n        memset(*(char**)ptrptr + (size * at), 0, size * add);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virShrinkN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "175-185",
    "snippet": "void virShrinkN(void *ptrptr, size_t size, size_t *countptr, size_t toremove)\n{\n    if (toremove < *countptr) {\n        if (virReallocN(ptrptr, size, *countptr -= toremove) < 0)\n            abort();\n    } else {\n        g_free(*((void **)ptrptr));\n        *((void **)ptrptr) = NULL;\n        *countptr = 0;\n    }\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "*((void **)ptrptr)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReallocN",
          "args": [
            "ptrptr",
            "size",
            "*countptr -= toremove"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "virReallocN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
          "lines": "87-93",
          "snippet": "int virReallocN(void *ptrptr,\n                size_t size,\n                size_t count)\n{\n    *(void **)ptrptr = g_realloc_n(*(void**)ptrptr, size, count);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virReallocN(void *ptrptr,\n                size_t size,\n                size_t count)\n{\n    *(void **)ptrptr = g_realloc_n(*(void**)ptrptr, size, count);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid virShrinkN(void *ptrptr, size_t size, size_t *countptr, size_t toremove)\n{\n    if (toremove < *countptr) {\n        if (virReallocN(ptrptr, size, *countptr -= toremove) < 0)\n            abort();\n    } else {\n        g_free(*((void **)ptrptr));\n        *((void **)ptrptr) = NULL;\n        *countptr = 0;\n    }\n}"
  },
  {
    "function_name": "virResizeN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "142-160",
    "snippet": "int virResizeN(void *ptrptr,\n               size_t size,\n               size_t *allocptr,\n               size_t count,\n               size_t add)\n{\n    size_t delta;\n\n    if (count + add < count)\n        abort();\n\n    if (count + add <= *allocptr)\n        return 0;\n\n    delta = count + add - *allocptr;\n    if (delta < *allocptr / 2)\n        delta = *allocptr / 2;\n    return virExpandN(ptrptr, size, allocptr, delta);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virExpandN",
          "args": [
            "ptrptr",
            "size",
            "allocptr",
            "delta"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "virExpandN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
          "lines": "110-123",
          "snippet": "int virExpandN(void *ptrptr,\n               size_t size,\n               size_t *countptr,\n               size_t add)\n{\n    if (*countptr + add < *countptr)\n        abort();\n\n    if (virReallocN(ptrptr, size, *countptr + add) < 0)\n        abort();\n    memset(*(char **)ptrptr + (size * *countptr), 0, size * add);\n    *countptr += add;\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virExpandN(void *ptrptr,\n               size_t size,\n               size_t *countptr,\n               size_t add)\n{\n    if (*countptr + add < *countptr)\n        abort();\n\n    if (virReallocN(ptrptr, size, *countptr + add) < 0)\n        abort();\n    memset(*(char **)ptrptr + (size * *countptr), 0, size * add);\n    *countptr += add;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virResizeN(void *ptrptr,\n               size_t size,\n               size_t *allocptr,\n               size_t count,\n               size_t add)\n{\n    size_t delta;\n\n    if (count + add < count)\n        abort();\n\n    if (count + add <= *allocptr)\n        return 0;\n\n    delta = count + add - *allocptr;\n    if (delta < *allocptr / 2)\n        delta = *allocptr / 2;\n    return virExpandN(ptrptr, size, allocptr, delta);\n}"
  },
  {
    "function_name": "virExpandN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "110-123",
    "snippet": "int virExpandN(void *ptrptr,\n               size_t size,\n               size_t *countptr,\n               size_t add)\n{\n    if (*countptr + add < *countptr)\n        abort();\n\n    if (virReallocN(ptrptr, size, *countptr + add) < 0)\n        abort();\n    memset(*(char **)ptrptr + (size * *countptr), 0, size * add);\n    *countptr += add;\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "*(char **)ptrptr + (size * *countptr)",
            "0",
            "size * add"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReallocN",
          "args": [
            "ptrptr",
            "size",
            "*countptr + add"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "virReallocN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
          "lines": "87-93",
          "snippet": "int virReallocN(void *ptrptr,\n                size_t size,\n                size_t count)\n{\n    *(void **)ptrptr = g_realloc_n(*(void**)ptrptr, size, count);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virReallocN(void *ptrptr,\n                size_t size,\n                size_t count)\n{\n    *(void **)ptrptr = g_realloc_n(*(void**)ptrptr, size, count);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virExpandN(void *ptrptr,\n               size_t size,\n               size_t *countptr,\n               size_t add)\n{\n    if (*countptr + add < *countptr)\n        abort();\n\n    if (virReallocN(ptrptr, size, *countptr + add) < 0)\n        abort();\n    memset(*(char **)ptrptr + (size * *countptr), 0, size * add);\n    *countptr += add;\n    return 0;\n}"
  },
  {
    "function_name": "virReallocN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "87-93",
    "snippet": "int virReallocN(void *ptrptr,\n                size_t size,\n                size_t count)\n{\n    *(void **)ptrptr = g_realloc_n(*(void**)ptrptr, size, count);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_realloc_n",
          "args": [
            "*(void**)ptrptr",
            "size",
            "count"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virReallocN(void *ptrptr,\n                size_t size,\n                size_t count)\n{\n    *(void **)ptrptr = g_realloc_n(*(void**)ptrptr, size, count);\n    return 0;\n}"
  },
  {
    "function_name": "virAllocN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "65-71",
    "snippet": "int virAllocN(void *ptrptr,\n              size_t size,\n              size_t count)\n{\n    *(void**)ptrptr = g_malloc0_n(count, size);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_malloc0_n",
          "args": [
            "count",
            "size"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virAllocN(void *ptrptr,\n              size_t size,\n              size_t count)\n{\n    *(void**)ptrptr = g_malloc0_n(count, size);\n    return 0;\n}"
  },
  {
    "function_name": "virAlloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viralloc.c",
    "lines": "45-50",
    "snippet": "int virAlloc(void *ptrptr,\n             size_t size)\n{\n    *(void **)ptrptr = g_malloc0(size);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_malloc0",
          "args": [
            "size"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint virAlloc(void *ptrptr,\n             size_t size)\n{\n    *(void **)ptrptr = g_malloc0(size);\n    return 0;\n}"
  }
]