[
  {
    "function_name": "virNetDevIPRouteFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/networkcommon_conf.c",
    "lines": "289-324",
    "snippet": "int\nvirNetDevIPRouteFormat(virBufferPtr buf,\n                       const virNetDevIPRoute *def)\n{\n    char *addr = NULL;\n\n    virBufferAddLit(buf, \"<route\");\n\n    if (def->family)\n        virBufferAsprintf(buf, \" family='%s'\", def->family);\n\n    if (!(addr = virSocketAddrFormat(&def->address)))\n        return -1;\n    virBufferAsprintf(buf, \" address='%s'\", addr);\n    VIR_FREE(addr);\n\n    if (VIR_SOCKET_ADDR_VALID(&def->netmask)) {\n        if (!(addr = virSocketAddrFormat(&def->netmask)))\n            return -1;\n        virBufferAsprintf(buf, \" netmask='%s'\", addr);\n        VIR_FREE(addr);\n    }\n    if (def->has_prefix)\n        virBufferAsprintf(buf, \" prefix='%u'\", def->prefix);\n\n    if (!(addr = virSocketAddrFormat(&def->gateway)))\n        return -1;\n    virBufferAsprintf(buf, \" gateway='%s'\", addr);\n    VIR_FREE(addr);\n\n    if (def->has_metric && def->metric > 0)\n        virBufferAsprintf(buf, \" metric='%u'\", def->metric);\n    virBufferAddLit(buf, \"/>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"networkcommon_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\" metric='%u'\"",
            "def->metric"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "addr"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketAddrFormat",
          "args": [
            "&def->gateway"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "441-445",
          "snippet": "char *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nchar *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "addr"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_VALID",
          "args": [
            "&def->netmask"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "addr"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<route\""
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"networkcommon_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirNetDevIPRouteFormat(virBufferPtr buf,\n                       const virNetDevIPRoute *def)\n{\n    char *addr = NULL;\n\n    virBufferAddLit(buf, \"<route\");\n\n    if (def->family)\n        virBufferAsprintf(buf, \" family='%s'\", def->family);\n\n    if (!(addr = virSocketAddrFormat(&def->address)))\n        return -1;\n    virBufferAsprintf(buf, \" address='%s'\", addr);\n    VIR_FREE(addr);\n\n    if (VIR_SOCKET_ADDR_VALID(&def->netmask)) {\n        if (!(addr = virSocketAddrFormat(&def->netmask)))\n            return -1;\n        virBufferAsprintf(buf, \" netmask='%s'\", addr);\n        VIR_FREE(addr);\n    }\n    if (def->has_prefix)\n        virBufferAsprintf(buf, \" prefix='%u'\", def->prefix);\n\n    if (!(addr = virSocketAddrFormat(&def->gateway)))\n        return -1;\n    virBufferAsprintf(buf, \" gateway='%s'\", addr);\n    VIR_FREE(addr);\n\n    if (def->has_metric && def->metric > 0)\n        virBufferAsprintf(buf, \" metric='%u'\", def->metric);\n    virBufferAddLit(buf, \"/>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevIPRouteParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/networkcommon_conf.c",
    "lines": "220-287",
    "snippet": "virNetDevIPRoutePtr\nvirNetDevIPRouteParseXML(const char *errorDetail,\n                         xmlNodePtr node,\n                         xmlXPathContextPtr ctxt)\n{\n    /*\n     * virNetDevIPRoute object is already allocated as part\n     * of an array.  On failure clear: it out, but don't free it.\n     */\n\n    virNetDevIPRoutePtr def = NULL;\n    xmlNodePtr save;\n    char *family = NULL;\n    char *address = NULL, *netmask = NULL;\n    char *gateway = NULL;\n    unsigned long prefix = 0, metric = 0;\n    int prefixRc, metricRc;\n    bool hasPrefix = false;\n    bool hasMetric = false;\n\n    save = ctxt->node;\n    ctxt->node = node;\n\n    /* grab raw data from XML */\n    family = virXPathString(\"string(./@family)\", ctxt);\n    address = virXPathString(\"string(./@address)\", ctxt);\n    netmask = virXPathString(\"string(./@netmask)\", ctxt);\n    gateway = virXPathString(\"string(./@gateway)\", ctxt);\n    prefixRc = virXPathULong(\"string(./@prefix)\", ctxt, &prefix);\n    if (prefixRc == -2) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Invalid prefix specified \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto cleanup;\n    }\n    hasPrefix = (prefixRc == 0);\n    metricRc = virXPathULong(\"string(./@metric)\", ctxt, &metric);\n    if (metricRc == -2) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Invalid metric specified \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto cleanup;\n    }\n    if (metricRc == 0) {\n        hasMetric = true;\n        if (metric == 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid metric value, must be > 0 \"\n                             \"in route definition\"),\n                           errorDetail);\n            goto cleanup;\n        }\n    }\n\n    def = virNetDevIPRouteCreate(errorDetail, family, address, netmask,\n                                 gateway, prefix, hasPrefix, metric,\n                                 hasMetric);\n\n cleanup:\n    ctxt->node = save;\n    VIR_FREE(family);\n    VIR_FREE(address);\n    VIR_FREE(netmask);\n    VIR_FREE(gateway);\n    return def;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"networkcommon_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "gateway"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "netmask"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "address"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "family"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevIPRouteCreate",
          "args": [
            "errorDetail",
            "family",
            "address",
            "netmask",
            "gateway",
            "prefix",
            "hasPrefix",
            "metric",
            "hasMetric"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIPRouteCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/networkcommon_conf.c",
          "lines": "33-218",
          "snippet": "virNetDevIPRoutePtr\nvirNetDevIPRouteCreate(const char *errorDetail,\n                       const char *family,\n                       const char *address,\n                       const char *netmask,\n                       const char *gateway,\n                       unsigned int prefix,\n                       bool hasPrefix,\n                       unsigned int metric,\n                       bool hasMetric)\n{\n    virNetDevIPRoutePtr def = NULL;\n    virSocketAddr testAddr;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->family = g_strdup(family);\n\n    def->prefix = prefix;\n    def->has_prefix = hasPrefix;\n    def->metric = metric;\n    def->has_metric = hasMetric;\n\n    /* Note: both network and gateway addresses must be specified */\n\n    if (!address) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required address attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (!gateway) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required gateway attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->address, address, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad network address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->gateway, gateway, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad gateway address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, gateway);\n        goto error;\n    }\n\n    /* validate network address, etc. for each family */\n    if ((def->family == NULL) || (STREQ(def->family, \"ipv4\"))) {\n        if (!(VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET) ||\n              VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_UNSPEC))) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 address '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            if (virSocketAddrParse(&def->netmask, netmask, AF_UNSPEC) < 0) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Bad netmask address '%s' \"\n                                 \"in route definition\"),\n                               errorDetail, netmask);\n                goto error;\n            }\n            if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->netmask, AF_INET)) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Invalid netmask '%s' \"\n                                 \"for address '%s' (both must be IPv4)\"),\n                               errorDetail, netmask, address);\n                goto error;\n            }\n            if (def->has_prefix) {\n                /* can't have both netmask and prefix at the same time */\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Route definition cannot have both \"\n                                 \"a prefix and a netmask\"),\n                               errorDetail);\n                goto error;\n            }\n        }\n        if (def->prefix > 32) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 32\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else if (STREQ(def->family, \"ipv6\")) {\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 family specified for non-IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Specifying netmask invalid for IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 specified for non-IPv6 gateway address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, gateway);\n            goto error;\n        }\n        if (def->prefix > 128) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 128\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Unrecognized family '%s' \"\n                         \"in route definition\"),\n                       errorDetail, def->family);\n        goto error;\n    }\n\n    /* make sure the address is a network address */\n    if (netmask) {\n        if (virSocketAddrMask(&def->address, &def->netmask, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with netmask '%s' \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, netmask);\n            goto error;\n        }\n    } else {\n        if (virSocketAddrMaskByPrefix(&def->address,\n                                      def->prefix, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with prefix %u \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, def->prefix);\n            goto error;\n        }\n    }\n    if (!virSocketAddrEqual(&def->address, &testAddr)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Address '%s' in route definition \"\n                         \"is not a network address\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    return def;\n\n error:\n    virNetDevIPRouteFree(def);\n    return NULL;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"networkcommon_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirNetDevIPRoutePtr\nvirNetDevIPRouteCreate(const char *errorDetail,\n                       const char *family,\n                       const char *address,\n                       const char *netmask,\n                       const char *gateway,\n                       unsigned int prefix,\n                       bool hasPrefix,\n                       unsigned int metric,\n                       bool hasMetric)\n{\n    virNetDevIPRoutePtr def = NULL;\n    virSocketAddr testAddr;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->family = g_strdup(family);\n\n    def->prefix = prefix;\n    def->has_prefix = hasPrefix;\n    def->metric = metric;\n    def->has_metric = hasMetric;\n\n    /* Note: both network and gateway addresses must be specified */\n\n    if (!address) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required address attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (!gateway) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required gateway attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->address, address, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad network address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->gateway, gateway, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad gateway address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, gateway);\n        goto error;\n    }\n\n    /* validate network address, etc. for each family */\n    if ((def->family == NULL) || (STREQ(def->family, \"ipv4\"))) {\n        if (!(VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET) ||\n              VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_UNSPEC))) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 address '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            if (virSocketAddrParse(&def->netmask, netmask, AF_UNSPEC) < 0) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Bad netmask address '%s' \"\n                                 \"in route definition\"),\n                               errorDetail, netmask);\n                goto error;\n            }\n            if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->netmask, AF_INET)) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Invalid netmask '%s' \"\n                                 \"for address '%s' (both must be IPv4)\"),\n                               errorDetail, netmask, address);\n                goto error;\n            }\n            if (def->has_prefix) {\n                /* can't have both netmask and prefix at the same time */\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Route definition cannot have both \"\n                                 \"a prefix and a netmask\"),\n                               errorDetail);\n                goto error;\n            }\n        }\n        if (def->prefix > 32) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 32\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else if (STREQ(def->family, \"ipv6\")) {\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 family specified for non-IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Specifying netmask invalid for IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 specified for non-IPv6 gateway address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, gateway);\n            goto error;\n        }\n        if (def->prefix > 128) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 128\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Unrecognized family '%s' \"\n                         \"in route definition\"),\n                       errorDetail, def->family);\n        goto error;\n    }\n\n    /* make sure the address is a network address */\n    if (netmask) {\n        if (virSocketAddrMask(&def->address, &def->netmask, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with netmask '%s' \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, netmask);\n            goto error;\n        }\n    } else {\n        if (virSocketAddrMaskByPrefix(&def->address,\n                                      def->prefix, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with prefix %u \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, def->prefix);\n            goto error;\n        }\n    }\n    if (!virSocketAddrEqual(&def->address, &testAddr)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Address '%s' in route definition \"\n                         \"is not a network address\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    return def;\n\n error:\n    virNetDevIPRouteFree(def);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Invalid metric value, must be > 0 \"\n                             \"in route definition\")",
            "errorDetail"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: Invalid metric value, must be > 0 \"\n                             \"in route definition\""
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Invalid metric specified \"\n                         \"in route definition\")",
            "errorDetail"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathULong",
          "args": [
            "\"string(./@metric)\"",
            "ctxt",
            "&metric"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathULongLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "398-430",
          "snippet": "int\nvirXPathULongLong(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  unsigned long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ull((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathULongLong(const char *xpath,\n                  xmlXPathContextPtr ctxt,\n                  unsigned long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathULong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ull((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (unsigned long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Invalid prefix specified \"\n                         \"in route definition\")",
            "errorDetail"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./@gateway)\"",
            "ctxt"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"networkcommon_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirNetDevIPRoutePtr\nvirNetDevIPRouteParseXML(const char *errorDetail,\n                         xmlNodePtr node,\n                         xmlXPathContextPtr ctxt)\n{\n    /*\n     * virNetDevIPRoute object is already allocated as part\n     * of an array.  On failure clear: it out, but don't free it.\n     */\n\n    virNetDevIPRoutePtr def = NULL;\n    xmlNodePtr save;\n    char *family = NULL;\n    char *address = NULL, *netmask = NULL;\n    char *gateway = NULL;\n    unsigned long prefix = 0, metric = 0;\n    int prefixRc, metricRc;\n    bool hasPrefix = false;\n    bool hasMetric = false;\n\n    save = ctxt->node;\n    ctxt->node = node;\n\n    /* grab raw data from XML */\n    family = virXPathString(\"string(./@family)\", ctxt);\n    address = virXPathString(\"string(./@address)\", ctxt);\n    netmask = virXPathString(\"string(./@netmask)\", ctxt);\n    gateway = virXPathString(\"string(./@gateway)\", ctxt);\n    prefixRc = virXPathULong(\"string(./@prefix)\", ctxt, &prefix);\n    if (prefixRc == -2) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Invalid prefix specified \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto cleanup;\n    }\n    hasPrefix = (prefixRc == 0);\n    metricRc = virXPathULong(\"string(./@metric)\", ctxt, &metric);\n    if (metricRc == -2) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Invalid metric specified \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto cleanup;\n    }\n    if (metricRc == 0) {\n        hasMetric = true;\n        if (metric == 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid metric value, must be > 0 \"\n                             \"in route definition\"),\n                           errorDetail);\n            goto cleanup;\n        }\n    }\n\n    def = virNetDevIPRouteCreate(errorDetail, family, address, netmask,\n                                 gateway, prefix, hasPrefix, metric,\n                                 hasMetric);\n\n cleanup:\n    ctxt->node = save;\n    VIR_FREE(family);\n    VIR_FREE(address);\n    VIR_FREE(netmask);\n    VIR_FREE(gateway);\n    return def;\n}"
  },
  {
    "function_name": "virNetDevIPRouteCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/networkcommon_conf.c",
    "lines": "33-218",
    "snippet": "virNetDevIPRoutePtr\nvirNetDevIPRouteCreate(const char *errorDetail,\n                       const char *family,\n                       const char *address,\n                       const char *netmask,\n                       const char *gateway,\n                       unsigned int prefix,\n                       bool hasPrefix,\n                       unsigned int metric,\n                       bool hasMetric)\n{\n    virNetDevIPRoutePtr def = NULL;\n    virSocketAddr testAddr;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->family = g_strdup(family);\n\n    def->prefix = prefix;\n    def->has_prefix = hasPrefix;\n    def->metric = metric;\n    def->has_metric = hasMetric;\n\n    /* Note: both network and gateway addresses must be specified */\n\n    if (!address) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required address attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (!gateway) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required gateway attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->address, address, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad network address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->gateway, gateway, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad gateway address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, gateway);\n        goto error;\n    }\n\n    /* validate network address, etc. for each family */\n    if ((def->family == NULL) || (STREQ(def->family, \"ipv4\"))) {\n        if (!(VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET) ||\n              VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_UNSPEC))) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 address '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            if (virSocketAddrParse(&def->netmask, netmask, AF_UNSPEC) < 0) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Bad netmask address '%s' \"\n                                 \"in route definition\"),\n                               errorDetail, netmask);\n                goto error;\n            }\n            if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->netmask, AF_INET)) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Invalid netmask '%s' \"\n                                 \"for address '%s' (both must be IPv4)\"),\n                               errorDetail, netmask, address);\n                goto error;\n            }\n            if (def->has_prefix) {\n                /* can't have both netmask and prefix at the same time */\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Route definition cannot have both \"\n                                 \"a prefix and a netmask\"),\n                               errorDetail);\n                goto error;\n            }\n        }\n        if (def->prefix > 32) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 32\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else if (STREQ(def->family, \"ipv6\")) {\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 family specified for non-IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Specifying netmask invalid for IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 specified for non-IPv6 gateway address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, gateway);\n            goto error;\n        }\n        if (def->prefix > 128) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 128\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Unrecognized family '%s' \"\n                         \"in route definition\"),\n                       errorDetail, def->family);\n        goto error;\n    }\n\n    /* make sure the address is a network address */\n    if (netmask) {\n        if (virSocketAddrMask(&def->address, &def->netmask, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with netmask '%s' \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, netmask);\n            goto error;\n        }\n    } else {\n        if (virSocketAddrMaskByPrefix(&def->address,\n                                      def->prefix, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with prefix %u \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, def->prefix);\n            goto error;\n        }\n    }\n    if (!virSocketAddrEqual(&def->address, &testAddr)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Address '%s' in route definition \"\n                         \"is not a network address\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    return def;\n\n error:\n    virNetDevIPRouteFree(def);\n    return NULL;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"networkcommon_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevIPRouteFree",
          "args": [
            "def"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIPRouteFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevip.c",
          "lines": "975-982",
          "snippet": "void\nvirNetDevIPRouteFree(virNetDevIPRoutePtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}",
          "includes": [
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <net/if.h>",
            "# include <sys/ioctl.h>",
            "# include <ifaddrs.h>",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetlink.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevip.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <net/if.h>\n# include <sys/ioctl.h>\n# include <ifaddrs.h>\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virnetlink.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevip.h\"\n#include <config.h>\n\nvoid\nvirNetDevIPRouteFree(virNetDevIPRoutePtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Address '%s' in route definition \"\n                         \"is not a network address\")",
            "errorDetail",
            "address"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: Address '%s' in route definition \"\n                         \"is not a network address\""
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSocketAddrEqual",
          "args": [
            "&def->address",
            "&testAddr"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "359-378",
          "snippet": "bool\nvirSocketAddrEqual(const virSocketAddr *s1, const virSocketAddr *s2)\n{\n    if (s1->data.stor.ss_family != s2->data.stor.ss_family)\n        return false;\n\n    switch (s1->data.stor.ss_family) {\n    case AF_INET:\n        return (memcmp(&s1->data.inet4.sin_addr.s_addr,\n                       &s2->data.inet4.sin_addr.s_addr,\n                       sizeof(s1->data.inet4.sin_addr.s_addr)) == 0 &&\n                s1->data.inet4.sin_port == s2->data.inet4.sin_port);\n    case AF_INET6:\n        return (memcmp(&s1->data.inet6.sin6_addr.s6_addr,\n                       &s2->data.inet6.sin6_addr.s6_addr,\n                       sizeof(s1->data.inet6.sin6_addr.s6_addr)) == 0 &&\n                s1->data.inet6.sin6_port == s2->data.inet6.sin6_port);\n    }\n    return false;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nbool\nvirSocketAddrEqual(const virSocketAddr *s1, const virSocketAddr *s2)\n{\n    if (s1->data.stor.ss_family != s2->data.stor.ss_family)\n        return false;\n\n    switch (s1->data.stor.ss_family) {\n    case AF_INET:\n        return (memcmp(&s1->data.inet4.sin_addr.s_addr,\n                       &s2->data.inet4.sin_addr.s_addr,\n                       sizeof(s1->data.inet4.sin_addr.s_addr)) == 0 &&\n                s1->data.inet4.sin_port == s2->data.inet4.sin_port);\n    case AF_INET6:\n        return (memcmp(&s1->data.inet6.sin6_addr.s6_addr,\n                       &s2->data.inet6.sin6_addr.s6_addr,\n                       sizeof(s1->data.inet6.sin6_addr.s6_addr)) == 0 &&\n                s1->data.inet6.sin6_port == s2->data.inet6.sin6_port);\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: Error converting address '%s' with prefix %u \"\n                             \"to network-address \"\n                             \"in route definition\")",
            "errorDetail",
            "address",
            "def->prefix"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketAddrMaskByPrefix",
          "args": [
            "&def->address",
            "def->prefix",
            "&testAddr"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrMaskByPrefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "679-693",
          "snippet": "int\nvirSocketAddrMaskByPrefix(const virSocketAddr *addr,\n                          unsigned int prefix,\n                          virSocketAddrPtr network)\n{\n    virSocketAddr netmask;\n\n    if (virSocketAddrPrefixToNetmask(prefix, &netmask,\n                                     addr->data.stor.ss_family) < 0) {\n        network->data.stor.ss_family = AF_UNSPEC;\n        return -1;\n    }\n\n    return virSocketAddrMask(addr, &netmask, network);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nint\nvirSocketAddrMaskByPrefix(const virSocketAddr *addr,\n                          unsigned int prefix,\n                          virSocketAddrPtr network)\n{\n    virSocketAddr netmask;\n\n    if (virSocketAddrPrefixToNetmask(prefix, &netmask,\n                                     addr->data.stor.ss_family) < 0) {\n        network->data.stor.ss_family = AF_UNSPEC;\n        return -1;\n    }\n\n    return virSocketAddrMask(addr, &netmask, network);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: Error converting address '%s' with netmask '%s' \"\n                             \"to network-address \"\n                             \"in route definition\")",
            "errorDetail",
            "address",
            "netmask"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Unrecognized family '%s' \"\n                         \"in route definition\")",
            "errorDetail",
            "def->family"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 128\")",
            "errorDetail",
            "def->prefix"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: ipv6 specified for non-IPv6 gateway address '%s' \"\n                             \"in route definition\")",
            "errorDetail",
            "gateway"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&def->gateway",
            "AF_INET6"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Specifying netmask invalid for IPv6 address '%s' \"\n                             \"in route definition\")",
            "errorDetail",
            "address"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: ipv6 family specified for non-IPv6 address '%s' \"\n                             \"in route definition\")",
            "errorDetail",
            "address"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&def->address",
            "AF_INET6"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "def->family",
            "\"ipv6\""
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 32\")",
            "errorDetail",
            "def->prefix"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Route definition cannot have both \"\n                                 \"a prefix and a netmask\")",
            "errorDetail"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Invalid netmask '%s' \"\n                                 \"for address '%s' (both must be IPv4)\")",
            "errorDetail",
            "netmask",
            "address"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&def->netmask",
            "AF_INET"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Bad netmask address '%s' \"\n                                 \"in route definition\")",
            "errorDetail",
            "netmask"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketAddrParse",
          "args": [
            "&def->netmask",
            "netmask",
            "AF_UNSPEC"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "135-158",
          "snippet": "int virSocketAddrParse(virSocketAddrPtr addr, const char *val, int family)\n{\n    int len;\n    struct addrinfo *res;\n\n    if (virSocketAddrParseInternal(&res, val, family, AI_NUMERICHOST, true) < 0)\n        return -1;\n\n    if (res == NULL) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"No socket addresses found for '%s'\"),\n                       val);\n        return -1;\n    }\n\n    len = res->ai_addrlen;\n    if (addr != NULL) {\n        memcpy(&addr->data.stor, res->ai_addr, len);\n        addr->len = res->ai_addrlen;\n    }\n\n    freeaddrinfo(res);\n    return len;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nint virSocketAddrParse(virSocketAddrPtr addr, const char *val, int family)\n{\n    int len;\n    struct addrinfo *res;\n\n    if (virSocketAddrParseInternal(&res, val, family, AI_NUMERICHOST, true) < 0)\n        return -1;\n\n    if (res == NULL) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"No socket addresses found for '%s'\"),\n                       val);\n        return -1;\n    }\n\n    len = res->ai_addrlen;\n    if (addr != NULL) {\n        memcpy(&addr->data.stor, res->ai_addr, len);\n        addr->len = res->ai_addrlen;\n    }\n\n    freeaddrinfo(res);\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\")",
            "errorDetail",
            "address"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&def->gateway",
            "AF_INET"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 address '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 address '%s' \"\n                             \"in route definition\")",
            "errorDetail",
            "address"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&def->address",
            "AF_UNSPEC"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&def->address",
            "AF_INET"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "def->family",
            "\"ipv4\""
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Bad gateway address '%s' \"\n                         \"in route definition\")",
            "errorDetail",
            "gateway"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Bad network address '%s' \"\n                         \"in route definition\")",
            "errorDetail",
            "address"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Missing required gateway attribute \"\n                         \"in route definition\")",
            "errorDetail"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"%s: Missing required address attribute \"\n                         \"in route definition\")",
            "errorDetail"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "family"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"networkcommon_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirNetDevIPRoutePtr\nvirNetDevIPRouteCreate(const char *errorDetail,\n                       const char *family,\n                       const char *address,\n                       const char *netmask,\n                       const char *gateway,\n                       unsigned int prefix,\n                       bool hasPrefix,\n                       unsigned int metric,\n                       bool hasMetric)\n{\n    virNetDevIPRoutePtr def = NULL;\n    virSocketAddr testAddr;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->family = g_strdup(family);\n\n    def->prefix = prefix;\n    def->has_prefix = hasPrefix;\n    def->metric = metric;\n    def->has_metric = hasMetric;\n\n    /* Note: both network and gateway addresses must be specified */\n\n    if (!address) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required address attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (!gateway) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required gateway attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->address, address, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad network address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->gateway, gateway, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad gateway address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, gateway);\n        goto error;\n    }\n\n    /* validate network address, etc. for each family */\n    if ((def->family == NULL) || (STREQ(def->family, \"ipv4\"))) {\n        if (!(VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET) ||\n              VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_UNSPEC))) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 address '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            if (virSocketAddrParse(&def->netmask, netmask, AF_UNSPEC) < 0) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Bad netmask address '%s' \"\n                                 \"in route definition\"),\n                               errorDetail, netmask);\n                goto error;\n            }\n            if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->netmask, AF_INET)) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Invalid netmask '%s' \"\n                                 \"for address '%s' (both must be IPv4)\"),\n                               errorDetail, netmask, address);\n                goto error;\n            }\n            if (def->has_prefix) {\n                /* can't have both netmask and prefix at the same time */\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Route definition cannot have both \"\n                                 \"a prefix and a netmask\"),\n                               errorDetail);\n                goto error;\n            }\n        }\n        if (def->prefix > 32) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 32\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else if (STREQ(def->family, \"ipv6\")) {\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 family specified for non-IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Specifying netmask invalid for IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 specified for non-IPv6 gateway address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, gateway);\n            goto error;\n        }\n        if (def->prefix > 128) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 128\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Unrecognized family '%s' \"\n                         \"in route definition\"),\n                       errorDetail, def->family);\n        goto error;\n    }\n\n    /* make sure the address is a network address */\n    if (netmask) {\n        if (virSocketAddrMask(&def->address, &def->netmask, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with netmask '%s' \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, netmask);\n            goto error;\n        }\n    } else {\n        if (virSocketAddrMaskByPrefix(&def->address,\n                                      def->prefix, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with prefix %u \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, def->prefix);\n            goto error;\n        }\n    }\n    if (!virSocketAddrEqual(&def->address, &testAddr)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Address '%s' in route definition \"\n                         \"is not a network address\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    return def;\n\n error:\n    virNetDevIPRouteFree(def);\n    return NULL;\n}"
  }
]