[
  {
    "function_name": "dnsmasqCapsGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "860-864",
    "snippet": "bool\ndnsmasqCapsGet(dnsmasqCapsPtr caps, dnsmasqCapsFlags flag)\n{\n    return caps && virBitmapIsBitSet(caps->flags, flag);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapIsBitSet",
          "args": [
            "caps->flags",
            "flag"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsBitSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "298-306",
          "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nbool\ndnsmasqCapsGet(dnsmasqCapsPtr caps, dnsmasqCapsFlags flag)\n{\n    return caps && virBitmapIsBitSet(caps->flags, flag);\n}"
  },
  {
    "function_name": "dnsmasqCapsGetVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "851-858",
    "snippet": "unsigned long\ndnsmasqCapsGetVersion(dnsmasqCapsPtr caps)\n{\n    if (caps)\n        return caps->version;\n    else\n        return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nunsigned long\ndnsmasqCapsGetVersion(dnsmasqCapsPtr caps)\n{\n    if (caps)\n        return caps->version;\n    else\n        return 0;\n}"
  },
  {
    "function_name": "dnsmasqCapsGetBinaryPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "845-849",
    "snippet": "const char *\ndnsmasqCapsGetBinaryPath(dnsmasqCapsPtr caps)\n{\n    return caps ? caps->binaryPath : DNSMASQ;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\ndnsmasqCapsGetBinaryPath(dnsmasqCapsPtr caps)\n{\n    return caps ? caps->binaryPath : DNSMASQ;\n}"
  },
  {
    "function_name": "dnsmasqCapsRefresh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "835-843",
    "snippet": "int\ndnsmasqCapsRefresh(dnsmasqCapsPtr *caps, const char *binaryPath)\n{\n    if (!*caps) {\n        *caps = dnsmasqCapsNewFromBinary(binaryPath);\n        return *caps ? 0 : -1;\n    }\n    return dnsmasqCapsRefreshInternal(*caps, false);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dnsmasqCapsRefreshInternal",
          "args": [
            "*caps",
            "false"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsRefreshInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "707-762",
          "snippet": "static int\ndnsmasqCapsRefreshInternal(dnsmasqCapsPtr caps, bool force)\n{\n    int ret = -1;\n    struct stat sb;\n    virCommandPtr cmd = NULL;\n    char *help = NULL, *version = NULL, *complete = NULL;\n\n    if (!caps || caps->noRefresh)\n        return 0;\n\n    if (stat(caps->binaryPath, &sb) < 0) {\n        virReportSystemError(errno, _(\"Cannot check dnsmasq binary %s\"),\n                             caps->binaryPath);\n        return -1;\n    }\n    if (!force && caps->mtime == sb.st_mtime)\n        return 0;\n    caps->mtime = sb.st_mtime;\n\n    /* Make sure the binary we are about to try exec'ing exists.\n     * Technically we could catch the exec() failure, but that's\n     * in a sub-process so it's hard to feed back a useful error.\n     */\n    if (!virFileIsExecutable(caps->binaryPath)) {\n        virReportSystemError(errno, _(\"dnsmasq binary %s is not executable\"),\n                             caps->binaryPath);\n        goto cleanup;\n    }\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--version\", NULL);\n    virCommandSetOutputBuffer(cmd, &version);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n    virCommandFree(cmd);\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--help\", NULL);\n    virCommandSetOutputBuffer(cmd, &help);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    complete = g_strdup_printf(\"%s\\n%s\", version, help);\n\n    ret = dnsmasqCapsSetFromBuffer(caps, complete);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n    VIR_FREE(version);\n    VIR_FREE(complete);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\ndnsmasqCapsRefreshInternal(dnsmasqCapsPtr caps, bool force)\n{\n    int ret = -1;\n    struct stat sb;\n    virCommandPtr cmd = NULL;\n    char *help = NULL, *version = NULL, *complete = NULL;\n\n    if (!caps || caps->noRefresh)\n        return 0;\n\n    if (stat(caps->binaryPath, &sb) < 0) {\n        virReportSystemError(errno, _(\"Cannot check dnsmasq binary %s\"),\n                             caps->binaryPath);\n        return -1;\n    }\n    if (!force && caps->mtime == sb.st_mtime)\n        return 0;\n    caps->mtime = sb.st_mtime;\n\n    /* Make sure the binary we are about to try exec'ing exists.\n     * Technically we could catch the exec() failure, but that's\n     * in a sub-process so it's hard to feed back a useful error.\n     */\n    if (!virFileIsExecutable(caps->binaryPath)) {\n        virReportSystemError(errno, _(\"dnsmasq binary %s is not executable\"),\n                             caps->binaryPath);\n        goto cleanup;\n    }\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--version\", NULL);\n    virCommandSetOutputBuffer(cmd, &version);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n    virCommandFree(cmd);\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--help\", NULL);\n    virCommandSetOutputBuffer(cmd, &help);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    complete = g_strdup_printf(\"%s\\n%s\", version, help);\n\n    ret = dnsmasqCapsSetFromBuffer(caps, complete);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n    VIR_FREE(version);\n    VIR_FREE(complete);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsNewFromBinary",
          "args": [
            "binaryPath"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsNewFromBinary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "813-826",
          "snippet": "dnsmasqCapsPtr\ndnsmasqCapsNewFromBinary(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps = dnsmasqCapsNewEmpty(binaryPath);\n\n    if (!caps)\n        return NULL;\n\n    if (dnsmasqCapsRefreshInternal(caps, true) < 0) {\n        virObjectUnref(caps);\n        return NULL;\n    }\n    return caps;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\ndnsmasqCapsPtr\ndnsmasqCapsNewFromBinary(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps = dnsmasqCapsNewEmpty(binaryPath);\n\n    if (!caps)\n        return NULL;\n\n    if (dnsmasqCapsRefreshInternal(caps, true) < 0) {\n        virObjectUnref(caps);\n        return NULL;\n    }\n    return caps;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\ndnsmasqCapsRefresh(dnsmasqCapsPtr *caps, const char *binaryPath)\n{\n    if (!*caps) {\n        *caps = dnsmasqCapsNewFromBinary(binaryPath);\n        return *caps ? 0 : -1;\n    }\n    return dnsmasqCapsRefreshInternal(*caps, false);\n}"
  },
  {
    "function_name": "dnsmasqCapsNewFromBinary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "813-826",
    "snippet": "dnsmasqCapsPtr\ndnsmasqCapsNewFromBinary(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps = dnsmasqCapsNewEmpty(binaryPath);\n\n    if (!caps)\n        return NULL;\n\n    if (dnsmasqCapsRefreshInternal(caps, true) < 0) {\n        virObjectUnref(caps);\n        return NULL;\n    }\n    return caps;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 822
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsRefreshInternal",
          "args": [
            "caps",
            "true"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsRefreshInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "707-762",
          "snippet": "static int\ndnsmasqCapsRefreshInternal(dnsmasqCapsPtr caps, bool force)\n{\n    int ret = -1;\n    struct stat sb;\n    virCommandPtr cmd = NULL;\n    char *help = NULL, *version = NULL, *complete = NULL;\n\n    if (!caps || caps->noRefresh)\n        return 0;\n\n    if (stat(caps->binaryPath, &sb) < 0) {\n        virReportSystemError(errno, _(\"Cannot check dnsmasq binary %s\"),\n                             caps->binaryPath);\n        return -1;\n    }\n    if (!force && caps->mtime == sb.st_mtime)\n        return 0;\n    caps->mtime = sb.st_mtime;\n\n    /* Make sure the binary we are about to try exec'ing exists.\n     * Technically we could catch the exec() failure, but that's\n     * in a sub-process so it's hard to feed back a useful error.\n     */\n    if (!virFileIsExecutable(caps->binaryPath)) {\n        virReportSystemError(errno, _(\"dnsmasq binary %s is not executable\"),\n                             caps->binaryPath);\n        goto cleanup;\n    }\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--version\", NULL);\n    virCommandSetOutputBuffer(cmd, &version);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n    virCommandFree(cmd);\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--help\", NULL);\n    virCommandSetOutputBuffer(cmd, &help);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    complete = g_strdup_printf(\"%s\\n%s\", version, help);\n\n    ret = dnsmasqCapsSetFromBuffer(caps, complete);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n    VIR_FREE(version);\n    VIR_FREE(complete);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\ndnsmasqCapsRefreshInternal(dnsmasqCapsPtr caps, bool force)\n{\n    int ret = -1;\n    struct stat sb;\n    virCommandPtr cmd = NULL;\n    char *help = NULL, *version = NULL, *complete = NULL;\n\n    if (!caps || caps->noRefresh)\n        return 0;\n\n    if (stat(caps->binaryPath, &sb) < 0) {\n        virReportSystemError(errno, _(\"Cannot check dnsmasq binary %s\"),\n                             caps->binaryPath);\n        return -1;\n    }\n    if (!force && caps->mtime == sb.st_mtime)\n        return 0;\n    caps->mtime = sb.st_mtime;\n\n    /* Make sure the binary we are about to try exec'ing exists.\n     * Technically we could catch the exec() failure, but that's\n     * in a sub-process so it's hard to feed back a useful error.\n     */\n    if (!virFileIsExecutable(caps->binaryPath)) {\n        virReportSystemError(errno, _(\"dnsmasq binary %s is not executable\"),\n                             caps->binaryPath);\n        goto cleanup;\n    }\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--version\", NULL);\n    virCommandSetOutputBuffer(cmd, &version);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n    virCommandFree(cmd);\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--help\", NULL);\n    virCommandSetOutputBuffer(cmd, &help);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    complete = g_strdup_printf(\"%s\\n%s\", version, help);\n\n    ret = dnsmasqCapsSetFromBuffer(caps, complete);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n    VIR_FREE(version);\n    VIR_FREE(complete);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsNewEmpty",
          "args": [
            "binaryPath"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsNewEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "764-781",
          "snippet": "static dnsmasqCapsPtr\ndnsmasqCapsNewEmpty(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps;\n\n    if (dnsmasqCapsInitialize() < 0)\n        return NULL;\n    if (!(caps = virObjectNew(dnsmasqCapsClass)))\n        return NULL;\n    if (!(caps->flags = virBitmapNew(DNSMASQ_CAPS_LAST)))\n        goto error;\n    caps->binaryPath = g_strdup(binaryPath ? binaryPath : DNSMASQ);\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr dnsmasqCapsClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virClassPtr dnsmasqCapsClass;\n\nstatic dnsmasqCapsPtr\ndnsmasqCapsNewEmpty(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps;\n\n    if (dnsmasqCapsInitialize() < 0)\n        return NULL;\n    if (!(caps = virObjectNew(dnsmasqCapsClass)))\n        return NULL;\n    if (!(caps->flags = virBitmapNew(DNSMASQ_CAPS_LAST)))\n        goto error;\n    caps->binaryPath = g_strdup(binaryPath ? binaryPath : DNSMASQ);\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\ndnsmasqCapsPtr\ndnsmasqCapsNewFromBinary(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps = dnsmasqCapsNewEmpty(binaryPath);\n\n    if (!caps)\n        return NULL;\n\n    if (dnsmasqCapsRefreshInternal(caps, true) < 0) {\n        virObjectUnref(caps);\n        return NULL;\n    }\n    return caps;\n}"
  },
  {
    "function_name": "dnsmasqCapsNewFromFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "798-811",
    "snippet": "dnsmasqCapsPtr\ndnsmasqCapsNewFromFile(const char *dataPath, const char *binaryPath)\n{\n    dnsmasqCapsPtr caps = dnsmasqCapsNewEmpty(binaryPath);\n\n    if (!caps)\n        return NULL;\n\n    if (dnsmasqCapsSetFromFile(caps, dataPath) < 0) {\n        virObjectUnref(caps);\n        return NULL;\n    }\n    return caps;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsSetFromFile",
          "args": [
            "caps",
            "dataPath"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsSetFromFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "691-705",
          "snippet": "static int\ndnsmasqCapsSetFromFile(dnsmasqCapsPtr caps, const char *path)\n{\n    int ret = -1;\n    char *buf = NULL;\n\n    if (virFileReadAll(path, 1024 * 1024, &buf) < 0)\n        goto cleanup;\n\n    ret = dnsmasqCapsSetFromBuffer(caps, buf);\n\n cleanup:\n    VIR_FREE(buf);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\ndnsmasqCapsSetFromFile(dnsmasqCapsPtr caps, const char *path)\n{\n    int ret = -1;\n    char *buf = NULL;\n\n    if (virFileReadAll(path, 1024 * 1024, &buf) < 0)\n        goto cleanup;\n\n    ret = dnsmasqCapsSetFromBuffer(caps, buf);\n\n cleanup:\n    VIR_FREE(buf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsNewEmpty",
          "args": [
            "binaryPath"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsNewEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "764-781",
          "snippet": "static dnsmasqCapsPtr\ndnsmasqCapsNewEmpty(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps;\n\n    if (dnsmasqCapsInitialize() < 0)\n        return NULL;\n    if (!(caps = virObjectNew(dnsmasqCapsClass)))\n        return NULL;\n    if (!(caps->flags = virBitmapNew(DNSMASQ_CAPS_LAST)))\n        goto error;\n    caps->binaryPath = g_strdup(binaryPath ? binaryPath : DNSMASQ);\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr dnsmasqCapsClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virClassPtr dnsmasqCapsClass;\n\nstatic dnsmasqCapsPtr\ndnsmasqCapsNewEmpty(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps;\n\n    if (dnsmasqCapsInitialize() < 0)\n        return NULL;\n    if (!(caps = virObjectNew(dnsmasqCapsClass)))\n        return NULL;\n    if (!(caps->flags = virBitmapNew(DNSMASQ_CAPS_LAST)))\n        goto error;\n    caps->binaryPath = g_strdup(binaryPath ? binaryPath : DNSMASQ);\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\ndnsmasqCapsPtr\ndnsmasqCapsNewFromFile(const char *dataPath, const char *binaryPath)\n{\n    dnsmasqCapsPtr caps = dnsmasqCapsNewEmpty(binaryPath);\n\n    if (!caps)\n        return NULL;\n\n    if (dnsmasqCapsSetFromFile(caps, dataPath) < 0) {\n        virObjectUnref(caps);\n        return NULL;\n    }\n    return caps;\n}"
  },
  {
    "function_name": "dnsmasqCapsNewFromBuffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "783-796",
    "snippet": "dnsmasqCapsPtr\ndnsmasqCapsNewFromBuffer(const char *buf, const char *binaryPath)\n{\n    dnsmasqCapsPtr caps = dnsmasqCapsNewEmpty(binaryPath);\n\n    if (!caps)\n        return NULL;\n\n    if (dnsmasqCapsSetFromBuffer(caps, buf) < 0) {\n        virObjectUnref(caps);\n        return NULL;\n    }\n    return caps;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsSetFromBuffer",
          "args": [
            "caps",
            "buf"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsSetFromBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "640-689",
          "snippet": "static int\ndnsmasqCapsSetFromBuffer(dnsmasqCapsPtr caps, const char *buf)\n{\n    int len;\n    const char *p;\n\n    caps->noRefresh = true;\n\n    p = STRSKIP(buf, DNSMASQ_VERSION_STR);\n    if (!p)\n       goto fail;\n    virSkipSpaces(&p);\n    if (virParseVersionString(p, &caps->version, true) < 0)\n        goto fail;\n\n    if (strstr(buf, \"--bind-dynamic\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BIND_DYNAMIC);\n\n    /* if this string is a part of the --version output, dnsmasq\n     * has been patched to use SO_BINDTODEVICE when listening,\n     * so that it will only accept requests that arrived on the\n     * listening interface(s)\n     */\n    if (strstr(buf, \"--bind-interfaces with SO_BINDTODEVICE\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BINDTODEVICE);\n\n    if (strstr(buf, \"--ra-param\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_RA_PARAM);\n\n    VIR_INFO(\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\",\n             (int)caps->version / 1000000,\n             (int)(caps->version % 1000000) / 1000,\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \");\n    return 0;\n\n fail:\n    p = strchr(buf, '\\n');\n    if (!p)\n        len = strlen(buf);\n    else\n        len = p - buf;\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"cannot parse %s version number in '%.*s'\"),\n                   caps->binaryPath, len, buf);\n    return -1;\n\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DNSMASQ_VERSION_STR \"Dnsmasq version \""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define DNSMASQ_VERSION_STR \"Dnsmasq version \"\n\nstatic int\ndnsmasqCapsSetFromBuffer(dnsmasqCapsPtr caps, const char *buf)\n{\n    int len;\n    const char *p;\n\n    caps->noRefresh = true;\n\n    p = STRSKIP(buf, DNSMASQ_VERSION_STR);\n    if (!p)\n       goto fail;\n    virSkipSpaces(&p);\n    if (virParseVersionString(p, &caps->version, true) < 0)\n        goto fail;\n\n    if (strstr(buf, \"--bind-dynamic\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BIND_DYNAMIC);\n\n    /* if this string is a part of the --version output, dnsmasq\n     * has been patched to use SO_BINDTODEVICE when listening,\n     * so that it will only accept requests that arrived on the\n     * listening interface(s)\n     */\n    if (strstr(buf, \"--bind-interfaces with SO_BINDTODEVICE\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BINDTODEVICE);\n\n    if (strstr(buf, \"--ra-param\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_RA_PARAM);\n\n    VIR_INFO(\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\",\n             (int)caps->version / 1000000,\n             (int)(caps->version % 1000000) / 1000,\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \");\n    return 0;\n\n fail:\n    p = strchr(buf, '\\n');\n    if (!p)\n        len = strlen(buf);\n    else\n        len = p - buf;\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"cannot parse %s version number in '%.*s'\"),\n                   caps->binaryPath, len, buf);\n    return -1;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsNewEmpty",
          "args": [
            "binaryPath"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsNewEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "764-781",
          "snippet": "static dnsmasqCapsPtr\ndnsmasqCapsNewEmpty(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps;\n\n    if (dnsmasqCapsInitialize() < 0)\n        return NULL;\n    if (!(caps = virObjectNew(dnsmasqCapsClass)))\n        return NULL;\n    if (!(caps->flags = virBitmapNew(DNSMASQ_CAPS_LAST)))\n        goto error;\n    caps->binaryPath = g_strdup(binaryPath ? binaryPath : DNSMASQ);\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr dnsmasqCapsClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virClassPtr dnsmasqCapsClass;\n\nstatic dnsmasqCapsPtr\ndnsmasqCapsNewEmpty(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps;\n\n    if (dnsmasqCapsInitialize() < 0)\n        return NULL;\n    if (!(caps = virObjectNew(dnsmasqCapsClass)))\n        return NULL;\n    if (!(caps->flags = virBitmapNew(DNSMASQ_CAPS_LAST)))\n        goto error;\n    caps->binaryPath = g_strdup(binaryPath ? binaryPath : DNSMASQ);\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\ndnsmasqCapsPtr\ndnsmasqCapsNewFromBuffer(const char *buf, const char *binaryPath)\n{\n    dnsmasqCapsPtr caps = dnsmasqCapsNewEmpty(binaryPath);\n\n    if (!caps)\n        return NULL;\n\n    if (dnsmasqCapsSetFromBuffer(caps, buf) < 0) {\n        virObjectUnref(caps);\n        return NULL;\n    }\n    return caps;\n}"
  },
  {
    "function_name": "dnsmasqCapsNewEmpty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "764-781",
    "snippet": "static dnsmasqCapsPtr\ndnsmasqCapsNewEmpty(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps;\n\n    if (dnsmasqCapsInitialize() < 0)\n        return NULL;\n    if (!(caps = virObjectNew(dnsmasqCapsClass)))\n        return NULL;\n    if (!(caps->flags = virBitmapNew(DNSMASQ_CAPS_LAST)))\n        goto error;\n    caps->binaryPath = g_strdup(binaryPath ? binaryPath : DNSMASQ);\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr dnsmasqCapsClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "binaryPath ? binaryPath : DNSMASQ"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "DNSMASQ_CAPS_LAST"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectNew",
          "args": [
            "dnsmasqCapsClass"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "236-253",
          "snippet": "void *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsInitialize",
          "args": [],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virClassPtr dnsmasqCapsClass;\n\nstatic dnsmasqCapsPtr\ndnsmasqCapsNewEmpty(const char *binaryPath)\n{\n    dnsmasqCapsPtr caps;\n\n    if (dnsmasqCapsInitialize() < 0)\n        return NULL;\n    if (!(caps = virObjectNew(dnsmasqCapsClass)))\n        return NULL;\n    if (!(caps->flags = virBitmapNew(DNSMASQ_CAPS_LAST)))\n        goto error;\n    caps->binaryPath = g_strdup(binaryPath ? binaryPath : DNSMASQ);\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}"
  },
  {
    "function_name": "dnsmasqCapsRefreshInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "707-762",
    "snippet": "static int\ndnsmasqCapsRefreshInternal(dnsmasqCapsPtr caps, bool force)\n{\n    int ret = -1;\n    struct stat sb;\n    virCommandPtr cmd = NULL;\n    char *help = NULL, *version = NULL, *complete = NULL;\n\n    if (!caps || caps->noRefresh)\n        return 0;\n\n    if (stat(caps->binaryPath, &sb) < 0) {\n        virReportSystemError(errno, _(\"Cannot check dnsmasq binary %s\"),\n                             caps->binaryPath);\n        return -1;\n    }\n    if (!force && caps->mtime == sb.st_mtime)\n        return 0;\n    caps->mtime = sb.st_mtime;\n\n    /* Make sure the binary we are about to try exec'ing exists.\n     * Technically we could catch the exec() failure, but that's\n     * in a sub-process so it's hard to feed back a useful error.\n     */\n    if (!virFileIsExecutable(caps->binaryPath)) {\n        virReportSystemError(errno, _(\"dnsmasq binary %s is not executable\"),\n                             caps->binaryPath);\n        goto cleanup;\n    }\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--version\", NULL);\n    virCommandSetOutputBuffer(cmd, &version);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n    virCommandFree(cmd);\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--help\", NULL);\n    virCommandSetOutputBuffer(cmd, &help);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    complete = g_strdup_printf(\"%s\\n%s\", version, help);\n\n    ret = dnsmasqCapsSetFromBuffer(caps, complete);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n    VIR_FREE(version);\n    VIR_FREE(complete);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "complete"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "version"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "help"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsSetFromBuffer",
          "args": [
            "caps",
            "complete"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsSetFromBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "640-689",
          "snippet": "static int\ndnsmasqCapsSetFromBuffer(dnsmasqCapsPtr caps, const char *buf)\n{\n    int len;\n    const char *p;\n\n    caps->noRefresh = true;\n\n    p = STRSKIP(buf, DNSMASQ_VERSION_STR);\n    if (!p)\n       goto fail;\n    virSkipSpaces(&p);\n    if (virParseVersionString(p, &caps->version, true) < 0)\n        goto fail;\n\n    if (strstr(buf, \"--bind-dynamic\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BIND_DYNAMIC);\n\n    /* if this string is a part of the --version output, dnsmasq\n     * has been patched to use SO_BINDTODEVICE when listening,\n     * so that it will only accept requests that arrived on the\n     * listening interface(s)\n     */\n    if (strstr(buf, \"--bind-interfaces with SO_BINDTODEVICE\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BINDTODEVICE);\n\n    if (strstr(buf, \"--ra-param\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_RA_PARAM);\n\n    VIR_INFO(\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\",\n             (int)caps->version / 1000000,\n             (int)(caps->version % 1000000) / 1000,\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \");\n    return 0;\n\n fail:\n    p = strchr(buf, '\\n');\n    if (!p)\n        len = strlen(buf);\n    else\n        len = p - buf;\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"cannot parse %s version number in '%.*s'\"),\n                   caps->binaryPath, len, buf);\n    return -1;\n\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DNSMASQ_VERSION_STR \"Dnsmasq version \""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define DNSMASQ_VERSION_STR \"Dnsmasq version \"\n\nstatic int\ndnsmasqCapsSetFromBuffer(dnsmasqCapsPtr caps, const char *buf)\n{\n    int len;\n    const char *p;\n\n    caps->noRefresh = true;\n\n    p = STRSKIP(buf, DNSMASQ_VERSION_STR);\n    if (!p)\n       goto fail;\n    virSkipSpaces(&p);\n    if (virParseVersionString(p, &caps->version, true) < 0)\n        goto fail;\n\n    if (strstr(buf, \"--bind-dynamic\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BIND_DYNAMIC);\n\n    /* if this string is a part of the --version output, dnsmasq\n     * has been patched to use SO_BINDTODEVICE when listening,\n     * so that it will only accept requests that arrived on the\n     * listening interface(s)\n     */\n    if (strstr(buf, \"--bind-interfaces with SO_BINDTODEVICE\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BINDTODEVICE);\n\n    if (strstr(buf, \"--ra-param\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_RA_PARAM);\n\n    VIR_INFO(\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\",\n             (int)caps->version / 1000000,\n             (int)(caps->version % 1000000) / 1000,\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \");\n    return 0;\n\n fail:\n    p = strchr(buf, '\\n');\n    if (!p)\n        len = strlen(buf);\n    else\n        len = p - buf;\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"cannot parse %s version number in '%.*s'\"),\n                   caps->binaryPath, len, buf);\n    return -1;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s\\n%s\"",
            "version",
            "help"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandClearCaps",
          "args": [
            "cmd"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandClearCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1179-1186",
          "snippet": "void\nvirCommandClearCaps(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_CLEAR_CAPS;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandClearCaps(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_CLEAR_CAPS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddEnvPassCommon",
          "args": [
            "cmd"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddEnvPassCommon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1454-1474",
          "snippet": "void\nvirCommandAddEnvPassCommon(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (VIR_RESIZE_N(cmd->env, cmd->maxenv, cmd->nenv, 9) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    virCommandAddEnvPair(cmd, \"LC_ALL\", \"C\");\n\n    virCommandAddEnvPass(cmd, \"LD_PRELOAD\");\n    virCommandAddEnvPass(cmd, \"LD_LIBRARY_PATH\");\n    virCommandAddEnvPass(cmd, \"PATH\");\n    virCommandAddEnvPass(cmd, \"HOME\");\n    virCommandAddEnvPass(cmd, \"USER\");\n    virCommandAddEnvPass(cmd, \"LOGNAME\");\n    virCommandAddEnvPass(cmd, \"TMPDIR\");\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddEnvPassCommon(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (VIR_RESIZE_N(cmd->env, cmd->maxenv, cmd->nenv, 9) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    virCommandAddEnvPair(cmd, \"LC_ALL\", \"C\");\n\n    virCommandAddEnvPass(cmd, \"LD_PRELOAD\");\n    virCommandAddEnvPass(cmd, \"LD_LIBRARY_PATH\");\n    virCommandAddEnvPass(cmd, \"PATH\");\n    virCommandAddEnvPass(cmd, \"HOME\");\n    virCommandAddEnvPass(cmd, \"USER\");\n    virCommandAddEnvPass(cmd, \"LOGNAME\");\n    virCommandAddEnvPass(cmd, \"TMPDIR\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "&help"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "caps->binaryPath",
            "\"--help\"",
            "NULL"
          ],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"dnsmasq binary %s is not executable\")",
            "caps->binaryPath"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileIsExecutable",
          "args": [
            "caps->binaryPath"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsExecutable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1886-1899",
          "snippet": "bool\nvirFileIsExecutable(const char *file)\n{\n    struct stat sb;\n\n    /* We would also want to check faccessat if we cared about ACLs,\n     * but we don't.  */\n    if (stat(file, &sb) < 0)\n        return false;\n    if (S_ISREG(sb.st_mode) && (sb.st_mode & 0111) != 0)\n        return true;\n    errno = S_ISDIR(sb.st_mode) ? EISDIR : EACCES;\n    return false;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsExecutable(const char *file)\n{\n    struct stat sb;\n\n    /* We would also want to check faccessat if we cared about ACLs,\n     * but we don't.  */\n    if (stat(file, &sb) < 0)\n        return false;\n    if (S_ISREG(sb.st_mode) && (sb.st_mode & 0111) != 0)\n        return true;\n    errno = S_ISDIR(sb.st_mode) ? EISDIR : EACCES;\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot check dnsmasq binary %s\")",
            "caps->binaryPath"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "caps->binaryPath",
            "&sb"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\ndnsmasqCapsRefreshInternal(dnsmasqCapsPtr caps, bool force)\n{\n    int ret = -1;\n    struct stat sb;\n    virCommandPtr cmd = NULL;\n    char *help = NULL, *version = NULL, *complete = NULL;\n\n    if (!caps || caps->noRefresh)\n        return 0;\n\n    if (stat(caps->binaryPath, &sb) < 0) {\n        virReportSystemError(errno, _(\"Cannot check dnsmasq binary %s\"),\n                             caps->binaryPath);\n        return -1;\n    }\n    if (!force && caps->mtime == sb.st_mtime)\n        return 0;\n    caps->mtime = sb.st_mtime;\n\n    /* Make sure the binary we are about to try exec'ing exists.\n     * Technically we could catch the exec() failure, but that's\n     * in a sub-process so it's hard to feed back a useful error.\n     */\n    if (!virFileIsExecutable(caps->binaryPath)) {\n        virReportSystemError(errno, _(\"dnsmasq binary %s is not executable\"),\n                             caps->binaryPath);\n        goto cleanup;\n    }\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--version\", NULL);\n    virCommandSetOutputBuffer(cmd, &version);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n    virCommandFree(cmd);\n\n    cmd = virCommandNewArgList(caps->binaryPath, \"--help\", NULL);\n    virCommandSetOutputBuffer(cmd, &help);\n    virCommandAddEnvPassCommon(cmd);\n    virCommandClearCaps(cmd);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    complete = g_strdup_printf(\"%s\\n%s\", version, help);\n\n    ret = dnsmasqCapsSetFromBuffer(caps, complete);\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n    VIR_FREE(version);\n    VIR_FREE(complete);\n    return ret;\n}"
  },
  {
    "function_name": "dnsmasqCapsSetFromFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "691-705",
    "snippet": "static int\ndnsmasqCapsSetFromFile(dnsmasqCapsPtr caps, const char *path)\n{\n    int ret = -1;\n    char *buf = NULL;\n\n    if (virFileReadAll(path, 1024 * 1024, &buf) < 0)\n        goto cleanup;\n\n    ret = dnsmasqCapsSetFromBuffer(caps, buf);\n\n cleanup:\n    VIR_FREE(buf);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buf"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsSetFromBuffer",
          "args": [
            "caps",
            "buf"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsSetFromBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "640-689",
          "snippet": "static int\ndnsmasqCapsSetFromBuffer(dnsmasqCapsPtr caps, const char *buf)\n{\n    int len;\n    const char *p;\n\n    caps->noRefresh = true;\n\n    p = STRSKIP(buf, DNSMASQ_VERSION_STR);\n    if (!p)\n       goto fail;\n    virSkipSpaces(&p);\n    if (virParseVersionString(p, &caps->version, true) < 0)\n        goto fail;\n\n    if (strstr(buf, \"--bind-dynamic\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BIND_DYNAMIC);\n\n    /* if this string is a part of the --version output, dnsmasq\n     * has been patched to use SO_BINDTODEVICE when listening,\n     * so that it will only accept requests that arrived on the\n     * listening interface(s)\n     */\n    if (strstr(buf, \"--bind-interfaces with SO_BINDTODEVICE\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BINDTODEVICE);\n\n    if (strstr(buf, \"--ra-param\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_RA_PARAM);\n\n    VIR_INFO(\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\",\n             (int)caps->version / 1000000,\n             (int)(caps->version % 1000000) / 1000,\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \");\n    return 0;\n\n fail:\n    p = strchr(buf, '\\n');\n    if (!p)\n        len = strlen(buf);\n    else\n        len = p - buf;\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"cannot parse %s version number in '%.*s'\"),\n                   caps->binaryPath, len, buf);\n    return -1;\n\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DNSMASQ_VERSION_STR \"Dnsmasq version \""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define DNSMASQ_VERSION_STR \"Dnsmasq version \"\n\nstatic int\ndnsmasqCapsSetFromBuffer(dnsmasqCapsPtr caps, const char *buf)\n{\n    int len;\n    const char *p;\n\n    caps->noRefresh = true;\n\n    p = STRSKIP(buf, DNSMASQ_VERSION_STR);\n    if (!p)\n       goto fail;\n    virSkipSpaces(&p);\n    if (virParseVersionString(p, &caps->version, true) < 0)\n        goto fail;\n\n    if (strstr(buf, \"--bind-dynamic\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BIND_DYNAMIC);\n\n    /* if this string is a part of the --version output, dnsmasq\n     * has been patched to use SO_BINDTODEVICE when listening,\n     * so that it will only accept requests that arrived on the\n     * listening interface(s)\n     */\n    if (strstr(buf, \"--bind-interfaces with SO_BINDTODEVICE\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BINDTODEVICE);\n\n    if (strstr(buf, \"--ra-param\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_RA_PARAM);\n\n    VIR_INFO(\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\",\n             (int)caps->version / 1000000,\n             (int)(caps->version % 1000000) / 1000,\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \");\n    return 0;\n\n fail:\n    p = strchr(buf, '\\n');\n    if (!p)\n        len = strlen(buf);\n    else\n        len = p - buf;\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"cannot parse %s version number in '%.*s'\"),\n                   caps->binaryPath, len, buf);\n    return -1;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "1024 * 1024",
            "&buf"
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\ndnsmasqCapsSetFromFile(dnsmasqCapsPtr caps, const char *path)\n{\n    int ret = -1;\n    char *buf = NULL;\n\n    if (virFileReadAll(path, 1024 * 1024, &buf) < 0)\n        goto cleanup;\n\n    ret = dnsmasqCapsSetFromBuffer(caps, buf);\n\n cleanup:\n    VIR_FREE(buf);\n    return ret;\n}"
  },
  {
    "function_name": "dnsmasqCapsSetFromBuffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "640-689",
    "snippet": "static int\ndnsmasqCapsSetFromBuffer(dnsmasqCapsPtr caps, const char *buf)\n{\n    int len;\n    const char *p;\n\n    caps->noRefresh = true;\n\n    p = STRSKIP(buf, DNSMASQ_VERSION_STR);\n    if (!p)\n       goto fail;\n    virSkipSpaces(&p);\n    if (virParseVersionString(p, &caps->version, true) < 0)\n        goto fail;\n\n    if (strstr(buf, \"--bind-dynamic\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BIND_DYNAMIC);\n\n    /* if this string is a part of the --version output, dnsmasq\n     * has been patched to use SO_BINDTODEVICE when listening,\n     * so that it will only accept requests that arrived on the\n     * listening interface(s)\n     */\n    if (strstr(buf, \"--bind-interfaces with SO_BINDTODEVICE\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BINDTODEVICE);\n\n    if (strstr(buf, \"--ra-param\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_RA_PARAM);\n\n    VIR_INFO(\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\",\n             (int)caps->version / 1000000,\n             (int)(caps->version % 1000000) / 1000,\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \");\n    return 0;\n\n fail:\n    p = strchr(buf, '\\n');\n    if (!p)\n        len = strlen(buf);\n    else\n        len = p - buf;\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"cannot parse %s version number in '%.*s'\"),\n                   caps->binaryPath, len, buf);\n    return -1;\n\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DNSMASQ_VERSION_STR \"Dnsmasq version \""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse %s version number in '%.*s'\")",
            "caps->binaryPath",
            "len",
            "buf"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot parse %s version number in '%.*s'\""
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "buf"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "buf",
            "'\\n'"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\"",
            "(int)caps->version / 1000000",
            "(int)(caps->version % 1000000) / 1000",
            "dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \"",
            "dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \"",
            "dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \""
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsGet",
          "args": [
            "caps",
            "DNSMASQ_CAPS_RA_PARAM"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "860-864",
          "snippet": "bool\ndnsmasqCapsGet(dnsmasqCapsPtr caps, dnsmasqCapsFlags flag)\n{\n    return caps && virBitmapIsBitSet(caps->flags, flag);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nbool\ndnsmasqCapsGet(dnsmasqCapsPtr caps, dnsmasqCapsFlags flag)\n{\n    return caps && virBitmapIsBitSet(caps->flags, flag);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dnsmasqCapsSet",
          "args": [
            "caps",
            "DNSMASQ_CAPS_RA_PARAM"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqCapsSetFromFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "691-705",
          "snippet": "static int\ndnsmasqCapsSetFromFile(dnsmasqCapsPtr caps, const char *path)\n{\n    int ret = -1;\n    char *buf = NULL;\n\n    if (virFileReadAll(path, 1024 * 1024, &buf) < 0)\n        goto cleanup;\n\n    ret = dnsmasqCapsSetFromBuffer(caps, buf);\n\n cleanup:\n    VIR_FREE(buf);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\ndnsmasqCapsSetFromFile(dnsmasqCapsPtr caps, const char *path)\n{\n    int ret = -1;\n    char *buf = NULL;\n\n    if (virFileReadAll(path, 1024 * 1024, &buf) < 0)\n        goto cleanup;\n\n    ret = dnsmasqCapsSetFromBuffer(caps, buf);\n\n cleanup:\n    VIR_FREE(buf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "buf",
            "\"--ra-param\""
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "buf",
            "\"--bind-interfaces with SO_BINDTODEVICE\""
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "buf",
            "\"--bind-dynamic\""
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virParseVersionString",
          "args": [
            "p",
            "&caps->version",
            "true"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "virParseVersionString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "254-282",
          "snippet": "int\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&p"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "buf",
            "DNSMASQ_VERSION_STR"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define DNSMASQ_VERSION_STR \"Dnsmasq version \"\n\nstatic int\ndnsmasqCapsSetFromBuffer(dnsmasqCapsPtr caps, const char *buf)\n{\n    int len;\n    const char *p;\n\n    caps->noRefresh = true;\n\n    p = STRSKIP(buf, DNSMASQ_VERSION_STR);\n    if (!p)\n       goto fail;\n    virSkipSpaces(&p);\n    if (virParseVersionString(p, &caps->version, true) < 0)\n        goto fail;\n\n    if (strstr(buf, \"--bind-dynamic\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BIND_DYNAMIC);\n\n    /* if this string is a part of the --version output, dnsmasq\n     * has been patched to use SO_BINDTODEVICE when listening,\n     * so that it will only accept requests that arrived on the\n     * listening interface(s)\n     */\n    if (strstr(buf, \"--bind-interfaces with SO_BINDTODEVICE\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_BINDTODEVICE);\n\n    if (strstr(buf, \"--ra-param\"))\n        dnsmasqCapsSet(caps, DNSMASQ_CAPS_RA_PARAM);\n\n    VIR_INFO(\"dnsmasq version is %d.%d, --bind-dynamic is %spresent, \"\n             \"SO_BINDTODEVICE is %sin use, --ra-param is %spresent\",\n             (int)caps->version / 1000000,\n             (int)(caps->version % 1000000) / 1000,\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BIND_DYNAMIC) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_BINDTODEVICE) ? \"\" : \"NOT \",\n             dnsmasqCapsGet(caps, DNSMASQ_CAPS_RA_PARAM) ? \"\" : \"NOT \");\n    return 0;\n\n fail:\n    p = strchr(buf, '\\n');\n    if (!p)\n        len = strlen(buf);\n    else\n        len = p - buf;\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"cannot parse %s version number in '%.*s'\"),\n                   caps->binaryPath, len, buf);\n    return -1;\n\n}"
  },
  {
    "function_name": "dnsmasqCapsSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "630-635",
    "snippet": "static void\ndnsmasqCapsSet(dnsmasqCapsPtr caps,\n               dnsmasqCapsFlags flag)\n{\n    ignore_value(virBitmapSetBit(caps->flags, flag));\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(caps->flags, flag)"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "caps->flags",
            "flag"
          ],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\ndnsmasqCapsSet(dnsmasqCapsPtr caps,\n               dnsmasqCapsFlags flag)\n{\n    ignore_value(virBitmapSetBit(caps->flags, flag));\n}"
  },
  {
    "function_name": "dnsmasqCapsOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "620-626",
    "snippet": "static int dnsmasqCapsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(dnsmasqCaps, virClassForObject()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "dnsmasqCaps",
            "virClassForObject()"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObject",
          "args": [],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int dnsmasqCapsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(dnsmasqCaps, virClassForObject()))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "dnsmasqCapsDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "611-618",
    "snippet": "static void\ndnsmasqCapsDispose(void *obj)\n{\n    dnsmasqCapsPtr caps = obj;\n\n    virBitmapFree(caps->flags);\n    VIR_FREE(caps->binaryPath);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "caps->binaryPath"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "caps->flags"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\ndnsmasqCapsDispose(void *obj)\n{\n    dnsmasqCapsPtr caps = obj;\n\n    virBitmapFree(caps->flags);\n    VIR_FREE(caps->binaryPath);\n}"
  },
  {
    "function_name": "dnsmasqReload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "579-593",
    "snippet": "int\ndnsmasqReload(pid_t pid G_GNUC_UNUSED)\n{\n#ifndef WIN32\n    if (kill(pid, SIGHUP) != 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to make dnsmasq (PID: %d)\"\n                               \" reload config files.\"),\n                             pid);\n        return -1;\n    }\n#endif /* WIN32 */\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to make dnsmasq (PID: %d)\"\n                               \" reload config files.\")",
            "pid"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to make dnsmasq (PID: %d)\"\n                               \" reload config files.\""
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "pid",
            "SIGHUP"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\ndnsmasqReload(pid_t pid G_GNUC_UNUSED)\n{\n#ifndef WIN32\n    if (kill(pid, SIGHUP) != 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to make dnsmasq (PID: %d)\"\n                               \" reload config files.\"),\n                             pid);\n        return -1;\n    }\n#endif /* WIN32 */\n\n    return 0;\n}"
  },
  {
    "function_name": "dnsmasqDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "560-571",
    "snippet": "int\ndnsmasqDelete(const dnsmasqContext *ctx)\n{\n    int ret = 0;\n\n    if (ctx->hostsfile)\n        ret = genericFileDelete(ctx->hostsfile->path);\n    if (ctx->addnhostsfile)\n        ret = genericFileDelete(ctx->addnhostsfile->path);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "genericFileDelete",
          "args": [
            "ctx->addnhostsfile->path"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "genericFileDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "256-269",
          "snippet": "static int\ngenericFileDelete(char *path)\n{\n    if (!virFileExists(path))\n        return 0;\n\n    if (unlink(path) < 0) {\n        virReportSystemError(errno, _(\"cannot remove config file '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\ngenericFileDelete(char *path)\n{\n    if (!virFileExists(path))\n        return 0;\n\n    if (unlink(path) < 0) {\n        virReportSystemError(errno, _(\"cannot remove config file '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\ndnsmasqDelete(const dnsmasqContext *ctx)\n{\n    int ret = 0;\n\n    if (ctx->hostsfile)\n        ret = genericFileDelete(ctx->hostsfile->path);\n    if (ctx->addnhostsfile)\n        ret = genericFileDelete(ctx->addnhostsfile->path);\n\n    return ret;\n}"
  },
  {
    "function_name": "dnsmasqSave",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "532-551",
    "snippet": "int\ndnsmasqSave(const dnsmasqContext *ctx)\n{\n    int ret = 0;\n\n    if (virFileMakePath(ctx->config_dir) < 0) {\n        virReportSystemError(errno, _(\"cannot create config directory '%s'\"),\n                             ctx->config_dir);\n        return -1;\n    }\n\n    if (ctx->hostsfile)\n        ret = hostsfileSave(ctx->hostsfile);\n    if (ret == 0) {\n        if (ctx->addnhostsfile)\n            ret = addnhostsSave(ctx->addnhostsfile);\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addnhostsSave",
          "args": [
            "ctx->addnhostsfile"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "addnhostsSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "241-254",
          "snippet": "static int\naddnhostsSave(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    int err = addnhostsWrite(addnhostsfile->path, addnhostsfile->hosts,\n                             addnhostsfile->nhosts);\n\n    if (err < 0) {\n        virReportSystemError(-err, _(\"cannot write config file '%s'\"),\n                             addnhostsfile->path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\naddnhostsSave(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    int err = addnhostsWrite(addnhostsfile->path, addnhostsfile->hosts,\n                             addnhostsfile->nhosts);\n\n    if (err < 0) {\n        virReportSystemError(-err, _(\"cannot write config file '%s'\"),\n                             addnhostsfile->path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hostsfileSave",
          "args": [
            "ctx->hostsfile"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "hostsfileSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "422-435",
          "snippet": "static int\nhostsfileSave(dnsmasqHostsfile *hostsfile)\n{\n    int err = hostsfileWrite(hostsfile->path, hostsfile->hosts,\n                             hostsfile->nhosts);\n\n    if (err < 0) {\n        virReportSystemError(-err, _(\"cannot write config file '%s'\"),\n                             hostsfile->path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nhostsfileSave(dnsmasqHostsfile *hostsfile)\n{\n    int err = hostsfileWrite(hostsfile->path, hostsfile->hosts,\n                             hostsfile->nhosts);\n\n    if (err < 0) {\n        virReportSystemError(-err, _(\"cannot write config file '%s'\"),\n                             hostsfile->path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create config directory '%s'\")",
            "ctx->config_dir"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot create config directory '%s'\""
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "ctx->config_dir"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\ndnsmasqSave(const dnsmasqContext *ctx)\n{\n    int ret = 0;\n\n    if (virFileMakePath(ctx->config_dir) < 0) {\n        virReportSystemError(errno, _(\"cannot create config directory '%s'\"),\n                             ctx->config_dir);\n        return -1;\n    }\n\n    if (ctx->hostsfile)\n        ret = hostsfileSave(ctx->hostsfile);\n    if (ret == 0) {\n        if (ctx->addnhostsfile)\n            ret = addnhostsSave(ctx->addnhostsfile);\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "dnsmasqAddHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "518-524",
    "snippet": "int\ndnsmasqAddHost(dnsmasqContext *ctx,\n               virSocketAddr *ip,\n               const char *name)\n{\n    return addnhostsAdd(ctx->addnhostsfile, ip, name);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addnhostsAdd",
          "args": [
            "ctx->addnhostsfile",
            "ip",
            "name"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "addnhostsAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "88-135",
          "snippet": "static int\naddnhostsAdd(dnsmasqAddnHostsfile *addnhostsfile,\n             virSocketAddr *ip,\n             const char *name)\n{\n    char *ipstr = NULL;\n    int idx = -1;\n    size_t i;\n\n    if (!(ipstr = virSocketAddrFormat(ip)))\n        return -1;\n\n    for (i = 0; i < addnhostsfile->nhosts; i++) {\n        if (STREQ((const char *)addnhostsfile->hosts[i].ip, (const char *)ipstr)) {\n            idx = i;\n            break;\n        }\n    }\n\n    if (idx < 0) {\n        if (VIR_REALLOC_N(addnhostsfile->hosts, addnhostsfile->nhosts + 1) < 0)\n            goto error;\n\n        idx = addnhostsfile->nhosts;\n        if (VIR_ALLOC(addnhostsfile->hosts[idx].hostnames) < 0)\n            goto error;\n\n        addnhostsfile->hosts[idx].ip = g_strdup(ipstr);\n\n        addnhostsfile->hosts[idx].nhostnames = 0;\n        addnhostsfile->nhosts++;\n    }\n\n    if (VIR_REALLOC_N(addnhostsfile->hosts[idx].hostnames, addnhostsfile->hosts[idx].nhostnames + 1) < 0)\n        goto error;\n\n    addnhostsfile->hosts[idx].hostnames[addnhostsfile->hosts[idx].nhostnames] = g_strdup(name);\n\n    VIR_FREE(ipstr);\n\n    addnhostsfile->hosts[idx].nhostnames++;\n\n    return 0;\n\n error:\n    VIR_FREE(ipstr);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\naddnhostsAdd(dnsmasqAddnHostsfile *addnhostsfile,\n             virSocketAddr *ip,\n             const char *name)\n{\n    char *ipstr = NULL;\n    int idx = -1;\n    size_t i;\n\n    if (!(ipstr = virSocketAddrFormat(ip)))\n        return -1;\n\n    for (i = 0; i < addnhostsfile->nhosts; i++) {\n        if (STREQ((const char *)addnhostsfile->hosts[i].ip, (const char *)ipstr)) {\n            idx = i;\n            break;\n        }\n    }\n\n    if (idx < 0) {\n        if (VIR_REALLOC_N(addnhostsfile->hosts, addnhostsfile->nhosts + 1) < 0)\n            goto error;\n\n        idx = addnhostsfile->nhosts;\n        if (VIR_ALLOC(addnhostsfile->hosts[idx].hostnames) < 0)\n            goto error;\n\n        addnhostsfile->hosts[idx].ip = g_strdup(ipstr);\n\n        addnhostsfile->hosts[idx].nhostnames = 0;\n        addnhostsfile->nhosts++;\n    }\n\n    if (VIR_REALLOC_N(addnhostsfile->hosts[idx].hostnames, addnhostsfile->hosts[idx].nhostnames + 1) < 0)\n        goto error;\n\n    addnhostsfile->hosts[idx].hostnames[addnhostsfile->hosts[idx].nhostnames] = g_strdup(name);\n\n    VIR_FREE(ipstr);\n\n    addnhostsfile->hosts[idx].nhostnames++;\n\n    return 0;\n\n error:\n    VIR_FREE(ipstr);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\ndnsmasqAddHost(dnsmasqContext *ctx,\n               virSocketAddr *ip,\n               const char *name)\n{\n    return addnhostsAdd(ctx->addnhostsfile, ip, name);\n}"
  },
  {
    "function_name": "dnsmasqAddDhcpHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "498-507",
    "snippet": "int\ndnsmasqAddDhcpHost(dnsmasqContext *ctx,\n                   const char *mac,\n                   virSocketAddr *ip,\n                   const char *name,\n                   const char *id,\n                   bool ipv6)\n{\n    return hostsfileAdd(ctx->hostsfile, mac, ip, name, id, ipv6);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hostsfileAdd",
          "args": [
            "ctx->hostsfile",
            "mac",
            "ip",
            "name",
            "id",
            "ipv6"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "hostsfileAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "293-339",
          "snippet": "static int\nhostsfileAdd(dnsmasqHostsfile *hostsfile,\n             const char *mac,\n             virSocketAddr *ip,\n             const char *name,\n             const char *id,\n             bool ipv6)\n{\n    char *ipstr = NULL;\n    if (VIR_REALLOC_N(hostsfile->hosts, hostsfile->nhosts + 1) < 0)\n        goto error;\n\n    if (!(ipstr = virSocketAddrFormat(ip)))\n        return -1;\n\n    /* the first test determines if it is a dhcpv6 host */\n    if (ipv6) {\n        if (name && id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"id:%s,%s,[%s]\",\n                                                                       id, name, ipstr);\n        } else if (name && !id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,[%s]\",\n                                                                       name, ipstr);\n        } else if (!name && id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"id:%s,[%s]\",\n                                                                       id, ipstr);\n        }\n    } else if (name && mac) {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s,%s\",\n                                                                   mac, ipstr, name);\n    } else if (name && !mac) {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s\", name,\n                                                                   ipstr);\n    } else {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s\", mac,\n                                                                   ipstr);\n    }\n    VIR_FREE(ipstr);\n\n    hostsfile->nhosts++;\n\n    return 0;\n\n error:\n    VIR_FREE(ipstr);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nhostsfileAdd(dnsmasqHostsfile *hostsfile,\n             const char *mac,\n             virSocketAddr *ip,\n             const char *name,\n             const char *id,\n             bool ipv6)\n{\n    char *ipstr = NULL;\n    if (VIR_REALLOC_N(hostsfile->hosts, hostsfile->nhosts + 1) < 0)\n        goto error;\n\n    if (!(ipstr = virSocketAddrFormat(ip)))\n        return -1;\n\n    /* the first test determines if it is a dhcpv6 host */\n    if (ipv6) {\n        if (name && id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"id:%s,%s,[%s]\",\n                                                                       id, name, ipstr);\n        } else if (name && !id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,[%s]\",\n                                                                       name, ipstr);\n        } else if (!name && id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"id:%s,[%s]\",\n                                                                       id, ipstr);\n        }\n    } else if (name && mac) {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s,%s\",\n                                                                   mac, ipstr, name);\n    } else if (name && !mac) {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s\", name,\n                                                                   ipstr);\n    } else {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s\", mac,\n                                                                   ipstr);\n    }\n    VIR_FREE(ipstr);\n\n    hostsfile->nhosts++;\n\n    return 0;\n\n error:\n    VIR_FREE(ipstr);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\ndnsmasqAddDhcpHost(dnsmasqContext *ctx,\n                   const char *mac,\n                   virSocketAddr *ip,\n                   const char *name,\n                   const char *id,\n                   bool ipv6)\n{\n    return hostsfileAdd(ctx->hostsfile, mac, ip, name, id, ipv6);\n}"
  },
  {
    "function_name": "dnsmasqContextFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "473-487",
    "snippet": "void\ndnsmasqContextFree(dnsmasqContext *ctx)\n{\n    if (!ctx)\n        return;\n\n    VIR_FREE(ctx->config_dir);\n\n    if (ctx->hostsfile)\n        hostsfileFree(ctx->hostsfile);\n    if (ctx->addnhostsfile)\n        addnhostsFree(ctx->addnhostsfile);\n\n    VIR_FREE(ctx);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ctx"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addnhostsFree",
          "args": [
            "ctx->addnhostsfile"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "addnhostsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "69-86",
          "snippet": "static void\naddnhostsFree(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    size_t i;\n\n    if (addnhostsfile->hosts) {\n        for (i = 0; i < addnhostsfile->nhosts; i++)\n            addnhostFree(&addnhostsfile->hosts[i]);\n\n        VIR_FREE(addnhostsfile->hosts);\n\n        addnhostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(addnhostsfile->path);\n\n    VIR_FREE(addnhostsfile);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\naddnhostsFree(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    size_t i;\n\n    if (addnhostsfile->hosts) {\n        for (i = 0; i < addnhostsfile->nhosts; i++)\n            addnhostFree(&addnhostsfile->hosts[i]);\n\n        VIR_FREE(addnhostsfile->hosts);\n\n        addnhostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(addnhostsfile->path);\n\n    VIR_FREE(addnhostsfile);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hostsfileFree",
          "args": [
            "ctx->hostsfile"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "hostsfileFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "271-288",
          "snippet": "static void\nhostsfileFree(dnsmasqHostsfile *hostsfile)\n{\n    size_t i;\n\n    if (hostsfile->hosts) {\n        for (i = 0; i < hostsfile->nhosts; i++)\n            dhcphostFree(&hostsfile->hosts[i]);\n\n        VIR_FREE(hostsfile->hosts);\n\n        hostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(hostsfile->path);\n\n    VIR_FREE(hostsfile);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nhostsfileFree(dnsmasqHostsfile *hostsfile)\n{\n    size_t i;\n\n    if (hostsfile->hosts) {\n        for (i = 0; i < hostsfile->nhosts; i++)\n            dhcphostFree(&hostsfile->hosts[i]);\n\n        VIR_FREE(hostsfile->hosts);\n\n        hostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(hostsfile->path);\n\n    VIR_FREE(hostsfile);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ctx->config_dir"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\ndnsmasqContextFree(dnsmasqContext *ctx)\n{\n    if (!ctx)\n        return;\n\n    VIR_FREE(ctx->config_dir);\n\n    if (ctx->hostsfile)\n        hostsfileFree(ctx->hostsfile);\n    if (ctx->addnhostsfile)\n        addnhostsFree(ctx->addnhostsfile);\n\n    VIR_FREE(ctx);\n}"
  },
  {
    "function_name": "dnsmasqContextNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "444-465",
    "snippet": "dnsmasqContext *\ndnsmasqContextNew(const char *network_name,\n                  const char *config_dir)\n{\n    dnsmasqContext *ctx;\n\n    if (VIR_ALLOC(ctx) < 0)\n        return NULL;\n\n    ctx->config_dir = g_strdup(config_dir);\n\n    if (!(ctx->hostsfile = hostsfileNew(network_name, config_dir)))\n        goto error;\n    if (!(ctx->addnhostsfile = addnhostsNew(network_name, config_dir)))\n        goto error;\n\n    return ctx;\n\n error:\n    dnsmasqContextFree(ctx);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dnsmasqContextFree",
          "args": [
            "ctx"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "dnsmasqContextFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "473-487",
          "snippet": "void\ndnsmasqContextFree(dnsmasqContext *ctx)\n{\n    if (!ctx)\n        return;\n\n    VIR_FREE(ctx->config_dir);\n\n    if (ctx->hostsfile)\n        hostsfileFree(ctx->hostsfile);\n    if (ctx->addnhostsfile)\n        addnhostsFree(ctx->addnhostsfile);\n\n    VIR_FREE(ctx);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\ndnsmasqContextFree(dnsmasqContext *ctx)\n{\n    if (!ctx)\n        return;\n\n    VIR_FREE(ctx->config_dir);\n\n    if (ctx->hostsfile)\n        hostsfileFree(ctx->hostsfile);\n    if (ctx->addnhostsfile)\n        addnhostsFree(ctx->addnhostsfile);\n\n    VIR_FREE(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "addnhostsNew",
          "args": [
            "network_name",
            "config_dir"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "addnhostsNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "137-163",
          "snippet": "static dnsmasqAddnHostsfile *\naddnhostsNew(const char *name,\n             const char *config_dir)\n{\n    dnsmasqAddnHostsfile *addnhostsfile;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (VIR_ALLOC(addnhostsfile) < 0)\n        return NULL;\n\n    addnhostsfile->hosts = NULL;\n    addnhostsfile->nhosts = 0;\n\n    virBufferAsprintf(&buf, \"%s\", config_dir);\n    virBufferEscapeString(&buf, \"/%s\", name);\n    virBufferAsprintf(&buf, \".%s\", DNSMASQ_ADDNHOSTSFILE_SUFFIX);\n\n    if (!(addnhostsfile->path = virBufferContentAndReset(&buf)))\n        goto error;\n\n    return addnhostsfile;\n\n error:\n    virBufferFreeAndReset(&buf);\n    addnhostsFree(addnhostsfile);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DNSMASQ_ADDNHOSTSFILE_SUFFIX \"addnhosts\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define DNSMASQ_ADDNHOSTSFILE_SUFFIX \"addnhosts\"\n\nstatic dnsmasqAddnHostsfile *\naddnhostsNew(const char *name,\n             const char *config_dir)\n{\n    dnsmasqAddnHostsfile *addnhostsfile;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (VIR_ALLOC(addnhostsfile) < 0)\n        return NULL;\n\n    addnhostsfile->hosts = NULL;\n    addnhostsfile->nhosts = 0;\n\n    virBufferAsprintf(&buf, \"%s\", config_dir);\n    virBufferEscapeString(&buf, \"/%s\", name);\n    virBufferAsprintf(&buf, \".%s\", DNSMASQ_ADDNHOSTSFILE_SUFFIX);\n\n    if (!(addnhostsfile->path = virBufferContentAndReset(&buf)))\n        goto error;\n\n    return addnhostsfile;\n\n error:\n    virBufferFreeAndReset(&buf);\n    addnhostsFree(addnhostsfile);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hostsfileNew",
          "args": [
            "network_name",
            "config_dir"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "hostsfileNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "341-366",
          "snippet": "static dnsmasqHostsfile *\nhostsfileNew(const char *name,\n             const char *config_dir)\n{\n    dnsmasqHostsfile *hostsfile;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (VIR_ALLOC(hostsfile) < 0)\n        return NULL;\n\n    hostsfile->hosts = NULL;\n    hostsfile->nhosts = 0;\n\n    virBufferAsprintf(&buf, \"%s\", config_dir);\n    virBufferEscapeString(&buf, \"/%s\", name);\n    virBufferAsprintf(&buf, \".%s\", DNSMASQ_HOSTSFILE_SUFFIX);\n\n    if (!(hostsfile->path = virBufferContentAndReset(&buf)))\n        goto error;\n    return hostsfile;\n\n error:\n    virBufferFreeAndReset(&buf);\n    hostsfileFree(hostsfile);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DNSMASQ_HOSTSFILE_SUFFIX \"hostsfile\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define DNSMASQ_HOSTSFILE_SUFFIX \"hostsfile\"\n\nstatic dnsmasqHostsfile *\nhostsfileNew(const char *name,\n             const char *config_dir)\n{\n    dnsmasqHostsfile *hostsfile;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (VIR_ALLOC(hostsfile) < 0)\n        return NULL;\n\n    hostsfile->hosts = NULL;\n    hostsfile->nhosts = 0;\n\n    virBufferAsprintf(&buf, \"%s\", config_dir);\n    virBufferEscapeString(&buf, \"/%s\", name);\n    virBufferAsprintf(&buf, \".%s\", DNSMASQ_HOSTSFILE_SUFFIX);\n\n    if (!(hostsfile->path = virBufferContentAndReset(&buf)))\n        goto error;\n    return hostsfile;\n\n error:\n    virBufferFreeAndReset(&buf);\n    hostsfileFree(hostsfile);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "config_dir"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ctx"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\ndnsmasqContext *\ndnsmasqContextNew(const char *network_name,\n                  const char *config_dir)\n{\n    dnsmasqContext *ctx;\n\n    if (VIR_ALLOC(ctx) < 0)\n        return NULL;\n\n    ctx->config_dir = g_strdup(config_dir);\n\n    if (!(ctx->hostsfile = hostsfileNew(network_name, config_dir)))\n        goto error;\n    if (!(ctx->addnhostsfile = addnhostsNew(network_name, config_dir)))\n        goto error;\n\n    return ctx;\n\n error:\n    dnsmasqContextFree(ctx);\n    return NULL;\n}"
  },
  {
    "function_name": "hostsfileSave",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "422-435",
    "snippet": "static int\nhostsfileSave(dnsmasqHostsfile *hostsfile)\n{\n    int err = hostsfileWrite(hostsfile->path, hostsfile->hosts,\n                             hostsfile->nhosts);\n\n    if (err < 0) {\n        virReportSystemError(-err, _(\"cannot write config file '%s'\"),\n                             hostsfile->path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-err",
            "_(\"cannot write config file '%s'\")",
            "hostsfile->path"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot write config file '%s'\""
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hostsfileWrite",
          "args": [
            "hostsfile->path",
            "hostsfile->hosts",
            "hostsfile->nhosts"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "hostsfileWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "368-420",
          "snippet": "static int\nhostsfileWrite(const char *path,\n               dnsmasqDhcpHost *hosts,\n               unsigned int nhosts)\n{\n    char *tmp;\n    FILE *f;\n    bool istmp = true;\n    size_t i;\n    int rc = 0;\n\n    /* even if there are 0 hosts, create a 0 length file, to allow\n     * for runtime addition.\n     */\n\n    tmp = g_strdup_printf(\"%s.new\", path);\n\n    if (!(f = fopen(tmp, \"w\"))) {\n        istmp = false;\n        if (!(f = fopen(path, \"w\"))) {\n            rc = -errno;\n            goto cleanup;\n        }\n    }\n\n    for (i = 0; i < nhosts; i++) {\n        if (fputs(hosts[i].host, f) == EOF || fputc('\\n', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n    }\n\n    if (VIR_FCLOSE(f) == EOF) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    if (istmp && rename(tmp, path) < 0) {\n        rc = -errno;\n        unlink(tmp);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(tmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nhostsfileWrite(const char *path,\n               dnsmasqDhcpHost *hosts,\n               unsigned int nhosts)\n{\n    char *tmp;\n    FILE *f;\n    bool istmp = true;\n    size_t i;\n    int rc = 0;\n\n    /* even if there are 0 hosts, create a 0 length file, to allow\n     * for runtime addition.\n     */\n\n    tmp = g_strdup_printf(\"%s.new\", path);\n\n    if (!(f = fopen(tmp, \"w\"))) {\n        istmp = false;\n        if (!(f = fopen(path, \"w\"))) {\n            rc = -errno;\n            goto cleanup;\n        }\n    }\n\n    for (i = 0; i < nhosts; i++) {\n        if (fputs(hosts[i].host, f) == EOF || fputc('\\n', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n    }\n\n    if (VIR_FCLOSE(f) == EOF) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    if (istmp && rename(tmp, path) < 0) {\n        rc = -errno;\n        unlink(tmp);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(tmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nhostsfileSave(dnsmasqHostsfile *hostsfile)\n{\n    int err = hostsfileWrite(hostsfile->path, hostsfile->hosts,\n                             hostsfile->nhosts);\n\n    if (err < 0) {\n        virReportSystemError(-err, _(\"cannot write config file '%s'\"),\n                             hostsfile->path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "hostsfileWrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "368-420",
    "snippet": "static int\nhostsfileWrite(const char *path,\n               dnsmasqDhcpHost *hosts,\n               unsigned int nhosts)\n{\n    char *tmp;\n    FILE *f;\n    bool istmp = true;\n    size_t i;\n    int rc = 0;\n\n    /* even if there are 0 hosts, create a 0 length file, to allow\n     * for runtime addition.\n     */\n\n    tmp = g_strdup_printf(\"%s.new\", path);\n\n    if (!(f = fopen(tmp, \"w\"))) {\n        istmp = false;\n        if (!(f = fopen(path, \"w\"))) {\n            rc = -errno;\n            goto cleanup;\n        }\n    }\n\n    for (i = 0; i < nhosts; i++) {\n        if (fputs(hosts[i].host, f) == EOF || fputc('\\n', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n    }\n\n    if (VIR_FCLOSE(f) == EOF) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    if (istmp && rename(tmp, path) < 0) {\n        rc = -errno;\n        unlink(tmp);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(tmp);\n\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "tmp"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rename",
          "args": [
            "tmp",
            "path"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FCLOSE",
          "args": [
            "f"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "tmp"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "f"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputc",
          "args": [
            "'\\n'",
            "f"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputs",
          "args": [
            "hosts[i].host",
            "f"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "path",
            "\"w\""
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "tmp",
            "\"w\""
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s.new\"",
            "path"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nhostsfileWrite(const char *path,\n               dnsmasqDhcpHost *hosts,\n               unsigned int nhosts)\n{\n    char *tmp;\n    FILE *f;\n    bool istmp = true;\n    size_t i;\n    int rc = 0;\n\n    /* even if there are 0 hosts, create a 0 length file, to allow\n     * for runtime addition.\n     */\n\n    tmp = g_strdup_printf(\"%s.new\", path);\n\n    if (!(f = fopen(tmp, \"w\"))) {\n        istmp = false;\n        if (!(f = fopen(path, \"w\"))) {\n            rc = -errno;\n            goto cleanup;\n        }\n    }\n\n    for (i = 0; i < nhosts; i++) {\n        if (fputs(hosts[i].host, f) == EOF || fputc('\\n', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n    }\n\n    if (VIR_FCLOSE(f) == EOF) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    if (istmp && rename(tmp, path) < 0) {\n        rc = -errno;\n        unlink(tmp);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(tmp);\n\n    return rc;\n}"
  },
  {
    "function_name": "hostsfileNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "341-366",
    "snippet": "static dnsmasqHostsfile *\nhostsfileNew(const char *name,\n             const char *config_dir)\n{\n    dnsmasqHostsfile *hostsfile;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (VIR_ALLOC(hostsfile) < 0)\n        return NULL;\n\n    hostsfile->hosts = NULL;\n    hostsfile->nhosts = 0;\n\n    virBufferAsprintf(&buf, \"%s\", config_dir);\n    virBufferEscapeString(&buf, \"/%s\", name);\n    virBufferAsprintf(&buf, \".%s\", DNSMASQ_HOSTSFILE_SUFFIX);\n\n    if (!(hostsfile->path = virBufferContentAndReset(&buf)))\n        goto error;\n    return hostsfile;\n\n error:\n    virBufferFreeAndReset(&buf);\n    hostsfileFree(hostsfile);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DNSMASQ_HOSTSFILE_SUFFIX \"hostsfile\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hostsfileFree",
          "args": [
            "hostsfile"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "hostsfileFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "271-288",
          "snippet": "static void\nhostsfileFree(dnsmasqHostsfile *hostsfile)\n{\n    size_t i;\n\n    if (hostsfile->hosts) {\n        for (i = 0; i < hostsfile->nhosts; i++)\n            dhcphostFree(&hostsfile->hosts[i]);\n\n        VIR_FREE(hostsfile->hosts);\n\n        hostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(hostsfile->path);\n\n    VIR_FREE(hostsfile);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nhostsfileFree(dnsmasqHostsfile *hostsfile)\n{\n    size_t i;\n\n    if (hostsfile->hosts) {\n        for (i = 0; i < hostsfile->nhosts; i++)\n            dhcphostFree(&hostsfile->hosts[i]);\n\n        VIR_FREE(hostsfile->hosts);\n\n        hostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(hostsfile->path);\n\n    VIR_FREE(hostsfile);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\".%s\"",
            "DNSMASQ_HOSTSFILE_SUFFIX"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "&buf",
            "\"/%s\"",
            "name"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "hostsfile"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define DNSMASQ_HOSTSFILE_SUFFIX \"hostsfile\"\n\nstatic dnsmasqHostsfile *\nhostsfileNew(const char *name,\n             const char *config_dir)\n{\n    dnsmasqHostsfile *hostsfile;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (VIR_ALLOC(hostsfile) < 0)\n        return NULL;\n\n    hostsfile->hosts = NULL;\n    hostsfile->nhosts = 0;\n\n    virBufferAsprintf(&buf, \"%s\", config_dir);\n    virBufferEscapeString(&buf, \"/%s\", name);\n    virBufferAsprintf(&buf, \".%s\", DNSMASQ_HOSTSFILE_SUFFIX);\n\n    if (!(hostsfile->path = virBufferContentAndReset(&buf)))\n        goto error;\n    return hostsfile;\n\n error:\n    virBufferFreeAndReset(&buf);\n    hostsfileFree(hostsfile);\n    return NULL;\n}"
  },
  {
    "function_name": "hostsfileAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "293-339",
    "snippet": "static int\nhostsfileAdd(dnsmasqHostsfile *hostsfile,\n             const char *mac,\n             virSocketAddr *ip,\n             const char *name,\n             const char *id,\n             bool ipv6)\n{\n    char *ipstr = NULL;\n    if (VIR_REALLOC_N(hostsfile->hosts, hostsfile->nhosts + 1) < 0)\n        goto error;\n\n    if (!(ipstr = virSocketAddrFormat(ip)))\n        return -1;\n\n    /* the first test determines if it is a dhcpv6 host */\n    if (ipv6) {\n        if (name && id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"id:%s,%s,[%s]\",\n                                                                       id, name, ipstr);\n        } else if (name && !id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,[%s]\",\n                                                                       name, ipstr);\n        } else if (!name && id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"id:%s,[%s]\",\n                                                                       id, ipstr);\n        }\n    } else if (name && mac) {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s,%s\",\n                                                                   mac, ipstr, name);\n    } else if (name && !mac) {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s\", name,\n                                                                   ipstr);\n    } else {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s\", mac,\n                                                                   ipstr);\n    }\n    VIR_FREE(ipstr);\n\n    hostsfile->nhosts++;\n\n    return 0;\n\n error:\n    VIR_FREE(ipstr);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ipstr"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ipstr"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s,%s\"",
            "mac",
            "ipstr"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSocketAddrFormat",
          "args": [
            "ip"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "441-445",
          "snippet": "char *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nchar *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "hostsfile->hosts",
            "hostsfile->nhosts + 1"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nhostsfileAdd(dnsmasqHostsfile *hostsfile,\n             const char *mac,\n             virSocketAddr *ip,\n             const char *name,\n             const char *id,\n             bool ipv6)\n{\n    char *ipstr = NULL;\n    if (VIR_REALLOC_N(hostsfile->hosts, hostsfile->nhosts + 1) < 0)\n        goto error;\n\n    if (!(ipstr = virSocketAddrFormat(ip)))\n        return -1;\n\n    /* the first test determines if it is a dhcpv6 host */\n    if (ipv6) {\n        if (name && id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"id:%s,%s,[%s]\",\n                                                                       id, name, ipstr);\n        } else if (name && !id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,[%s]\",\n                                                                       name, ipstr);\n        } else if (!name && id) {\n            hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"id:%s,[%s]\",\n                                                                       id, ipstr);\n        }\n    } else if (name && mac) {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s,%s\",\n                                                                   mac, ipstr, name);\n    } else if (name && !mac) {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s\", name,\n                                                                   ipstr);\n    } else {\n        hostsfile->hosts[hostsfile->nhosts].host = g_strdup_printf(\"%s,%s\", mac,\n                                                                   ipstr);\n    }\n    VIR_FREE(ipstr);\n\n    hostsfile->nhosts++;\n\n    return 0;\n\n error:\n    VIR_FREE(ipstr);\n    return -1;\n}"
  },
  {
    "function_name": "hostsfileFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "271-288",
    "snippet": "static void\nhostsfileFree(dnsmasqHostsfile *hostsfile)\n{\n    size_t i;\n\n    if (hostsfile->hosts) {\n        for (i = 0; i < hostsfile->nhosts; i++)\n            dhcphostFree(&hostsfile->hosts[i]);\n\n        VIR_FREE(hostsfile->hosts);\n\n        hostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(hostsfile->path);\n\n    VIR_FREE(hostsfile);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "hostsfile"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "hostsfile->path"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "hostsfile->hosts"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dhcphostFree",
          "args": [
            "&hostsfile->hosts[i]"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "dhcphostFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "52-56",
          "snippet": "static void\ndhcphostFree(dnsmasqDhcpHost *host)\n{\n    VIR_FREE(host->host);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\ndhcphostFree(dnsmasqDhcpHost *host)\n{\n    VIR_FREE(host->host);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nhostsfileFree(dnsmasqHostsfile *hostsfile)\n{\n    size_t i;\n\n    if (hostsfile->hosts) {\n        for (i = 0; i < hostsfile->nhosts; i++)\n            dhcphostFree(&hostsfile->hosts[i]);\n\n        VIR_FREE(hostsfile->hosts);\n\n        hostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(hostsfile->path);\n\n    VIR_FREE(hostsfile);\n}"
  },
  {
    "function_name": "genericFileDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "256-269",
    "snippet": "static int\ngenericFileDelete(char *path)\n{\n    if (!virFileExists(path))\n        return 0;\n\n    if (unlink(path) < 0) {\n        virReportSystemError(errno, _(\"cannot remove config file '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot remove config file '%s'\")",
            "path"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot remove config file '%s'\""
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "path"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\ngenericFileDelete(char *path)\n{\n    if (!virFileExists(path))\n        return 0;\n\n    if (unlink(path) < 0) {\n        virReportSystemError(errno, _(\"cannot remove config file '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "addnhostsSave",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "241-254",
    "snippet": "static int\naddnhostsSave(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    int err = addnhostsWrite(addnhostsfile->path, addnhostsfile->hosts,\n                             addnhostsfile->nhosts);\n\n    if (err < 0) {\n        virReportSystemError(-err, _(\"cannot write config file '%s'\"),\n                             addnhostsfile->path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-err",
            "_(\"cannot write config file '%s'\")",
            "addnhostsfile->path"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot write config file '%s'\""
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "addnhostsWrite",
          "args": [
            "addnhostsfile->path",
            "addnhostsfile->hosts",
            "addnhostsfile->nhosts"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "addnhostsWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "165-239",
          "snippet": "static int\naddnhostsWrite(const char *path,\n               dnsmasqAddnHost *hosts,\n               unsigned int nhosts)\n{\n    char *tmp;\n    FILE *f;\n    bool istmp = true;\n    size_t i, j;\n    int rc = 0;\n\n    /* even if there are 0 hosts, create a 0 length file, to allow\n     * for runtime addition.\n     */\n\n    tmp = g_strdup_printf(\"%s.new\", path);\n\n    if (!(f = fopen(tmp, \"w\"))) {\n        istmp = false;\n        if (!(f = fopen(path, \"w\"))) {\n            rc = -errno;\n            goto cleanup;\n        }\n    }\n\n    for (i = 0; i < nhosts; i++) {\n        if (fputs(hosts[i].ip, f) == EOF || fputc('\\t', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n\n        for (j = 0; j < hosts[i].nhostnames; j++) {\n            if (fputs(hosts[i].hostnames[j], f) == EOF || fputc('\\t', f) == EOF) {\n                rc = -errno;\n                VIR_FORCE_FCLOSE(f);\n\n                if (istmp)\n                    unlink(tmp);\n\n                goto cleanup;\n            }\n        }\n\n        if (fputc('\\n', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n    }\n\n    if (VIR_FCLOSE(f) == EOF) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    if (istmp && rename(tmp, path) < 0) {\n        rc = -errno;\n        unlink(tmp);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(tmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\naddnhostsWrite(const char *path,\n               dnsmasqAddnHost *hosts,\n               unsigned int nhosts)\n{\n    char *tmp;\n    FILE *f;\n    bool istmp = true;\n    size_t i, j;\n    int rc = 0;\n\n    /* even if there are 0 hosts, create a 0 length file, to allow\n     * for runtime addition.\n     */\n\n    tmp = g_strdup_printf(\"%s.new\", path);\n\n    if (!(f = fopen(tmp, \"w\"))) {\n        istmp = false;\n        if (!(f = fopen(path, \"w\"))) {\n            rc = -errno;\n            goto cleanup;\n        }\n    }\n\n    for (i = 0; i < nhosts; i++) {\n        if (fputs(hosts[i].ip, f) == EOF || fputc('\\t', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n\n        for (j = 0; j < hosts[i].nhostnames; j++) {\n            if (fputs(hosts[i].hostnames[j], f) == EOF || fputc('\\t', f) == EOF) {\n                rc = -errno;\n                VIR_FORCE_FCLOSE(f);\n\n                if (istmp)\n                    unlink(tmp);\n\n                goto cleanup;\n            }\n        }\n\n        if (fputc('\\n', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n    }\n\n    if (VIR_FCLOSE(f) == EOF) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    if (istmp && rename(tmp, path) < 0) {\n        rc = -errno;\n        unlink(tmp);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(tmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\naddnhostsSave(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    int err = addnhostsWrite(addnhostsfile->path, addnhostsfile->hosts,\n                             addnhostsfile->nhosts);\n\n    if (err < 0) {\n        virReportSystemError(-err, _(\"cannot write config file '%s'\"),\n                             addnhostsfile->path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "addnhostsWrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "165-239",
    "snippet": "static int\naddnhostsWrite(const char *path,\n               dnsmasqAddnHost *hosts,\n               unsigned int nhosts)\n{\n    char *tmp;\n    FILE *f;\n    bool istmp = true;\n    size_t i, j;\n    int rc = 0;\n\n    /* even if there are 0 hosts, create a 0 length file, to allow\n     * for runtime addition.\n     */\n\n    tmp = g_strdup_printf(\"%s.new\", path);\n\n    if (!(f = fopen(tmp, \"w\"))) {\n        istmp = false;\n        if (!(f = fopen(path, \"w\"))) {\n            rc = -errno;\n            goto cleanup;\n        }\n    }\n\n    for (i = 0; i < nhosts; i++) {\n        if (fputs(hosts[i].ip, f) == EOF || fputc('\\t', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n\n        for (j = 0; j < hosts[i].nhostnames; j++) {\n            if (fputs(hosts[i].hostnames[j], f) == EOF || fputc('\\t', f) == EOF) {\n                rc = -errno;\n                VIR_FORCE_FCLOSE(f);\n\n                if (istmp)\n                    unlink(tmp);\n\n                goto cleanup;\n            }\n        }\n\n        if (fputc('\\n', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n    }\n\n    if (VIR_FCLOSE(f) == EOF) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    if (istmp && rename(tmp, path) < 0) {\n        rc = -errno;\n        unlink(tmp);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(tmp);\n\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "tmp"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rename",
          "args": [
            "tmp",
            "path"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FCLOSE",
          "args": [
            "f"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "tmp"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "f"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputc",
          "args": [
            "'\\n'",
            "f"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "tmp"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "f"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputc",
          "args": [
            "'\\t'",
            "f"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputs",
          "args": [
            "hosts[i].hostnames[j]",
            "f"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "tmp"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "f"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputc",
          "args": [
            "'\\t'",
            "f"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputs",
          "args": [
            "hosts[i].ip",
            "f"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "path",
            "\"w\""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "tmp",
            "\"w\""
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s.new\"",
            "path"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\naddnhostsWrite(const char *path,\n               dnsmasqAddnHost *hosts,\n               unsigned int nhosts)\n{\n    char *tmp;\n    FILE *f;\n    bool istmp = true;\n    size_t i, j;\n    int rc = 0;\n\n    /* even if there are 0 hosts, create a 0 length file, to allow\n     * for runtime addition.\n     */\n\n    tmp = g_strdup_printf(\"%s.new\", path);\n\n    if (!(f = fopen(tmp, \"w\"))) {\n        istmp = false;\n        if (!(f = fopen(path, \"w\"))) {\n            rc = -errno;\n            goto cleanup;\n        }\n    }\n\n    for (i = 0; i < nhosts; i++) {\n        if (fputs(hosts[i].ip, f) == EOF || fputc('\\t', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n\n        for (j = 0; j < hosts[i].nhostnames; j++) {\n            if (fputs(hosts[i].hostnames[j], f) == EOF || fputc('\\t', f) == EOF) {\n                rc = -errno;\n                VIR_FORCE_FCLOSE(f);\n\n                if (istmp)\n                    unlink(tmp);\n\n                goto cleanup;\n            }\n        }\n\n        if (fputc('\\n', f) == EOF) {\n            rc = -errno;\n            VIR_FORCE_FCLOSE(f);\n\n            if (istmp)\n                unlink(tmp);\n\n            goto cleanup;\n        }\n    }\n\n    if (VIR_FCLOSE(f) == EOF) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    if (istmp && rename(tmp, path) < 0) {\n        rc = -errno;\n        unlink(tmp);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(tmp);\n\n    return rc;\n}"
  },
  {
    "function_name": "addnhostsNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "137-163",
    "snippet": "static dnsmasqAddnHostsfile *\naddnhostsNew(const char *name,\n             const char *config_dir)\n{\n    dnsmasqAddnHostsfile *addnhostsfile;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (VIR_ALLOC(addnhostsfile) < 0)\n        return NULL;\n\n    addnhostsfile->hosts = NULL;\n    addnhostsfile->nhosts = 0;\n\n    virBufferAsprintf(&buf, \"%s\", config_dir);\n    virBufferEscapeString(&buf, \"/%s\", name);\n    virBufferAsprintf(&buf, \".%s\", DNSMASQ_ADDNHOSTSFILE_SUFFIX);\n\n    if (!(addnhostsfile->path = virBufferContentAndReset(&buf)))\n        goto error;\n\n    return addnhostsfile;\n\n error:\n    virBufferFreeAndReset(&buf);\n    addnhostsFree(addnhostsfile);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DNSMASQ_ADDNHOSTSFILE_SUFFIX \"addnhosts\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addnhostsFree",
          "args": [
            "addnhostsfile"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "addnhostsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "69-86",
          "snippet": "static void\naddnhostsFree(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    size_t i;\n\n    if (addnhostsfile->hosts) {\n        for (i = 0; i < addnhostsfile->nhosts; i++)\n            addnhostFree(&addnhostsfile->hosts[i]);\n\n        VIR_FREE(addnhostsfile->hosts);\n\n        addnhostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(addnhostsfile->path);\n\n    VIR_FREE(addnhostsfile);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\naddnhostsFree(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    size_t i;\n\n    if (addnhostsfile->hosts) {\n        for (i = 0; i < addnhostsfile->nhosts; i++)\n            addnhostFree(&addnhostsfile->hosts[i]);\n\n        VIR_FREE(addnhostsfile->hosts);\n\n        addnhostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(addnhostsfile->path);\n\n    VIR_FREE(addnhostsfile);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\".%s\"",
            "DNSMASQ_ADDNHOSTSFILE_SUFFIX"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "&buf",
            "\"/%s\"",
            "name"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "addnhostsfile"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define DNSMASQ_ADDNHOSTSFILE_SUFFIX \"addnhosts\"\n\nstatic dnsmasqAddnHostsfile *\naddnhostsNew(const char *name,\n             const char *config_dir)\n{\n    dnsmasqAddnHostsfile *addnhostsfile;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (VIR_ALLOC(addnhostsfile) < 0)\n        return NULL;\n\n    addnhostsfile->hosts = NULL;\n    addnhostsfile->nhosts = 0;\n\n    virBufferAsprintf(&buf, \"%s\", config_dir);\n    virBufferEscapeString(&buf, \"/%s\", name);\n    virBufferAsprintf(&buf, \".%s\", DNSMASQ_ADDNHOSTSFILE_SUFFIX);\n\n    if (!(addnhostsfile->path = virBufferContentAndReset(&buf)))\n        goto error;\n\n    return addnhostsfile;\n\n error:\n    virBufferFreeAndReset(&buf);\n    addnhostsFree(addnhostsfile);\n    return NULL;\n}"
  },
  {
    "function_name": "addnhostsAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "88-135",
    "snippet": "static int\naddnhostsAdd(dnsmasqAddnHostsfile *addnhostsfile,\n             virSocketAddr *ip,\n             const char *name)\n{\n    char *ipstr = NULL;\n    int idx = -1;\n    size_t i;\n\n    if (!(ipstr = virSocketAddrFormat(ip)))\n        return -1;\n\n    for (i = 0; i < addnhostsfile->nhosts; i++) {\n        if (STREQ((const char *)addnhostsfile->hosts[i].ip, (const char *)ipstr)) {\n            idx = i;\n            break;\n        }\n    }\n\n    if (idx < 0) {\n        if (VIR_REALLOC_N(addnhostsfile->hosts, addnhostsfile->nhosts + 1) < 0)\n            goto error;\n\n        idx = addnhostsfile->nhosts;\n        if (VIR_ALLOC(addnhostsfile->hosts[idx].hostnames) < 0)\n            goto error;\n\n        addnhostsfile->hosts[idx].ip = g_strdup(ipstr);\n\n        addnhostsfile->hosts[idx].nhostnames = 0;\n        addnhostsfile->nhosts++;\n    }\n\n    if (VIR_REALLOC_N(addnhostsfile->hosts[idx].hostnames, addnhostsfile->hosts[idx].nhostnames + 1) < 0)\n        goto error;\n\n    addnhostsfile->hosts[idx].hostnames[addnhostsfile->hosts[idx].nhostnames] = g_strdup(name);\n\n    VIR_FREE(ipstr);\n\n    addnhostsfile->hosts[idx].nhostnames++;\n\n    return 0;\n\n error:\n    VIR_FREE(ipstr);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ipstr"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ipstr"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "addnhostsfile->hosts[idx].hostnames",
            "addnhostsfile->hosts[idx].nhostnames + 1"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "addnhostsfile->hosts[idx].hostnames"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "addnhostsfile->hosts",
            "addnhostsfile->nhosts + 1"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "(const char *)addnhostsfile->hosts[i].ip",
            "(const char *)ipstr"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketAddrFormat",
          "args": [
            "ip"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "441-445",
          "snippet": "char *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nchar *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\naddnhostsAdd(dnsmasqAddnHostsfile *addnhostsfile,\n             virSocketAddr *ip,\n             const char *name)\n{\n    char *ipstr = NULL;\n    int idx = -1;\n    size_t i;\n\n    if (!(ipstr = virSocketAddrFormat(ip)))\n        return -1;\n\n    for (i = 0; i < addnhostsfile->nhosts; i++) {\n        if (STREQ((const char *)addnhostsfile->hosts[i].ip, (const char *)ipstr)) {\n            idx = i;\n            break;\n        }\n    }\n\n    if (idx < 0) {\n        if (VIR_REALLOC_N(addnhostsfile->hosts, addnhostsfile->nhosts + 1) < 0)\n            goto error;\n\n        idx = addnhostsfile->nhosts;\n        if (VIR_ALLOC(addnhostsfile->hosts[idx].hostnames) < 0)\n            goto error;\n\n        addnhostsfile->hosts[idx].ip = g_strdup(ipstr);\n\n        addnhostsfile->hosts[idx].nhostnames = 0;\n        addnhostsfile->nhosts++;\n    }\n\n    if (VIR_REALLOC_N(addnhostsfile->hosts[idx].hostnames, addnhostsfile->hosts[idx].nhostnames + 1) < 0)\n        goto error;\n\n    addnhostsfile->hosts[idx].hostnames[addnhostsfile->hosts[idx].nhostnames] = g_strdup(name);\n\n    VIR_FREE(ipstr);\n\n    addnhostsfile->hosts[idx].nhostnames++;\n\n    return 0;\n\n error:\n    VIR_FREE(ipstr);\n    return -1;\n}"
  },
  {
    "function_name": "addnhostsFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "69-86",
    "snippet": "static void\naddnhostsFree(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    size_t i;\n\n    if (addnhostsfile->hosts) {\n        for (i = 0; i < addnhostsfile->nhosts; i++)\n            addnhostFree(&addnhostsfile->hosts[i]);\n\n        VIR_FREE(addnhostsfile->hosts);\n\n        addnhostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(addnhostsfile->path);\n\n    VIR_FREE(addnhostsfile);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "addnhostsfile"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "addnhostsfile->path"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "addnhostsfile->hosts"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addnhostFree",
          "args": [
            "&addnhostsfile->hosts[i]"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "addnhostFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
          "lines": "58-67",
          "snippet": "static void\naddnhostFree(dnsmasqAddnHost *host)\n{\n    size_t i;\n\n    for (i = 0; i < host->nhostnames; i++)\n        VIR_FREE(host->hostnames[i]);\n    VIR_FREE(host->hostnames);\n    VIR_FREE(host->ip);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virutil.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virbitmap.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <signal.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\naddnhostFree(dnsmasqAddnHost *host)\n{\n    size_t i;\n\n    for (i = 0; i < host->nhostnames; i++)\n        VIR_FREE(host->hostnames[i]);\n    VIR_FREE(host->hostnames);\n    VIR_FREE(host->ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\naddnhostsFree(dnsmasqAddnHostsfile *addnhostsfile)\n{\n    size_t i;\n\n    if (addnhostsfile->hosts) {\n        for (i = 0; i < addnhostsfile->nhosts; i++)\n            addnhostFree(&addnhostsfile->hosts[i]);\n\n        VIR_FREE(addnhostsfile->hosts);\n\n        addnhostsfile->nhosts = 0;\n    }\n\n    VIR_FREE(addnhostsfile->path);\n\n    VIR_FREE(addnhostsfile);\n}"
  },
  {
    "function_name": "addnhostFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "58-67",
    "snippet": "static void\naddnhostFree(dnsmasqAddnHost *host)\n{\n    size_t i;\n\n    for (i = 0; i < host->nhostnames; i++)\n        VIR_FREE(host->hostnames[i]);\n    VIR_FREE(host->hostnames);\n    VIR_FREE(host->ip);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "host->ip"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "host->hostnames"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "host->hostnames[i]"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\naddnhostFree(dnsmasqAddnHost *host)\n{\n    size_t i;\n\n    for (i = 0; i < host->nhostnames; i++)\n        VIR_FREE(host->hostnames[i]);\n    VIR_FREE(host->hostnames);\n    VIR_FREE(host->ip);\n}"
  },
  {
    "function_name": "dhcphostFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdnsmasq.c",
    "lines": "52-56",
    "snippet": "static void\ndhcphostFree(dnsmasqDhcpHost *host)\n{\n    VIR_FREE(host->host);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"vircommand.h\"",
      "#include \"virutil.h\"",
      "#include \"virdnsmasq.h\"",
      "#include \"virbitmap.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <signal.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "host->host"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virutil.h\"\n#include \"virdnsmasq.h\"\n#include \"virbitmap.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <signal.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\ndhcphostFree(dnsmasqDhcpHost *host)\n{\n    VIR_FREE(host->host);\n}"
  }
]