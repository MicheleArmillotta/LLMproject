[
  {
    "function_name": "virNetDevBridgeFDBDel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "1117-1122",
    "snippet": "int\nvirNetDevBridgeFDBDel(const virMacAddr *mac, const char *ifname,\n                      unsigned int flags)\n{\n    return virNetDevBridgeFDBAddDel(mac, ifname, flags, false);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeFDBAddDel",
          "args": [
            "mac",
            "ifname",
            "flags",
            "false"
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeFDBAddDel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "1095-1104",
          "snippet": "static int\nvirNetDevBridgeFDBAddDel(const virMacAddr *mac G_GNUC_UNUSED,\n                         const char *ifname G_GNUC_UNUSED,\n                         unsigned int fdbFlags G_GNUC_UNUSED,\n                         bool isAdd G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to add/delete fdb entries on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeFDBAddDel(const virMacAddr *mac G_GNUC_UNUSED,\n                         const char *ifname G_GNUC_UNUSED,\n                         unsigned int fdbFlags G_GNUC_UNUSED,\n                         bool isAdd G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to add/delete fdb entries on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeFDBDel(const virMacAddr *mac, const char *ifname,\n                      unsigned int flags)\n{\n    return virNetDevBridgeFDBAddDel(mac, ifname, flags, false);\n}"
  },
  {
    "function_name": "virNetDevBridgeFDBAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "1109-1114",
    "snippet": "int\nvirNetDevBridgeFDBAdd(const virMacAddr *mac, const char *ifname,\n                      unsigned int flags)\n{\n    return virNetDevBridgeFDBAddDel(mac, ifname, flags, true);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeFDBAddDel",
          "args": [
            "mac",
            "ifname",
            "flags",
            "true"
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeFDBAddDel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "1095-1104",
          "snippet": "static int\nvirNetDevBridgeFDBAddDel(const virMacAddr *mac G_GNUC_UNUSED,\n                         const char *ifname G_GNUC_UNUSED,\n                         unsigned int fdbFlags G_GNUC_UNUSED,\n                         bool isAdd G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to add/delete fdb entries on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeFDBAddDel(const virMacAddr *mac G_GNUC_UNUSED,\n                         const char *ifname G_GNUC_UNUSED,\n                         unsigned int fdbFlags G_GNUC_UNUSED,\n                         bool isAdd G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to add/delete fdb entries on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeFDBAdd(const virMacAddr *mac, const char *ifname,\n                      unsigned int flags)\n{\n    return virNetDevBridgeFDBAddDel(mac, ifname, flags, true);\n}"
  },
  {
    "function_name": "virNetDevBridgeFDBAddDel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "1095-1104",
    "snippet": "static int\nvirNetDevBridgeFDBAddDel(const virMacAddr *mac G_GNUC_UNUSED,\n                         const char *ifname G_GNUC_UNUSED,\n                         unsigned int fdbFlags G_GNUC_UNUSED,\n                         bool isAdd G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to add/delete fdb entries on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to add/delete fdb entries on this platform\")"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to add/delete fdb entries on this platform\""
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeFDBAddDel(const virMacAddr *mac G_GNUC_UNUSED,\n                         const char *ifname G_GNUC_UNUSED,\n                         unsigned int fdbFlags G_GNUC_UNUSED,\n                         bool isAdd G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to add/delete fdb entries on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeFDBAddDel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "1006-1091",
    "snippet": "static int\nvirNetDevBridgeFDBAddDel(const virMacAddr *mac, const char *ifname,\n                         unsigned int flags, bool isAdd)\n{\n    struct nlmsgerr *err;\n    unsigned int recvbuflen;\n    struct ndmsg ndm = { .ndm_family = PF_BRIDGE, .ndm_state = NUD_NOARP };\n    g_autoptr(virNetlinkMsg) nl_msg = NULL;\n    g_autofree struct nlmsghdr *resp = NULL;\n\n    if (virNetDevGetIndex(ifname, &ndm.ndm_ifindex) < 0)\n        return -1;\n\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_ROUTER)\n        ndm.ndm_flags |= NTF_ROUTER;\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_SELF)\n        ndm.ndm_flags |= NTF_SELF;\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_MASTER)\n        ndm.ndm_flags |= NTF_MASTER;\n    /* default self (same as iproute2's bridge command */\n    if (!(ndm.ndm_flags & (NTF_MASTER | NTF_SELF)))\n        ndm.ndm_flags |= NTF_SELF;\n\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_PERMANENT)\n        ndm.ndm_state |= NUD_PERMANENT;\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_TEMP)\n        ndm.ndm_state |= NUD_REACHABLE;\n    /* default permanent, same as iproute2's bridge command */\n    if (!(ndm.ndm_state & (NUD_PERMANENT | NUD_REACHABLE)))\n        ndm.ndm_state |= NUD_PERMANENT;\n\n    nl_msg = nlmsg_alloc_simple(isAdd ? RTM_NEWNEIGH : RTM_DELNEIGH,\n                                NLM_F_REQUEST |\n                                (isAdd ? (NLM_F_CREATE | NLM_F_EXCL) : 0));\n    if (!nl_msg) {\n        virReportOOMError();\n        return -1;\n    }\n\n    if (nlmsg_append(nl_msg, &ndm, sizeof(ndm), NLMSG_ALIGNTO) < 0)\n        goto buffer_too_small;\n    if (nla_put(nl_msg, NDA_LLADDR, VIR_MAC_BUFLEN, mac) < 0)\n        goto buffer_too_small;\n\n    /* NB: this message can also accept a Destination IP, a port, a\n     * vlan tag, and a via (see iproute2/bridge/fdb.c:fdb_modify()),\n     * but those aren't required for our application\n     */\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0,\n                          NETLINK_ROUTE, 0) < 0) {\n        return -1;\n    }\n    if (recvbuflen < NLMSG_LENGTH(0) || resp == NULL)\n        goto malformed_resp;\n\n    switch (resp->nlmsg_type) {\n    case NLMSG_ERROR:\n        err = (struct nlmsgerr *)NLMSG_DATA(resp);\n        if (resp->nlmsg_len < NLMSG_LENGTH(sizeof(*err)))\n            goto malformed_resp;\n        if (err->error) {\n            virReportSystemError(-err->error,\n                                 _(\"error adding fdb entry for %s\"), ifname);\n            return -1;\n        }\n        break;\n    case NLMSG_DONE:\n        break;\n\n    default:\n        goto malformed_resp;\n    }\n\n    return 0;\n\n malformed_resp:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"malformed netlink response message\"));\n    return -1;\n\n buffer_too_small:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"allocated netlink buffer is too small\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"allocated netlink buffer is too small\")"
          ],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"allocated netlink buffer is too small\""
          ],
          "line": 1089
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"malformed netlink response message\")"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-err->error",
            "_(\"error adding fdb entry for %s\")",
            "ifname"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_LENGTH",
          "args": [
            "sizeof(*err)"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_DATA",
          "args": [
            "resp"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_LENGTH",
          "args": [
            "0"
          ],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetlinkCommand",
          "args": [
            "nl_msg",
            "&resp",
            "&recvbuflen",
            "0",
            "0",
            "NETLINK_ROUTE",
            "0"
          ],
          "line": 1055
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1236-1246",
          "snippet": "int virNetlinkCommand(struct nl_msg *nl_msg G_GNUC_UNUSED,\n                      struct nlmsghdr **resp G_GNUC_UNUSED,\n                      unsigned int *respbuflen G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED,\n                      unsigned int protocol G_GNUC_UNUSED,\n                      unsigned int groups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetlinkCommand(struct nl_msg *nl_msg G_GNUC_UNUSED,\n                      struct nlmsghdr **resp G_GNUC_UNUSED,\n                      unsigned int *respbuflen G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED,\n                      unsigned int protocol G_GNUC_UNUSED,\n                      unsigned int groups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nl_msg",
            "NDA_LLADDR",
            "VIR_MAC_BUFLEN",
            "mac"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_append",
          "args": [
            "nl_msg",
            "&ndm",
            "sizeof(ndm)",
            "NLMSG_ALIGNTO"
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_alloc_simple",
          "args": [
            "isAdd ? RTM_NEWNEIGH : RTM_DELNEIGH",
            "NLM_F_REQUEST |\n                                (isAdd ? (NLM_F_CREATE | NLM_F_EXCL) : 0)"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevGetIndex",
          "args": [
            "ifname",
            "&ndm.ndm_ifindex"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "893-899",
          "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeFDBAddDel(const virMacAddr *mac, const char *ifname,\n                         unsigned int flags, bool isAdd)\n{\n    struct nlmsgerr *err;\n    unsigned int recvbuflen;\n    struct ndmsg ndm = { .ndm_family = PF_BRIDGE, .ndm_state = NUD_NOARP };\n    g_autoptr(virNetlinkMsg) nl_msg = NULL;\n    g_autofree struct nlmsghdr *resp = NULL;\n\n    if (virNetDevGetIndex(ifname, &ndm.ndm_ifindex) < 0)\n        return -1;\n\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_ROUTER)\n        ndm.ndm_flags |= NTF_ROUTER;\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_SELF)\n        ndm.ndm_flags |= NTF_SELF;\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_MASTER)\n        ndm.ndm_flags |= NTF_MASTER;\n    /* default self (same as iproute2's bridge command */\n    if (!(ndm.ndm_flags & (NTF_MASTER | NTF_SELF)))\n        ndm.ndm_flags |= NTF_SELF;\n\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_PERMANENT)\n        ndm.ndm_state |= NUD_PERMANENT;\n    if (flags & VIR_NETDEVBRIDGE_FDB_FLAG_TEMP)\n        ndm.ndm_state |= NUD_REACHABLE;\n    /* default permanent, same as iproute2's bridge command */\n    if (!(ndm.ndm_state & (NUD_PERMANENT | NUD_REACHABLE)))\n        ndm.ndm_state |= NUD_PERMANENT;\n\n    nl_msg = nlmsg_alloc_simple(isAdd ? RTM_NEWNEIGH : RTM_DELNEIGH,\n                                NLM_F_REQUEST |\n                                (isAdd ? (NLM_F_CREATE | NLM_F_EXCL) : 0));\n    if (!nl_msg) {\n        virReportOOMError();\n        return -1;\n    }\n\n    if (nlmsg_append(nl_msg, &ndm, sizeof(ndm), NLMSG_ALIGNTO) < 0)\n        goto buffer_too_small;\n    if (nla_put(nl_msg, NDA_LLADDR, VIR_MAC_BUFLEN, mac) < 0)\n        goto buffer_too_small;\n\n    /* NB: this message can also accept a Destination IP, a port, a\n     * vlan tag, and a via (see iproute2/bridge/fdb.c:fdb_modify()),\n     * but those aren't required for our application\n     */\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0,\n                          NETLINK_ROUTE, 0) < 0) {\n        return -1;\n    }\n    if (recvbuflen < NLMSG_LENGTH(0) || resp == NULL)\n        goto malformed_resp;\n\n    switch (resp->nlmsg_type) {\n    case NLMSG_ERROR:\n        err = (struct nlmsgerr *)NLMSG_DATA(resp);\n        if (resp->nlmsg_len < NLMSG_LENGTH(sizeof(*err)))\n            goto malformed_resp;\n        if (err->error) {\n            virReportSystemError(-err->error,\n                                 _(\"error adding fdb entry for %s\"), ifname);\n            return -1;\n        }\n        break;\n    case NLMSG_DONE:\n        break;\n\n    default:\n        goto malformed_resp;\n    }\n\n    return 0;\n\n malformed_resp:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"malformed netlink response message\"));\n    return -1;\n\n buffer_too_small:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"allocated netlink buffer is too small\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeSetVlanFiltering",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "966-973",
    "snippet": "int\nvirNetDevBridgeSetVlanFiltering(const char *brname G_GNUC_UNUSED,\n                                bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge vlan_filtering on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to set bridge vlan_filtering on this platform\")"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set bridge vlan_filtering on this platform\""
          ],
          "line": 971
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeSetVlanFiltering(const char *brname G_GNUC_UNUSED,\n                                bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge vlan_filtering on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeGetVlanFiltering",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "956-963",
    "snippet": "int\nvirNetDevBridgeGetVlanFiltering(const char *brname G_GNUC_UNUSED,\n                                bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get bridge vlan_filtering on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get bridge vlan_filtering on this platform\")"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get bridge vlan_filtering on this platform\""
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeGetVlanFiltering(const char *brname G_GNUC_UNUSED,\n                                bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get bridge vlan_filtering on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeSetVlanFiltering",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "947-952",
    "snippet": "int\nvirNetDevBridgeSetVlanFiltering(const char *brname,\n                                bool enable)\n{\n    return virNetDevBridgeSet(brname, \"vlan_filtering\", enable ? 1 : 0, -1, NULL);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeSet",
          "args": [
            "brname",
            "\"vlan_filtering\"",
            "enable ? 1 : 0",
            "-1",
            "NULL"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "115-153",
          "snippet": "static int virNetDevBridgeSet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long value,    /* new value */\n                              int fd,                 /* control socket */\n                              struct ifreq *ifr)      /* pre-filled bridge name */\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = g_strdup_printf(\"%lu\", value);\n        if (virFileWriteStr(path, valuestr, 0) >= 0)\n            return 0;\n        VIR_DEBUG(\"Unable to set bridge %s %s via sysfs\", brname, paramname);\n    }\n\n    unsigned long paramid;\n    if (STREQ(paramname, \"stp_state\")) {\n        paramid = BRCTL_SET_BRIDGE_STP_STATE;\n    } else if (STREQ(paramname, \"forward_delay\")) {\n        paramid = BRCTL_SET_BRIDGE_FORWARD_DELAY;\n    } else {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n    unsigned long args[] = { paramid, value, 0, 0 };\n    ifr->ifr_data = (char*)&args;\n    if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeSet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long value,    /* new value */\n                              int fd,                 /* control socket */\n                              struct ifreq *ifr)      /* pre-filled bridge name */\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = g_strdup_printf(\"%lu\", value);\n        if (virFileWriteStr(path, valuestr, 0) >= 0)\n            return 0;\n        VIR_DEBUG(\"Unable to set bridge %s %s via sysfs\", brname, paramname);\n    }\n\n    unsigned long paramid;\n    if (STREQ(paramname, \"stp_state\")) {\n        paramid = BRCTL_SET_BRIDGE_STP_STATE;\n    } else if (STREQ(paramname, \"forward_delay\")) {\n        paramid = BRCTL_SET_BRIDGE_FORWARD_DELAY;\n    } else {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n    unsigned long args[] = { paramid, value, 0, 0 };\n    ifr->ifr_data = (char*)&args;\n    if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeSetVlanFiltering(const char *brname,\n                                bool enable)\n{\n    return virNetDevBridgeSet(brname, \"vlan_filtering\", enable ? 1 : 0, -1, NULL);\n}"
  },
  {
    "function_name": "virNetDevBridgeGetVlanFiltering",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "923-934",
    "snippet": "int\nvirNetDevBridgeGetVlanFiltering(const char *brname,\n                                bool *enable)\n{\n    unsigned long value;\n\n    if (virNetDevBridgeGet(brname, \"vlan_filtering\", &value) < 0)\n        return -1;\n\n    *enable = !!value;\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeGet",
          "args": [
            "brname",
            "\"vlan_filtering\"",
            "&value"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "156-205",
          "snippet": "static int virNetDevBridgeGet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long *value)   /* current value */\n{\n    struct ifreq ifr;\n    g_autofree char *path = NULL;\n    VIR_AUTOCLOSE fd = -1;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = NULL;\n\n        if (virFileReadAll(path, VIR_INT64_STR_BUFLEN,\n                           &valuestr) < 0)\n            return -1;\n\n        if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"),\n                                 brname, paramname);\n            return -1;\n        }\n    } else {\n        struct __bridge_info info;\n        unsigned long args[] = { BRCTL_GET_BRIDGE_INFO, (unsigned long)&info, 0, 0 };\n\n        if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n            return -1;\n\n        ifr.ifr_data = (char*)&args;\n        if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n\n        if (STREQ(paramname, \"stp_state\")) {\n            *value = info.stp_enabled;\n        } else if (STREQ(paramname, \"forward_delay\")) {\n            *value = info.forward_delay;\n        } else {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeGet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long *value)   /* current value */\n{\n    struct ifreq ifr;\n    g_autofree char *path = NULL;\n    VIR_AUTOCLOSE fd = -1;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = NULL;\n\n        if (virFileReadAll(path, VIR_INT64_STR_BUFLEN,\n                           &valuestr) < 0)\n            return -1;\n\n        if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"),\n                                 brname, paramname);\n            return -1;\n        }\n    } else {\n        struct __bridge_info info;\n        unsigned long args[] = { BRCTL_GET_BRIDGE_INFO, (unsigned long)&info, 0, 0 };\n\n        if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n            return -1;\n\n        ifr.ifr_data = (char*)&args;\n        if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n\n        if (STREQ(paramname, \"stp_state\")) {\n            *value = info.stp_enabled;\n        } else if (STREQ(paramname, \"forward_delay\")) {\n            *value = info.forward_delay;\n        } else {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeGetVlanFiltering(const char *brname,\n                                bool *enable)\n{\n    unsigned long value;\n\n    if (virNetDevBridgeGet(brname, \"vlan_filtering\", &value) < 0)\n        return -1;\n\n    *enable = !!value;\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeGetSTP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "902-909",
    "snippet": "int virNetDevBridgeGetSTP(const char *brname,\n                          bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to get STP on %s on this platform\"),\n                         brname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to get STP on %s on this platform\")",
            "brname"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get STP on %s on this platform\""
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeGetSTP(const char *brname,\n                          bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to get STP on %s on this platform\"),\n                         brname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeSetSTP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "893-901",
    "snippet": "int virNetDevBridgeSetSTP(const char *brname,\n                          bool enable G_GNUC_UNUSED)\n\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to set STP on %s on this platform\"),\n                         brname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to set STP on %s on this platform\")",
            "brname"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set STP on %s on this platform\""
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeSetSTP(const char *brname,\n                          bool enable G_GNUC_UNUSED)\n\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to set STP on %s on this platform\"),\n                         brname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeGetSTPDelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "884-891",
    "snippet": "int virNetDevBridgeGetSTPDelay(const char *brname,\n                               int *delay G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to get STP delay on %s on this platform\"),\n                         brname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to get STP delay on %s on this platform\")",
            "brname"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get STP delay on %s on this platform\""
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeGetSTPDelay(const char *brname,\n                               int *delay G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to get STP delay on %s on this platform\"),\n                         brname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeSetSTPDelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "876-883",
    "snippet": "int virNetDevBridgeSetSTPDelay(const char *brname,\n                               int delay G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to set STP delay on %s on this platform\"),\n                         brname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to set STP delay on %s on this platform\")",
            "brname"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set STP delay on %s on this platform\""
          ],
          "line": 880
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeSetSTPDelay(const char *brname,\n                               int delay G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to set STP delay on %s on this platform\"),\n                         brname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeGetSTP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "867-874",
    "snippet": "int virNetDevBridgeGetSTP(const char *brname,\n                          bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to get STP on %s on this platform\"),\n                         brname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to get STP on %s on this platform\")",
            "brname"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get STP on %s on this platform\""
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeGetSTP(const char *brname,\n                          bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to get STP on %s on this platform\"),\n                         brname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeSetSTP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "859-866",
    "snippet": "int virNetDevBridgeSetSTP(const char *brname G_GNUC_UNUSED,\n                          bool enable G_GNUC_UNUSED)\n\n{\n    /* FreeBSD doesn't allow to set STP per bridge,\n     * only per-device in bridge */\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeSetSTP(const char *brname G_GNUC_UNUSED,\n                          bool enable G_GNUC_UNUSED)\n\n{\n    /* FreeBSD doesn't allow to set STP per bridge,\n     * only per-device in bridge */\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeGetSTPDelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "850-857",
    "snippet": "int virNetDevBridgeGetSTPDelay(const char *brname,\n                               int *delay G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to get STP delay on %s on this platform\"),\n                         brname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to get STP delay on %s on this platform\")",
            "brname"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get STP delay on %s on this platform\""
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeGetSTPDelay(const char *brname,\n                               int *delay G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to get STP delay on %s on this platform\"),\n                         brname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeSetSTPDelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "832-849",
    "snippet": "int virNetDevBridgeSetSTPDelay(const char *brname,\n                               int delay)\n{\n    struct ifbrparam param;\n    u_long delay_seconds = delay / 1000;\n\n    /* FreeBSD doesn't allow setting STP delay < 4 */\n    delay_seconds = delay_seconds < 4 ? 4 : delay_seconds;\n    param.ifbrp_fwddelay = delay_seconds & 0xff;\n\n    if (virNetDevBridgeCmd(brname, BRDGSFD, &param, sizeof(param)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set STP delay on %s\"), brname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to set STP delay on %s\")",
            "brname"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set STP delay on %s\""
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBridgeCmd",
          "args": [
            "brname",
            "BRDGSFD",
            "&param",
            "sizeof(param)"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeCmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "75-103",
          "snippet": "static int virNetDevBridgeCmd(const char *brname,\n                              u_long op,\n                              void *arg,\n                              size_t argsize)\n{\n    struct ifdrv ifd;\n    VIR_AUTOCLOSE s = -1;\n\n    memset(&ifd, 0, sizeof(ifd));\n\n    if ((s = socket(AF_LOCAL, SOCK_DGRAM, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(ifd.ifd_name, brname) < 0) {\n       virReportSystemError(ERANGE,\n                            _(\"Network interface name '%s' is too long\"),\n                            brname);\n       return -1;\n    }\n\n    ifd.ifd_cmd = op;\n    ifd.ifd_len = argsize;\n    ifd.ifd_data = arg;\n\n    return ioctl(s, SIOCSDRVSPEC, &ifd);\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeCmd(const char *brname,\n                              u_long op,\n                              void *arg,\n                              size_t argsize)\n{\n    struct ifdrv ifd;\n    VIR_AUTOCLOSE s = -1;\n\n    memset(&ifd, 0, sizeof(ifd));\n\n    if ((s = socket(AF_LOCAL, SOCK_DGRAM, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(ifd.ifd_name, brname) < 0) {\n       virReportSystemError(ERANGE,\n                            _(\"Network interface name '%s' is too long\"),\n                            brname);\n       return -1;\n    }\n\n    ifd.ifd_cmd = op;\n    ifd.ifd_len = argsize;\n    ifd.ifd_data = arg;\n\n    return ioctl(s, SIOCSDRVSPEC, &ifd);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeSetSTPDelay(const char *brname,\n                               int delay)\n{\n    struct ifbrparam param;\n    u_long delay_seconds = delay / 1000;\n\n    /* FreeBSD doesn't allow setting STP delay < 4 */\n    delay_seconds = delay_seconds < 4 ? 4 : delay_seconds;\n    param.ifbrp_fwddelay = delay_seconds & 0xff;\n\n    if (virNetDevBridgeCmd(brname, BRDGSFD, &param, sizeof(param)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set STP delay on %s\"), brname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeGetSTP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "820-830",
    "snippet": "int virNetDevBridgeGetSTP(const char *brname,\n                          bool *enabled)\n{\n    int ret = -1;\n    unsigned long val = 0;\n\n    ret = virNetDevBridgeGet(brname, \"stp_state\", &val);\n    *enabled = val ? true : false;\n\n    return ret;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeGet",
          "args": [
            "brname",
            "\"stp_state\"",
            "&val"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "156-205",
          "snippet": "static int virNetDevBridgeGet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long *value)   /* current value */\n{\n    struct ifreq ifr;\n    g_autofree char *path = NULL;\n    VIR_AUTOCLOSE fd = -1;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = NULL;\n\n        if (virFileReadAll(path, VIR_INT64_STR_BUFLEN,\n                           &valuestr) < 0)\n            return -1;\n\n        if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"),\n                                 brname, paramname);\n            return -1;\n        }\n    } else {\n        struct __bridge_info info;\n        unsigned long args[] = { BRCTL_GET_BRIDGE_INFO, (unsigned long)&info, 0, 0 };\n\n        if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n            return -1;\n\n        ifr.ifr_data = (char*)&args;\n        if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n\n        if (STREQ(paramname, \"stp_state\")) {\n            *value = info.stp_enabled;\n        } else if (STREQ(paramname, \"forward_delay\")) {\n            *value = info.forward_delay;\n        } else {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeGet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long *value)   /* current value */\n{\n    struct ifreq ifr;\n    g_autofree char *path = NULL;\n    VIR_AUTOCLOSE fd = -1;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = NULL;\n\n        if (virFileReadAll(path, VIR_INT64_STR_BUFLEN,\n                           &valuestr) < 0)\n            return -1;\n\n        if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"),\n                                 brname, paramname);\n            return -1;\n        }\n    } else {\n        struct __bridge_info info;\n        unsigned long args[] = { BRCTL_GET_BRIDGE_INFO, (unsigned long)&info, 0, 0 };\n\n        if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n            return -1;\n\n        ifr.ifr_data = (char*)&args;\n        if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n\n        if (STREQ(paramname, \"stp_state\")) {\n            *value = info.stp_enabled;\n        } else if (STREQ(paramname, \"forward_delay\")) {\n            *value = info.forward_delay;\n        } else {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeGetSTP(const char *brname,\n                          bool *enabled)\n{\n    int ret = -1;\n    unsigned long val = 0;\n\n    ret = virNetDevBridgeGet(brname, \"stp_state\", &val);\n    *enabled = val ? true : false;\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevBridgeSetSTP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "796-807",
    "snippet": "int virNetDevBridgeSetSTP(const char *brname,\n                          bool enable)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    return virNetDevBridgeSet(brname, \"stp_state\", enable ? 1 : 0,\n                              fd, &ifr);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeSet",
          "args": [
            "brname",
            "\"stp_state\"",
            "enable ? 1 : 0",
            "fd",
            "&ifr"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "115-153",
          "snippet": "static int virNetDevBridgeSet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long value,    /* new value */\n                              int fd,                 /* control socket */\n                              struct ifreq *ifr)      /* pre-filled bridge name */\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = g_strdup_printf(\"%lu\", value);\n        if (virFileWriteStr(path, valuestr, 0) >= 0)\n            return 0;\n        VIR_DEBUG(\"Unable to set bridge %s %s via sysfs\", brname, paramname);\n    }\n\n    unsigned long paramid;\n    if (STREQ(paramname, \"stp_state\")) {\n        paramid = BRCTL_SET_BRIDGE_STP_STATE;\n    } else if (STREQ(paramname, \"forward_delay\")) {\n        paramid = BRCTL_SET_BRIDGE_FORWARD_DELAY;\n    } else {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n    unsigned long args[] = { paramid, value, 0, 0 };\n    ifr->ifr_data = (char*)&args;\n    if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeSet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long value,    /* new value */\n                              int fd,                 /* control socket */\n                              struct ifreq *ifr)      /* pre-filled bridge name */\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = g_strdup_printf(\"%lu\", value);\n        if (virFileWriteStr(path, valuestr, 0) >= 0)\n            return 0;\n        VIR_DEBUG(\"Unable to set bridge %s %s via sysfs\", brname, paramname);\n    }\n\n    unsigned long paramid;\n    if (STREQ(paramname, \"stp_state\")) {\n        paramid = BRCTL_SET_BRIDGE_STP_STATE;\n    } else if (STREQ(paramname, \"forward_delay\")) {\n        paramid = BRCTL_SET_BRIDGE_FORWARD_DELAY;\n    } else {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n    unsigned long args[] = { paramid, value, 0, 0 };\n    ifr->ifr_data = (char*)&args;\n    if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "brname",
            "&ifr"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeSetSTP(const char *brname,\n                          bool enable)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    return virNetDevBridgeSet(brname, \"stp_state\", enable ? 1 : 0,\n                              fd, &ifr);\n}"
  },
  {
    "function_name": "virNetDevBridgeGetSTPDelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "773-783",
    "snippet": "int virNetDevBridgeGetSTPDelay(const char *brname,\n                               int *delayms)\n{\n    int ret = -1;\n    unsigned long val = 0;\n\n    ret = virNetDevBridgeGet(brname, \"forward_delay\", &val);\n    *delayms = JIFFIES_TO_MS(val);\n\n    return ret;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "JIFFIES_TO_MS",
          "args": [
            "val"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevBridgeGet",
          "args": [
            "brname",
            "\"forward_delay\"",
            "&val"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "156-205",
          "snippet": "static int virNetDevBridgeGet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long *value)   /* current value */\n{\n    struct ifreq ifr;\n    g_autofree char *path = NULL;\n    VIR_AUTOCLOSE fd = -1;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = NULL;\n\n        if (virFileReadAll(path, VIR_INT64_STR_BUFLEN,\n                           &valuestr) < 0)\n            return -1;\n\n        if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"),\n                                 brname, paramname);\n            return -1;\n        }\n    } else {\n        struct __bridge_info info;\n        unsigned long args[] = { BRCTL_GET_BRIDGE_INFO, (unsigned long)&info, 0, 0 };\n\n        if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n            return -1;\n\n        ifr.ifr_data = (char*)&args;\n        if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n\n        if (STREQ(paramname, \"stp_state\")) {\n            *value = info.stp_enabled;\n        } else if (STREQ(paramname, \"forward_delay\")) {\n            *value = info.forward_delay;\n        } else {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeGet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long *value)   /* current value */\n{\n    struct ifreq ifr;\n    g_autofree char *path = NULL;\n    VIR_AUTOCLOSE fd = -1;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = NULL;\n\n        if (virFileReadAll(path, VIR_INT64_STR_BUFLEN,\n                           &valuestr) < 0)\n            return -1;\n\n        if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"),\n                                 brname, paramname);\n            return -1;\n        }\n    } else {\n        struct __bridge_info info;\n        unsigned long args[] = { BRCTL_GET_BRIDGE_INFO, (unsigned long)&info, 0, 0 };\n\n        if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n            return -1;\n\n        ifr.ifr_data = (char*)&args;\n        if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n\n        if (STREQ(paramname, \"stp_state\")) {\n            *value = info.stp_enabled;\n        } else if (STREQ(paramname, \"forward_delay\")) {\n            *value = info.forward_delay;\n        } else {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeGetSTPDelay(const char *brname,\n                               int *delayms)\n{\n    int ret = -1;\n    unsigned long val = 0;\n\n    ret = virNetDevBridgeGet(brname, \"forward_delay\", &val);\n    *delayms = JIFFIES_TO_MS(val);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevBridgeSetSTPDelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "748-759",
    "snippet": "int virNetDevBridgeSetSTPDelay(const char *brname,\n                               int delay)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    return virNetDevBridgeSet(brname, \"forward_delay\", MS_TO_JIFFIES(delay),\n                              fd, &ifr);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeSet",
          "args": [
            "brname",
            "\"forward_delay\"",
            "MS_TO_JIFFIES(delay)",
            "fd",
            "&ifr"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "115-153",
          "snippet": "static int virNetDevBridgeSet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long value,    /* new value */\n                              int fd,                 /* control socket */\n                              struct ifreq *ifr)      /* pre-filled bridge name */\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = g_strdup_printf(\"%lu\", value);\n        if (virFileWriteStr(path, valuestr, 0) >= 0)\n            return 0;\n        VIR_DEBUG(\"Unable to set bridge %s %s via sysfs\", brname, paramname);\n    }\n\n    unsigned long paramid;\n    if (STREQ(paramname, \"stp_state\")) {\n        paramid = BRCTL_SET_BRIDGE_STP_STATE;\n    } else if (STREQ(paramname, \"forward_delay\")) {\n        paramid = BRCTL_SET_BRIDGE_FORWARD_DELAY;\n    } else {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n    unsigned long args[] = { paramid, value, 0, 0 };\n    ifr->ifr_data = (char*)&args;\n    if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeSet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long value,    /* new value */\n                              int fd,                 /* control socket */\n                              struct ifreq *ifr)      /* pre-filled bridge name */\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = g_strdup_printf(\"%lu\", value);\n        if (virFileWriteStr(path, valuestr, 0) >= 0)\n            return 0;\n        VIR_DEBUG(\"Unable to set bridge %s %s via sysfs\", brname, paramname);\n    }\n\n    unsigned long paramid;\n    if (STREQ(paramname, \"stp_state\")) {\n        paramid = BRCTL_SET_BRIDGE_STP_STATE;\n    } else if (STREQ(paramname, \"forward_delay\")) {\n        paramid = BRCTL_SET_BRIDGE_FORWARD_DELAY;\n    } else {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n    unsigned long args[] = { paramid, value, 0, 0 };\n    ifr->ifr_data = (char*)&args;\n    if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MS_TO_JIFFIES",
          "args": [
            "delay"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "brname",
            "&ifr"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeSetSTPDelay(const char *brname,\n                               int delay)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    return virNetDevBridgeSet(brname, \"forward_delay\", MS_TO_JIFFIES(delay),\n                              fd, &ifr);\n}"
  },
  {
    "function_name": "virNetDevBridgeRemovePort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "727-733",
    "snippet": "int virNetDevBridgeRemovePort(const char *brname,\n                              const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to remove bridge %s port %s\"), brname, ifname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to remove bridge %s port %s\")",
            "brname",
            "ifname"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove bridge %s port %s\""
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeRemovePort(const char *brname,\n                              const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to remove bridge %s port %s\"), brname, ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeRemovePort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "705-725",
    "snippet": "int virNetDevBridgeRemovePort(const char *brname,\n                              const char *ifname)\n{\n    struct ifbreq req;\n\n    memset(&req, 0, sizeof(req));\n    if (virStrcpyStatic(req.ifbr_ifsname, ifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"Network interface name '%s' is too long\"),\n                             ifname);\n        return -1;\n    }\n\n    if (virNetDevBridgeCmd(brname, BRDGDEL, &req, sizeof(req)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove bridge %s port %s\"), brname, ifname);\n       return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to remove bridge %s port %s\")",
            "brname",
            "ifname"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove bridge %s port %s\""
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBridgeCmd",
          "args": [
            "brname",
            "BRDGDEL",
            "&req",
            "sizeof(req)"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeCmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "75-103",
          "snippet": "static int virNetDevBridgeCmd(const char *brname,\n                              u_long op,\n                              void *arg,\n                              size_t argsize)\n{\n    struct ifdrv ifd;\n    VIR_AUTOCLOSE s = -1;\n\n    memset(&ifd, 0, sizeof(ifd));\n\n    if ((s = socket(AF_LOCAL, SOCK_DGRAM, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(ifd.ifd_name, brname) < 0) {\n       virReportSystemError(ERANGE,\n                            _(\"Network interface name '%s' is too long\"),\n                            brname);\n       return -1;\n    }\n\n    ifd.ifd_cmd = op;\n    ifd.ifd_len = argsize;\n    ifd.ifd_data = arg;\n\n    return ioctl(s, SIOCSDRVSPEC, &ifd);\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeCmd(const char *brname,\n                              u_long op,\n                              void *arg,\n                              size_t argsize)\n{\n    struct ifdrv ifd;\n    VIR_AUTOCLOSE s = -1;\n\n    memset(&ifd, 0, sizeof(ifd));\n\n    if ((s = socket(AF_LOCAL, SOCK_DGRAM, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(ifd.ifd_name, brname) < 0) {\n       virReportSystemError(ERANGE,\n                            _(\"Network interface name '%s' is too long\"),\n                            brname);\n       return -1;\n    }\n\n    ifd.ifd_cmd = op;\n    ifd.ifd_len = argsize;\n    ifd.ifd_data = arg;\n\n    return ioctl(s, SIOCSDRVSPEC, &ifd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ERANGE",
            "_(\"Network interface name '%s' is too long\")",
            "ifname"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "req.ifbr_ifsname",
            "ifname"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&req",
            "0",
            "sizeof(req)"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeRemovePort(const char *brname,\n                              const char *ifname)\n{\n    struct ifbreq req;\n\n    memset(&req, 0, sizeof(req));\n    if (virStrcpyStatic(req.ifbr_ifsname, ifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"Network interface name '%s' is too long\"),\n                             ifname);\n        return -1;\n    }\n\n    if (virNetDevBridgeCmd(brname, BRDGDEL, &req, sizeof(req)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove bridge %s port %s\"), brname, ifname);\n       return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeRemovePort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "680-703",
    "snippet": "int virNetDevBridgeRemovePort(const char *brname,\n                              const char *ifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    if (!(ifr.ifr_ifindex = if_nametoindex(ifname))) {\n        virReportSystemError(ENODEV,\n                             _(\"Unable to get interface index for %s\"), ifname);\n\n        return -1;\n    }\n\n    if (ioctl(fd, SIOCBRDELIF, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove bridge %s port %s\"), brname, ifname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to remove bridge %s port %s\")",
            "brname",
            "ifname"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove bridge %s port %s\""
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCBRDELIF",
            "&ifr"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENODEV",
            "_(\"Unable to get interface index for %s\")",
            "ifname"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if_nametoindex",
          "args": [
            "ifname"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "brname",
            "&ifr"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeRemovePort(const char *brname,\n                              const char *ifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    if (!(ifr.ifr_ifindex = if_nametoindex(ifname))) {\n        virReportSystemError(ENODEV,\n                             _(\"Unable to get interface index for %s\"), ifname);\n\n        return -1;\n    }\n\n    if (ioctl(fd, SIOCBRDELIF, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove bridge %s port %s\"), brname, ifname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeAddPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "661-667",
    "snippet": "int virNetDevBridgeAddPort(const char *brname,\n                           const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to add bridge %s port %s\"), brname, ifname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to add bridge %s port %s\")",
            "brname",
            "ifname"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to add bridge %s port %s\""
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeAddPort(const char *brname,\n                           const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to add bridge %s port %s\"), brname, ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeAddPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "639-659",
    "snippet": "int virNetDevBridgeAddPort(const char *brname,\n                           const char *ifname)\n{\n    struct ifbreq req;\n\n    memset(&req, 0, sizeof(req));\n    if (virStrcpyStatic(req.ifbr_ifsname, ifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"Network interface name '%s' is too long\"),\n                             ifname);\n        return -1;\n    }\n\n    if (virNetDevBridgeCmd(brname, BRDGADD, &req, sizeof(req)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to add bridge %s port %s\"), brname, ifname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to add bridge %s port %s\")",
            "brname",
            "ifname"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to add bridge %s port %s\""
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBridgeCmd",
          "args": [
            "brname",
            "BRDGADD",
            "&req",
            "sizeof(req)"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeCmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "75-103",
          "snippet": "static int virNetDevBridgeCmd(const char *brname,\n                              u_long op,\n                              void *arg,\n                              size_t argsize)\n{\n    struct ifdrv ifd;\n    VIR_AUTOCLOSE s = -1;\n\n    memset(&ifd, 0, sizeof(ifd));\n\n    if ((s = socket(AF_LOCAL, SOCK_DGRAM, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(ifd.ifd_name, brname) < 0) {\n       virReportSystemError(ERANGE,\n                            _(\"Network interface name '%s' is too long\"),\n                            brname);\n       return -1;\n    }\n\n    ifd.ifd_cmd = op;\n    ifd.ifd_len = argsize;\n    ifd.ifd_data = arg;\n\n    return ioctl(s, SIOCSDRVSPEC, &ifd);\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeCmd(const char *brname,\n                              u_long op,\n                              void *arg,\n                              size_t argsize)\n{\n    struct ifdrv ifd;\n    VIR_AUTOCLOSE s = -1;\n\n    memset(&ifd, 0, sizeof(ifd));\n\n    if ((s = socket(AF_LOCAL, SOCK_DGRAM, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(ifd.ifd_name, brname) < 0) {\n       virReportSystemError(ERANGE,\n                            _(\"Network interface name '%s' is too long\"),\n                            brname);\n       return -1;\n    }\n\n    ifd.ifd_cmd = op;\n    ifd.ifd_len = argsize;\n    ifd.ifd_data = arg;\n\n    return ioctl(s, SIOCSDRVSPEC, &ifd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ERANGE",
            "_(\"Network interface name '%s' is too long\")",
            "ifname"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "req.ifbr_ifsname",
            "ifname"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&req",
            "0",
            "sizeof(req)"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeAddPort(const char *brname,\n                           const char *ifname)\n{\n    struct ifbreq req;\n\n    memset(&req, 0, sizeof(req));\n    if (virStrcpyStatic(req.ifbr_ifsname, ifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"Network interface name '%s' is too long\"),\n                             ifname);\n        return -1;\n    }\n\n    if (virNetDevBridgeCmd(brname, BRDGADD, &req, sizeof(req)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to add bridge %s port %s\"), brname, ifname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeAddPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "615-637",
    "snippet": "int virNetDevBridgeAddPort(const char *brname,\n                           const char *ifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    if (!(ifr.ifr_ifindex = if_nametoindex(ifname))) {\n        virReportSystemError(ENODEV,\n                             _(\"Unable to get interface index for %s\"), ifname);\n        return -1;\n    }\n\n    if (ioctl(fd, SIOCBRADDIF, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to add bridge %s port %s\"), brname, ifname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to add bridge %s port %s\")",
            "brname",
            "ifname"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to add bridge %s port %s\""
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCBRADDIF",
            "&ifr"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENODEV",
            "_(\"Unable to get interface index for %s\")",
            "ifname"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if_nametoindex",
          "args": [
            "ifname"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "brname",
            "&ifr"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeAddPort(const char *brname,\n                           const char *ifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    if (!(ifr.ifr_ifindex = if_nametoindex(ifname))) {\n        virReportSystemError(ENODEV,\n                             _(\"Unable to get interface index for %s\"), ifname);\n        return -1;\n    }\n\n    if (ioctl(fd, SIOCBRADDIF, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to add bridge %s port %s\"), brname, ifname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "597-602",
    "snippet": "int virNetDevBridgeDelete(const char *brname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to delete bridge %s\"), brname);\n    return EINVAL;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to delete bridge %s\")",
            "brname"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to delete bridge %s\""
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeDelete(const char *brname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to delete bridge %s\"), brname);\n    return EINVAL;\n}"
  },
  {
    "function_name": "virNetDevBridgeDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "578-595",
    "snippet": "int\nvirNetDevBridgeDelete(const char *brname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE s = -1;\n\n    if ((s = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(s, SIOCIFDESTROY, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove bridge %s\"),\n                             brname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to remove bridge %s\")",
            "brname"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove bridge %s\""
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "s",
            "SIOCIFDESTROY",
            "&ifr"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "brname",
            "&ifr"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeDelete(const char *brname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE s = -1;\n\n    if ((s = virNetDevSetupControl(brname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(s, SIOCIFDESTROY, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove bridge %s\"),\n                             brname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "570-574",
    "snippet": "int\nvirNetDevBridgeDelete(const char *brname)\n{\n    return virNetDevBridgeDeleteWithIoctl(brname);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeDeleteWithIoctl",
          "args": [
            "brname"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeDeleteWithIoctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "532-549",
          "snippet": "static int\nvirNetDevBridgeDeleteWithIoctl(const char *brname)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    ignore_value(virNetDevSetOnline(brname, false));\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRDELBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to delete bridge %s\"), brname);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeDeleteWithIoctl(const char *brname)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    ignore_value(virNetDevSetOnline(brname, false));\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRDELBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to delete bridge %s\"), brname);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeDelete(const char *brname)\n{\n    return virNetDevBridgeDeleteWithIoctl(brname);\n}"
  },
  {
    "function_name": "virNetDevBridgeDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "554-566",
    "snippet": "int\nvirNetDevBridgeDelete(const char *brname)\n{\n    /* If netlink is available, use it, as it is successful at\n     * deleting a bridge even if it is currently IFF_UP. fallback to\n     * using ioctl(SIOCBRDELBR) if netlink fails with EOPNOTSUPP.\n     */\n# if defined(HAVE_STRUCT_IFREQ) && defined(SIOCBRDELBR)\n    return virNetlinkDelLink(brname, virNetDevBridgeDeleteWithIoctl);\n# else\n    return virNetlinkDelLink(brname, NULL);\n# endif\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetlinkDelLink",
          "args": [
            "brname",
            "NULL"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkDelLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1275-1281",
          "snippet": "int\nvirNetlinkDelLink(const char *ifname G_GNUC_UNUSED,\n                  virNetlinkDelLinkFallback fallback G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetlinkDelLink(const char *ifname G_GNUC_UNUSED,\n                  virNetlinkDelLinkFallback fallback G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeDelete(const char *brname)\n{\n    /* If netlink is available, use it, as it is successful at\n     * deleting a bridge even if it is currently IFF_UP. fallback to\n     * using ioctl(SIOCBRDELBR) if netlink fails with EOPNOTSUPP.\n     */\n# if defined(HAVE_STRUCT_IFREQ) && defined(SIOCBRDELBR)\n    return virNetlinkDelLink(brname, virNetDevBridgeDeleteWithIoctl);\n# else\n    return virNetlinkDelLink(brname, NULL);\n# endif\n}"
  },
  {
    "function_name": "virNetDevBridgeDeleteWithIoctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "532-549",
    "snippet": "static int\nvirNetDevBridgeDeleteWithIoctl(const char *brname)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    ignore_value(virNetDevSetOnline(brname, false));\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRDELBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to delete bridge %s\"), brname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to delete bridge %s\")",
            "brname"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to delete bridge %s\""
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCBRDELBR",
            "brname"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "NULL",
            "NULL"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevSetOnline(brname, false)"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetOnline",
          "args": [
            "brname",
            "false"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetOnline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "660-665",
          "snippet": "int\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeDeleteWithIoctl(const char *brname)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    ignore_value(virNetDevSetOnline(brname, false));\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRDELBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to delete bridge %s\"), brname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "513-520",
    "snippet": "int\nvirNetDevBridgeCreate(const char *brname,\n                      const virMacAddr *mac G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to create bridge %s\"), brname);\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to create bridge %s\")",
            "brname"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to create bridge %s\""
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeCreate(const char *brname,\n                      const virMacAddr *mac G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to create bridge %s\"), brname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgeCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "482-511",
    "snippet": "int\nvirNetDevBridgeCreate(const char *brname,\n                      const virMacAddr *mac)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE s = -1;\n\n    if ((s = virNetDevSetupControl(\"bridge\", &ifr)) < 0)\n        return -1;\n\n    if (ioctl(s, SIOCIFCREATE2, &ifr) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to create bridge device\"));\n        return -1;\n    }\n\n    if (virNetDevSetName(ifr.ifr_name, brname) == -1)\n        return -1;\n\n    if (virNetDevSetMAC(brname, mac) < 0) {\n        virErrorPtr savederr;\n\n        virErrorPreserveLast(&savederr);\n        ignore_value(virNetDevBridgeDelete(brname));\n        virErrorRestore(&savederr);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&savederr"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevBridgeDelete(brname)"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevBridgeDelete",
          "args": [
            "brname"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "597-602",
          "snippet": "int virNetDevBridgeDelete(const char *brname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to delete bridge %s\"), brname);\n    return EINVAL;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint virNetDevBridgeDelete(const char *brname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to delete bridge %s\"), brname);\n    return EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&savederr"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetMAC",
          "args": [
            "brname",
            "mac"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetMAC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "346-351",
          "snippet": "int\nvirNetDevSetMAC(const char *ifname,\n                const virMacAddr *macaddr)\n{\n    return virNetDevSetMACInternal(ifname, macaddr, false);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetMAC(const char *ifname,\n                const virMacAddr *macaddr)\n{\n    return virNetDevSetMACInternal(ifname, macaddr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetName",
          "args": [
            "ifr.ifr_name",
            "brname"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "591-597",
          "snippet": "int virNetDevSetName(const char* ifname, const char *newifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot rename interface '%s' to '%s' on this platform\"),\n                         ifname, newifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetName(const char* ifname, const char *newifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot rename interface '%s' to '%s' on this platform\"),\n                         ifname, newifname);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to create bridge device\")"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to create bridge device\""
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "s",
            "SIOCIFCREATE2",
            "&ifr"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "\"bridge\"",
            "&ifr"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeCreate(const char *brname,\n                      const virMacAddr *mac)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE s = -1;\n\n    if ((s = virNetDevSetupControl(\"bridge\", &ifr)) < 0)\n        return -1;\n\n    if (ioctl(s, SIOCIFCREATE2, &ifr) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to create bridge device\"));\n        return -1;\n    }\n\n    if (virNetDevSetName(ifr.ifr_name, brname) == -1)\n        return -1;\n\n    if (virNetDevSetMAC(brname, mac) < 0) {\n        virErrorPtr savederr;\n\n        virErrorPreserveLast(&savederr);\n        ignore_value(virNetDevBridgeDelete(brname));\n        virErrorRestore(&savederr);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "473-478",
    "snippet": "int\nvirNetDevBridgeCreate(const char *brname,\n                      const virMacAddr *mac)\n{\n    return virNetDevBridgeCreateWithIoctl(brname, mac);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgeCreateWithIoctl",
          "args": [
            "brname",
            "mac"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeCreateWithIoctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "414-439",
          "snippet": "static int\nvirNetDevBridgeCreateWithIoctl(const char *brname,\n                               const virMacAddr *mac)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRADDBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create bridge %s\"), brname);\n        return -1;\n    }\n\n    if (virNetDevSetMAC(brname, mac) < 0) {\n        virErrorPtr savederr;\n\n        virErrorPreserveLast(&savederr);\n        ignore_value(ioctl(fd, SIOCBRDELBR, brname));\n        virErrorRestore(&savederr);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeCreateWithIoctl(const char *brname,\n                               const virMacAddr *mac)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRADDBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create bridge %s\"), brname);\n        return -1;\n    }\n\n    if (virNetDevSetMAC(brname, mac) < 0) {\n        virErrorPtr savederr;\n\n        virErrorPreserveLast(&savederr);\n        ignore_value(ioctl(fd, SIOCBRDELBR, brname));\n        virErrorRestore(&savederr);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeCreate(const char *brname,\n                      const virMacAddr *mac)\n{\n    return virNetDevBridgeCreateWithIoctl(brname, mac);\n}"
  },
  {
    "function_name": "virNetDevBridgeCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "443-469",
    "snippet": "int\nvirNetDevBridgeCreate(const char *brname,\n                      const virMacAddr *mac)\n{\n    /* use a netlink RTM_NEWLINK message to create the bridge */\n    int error = 0;\n    virNetlinkNewLinkData data = {\n        .mac = mac,\n    };\n\n\n    if (virNetlinkNewLink(brname, \"bridge\", &data, &error) < 0) {\n# if defined(HAVE_STRUCT_IFREQ) && defined(SIOCBRADDBR)\n        if (error == -EOPNOTSUPP) {\n            /* fallback to ioctl if netlink doesn't support creating bridges */\n            return virNetDevBridgeCreateWithIoctl(brname, mac);\n        }\n# endif\n        if (error < 0)\n            virReportSystemError(-error, _(\"error creating bridge interface %s\"),\n                                 brname);\n\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-error",
            "_(\"error creating bridge interface %s\")",
            "brname"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"error creating bridge interface %s\""
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBridgeCreateWithIoctl",
          "args": [
            "brname",
            "mac"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeCreateWithIoctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "414-439",
          "snippet": "static int\nvirNetDevBridgeCreateWithIoctl(const char *brname,\n                               const virMacAddr *mac)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRADDBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create bridge %s\"), brname);\n        return -1;\n    }\n\n    if (virNetDevSetMAC(brname, mac) < 0) {\n        virErrorPtr savederr;\n\n        virErrorPreserveLast(&savederr);\n        ignore_value(ioctl(fd, SIOCBRDELBR, brname));\n        virErrorRestore(&savederr);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeCreateWithIoctl(const char *brname,\n                               const virMacAddr *mac)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRADDBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create bridge %s\"), brname);\n        return -1;\n    }\n\n    if (virNetDevSetMAC(brname, mac) < 0) {\n        virErrorPtr savederr;\n\n        virErrorPreserveLast(&savederr);\n        ignore_value(ioctl(fd, SIOCBRDELBR, brname));\n        virErrorRestore(&savederr);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetlinkNewLink",
          "args": [
            "brname",
            "\"bridge\"",
            "&data",
            "&error"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkNewLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1284-1292",
          "snippet": "int\nvirNetlinkNewLink(const char *ifname G_GNUC_UNUSED,\n                  const char *type G_GNUC_UNUSED,\n                  virNetlinkNewLinkDataPtr extra_args G_GNUC_UNUSED,\n                  int *error G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetlinkNewLink(const char *ifname G_GNUC_UNUSED,\n                  const char *type G_GNUC_UNUSED,\n                  virNetlinkNewLinkDataPtr extra_args G_GNUC_UNUSED,\n                  int *error G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeCreate(const char *brname,\n                      const virMacAddr *mac)\n{\n    /* use a netlink RTM_NEWLINK message to create the bridge */\n    int error = 0;\n    virNetlinkNewLinkData data = {\n        .mac = mac,\n    };\n\n\n    if (virNetlinkNewLink(brname, \"bridge\", &data, &error) < 0) {\n# if defined(HAVE_STRUCT_IFREQ) && defined(SIOCBRADDBR)\n        if (error == -EOPNOTSUPP) {\n            /* fallback to ioctl if netlink doesn't support creating bridges */\n            return virNetDevBridgeCreateWithIoctl(brname, mac);\n        }\n# endif\n        if (error < 0)\n            virReportSystemError(-error, _(\"error creating bridge interface %s\"),\n                                 brname);\n\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeCreateWithIoctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "414-439",
    "snippet": "static int\nvirNetDevBridgeCreateWithIoctl(const char *brname,\n                               const virMacAddr *mac)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRADDBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create bridge %s\"), brname);\n        return -1;\n    }\n\n    if (virNetDevSetMAC(brname, mac) < 0) {\n        virErrorPtr savederr;\n\n        virErrorPreserveLast(&savederr);\n        ignore_value(ioctl(fd, SIOCBRDELBR, brname));\n        virErrorRestore(&savederr);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&savederr"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "ioctl(fd, SIOCBRDELBR, brname)"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCBRDELBR",
            "brname"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&savederr"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetMAC",
          "args": [
            "brname",
            "mac"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetMAC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "346-351",
          "snippet": "int\nvirNetDevSetMAC(const char *ifname,\n                const virMacAddr *macaddr)\n{\n    return virNetDevSetMACInternal(ifname, macaddr, false);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetMAC(const char *ifname,\n                const virMacAddr *macaddr)\n{\n    return virNetDevSetMACInternal(ifname, macaddr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to create bridge %s\")",
            "brname"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to create bridge %s\""
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "NULL",
            "NULL"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgeCreateWithIoctl(const char *brname,\n                               const virMacAddr *mac)\n{\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(NULL, NULL)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCBRADDBR, brname) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create bridge %s\"), brname);\n        return -1;\n    }\n\n    if (virNetDevSetMAC(brname, mac) < 0) {\n        virErrorPtr savederr;\n\n        virErrorPreserveLast(&savederr);\n        ignore_value(ioctl(fd, SIOCBRDELBR, brname));\n        virErrorRestore(&savederr);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgePortSetIsolated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "393-401",
    "snippet": "int\nvirNetDevBridgePortSetIsolated(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port isolated on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to set bridge port isolated on this platform\")"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set bridge port isolated on this platform\""
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortSetIsolated(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port isolated on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgePortGetIsolated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "382-390",
    "snippet": "int\nvirNetDevBridgePortGetIsolated(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get bridge port isolated on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get bridge port isolated on this platform\")"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get bridge port isolated on this platform\""
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortGetIsolated(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get bridge port isolated on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgePortSetUnicastFlood",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "371-379",
    "snippet": "int\nvirNetDevBridgePortSetUnicastFlood(const char *brname G_GNUC_UNUSED,\n                                   const char *ifname G_GNUC_UNUSED,\n                                   bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port unicast_flood on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to set bridge port unicast_flood on this platform\")"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set bridge port unicast_flood on this platform\""
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortSetUnicastFlood(const char *brname G_GNUC_UNUSED,\n                                   const char *ifname G_GNUC_UNUSED,\n                                   bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port unicast_flood on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgePortGetUnicastFlood",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "360-368",
    "snippet": "int\nvirNetDevBridgePortGetUnicastFlood(const char *brname G_GNUC_UNUSED,\n                                   const char *ifname G_GNUC_UNUSED,\n                                   bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get bridge port unicast_flood on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get bridge port unicast_flood on this platform\")"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get bridge port unicast_flood on this platform\""
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortGetUnicastFlood(const char *brname G_GNUC_UNUSED,\n                                   const char *ifname G_GNUC_UNUSED,\n                                   bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get bridge port unicast_flood on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgePortSetLearning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "349-357",
    "snippet": "int\nvirNetDevBridgePortSetLearning(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port learning on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to set bridge port learning on this platform\")"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set bridge port learning on this platform\""
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortSetLearning(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port learning on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgePortGetLearning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "338-346",
    "snippet": "int\nvirNetDevBridgePortGetLearning(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get bridge port learning on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get bridge port learning on this platform\")"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get bridge port learning on this platform\""
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortGetLearning(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool *enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get bridge port learning on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevBridgePortSetIsolated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "328-334",
    "snippet": "int\nvirNetDevBridgePortSetIsolated(const char *brname,\n                               const char *ifname,\n                               bool enable)\n{\n    return virNetDevBridgePortSet(brname, ifname, \"isolated\", enable ? 1 : 0);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgePortSet",
          "args": [
            "brname",
            "ifname",
            "\"isolated\"",
            "enable ? 1 : 0"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgePortSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "209-236",
          "snippet": "static int\nvirNetDevBridgePortSet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long value)\n{\n    char valuestr[VIR_INT64_STR_BUFLEN];\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    g_snprintf(valuestr, sizeof(valuestr), \"%lu\", value);\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (!virFileExists(path))\n        errno = EINVAL;\n    else\n        ret = virFileWriteStr(path, valuestr, 0);\n\n    if (ret < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set bridge %s port %s %s to %s\"),\n                             brname, ifname, paramname, valuestr);\n    }\n\n    return ret;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgePortSet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long value)\n{\n    char valuestr[VIR_INT64_STR_BUFLEN];\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    g_snprintf(valuestr, sizeof(valuestr), \"%lu\", value);\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (!virFileExists(path))\n        errno = EINVAL;\n    else\n        ret = virFileWriteStr(path, valuestr, 0);\n\n    if (ret < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set bridge %s port %s %s to %s\"),\n                             brname, ifname, paramname, valuestr);\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortSetIsolated(const char *brname,\n                               const char *ifname,\n                               bool enable)\n{\n    return virNetDevBridgePortSet(brname, ifname, \"isolated\", enable ? 1 : 0);\n}"
  },
  {
    "function_name": "virNetDevBridgePortGetIsolated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "313-325",
    "snippet": "int\nvirNetDevBridgePortGetIsolated(const char *brname,\n                               const char *ifname,\n                               bool *enable)\n{\n    unsigned long value;\n\n    if (virNetDevBridgePortGet(brname, ifname, \"isolated\", &value) < 0)\n       return -1;\n\n    *enable = !!value;\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgePortGet",
          "args": [
            "brname",
            "ifname",
            "\"isolated\"",
            "&value"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgePortGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "239-262",
          "snippet": "static int\nvirNetDevBridgePortGet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long *value)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *valuestr = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &valuestr) < 0)\n        return -1;\n\n    if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to get bridge %s port %s %s\"),\n                             brname, ifname, paramname);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgePortGet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long *value)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *valuestr = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &valuestr) < 0)\n        return -1;\n\n    if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to get bridge %s port %s %s\"),\n                             brname, ifname, paramname);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortGetIsolated(const char *brname,\n                               const char *ifname,\n                               bool *enable)\n{\n    unsigned long value;\n\n    if (virNetDevBridgePortGet(brname, ifname, \"isolated\", &value) < 0)\n       return -1;\n\n    *enable = !!value;\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgePortSetUnicastFlood",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "304-310",
    "snippet": "int\nvirNetDevBridgePortSetUnicastFlood(const char *brname,\n                                   const char *ifname,\n                                   bool enable)\n{\n    return virNetDevBridgePortSet(brname, ifname, \"unicast_flood\", enable ? 1 : 0);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgePortSet",
          "args": [
            "brname",
            "ifname",
            "\"unicast_flood\"",
            "enable ? 1 : 0"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgePortSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "209-236",
          "snippet": "static int\nvirNetDevBridgePortSet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long value)\n{\n    char valuestr[VIR_INT64_STR_BUFLEN];\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    g_snprintf(valuestr, sizeof(valuestr), \"%lu\", value);\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (!virFileExists(path))\n        errno = EINVAL;\n    else\n        ret = virFileWriteStr(path, valuestr, 0);\n\n    if (ret < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set bridge %s port %s %s to %s\"),\n                             brname, ifname, paramname, valuestr);\n    }\n\n    return ret;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgePortSet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long value)\n{\n    char valuestr[VIR_INT64_STR_BUFLEN];\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    g_snprintf(valuestr, sizeof(valuestr), \"%lu\", value);\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (!virFileExists(path))\n        errno = EINVAL;\n    else\n        ret = virFileWriteStr(path, valuestr, 0);\n\n    if (ret < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set bridge %s port %s %s to %s\"),\n                             brname, ifname, paramname, valuestr);\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortSetUnicastFlood(const char *brname,\n                                   const char *ifname,\n                                   bool enable)\n{\n    return virNetDevBridgePortSet(brname, ifname, \"unicast_flood\", enable ? 1 : 0);\n}"
  },
  {
    "function_name": "virNetDevBridgePortGetUnicastFlood",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "289-301",
    "snippet": "int\nvirNetDevBridgePortGetUnicastFlood(const char *brname,\n                                   const char *ifname,\n                                   bool *enable)\n{\n    unsigned long value;\n\n    if (virNetDevBridgePortGet(brname, ifname, \"unicast_flood\", &value) < 0)\n       return -1;\n\n    *enable = !!value;\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgePortGet",
          "args": [
            "brname",
            "ifname",
            "\"unicast_flood\"",
            "&value"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgePortGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "239-262",
          "snippet": "static int\nvirNetDevBridgePortGet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long *value)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *valuestr = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &valuestr) < 0)\n        return -1;\n\n    if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to get bridge %s port %s %s\"),\n                             brname, ifname, paramname);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgePortGet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long *value)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *valuestr = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &valuestr) < 0)\n        return -1;\n\n    if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to get bridge %s port %s %s\"),\n                             brname, ifname, paramname);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortGetUnicastFlood(const char *brname,\n                                   const char *ifname,\n                                   bool *enable)\n{\n    unsigned long value;\n\n    if (virNetDevBridgePortGet(brname, ifname, \"unicast_flood\", &value) < 0)\n       return -1;\n\n    *enable = !!value;\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgePortSetLearning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "280-286",
    "snippet": "int\nvirNetDevBridgePortSetLearning(const char *brname,\n                               const char *ifname,\n                               bool enable)\n{\n    return virNetDevBridgePortSet(brname, ifname, \"learning\", enable ? 1 : 0);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgePortSet",
          "args": [
            "brname",
            "ifname",
            "\"learning\"",
            "enable ? 1 : 0"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgePortSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "209-236",
          "snippet": "static int\nvirNetDevBridgePortSet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long value)\n{\n    char valuestr[VIR_INT64_STR_BUFLEN];\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    g_snprintf(valuestr, sizeof(valuestr), \"%lu\", value);\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (!virFileExists(path))\n        errno = EINVAL;\n    else\n        ret = virFileWriteStr(path, valuestr, 0);\n\n    if (ret < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set bridge %s port %s %s to %s\"),\n                             brname, ifname, paramname, valuestr);\n    }\n\n    return ret;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgePortSet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long value)\n{\n    char valuestr[VIR_INT64_STR_BUFLEN];\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    g_snprintf(valuestr, sizeof(valuestr), \"%lu\", value);\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (!virFileExists(path))\n        errno = EINVAL;\n    else\n        ret = virFileWriteStr(path, valuestr, 0);\n\n    if (ret < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set bridge %s port %s %s to %s\"),\n                             brname, ifname, paramname, valuestr);\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortSetLearning(const char *brname,\n                               const char *ifname,\n                               bool enable)\n{\n    return virNetDevBridgePortSet(brname, ifname, \"learning\", enable ? 1 : 0);\n}"
  },
  {
    "function_name": "virNetDevBridgePortGetLearning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "265-277",
    "snippet": "int\nvirNetDevBridgePortGetLearning(const char *brname,\n                               const char *ifname,\n                               bool *enable)\n{\n    unsigned long value;\n\n    if (virNetDevBridgePortGet(brname, ifname, \"learning\", &value) < 0)\n       return -1;\n\n    *enable = !!value;\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBridgePortGet",
          "args": [
            "brname",
            "ifname",
            "\"learning\"",
            "&value"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgePortGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "239-262",
          "snippet": "static int\nvirNetDevBridgePortGet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long *value)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *valuestr = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &valuestr) < 0)\n        return -1;\n\n    if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to get bridge %s port %s %s\"),\n                             brname, ifname, paramname);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgePortGet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long *value)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *valuestr = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &valuestr) < 0)\n        return -1;\n\n    if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to get bridge %s port %s %s\"),\n                             brname, ifname, paramname);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortGetLearning(const char *brname,\n                               const char *ifname,\n                               bool *enable)\n{\n    unsigned long value;\n\n    if (virNetDevBridgePortGet(brname, ifname, \"learning\", &value) < 0)\n       return -1;\n\n    *enable = !!value;\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgePortGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "239-262",
    "snippet": "static int\nvirNetDevBridgePortGet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long *value)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *valuestr = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &valuestr) < 0)\n        return -1;\n\n    if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to get bridge %s port %s %s\"),\n                             brname, ifname, paramname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Unable to get bridge %s port %s %s\")",
            "brname",
            "ifname",
            "paramname"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get bridge %s port %s %s\""
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ul",
          "args": [
            "valuestr",
            "NULL",
            "10",
            "value"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "VIR_INT64_STR_BUFLEN",
            "&valuestr"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgePortGet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long *value)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *valuestr = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &valuestr) < 0)\n        return -1;\n\n    if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to get bridge %s port %s %s\"),\n                             brname, ifname, paramname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgePortSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "209-236",
    "snippet": "static int\nvirNetDevBridgePortSet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long value)\n{\n    char valuestr[VIR_INT64_STR_BUFLEN];\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    g_snprintf(valuestr, sizeof(valuestr), \"%lu\", value);\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (!virFileExists(path))\n        errno = EINVAL;\n    else\n        ret = virFileWriteStr(path, valuestr, 0);\n\n    if (ret < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set bridge %s port %s %s to %s\"),\n                             brname, ifname, paramname, valuestr);\n    }\n\n    return ret;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to set bridge %s port %s %s to %s\")",
            "brname",
            "ifname",
            "paramname",
            "valuestr"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virReportSystemErrorFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1322-1360",
          "snippet": "void virReportSystemErrorFull(int domcode,\n                              int theerrno,\n                              const char *filename,\n                              const char *funcname,\n                              size_t linenr,\n                              const char *fmt, ...)\n{\n    int save_errno = errno;\n    char msgDetailBuf[VIR_ERROR_MAX_LENGTH];\n\n    const char *errnoDetail = g_strerror(theerrno);\n    const char *msg = virErrorMsg(VIR_ERR_SYSTEM_ERROR, fmt);\n    const char *msgDetail = NULL;\n\n    if (fmt) {\n        va_list args;\n        int n;\n\n        va_start(args, fmt);\n        n = g_vsnprintf(msgDetailBuf, sizeof(msgDetailBuf), fmt, args);\n        va_end(args);\n\n        size_t len = strlen(errnoDetail);\n        if (0 <= n && n + 2 + len < sizeof(msgDetailBuf)) {\n          strcpy(msgDetailBuf + n, \": \");\n          n += 2;\n          strcpy(msgDetailBuf + n, errnoDetail);\n          msgDetail = msgDetailBuf;\n        }\n    }\n\n    if (!msgDetail)\n        msgDetail = errnoDetail;\n\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_SYSTEM_ERROR, VIR_ERR_ERROR,\n                      msg, msgDetail, NULL, theerrno, -1, msg, msgDetail);\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportSystemErrorFull(int domcode,\n                              int theerrno,\n                              const char *filename,\n                              const char *funcname,\n                              size_t linenr,\n                              const char *fmt, ...)\n{\n    int save_errno = errno;\n    char msgDetailBuf[VIR_ERROR_MAX_LENGTH];\n\n    const char *errnoDetail = g_strerror(theerrno);\n    const char *msg = virErrorMsg(VIR_ERR_SYSTEM_ERROR, fmt);\n    const char *msgDetail = NULL;\n\n    if (fmt) {\n        va_list args;\n        int n;\n\n        va_start(args, fmt);\n        n = g_vsnprintf(msgDetailBuf, sizeof(msgDetailBuf), fmt, args);\n        va_end(args);\n\n        size_t len = strlen(errnoDetail);\n        if (0 <= n && n + 2 + len < sizeof(msgDetailBuf)) {\n          strcpy(msgDetailBuf + n, \": \");\n          n += 2;\n          strcpy(msgDetailBuf + n, errnoDetail);\n          msgDetail = msgDetailBuf;\n        }\n    }\n\n    if (!msgDetail)\n        msgDetail = errnoDetail;\n\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_SYSTEM_ERROR, VIR_ERR_ERROR,\n                      msg, msgDetail, NULL, theerrno, -1, msg, msgDetail);\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set bridge %s port %s %s to %s\""
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileWriteStr",
          "args": [
            "path",
            "valuestr",
            "0"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "virFileWriteStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1502-1524",
          "snippet": "int\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "valuestr",
            "sizeof(valuestr)",
            "\"%lu\"",
            "value"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBridgePortSet(const char *brname,\n                       const char *ifname,\n                       const char *paramname,\n                       unsigned long value)\n{\n    char valuestr[VIR_INT64_STR_BUFLEN];\n    int ret = -1;\n    g_autofree char *path = NULL;\n\n    g_snprintf(valuestr, sizeof(valuestr), \"%lu\", value);\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/brif/%s/%s\", brname, ifname,\n                           paramname);\n\n    if (!virFileExists(path))\n        errno = EINVAL;\n    else\n        ret = virFileWriteStr(path, valuestr, 0);\n\n    if (ret < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set bridge %s port %s %s to %s\"),\n                             brname, ifname, paramname, valuestr);\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevBridgeGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "156-205",
    "snippet": "static int virNetDevBridgeGet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long *value)   /* current value */\n{\n    struct ifreq ifr;\n    g_autofree char *path = NULL;\n    VIR_AUTOCLOSE fd = -1;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = NULL;\n\n        if (virFileReadAll(path, VIR_INT64_STR_BUFLEN,\n                           &valuestr) < 0)\n            return -1;\n\n        if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"),\n                                 brname, paramname);\n            return -1;\n        }\n    } else {\n        struct __bridge_info info;\n        unsigned long args[] = { BRCTL_GET_BRIDGE_INFO, (unsigned long)&info, 0, 0 };\n\n        if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n            return -1;\n\n        ifr.ifr_data = (char*)&args;\n        if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n\n        if (STREQ(paramname, \"stp_state\")) {\n            *value = info.stp_enabled;\n        } else if (STREQ(paramname, \"forward_delay\")) {\n            *value = info.forward_delay;\n        } else {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Unable to get bridge %s %s\")",
            "brname",
            "paramname"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get bridge %s %s\""
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "paramname",
            "\"forward_delay\""
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "paramname",
            "\"stp_state\""
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to get bridge %s %s\")",
            "brname",
            "paramname"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCDEVPRIVATE",
            "ifr"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "brname",
            "&ifr"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Unable to get bridge %s %s\")",
            "brname",
            "paramname"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ul",
          "args": [
            "valuestr",
            "NULL",
            "10",
            "value"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "VIR_INT64_STR_BUFLEN",
            "&valuestr"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeGet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long *value)   /* current value */\n{\n    struct ifreq ifr;\n    g_autofree char *path = NULL;\n    VIR_AUTOCLOSE fd = -1;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = NULL;\n\n        if (virFileReadAll(path, VIR_INT64_STR_BUFLEN,\n                           &valuestr) < 0)\n            return -1;\n\n        if (virStrToLong_ul(valuestr, NULL, 10, value) < 0) {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"),\n                                 brname, paramname);\n            return -1;\n        }\n    } else {\n        struct __bridge_info info;\n        unsigned long args[] = { BRCTL_GET_BRIDGE_INFO, (unsigned long)&info, 0, 0 };\n\n        if ((fd = virNetDevSetupControl(brname, &ifr)) < 0)\n            return -1;\n\n        ifr.ifr_data = (char*)&args;\n        if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n\n        if (STREQ(paramname, \"stp_state\")) {\n            *value = info.stp_enabled;\n        } else if (STREQ(paramname, \"forward_delay\")) {\n            *value = info.forward_delay;\n        } else {\n            virReportSystemError(EINVAL,\n                                 _(\"Unable to get bridge %s %s\"), brname, paramname);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "115-153",
    "snippet": "static int virNetDevBridgeSet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long value,    /* new value */\n                              int fd,                 /* control socket */\n                              struct ifreq *ifr)      /* pre-filled bridge name */\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = g_strdup_printf(\"%lu\", value);\n        if (virFileWriteStr(path, valuestr, 0) >= 0)\n            return 0;\n        VIR_DEBUG(\"Unable to set bridge %s %s via sysfs\", brname, paramname);\n    }\n\n    unsigned long paramid;\n    if (STREQ(paramname, \"stp_state\")) {\n        paramid = BRCTL_SET_BRIDGE_STP_STATE;\n    } else if (STREQ(paramname, \"forward_delay\")) {\n        paramid = BRCTL_SET_BRIDGE_FORWARD_DELAY;\n    } else {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n    unsigned long args[] = { paramid, value, 0, 0 };\n    ifr->ifr_data = (char*)&args;\n    if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to set bridge %s %s via ioctl\")",
            "brname",
            "paramname"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to set bridge %s %s via ioctl\""
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCDEVPRIVATE",
            "ifr"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Unable to set bridge %s %s via ioctl\")",
            "brname",
            "paramname"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "paramname",
            "\"forward_delay\""
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "paramname",
            "\"stp_state\""
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Unable to set bridge %s %s via sysfs\"",
            "brname",
            "paramname"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileWriteStr",
          "args": [
            "path",
            "valuestr",
            "0"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "virFileWriteStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1502-1524",
          "snippet": "int\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeSet(const char *brname,\n                              const char *paramname,  /* sysfs param name */\n                              unsigned long value,    /* new value */\n                              int fd,                 /* control socket */\n                              struct ifreq *ifr)      /* pre-filled bridge name */\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_NET_DIR \"%s/bridge/%s\", brname, paramname);\n\n    if (virFileExists(path)) {\n        g_autofree char *valuestr = g_strdup_printf(\"%lu\", value);\n        if (virFileWriteStr(path, valuestr, 0) >= 0)\n            return 0;\n        VIR_DEBUG(\"Unable to set bridge %s %s via sysfs\", brname, paramname);\n    }\n\n    unsigned long paramid;\n    if (STREQ(paramname, \"stp_state\")) {\n        paramid = BRCTL_SET_BRIDGE_STP_STATE;\n    } else if (STREQ(paramname, \"forward_delay\")) {\n        paramid = BRCTL_SET_BRIDGE_FORWARD_DELAY;\n    } else {\n        virReportSystemError(EINVAL,\n                             _(\"Unable to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n    unsigned long args[] = { paramid, value, 0, 0 };\n    ifr->ifr_data = (char*)&args;\n    if (ioctl(fd, SIOCDEVPRIVATE, ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to set bridge %s %s via ioctl\"),\n                             brname, paramname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBridgeCmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
    "lines": "75-103",
    "snippet": "static int virNetDevBridgeCmd(const char *brname,\n                              u_long op,\n                              void *arg,\n                              size_t argsize)\n{\n    struct ifdrv ifd;\n    VIR_AUTOCLOSE s = -1;\n\n    memset(&ifd, 0, sizeof(ifd));\n\n    if ((s = socket(AF_LOCAL, SOCK_DGRAM, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(ifd.ifd_name, brname) < 0) {\n       virReportSystemError(ERANGE,\n                            _(\"Network interface name '%s' is too long\"),\n                            brname);\n       return -1;\n    }\n\n    ifd.ifd_cmd = op;\n    ifd.ifd_len = argsize;\n    ifd.ifd_data = arg;\n\n    return ioctl(s, SIOCSDRVSPEC, &ifd);\n}",
    "includes": [
      "# include <net/if_bridgevar.h>",
      "# include <net/ethernet.h>",
      "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
      "# include <linux/in6.h>",
      "# include <linux/param.h>     /* HZ                 */",
      "# include <linux/sockios.h>",
      "#  include \"virnetlink.h\"",
      "# include <net/if.h>",
      "#include \"virsocket.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "s",
            "SIOCSDRVSPEC",
            "&ifd"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ERANGE",
            "_(\"Network interface name '%s' is too long\")",
            "brname"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Network interface name '%s' is too long\""
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "ifd.ifd_name",
            "brname"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Cannot open network interface control socket\")"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "AF_LOCAL",
            "SOCK_DGRAM",
            "0"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "vir_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "351-367",
          "snippet": "int\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ifd",
            "0",
            "sizeof(ifd)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nstatic int virNetDevBridgeCmd(const char *brname,\n                              u_long op,\n                              void *arg,\n                              size_t argsize)\n{\n    struct ifdrv ifd;\n    VIR_AUTOCLOSE s = -1;\n\n    memset(&ifd, 0, sizeof(ifd));\n\n    if ((s = socket(AF_LOCAL, SOCK_DGRAM, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(ifd.ifd_name, brname) < 0) {\n       virReportSystemError(ERANGE,\n                            _(\"Network interface name '%s' is too long\"),\n                            brname);\n       return -1;\n    }\n\n    ifd.ifd_cmd = op;\n    ifd.ifd_len = argsize;\n    ifd.ifd_data = arg;\n\n    return ioctl(s, SIOCSDRVSPEC, &ifd);\n}"
  }
]