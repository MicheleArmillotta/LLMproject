[
  {
    "function_name": "virCgroupBackendForController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
    "lines": "76-90",
    "snippet": "virCgroupBackendPtr\nvirCgroupBackendForController(virCgroupPtr group,\n                              unsigned int controller)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->hasController(group, controller)) {\n            return group->backends[i];\n        }\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group->backends[i]->hasController",
          "args": [
            "group",
            "controller"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nvirCgroupBackendPtr\nvirCgroupBackendForController(virCgroupPtr group,\n                              unsigned int controller)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->hasController(group, controller)) {\n            return group->backends[i];\n        }\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virCgroupBackendGetAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
    "lines": "64-73",
    "snippet": "virCgroupBackendPtr *\nvirCgroupBackendGetAll(void)\n{\n    if (virOnce(&virCgroupBackendOnce, virCgroupBackendOnceInit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize cgroup backend.\"));\n        return NULL;\n    }\n    return virCgroupBackends;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virOnceControl virCgroupBackendOnce = VIR_ONCE_CONTROL_INITIALIZER;",
      "static virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to initialize cgroup backend.\")"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to initialize cgroup backend.\""
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virOnce",
          "args": [
            "&virCgroupBackendOnce",
            "virCgroupBackendOnceInit"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "virOnce",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "40-43",
          "snippet": "int virOnce(virOnceControlPtr once, virOnceFunc init)\n{\n    return pthread_once(&once->once, init);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virOnce(virOnceControlPtr once, virOnceFunc init)\n{\n    return pthread_once(&once->once, init);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nstatic virOnceControl virCgroupBackendOnce = VIR_ONCE_CONTROL_INITIALIZER;\nstatic virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };\n\nvirCgroupBackendPtr *\nvirCgroupBackendGetAll(void)\n{\n    if (virOnce(&virCgroupBackendOnce, virCgroupBackendOnceInit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize cgroup backend.\"));\n        return NULL;\n    }\n    return virCgroupBackends;\n}"
  },
  {
    "function_name": "virCgroupBackendOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
    "lines": "56-61",
    "snippet": "static void\nvirCgroupBackendOnceInit(void)\n{\n    virCgroupV2Register();\n    virCgroupV1Register();\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV1Register",
          "args": [],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1Register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "2187-2191",
          "snippet": "void\nvirCgroupV1Register(void)\n{\n    VIR_INFO(\"Control groups not supported on this platform\");\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirCgroupV1Register(void)\n{\n    VIR_INFO(\"Control groups not supported on this platform\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV2Register",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV2Register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv2.c",
          "lines": "1923-1927",
          "snippet": "void\nvirCgroupV2Register(void)\n{\n    VIR_INFO(\"Control groups not supported on this platform\");\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2devices.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"virbpf.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2devices.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"virbpf.h\"\n#include \"viralloc.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirCgroupV2Register(void)\n{\n    VIR_INFO(\"Control groups not supported on this platform\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nstatic void\nvirCgroupBackendOnceInit(void)\n{\n    virCgroupV2Register();\n    virCgroupV1Register();\n}"
  },
  {
    "function_name": "virCgroupBackendRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
    "lines": "42-53",
    "snippet": "void\nvirCgroupBackendRegister(virCgroupBackendPtr backend)\n{\n    if (virCgroupBackends[backend->type]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cgroup backend '%s' already registered.\"),\n                       virCgroupBackendTypeToString(backend->type));\n        return;\n    }\n\n    virCgroupBackends[backend->type] = backend;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupv2.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cgroup backend '%s' already registered.\")",
            "virCgroupBackendTypeToString(backend->type)"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupBackendTypeToString",
          "args": [
            "backend->type"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cgroup backend '%s' already registered.\""
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nstatic virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };\n\nvoid\nvirCgroupBackendRegister(virCgroupBackendPtr backend)\n{\n    if (virCgroupBackends[backend->type]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cgroup backend '%s' already registered.\"),\n                       virCgroupBackendTypeToString(backend->type));\n        return;\n    }\n\n    virCgroupBackends[backend->type] = backend;\n}"
  }
]