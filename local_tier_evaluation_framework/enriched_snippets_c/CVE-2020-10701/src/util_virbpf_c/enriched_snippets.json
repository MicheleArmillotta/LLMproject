[
  {
    "function_name": "virBPFDeleteElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "417-423",
    "snippet": "int\nvirBPFDeleteElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFDeleteElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFUpdateElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "407-414",
    "snippet": "int\nvirBPFUpdateElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFUpdateElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFGetNextElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "397-404",
    "snippet": "int\nvirBPFGetNextElem(int mapfd G_GNUC_UNUSED,\n                  void *key G_GNUC_UNUSED,\n                  void *nextKey G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetNextElem(int mapfd G_GNUC_UNUSED,\n                  void *key G_GNUC_UNUSED,\n                  void *nextKey G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFLookupElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "387-394",
    "snippet": "int\nvirBPFLookupElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFLookupElem(int mapfd G_GNUC_UNUSED,\n                 void *key G_GNUC_UNUSED,\n                 void *val G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFGetMapInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "378-384",
    "snippet": "int\nvirBPFGetMapInfo(int mapfd G_GNUC_UNUSED,\n                 struct bpf_map_info *info G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetMapInfo(int mapfd G_GNUC_UNUSED,\n                 struct bpf_map_info *info G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFGetMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "370-375",
    "snippet": "int\nvirBPFGetMap(unsigned int id G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetMap(unsigned int id G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFGetProgInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "360-367",
    "snippet": "int\nvirBPFGetProgInfo(int progfd G_GNUC_UNUSED,\n                  struct bpf_prog_info *info G_GNUC_UNUSED,\n                  unsigned int **mapIDs G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetProgInfo(int progfd G_GNUC_UNUSED,\n                  struct bpf_prog_info *info G_GNUC_UNUSED,\n                  unsigned int **mapIDs G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFGetProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "352-357",
    "snippet": "int\nvirBPFGetProg(unsigned int id G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetProg(unsigned int id G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFQueryProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "340-349",
    "snippet": "int\nvirBPFQueryProg(int targetfd G_GNUC_UNUSED,\n                unsigned int maxprogids G_GNUC_UNUSED,\n                int attachType G_GNUC_UNUSED,\n                unsigned int *progcnt G_GNUC_UNUSED,\n                void *progids G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFQueryProg(int targetfd G_GNUC_UNUSED,\n                unsigned int maxprogids G_GNUC_UNUSED,\n                int attachType G_GNUC_UNUSED,\n                unsigned int *progcnt G_GNUC_UNUSED,\n                void *progids G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFDetachProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "330-337",
    "snippet": "int\nvirBPFDetachProg(int progfd G_GNUC_UNUSED,\n                 int targetfd G_GNUC_UNUSED,\n                 int attachType G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFDetachProg(int progfd G_GNUC_UNUSED,\n                 int targetfd G_GNUC_UNUSED,\n                 int attachType G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFAttachProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "320-327",
    "snippet": "int\nvirBPFAttachProg(int progfd G_GNUC_UNUSED,\n                 int targetfd G_GNUC_UNUSED,\n                 int attachType G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFAttachProg(int progfd G_GNUC_UNUSED,\n                 int targetfd G_GNUC_UNUSED,\n                 int attachType G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFLoadProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "310-317",
    "snippet": "int\nvirBPFLoadProg(struct bpf_insn *insns G_GNUC_UNUSED,\n               int progType G_GNUC_UNUSED,\n               unsigned int insnCnt G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFLoadProg(struct bpf_insn *insns G_GNUC_UNUSED,\n               int progType G_GNUC_UNUSED,\n               unsigned int insnCnt G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFCreateMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "299-307",
    "snippet": "int\nvirBPFCreateMap(unsigned int mapType G_GNUC_UNUSED,\n                unsigned int keySize G_GNUC_UNUSED,\n                unsigned int valSize G_GNUC_UNUSED,\n                unsigned int maxEntries G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFCreateMap(unsigned int mapType G_GNUC_UNUSED,\n                unsigned int keySize G_GNUC_UNUSED,\n                unsigned int valSize G_GNUC_UNUSED,\n                unsigned int maxEntries G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virBPFDeleteElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "281-293",
    "snippet": "int\nvirBPFDeleteElem(int mapfd,\n                 void *key)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_fd = mapfd;\n    attr.key = (uintptr_t)key;\n\n    return syscall(SYS_bpf, BPF_MAP_DELETE_ELEM, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_MAP_DELETE_ELEM",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFDeleteElem(int mapfd,\n                 void *key)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_fd = mapfd;\n    attr.key = (uintptr_t)key;\n\n    return syscall(SYS_bpf, BPF_MAP_DELETE_ELEM, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFUpdateElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "264-278",
    "snippet": "int\nvirBPFUpdateElem(int mapfd,\n                 void *key,\n                 void *val)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_fd = mapfd;\n    attr.key = (uintptr_t)key;\n    attr.value = (uintptr_t)val;\n\n    return syscall(SYS_bpf, BPF_MAP_UPDATE_ELEM, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_MAP_UPDATE_ELEM",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFUpdateElem(int mapfd,\n                 void *key,\n                 void *val)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_fd = mapfd;\n    attr.key = (uintptr_t)key;\n    attr.value = (uintptr_t)val;\n\n    return syscall(SYS_bpf, BPF_MAP_UPDATE_ELEM, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFGetNextElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "247-261",
    "snippet": "int\nvirBPFGetNextElem(int mapfd,\n                  void *key,\n                  void *nextKey)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_fd = mapfd;\n    attr.key = (uintptr_t)key;\n    attr.next_key = (uintptr_t)nextKey;\n\n    return syscall(SYS_bpf, BPF_MAP_GET_NEXT_KEY, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_MAP_GET_NEXT_KEY",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetNextElem(int mapfd,\n                  void *key,\n                  void *nextKey)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_fd = mapfd;\n    attr.key = (uintptr_t)key;\n    attr.next_key = (uintptr_t)nextKey;\n\n    return syscall(SYS_bpf, BPF_MAP_GET_NEXT_KEY, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFLookupElem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "230-244",
    "snippet": "int\nvirBPFLookupElem(int mapfd,\n                 void *key,\n                 void *val)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_fd = mapfd;\n    attr.key = (uintptr_t)key;\n    attr.value = (uintptr_t)val;\n\n    return syscall(SYS_bpf, BPF_MAP_LOOKUP_ELEM, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_MAP_LOOKUP_ELEM",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFLookupElem(int mapfd,\n                 void *key,\n                 void *val)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_fd = mapfd;\n    attr.key = (uintptr_t)key;\n    attr.value = (uintptr_t)val;\n\n    return syscall(SYS_bpf, BPF_MAP_LOOKUP_ELEM, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFGetMapInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "214-227",
    "snippet": "int\nvirBPFGetMapInfo(int mapfd,\n                 struct bpf_map_info *info)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.info.bpf_fd = mapfd;\n    attr.info.info_len = sizeof(struct bpf_map_info);\n    attr.info.info = (uintptr_t)info;\n\n    return syscall(SYS_bpf, BPF_OBJ_GET_INFO_BY_FD, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_OBJ_GET_INFO_BY_FD",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetMapInfo(int mapfd,\n                 struct bpf_map_info *info)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.info.bpf_fd = mapfd;\n    attr.info.info_len = sizeof(struct bpf_map_info);\n    attr.info.info = (uintptr_t)info;\n\n    return syscall(SYS_bpf, BPF_OBJ_GET_INFO_BY_FD, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFGetMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "201-211",
    "snippet": "int\nvirBPFGetMap(unsigned int id)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_id = id;\n\n    return syscall(SYS_bpf, BPF_MAP_GET_FD_BY_ID, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_MAP_GET_FD_BY_ID",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetMap(unsigned int id)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_id = id;\n\n    return syscall(SYS_bpf, BPF_MAP_GET_FD_BY_ID, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFGetProgInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "157-198",
    "snippet": "int\nvirBPFGetProgInfo(int progfd,\n                  struct bpf_prog_info *info,\n                  unsigned int **mapIDs)\n{\n    union bpf_attr attr;\n    int rc;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.info.bpf_fd = progfd;\n    attr.info.info_len = sizeof(struct bpf_prog_info);\n    attr.info.info = (uintptr_t)info;\n\n    rc = syscall(SYS_bpf, BPF_OBJ_GET_INFO_BY_FD, &attr, sizeof(attr));\n    if (rc < 0)\n        return rc;\n\n    if (mapIDs && info->nr_map_ids > 0) {\n        unsigned int maplen = info->nr_map_ids;\n        g_autofree unsigned int *retmapIDs = NULL;\n\n        retmapIDs = g_new0(unsigned int, maplen);\n\n        memset(info, 0, sizeof(struct bpf_prog_info));\n        info->nr_map_ids = maplen;\n        info->map_ids = (uintptr_t)retmapIDs;\n\n        memset(&attr, 0, sizeof(attr));\n        attr.info.bpf_fd = progfd;\n        attr.info.info_len = sizeof(struct bpf_prog_info);\n        attr.info.info = (uintptr_t)info;\n\n        rc = syscall(SYS_bpf, BPF_OBJ_GET_INFO_BY_FD, &attr, sizeof(attr));\n        if (rc < 0)\n            return rc;\n\n        *mapIDs = g_steal_pointer(&retmapIDs);\n    }\n\n    return rc;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&retmapIDs"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_OBJ_GET_INFO_BY_FD",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(struct bpf_prog_info)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "unsignedint",
            "maplen"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_OBJ_GET_INFO_BY_FD",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetProgInfo(int progfd,\n                  struct bpf_prog_info *info,\n                  unsigned int **mapIDs)\n{\n    union bpf_attr attr;\n    int rc;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.info.bpf_fd = progfd;\n    attr.info.info_len = sizeof(struct bpf_prog_info);\n    attr.info.info = (uintptr_t)info;\n\n    rc = syscall(SYS_bpf, BPF_OBJ_GET_INFO_BY_FD, &attr, sizeof(attr));\n    if (rc < 0)\n        return rc;\n\n    if (mapIDs && info->nr_map_ids > 0) {\n        unsigned int maplen = info->nr_map_ids;\n        g_autofree unsigned int *retmapIDs = NULL;\n\n        retmapIDs = g_new0(unsigned int, maplen);\n\n        memset(info, 0, sizeof(struct bpf_prog_info));\n        info->nr_map_ids = maplen;\n        info->map_ids = (uintptr_t)retmapIDs;\n\n        memset(&attr, 0, sizeof(attr));\n        attr.info.bpf_fd = progfd;\n        attr.info.info_len = sizeof(struct bpf_prog_info);\n        attr.info.info = (uintptr_t)info;\n\n        rc = syscall(SYS_bpf, BPF_OBJ_GET_INFO_BY_FD, &attr, sizeof(attr));\n        if (rc < 0)\n            return rc;\n\n        *mapIDs = g_steal_pointer(&retmapIDs);\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virBPFGetProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "144-154",
    "snippet": "int\nvirBPFGetProg(unsigned int id)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.prog_id = id;\n\n    return syscall(SYS_bpf, BPF_PROG_GET_FD_BY_ID, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_PROG_GET_FD_BY_ID",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFGetProg(unsigned int id)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.prog_id = id;\n\n    return syscall(SYS_bpf, BPF_PROG_GET_FD_BY_ID, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFQueryProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "118-141",
    "snippet": "int\nvirBPFQueryProg(int targetfd,\n                unsigned int maxprogids,\n                int attachType,\n                unsigned int *progcnt,\n                void *progids)\n{\n    union bpf_attr attr;\n    int rc;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.query.target_fd = targetfd;\n    attr.query.attach_type = attachType;\n    attr.query.prog_cnt = maxprogids;\n    attr.query.prog_ids = (uintptr_t)progids;\n\n    rc = syscall(SYS_bpf, BPF_PROG_QUERY, &attr, sizeof(attr));\n\n    if (rc >= 0)\n        *progcnt = attr.query.prog_cnt;\n\n    return rc;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_PROG_QUERY",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFQueryProg(int targetfd,\n                unsigned int maxprogids,\n                int attachType,\n                unsigned int *progcnt,\n                void *progids)\n{\n    union bpf_attr attr;\n    int rc;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.query.target_fd = targetfd;\n    attr.query.attach_type = attachType;\n    attr.query.prog_cnt = maxprogids;\n    attr.query.prog_ids = (uintptr_t)progids;\n\n    rc = syscall(SYS_bpf, BPF_PROG_QUERY, &attr, sizeof(attr));\n\n    if (rc >= 0)\n        *progcnt = attr.query.prog_cnt;\n\n    return rc;\n}"
  },
  {
    "function_name": "virBPFDetachProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "101-115",
    "snippet": "int\nvirBPFDetachProg(int progfd,\n                 int targetfd,\n                 int attachType)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.target_fd = targetfd;\n    attr.attach_bpf_fd = progfd;\n    attr.attach_type = attachType;\n\n    return syscall(SYS_bpf, BPF_PROG_DETACH, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_PROG_DETACH",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFDetachProg(int progfd,\n                 int targetfd,\n                 int attachType)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.target_fd = targetfd;\n    attr.attach_bpf_fd = progfd;\n    attr.attach_type = attachType;\n\n    return syscall(SYS_bpf, BPF_PROG_DETACH, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFAttachProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "84-98",
    "snippet": "int\nvirBPFAttachProg(int progfd,\n                 int targetfd,\n                 int attachType)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.target_fd = targetfd;\n    attr.attach_bpf_fd = progfd;\n    attr.attach_type = attachType;\n\n    return syscall(SYS_bpf, BPF_PROG_ATTACH, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_PROG_ATTACH",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFAttachProg(int progfd,\n                 int targetfd,\n                 int attachType)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.target_fd = targetfd;\n    attr.attach_bpf_fd = progfd;\n    attr.attach_type = attachType;\n\n    return syscall(SYS_bpf, BPF_PROG_ATTACH, &attr, sizeof(attr));\n}"
  },
  {
    "function_name": "virBPFLoadProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "54-81",
    "snippet": "int\nvirBPFLoadProg(struct bpf_insn *insns,\n               int progType,\n               unsigned int insnCnt)\n{\n    g_autofree char *logbuf = NULL;\n    int progfd = -1;\n    union bpf_attr attr;\n\n    logbuf = g_new0(char, LOG_BUF_SIZE);\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.prog_type = progType;\n    attr.insn_cnt = insnCnt;\n    attr.insns = (uintptr_t)insns;\n    attr.license = (uintptr_t)\"GPL\";\n    attr.log_buf = (uintptr_t)logbuf;\n    attr.log_size = LOG_BUF_SIZE;\n    attr.log_level = 1;\n\n    progfd = syscall(SYS_bpf, BPF_PROG_LOAD, &attr, sizeof(attr));\n\n    if (progfd < 0)\n        VIR_DEBUG(\"%s\", logbuf);\n\n    return progfd;\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"%s\"",
            "logbuf"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_PROG_LOAD",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "char",
            "LOG_BUF_SIZE"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFLoadProg(struct bpf_insn *insns,\n               int progType,\n               unsigned int insnCnt)\n{\n    g_autofree char *logbuf = NULL;\n    int progfd = -1;\n    union bpf_attr attr;\n\n    logbuf = g_new0(char, LOG_BUF_SIZE);\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.prog_type = progType;\n    attr.insn_cnt = insnCnt;\n    attr.insns = (uintptr_t)insns;\n    attr.license = (uintptr_t)\"GPL\";\n    attr.log_buf = (uintptr_t)logbuf;\n    attr.log_size = LOG_BUF_SIZE;\n    attr.log_level = 1;\n\n    progfd = syscall(SYS_bpf, BPF_PROG_LOAD, &attr, sizeof(attr));\n\n    if (progfd < 0)\n        VIR_DEBUG(\"%s\", logbuf);\n\n    return progfd;\n}"
  },
  {
    "function_name": "virBPFCreateMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbpf.c",
    "lines": "33-49",
    "snippet": "int\nvirBPFCreateMap(unsigned int mapType,\n                unsigned int keySize,\n                unsigned int valSize,\n                unsigned int maxEntries)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_type = mapType;\n    attr.key_size = keySize;\n    attr.value_size = valSize;\n    attr.max_entries = maxEntries;\n\n    return syscall(SYS_bpf, BPF_MAP_CREATE, &attr, sizeof(attr));\n}",
    "includes": [
      "# include <unistd.h>",
      "# include <sys/syscall.h>",
      "#include \"virbpf.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_bpf",
            "BPF_MAP_CREATE",
            "&attr",
            "sizeof(attr)"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&attr",
            "0",
            "sizeof(attr)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <unistd.h>\n# include <sys/syscall.h>\n#include \"virbpf.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirBPFCreateMap(unsigned int mapType,\n                unsigned int keySize,\n                unsigned int valSize,\n                unsigned int maxEntries)\n{\n    union bpf_attr attr;\n\n    memset(&attr, 0, sizeof(attr));\n\n    attr.map_type = mapType;\n    attr.key_size = keySize;\n    attr.value_size = valSize;\n    attr.max_entries = maxEntries;\n\n    return syscall(SYS_bpf, BPF_MAP_CREATE, &attr, sizeof(attr));\n}"
  }
]