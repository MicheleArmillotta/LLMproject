[
  {
    "function_name": "virDomainListCheckpoints",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "203-243",
    "snippet": "int\nvirDomainListCheckpoints(virDomainCheckpointObjListPtr checkpoints,\n                         virDomainMomentObjPtr from,\n                         virDomainPtr dom,\n                         virDomainCheckpointPtr **chks,\n                         unsigned int flags)\n{\n    int count = virDomainCheckpointObjListGetNames(checkpoints, from, NULL,\n                                                   0, flags);\n    virDomainCheckpointPtr *list = NULL;\n    char **names;\n    int ret = -1;\n    size_t i;\n\n    if (!chks || count < 0)\n        return count;\n    if (VIR_ALLOC_N(names, count) < 0 ||\n        VIR_ALLOC_N(list, count + 1) < 0)\n        goto cleanup;\n\n    if (virDomainCheckpointObjListGetNames(checkpoints, from, names, count,\n                                           flags) < 0)\n        goto cleanup;\n    for (i = 0; i < count; i++)\n        if ((list[i] = virGetDomainCheckpoint(dom, names[i])) == NULL)\n            goto cleanup;\n\n    ret = count;\n    *chks = list;\n\n cleanup:\n    for (i = 0; i < count; i++)\n        VIR_FREE(names[i]);\n    VIR_FREE(names);\n    if (ret < 0 && list) {\n        for (i = 0; i < count; i++)\n            virObjectUnref(list[i]);\n        VIR_FREE(list);\n    }\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "list[i]"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "names"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "names[i]"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetDomainCheckpoint",
          "args": [
            "dom",
            "names[i]"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomainCheckpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "966-989",
          "snippet": "virDomainCheckpointPtr\nvirGetDomainCheckpoint(virDomainPtr domain,\n                       const char *name)\n{\n    virDomainCheckpointPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainCheckpointClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainCheckpointClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainCheckpointClass;\n\nvirDomainCheckpointPtr\nvirGetDomainCheckpoint(virDomainPtr domain,\n                       const char *name)\n{\n    virDomainCheckpointPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainCheckpointClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCheckpointObjListGetNames",
          "args": [
            "checkpoints",
            "from",
            "names",
            "count",
            "flags"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCheckpointObjListGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
          "lines": "86-106",
          "snippet": "static int\nvirDomainCheckpointObjListGetNames(virDomainCheckpointObjListPtr checkpoints,\n                                   virDomainMomentObjPtr from,\n                                   char **const names,\n                                   int maxnames,\n                                   unsigned int flags)\n{\n    /* We intentionally chose our public flags to match the common flags */\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_ROOTS ==\n           (int) VIR_DOMAIN_MOMENT_LIST_ROOTS);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_TOPOLOGICAL ==\n           (int) VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_LEAVES);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_NO_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_NO_LEAVES);\n\n    return virDomainMomentObjListGetNames(checkpoints->base, from, names,\n                                          maxnames, flags,\n                                          virDomainCheckpointFilter, 0);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointObjListGetNames(virDomainCheckpointObjListPtr checkpoints,\n                                   virDomainMomentObjPtr from,\n                                   char **const names,\n                                   int maxnames,\n                                   unsigned int flags)\n{\n    /* We intentionally chose our public flags to match the common flags */\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_ROOTS ==\n           (int) VIR_DOMAIN_MOMENT_LIST_ROOTS);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_TOPOLOGICAL ==\n           (int) VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_LEAVES);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_NO_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_NO_LEAVES);\n\n    return virDomainMomentObjListGetNames(checkpoints->base, from, names,\n                                          maxnames, flags,\n                                          virDomainCheckpointFilter, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "list",
            "count + 1"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "names",
            "count"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainListCheckpoints(virDomainCheckpointObjListPtr checkpoints,\n                         virDomainMomentObjPtr from,\n                         virDomainPtr dom,\n                         virDomainCheckpointPtr **chks,\n                         unsigned int flags)\n{\n    int count = virDomainCheckpointObjListGetNames(checkpoints, from, NULL,\n                                                   0, flags);\n    virDomainCheckpointPtr *list = NULL;\n    char **names;\n    int ret = -1;\n    size_t i;\n\n    if (!chks || count < 0)\n        return count;\n    if (VIR_ALLOC_N(names, count) < 0 ||\n        VIR_ALLOC_N(list, count + 1) < 0)\n        goto cleanup;\n\n    if (virDomainCheckpointObjListGetNames(checkpoints, from, names, count,\n                                           flags) < 0)\n        goto cleanup;\n    for (i = 0; i < count; i++)\n        if ((list[i] = virGetDomainCheckpoint(dom, names[i])) == NULL)\n            goto cleanup;\n\n    ret = count;\n    *chks = list;\n\n cleanup:\n    for (i = 0; i < count; i++)\n        VIR_FREE(names[i]);\n    VIR_FREE(names);\n    if (ret < 0 && list) {\n        for (i = 0; i < count; i++)\n            virObjectUnref(list[i]);\n        VIR_FREE(list);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virDomainCheckpointCheckCycles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "194-200",
    "snippet": "int\nvirDomainCheckpointCheckCycles(virDomainCheckpointObjListPtr checkpoints,\n                               virDomainCheckpointDefPtr def,\n                               const char *domname)\n{\n    return virDomainMomentCheckCycles(checkpoints->base, &def->parent, domname);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentCheckCycles",
          "args": [
            "checkpoints->base",
            "&def->parent",
            "domname"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentCheckCycles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "550-587",
          "snippet": "int\nvirDomainMomentCheckCycles(virDomainMomentObjListPtr list,\n                           virDomainMomentDefPtr def,\n                           const char *domname)\n{\n    virDomainMomentObjPtr other;\n\n    if (def->parent_name) {\n        if (STREQ(def->name, def->parent_name)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"cannot set moment %s as its own parent\"),\n                           def->name);\n            return -1;\n        }\n        other = virDomainMomentFindByName(list, def->parent_name);\n        if (!other) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"parent %s for moment %s not found\"),\n                           def->parent_name, def->name);\n            return -1;\n        }\n        while (other->def->parent_name) {\n            if (STREQ(other->def->parent_name, def->name)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parent %s would create cycle to %s\"),\n                               other->def->name, def->name);\n                return -1;\n            }\n            other = virDomainMomentFindByName(list, other->def->parent_name);\n            if (!other) {\n                VIR_WARN(\"moments are inconsistent for domain %s\",\n                         domname);\n                break;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentCheckCycles(virDomainMomentObjListPtr list,\n                           virDomainMomentDefPtr def,\n                           const char *domname)\n{\n    virDomainMomentObjPtr other;\n\n    if (def->parent_name) {\n        if (STREQ(def->name, def->parent_name)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"cannot set moment %s as its own parent\"),\n                           def->name);\n            return -1;\n        }\n        other = virDomainMomentFindByName(list, def->parent_name);\n        if (!other) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"parent %s for moment %s not found\"),\n                           def->parent_name, def->name);\n            return -1;\n        }\n        while (other->def->parent_name) {\n            if (STREQ(other->def->parent_name, def->name)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parent %s would create cycle to %s\"),\n                               other->def->name, def->name);\n                return -1;\n            }\n            other = virDomainMomentFindByName(list, other->def->parent_name);\n            if (!other) {\n                VIR_WARN(\"moments are inconsistent for domain %s\",\n                         domname);\n                break;\n            }\n        }\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainCheckpointCheckCycles(virDomainCheckpointObjListPtr checkpoints,\n                               virDomainCheckpointDefPtr def,\n                               const char *domname)\n{\n    return virDomainMomentCheckCycles(checkpoints->base, &def->parent, domname);\n}"
  },
  {
    "function_name": "virDomainCheckpointUpdateRelations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "182-191",
    "snippet": "int\nvirDomainCheckpointUpdateRelations(virDomainCheckpointObjListPtr checkpoints,\n                                   virDomainMomentObjPtr *leaf)\n{\n    int ret = virDomainMomentUpdateRelations(checkpoints->base);\n\n    if (ret == 0)\n        *leaf = virDomainMomentFindLeaf(checkpoints->base);\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentFindLeaf",
          "args": [
            "checkpoints->base"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentFindLeaf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "590-602",
          "snippet": "virDomainMomentObjPtr\nvirDomainMomentFindLeaf(virDomainMomentObjListPtr list)\n{\n    virDomainMomentObjPtr moment = &list->metaroot;\n\n    if (moment->nchildren != 1)\n        return NULL;\n    while (moment->nchildren == 1)\n        moment = moment->first_child;\n    if (moment->nchildren == 0)\n        return moment;\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentFindLeaf(virDomainMomentObjListPtr list)\n{\n    virDomainMomentObjPtr moment = &list->metaroot;\n\n    if (moment->nchildren != 1)\n        return NULL;\n    while (moment->nchildren == 1)\n        moment = moment->first_child;\n    if (moment->nchildren == 0)\n        return moment;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMomentUpdateRelations",
          "args": [
            "checkpoints->base"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentUpdateRelations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "533-543",
          "snippet": "int\nvirDomainMomentUpdateRelations(virDomainMomentObjListPtr moments)\n{\n    struct moment_set_relation act = { moments, 0 };\n\n    virDomainMomentDropChildren(&moments->metaroot);\n    virHashForEach(moments->objs, virDomainMomentSetRelations, &act);\n    if (act.err)\n        moments->current = NULL;\n    return act.err;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentUpdateRelations(virDomainMomentObjListPtr moments)\n{\n    struct moment_set_relation act = { moments, 0 };\n\n    virDomainMomentDropChildren(&moments->metaroot);\n    virHashForEach(moments->objs, virDomainMomentSetRelations, &act);\n    if (act.err)\n        moments->current = NULL;\n    return act.err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainCheckpointUpdateRelations(virDomainCheckpointObjListPtr checkpoints,\n                                   virDomainMomentObjPtr *leaf)\n{\n    int ret = virDomainMomentUpdateRelations(checkpoints->base);\n\n    if (ret == 0)\n        *leaf = virDomainMomentFindLeaf(checkpoints->base);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainCheckpointLinkParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "169-174",
    "snippet": "void\nvirDomainCheckpointLinkParent(virDomainCheckpointObjListPtr checkpoints,\n                              virDomainMomentObjPtr chk)\n{\n    return virDomainMomentLinkParent(checkpoints->base, chk);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentLinkParent",
          "args": [
            "checkpoints->base",
            "chk"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentLinkParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "169-183",
          "snippet": "void\nvirDomainMomentLinkParent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr parent;\n\n    parent = virDomainMomentFindByName(moments, moment->def->parent_name);\n    if (!parent) {\n        parent = &moments->metaroot;\n        if (moment->def->parent_name)\n            VIR_WARN(\"moment %s lacks parent %s\", moment->def->name,\n                     moment->def->parent_name);\n    }\n    virDomainMomentSetParent(moment, parent);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentLinkParent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr parent;\n\n    parent = virDomainMomentFindByName(moments, moment->def->parent_name);\n    if (!parent) {\n        parent = &moments->metaroot;\n        if (moment->def->parent_name)\n            VIR_WARN(\"moment %s lacks parent %s\", moment->def->name,\n                     moment->def->parent_name);\n    }\n    virDomainMomentSetParent(moment, parent);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainCheckpointLinkParent(virDomainCheckpointObjListPtr checkpoints,\n                              virDomainMomentObjPtr chk)\n{\n    return virDomainMomentLinkParent(checkpoints->base, chk);\n}"
  },
  {
    "function_name": "virDomainCheckpointForEach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "159-165",
    "snippet": "int\nvirDomainCheckpointForEach(virDomainCheckpointObjListPtr checkpoints,\n                           virHashIterator iter,\n                           void *data)\n{\n    return virDomainMomentForEach(checkpoints->base, iter, data);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentForEach",
          "args": [
            "checkpoints->base",
            "iter",
            "data"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "475-481",
          "snippet": "int\nvirDomainMomentForEach(virDomainMomentObjListPtr moments,\n                       virHashIterator iter,\n                       void *data)\n{\n    return virHashForEach(moments->objs, iter, data);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEach(virDomainMomentObjListPtr moments,\n                       virHashIterator iter,\n                       void *data)\n{\n    return virHashForEach(moments->objs, iter, data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainCheckpointForEach(virDomainCheckpointObjListPtr checkpoints,\n                           virHashIterator iter,\n                           void *data)\n{\n    return virDomainMomentForEach(checkpoints->base, iter, data);\n}"
  },
  {
    "function_name": "virDomainCheckpointObjListRemoveAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "152-156",
    "snippet": "void\nvirDomainCheckpointObjListRemoveAll(virDomainCheckpointObjListPtr checkpoints)\n{\n    return virDomainMomentObjListRemoveAll(checkpoints->base);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentObjListRemoveAll",
          "args": [
            "checkpoints->base"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListRemoveAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "466-471",
          "snippet": "void\nvirDomainMomentObjListRemoveAll(virDomainMomentObjListPtr moments)\n{\n    virHashRemoveAll(moments->objs);\n    virDomainMomentDropChildren(&moments->metaroot);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentObjListRemoveAll(virDomainMomentObjListPtr moments)\n{\n    virHashRemoveAll(moments->objs);\n    virDomainMomentDropChildren(&moments->metaroot);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainCheckpointObjListRemoveAll(virDomainCheckpointObjListPtr checkpoints)\n{\n    return virDomainMomentObjListRemoveAll(checkpoints->base);\n}"
  },
  {
    "function_name": "virDomainCheckpointObjListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "143-148",
    "snippet": "bool\nvirDomainCheckpointObjListRemove(virDomainCheckpointObjListPtr checkpoints,\n                                 virDomainMomentObjPtr checkpoint)\n{\n    return virDomainMomentObjListRemove(checkpoints->base, checkpoint);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentObjListRemove",
          "args": [
            "checkpoints->base",
            "checkpoint"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "452-462",
          "snippet": "bool\nvirDomainMomentObjListRemove(virDomainMomentObjListPtr moments,\n                             virDomainMomentObjPtr moment)\n{\n    bool ret = moments->current == moment;\n\n    virHashRemoveEntry(moments->objs, moment->def->name);\n    if (ret)\n        moments->current = NULL;\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirDomainMomentObjListRemove(virDomainMomentObjListPtr moments,\n                             virDomainMomentObjPtr moment)\n{\n    bool ret = moments->current == moment;\n\n    virHashRemoveEntry(moments->objs, moment->def->name);\n    if (ret)\n        moments->current = NULL;\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirDomainCheckpointObjListRemove(virDomainCheckpointObjListPtr checkpoints,\n                                 virDomainMomentObjPtr checkpoint)\n{\n    return virDomainMomentObjListRemove(checkpoints->base, checkpoint);\n}"
  },
  {
    "function_name": "virDomainCheckpointSetCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "134-139",
    "snippet": "void\nvirDomainCheckpointSetCurrent(virDomainCheckpointObjListPtr checkpoints,\n                              virDomainMomentObjPtr checkpoint)\n{\n    virDomainMomentSetCurrent(checkpoints->base, checkpoint);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentSetCurrent",
          "args": [
            "checkpoints->base",
            "checkpoint"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentSetCurrent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "435-440",
          "snippet": "void\nvirDomainMomentSetCurrent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    moments->current = moment;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentSetCurrent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    moments->current = moment;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainCheckpointSetCurrent(virDomainCheckpointObjListPtr checkpoints,\n                              virDomainMomentObjPtr checkpoint)\n{\n    virDomainMomentSetCurrent(checkpoints->base, checkpoint);\n}"
  },
  {
    "function_name": "virDomainCheckpointGetCurrentName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "126-130",
    "snippet": "const char *\nvirDomainCheckpointGetCurrentName(virDomainCheckpointObjListPtr checkpoints)\n{\n    return virDomainMomentGetCurrentName(checkpoints->base);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentGetCurrentName",
          "args": [
            "checkpoints->base"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "425-431",
          "snippet": "const char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainCheckpointGetCurrentName(virDomainCheckpointObjListPtr checkpoints)\n{\n    return virDomainMomentGetCurrentName(checkpoints->base);\n}"
  },
  {
    "function_name": "virDomainCheckpointGetCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "118-122",
    "snippet": "virDomainMomentObjPtr\nvirDomainCheckpointGetCurrent(virDomainCheckpointObjListPtr checkpoints)\n{\n    return virDomainMomentGetCurrent(checkpoints->base);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentGetCurrent",
          "args": [
            "checkpoints->base"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "425-431",
          "snippet": "const char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainCheckpointGetCurrent(virDomainCheckpointObjListPtr checkpoints)\n{\n    return virDomainMomentGetCurrent(checkpoints->base);\n}"
  },
  {
    "function_name": "virDomainCheckpointFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "109-114",
    "snippet": "virDomainMomentObjPtr\nvirDomainCheckpointFindByName(virDomainCheckpointObjListPtr checkpoints,\n                              const char *name)\n{\n    return virDomainMomentFindByName(checkpoints->base, name);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentFindByName",
          "args": [
            "checkpoints->base",
            "name"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "406-413",
          "snippet": "virDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainCheckpointFindByName(virDomainCheckpointObjListPtr checkpoints,\n                              const char *name)\n{\n    return virDomainMomentFindByName(checkpoints->base, name);\n}"
  },
  {
    "function_name": "virDomainCheckpointObjListGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "86-106",
    "snippet": "static int\nvirDomainCheckpointObjListGetNames(virDomainCheckpointObjListPtr checkpoints,\n                                   virDomainMomentObjPtr from,\n                                   char **const names,\n                                   int maxnames,\n                                   unsigned int flags)\n{\n    /* We intentionally chose our public flags to match the common flags */\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_ROOTS ==\n           (int) VIR_DOMAIN_MOMENT_LIST_ROOTS);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_TOPOLOGICAL ==\n           (int) VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_LEAVES);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_NO_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_NO_LEAVES);\n\n    return virDomainMomentObjListGetNames(checkpoints->base, from, names,\n                                          maxnames, flags,\n                                          virDomainCheckpointFilter, 0);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentObjListGetNames",
          "args": [
            "checkpoints->base",
            "from",
            "names",
            "maxnames",
            "flags",
            "virDomainCheckpointFilter",
            "0"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "337-403",
          "snippet": "int\nvirDomainMomentObjListGetNames(virDomainMomentObjListPtr moments,\n                               virDomainMomentObjPtr from,\n                               char **const names,\n                               int maxnames,\n                               unsigned int flags,\n                               virDomainMomentObjListFilter filter,\n                               unsigned int filter_flags)\n{\n    struct virDomainMomentNameData data = { names, maxnames, flags, 0,\n                                            false, filter, filter_flags };\n    size_t i;\n\n    virCheckFlags(VIR_DOMAIN_MOMENT_FILTERS_ALL, -1);\n    if (!from) {\n        /* LIST_ROOTS and LIST_DESCENDANTS have the same bit value,\n         * but opposite semantics.  Toggle here to get the correct\n         * traversal on the metaroot.  */\n        flags ^= VIR_DOMAIN_MOMENT_LIST_ROOTS;\n        from = &moments->metaroot;\n    }\n\n    /* We handle LIST_ROOT/LIST_DESCENDANTS and LIST_TOPOLOGICAL directly,\n     * mask those bits out to determine when we must use the filter callback. */\n    data.flags &= ~(VIR_DOMAIN_MOMENT_LIST_DESCENDANTS |\n                    VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n\n    /* If this common code is being used, we assume that all moments\n     * have metadata, and thus can handle METADATA up front as an\n     * all-or-none filter.  XXX This might not always be true, if we\n     * add the ability to track qcow2 internal snapshots without the\n     * use of metadata, in which case this check should move into the\n     * filter callback.  */\n    if ((data.flags & VIR_DOMAIN_MOMENT_FILTERS_METADATA) ==\n        VIR_DOMAIN_MOMENT_LIST_NO_METADATA)\n        return 0;\n    data.flags &= ~VIR_DOMAIN_MOMENT_FILTERS_METADATA;\n\n    if (flags & VIR_DOMAIN_MOMENT_LIST_DESCENDANTS) {\n        /* We could just always do a topological visit; but it is\n         * possible to optimize for less stack usage and time when a\n         * simpler full hashtable visit or counter will do. */\n        if (from->def || (names &&\n                          (flags & VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL)))\n            virDomainMomentForEachDescendant(from,\n                                             virDomainMomentObjListCopyNames,\n                                             &data);\n        else if (names || data.flags || filter_flags)\n            virHashForEach(moments->objs, virDomainMomentObjListCopyNames,\n                           &data);\n        else\n            data.count = virHashSize(moments->objs);\n    } else if (names || data.flags || filter_flags) {\n        virDomainMomentForEachChild(from,\n                                    virDomainMomentObjListCopyNames, &data);\n    } else {\n        data.count = from->nchildren;\n    }\n\n    if (data.error) {\n        for (i = 0; i < data.count; i++)\n            VIR_FREE(names[i]);\n        return -1;\n    }\n\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentObjListGetNames(virDomainMomentObjListPtr moments,\n                               virDomainMomentObjPtr from,\n                               char **const names,\n                               int maxnames,\n                               unsigned int flags,\n                               virDomainMomentObjListFilter filter,\n                               unsigned int filter_flags)\n{\n    struct virDomainMomentNameData data = { names, maxnames, flags, 0,\n                                            false, filter, filter_flags };\n    size_t i;\n\n    virCheckFlags(VIR_DOMAIN_MOMENT_FILTERS_ALL, -1);\n    if (!from) {\n        /* LIST_ROOTS and LIST_DESCENDANTS have the same bit value,\n         * but opposite semantics.  Toggle here to get the correct\n         * traversal on the metaroot.  */\n        flags ^= VIR_DOMAIN_MOMENT_LIST_ROOTS;\n        from = &moments->metaroot;\n    }\n\n    /* We handle LIST_ROOT/LIST_DESCENDANTS and LIST_TOPOLOGICAL directly,\n     * mask those bits out to determine when we must use the filter callback. */\n    data.flags &= ~(VIR_DOMAIN_MOMENT_LIST_DESCENDANTS |\n                    VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n\n    /* If this common code is being used, we assume that all moments\n     * have metadata, and thus can handle METADATA up front as an\n     * all-or-none filter.  XXX This might not always be true, if we\n     * add the ability to track qcow2 internal snapshots without the\n     * use of metadata, in which case this check should move into the\n     * filter callback.  */\n    if ((data.flags & VIR_DOMAIN_MOMENT_FILTERS_METADATA) ==\n        VIR_DOMAIN_MOMENT_LIST_NO_METADATA)\n        return 0;\n    data.flags &= ~VIR_DOMAIN_MOMENT_FILTERS_METADATA;\n\n    if (flags & VIR_DOMAIN_MOMENT_LIST_DESCENDANTS) {\n        /* We could just always do a topological visit; but it is\n         * possible to optimize for less stack usage and time when a\n         * simpler full hashtable visit or counter will do. */\n        if (from->def || (names &&\n                          (flags & VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL)))\n            virDomainMomentForEachDescendant(from,\n                                             virDomainMomentObjListCopyNames,\n                                             &data);\n        else if (names || data.flags || filter_flags)\n            virHashForEach(moments->objs, virDomainMomentObjListCopyNames,\n                           &data);\n        else\n            data.count = virHashSize(moments->objs);\n    } else if (names || data.flags || filter_flags) {\n        virDomainMomentForEachChild(from,\n                                    virDomainMomentObjListCopyNames, &data);\n    } else {\n        data.count = from->nchildren;\n    }\n\n    if (data.error) {\n        for (i = 0; i < data.count; i++)\n            VIR_FREE(names[i]);\n        return -1;\n    }\n\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_STATIC_ASSERT",
          "args": [
            "VIR_DOMAIN_CHECKPOINT_LIST_NO_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_NO_LEAVES"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_STATIC_ASSERT",
          "args": [
            "VIR_DOMAIN_CHECKPOINT_LIST_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_LEAVES"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_STATIC_ASSERT",
          "args": [
            "VIR_DOMAIN_CHECKPOINT_LIST_TOPOLOGICAL ==\n           (int) VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_STATIC_ASSERT",
          "args": [
            "VIR_DOMAIN_CHECKPOINT_LIST_ROOTS ==\n           (int) VIR_DOMAIN_MOMENT_LIST_ROOTS"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDomainCheckpointObjListGetNames(virDomainCheckpointObjListPtr checkpoints,\n                                   virDomainMomentObjPtr from,\n                                   char **const names,\n                                   int maxnames,\n                                   unsigned int flags)\n{\n    /* We intentionally chose our public flags to match the common flags */\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_ROOTS ==\n           (int) VIR_DOMAIN_MOMENT_LIST_ROOTS);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_TOPOLOGICAL ==\n           (int) VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_LEAVES);\n    G_STATIC_ASSERT(VIR_DOMAIN_CHECKPOINT_LIST_NO_LEAVES ==\n           (int) VIR_DOMAIN_MOMENT_LIST_NO_LEAVES);\n\n    return virDomainMomentObjListGetNames(checkpoints->base, from, names,\n                                          maxnames, flags,\n                                          virDomainCheckpointFilter, 0);\n}"
  },
  {
    "function_name": "virDomainCheckpointObjListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "76-83",
    "snippet": "void\nvirDomainCheckpointObjListFree(virDomainCheckpointObjListPtr checkpoints)\n{\n    if (!checkpoints)\n        return;\n    virDomainMomentObjListFree(checkpoints->base);\n    VIR_FREE(checkpoints);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "checkpoints"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMomentObjListFree",
          "args": [
            "checkpoints->base"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "288-295",
          "snippet": "void\nvirDomainMomentObjListFree(virDomainMomentObjListPtr moments)\n{\n    if (!moments)\n        return;\n    virHashFree(moments->objs);\n    VIR_FREE(moments);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentObjListFree(virDomainMomentObjListPtr moments)\n{\n    if (!moments)\n        return;\n    virHashFree(moments->objs);\n    VIR_FREE(moments);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainCheckpointObjListFree(virDomainCheckpointObjListPtr checkpoints)\n{\n    if (!checkpoints)\n        return;\n    virDomainMomentObjListFree(checkpoints->base);\n    VIR_FREE(checkpoints);\n}"
  },
  {
    "function_name": "virDomainCheckpointObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "60-73",
    "snippet": "virDomainCheckpointObjListPtr\nvirDomainCheckpointObjListNew(void)\n{\n    virDomainCheckpointObjListPtr checkpoints;\n\n    if (VIR_ALLOC(checkpoints) < 0)\n        return NULL;\n    checkpoints->base = virDomainMomentObjListNew();\n    if (!checkpoints->base) {\n        VIR_FREE(checkpoints);\n        return NULL;\n    }\n    return checkpoints;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "checkpoints"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMomentObjListNew",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "273-286",
          "snippet": "virDomainMomentObjListPtr\nvirDomainMomentObjListNew(void)\n{\n    virDomainMomentObjListPtr moments;\n\n    if (VIR_ALLOC(moments) < 0)\n        return NULL;\n    moments->objs = virHashCreate(50, virDomainMomentObjListDataFree);\n    if (!moments->objs) {\n        VIR_FREE(moments);\n        return NULL;\n    }\n    return moments;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjListPtr\nvirDomainMomentObjListNew(void)\n{\n    virDomainMomentObjListPtr moments;\n\n    if (VIR_ALLOC(moments) < 0)\n        return NULL;\n    moments->objs = virHashCreate(50, virDomainMomentObjListDataFree);\n    if (!moments->objs) {\n        VIR_FREE(moments);\n        return NULL;\n    }\n    return moments;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "checkpoints"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainCheckpointObjListPtr\nvirDomainCheckpointObjListNew(void)\n{\n    virDomainCheckpointObjListPtr checkpoints;\n\n    if (VIR_ALLOC(checkpoints) < 0)\n        return NULL;\n    checkpoints->base = virDomainMomentObjListNew();\n    if (!checkpoints->base) {\n        VIR_FREE(checkpoints);\n        return NULL;\n    }\n    return checkpoints;\n}"
  },
  {
    "function_name": "virDomainCheckpointFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "50-57",
    "snippet": "static bool\nvirDomainCheckpointFilter(virDomainMomentObjPtr obj G_GNUC_UNUSED,\n                          unsigned int flags)\n{\n    /* For now, we have no further filters than what the common code handles. */\n    virCheckFlags(0, false);\n    return true;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "false"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirDomainCheckpointFilter(virDomainMomentObjPtr obj G_GNUC_UNUSED,\n                          unsigned int flags)\n{\n    /* For now, we have no further filters than what the common code handles. */\n    virCheckFlags(0, false);\n    return true;\n}"
  },
  {
    "function_name": "virDomainCheckpointAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomaincheckpointobjlist.c",
    "lines": "42-47",
    "snippet": "virDomainMomentObjPtr\nvirDomainCheckpointAssignDef(virDomainCheckpointObjListPtr checkpoints,\n                             virDomainCheckpointDefPtr def)\n{\n    return virDomainMomentAssignDef(checkpoints->base, &def->parent);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"checkpoint_conf.h\"",
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentAssignDef",
          "args": [
            "checkpoints->base",
            "&def->parent"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "238-261",
          "snippet": "virDomainMomentObjPtr\nvirDomainMomentAssignDef(virDomainMomentObjListPtr moments,\n                         virDomainMomentDefPtr def)\n{\n    virDomainMomentObjPtr moment;\n\n    if (virHashLookup(moments->objs, def->name) != NULL) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"domain moment %s already exists\"),\n                       def->name);\n        return NULL;\n    }\n\n    if (!(moment = virDomainMomentObjNew()))\n        return NULL;\n\n    if (virHashAddEntry(moments->objs, def->name, moment) < 0) {\n        VIR_FREE(moment);\n        return NULL;\n    }\n    moment->def = def;\n\n    return moment;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentAssignDef(virDomainMomentObjListPtr moments,\n                         virDomainMomentDefPtr def)\n{\n    virDomainMomentObjPtr moment;\n\n    if (virHashLookup(moments->objs, def->name) != NULL) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"domain moment %s already exists\"),\n                       def->name);\n        return NULL;\n    }\n\n    if (!(moment = virDomainMomentObjNew()))\n        return NULL;\n\n    if (virHashAddEntry(moments->objs, def->name, moment) < 0) {\n        VIR_FREE(moment);\n        return NULL;\n    }\n    moment->def = def;\n\n    return moment;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainCheckpointAssignDef(virDomainCheckpointObjListPtr checkpoints,\n                             virDomainCheckpointDefPtr def)\n{\n    return virDomainMomentAssignDef(checkpoints->base, &def->parent);\n}"
  }
]