[
  {
    "function_name": "vzRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "4159-4185",
    "snippet": "int\nvzRegister(void)\n{\n    char *prlctl_path;\n\n    prlctl_path = virFindFileInPath(PRLCTL);\n    if (!prlctl_path) {\n        VIR_DEBUG(\"%s\", _(\"Can't find prlctl command in the PATH env\"));\n        return 0;\n    }\n\n    VIR_FREE(prlctl_path);\n\n    /* Backward compatibility with Parallels domain type */\n    parallelsHypervisorDriver = vzHypervisorDriver;\n    parallelsHypervisorDriver.name = \"Parallels\";\n    if (virRegisterConnectDriver(&parallelsConnectDriver, true) < 0)\n        return -1;\n\n    if (virRegisterConnectDriver(&vzConnectDriver, true) < 0)\n        return -1;\n\n    if (virRegisterStateDriver(&vzStateDriver) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define PRLCTL                      \"prlctl\""
    ],
    "globals_used": [
      "static virHypervisorDriver vzHypervisorDriver = {\n    .name = \"vz\",\n    .connectOpen = vzConnectOpen,            /* 0.10.0 */\n    .connectClose = vzConnectClose,          /* 0.10.0 */\n    .connectGetVersion = vzConnectGetVersion,   /* 0.10.0 */\n    .connectGetHostname = vzConnectGetHostname,      /* 0.10.0 */\n    .connectGetSysinfo = vzConnectGetSysinfo, /* 1.3.4 */\n    .connectGetMaxVcpus = vzConnectGetMaxVcpus, /* 1.2.21 */\n    .nodeGetInfo = vzNodeGetInfo,      /* 0.10.0 */\n    .nodeGetCPUStats = vzNodeGetCPUStats,      /* 1.2.21 */\n    .nodeGetMemoryStats = vzNodeGetMemoryStats, /* 1.2.21 */\n    .nodeGetCellsFreeMemory = vzNodeGetCellsFreeMemory, /* 1.2.21 */\n    .nodeGetFreeMemory = vzNodeGetFreeMemory, /* 1.2.21 */\n    .connectGetCapabilities = vzConnectGetCapabilities,      /* 0.10.0 */\n    .connectBaselineCPU = vzConnectBaselineCPU, /* 1.2.6 */\n    .connectListDomains = vzConnectListDomains,      /* 0.10.0 */\n    .connectNumOfDomains = vzConnectNumOfDomains,    /* 0.10.0 */\n    .connectListDefinedDomains = vzConnectListDefinedDomains,        /* 0.10.0 */\n    .connectNumOfDefinedDomains = vzConnectNumOfDefinedDomains,      /* 0.10.0 */\n    .connectListAllDomains = vzConnectListAllDomains, /* 0.10.0 */\n    .domainLookupByID = vzDomainLookupByID,    /* 0.10.0 */\n    .domainLookupByUUID = vzDomainLookupByUUID,        /* 0.10.0 */\n    .domainLookupByName = vzDomainLookupByName,        /* 0.10.0 */\n    .domainGetOSType = vzDomainGetOSType,    /* 0.10.0 */\n    .domainGetInfo = vzDomainGetInfo,  /* 0.10.0 */\n    .domainGetState = vzDomainGetState,        /* 0.10.0 */\n    .domainGetXMLDesc = vzDomainGetXMLDesc,    /* 0.10.0 */\n    .domainIsPersistent = vzDomainIsPersistent,        /* 0.10.0 */\n    .domainGetAutostart = vzDomainGetAutostart,        /* 0.10.0 */\n    .domainGetVcpus = vzDomainGetVcpus, /* 1.2.6 */\n    .domainSuspend = vzDomainSuspend,    /* 0.10.0 */\n    .domainResume = vzDomainResume,    /* 0.10.0 */\n    .domainDestroy = vzDomainDestroy,  /* 0.10.0 */\n    .domainDestroyFlags = vzDomainDestroyFlags,  /* 2.2.0 */\n    .domainShutdown = vzDomainShutdown, /* 0.10.0 */\n    .domainShutdownFlags = vzDomainShutdownFlags, /* 2.2.0 */\n    .domainCreate = vzDomainCreate,    /* 0.10.0 */\n    .domainCreateWithFlags = vzDomainCreateWithFlags, /* 1.2.10 */\n    .domainReboot = vzDomainReboot, /* 1.3.0 */\n    .domainDefineXML = vzDomainDefineXML,      /* 0.10.0 */\n    .domainDefineXMLFlags = vzDomainDefineXMLFlags, /* 1.2.12 */\n    .domainUndefine = vzDomainUndefine, /* 1.2.10 */\n    .domainUndefineFlags = vzDomainUndefineFlags, /* 1.2.10 */\n    .domainAttachDevice = vzDomainAttachDevice, /* 1.2.15 */\n    .domainAttachDeviceFlags = vzDomainAttachDeviceFlags, /* 1.2.15 */\n    .domainDetachDevice = vzDomainDetachDevice, /* 1.2.15 */\n    .domainDetachDeviceFlags = vzDomainDetachDeviceFlags, /* 1.2.15 */\n    .domainIsActive = vzDomainIsActive, /* 1.2.10 */\n    .domainIsUpdated = vzDomainIsUpdated,     /* 1.2.21 */\n    .domainSetVcpus = vzDomainSetVcpus, /* 3.3.0 */\n    .domainSetVcpusFlags = vzDomainSetVcpusFlags, /* 3.3.0 */\n    .domainGetVcpusFlags = vzDomainGetVcpusFlags, /* 1.2.21 */\n    .domainGetMaxVcpus = vzDomainGetMaxVcpus, /* 1.2.21 */\n    .domainSetUserPassword = vzDomainSetUserPassword, /* 2.0.0 */\n    .connectDomainEventRegisterAny = vzConnectDomainEventRegisterAny, /* 1.2.10 */\n    .connectDomainEventDeregisterAny = vzConnectDomainEventDeregisterAny, /* 1.2.10 */\n    .nodeGetCPUMap = vzNodeGetCPUMap, /* 1.2.8 */\n    .connectIsEncrypted = vzConnectIsEncrypted, /* 1.2.5 */\n    .connectIsSecure = vzConnectIsSecure, /* 1.2.5 */\n    .connectIsAlive = vzConnectIsAlive, /* 1.2.5 */\n    .domainHasManagedSaveImage = vzDomainHasManagedSaveImage, /* 1.2.13 */\n    .domainManagedSave = vzDomainManagedSave, /* 1.2.14 */\n    .domainManagedSaveRemove = vzDomainManagedSaveRemove, /* 1.2.14 */\n    .domainGetMaxMemory = vzDomainGetMaxMemory, /* 1.2.15 */\n    .domainBlockStats = vzDomainBlockStats, /* 1.2.17 */\n    .domainBlockStatsFlags = vzDomainBlockStatsFlags, /* 1.2.17 */\n    .domainInterfaceStats = vzDomainInterfaceStats, /* 1.2.17 */\n    .domainMemoryStats = vzDomainMemoryStats, /* 1.2.17 */\n    .connectRegisterCloseCallback = vzConnectRegisterCloseCallback, /* 1.3.2 */\n    .connectUnregisterCloseCallback = vzConnectUnregisterCloseCallback, /* 1.3.2 */\n    .domainSetMemoryFlags = vzDomainSetMemoryFlags, /* 1.3.4 */\n    .domainSetMemory = vzDomainSetMemory, /* 1.3.4 */\n    .domainSnapshotNum = vzDomainSnapshotNum, /* 1.3.5 */\n    .domainSnapshotListNames = vzDomainSnapshotListNames, /* 1.3.5 */\n    .domainListAllSnapshots = vzDomainListAllSnapshots, /* 1.3.5 */\n    .domainSnapshotGetXMLDesc = vzDomainSnapshotGetXMLDesc, /* 1.3.5 */\n    .domainSnapshotNumChildren = vzDomainSnapshotNumChildren, /* 1.3.5 */\n    .domainSnapshotListChildrenNames = vzDomainSnapshotListChildrenNames, /* 1.3.5 */\n    .domainSnapshotListAllChildren = vzDomainSnapshotListAllChildren, /* 1.3.5 */\n    .domainSnapshotLookupByName = vzDomainSnapshotLookupByName, /* 1.3.5 */\n    .domainHasCurrentSnapshot = vzDomainHasCurrentSnapshot, /* 1.3.5 */\n    .domainSnapshotGetParent = vzDomainSnapshotGetParent, /* 1.3.5 */\n    .domainSnapshotCurrent = vzDomainSnapshotCurrent, /* 1.3.5 */\n    .domainSnapshotIsCurrent = vzDomainSnapshotIsCurrent, /* 1.3.5 */\n    .domainSnapshotHasMetadata = vzDomainSnapshotHasMetadata, /* 1.3.5 */\n    .domainSnapshotCreateXML = vzDomainSnapshotCreateXML, /* 1.3.5 */\n    .domainSnapshotDelete = vzDomainSnapshotDelete, /* 1.3.5 */\n    .domainRevertToSnapshot = vzDomainRevertToSnapshot, /* 1.3.5 */\n    .connectSupportsFeature = vzConnectSupportsFeature, /* 1.3.5 */\n    .domainMigrateBegin3Params = vzDomainMigrateBegin3Params, /* 1.3.5 */\n    .domainMigratePrepare3Params = vzDomainMigratePrepare3Params, /* 1.3.5 */\n    .domainMigratePerform3Params = vzDomainMigratePerform3Params, /* 1.3.5 */\n    .domainMigrateFinish3Params = vzDomainMigrateFinish3Params, /* 1.3.5 */\n    .domainMigrateConfirm3Params = vzDomainMigrateConfirm3Params, /* 1.3.5 */\n    .domainUpdateDeviceFlags = vzDomainUpdateDeviceFlags, /* 2.0.0 */\n    .domainGetJobInfo = vzDomainGetJobInfo, /* 2.2.0 */\n    .domainGetJobStats = vzDomainGetJobStats, /* 2.2.0 */\n    .connectGetAllDomainStats = vzConnectGetAllDomainStats, /* 3.1.0 */\n    .domainAbortJob = vzDomainAbortJob, /* 3.1.0 */\n    .domainReset = vzDomainReset, /* 3.1.0 */\n    .domainBlockResize = vzDomainBlockResize, /* 3.3.0 */\n};",
      "static virConnectDriver vzConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"vz\", NULL },\n    .hypervisorDriver = &vzHypervisorDriver,\n};",
      "static virStateDriver vzStateDriver = {\n    .name = \"vz\",\n    .stateInitialize = vzStateInitialize,\n    .stateCleanup = vzStateCleanup,\n};",
      "static virHypervisorDriver parallelsHypervisorDriver;",
      "static virConnectDriver parallelsConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"parallels\", NULL },\n    .hypervisorDriver = &parallelsHypervisorDriver,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRegisterStateDriver",
          "args": [
            "&vzStateDriver"
          ],
          "line": 4181
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterStateDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "588-602",
          "snippet": "int\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virStateDriverPtr virStateDriverTab[MAX_DRIVERS];",
            "static int virStateDriverTabCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virStateDriverPtr virStateDriverTab[MAX_DRIVERS];\nstatic int virStateDriverTabCount;\n\nint\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRegisterConnectDriver",
          "args": [
            "&vzConnectDriver",
            "true"
          ],
          "line": 4178
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterConnectDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "515-550",
          "snippet": "int\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];",
            "static int virConnectDriverTabCount;",
            "static virNetworkDriverPtr virSharedNetworkDriver;",
            "static virInterfaceDriverPtr virSharedInterfaceDriver;",
            "static virStorageDriverPtr virSharedStorageDriver;",
            "static virNodeDeviceDriverPtr virSharedNodeDeviceDriver;",
            "static virSecretDriverPtr virSharedSecretDriver;",
            "static virNWFilterDriverPtr virSharedNWFilterDriver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];\nstatic int virConnectDriverTabCount;\nstatic virNetworkDriverPtr virSharedNetworkDriver;\nstatic virInterfaceDriverPtr virSharedInterfaceDriver;\nstatic virStorageDriverPtr virSharedStorageDriver;\nstatic virNodeDeviceDriverPtr virSharedNodeDeviceDriver;\nstatic virSecretDriverPtr virSharedSecretDriver;\nstatic virNWFilterDriverPtr virSharedNWFilterDriver;\n\nint\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "prlctl_path"
          ],
          "line": 4170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"%s\"",
            "_(\"Can't find prlctl command in the PATH env\")"
          ],
          "line": 4166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Can't find prlctl command in the PATH env\""
          ],
          "line": 4166
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFindFileInPath",
          "args": [
            "PRLCTL"
          ],
          "line": 4164
        },
        "resolved": true,
        "details": {
          "function_name": "virFindFileInPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1657-1709",
          "snippet": "char *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define PRLCTL                      \"prlctl\"\n\nstatic virHypervisorDriver vzHypervisorDriver = {\n    .name = \"vz\",\n    .connectOpen = vzConnectOpen,            /* 0.10.0 */\n    .connectClose = vzConnectClose,          /* 0.10.0 */\n    .connectGetVersion = vzConnectGetVersion,   /* 0.10.0 */\n    .connectGetHostname = vzConnectGetHostname,      /* 0.10.0 */\n    .connectGetSysinfo = vzConnectGetSysinfo, /* 1.3.4 */\n    .connectGetMaxVcpus = vzConnectGetMaxVcpus, /* 1.2.21 */\n    .nodeGetInfo = vzNodeGetInfo,      /* 0.10.0 */\n    .nodeGetCPUStats = vzNodeGetCPUStats,      /* 1.2.21 */\n    .nodeGetMemoryStats = vzNodeGetMemoryStats, /* 1.2.21 */\n    .nodeGetCellsFreeMemory = vzNodeGetCellsFreeMemory, /* 1.2.21 */\n    .nodeGetFreeMemory = vzNodeGetFreeMemory, /* 1.2.21 */\n    .connectGetCapabilities = vzConnectGetCapabilities,      /* 0.10.0 */\n    .connectBaselineCPU = vzConnectBaselineCPU, /* 1.2.6 */\n    .connectListDomains = vzConnectListDomains,      /* 0.10.0 */\n    .connectNumOfDomains = vzConnectNumOfDomains,    /* 0.10.0 */\n    .connectListDefinedDomains = vzConnectListDefinedDomains,        /* 0.10.0 */\n    .connectNumOfDefinedDomains = vzConnectNumOfDefinedDomains,      /* 0.10.0 */\n    .connectListAllDomains = vzConnectListAllDomains, /* 0.10.0 */\n    .domainLookupByID = vzDomainLookupByID,    /* 0.10.0 */\n    .domainLookupByUUID = vzDomainLookupByUUID,        /* 0.10.0 */\n    .domainLookupByName = vzDomainLookupByName,        /* 0.10.0 */\n    .domainGetOSType = vzDomainGetOSType,    /* 0.10.0 */\n    .domainGetInfo = vzDomainGetInfo,  /* 0.10.0 */\n    .domainGetState = vzDomainGetState,        /* 0.10.0 */\n    .domainGetXMLDesc = vzDomainGetXMLDesc,    /* 0.10.0 */\n    .domainIsPersistent = vzDomainIsPersistent,        /* 0.10.0 */\n    .domainGetAutostart = vzDomainGetAutostart,        /* 0.10.0 */\n    .domainGetVcpus = vzDomainGetVcpus, /* 1.2.6 */\n    .domainSuspend = vzDomainSuspend,    /* 0.10.0 */\n    .domainResume = vzDomainResume,    /* 0.10.0 */\n    .domainDestroy = vzDomainDestroy,  /* 0.10.0 */\n    .domainDestroyFlags = vzDomainDestroyFlags,  /* 2.2.0 */\n    .domainShutdown = vzDomainShutdown, /* 0.10.0 */\n    .domainShutdownFlags = vzDomainShutdownFlags, /* 2.2.0 */\n    .domainCreate = vzDomainCreate,    /* 0.10.0 */\n    .domainCreateWithFlags = vzDomainCreateWithFlags, /* 1.2.10 */\n    .domainReboot = vzDomainReboot, /* 1.3.0 */\n    .domainDefineXML = vzDomainDefineXML,      /* 0.10.0 */\n    .domainDefineXMLFlags = vzDomainDefineXMLFlags, /* 1.2.12 */\n    .domainUndefine = vzDomainUndefine, /* 1.2.10 */\n    .domainUndefineFlags = vzDomainUndefineFlags, /* 1.2.10 */\n    .domainAttachDevice = vzDomainAttachDevice, /* 1.2.15 */\n    .domainAttachDeviceFlags = vzDomainAttachDeviceFlags, /* 1.2.15 */\n    .domainDetachDevice = vzDomainDetachDevice, /* 1.2.15 */\n    .domainDetachDeviceFlags = vzDomainDetachDeviceFlags, /* 1.2.15 */\n    .domainIsActive = vzDomainIsActive, /* 1.2.10 */\n    .domainIsUpdated = vzDomainIsUpdated,     /* 1.2.21 */\n    .domainSetVcpus = vzDomainSetVcpus, /* 3.3.0 */\n    .domainSetVcpusFlags = vzDomainSetVcpusFlags, /* 3.3.0 */\n    .domainGetVcpusFlags = vzDomainGetVcpusFlags, /* 1.2.21 */\n    .domainGetMaxVcpus = vzDomainGetMaxVcpus, /* 1.2.21 */\n    .domainSetUserPassword = vzDomainSetUserPassword, /* 2.0.0 */\n    .connectDomainEventRegisterAny = vzConnectDomainEventRegisterAny, /* 1.2.10 */\n    .connectDomainEventDeregisterAny = vzConnectDomainEventDeregisterAny, /* 1.2.10 */\n    .nodeGetCPUMap = vzNodeGetCPUMap, /* 1.2.8 */\n    .connectIsEncrypted = vzConnectIsEncrypted, /* 1.2.5 */\n    .connectIsSecure = vzConnectIsSecure, /* 1.2.5 */\n    .connectIsAlive = vzConnectIsAlive, /* 1.2.5 */\n    .domainHasManagedSaveImage = vzDomainHasManagedSaveImage, /* 1.2.13 */\n    .domainManagedSave = vzDomainManagedSave, /* 1.2.14 */\n    .domainManagedSaveRemove = vzDomainManagedSaveRemove, /* 1.2.14 */\n    .domainGetMaxMemory = vzDomainGetMaxMemory, /* 1.2.15 */\n    .domainBlockStats = vzDomainBlockStats, /* 1.2.17 */\n    .domainBlockStatsFlags = vzDomainBlockStatsFlags, /* 1.2.17 */\n    .domainInterfaceStats = vzDomainInterfaceStats, /* 1.2.17 */\n    .domainMemoryStats = vzDomainMemoryStats, /* 1.2.17 */\n    .connectRegisterCloseCallback = vzConnectRegisterCloseCallback, /* 1.3.2 */\n    .connectUnregisterCloseCallback = vzConnectUnregisterCloseCallback, /* 1.3.2 */\n    .domainSetMemoryFlags = vzDomainSetMemoryFlags, /* 1.3.4 */\n    .domainSetMemory = vzDomainSetMemory, /* 1.3.4 */\n    .domainSnapshotNum = vzDomainSnapshotNum, /* 1.3.5 */\n    .domainSnapshotListNames = vzDomainSnapshotListNames, /* 1.3.5 */\n    .domainListAllSnapshots = vzDomainListAllSnapshots, /* 1.3.5 */\n    .domainSnapshotGetXMLDesc = vzDomainSnapshotGetXMLDesc, /* 1.3.5 */\n    .domainSnapshotNumChildren = vzDomainSnapshotNumChildren, /* 1.3.5 */\n    .domainSnapshotListChildrenNames = vzDomainSnapshotListChildrenNames, /* 1.3.5 */\n    .domainSnapshotListAllChildren = vzDomainSnapshotListAllChildren, /* 1.3.5 */\n    .domainSnapshotLookupByName = vzDomainSnapshotLookupByName, /* 1.3.5 */\n    .domainHasCurrentSnapshot = vzDomainHasCurrentSnapshot, /* 1.3.5 */\n    .domainSnapshotGetParent = vzDomainSnapshotGetParent, /* 1.3.5 */\n    .domainSnapshotCurrent = vzDomainSnapshotCurrent, /* 1.3.5 */\n    .domainSnapshotIsCurrent = vzDomainSnapshotIsCurrent, /* 1.3.5 */\n    .domainSnapshotHasMetadata = vzDomainSnapshotHasMetadata, /* 1.3.5 */\n    .domainSnapshotCreateXML = vzDomainSnapshotCreateXML, /* 1.3.5 */\n    .domainSnapshotDelete = vzDomainSnapshotDelete, /* 1.3.5 */\n    .domainRevertToSnapshot = vzDomainRevertToSnapshot, /* 1.3.5 */\n    .connectSupportsFeature = vzConnectSupportsFeature, /* 1.3.5 */\n    .domainMigrateBegin3Params = vzDomainMigrateBegin3Params, /* 1.3.5 */\n    .domainMigratePrepare3Params = vzDomainMigratePrepare3Params, /* 1.3.5 */\n    .domainMigratePerform3Params = vzDomainMigratePerform3Params, /* 1.3.5 */\n    .domainMigrateFinish3Params = vzDomainMigrateFinish3Params, /* 1.3.5 */\n    .domainMigrateConfirm3Params = vzDomainMigrateConfirm3Params, /* 1.3.5 */\n    .domainUpdateDeviceFlags = vzDomainUpdateDeviceFlags, /* 2.0.0 */\n    .domainGetJobInfo = vzDomainGetJobInfo, /* 2.2.0 */\n    .domainGetJobStats = vzDomainGetJobStats, /* 2.2.0 */\n    .connectGetAllDomainStats = vzConnectGetAllDomainStats, /* 3.1.0 */\n    .domainAbortJob = vzDomainAbortJob, /* 3.1.0 */\n    .domainReset = vzDomainReset, /* 3.1.0 */\n    .domainBlockResize = vzDomainBlockResize, /* 3.3.0 */\n};\nstatic virConnectDriver vzConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"vz\", NULL },\n    .hypervisorDriver = &vzHypervisorDriver,\n};\nstatic virStateDriver vzStateDriver = {\n    .name = \"vz\",\n    .stateInitialize = vzStateInitialize,\n    .stateCleanup = vzStateCleanup,\n};\nstatic virHypervisorDriver parallelsHypervisorDriver;\nstatic virConnectDriver parallelsConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"parallels\", NULL },\n    .hypervisorDriver = &parallelsHypervisorDriver,\n};\n\nint\nvzRegister(void)\n{\n    char *prlctl_path;\n\n    prlctl_path = virFindFileInPath(PRLCTL);\n    if (!prlctl_path) {\n        VIR_DEBUG(\"%s\", _(\"Can't find prlctl command in the PATH env\"));\n        return 0;\n    }\n\n    VIR_FREE(prlctl_path);\n\n    /* Backward compatibility with Parallels domain type */\n    parallelsHypervisorDriver = vzHypervisorDriver;\n    parallelsHypervisorDriver.name = \"Parallels\";\n    if (virRegisterConnectDriver(&parallelsConnectDriver, true) < 0)\n        return -1;\n\n    if (virRegisterConnectDriver(&vzConnectDriver, true) < 0)\n        return -1;\n\n    if (virRegisterStateDriver(&vzStateDriver) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzStateInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "4095-4138",
    "snippet": "static int\nvzStateInitialize(bool privileged,\n                  const char *root,\n                  virStateInhibitCallback callback G_GNUC_UNUSED,\n                  void *opaque G_GNUC_UNUSED)\n{\n    if (!privileged)\n        return VIR_DRV_STATE_INIT_SKIPPED;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    vz_driver_privileged = privileged;\n\n    if (virFileMakePathWithMode(VZ_STATEDIR, S_IRWXU) < 0) {\n        virReportSystemError(errno, _(\"cannot create state directory '%s'\"),\n                             VZ_STATEDIR);\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n\n    if ((vz_driver_lock_fd =\n         virPidFileAcquire(VZ_STATEDIR, \"driver\", false, getpid())) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    if (prlsdkInit() < 0) {\n        VIR_DEBUG(\"%s\", _(\"Can't initialize Parallels SDK\"));\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n\n    if (virMutexInit(&vz_driver_lock) < 0)\n        goto error;\n\n    /* Failing to create driver here is not fatal and only means\n     * that next driver client will try once more when connecting */\n    vz_driver = vzDriverObjNew();\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n error:\n    vzStateCleanup();\n    return VIR_DRV_STATE_INIT_ERROR;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_STATEDIR RUNSTATEDIR \"/libvirt/vz\""
    ],
    "globals_used": [
      "static bool vz_driver_privileged;",
      "static int vz_driver_lock_fd = -1;",
      "static virMutex vz_driver_lock;",
      "static vzDriverPtr vz_driver;",
      "static vzDriverPtr\nvzDriverObjNew(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzStateCleanup",
          "args": [],
          "line": 4136
        },
        "resolved": true,
        "details": {
          "function_name": "vzStateCleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "4081-4093",
          "snippet": "static int\nvzStateCleanup(void)\n{\n    if (vz_driver_privileged) {\n        virObjectUnref(vz_driver);\n        vz_driver = NULL;\n        if (vz_driver_lock_fd != -1)\n            virPidFileRelease(VZ_STATEDIR, \"driver\", vz_driver_lock_fd);\n        virMutexDestroy(&vz_driver_lock);\n        prlsdkDeinit();\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_STATEDIR RUNSTATEDIR \"/libvirt/vz\""
          ],
          "globals_used": [
            "static bool vz_driver_privileged;",
            "static int vz_driver_lock_fd = -1;",
            "static virMutex vz_driver_lock;",
            "static vzDriverPtr vz_driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_STATEDIR RUNSTATEDIR \"/libvirt/vz\"\n\nstatic bool vz_driver_privileged;\nstatic int vz_driver_lock_fd = -1;\nstatic virMutex vz_driver_lock;\nstatic vzDriverPtr vz_driver;\n\nstatic int\nvzStateCleanup(void)\n{\n    if (vz_driver_privileged) {\n        virObjectUnref(vz_driver);\n        vz_driver = NULL;\n        if (vz_driver_lock_fd != -1)\n            virPidFileRelease(VZ_STATEDIR, \"driver\", vz_driver_lock_fd);\n        virMutexDestroy(&vz_driver_lock);\n        prlsdkDeinit();\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDriverObjNew",
          "args": [],
          "line": 4132
        },
        "resolved": true,
        "details": {
          "function_name": "vzDriverObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "315-348",
          "snippet": "static vzDriverPtr\nvzDriverObjNew(void)\n{\n    vzDriverPtr driver;\n\n    if (vzDriverInitialize() < 0)\n        return NULL;\n\n    if (!(driver = virObjectLockableNew(vzDriverClass)))\n        return NULL;\n\n    vzDomainDefParserConfig.priv = driver;\n\n    if (!(driver->caps = vzBuildCapabilities()) ||\n        !(driver->xmlopt = virDomainXMLOptionNew(&vzDomainDefParserConfig,\n                                                 &vzDomainXMLPrivateDataCallbacksPtr,\n                                                 NULL, NULL, NULL)) ||\n        !(driver->domains = virDomainObjListNew()) ||\n        !(driver->domainEventState = virObjectEventStateNew()) ||\n        (vzInitVersion(driver) < 0) ||\n        (prlsdkConnect(driver) < 0)) {\n        virObjectUnref(driver);\n        return NULL;\n    }\n\n    driver->hostsysinfo = virSysinfoRead();\n    ignore_value(prlsdkLoadDomains(driver));\n\n    /* As far as waitDomainJob finally calls virReportErrorHelper\n     * and we are not going to report it, reset it explicitly */\n    virResetLastError();\n\n    return driver;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr vzDriverClass;",
            "static vzDriverPtr\nvzDriverObjNew(void);",
            "static virDomainXMLPrivateDataCallbacks vzDomainXMLPrivateDataCallbacksPtr = {\n    .alloc = vzDomObjAlloc,\n    .free = vzDomObjFree,\n};",
            "static virDomainDefParserConfig vzDomainDefParserConfig = {\n    .macPrefix = {0x42, 0x1C, 0x00},\n    .domainPostParseCallback = vzDomainDefPostParse,\n    .devicesPostParseCallback = vzDomainDeviceDefPostParse,\n    .domainValidateCallback = vzDomainDefValidate,\n    .deviceValidateCallback = vzDomainDeviceDefValidate,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virClassPtr vzDriverClass;\nstatic vzDriverPtr\nvzDriverObjNew(void);\nstatic virDomainXMLPrivateDataCallbacks vzDomainXMLPrivateDataCallbacksPtr = {\n    .alloc = vzDomObjAlloc,\n    .free = vzDomObjFree,\n};\nstatic virDomainDefParserConfig vzDomainDefParserConfig = {\n    .macPrefix = {0x42, 0x1C, 0x00},\n    .domainPostParseCallback = vzDomainDefPostParse,\n    .devicesPostParseCallback = vzDomainDeviceDefPostParse,\n    .domainValidateCallback = vzDomainDefValidate,\n    .deviceValidateCallback = vzDomainDeviceDefValidate,\n};\n\nstatic vzDriverPtr\nvzDriverObjNew(void)\n{\n    vzDriverPtr driver;\n\n    if (vzDriverInitialize() < 0)\n        return NULL;\n\n    if (!(driver = virObjectLockableNew(vzDriverClass)))\n        return NULL;\n\n    vzDomainDefParserConfig.priv = driver;\n\n    if (!(driver->caps = vzBuildCapabilities()) ||\n        !(driver->xmlopt = virDomainXMLOptionNew(&vzDomainDefParserConfig,\n                                                 &vzDomainXMLPrivateDataCallbacksPtr,\n                                                 NULL, NULL, NULL)) ||\n        !(driver->domains = virDomainObjListNew()) ||\n        !(driver->domainEventState = virObjectEventStateNew()) ||\n        (vzInitVersion(driver) < 0) ||\n        (prlsdkConnect(driver) < 0)) {\n        virObjectUnref(driver);\n        return NULL;\n    }\n\n    driver->hostsysinfo = virSysinfoRead();\n    ignore_value(prlsdkLoadDomains(driver));\n\n    /* As far as waitDomainJob finally calls virReportErrorHelper\n     * and we are not going to report it, reset it explicitly */\n    virResetLastError();\n\n    return driver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexInit",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 4127
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexInitRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "61-74",
          "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"%s\"",
            "_(\"Can't initialize Parallels SDK\")"
          ],
          "line": 4123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Can't initialize Parallels SDK\""
          ],
          "line": 4123
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkInit",
          "args": [],
          "line": 4122
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "330-345",
          "snippet": "int\nprlsdkInit(void)\n{\n    PRL_RESULT ret;\n\n    /* Disable console output */\n    PrlApi_SwitchConsoleLogging(0);\n\n    ret = PrlApi_InitEx(PARALLELS_API_VER, PAM_SERVER, 0, 0);\n    if (PRL_FAILED(ret)) {\n        logPrlError(ret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkInit(void)\n{\n    PRL_RESULT ret;\n\n    /* Disable console output */\n    PrlApi_SwitchConsoleLogging(0);\n\n    ret = PrlApi_InitEx(PARALLELS_API_VER, PAM_SERVER, 0, 0);\n    if (PRL_FAILED(ret)) {\n        logPrlError(ret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPidFileAcquire",
          "args": [
            "VZ_STATEDIR",
            "\"driver\"",
            "false",
            "getpid()"
          ],
          "line": 4119
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileAcquire",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "413-427",
          "snippet": "int virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 4119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create state directory '%s'\")",
            "VZ_STATEDIR"
          ],
          "line": 4113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePathWithMode",
          "args": [
            "VZ_STATEDIR",
            "S_IRWXU"
          ],
          "line": 4112
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePathWithMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3082-3091",
          "snippet": "int\nvirFileMakePathWithMode(const char *path,\n                        mode_t mode)\n{\n    g_autofree char *tmp = NULL;\n\n    tmp = g_strdup(path);\n\n    return virFileMakePathHelper(tmp, mode);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePathWithMode(const char *path,\n                        mode_t mode)\n{\n    g_autofree char *tmp = NULL;\n\n    tmp = g_strdup(path);\n\n    return virFileMakePathHelper(tmp, mode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Driver does not support embedded mode\")"
          ],
          "line": 4105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_STATEDIR RUNSTATEDIR \"/libvirt/vz\"\n\nstatic bool vz_driver_privileged;\nstatic int vz_driver_lock_fd = -1;\nstatic virMutex vz_driver_lock;\nstatic vzDriverPtr vz_driver;\nstatic vzDriverPtr\nvzDriverObjNew(void);\n\nstatic int\nvzStateInitialize(bool privileged,\n                  const char *root,\n                  virStateInhibitCallback callback G_GNUC_UNUSED,\n                  void *opaque G_GNUC_UNUSED)\n{\n    if (!privileged)\n        return VIR_DRV_STATE_INIT_SKIPPED;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    vz_driver_privileged = privileged;\n\n    if (virFileMakePathWithMode(VZ_STATEDIR, S_IRWXU) < 0) {\n        virReportSystemError(errno, _(\"cannot create state directory '%s'\"),\n                             VZ_STATEDIR);\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n\n    if ((vz_driver_lock_fd =\n         virPidFileAcquire(VZ_STATEDIR, \"driver\", false, getpid())) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    if (prlsdkInit() < 0) {\n        VIR_DEBUG(\"%s\", _(\"Can't initialize Parallels SDK\"));\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n\n    if (virMutexInit(&vz_driver_lock) < 0)\n        goto error;\n\n    /* Failing to create driver here is not fatal and only means\n     * that next driver client will try once more when connecting */\n    vz_driver = vzDriverObjNew();\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n error:\n    vzStateCleanup();\n    return VIR_DRV_STATE_INIT_ERROR;\n}"
  },
  {
    "function_name": "vzStateCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "4081-4093",
    "snippet": "static int\nvzStateCleanup(void)\n{\n    if (vz_driver_privileged) {\n        virObjectUnref(vz_driver);\n        vz_driver = NULL;\n        if (vz_driver_lock_fd != -1)\n            virPidFileRelease(VZ_STATEDIR, \"driver\", vz_driver_lock_fd);\n        virMutexDestroy(&vz_driver_lock);\n        prlsdkDeinit();\n    }\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_STATEDIR RUNSTATEDIR \"/libvirt/vz\""
    ],
    "globals_used": [
      "static bool vz_driver_privileged;",
      "static int vz_driver_lock_fd = -1;",
      "static virMutex vz_driver_lock;",
      "static vzDriverPtr vz_driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prlsdkDeinit",
          "args": [],
          "line": 4090
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkDeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "347-351",
          "snippet": "void\nprlsdkDeinit(void)\n{\n    PrlApi_Deinit();\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nprlsdkDeinit(void)\n{\n    PrlApi_Deinit();\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexDestroy",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 4089
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "76-79",
          "snippet": "void virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPidFileRelease",
          "args": [
            "VZ_STATEDIR",
            "\"driver\"",
            "vz_driver_lock_fd"
          ],
          "line": 4088
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileRelease",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "453-466",
          "snippet": "int virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "vz_driver"
          ],
          "line": 4085
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_STATEDIR RUNSTATEDIR \"/libvirt/vz\"\n\nstatic bool vz_driver_privileged;\nstatic int vz_driver_lock_fd = -1;\nstatic virMutex vz_driver_lock;\nstatic vzDriverPtr vz_driver;\n\nstatic int\nvzStateCleanup(void)\n{\n    if (vz_driver_privileged) {\n        virObjectUnref(vz_driver);\n        vz_driver = NULL;\n        if (vz_driver_lock_fd != -1)\n            virPidFileRelease(VZ_STATEDIR, \"driver\", vz_driver_lock_fd);\n        virMutexDestroy(&vz_driver_lock);\n        prlsdkDeinit();\n    }\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainBlockResize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3917-3970",
    "snippet": "static int\nvzDomainBlockResize(virDomainPtr domain,\n                    const char *path,\n                    unsigned long long size,\n                    unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    virDomainDiskDefPtr disk = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_BLOCK_RESIZE_BYTES, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainBlockResizeEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (path[0] == '\\0') {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       \"%s\", _(\"empty path\"));\n        goto cleanup;\n    }\n\n    /* sdk wants Mb */\n    if (flags & VIR_DOMAIN_BLOCK_RESIZE_BYTES)\n        size /= 1024;\n    size /= 1024;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(dom) < 0)\n        goto cleanup;\n\n    if (!(disk = virDomainDiskByName(dom->def, path, false))) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid path: %s\"), path);\n        goto cleanup;\n    }\n\n    ret = prlsdkResizeImage(dom, disk, size);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 3968
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 3967
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkResizeImage",
          "args": [
            "dom",
            "disk",
            "size"
          ],
          "line": 3963
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkResizeImage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4862-4897",
          "snippet": "int prlsdkResizeImage(virDomainObjPtr dom, virDomainDiskDefPtr disk,\n                      unsigned long long newsize)\n{\n    int ret = -1;\n    PRL_RESULT pret;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_UINT32 emulatedType;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE prldisk = PRL_INVALID_HANDLE;\n\n    prldisk = prlsdkGetDisk(privdom->sdkdom, disk);\n    if (prldisk == PRL_INVALID_HANDLE)\n        goto cleanup;\n\n    pret = PrlVmDev_GetEmulatedType(prldisk, &emulatedType);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    if (emulatedType != PDT_USE_IMAGE_FILE &&\n        emulatedType != PDT_USE_FILE_SYSTEM) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Only disk image supported for resize\"));\n        goto cleanup;\n    }\n\n    job = PrlVmDev_ResizeImage(prldisk, newsize,\n                               PRIF_RESIZE_LAST_PARTITION);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n\n    PrlHandle_Free(prldisk);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);",
            "static PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\nstatic PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);\n\nint prlsdkResizeImage(virDomainObjPtr dom, virDomainDiskDefPtr disk,\n                      unsigned long long newsize)\n{\n    int ret = -1;\n    PRL_RESULT pret;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_UINT32 emulatedType;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE prldisk = PRL_INVALID_HANDLE;\n\n    prldisk = prlsdkGetDisk(privdom->sdkdom, disk);\n    if (prldisk == PRL_INVALID_HANDLE)\n        goto cleanup;\n\n    pret = PrlVmDev_GetEmulatedType(prldisk, &emulatedType);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    if (emulatedType != PDT_USE_IMAGE_FILE &&\n        emulatedType != PDT_USE_FILE_SYSTEM) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Only disk image supported for resize\"));\n        goto cleanup;\n    }\n\n    job = PrlVmDev_ResizeImage(prldisk, newsize,\n                               PRIF_RESIZE_LAST_PARTITION);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n\n    PrlHandle_Free(prldisk);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid path: %s\")",
            "path"
          ],
          "line": 3958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"invalid path: %s\""
          ],
          "line": 3959
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskByName",
          "args": [
            "dom->def",
            "path",
            "false"
          ],
          "line": 3957
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17327-17334",
          "snippet": "virDomainDiskDefPtr\nvirDomainDiskByName(virDomainDefPtr def,\n                    const char *name,\n                    bool allow_ambiguous)\n{\n    int idx = virDomainDiskIndexByName(def, name, allow_ambiguous);\n    return idx < 0 ? NULL : def->disks[idx];\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDiskDefPtr\nvirDomainDiskByName(virDomainDefPtr def,\n                    const char *name,\n                    bool allow_ambiguous)\n{\n    int idx = virDomainDiskIndexByName(def, name, allow_ambiguous);\n    return idx < 0 ? NULL : def->disks[idx];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "dom"
          ],
          "line": 3954
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 3951
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 3947
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"empty path\")"
          ],
          "line": 3937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainBlockResizeEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 3933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 3930
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_BLOCK_RESIZE_BYTES",
            "-1"
          ],
          "line": 3928
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainBlockResize(virDomainPtr domain,\n                    const char *path,\n                    unsigned long long size,\n                    unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    virDomainDiskDefPtr disk = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_BLOCK_RESIZE_BYTES, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainBlockResizeEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (path[0] == '\\0') {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       \"%s\", _(\"empty path\"));\n        goto cleanup;\n    }\n\n    /* sdk wants Mb */\n    if (flags & VIR_DOMAIN_BLOCK_RESIZE_BYTES)\n        size /= 1024;\n    size /= 1024;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(dom) < 0)\n        goto cleanup;\n\n    if (!(disk = virDomainDiskByName(dom->def, path, false))) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid path: %s\"), path);\n        goto cleanup;\n    }\n\n    ret = prlsdkResizeImage(dom, disk, size);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSetVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3912-3916",
    "snippet": "static int vzDomainSetVcpus(virDomainPtr dom, unsigned int nvcpus)\n{\n    return vzDomainSetVcpusFlags(dom, nvcpus,\n                                 VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainSetVcpusFlags",
          "args": [
            "dom",
            "nvcpus",
            "VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG"
          ],
          "line": 3914
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainSetVcpusFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3877-3910",
          "snippet": "static int vzDomainSetVcpusFlags(virDomainPtr domain, unsigned int nvcpus,\n                                 unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainSetVcpusFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSetCpuCount(dom, nvcpus);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainSetVcpusFlags(virDomainPtr domain, unsigned int nvcpus,\n                                 unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainSetVcpusFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSetCpuCount(dom, nvcpus);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainSetVcpus(virDomainPtr dom, unsigned int nvcpus)\n{\n    return vzDomainSetVcpusFlags(dom, nvcpus,\n                                 VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG);\n}"
  },
  {
    "function_name": "vzDomainSetVcpusFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3877-3910",
    "snippet": "static int vzDomainSetVcpusFlags(virDomainPtr domain, unsigned int nvcpus,\n                                 unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainSetVcpusFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSetCpuCount(dom, nvcpus);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 3908
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 3907
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkSetCpuCount",
          "args": [
            "dom",
            "nvcpus"
          ],
          "line": 3903
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkSetCpuCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4842-4860",
          "snippet": "int prlsdkSetCpuCount(virDomainObjPtr dom, unsigned int count)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    PRL_RESULT pret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    pret = PrlVmCfg_SetCpuCount(privdom->sdkdom, count);\n    prlsdkCheckRetExit(pret, -1);\n\n    job = PrlVm_CommitEx(privdom->sdkdom, 0);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkSetCpuCount(virDomainObjPtr dom, unsigned int count)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    PRL_RESULT pret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    pret = PrlVmCfg_SetCpuCount(privdom->sdkdom, count);\n    prlsdkCheckRetExit(pret, -1);\n\n    job = PrlVm_CommitEx(privdom->sdkdom, 0);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 3900
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 3896
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetVcpusFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 3893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzCheckConfigUpdateFlags",
          "args": [
            "dom",
            "&flags"
          ],
          "line": 3890
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckConfigUpdateFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1456-1476",
          "snippet": "static int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 3887
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 3884
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainSetVcpusFlags(virDomainPtr domain, unsigned int nvcpus,\n                                 unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainSetVcpusFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSetCpuCount(dom, nvcpus);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainReset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3846-3875",
    "snippet": "static int\nvzDomainReset(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainResetEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkReset(dom);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 3873
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 3872
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkReset",
          "args": [
            "dom"
          ],
          "line": 3868
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2431-2444",
          "snippet": "int prlsdkReset(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Reset(privdom->sdkdom);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkReset(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Reset(privdom->sdkdom);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 3865
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 3861
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainResetEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 3858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 3855
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 3853
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainReset(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainResetEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkReset(dom);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainAbortJob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3826-3844",
    "snippet": "static int\nvzDomainAbortJob(virDomainPtr domain)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainAbortJobEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = prlsdkCancelJob(dom);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 3841
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkCancelJob",
          "args": [
            "dom"
          ],
          "line": 3838
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkCancelJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "275-297",
          "snippet": "int\nprlsdkCancelJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n    PRL_HANDLE job;\n\n    if (!privdom->job.active) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"no job is active on the domain\"));\n        return -1;\n    }\n\n   privdom->job.cancelled = true;\n   job = PrlJob_Cancel(privdom->job.sdkJob);\n\n   virObjectUnlock(dom);\n   pret = waitJobHelper(job, JOB_INFINIT_WAIT_TIMEOUT,\n                        __FILE__, __FUNCTION__, __LINE__);\n   virObjectLock(dom);\n\n   return PRL_FAILED(pret) ? -1 : 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define JOB_INFINIT_WAIT_TIMEOUT UINT_MAX"
          ],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define JOB_INFINIT_WAIT_TIMEOUT UINT_MAX\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint\nprlsdkCancelJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n    PRL_HANDLE job;\n\n    if (!privdom->job.active) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"no job is active on the domain\"));\n        return -1;\n    }\n\n   privdom->job.cancelled = true;\n   job = PrlJob_Cancel(privdom->job.sdkJob);\n\n   virObjectUnlock(dom);\n   pret = waitJobHelper(job, JOB_INFINIT_WAIT_TIMEOUT,\n                        __FILE__, __FUNCTION__, __LINE__);\n   virObjectLock(dom);\n\n   return PRL_FAILED(pret) ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAbortJobEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 3835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 3832
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainAbortJob(virDomainPtr domain)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainAbortJobEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = prlsdkCancelJob(dom);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzConnectGetAllDomainStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3741-3822",
    "snippet": "static int\nvzConnectGetAllDomainStats(virConnectPtr conn,\n                           virDomainPtr *domains,\n                           unsigned int ndomains,\n                           unsigned int stats,\n                           virDomainStatsRecordPtr **retStats,\n                           unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    unsigned int lflags = flags & (VIR_CONNECT_LIST_DOMAINS_FILTERS_ACTIVE |\n                                   VIR_CONNECT_LIST_DOMAINS_FILTERS_PERSISTENT |\n                                   VIR_CONNECT_LIST_DOMAINS_FILTERS_STATE);\n    unsigned int supported = VIR_DOMAIN_STATS_STATE |\n                             VIR_DOMAIN_STATS_VCPU |\n                             VIR_DOMAIN_STATS_INTERFACE |\n                             VIR_DOMAIN_STATS_BALLOON |\n                             VIR_DOMAIN_STATS_BLOCK;\n    virDomainObjPtr *doms = NULL;\n    size_t ndoms;\n    virDomainStatsRecordPtr *tmpstats = NULL;\n    int nstats = 0;\n    int ret = -1;\n    size_t i;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ACTIVE |\n                  VIR_CONNECT_LIST_DOMAINS_FILTERS_PERSISTENT |\n                  VIR_CONNECT_LIST_DOMAINS_FILTERS_STATE |\n                  VIR_CONNECT_GET_ALL_DOMAINS_STATS_ENFORCE_STATS, -1);\n\n    if (virConnectGetAllDomainStatsEnsureACL(conn) < 0)\n        return -1;\n\n    if (!stats) {\n        stats = supported;\n    } else if ((flags & VIR_CONNECT_GET_ALL_DOMAINS_STATS_ENFORCE_STATS) &&\n               (stats & ~supported)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"Stats types bits 0x%x are not supported by this daemon\"),\n                       stats & ~supported);\n        return -1;\n    }\n\n    if (ndomains) {\n        if (virDomainObjListConvert(driver->domains, conn, domains, ndomains, &doms,\n                                    &ndoms, virConnectGetAllDomainStatsCheckACL,\n                                    lflags, true) < 0)\n            return -1;\n    } else {\n        if (virDomainObjListCollect(driver->domains, conn, &doms, &ndoms,\n                                    virConnectGetAllDomainStatsCheckACL,\n                                    lflags) < 0)\n            return -1;\n    }\n\n    if (VIR_ALLOC_N(tmpstats, ndoms + 1) < 0)\n        goto cleanup;\n\n    for (i = 0; i < ndoms; i++) {\n        virDomainStatsRecordPtr tmp;\n        virDomainObjPtr dom = doms[i];\n\n        virObjectLock(dom);\n        tmp = vzDomainGetAllStats(conn, dom);\n        virObjectUnlock(dom);\n\n        if (!tmp)\n            goto cleanup;\n\n        tmpstats[nstats++] = tmp;\n    }\n\n    *retStats = tmpstats;\n    tmpstats = NULL;\n    ret = nstats;\n\n cleanup:\n    virDomainStatsRecordListFree(tmpstats);\n    virObjectListFreeCount(doms, ndoms);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectListFreeCount",
          "args": [
            "doms",
            "ndoms"
          ],
          "line": 3819
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFreeCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "625-638",
          "snippet": "void\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainStatsRecordListFree",
          "args": [
            "tmpstats"
          ],
          "line": 3818
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainStatsRecordListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "11874-11889",
          "snippet": "void\nvirDomainStatsRecordListFree(virDomainStatsRecordPtr *stats)\n{\n    virDomainStatsRecordPtr *next;\n\n    if (!stats)\n        return;\n\n    for (next = stats; *next; next++) {\n        virTypedParamsFree((*next)->params, (*next)->nparams);\n        virDomainFree((*next)->dom);\n        VIR_FREE(*next);\n    }\n\n    VIR_FREE(stats);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainStatsRecordListFree(virDomainStatsRecordPtr *stats)\n{\n    virDomainStatsRecordPtr *next;\n\n    if (!stats)\n        return;\n\n    for (next = stats; *next; next++) {\n        virTypedParamsFree((*next)->params, (*next)->nparams);\n        virDomainFree((*next)->dom);\n        VIR_FREE(*next);\n    }\n\n    VIR_FREE(stats);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dom"
          ],
          "line": 3805
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainGetAllStats",
          "args": [
            "conn",
            "dom"
          ],
          "line": 3804
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetAllStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3704-3739",
          "snippet": "static virDomainStatsRecordPtr\nvzDomainGetAllStats(virConnectPtr conn,\n                    virDomainObjPtr dom)\n{\n    virDomainStatsRecordPtr stat;\n    int maxparams = 0;\n\n    if (VIR_ALLOC(stat) < 0)\n        return NULL;\n\n    if (vzDomainGetStateStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetBlockStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetNetStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetVCPUStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetBalloonStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (!(stat->dom = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id)))\n        goto error;\n\n    return stat;\n\n error:\n    virTypedParamsFree(stat->params, stat->nparams);\n    virObjectUnref(stat->dom);\n    VIR_FREE(stat);\n    return NULL;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainStatsRecordPtr\nvzDomainGetAllStats(virConnectPtr conn,\n                    virDomainObjPtr dom)\n{\n    virDomainStatsRecordPtr stat;\n    int maxparams = 0;\n\n    if (VIR_ALLOC(stat) < 0)\n        return NULL;\n\n    if (vzDomainGetStateStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetBlockStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetNetStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetVCPUStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetBalloonStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (!(stat->dom = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id)))\n        goto error;\n\n    return stat;\n\n error:\n    virTypedParamsFree(stat->params, stat->nparams);\n    virObjectUnref(stat->dom);\n    VIR_FREE(stat);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dom"
          ],
          "line": 3803
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "tmpstats",
            "ndoms + 1"
          ],
          "line": 3796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjListCollect",
          "args": [
            "driver->domains",
            "conn",
            "&doms",
            "&ndoms",
            "virConnectGetAllDomainStatsCheckACL",
            "lflags"
          ],
          "line": 3790
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListCollect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "972-998",
          "snippet": "int\nvirDomainObjListCollect(virDomainObjListPtr domlist,\n                        virConnectPtr conn,\n                        virDomainObjPtr **vms,\n                        size_t *nvms,\n                        virDomainObjListACLFilter filter,\n                        unsigned int flags)\n{\n    struct virDomainListData data = { NULL, 0 };\n\n    virObjectRWLockRead(domlist);\n    sa_assert(domlist->objs);\n    if (VIR_ALLOC_N(data.vms, virHashSize(domlist->objs)) < 0) {\n        virObjectRWUnlock(domlist);\n        return -1;\n    }\n\n    virHashForEach(domlist->objs, virDomainObjListCollectIterator, &data);\n    virObjectRWUnlock(domlist);\n\n    virDomainObjListFilter(&data.vms, &data.nvms, conn, filter, flags);\n\n    *nvms = data.nvms;\n    *vms = data.vms;\n\n    return 0;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListCollect(virDomainObjListPtr domlist,\n                        virConnectPtr conn,\n                        virDomainObjPtr **vms,\n                        size_t *nvms,\n                        virDomainObjListACLFilter filter,\n                        unsigned int flags)\n{\n    struct virDomainListData data = { NULL, 0 };\n\n    virObjectRWLockRead(domlist);\n    sa_assert(domlist->objs);\n    if (VIR_ALLOC_N(data.vms, virHashSize(domlist->objs)) < 0) {\n        virObjectRWUnlock(domlist);\n        return -1;\n    }\n\n    virHashForEach(domlist->objs, virDomainObjListCollectIterator, &data);\n    virObjectRWUnlock(domlist);\n\n    virDomainObjListFilter(&data.vms, &data.nvms, conn, filter, flags);\n\n    *nvms = data.nvms;\n    *vms = data.vms;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListConvert",
          "args": [
            "driver->domains",
            "conn",
            "domains",
            "ndomains",
            "&doms",
            "&ndoms",
            "virConnectGetAllDomainStatsCheckACL",
            "lflags",
            "true"
          ],
          "line": 3785
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListConvert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "1001-1057",
          "snippet": "int\nvirDomainObjListConvert(virDomainObjListPtr domlist,\n                        virConnectPtr conn,\n                        virDomainPtr *doms,\n                        size_t ndoms,\n                        virDomainObjPtr **vms,\n                        size_t *nvms,\n                        virDomainObjListACLFilter filter,\n                        unsigned int flags,\n                        bool skip_missing)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainObjPtr vm;\n    size_t i;\n\n    *nvms = 0;\n    *vms = NULL;\n\n    virObjectRWLockRead(domlist);\n    for (i = 0; i < ndoms; i++) {\n        virDomainPtr dom = doms[i];\n\n        virUUIDFormat(dom->uuid, uuidstr);\n\n        if (!(vm = virHashLookup(domlist->objs, uuidstr))) {\n            if (skip_missing)\n                continue;\n\n            virObjectRWUnlock(domlist);\n            virReportError(VIR_ERR_NO_DOMAIN,\n                           _(\"no domain with matching uuid '%s' (%s)\"),\n                           uuidstr, dom->name);\n            goto error;\n        }\n\n        virObjectRef(vm);\n\n        if (VIR_APPEND_ELEMENT(*vms, *nvms, vm) < 0) {\n            virObjectRWUnlock(domlist);\n            virObjectUnref(vm);\n            goto error;\n        }\n    }\n    virObjectRWUnlock(domlist);\n\n    sa_assert(*vms);\n    virDomainObjListFilter(vms, nvms, conn, filter, flags);\n\n    return 0;\n\n error:\n    virObjectListFreeCount(*vms, *nvms);\n    *vms = NULL;\n    *nvms = 0;\n\n    return -1;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListConvert(virDomainObjListPtr domlist,\n                        virConnectPtr conn,\n                        virDomainPtr *doms,\n                        size_t ndoms,\n                        virDomainObjPtr **vms,\n                        size_t *nvms,\n                        virDomainObjListACLFilter filter,\n                        unsigned int flags,\n                        bool skip_missing)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainObjPtr vm;\n    size_t i;\n\n    *nvms = 0;\n    *vms = NULL;\n\n    virObjectRWLockRead(domlist);\n    for (i = 0; i < ndoms; i++) {\n        virDomainPtr dom = doms[i];\n\n        virUUIDFormat(dom->uuid, uuidstr);\n\n        if (!(vm = virHashLookup(domlist->objs, uuidstr))) {\n            if (skip_missing)\n                continue;\n\n            virObjectRWUnlock(domlist);\n            virReportError(VIR_ERR_NO_DOMAIN,\n                           _(\"no domain with matching uuid '%s' (%s)\"),\n                           uuidstr, dom->name);\n            goto error;\n        }\n\n        virObjectRef(vm);\n\n        if (VIR_APPEND_ELEMENT(*vms, *nvms, vm) < 0) {\n            virObjectRWUnlock(domlist);\n            virObjectUnref(vm);\n            goto error;\n        }\n    }\n    virObjectRWUnlock(domlist);\n\n    sa_assert(*vms);\n    virDomainObjListFilter(vms, nvms, conn, filter, flags);\n\n    return 0;\n\n error:\n    virObjectListFreeCount(*vms, *nvms);\n    *vms = NULL;\n    *nvms = 0;\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "_(\"Stats types bits 0x%x are not supported by this daemon\")",
            "stats & ~supported"
          ],
          "line": 3778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Stats types bits 0x%x are not supported by this daemon\""
          ],
          "line": 3779
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetAllDomainStatsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 3771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_LIST_DOMAINS_FILTERS_ACTIVE |\n                  VIR_CONNECT_LIST_DOMAINS_FILTERS_PERSISTENT |\n                  VIR_CONNECT_LIST_DOMAINS_FILTERS_STATE |\n                  VIR_CONNECT_GET_ALL_DOMAINS_STATS_ENFORCE_STATS",
            "-1"
          ],
          "line": 3766
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectGetAllDomainStats(virConnectPtr conn,\n                           virDomainPtr *domains,\n                           unsigned int ndomains,\n                           unsigned int stats,\n                           virDomainStatsRecordPtr **retStats,\n                           unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    unsigned int lflags = flags & (VIR_CONNECT_LIST_DOMAINS_FILTERS_ACTIVE |\n                                   VIR_CONNECT_LIST_DOMAINS_FILTERS_PERSISTENT |\n                                   VIR_CONNECT_LIST_DOMAINS_FILTERS_STATE);\n    unsigned int supported = VIR_DOMAIN_STATS_STATE |\n                             VIR_DOMAIN_STATS_VCPU |\n                             VIR_DOMAIN_STATS_INTERFACE |\n                             VIR_DOMAIN_STATS_BALLOON |\n                             VIR_DOMAIN_STATS_BLOCK;\n    virDomainObjPtr *doms = NULL;\n    size_t ndoms;\n    virDomainStatsRecordPtr *tmpstats = NULL;\n    int nstats = 0;\n    int ret = -1;\n    size_t i;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ACTIVE |\n                  VIR_CONNECT_LIST_DOMAINS_FILTERS_PERSISTENT |\n                  VIR_CONNECT_LIST_DOMAINS_FILTERS_STATE |\n                  VIR_CONNECT_GET_ALL_DOMAINS_STATS_ENFORCE_STATS, -1);\n\n    if (virConnectGetAllDomainStatsEnsureACL(conn) < 0)\n        return -1;\n\n    if (!stats) {\n        stats = supported;\n    } else if ((flags & VIR_CONNECT_GET_ALL_DOMAINS_STATS_ENFORCE_STATS) &&\n               (stats & ~supported)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"Stats types bits 0x%x are not supported by this daemon\"),\n                       stats & ~supported);\n        return -1;\n    }\n\n    if (ndomains) {\n        if (virDomainObjListConvert(driver->domains, conn, domains, ndomains, &doms,\n                                    &ndoms, virConnectGetAllDomainStatsCheckACL,\n                                    lflags, true) < 0)\n            return -1;\n    } else {\n        if (virDomainObjListCollect(driver->domains, conn, &doms, &ndoms,\n                                    virConnectGetAllDomainStatsCheckACL,\n                                    lflags) < 0)\n            return -1;\n    }\n\n    if (VIR_ALLOC_N(tmpstats, ndoms + 1) < 0)\n        goto cleanup;\n\n    for (i = 0; i < ndoms; i++) {\n        virDomainStatsRecordPtr tmp;\n        virDomainObjPtr dom = doms[i];\n\n        virObjectLock(dom);\n        tmp = vzDomainGetAllStats(conn, dom);\n        virObjectUnlock(dom);\n\n        if (!tmp)\n            goto cleanup;\n\n        tmpstats[nstats++] = tmp;\n    }\n\n    *retStats = tmpstats;\n    tmpstats = NULL;\n    ret = nstats;\n\n cleanup:\n    virDomainStatsRecordListFree(tmpstats);\n    virObjectListFreeCount(doms, ndoms);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainGetAllStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3704-3739",
    "snippet": "static virDomainStatsRecordPtr\nvzDomainGetAllStats(virConnectPtr conn,\n                    virDomainObjPtr dom)\n{\n    virDomainStatsRecordPtr stat;\n    int maxparams = 0;\n\n    if (VIR_ALLOC(stat) < 0)\n        return NULL;\n\n    if (vzDomainGetStateStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetBlockStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetNetStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetVCPUStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetBalloonStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (!(stat->dom = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id)))\n        goto error;\n\n    return stat;\n\n error:\n    virTypedParamsFree(stat->params, stat->nparams);\n    virObjectUnref(stat->dom);\n    VIR_FREE(stat);\n    return NULL;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "stat"
          ],
          "line": 3737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "stat->dom"
          ],
          "line": 3736
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "stat->params",
            "stat->nparams"
          ],
          "line": 3735
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "dom->def->name",
            "dom->def->uuid",
            "dom->def->id"
          ],
          "line": 3729
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainGetBalloonStats",
          "args": [
            "dom",
            "stat",
            "&maxparams"
          ],
          "line": 3726
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetBalloonStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3631-3680",
          "snippet": "static int\nvzDomainGetBalloonStats(virDomainObjPtr dom,\n                        virDomainStatsRecordPtr record,\n                        int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    virDomainMemoryStatStruct stats[VIR_DOMAIN_MEMORY_STAT_NR];\n    size_t i;\n    int n;\n\n    if (virTypedParamsAddULLong(&record->params,\n                                &record->nparams,\n                                maxparams,\n                                \"balloon.maximum\",\n                                virDomainDefGetMemoryTotal(dom->def)) < 0)\n        return -1;\n\n    if (virTypedParamsAddULLong(&record->params,\n                                &record->nparams,\n                                maxparams,\n                                \"balloon.current\",\n                                virDomainDefGetMemoryTotal(dom->def)) < 0)\n        return -1;\n\n    n = prlsdkGetMemoryStats(privdom->stats, stats, VIR_DOMAIN_MEMORY_STAT_NR);\n    if (n < 0)\n        return -1;\n\n#define STORE_MEM_RECORD(TAG, NAME) \\\n    if (stats[i].tag == VIR_DOMAIN_MEMORY_STAT_ ##TAG) \\\n        if (virTypedParamsAddULLong(&record->params, \\\n                                    &record->nparams, \\\n                                    maxparams, \\\n                                    \"balloon.\" NAME, \\\n                                    stats[i].val) < 0) \\\n            return -1;\n\n    for (i = 0; i < n; i++) {\n        STORE_MEM_RECORD(SWAP_IN, \"swap_in\")\n        STORE_MEM_RECORD(SWAP_OUT, \"swap_out\")\n        STORE_MEM_RECORD(MAJOR_FAULT, \"major_fault\")\n        STORE_MEM_RECORD(MINOR_FAULT, \"minor_fault\")\n        STORE_MEM_RECORD(AVAILABLE, \"available\")\n        STORE_MEM_RECORD(UNUSED, \"unused\")\n    }\n\n#undef STORE_MEM_RECORD\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetBalloonStats(virDomainObjPtr dom,\n                        virDomainStatsRecordPtr record,\n                        int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    virDomainMemoryStatStruct stats[VIR_DOMAIN_MEMORY_STAT_NR];\n    size_t i;\n    int n;\n\n    if (virTypedParamsAddULLong(&record->params,\n                                &record->nparams,\n                                maxparams,\n                                \"balloon.maximum\",\n                                virDomainDefGetMemoryTotal(dom->def)) < 0)\n        return -1;\n\n    if (virTypedParamsAddULLong(&record->params,\n                                &record->nparams,\n                                maxparams,\n                                \"balloon.current\",\n                                virDomainDefGetMemoryTotal(dom->def)) < 0)\n        return -1;\n\n    n = prlsdkGetMemoryStats(privdom->stats, stats, VIR_DOMAIN_MEMORY_STAT_NR);\n    if (n < 0)\n        return -1;\n\n#define STORE_MEM_RECORD(TAG, NAME) \\\n    if (stats[i].tag == VIR_DOMAIN_MEMORY_STAT_ ##TAG) \\\n        if (virTypedParamsAddULLong(&record->params, \\\n                                    &record->nparams, \\\n                                    maxparams, \\\n                                    \"balloon.\" NAME, \\\n                                    stats[i].val) < 0) \\\n            return -1;\n\n    for (i = 0; i < n; i++) {\n        STORE_MEM_RECORD(SWAP_IN, \"swap_in\")\n        STORE_MEM_RECORD(SWAP_OUT, \"swap_out\")\n        STORE_MEM_RECORD(MAJOR_FAULT, \"major_fault\")\n        STORE_MEM_RECORD(MINOR_FAULT, \"minor_fault\")\n        STORE_MEM_RECORD(AVAILABLE, \"available\")\n        STORE_MEM_RECORD(UNUSED, \"unused\")\n    }\n\n#undef STORE_MEM_RECORD\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainGetVCPUStats",
          "args": [
            "dom",
            "stat",
            "&maxparams"
          ],
          "line": 3723
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetVCPUStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3580-3629",
          "snippet": "static int\nvzDomainGetVCPUStats(virDomainObjPtr dom,\n                     virDomainStatsRecordPtr record,\n                     int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"vcpu.current\",\n                              virDomainDefGetVcpus(dom->def)) < 0)\n        return -1;\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"vcpu.maximum\",\n                              virDomainDefGetVcpusMax(dom->def)) < 0)\n        return -1;\n\n    for (i = 0; i < virDomainDefGetVcpusMax(dom->def); i++) {\n        int state = dom->def->vcpus[i]->online ? VIR_VCPU_RUNNING :\n                                                 VIR_VCPU_OFFLINE;\n        unsigned long long time;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"vcpu.%zu.state\", i);\n        if (virTypedParamsAddInt(&record->params,\n                                 &record->nparams,\n                                 maxparams,\n                                 param_name,\n                                 state) < 0)\n            return -1;\n\n        if (prlsdkGetVcpuStats(privdom->stats, i, &time) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"vcpu.%zu.time\", i);\n        if (virTypedParamsAddULLong(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    time) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetVCPUStats(virDomainObjPtr dom,\n                     virDomainStatsRecordPtr record,\n                     int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"vcpu.current\",\n                              virDomainDefGetVcpus(dom->def)) < 0)\n        return -1;\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"vcpu.maximum\",\n                              virDomainDefGetVcpusMax(dom->def)) < 0)\n        return -1;\n\n    for (i = 0; i < virDomainDefGetVcpusMax(dom->def); i++) {\n        int state = dom->def->vcpus[i]->online ? VIR_VCPU_RUNNING :\n                                                 VIR_VCPU_OFFLINE;\n        unsigned long long time;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"vcpu.%zu.state\", i);\n        if (virTypedParamsAddInt(&record->params,\n                                 &record->nparams,\n                                 maxparams,\n                                 param_name,\n                                 state) < 0)\n            return -1;\n\n        if (prlsdkGetVcpuStats(privdom->stats, i, &time) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"vcpu.%zu.time\", i);\n        if (virTypedParamsAddULLong(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    time) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainGetNetStats",
          "args": [
            "dom",
            "stat",
            "&maxparams"
          ],
          "line": 3720
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetNetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3539-3578",
          "snippet": "static int\nvzDomainGetNetStats(virDomainObjPtr dom,\n                    virDomainStatsRecordPtr record,\n                    int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"net.count\",\n                              dom->def->nnets) < 0)\n        return -1;\n\n    for (i = 0; i < dom->def->nnets; i++) {\n        virDomainInterfaceStatsStruct stat;\n        virDomainNetDefPtr net = dom->def->nets[i];\n\n        if (prlsdkGetNetStats(privdom->stats, privdom->sdkdom, net->ifname,\n                              &stat) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"net.%zu.name\", i);\n        if (virTypedParamsAddString(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    net->ifname) < 0)\n            return -1;\n\n        VZ_ADD_STAT_PARAM_UUL(\"net\", rx_bytes, \"rx.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", rx_packets, \"rx.pkts\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", tx_bytes, \"tx.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", tx_packets, \"tx.pkts\");\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetNetStats(virDomainObjPtr dom,\n                    virDomainStatsRecordPtr record,\n                    int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"net.count\",\n                              dom->def->nnets) < 0)\n        return -1;\n\n    for (i = 0; i < dom->def->nnets; i++) {\n        virDomainInterfaceStatsStruct stat;\n        virDomainNetDefPtr net = dom->def->nets[i];\n\n        if (prlsdkGetNetStats(privdom->stats, privdom->sdkdom, net->ifname,\n                              &stat) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"net.%zu.name\", i);\n        if (virTypedParamsAddString(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    net->ifname) < 0)\n            return -1;\n\n        VZ_ADD_STAT_PARAM_UUL(\"net\", rx_bytes, \"rx.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", rx_packets, \"rx.pkts\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", tx_bytes, \"tx.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", tx_packets, \"tx.pkts\");\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainGetBlockStats",
          "args": [
            "dom",
            "stat",
            "&maxparams"
          ],
          "line": 3717
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetBlockStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3472-3537",
          "snippet": "static int\nvzDomainGetBlockStats(virDomainObjPtr dom,\n                      virDomainStatsRecordPtr record,\n                      int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"block.count\",\n                              dom->def->ndisks) < 0)\n        return -1;\n\n    for (i = 0; i < dom->def->ndisks; i++) {\n        virDomainBlockStatsStruct stat;\n        virDomainDiskDefPtr disk = dom->def->disks[i];\n\n        if (prlsdkGetBlockStats(privdom->stats,\n                                disk,\n                                &stat,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                   \"block.%zu.name\", i);\n        if (virTypedParamsAddString(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    disk->dst) < 0)\n            return -1;\n\n        if (virStorageSourceIsLocalStorage(disk->src) && disk->src->path) {\n            g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                       \"block.%zu.path\", i);\n            if (virTypedParamsAddString(&record->params,\n                                        &record->nparams,\n                                        maxparams,\n                                        param_name,\n                                        disk->src->path) < 0)\n                return -1;\n        }\n\n        VZ_ADD_STAT_PARAM_UUL(\"block\", rd_req, \"rd.reqs\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", rd_bytes, \"rd.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", wr_req, \"wr.reqs\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", wr_bytes, \"wr.bytes\");\n\n        if (disk->device == VIR_DOMAIN_DISK_DEVICE_DISK) {\n            g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                       \"block.%zu.capacity\", i);\n            if (virTypedParamsAddULLong(&record->params,\n                                        &record->nparams,\n                                        maxparams,\n                                        param_name,\n                                        disk->src->capacity) < 0)\n                return -1;\n        }\n\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetBlockStats(virDomainObjPtr dom,\n                      virDomainStatsRecordPtr record,\n                      int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"block.count\",\n                              dom->def->ndisks) < 0)\n        return -1;\n\n    for (i = 0; i < dom->def->ndisks; i++) {\n        virDomainBlockStatsStruct stat;\n        virDomainDiskDefPtr disk = dom->def->disks[i];\n\n        if (prlsdkGetBlockStats(privdom->stats,\n                                disk,\n                                &stat,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                   \"block.%zu.name\", i);\n        if (virTypedParamsAddString(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    disk->dst) < 0)\n            return -1;\n\n        if (virStorageSourceIsLocalStorage(disk->src) && disk->src->path) {\n            g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                       \"block.%zu.path\", i);\n            if (virTypedParamsAddString(&record->params,\n                                        &record->nparams,\n                                        maxparams,\n                                        param_name,\n                                        disk->src->path) < 0)\n                return -1;\n        }\n\n        VZ_ADD_STAT_PARAM_UUL(\"block\", rd_req, \"rd.reqs\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", rd_bytes, \"rd.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", wr_req, \"wr.reqs\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", wr_bytes, \"wr.bytes\");\n\n        if (disk->device == VIR_DOMAIN_DISK_DEVICE_DISK) {\n            g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                       \"block.%zu.capacity\", i);\n            if (virTypedParamsAddULLong(&record->params,\n                                        &record->nparams,\n                                        maxparams,\n                                        param_name,\n                                        disk->src->capacity) < 0)\n                return -1;\n        }\n\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainGetStateStats",
          "args": [
            "dom",
            "stat",
            "&maxparams"
          ],
          "line": 3714
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetStateStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3682-3702",
          "snippet": "static int\nvzDomainGetStateStats(virDomainObjPtr dom,\n                      virDomainStatsRecordPtr record,\n                      int *maxparams)\n{\n    if (virTypedParamsAddInt(&record->params,\n                             &record->nparams,\n                             maxparams,\n                             \"state.state\",\n                             dom->state.state) < 0)\n        return -1;\n\n    if (virTypedParamsAddInt(&record->params,\n                             &record->nparams,\n                             maxparams,\n                             \"state.reason\",\n                             dom->state.reason) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetStateStats(virDomainObjPtr dom,\n                      virDomainStatsRecordPtr record,\n                      int *maxparams)\n{\n    if (virTypedParamsAddInt(&record->params,\n                             &record->nparams,\n                             maxparams,\n                             \"state.state\",\n                             dom->state.state) < 0)\n        return -1;\n\n    if (virTypedParamsAddInt(&record->params,\n                             &record->nparams,\n                             maxparams,\n                             \"state.reason\",\n                             dom->state.reason) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "stat"
          ],
          "line": 3711
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainStatsRecordPtr\nvzDomainGetAllStats(virConnectPtr conn,\n                    virDomainObjPtr dom)\n{\n    virDomainStatsRecordPtr stat;\n    int maxparams = 0;\n\n    if (VIR_ALLOC(stat) < 0)\n        return NULL;\n\n    if (vzDomainGetStateStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetBlockStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetNetStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetVCPUStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (vzDomainGetBalloonStats(dom, stat, &maxparams) < 0)\n        goto error;\n\n    if (!(stat->dom = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id)))\n        goto error;\n\n    return stat;\n\n error:\n    virTypedParamsFree(stat->params, stat->nparams);\n    virObjectUnref(stat->dom);\n    VIR_FREE(stat);\n    return NULL;\n}"
  },
  {
    "function_name": "vzDomainGetStateStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3682-3702",
    "snippet": "static int\nvzDomainGetStateStats(virDomainObjPtr dom,\n                      virDomainStatsRecordPtr record,\n                      int *maxparams)\n{\n    if (virTypedParamsAddInt(&record->params,\n                             &record->nparams,\n                             maxparams,\n                             \"state.state\",\n                             dom->state.state) < 0)\n        return -1;\n\n    if (virTypedParamsAddInt(&record->params,\n                             &record->nparams,\n                             maxparams,\n                             \"state.reason\",\n                             dom->state.reason) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddInt",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "\"state.reason\"",
            "dom->state.reason"
          ],
          "line": 3694
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "437-463",
          "snippet": "int\nvirTypedParamsAddInt(virTypedParameterPtr *params,\n                     int *nparams,\n                     int *maxparams,\n                     const char *name,\n                     int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_INT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddInt(virTypedParameterPtr *params,\n                     int *nparams,\n                     int *maxparams,\n                     const char *name,\n                     int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_INT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetStateStats(virDomainObjPtr dom,\n                      virDomainStatsRecordPtr record,\n                      int *maxparams)\n{\n    if (virTypedParamsAddInt(&record->params,\n                             &record->nparams,\n                             maxparams,\n                             \"state.state\",\n                             dom->state.state) < 0)\n        return -1;\n\n    if (virTypedParamsAddInt(&record->params,\n                             &record->nparams,\n                             maxparams,\n                             \"state.reason\",\n                             dom->state.reason) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainGetBalloonStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3631-3680",
    "snippet": "static int\nvzDomainGetBalloonStats(virDomainObjPtr dom,\n                        virDomainStatsRecordPtr record,\n                        int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    virDomainMemoryStatStruct stats[VIR_DOMAIN_MEMORY_STAT_NR];\n    size_t i;\n    int n;\n\n    if (virTypedParamsAddULLong(&record->params,\n                                &record->nparams,\n                                maxparams,\n                                \"balloon.maximum\",\n                                virDomainDefGetMemoryTotal(dom->def)) < 0)\n        return -1;\n\n    if (virTypedParamsAddULLong(&record->params,\n                                &record->nparams,\n                                maxparams,\n                                \"balloon.current\",\n                                virDomainDefGetMemoryTotal(dom->def)) < 0)\n        return -1;\n\n    n = prlsdkGetMemoryStats(privdom->stats, stats, VIR_DOMAIN_MEMORY_STAT_NR);\n    if (n < 0)\n        return -1;\n\n#define STORE_MEM_RECORD(TAG, NAME) \\\n    if (stats[i].tag == VIR_DOMAIN_MEMORY_STAT_ ##TAG) \\\n        if (virTypedParamsAddULLong(&record->params, \\\n                                    &record->nparams, \\\n                                    maxparams, \\\n                                    \"balloon.\" NAME, \\\n                                    stats[i].val) < 0) \\\n            return -1;\n\n    for (i = 0; i < n; i++) {\n        STORE_MEM_RECORD(SWAP_IN, \"swap_in\")\n        STORE_MEM_RECORD(SWAP_OUT, \"swap_out\")\n        STORE_MEM_RECORD(MAJOR_FAULT, \"major_fault\")\n        STORE_MEM_RECORD(MINOR_FAULT, \"minor_fault\")\n        STORE_MEM_RECORD(AVAILABLE, \"available\")\n        STORE_MEM_RECORD(UNUSED, \"unused\")\n    }\n\n#undef STORE_MEM_RECORD\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STORE_MEM_RECORD",
          "args": [
            "UNUSED",
            "\"unused\""
          ],
          "line": 3674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STORE_MEM_RECORD",
          "args": [
            "AVAILABLE",
            "\"available\""
          ],
          "line": 3673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STORE_MEM_RECORD",
          "args": [
            "MINOR_FAULT",
            "\"minor_fault\""
          ],
          "line": 3672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STORE_MEM_RECORD",
          "args": [
            "MAJOR_FAULT",
            "\"major_fault\""
          ],
          "line": 3671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STORE_MEM_RECORD",
          "args": [
            "SWAP_OUT",
            "\"swap_out\""
          ],
          "line": 3670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STORE_MEM_RECORD",
          "args": [
            "SWAP_IN",
            "\"swap_in\""
          ],
          "line": 3669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prlsdkGetMemoryStats",
          "args": [
            "privdom->stats",
            "stats",
            "VIR_DOMAIN_MEMORY_STAT_NR"
          ],
          "line": 3655
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetMemoryStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4501-4556",
          "snippet": "int\nprlsdkGetMemoryStats(PRL_HANDLE sdkstats,\n                     virDomainMemoryStatPtr stats,\n                     unsigned int nr_stats)\n{\n    long long v = 0, t = 0, u = 0;\n    size_t i = 0;\n\n#define PRLSDK_GET_COUNTER(NAME, VALUE) \\\n    if (prlsdkExtractStatsParam(sdkstats, NAME, &VALUE) < 0) \\\n        return -1; \\\n\n#define PRLSDK_MEMORY_STAT_SET(TAG, VALUE) \\\n    if (i < nr_stats) { \\\n        stats[i].tag = (TAG); \\\n        stats[i].val = (VALUE); \\\n        i++; \\\n    }\n\n    i = 0;\n\n    // count to kb\n    PRLSDK_GET_COUNTER(\"guest.ram.swap_in\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_SWAP_IN, v << 12)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.swap_out\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_SWAP_OUT, v << 12)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.minor_fault\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_MINOR_FAULT, v)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.major_fault\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_MAJOR_FAULT, v)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.total\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_AVAILABLE, v << 10)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.balloon_actual\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_ACTUAL_BALLOON, v << 10)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.usage\", u)\n    PRLSDK_GET_COUNTER(\"guest.ram.total\", t)\n    if (u != -1 && t != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_UNUSED, (t - u) << 10)\n\n#undef PRLSDK_GET_COUNTER\n#undef PRLSDK_MEMORY_STAT_SET\n\n    return i;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkGetMemoryStats(PRL_HANDLE sdkstats,\n                     virDomainMemoryStatPtr stats,\n                     unsigned int nr_stats)\n{\n    long long v = 0, t = 0, u = 0;\n    size_t i = 0;\n\n#define PRLSDK_GET_COUNTER(NAME, VALUE) \\\n    if (prlsdkExtractStatsParam(sdkstats, NAME, &VALUE) < 0) \\\n        return -1; \\\n\n#define PRLSDK_MEMORY_STAT_SET(TAG, VALUE) \\\n    if (i < nr_stats) { \\\n        stats[i].tag = (TAG); \\\n        stats[i].val = (VALUE); \\\n        i++; \\\n    }\n\n    i = 0;\n\n    // count to kb\n    PRLSDK_GET_COUNTER(\"guest.ram.swap_in\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_SWAP_IN, v << 12)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.swap_out\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_SWAP_OUT, v << 12)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.minor_fault\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_MINOR_FAULT, v)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.major_fault\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_MAJOR_FAULT, v)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.total\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_AVAILABLE, v << 10)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.balloon_actual\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_ACTUAL_BALLOON, v << 10)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.usage\", u)\n    PRLSDK_GET_COUNTER(\"guest.ram.total\", t)\n    if (u != -1 && t != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_UNUSED, (t - u) << 10)\n\n#undef PRLSDK_GET_COUNTER\n#undef PRLSDK_MEMORY_STAT_SET\n\n    return i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "\"balloon.current\"",
            "virDomainDefGetMemoryTotal(dom->def)"
          ],
          "line": 3648
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "dom->def"
          ],
          "line": 3652
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetBalloonStats(virDomainObjPtr dom,\n                        virDomainStatsRecordPtr record,\n                        int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    virDomainMemoryStatStruct stats[VIR_DOMAIN_MEMORY_STAT_NR];\n    size_t i;\n    int n;\n\n    if (virTypedParamsAddULLong(&record->params,\n                                &record->nparams,\n                                maxparams,\n                                \"balloon.maximum\",\n                                virDomainDefGetMemoryTotal(dom->def)) < 0)\n        return -1;\n\n    if (virTypedParamsAddULLong(&record->params,\n                                &record->nparams,\n                                maxparams,\n                                \"balloon.current\",\n                                virDomainDefGetMemoryTotal(dom->def)) < 0)\n        return -1;\n\n    n = prlsdkGetMemoryStats(privdom->stats, stats, VIR_DOMAIN_MEMORY_STAT_NR);\n    if (n < 0)\n        return -1;\n\n#define STORE_MEM_RECORD(TAG, NAME) \\\n    if (stats[i].tag == VIR_DOMAIN_MEMORY_STAT_ ##TAG) \\\n        if (virTypedParamsAddULLong(&record->params, \\\n                                    &record->nparams, \\\n                                    maxparams, \\\n                                    \"balloon.\" NAME, \\\n                                    stats[i].val) < 0) \\\n            return -1;\n\n    for (i = 0; i < n; i++) {\n        STORE_MEM_RECORD(SWAP_IN, \"swap_in\")\n        STORE_MEM_RECORD(SWAP_OUT, \"swap_out\")\n        STORE_MEM_RECORD(MAJOR_FAULT, \"major_fault\")\n        STORE_MEM_RECORD(MINOR_FAULT, \"minor_fault\")\n        STORE_MEM_RECORD(AVAILABLE, \"available\")\n        STORE_MEM_RECORD(UNUSED, \"unused\")\n    }\n\n#undef STORE_MEM_RECORD\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainGetVCPUStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3580-3629",
    "snippet": "static int\nvzDomainGetVCPUStats(virDomainObjPtr dom,\n                     virDomainStatsRecordPtr record,\n                     int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"vcpu.current\",\n                              virDomainDefGetVcpus(dom->def)) < 0)\n        return -1;\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"vcpu.maximum\",\n                              virDomainDefGetVcpusMax(dom->def)) < 0)\n        return -1;\n\n    for (i = 0; i < virDomainDefGetVcpusMax(dom->def); i++) {\n        int state = dom->def->vcpus[i]->online ? VIR_VCPU_RUNNING :\n                                                 VIR_VCPU_OFFLINE;\n        unsigned long long time;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"vcpu.%zu.state\", i);\n        if (virTypedParamsAddInt(&record->params,\n                                 &record->nparams,\n                                 maxparams,\n                                 param_name,\n                                 state) < 0)\n            return -1;\n\n        if (prlsdkGetVcpuStats(privdom->stats, i, &time) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"vcpu.%zu.time\", i);\n        if (virTypedParamsAddULLong(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    time) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "param_name",
            "time"
          ],
          "line": 3620
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "param_name",
            "VIR_TYPED_PARAM_FIELD_LENGTH",
            "\"vcpu.%zu.time\"",
            "i"
          ],
          "line": 3619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prlsdkGetVcpuStats",
          "args": [
            "privdom->stats",
            "i",
            "&time"
          ],
          "line": 3616
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetVcpuStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4483-4499",
          "snippet": "int\nprlsdkGetVcpuStats(PRL_HANDLE sdkstats, int idx, unsigned long long *vtime)\n{\n    char *name = NULL;\n    long long ptime = 0;\n    int ret = -1;\n\n    name = g_strdup_printf(\"guest.vcpu%u.time\", (unsigned int)idx);\n    if (prlsdkExtractStatsParam(sdkstats, name, &ptime) < 0)\n        goto cleanup;\n    *vtime = ptime == -1 ? 0 : ptime;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkGetVcpuStats(PRL_HANDLE sdkstats, int idx, unsigned long long *vtime)\n{\n    char *name = NULL;\n    long long ptime = 0;\n    int ret = -1;\n\n    name = g_strdup_printf(\"guest.vcpu%u.time\", (unsigned int)idx);\n    if (prlsdkExtractStatsParam(sdkstats, name, &ptime) < 0)\n        goto cleanup;\n    *vtime = ptime == -1 ? 0 : ptime;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddInt",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "param_name",
            "state"
          ],
          "line": 3609
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "437-463",
          "snippet": "int\nvirTypedParamsAddInt(virTypedParameterPtr *params,\n                     int *nparams,\n                     int *maxparams,\n                     const char *name,\n                     int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_INT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddInt(virTypedParameterPtr *params,\n                     int *nparams,\n                     int *maxparams,\n                     const char *name,\n                     int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_INT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "param_name",
            "VIR_TYPED_PARAM_FIELD_LENGTH",
            "\"vcpu.%zu.state\"",
            "i"
          ],
          "line": 3608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpusMax",
          "args": [
            "dom->def"
          ],
          "line": 3603
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpusMax",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1882-1886",
          "snippet": "unsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddUInt",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "\"vcpu.maximum\"",
            "virDomainDefGetVcpusMax(dom->def)"
          ],
          "line": 3596
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "484-510",
          "snippet": "int\nvirTypedParamsAddUInt(virTypedParameterPtr *params,\n                      int *nparams,\n                      int *maxparams,\n                      const char *name,\n                      unsigned int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_UINT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddUInt(virTypedParameterPtr *params,\n                      int *nparams,\n                      int *maxparams,\n                      const char *name,\n                      unsigned int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_UINT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpus",
          "args": [
            "dom->def"
          ],
          "line": 3593
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1912-1924",
          "snippet": "unsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetVCPUStats(virDomainObjPtr dom,\n                     virDomainStatsRecordPtr record,\n                     int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"vcpu.current\",\n                              virDomainDefGetVcpus(dom->def)) < 0)\n        return -1;\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"vcpu.maximum\",\n                              virDomainDefGetVcpusMax(dom->def)) < 0)\n        return -1;\n\n    for (i = 0; i < virDomainDefGetVcpusMax(dom->def); i++) {\n        int state = dom->def->vcpus[i]->online ? VIR_VCPU_RUNNING :\n                                                 VIR_VCPU_OFFLINE;\n        unsigned long long time;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"vcpu.%zu.state\", i);\n        if (virTypedParamsAddInt(&record->params,\n                                 &record->nparams,\n                                 maxparams,\n                                 param_name,\n                                 state) < 0)\n            return -1;\n\n        if (prlsdkGetVcpuStats(privdom->stats, i, &time) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"vcpu.%zu.time\", i);\n        if (virTypedParamsAddULLong(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    time) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainGetNetStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3539-3578",
    "snippet": "static int\nvzDomainGetNetStats(virDomainObjPtr dom,\n                    virDomainStatsRecordPtr record,\n                    int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"net.count\",\n                              dom->def->nnets) < 0)\n        return -1;\n\n    for (i = 0; i < dom->def->nnets; i++) {\n        virDomainInterfaceStatsStruct stat;\n        virDomainNetDefPtr net = dom->def->nets[i];\n\n        if (prlsdkGetNetStats(privdom->stats, privdom->sdkdom, net->ifname,\n                              &stat) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"net.%zu.name\", i);\n        if (virTypedParamsAddString(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    net->ifname) < 0)\n            return -1;\n\n        VZ_ADD_STAT_PARAM_UUL(\"net\", rx_bytes, \"rx.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", rx_packets, \"rx.pkts\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", tx_bytes, \"tx.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", tx_packets, \"tx.pkts\");\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VZ_ADD_STAT_PARAM_UUL",
          "args": [
            "\"net\"",
            "tx_packets",
            "\"tx.pkts\""
          ],
          "line": 3574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VZ_ADD_STAT_PARAM_UUL",
          "args": [
            "\"net\"",
            "tx_bytes",
            "\"tx.bytes\""
          ],
          "line": 3573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VZ_ADD_STAT_PARAM_UUL",
          "args": [
            "\"net\"",
            "rx_packets",
            "\"rx.pkts\""
          ],
          "line": 3572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VZ_ADD_STAT_PARAM_UUL",
          "args": [
            "\"net\"",
            "rx_bytes",
            "\"rx.bytes\""
          ],
          "line": 3571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "param_name",
            "net->ifname"
          ],
          "line": 3564
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "param_name",
            "VIR_TYPED_PARAM_FIELD_LENGTH",
            "\"net.%zu.name\"",
            "i"
          ],
          "line": 3563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prlsdkGetNetStats",
          "args": [
            "privdom->stats",
            "privdom->sdkdom",
            "net->ifname",
            "&stat"
          ],
          "line": 3559
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetNetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4436-4481",
          "snippet": "int\nprlsdkGetNetStats(PRL_HANDLE sdkstats, PRL_HANDLE sdkdom, const char *device,\n                  virDomainInterfaceStatsPtr stats)\n{\n    int ret = -1;\n    PRL_UINT32 net_index = -1;\n    char *name = NULL;\n    PRL_RESULT pret;\n    PRL_HANDLE net = PRL_INVALID_HANDLE;\n    virMacAddr mac;\n\n    if (virMacAddrParse(device, &mac) == 0)\n        net = prlsdkFindNetByMAC(sdkdom, &mac);\n    else\n        net = prlsdkFindNetByPath(sdkdom, device);\n\n    if (net == PRL_INVALID_HANDLE)\n       goto cleanup;\n\n    pret = PrlVmDev_GetIndex(net, &net_index);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n#define PRLSDK_GET_NET_COUNTER(VAL, NAME) \\\n    name = g_strdup_printf(\"net.nic%u.%s\", net_index, NAME); \\\n    if (prlsdkExtractStatsParam(sdkstats, name, &stats->VAL) < 0) \\\n        goto cleanup; \\\n    VIR_FREE(name);\n\n    PRLSDK_GET_NET_COUNTER(rx_bytes, \"bytes_in\")\n    PRLSDK_GET_NET_COUNTER(rx_packets, \"pkts_in\")\n    PRLSDK_GET_NET_COUNTER(tx_bytes, \"bytes_out\")\n    PRLSDK_GET_NET_COUNTER(tx_packets, \"pkts_out\")\n    stats->rx_errs = -1;\n    stats->rx_drop = -1;\n    stats->tx_errs = -1;\n    stats->tx_drop = -1;\n\n#undef PRLSDK_GET_NET_COUNTER\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    PrlHandle_Free(net);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);",
            "static PRL_HANDLE\nprlsdkFindNetByMAC(PRL_HANDLE sdkdom, virMacAddrPtr mac);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\nstatic PRL_HANDLE\nprlsdkFindNetByMAC(PRL_HANDLE sdkdom, virMacAddrPtr mac);\n\nint\nprlsdkGetNetStats(PRL_HANDLE sdkstats, PRL_HANDLE sdkdom, const char *device,\n                  virDomainInterfaceStatsPtr stats)\n{\n    int ret = -1;\n    PRL_UINT32 net_index = -1;\n    char *name = NULL;\n    PRL_RESULT pret;\n    PRL_HANDLE net = PRL_INVALID_HANDLE;\n    virMacAddr mac;\n\n    if (virMacAddrParse(device, &mac) == 0)\n        net = prlsdkFindNetByMAC(sdkdom, &mac);\n    else\n        net = prlsdkFindNetByPath(sdkdom, device);\n\n    if (net == PRL_INVALID_HANDLE)\n       goto cleanup;\n\n    pret = PrlVmDev_GetIndex(net, &net_index);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n#define PRLSDK_GET_NET_COUNTER(VAL, NAME) \\\n    name = g_strdup_printf(\"net.nic%u.%s\", net_index, NAME); \\\n    if (prlsdkExtractStatsParam(sdkstats, name, &stats->VAL) < 0) \\\n        goto cleanup; \\\n    VIR_FREE(name);\n\n    PRLSDK_GET_NET_COUNTER(rx_bytes, \"bytes_in\")\n    PRLSDK_GET_NET_COUNTER(rx_packets, \"pkts_in\")\n    PRLSDK_GET_NET_COUNTER(tx_bytes, \"bytes_out\")\n    PRLSDK_GET_NET_COUNTER(tx_packets, \"pkts_out\")\n    stats->rx_errs = -1;\n    stats->rx_drop = -1;\n    stats->tx_errs = -1;\n    stats->tx_drop = -1;\n\n#undef PRLSDK_GET_NET_COUNTER\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    PrlHandle_Free(net);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddUInt",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "\"net.count\"",
            "dom->def->nnets"
          ],
          "line": 3548
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "484-510",
          "snippet": "int\nvirTypedParamsAddUInt(virTypedParameterPtr *params,\n                      int *nparams,\n                      int *maxparams,\n                      const char *name,\n                      unsigned int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_UINT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddUInt(virTypedParameterPtr *params,\n                      int *nparams,\n                      int *maxparams,\n                      const char *name,\n                      unsigned int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_UINT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetNetStats(virDomainObjPtr dom,\n                    virDomainStatsRecordPtr record,\n                    int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"net.count\",\n                              dom->def->nnets) < 0)\n        return -1;\n\n    for (i = 0; i < dom->def->nnets; i++) {\n        virDomainInterfaceStatsStruct stat;\n        virDomainNetDefPtr net = dom->def->nets[i];\n\n        if (prlsdkGetNetStats(privdom->stats, privdom->sdkdom, net->ifname,\n                              &stat) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH, \"net.%zu.name\", i);\n        if (virTypedParamsAddString(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    net->ifname) < 0)\n            return -1;\n\n        VZ_ADD_STAT_PARAM_UUL(\"net\", rx_bytes, \"rx.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", rx_packets, \"rx.pkts\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", tx_bytes, \"tx.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"net\", tx_packets, \"tx.pkts\");\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainGetBlockStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3472-3537",
    "snippet": "static int\nvzDomainGetBlockStats(virDomainObjPtr dom,\n                      virDomainStatsRecordPtr record,\n                      int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"block.count\",\n                              dom->def->ndisks) < 0)\n        return -1;\n\n    for (i = 0; i < dom->def->ndisks; i++) {\n        virDomainBlockStatsStruct stat;\n        virDomainDiskDefPtr disk = dom->def->disks[i];\n\n        if (prlsdkGetBlockStats(privdom->stats,\n                                disk,\n                                &stat,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                   \"block.%zu.name\", i);\n        if (virTypedParamsAddString(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    disk->dst) < 0)\n            return -1;\n\n        if (virStorageSourceIsLocalStorage(disk->src) && disk->src->path) {\n            g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                       \"block.%zu.path\", i);\n            if (virTypedParamsAddString(&record->params,\n                                        &record->nparams,\n                                        maxparams,\n                                        param_name,\n                                        disk->src->path) < 0)\n                return -1;\n        }\n\n        VZ_ADD_STAT_PARAM_UUL(\"block\", rd_req, \"rd.reqs\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", rd_bytes, \"rd.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", wr_req, \"wr.reqs\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", wr_bytes, \"wr.bytes\");\n\n        if (disk->device == VIR_DOMAIN_DISK_DEVICE_DISK) {\n            g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                       \"block.%zu.capacity\", i);\n            if (virTypedParamsAddULLong(&record->params,\n                                        &record->nparams,\n                                        maxparams,\n                                        param_name,\n                                        disk->src->capacity) < 0)\n                return -1;\n        }\n\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "param_name",
            "disk->src->capacity"
          ],
          "line": 3526
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "param_name",
            "VIR_TYPED_PARAM_FIELD_LENGTH",
            "\"block.%zu.capacity\"",
            "i"
          ],
          "line": 3524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VZ_ADD_STAT_PARAM_UUL",
          "args": [
            "\"block\"",
            "wr_bytes",
            "\"wr.bytes\""
          ],
          "line": 3521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VZ_ADD_STAT_PARAM_UUL",
          "args": [
            "\"block\"",
            "wr_req",
            "\"wr.reqs\""
          ],
          "line": 3520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VZ_ADD_STAT_PARAM_UUL",
          "args": [
            "\"block\"",
            "rd_bytes",
            "\"rd.bytes\""
          ],
          "line": 3519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VZ_ADD_STAT_PARAM_UUL",
          "args": [
            "\"block\"",
            "rd_req",
            "\"rd.reqs\""
          ],
          "line": 3518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "param_name",
            "disk->src->path"
          ],
          "line": 3510
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "param_name",
            "VIR_TYPED_PARAM_FIELD_LENGTH",
            "\"block.%zu.path\"",
            "i"
          ],
          "line": 3508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsLocalStorage",
          "args": [
            "disk->src"
          ],
          "line": 3507
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsLocalStorage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2586-2608",
          "snippet": "bool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "param_name",
            "VIR_TYPED_PARAM_FIELD_LENGTH",
            "\"block.%zu.name\"",
            "i"
          ],
          "line": 3498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prlsdkGetBlockStats",
          "args": [
            "privdom->stats",
            "disk",
            "&stat",
            "IS_CT(dom->def)"
          ],
          "line": 3492
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetBlockStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4339-4394",
          "snippet": "int\nprlsdkGetBlockStats(PRL_HANDLE sdkstats,\n                    virDomainDiskDefPtr disk,\n                    virDomainBlockStatsPtr stats,\n                    bool isCt)\n{\n    virDomainDeviceDriveAddressPtr address;\n    int idx;\n    const char *prefix;\n    int ret = -1;\n    char *name = NULL;\n\n    address = &disk->info.addr.drive;\n\n    if (isCt) {\n        prefix = \"hdd\";\n        idx = address->unit;\n    } else {\n        switch (disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_IDE:\n            prefix = \"ide\";\n            idx = address->bus * 2 + address->unit;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SATA:\n            prefix = \"sata\";\n            idx = address->unit;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            prefix = \"scsi\";\n            idx = address->unit;\n            break;\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unknown disk bus: %X\"), disk->bus);\n            goto cleanup;\n        }\n    }\n\n\n#define PRLSDK_GET_STAT_PARAM(VAL, TYPE, NAME) \\\n    name = g_strdup_printf(\"devices.%s%d.%s\", prefix, idx, NAME); \\\n    if (prlsdkExtractStatsParam(sdkstats, name, &stats->VAL) < 0) \\\n        goto cleanup; \\\n    VIR_FREE(name);\n\n    PARALLELS_BLOCK_STATS_FOREACH(PRLSDK_GET_STAT_PARAM)\n\n#undef PRLSDK_GET_STAT_PARAM\n\n    ret = 0;\n\n cleanup:\n\n    VIR_FREE(name);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);\n\nint\nprlsdkGetBlockStats(PRL_HANDLE sdkstats,\n                    virDomainDiskDefPtr disk,\n                    virDomainBlockStatsPtr stats,\n                    bool isCt)\n{\n    virDomainDeviceDriveAddressPtr address;\n    int idx;\n    const char *prefix;\n    int ret = -1;\n    char *name = NULL;\n\n    address = &disk->info.addr.drive;\n\n    if (isCt) {\n        prefix = \"hdd\";\n        idx = address->unit;\n    } else {\n        switch (disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_IDE:\n            prefix = \"ide\";\n            idx = address->bus * 2 + address->unit;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SATA:\n            prefix = \"sata\";\n            idx = address->unit;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            prefix = \"scsi\";\n            idx = address->unit;\n            break;\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unknown disk bus: %X\"), disk->bus);\n            goto cleanup;\n        }\n    }\n\n\n#define PRLSDK_GET_STAT_PARAM(VAL, TYPE, NAME) \\\n    name = g_strdup_printf(\"devices.%s%d.%s\", prefix, idx, NAME); \\\n    if (prlsdkExtractStatsParam(sdkstats, name, &stats->VAL) < 0) \\\n        goto cleanup; \\\n    VIR_FREE(name);\n\n    PARALLELS_BLOCK_STATS_FOREACH(PRLSDK_GET_STAT_PARAM)\n\n#undef PRLSDK_GET_STAT_PARAM\n\n    ret = 0;\n\n cleanup:\n\n    VIR_FREE(name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_CT",
          "args": [
            "dom->def"
          ],
          "line": 3495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddUInt",
          "args": [
            "&record->params",
            "&record->nparams",
            "maxparams",
            "\"block.count\"",
            "dom->def->ndisks"
          ],
          "line": 3481
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "484-510",
          "snippet": "int\nvirTypedParamsAddUInt(virTypedParameterPtr *params,\n                      int *nparams,\n                      int *maxparams,\n                      const char *name,\n                      unsigned int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_UINT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddUInt(virTypedParameterPtr *params,\n                      int *nparams,\n                      int *maxparams,\n                      const char *name,\n                      unsigned int value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_UINT, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetBlockStats(virDomainObjPtr dom,\n                      virDomainStatsRecordPtr record,\n                      int *maxparams)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    char param_name[VIR_TYPED_PARAM_FIELD_LENGTH];\n\n    if (virTypedParamsAddUInt(&record->params,\n                              &record->nparams,\n                              maxparams,\n                              \"block.count\",\n                              dom->def->ndisks) < 0)\n        return -1;\n\n    for (i = 0; i < dom->def->ndisks; i++) {\n        virDomainBlockStatsStruct stat;\n        virDomainDiskDefPtr disk = dom->def->disks[i];\n\n        if (prlsdkGetBlockStats(privdom->stats,\n                                disk,\n                                &stat,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n\n        g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                   \"block.%zu.name\", i);\n        if (virTypedParamsAddString(&record->params,\n                                    &record->nparams,\n                                    maxparams,\n                                    param_name,\n                                    disk->dst) < 0)\n            return -1;\n\n        if (virStorageSourceIsLocalStorage(disk->src) && disk->src->path) {\n            g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                       \"block.%zu.path\", i);\n            if (virTypedParamsAddString(&record->params,\n                                        &record->nparams,\n                                        maxparams,\n                                        param_name,\n                                        disk->src->path) < 0)\n                return -1;\n        }\n\n        VZ_ADD_STAT_PARAM_UUL(\"block\", rd_req, \"rd.reqs\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", rd_bytes, \"rd.bytes\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", wr_req, \"wr.reqs\");\n        VZ_ADD_STAT_PARAM_UUL(\"block\", wr_bytes, \"wr.bytes\");\n\n        if (disk->device == VIR_DOMAIN_DISK_DEVICE_DISK) {\n            g_snprintf(param_name, VIR_TYPED_PARAM_FIELD_LENGTH,\n                       \"block.%zu.capacity\", i);\n            if (virTypedParamsAddULLong(&record->params,\n                                        &record->nparams,\n                                        maxparams,\n                                        param_name,\n                                        disk->src->capacity) < 0)\n                return -1;\n        }\n\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainGetJobStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3420-3456",
    "snippet": "static int\nvzDomainGetJobStats(virDomainPtr domain,\n                    int *type,\n                    virTypedParameterPtr *params,\n                    int *nparams,\n                    unsigned int flags)\n{\n    virDomainJobInfo info;\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetJobStatsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainGetJobInfoImpl(dom, &info) < 0)\n        goto cleanup;\n\n    if (info.type == VIR_DOMAIN_JOB_NONE) {\n        *type = VIR_DOMAIN_JOB_NONE;\n        *params = NULL;\n        *nparams = 0;\n        ret = 0;\n        goto cleanup;\n    }\n\n    ret = vzDomainJobInfoToParams(&info, type, params, nparams);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 3453
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainJobInfoToParams",
          "args": [
            "&info",
            "type",
            "params",
            "nparams"
          ],
          "line": 3450
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainJobInfoToParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3385-3418",
          "snippet": "static int\nvzDomainJobInfoToParams(virDomainJobInfoPtr info,\n                        int *type,\n                        virTypedParameterPtr *params,\n                        int *nparams)\n{\n    virTypedParameterPtr par = NULL;\n    int maxpar = 0;\n    int npar = 0;\n\n    if (virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_TIME_ELAPSED,\n                                info->timeElapsed) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_TOTAL,\n                                info->dataTotal) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_PROCESSED,\n                                info->dataProcessed) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_REMAINING,\n                                info->dataRemaining) < 0)\n        goto error;\n\n\n    *type = info->type;\n    *params = par;\n    *nparams = npar;\n    return 0;\n\n error:\n    virTypedParamsFree(par, npar);\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainJobInfoToParams(virDomainJobInfoPtr info,\n                        int *type,\n                        virTypedParameterPtr *params,\n                        int *nparams)\n{\n    virTypedParameterPtr par = NULL;\n    int maxpar = 0;\n    int npar = 0;\n\n    if (virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_TIME_ELAPSED,\n                                info->timeElapsed) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_TOTAL,\n                                info->dataTotal) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_PROCESSED,\n                                info->dataProcessed) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_REMAINING,\n                                info->dataRemaining) < 0)\n        goto error;\n\n\n    *type = info->type;\n    *params = par;\n    *nparams = npar;\n    return 0;\n\n error:\n    virTypedParamsFree(par, npar);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainGetJobInfoImpl",
          "args": [
            "dom",
            "&info"
          ],
          "line": 3439
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetJobInfoImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3343-3364",
          "snippet": "static int\nvzDomainGetJobInfoImpl(virDomainObjPtr dom, virDomainJobInfoPtr info)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    vzDomainJobObjPtr job = &privdom->job;\n\n    memset(info, 0, sizeof(*info));\n\n    if (!job->active || !job->hasProgress)\n        return 0;\n\n    if (vzDomainJobUpdateTime(job) < 0)\n        return -1;\n\n    info->type = VIR_DOMAIN_JOB_UNBOUNDED;\n    info->dataTotal = 100;\n    info->dataProcessed = job->progress;\n    info->dataRemaining = 100 - job->progress;\n    info->timeElapsed = job->elapsed;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetJobInfoImpl(virDomainObjPtr dom, virDomainJobInfoPtr info)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    vzDomainJobObjPtr job = &privdom->job;\n\n    memset(info, 0, sizeof(*info));\n\n    if (!job->active || !job->hasProgress)\n        return 0;\n\n    if (vzDomainJobUpdateTime(job) < 0)\n        return -1;\n\n    info->type = VIR_DOMAIN_JOB_UNBOUNDED;\n    info->dataTotal = 100;\n    info->dataProcessed = job->progress;\n    info->dataRemaining = 100 - job->progress;\n    info->timeElapsed = job->elapsed;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetJobStatsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 3436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 3433
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 3431
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetJobStats(virDomainPtr domain,\n                    int *type,\n                    virTypedParameterPtr *params,\n                    int *nparams,\n                    unsigned int flags)\n{\n    virDomainJobInfo info;\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetJobStatsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainGetJobInfoImpl(dom, &info) < 0)\n        goto cleanup;\n\n    if (info.type == VIR_DOMAIN_JOB_NONE) {\n        *type = VIR_DOMAIN_JOB_NONE;\n        *params = NULL;\n        *nparams = 0;\n        ret = 0;\n        goto cleanup;\n    }\n\n    ret = vzDomainJobInfoToParams(&info, type, params, nparams);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainJobInfoToParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3385-3418",
    "snippet": "static int\nvzDomainJobInfoToParams(virDomainJobInfoPtr info,\n                        int *type,\n                        virTypedParameterPtr *params,\n                        int *nparams)\n{\n    virTypedParameterPtr par = NULL;\n    int maxpar = 0;\n    int npar = 0;\n\n    if (virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_TIME_ELAPSED,\n                                info->timeElapsed) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_TOTAL,\n                                info->dataTotal) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_PROCESSED,\n                                info->dataProcessed) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_REMAINING,\n                                info->dataRemaining) < 0)\n        goto error;\n\n\n    *type = info->type;\n    *params = par;\n    *nparams = npar;\n    return 0;\n\n error:\n    virTypedParamsFree(par, npar);\n    return -1;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "par",
            "npar"
          ],
          "line": 3416
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&par",
            "&npar",
            "&maxpar",
            "VIR_DOMAIN_JOB_DATA_REMAINING",
            "info->dataRemaining"
          ],
          "line": 3404
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainJobInfoToParams(virDomainJobInfoPtr info,\n                        int *type,\n                        virTypedParameterPtr *params,\n                        int *nparams)\n{\n    virTypedParameterPtr par = NULL;\n    int maxpar = 0;\n    int npar = 0;\n\n    if (virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_TIME_ELAPSED,\n                                info->timeElapsed) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_TOTAL,\n                                info->dataTotal) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_PROCESSED,\n                                info->dataProcessed) < 0 ||\n        virTypedParamsAddULLong(&par, &npar, &maxpar,\n                                VIR_DOMAIN_JOB_DATA_REMAINING,\n                                info->dataRemaining) < 0)\n        goto error;\n\n\n    *type = info->type;\n    *params = par;\n    *nparams = npar;\n    return 0;\n\n error:\n    virTypedParamsFree(par, npar);\n    return -1;\n}"
  },
  {
    "function_name": "vzDomainGetJobInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3366-3383",
    "snippet": "static int\nvzDomainGetJobInfo(virDomainPtr domain, virDomainJobInfoPtr info)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetJobInfoEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = vzDomainGetJobInfoImpl(dom, info);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 3381
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainGetJobInfoImpl",
          "args": [
            "dom",
            "info"
          ],
          "line": 3378
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetJobInfoImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3343-3364",
          "snippet": "static int\nvzDomainGetJobInfoImpl(virDomainObjPtr dom, virDomainJobInfoPtr info)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    vzDomainJobObjPtr job = &privdom->job;\n\n    memset(info, 0, sizeof(*info));\n\n    if (!job->active || !job->hasProgress)\n        return 0;\n\n    if (vzDomainJobUpdateTime(job) < 0)\n        return -1;\n\n    info->type = VIR_DOMAIN_JOB_UNBOUNDED;\n    info->dataTotal = 100;\n    info->dataProcessed = job->progress;\n    info->dataRemaining = 100 - job->progress;\n    info->timeElapsed = job->elapsed;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetJobInfoImpl(virDomainObjPtr dom, virDomainJobInfoPtr info)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    vzDomainJobObjPtr job = &privdom->job;\n\n    memset(info, 0, sizeof(*info));\n\n    if (!job->active || !job->hasProgress)\n        return 0;\n\n    if (vzDomainJobUpdateTime(job) < 0)\n        return -1;\n\n    info->type = VIR_DOMAIN_JOB_UNBOUNDED;\n    info->dataTotal = 100;\n    info->dataProcessed = job->progress;\n    info->dataRemaining = 100 - job->progress;\n    info->timeElapsed = job->elapsed;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetJobInfoEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 3375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 3372
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetJobInfo(virDomainPtr domain, virDomainJobInfoPtr info)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetJobInfoEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = vzDomainGetJobInfoImpl(dom, info);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainGetJobInfoImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3343-3364",
    "snippet": "static int\nvzDomainGetJobInfoImpl(virDomainObjPtr dom, virDomainJobInfoPtr info)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    vzDomainJobObjPtr job = &privdom->job;\n\n    memset(info, 0, sizeof(*info));\n\n    if (!job->active || !job->hasProgress)\n        return 0;\n\n    if (vzDomainJobUpdateTime(job) < 0)\n        return -1;\n\n    info->type = VIR_DOMAIN_JOB_UNBOUNDED;\n    info->dataTotal = 100;\n    info->dataProcessed = job->progress;\n    info->dataRemaining = 100 - job->progress;\n    info->timeElapsed = job->elapsed;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainJobUpdateTime",
          "args": [
            "job"
          ],
          "line": 3354
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainJobUpdateTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "637-656",
          "snippet": "int\nvzDomainJobUpdateTime(vzDomainJobObjPtr job)\n{\n    unsigned long long now;\n\n    if (!job->started)\n        return 0;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    if (now < job->started) {\n        VIR_WARN(\"Async job starts in the future\");\n        job->started = 0;\n        return 0;\n    }\n\n    job->elapsed = now - job->started;\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvzDomainJobUpdateTime(vzDomainJobObjPtr job)\n{\n    unsigned long long now;\n\n    if (!job->started)\n        return 0;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    if (now < job->started) {\n        VIR_WARN(\"Async job starts in the future\");\n        job->started = 0;\n        return 0;\n    }\n\n    job->elapsed = now - job->started;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 3349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetJobInfoImpl(virDomainObjPtr dom, virDomainJobInfoPtr info)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    vzDomainJobObjPtr job = &privdom->job;\n\n    memset(info, 0, sizeof(*info));\n\n    if (!job->active || !job->hasProgress)\n        return 0;\n\n    if (vzDomainJobUpdateTime(job) < 0)\n        return -1;\n\n    info->type = VIR_DOMAIN_JOB_UNBOUNDED;\n    info->dataTotal = 100;\n    info->dataProcessed = job->progress;\n    info->dataRemaining = 100 - job->progress;\n    info->timeElapsed = job->elapsed;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainMigrateConfirm3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3326-3341",
    "snippet": "static int\nvzDomainMigrateConfirm3Params(virDomainPtr domain G_GNUC_UNUSED,\n                              virTypedParameterPtr params,\n                              int nparams,\n                              const char *cookiein G_GNUC_UNUSED,\n                              int cookieinlen G_GNUC_UNUSED,\n                              unsigned int flags,\n                              int cancelled G_GNUC_UNUSED)\n{\n    virCheckFlags(VZ_MIGRATION_FLAGS, -1);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL",
      "#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VZ_MIGRATION_PARAMETERS"
          ],
          "line": 3337
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VZ_MIGRATION_FLAGS",
            "-1"
          ],
          "line": 3335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL\n#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)\n\nstatic int\nvzDomainMigrateConfirm3Params(virDomainPtr domain G_GNUC_UNUSED,\n                              virTypedParameterPtr params,\n                              int nparams,\n                              const char *cookiein G_GNUC_UNUSED,\n                              int cookieinlen G_GNUC_UNUSED,\n                              unsigned int flags,\n                              int cancelled G_GNUC_UNUSED)\n{\n    virCheckFlags(VZ_MIGRATION_FLAGS, -1);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainMigrateFinish3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3277-3324",
    "snippet": "static virDomainPtr\nvzDomainMigrateFinish3Params(virConnectPtr dconn,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             const char *cookiein G_GNUC_UNUSED,\n                             int cookieinlen G_GNUC_UNUSED,\n                             char **cookieout G_GNUC_UNUSED,\n                             int *cookieoutlen G_GNUC_UNUSED,\n                             unsigned int flags,\n                             int cancelled)\n{\n    virDomainObjPtr dom = NULL;\n    virDomainPtr domain = NULL;\n    vzConnPtr privconn = dconn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    const char *name = NULL;\n\n    virCheckFlags(VZ_MIGRATION_FLAGS, NULL);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        return NULL;\n\n    if (cancelled)\n        return NULL;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &name) < 0)\n        return NULL;\n\n\n    if (!(dom = prlsdkAddDomainByName(driver, name)))\n        goto cleanup;\n\n    /* At first glace at may look strange that we add domain and\n     * then check ACL but we touch only cache and not real system state */\n    if (virDomainMigrateFinish3ParamsEnsureACL(dconn, dom->def) < 0)\n        goto cleanup;\n\n    domain = virGetDomain(dconn, dom->def->name, dom->def->uuid, dom->def->id);\n\n cleanup:\n    /* In this situation we have to restore domain on source. But the migration\n     * is already finished. */\n    if (!domain)\n        VIR_WARN(\"Can't provide domain '%s' after successful migration.\", name);\n    virDomainObjEndAPI(&dom);\n    return domain;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL",
      "#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 3322
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Can't provide domain '%s' after successful migration.\"",
            "name"
          ],
          "line": 3321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "dconn",
            "dom->def->name",
            "dom->def->uuid",
            "dom->def->id"
          ],
          "line": 3315
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigrateFinish3ParamsEnsureACL",
          "args": [
            "dconn",
            "dom->def"
          ],
          "line": 3312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prlsdkAddDomainByName",
          "args": [
            "driver",
            "name"
          ],
          "line": 3307
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkAddDomainByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2027-2041",
          "snippet": "virDomainObjPtr\nprlsdkAddDomainByName(vzDriverPtr driver, const char *name)\n{\n    PRL_HANDLE sdkdom;\n    virDomainObjPtr dom;\n\n    sdkdom = prlsdkSdkDomainLookupByName(driver, name);\n    if (sdkdom == PRL_INVALID_HANDLE)\n        return NULL;\n\n    dom = prlsdkLoadDomain(driver, sdkdom, NULL);\n\n    PrlHandle_Free(sdkdom);\n    return dom;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nprlsdkAddDomainByName(vzDriverPtr driver, const char *name)\n{\n    PRL_HANDLE sdkdom;\n    virDomainObjPtr dom;\n\n    sdkdom = prlsdkSdkDomainLookupByName(driver, name);\n    if (sdkdom == PRL_INVALID_HANDLE)\n        return NULL;\n\n    dom = prlsdkLoadDomain(driver, sdkdom, NULL);\n\n    PrlHandle_Free(sdkdom);\n    return dom;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "&name"
          ],
          "line": 3302
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VZ_MIGRATION_PARAMETERS"
          ],
          "line": 3296
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VZ_MIGRATION_FLAGS",
            "NULL"
          ],
          "line": 3294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL\n#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)\n\nstatic virDomainPtr\nvzDomainMigrateFinish3Params(virConnectPtr dconn,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             const char *cookiein G_GNUC_UNUSED,\n                             int cookieinlen G_GNUC_UNUSED,\n                             char **cookieout G_GNUC_UNUSED,\n                             int *cookieoutlen G_GNUC_UNUSED,\n                             unsigned int flags,\n                             int cancelled)\n{\n    virDomainObjPtr dom = NULL;\n    virDomainPtr domain = NULL;\n    vzConnPtr privconn = dconn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    const char *name = NULL;\n\n    virCheckFlags(VZ_MIGRATION_FLAGS, NULL);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        return NULL;\n\n    if (cancelled)\n        return NULL;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &name) < 0)\n        return NULL;\n\n\n    if (!(dom = prlsdkAddDomainByName(driver, name)))\n        goto cleanup;\n\n    /* At first glace at may look strange that we add domain and\n     * then check ACL but we touch only cache and not real system state */\n    if (virDomainMigrateFinish3ParamsEnsureACL(dconn, dom->def) < 0)\n        goto cleanup;\n\n    domain = virGetDomain(dconn, dom->def->name, dom->def->uuid, dom->def->id);\n\n cleanup:\n    /* In this situation we have to restore domain on source. But the migration\n     * is already finished. */\n    if (!domain)\n        VIR_WARN(\"Can't provide domain '%s' after successful migration.\", name);\n    virDomainObjEndAPI(&dom);\n    return domain;\n}"
  },
  {
    "function_name": "vzDomainMigratePerform3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3238-3275",
    "snippet": "static int\nvzDomainMigratePerform3Params(virDomainPtr domain,\n                              const char *dconnuri,\n                              virTypedParameterPtr params,\n                              int nparams,\n                              const char *cookiein,\n                              int cookieinlen,\n                              char **cookieout G_GNUC_UNUSED,\n                              int *cookieoutlen G_GNUC_UNUSED,\n                              unsigned int flags)\n{\n    int ret = -1;\n    virDomainObjPtr dom;\n    vzConnPtr privconn = domain->conn->privateData;\n\n    virCheckFlags(VZ_MIGRATION_FLAGS, -1);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        return -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainMigratePerform3ParamsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (flags & VIR_MIGRATE_PEER2PEER)\n        ret = vzDomainMigratePerformP2P(dom, privconn->driver, dconnuri,\n                                        params, nparams, flags);\n    else\n        ret = vzDomainMigratePerformStep(dom, privconn->driver, params, nparams,\n                                         cookiein, cookieinlen, flags);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL",
      "#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 3272
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainMigratePerformStep",
          "args": [
            "dom",
            "privconn->driver",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "flags"
          ],
          "line": 3268
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainMigratePerformStep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3079-3137",
          "snippet": "static int\nvzDomainMigratePerformStep(virDomainObjPtr dom,\n                           vzDriverPtr driver,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           const char *cookiein,\n                           int cookieinlen,\n                           unsigned int flags)\n{\n    int ret = -1;\n    vzDomObjPtr privdom = dom->privateData;\n    virURIPtr vzuri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    vzMigrationCookiePtr mig = NULL;\n    bool job = false;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0)\n        goto cleanup;\n\n    if (!miguri) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"migrate uri is not set\"));\n        goto cleanup;\n    }\n\n    if (!(mig = vzEatCookie(cookiein, cookieinlen,\n                            VZ_MIGRATION_COOKIE_SESSION_UUID)))\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n    privdom->job.hasProgress = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (!(vzuri = vzParseVzURI(miguri)))\n        goto cleanup;\n\n    if (prlsdkMigrate(dom, vzuri, mig->session_uuid, dname, flags) < 0)\n        goto cleanup;\n\n    virDomainObjListRemove(driver->domains, dom);\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virURIFree(vzuri);\n    vzMigrationCookieFree(mig);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainMigratePerformStep(virDomainObjPtr dom,\n                           vzDriverPtr driver,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           const char *cookiein,\n                           int cookieinlen,\n                           unsigned int flags)\n{\n    int ret = -1;\n    vzDomObjPtr privdom = dom->privateData;\n    virURIPtr vzuri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    vzMigrationCookiePtr mig = NULL;\n    bool job = false;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0)\n        goto cleanup;\n\n    if (!miguri) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"migrate uri is not set\"));\n        goto cleanup;\n    }\n\n    if (!(mig = vzEatCookie(cookiein, cookieinlen,\n                            VZ_MIGRATION_COOKIE_SESSION_UUID)))\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n    privdom->job.hasProgress = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (!(vzuri = vzParseVzURI(miguri)))\n        goto cleanup;\n\n    if (prlsdkMigrate(dom, vzuri, mig->session_uuid, dname, flags) < 0)\n        goto cleanup;\n\n    virDomainObjListRemove(driver->domains, dom);\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virURIFree(vzuri);\n    vzMigrationCookieFree(mig);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainMigratePerformP2P",
          "args": [
            "dom",
            "privconn->driver",
            "dconnuri",
            "params",
            "nparams",
            "flags"
          ],
          "line": 3265
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainMigratePerformP2P",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3139-3236",
          "snippet": "static int\nvzDomainMigratePerformP2P(virDomainObjPtr dom,\n                          vzDriverPtr driver,\n                          const char *dconnuri,\n                          virTypedParameterPtr orig_params,\n                          int nparams,\n                          unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    virConnectPtr dconn = NULL;\n    virTypedParameterPtr params = NULL;\n    int ret = -1;\n    int maxparams = nparams;\n\n    if (virTypedParamsCopy(&params, orig_params, nparams) < 0)\n        return -1;\n\n    if (!(dconn = virConnectOpen(dconnuri)))\n        goto done;\n\n    if (!(dom_xml = vzDomainMigrateBeginStep(dom, driver, params, nparams,\n                                             &cookieout, &cookieoutlen)))\n        goto done;\n\n    if (virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, dom_xml) < 0)\n        goto done;\n\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    virObjectUnlock(dom);\n    ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri, flags);\n    virObjectLock(dom);\n    if (ret < 0)\n        goto done;\n    ret = -1;\n\n    /* preparation step was successful, thus on any error we must perform\n     * finish step to finalize migration on target\n     */\n    if (uri && virTypedParamsReplaceString(&params, &nparams,\n                                           VIR_MIGRATE_PARAM_URI, uri) < 0) {\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (vzDomainMigratePerformStep(dom, driver, params, nparams, cookiein,\n                                   cookieinlen, flags) < 0) {\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    cancelled = 0;\n\n finish:\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n        virTypedParamsReplaceString(&params, &nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME,\n                                    dom->def->name) < 0)\n        goto done;\n\n    virObjectUnlock(dom);\n    ddomain = dconn->driver->domainMigrateFinish3Params(dconn, params, nparams,\n                                                        NULL, 0, NULL, NULL,\n                                                        flags, cancelled);\n    virObjectLock(dom);\n    if (ddomain)\n        ret = 0;\n    virObjectUnref(ddomain);\n\n    /* confirm step is NOOP thus no need to call it */\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    virObjectUnref(dconn);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainMigratePerformP2P(virDomainObjPtr dom,\n                          vzDriverPtr driver,\n                          const char *dconnuri,\n                          virTypedParameterPtr orig_params,\n                          int nparams,\n                          unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    virConnectPtr dconn = NULL;\n    virTypedParameterPtr params = NULL;\n    int ret = -1;\n    int maxparams = nparams;\n\n    if (virTypedParamsCopy(&params, orig_params, nparams) < 0)\n        return -1;\n\n    if (!(dconn = virConnectOpen(dconnuri)))\n        goto done;\n\n    if (!(dom_xml = vzDomainMigrateBeginStep(dom, driver, params, nparams,\n                                             &cookieout, &cookieoutlen)))\n        goto done;\n\n    if (virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, dom_xml) < 0)\n        goto done;\n\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    virObjectUnlock(dom);\n    ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri, flags);\n    virObjectLock(dom);\n    if (ret < 0)\n        goto done;\n    ret = -1;\n\n    /* preparation step was successful, thus on any error we must perform\n     * finish step to finalize migration on target\n     */\n    if (uri && virTypedParamsReplaceString(&params, &nparams,\n                                           VIR_MIGRATE_PARAM_URI, uri) < 0) {\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (vzDomainMigratePerformStep(dom, driver, params, nparams, cookiein,\n                                   cookieinlen, flags) < 0) {\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    cancelled = 0;\n\n finish:\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n        virTypedParamsReplaceString(&params, &nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME,\n                                    dom->def->name) < 0)\n        goto done;\n\n    virObjectUnlock(dom);\n    ddomain = dconn->driver->domainMigrateFinish3Params(dconn, params, nparams,\n                                                        NULL, 0, NULL, NULL,\n                                                        flags, cancelled);\n    virObjectLock(dom);\n    if (ddomain)\n        ret = 0;\n    virObjectUnref(ddomain);\n\n    /* confirm step is NOOP thus no need to call it */\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    virObjectUnref(dconn);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigratePerform3ParamsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 3261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 3258
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VZ_MIGRATION_PARAMETERS"
          ],
          "line": 3255
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VZ_MIGRATION_FLAGS",
            "-1"
          ],
          "line": 3253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL\n#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)\n\nstatic int\nvzDomainMigratePerform3Params(virDomainPtr domain,\n                              const char *dconnuri,\n                              virTypedParameterPtr params,\n                              int nparams,\n                              const char *cookiein,\n                              int cookieinlen,\n                              char **cookieout G_GNUC_UNUSED,\n                              int *cookieoutlen G_GNUC_UNUSED,\n                              unsigned int flags)\n{\n    int ret = -1;\n    virDomainObjPtr dom;\n    vzConnPtr privconn = domain->conn->privateData;\n\n    virCheckFlags(VZ_MIGRATION_FLAGS, -1);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        return -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainMigratePerform3ParamsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (flags & VIR_MIGRATE_PEER2PEER)\n        ret = vzDomainMigratePerformP2P(dom, privconn->driver, dconnuri,\n                                        params, nparams, flags);\n    else\n        ret = vzDomainMigratePerformStep(dom, privconn->driver, params, nparams,\n                                         cookiein, cookieinlen, flags);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainMigratePerformP2P",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3139-3236",
    "snippet": "static int\nvzDomainMigratePerformP2P(virDomainObjPtr dom,\n                          vzDriverPtr driver,\n                          const char *dconnuri,\n                          virTypedParameterPtr orig_params,\n                          int nparams,\n                          unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    virConnectPtr dconn = NULL;\n    virTypedParameterPtr params = NULL;\n    int ret = -1;\n    int maxparams = nparams;\n\n    if (virTypedParamsCopy(&params, orig_params, nparams) < 0)\n        return -1;\n\n    if (!(dconn = virConnectOpen(dconnuri)))\n        goto done;\n\n    if (!(dom_xml = vzDomainMigrateBeginStep(dom, driver, params, nparams,\n                                             &cookieout, &cookieoutlen)))\n        goto done;\n\n    if (virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, dom_xml) < 0)\n        goto done;\n\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    virObjectUnlock(dom);\n    ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri, flags);\n    virObjectLock(dom);\n    if (ret < 0)\n        goto done;\n    ret = -1;\n\n    /* preparation step was successful, thus on any error we must perform\n     * finish step to finalize migration on target\n     */\n    if (uri && virTypedParamsReplaceString(&params, &nparams,\n                                           VIR_MIGRATE_PARAM_URI, uri) < 0) {\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (vzDomainMigratePerformStep(dom, driver, params, nparams, cookiein,\n                                   cookieinlen, flags) < 0) {\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    cancelled = 0;\n\n finish:\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n        virTypedParamsReplaceString(&params, &nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME,\n                                    dom->def->name) < 0)\n        goto done;\n\n    virObjectUnlock(dom);\n    ddomain = dconn->driver->domainMigrateFinish3Params(dconn, params, nparams,\n                                                        NULL, 0, NULL, NULL,\n                                                        flags, cancelled);\n    virObjectLock(dom);\n    if (ddomain)\n        ret = 0;\n    virObjectUnref(ddomain);\n\n    /* confirm step is NOOP thus no need to call it */\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    virObjectUnref(dconn);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "dconn"
          ],
          "line": 3234
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "params",
            "nparams"
          ],
          "line": 3233
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookieout"
          ],
          "line": 3232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookiein"
          ],
          "line": 3231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "uri"
          ],
          "line": 3230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dom_xml"
          ],
          "line": 3229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&orig_err"
          ],
          "line": 3228
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "dom"
          ],
          "line": 3220
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish3Params",
          "args": [
            "dconn",
            "params",
            "nparams",
            "NULL",
            "0",
            "NULL",
            "NULL",
            "flags",
            "cancelled"
          ],
          "line": 3217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "dom"
          ],
          "line": 3216
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsReplaceString",
          "args": [
            "&params",
            "&nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "dom->def->name"
          ],
          "line": 3211
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsReplaceString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "312-350",
          "snippet": "int\nvirTypedParamsReplaceString(virTypedParameterPtr *params,\n                            int *nparams,\n                            const char *name,\n                            const char *value)\n{\n    char *str = NULL;\n    char *old = NULL;\n    size_t n = *nparams;\n    virTypedParameterPtr param;\n\n    param = virTypedParamsGet(*params, n, name);\n    if (param) {\n        if (param->type != VIR_TYPED_PARAM_STRING) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Parameter '%s' is not a string\"),\n                           param->field);\n            return -1;\n        }\n        old = param->value.s;\n    } else {\n        if (VIR_EXPAND_N(*params, n, 1) < 0)\n            return -1;\n        param = *params + n - 1;\n    }\n\n    str = g_strdup(value);\n\n    if (virTypedParameterAssign(param, name,\n                                VIR_TYPED_PARAM_STRING, str) < 0) {\n        param->value.s = old;\n        VIR_FREE(str);\n        return -1;\n    }\n    VIR_FREE(old);\n\n    *nparams = n;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsReplaceString(virTypedParameterPtr *params,\n                            int *nparams,\n                            const char *name,\n                            const char *value)\n{\n    char *str = NULL;\n    char *old = NULL;\n    size_t n = *nparams;\n    virTypedParameterPtr param;\n\n    param = virTypedParamsGet(*params, n, name);\n    if (param) {\n        if (param->type != VIR_TYPED_PARAM_STRING) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Parameter '%s' is not a string\"),\n                           param->field);\n            return -1;\n        }\n        old = param->value.s;\n    } else {\n        if (VIR_EXPAND_N(*params, n, 1) < 0)\n            return -1;\n        param = *params + n - 1;\n    }\n\n    str = g_strdup(value);\n\n    if (virTypedParameterAssign(param, name,\n                                VIR_TYPED_PARAM_STRING, str) < 0) {\n        param->value.s = old;\n        VIR_FREE(str);\n        return -1;\n    }\n    VIR_FREE(old);\n\n    *nparams = n;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "NULL"
          ],
          "line": 3209
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&orig_err"
          ],
          "line": 3202
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainMigratePerformStep",
          "args": [
            "dom",
            "driver",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "flags"
          ],
          "line": 3200
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainMigratePerformStep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3079-3137",
          "snippet": "static int\nvzDomainMigratePerformStep(virDomainObjPtr dom,\n                           vzDriverPtr driver,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           const char *cookiein,\n                           int cookieinlen,\n                           unsigned int flags)\n{\n    int ret = -1;\n    vzDomObjPtr privdom = dom->privateData;\n    virURIPtr vzuri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    vzMigrationCookiePtr mig = NULL;\n    bool job = false;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0)\n        goto cleanup;\n\n    if (!miguri) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"migrate uri is not set\"));\n        goto cleanup;\n    }\n\n    if (!(mig = vzEatCookie(cookiein, cookieinlen,\n                            VZ_MIGRATION_COOKIE_SESSION_UUID)))\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n    privdom->job.hasProgress = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (!(vzuri = vzParseVzURI(miguri)))\n        goto cleanup;\n\n    if (prlsdkMigrate(dom, vzuri, mig->session_uuid, dname, flags) < 0)\n        goto cleanup;\n\n    virDomainObjListRemove(driver->domains, dom);\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virURIFree(vzuri);\n    vzMigrationCookieFree(mig);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainMigratePerformStep(virDomainObjPtr dom,\n                           vzDriverPtr driver,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           const char *cookiein,\n                           int cookieinlen,\n                           unsigned int flags)\n{\n    int ret = -1;\n    vzDomObjPtr privdom = dom->privateData;\n    virURIPtr vzuri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    vzMigrationCookiePtr mig = NULL;\n    bool job = false;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0)\n        goto cleanup;\n\n    if (!miguri) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"migrate uri is not set\"));\n        goto cleanup;\n    }\n\n    if (!(mig = vzEatCookie(cookiein, cookieinlen,\n                            VZ_MIGRATION_COOKIE_SESSION_UUID)))\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n    privdom->job.hasProgress = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (!(vzuri = vzParseVzURI(miguri)))\n        goto cleanup;\n\n    if (prlsdkMigrate(dom, vzuri, mig->session_uuid, dname, flags) < 0)\n        goto cleanup;\n\n    virDomainObjListRemove(driver->domains, dom);\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virURIFree(vzuri);\n    vzMigrationCookieFree(mig);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&cookieout"
          ],
          "line": 3197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookiein"
          ],
          "line": 3196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare3Params",
          "args": [
            "dconn",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "&cookieout",
            "&cookieoutlen",
            "&uri",
            "flags"
          ],
          "line": 3179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&cookieout"
          ],
          "line": 3175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&params",
            "&nparams",
            "&maxparams",
            "VIR_MIGRATE_PARAM_DEST_XML",
            "dom_xml"
          ],
          "line": 3171
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainMigrateBeginStep",
          "args": [
            "dom",
            "driver",
            "params",
            "nparams",
            "&cookieout",
            "&cookieoutlen"
          ],
          "line": 3167
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainMigrateBeginStep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2856-2882",
          "snippet": "static char *\nvzDomainMigrateBeginStep(virDomainObjPtr dom,\n                         vzDriverPtr driver,\n                         virTypedParameterPtr params,\n                         int nparams,\n                         char **cookieout,\n                         int *cookieoutlen)\n{\n    /* we can't do this check via VZ_MIGRATION_PARAMETERS as on preparation\n     * step domain xml will be passed via this parameter and it is a common\n     * style to use single allowed parameter list definition in all steps */\n    if (virTypedParamsGet(params, nparams, VIR_MIGRATE_PARAM_DEST_XML)) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Changing destination XML is not supported\"));\n        return NULL;\n    }\n\n    /* session uuid, domain uuid and domain name are for backward compat */\n    if (vzBakeCookie(driver, dom, cookieout, cookieoutlen,\n                     VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME) < 0)\n        return NULL;\n\n    return virDomainDefFormat(dom->def, driver->xmlopt,\n                              VIR_DOMAIN_XML_MIGRATABLE);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL\n\nstatic char *\nvzDomainMigrateBeginStep(virDomainObjPtr dom,\n                         vzDriverPtr driver,\n                         virTypedParameterPtr params,\n                         int nparams,\n                         char **cookieout,\n                         int *cookieoutlen)\n{\n    /* we can't do this check via VZ_MIGRATION_PARAMETERS as on preparation\n     * step domain xml will be passed via this parameter and it is a common\n     * style to use single allowed parameter list definition in all steps */\n    if (virTypedParamsGet(params, nparams, VIR_MIGRATE_PARAM_DEST_XML)) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Changing destination XML is not supported\"));\n        return NULL;\n    }\n\n    /* session uuid, domain uuid and domain name are for backward compat */\n    if (vzBakeCookie(driver, dom, cookieout, cookieoutlen,\n                     VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME) < 0)\n        return NULL;\n\n    return virDomainDefFormat(dom->def, driver->xmlopt,\n                              VIR_DOMAIN_XML_MIGRATABLE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectOpen",
          "args": [
            "dconnuri"
          ],
          "line": 3164
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectOpenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1181-1199",
          "snippet": "virConnectPtr\nvirConnectOpenReadOnly(const char *name)\n{\n    virConnectPtr ret = NULL;\n\n    if (virInitialize() < 0)\n        goto error;\n\n    VIR_DEBUG(\"name=%s\", NULLSTR(name));\n    virResetLastError();\n    ret = virConnectOpenInternal(name, NULL, VIR_CONNECT_RO);\n    if (!ret)\n        goto error;\n    return ret;\n\n error:\n    virDispatchError(NULL);\n    return NULL;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirConnectPtr\nvirConnectOpenReadOnly(const char *name)\n{\n    virConnectPtr ret = NULL;\n\n    if (virInitialize() < 0)\n        goto error;\n\n    VIR_DEBUG(\"name=%s\", NULLSTR(name));\n    virResetLastError();\n    ret = virConnectOpenInternal(name, NULL, VIR_CONNECT_RO);\n    if (!ret)\n        goto error;\n    return ret;\n\n error:\n    virDispatchError(NULL);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsCopy",
          "args": [
            "&params",
            "orig_params",
            "nparams"
          ],
          "line": 3161
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "353-378",
          "snippet": "int\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainMigratePerformP2P(virDomainObjPtr dom,\n                          vzDriverPtr driver,\n                          const char *dconnuri,\n                          virTypedParameterPtr orig_params,\n                          int nparams,\n                          unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    virConnectPtr dconn = NULL;\n    virTypedParameterPtr params = NULL;\n    int ret = -1;\n    int maxparams = nparams;\n\n    if (virTypedParamsCopy(&params, orig_params, nparams) < 0)\n        return -1;\n\n    if (!(dconn = virConnectOpen(dconnuri)))\n        goto done;\n\n    if (!(dom_xml = vzDomainMigrateBeginStep(dom, driver, params, nparams,\n                                             &cookieout, &cookieoutlen)))\n        goto done;\n\n    if (virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, dom_xml) < 0)\n        goto done;\n\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    virObjectUnlock(dom);\n    ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri, flags);\n    virObjectLock(dom);\n    if (ret < 0)\n        goto done;\n    ret = -1;\n\n    /* preparation step was successful, thus on any error we must perform\n     * finish step to finalize migration on target\n     */\n    if (uri && virTypedParamsReplaceString(&params, &nparams,\n                                           VIR_MIGRATE_PARAM_URI, uri) < 0) {\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (vzDomainMigratePerformStep(dom, driver, params, nparams, cookiein,\n                                   cookieinlen, flags) < 0) {\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    cancelled = 0;\n\n finish:\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n        virTypedParamsReplaceString(&params, &nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME,\n                                    dom->def->name) < 0)\n        goto done;\n\n    virObjectUnlock(dom);\n    ddomain = dconn->driver->domainMigrateFinish3Params(dconn, params, nparams,\n                                                        NULL, 0, NULL, NULL,\n                                                        flags, cancelled);\n    virObjectLock(dom);\n    if (ddomain)\n        ret = 0;\n    virObjectUnref(ddomain);\n\n    /* confirm step is NOOP thus no need to call it */\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    virObjectUnref(dconn);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainMigratePerformStep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3079-3137",
    "snippet": "static int\nvzDomainMigratePerformStep(virDomainObjPtr dom,\n                           vzDriverPtr driver,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           const char *cookiein,\n                           int cookieinlen,\n                           unsigned int flags)\n{\n    int ret = -1;\n    vzDomObjPtr privdom = dom->privateData;\n    virURIPtr vzuri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    vzMigrationCookiePtr mig = NULL;\n    bool job = false;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0)\n        goto cleanup;\n\n    if (!miguri) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"migrate uri is not set\"));\n        goto cleanup;\n    }\n\n    if (!(mig = vzEatCookie(cookiein, cookieinlen,\n                            VZ_MIGRATION_COOKIE_SESSION_UUID)))\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n    privdom->job.hasProgress = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (!(vzuri = vzParseVzURI(miguri)))\n        goto cleanup;\n\n    if (prlsdkMigrate(dom, vzuri, mig->session_uuid, dname, flags) < 0)\n        goto cleanup;\n\n    virDomainObjListRemove(driver->domains, dom);\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virURIFree(vzuri);\n    vzMigrationCookieFree(mig);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzMigrationCookieFree",
          "args": [
            "mig"
          ],
          "line": 3134
        },
        "resolved": true,
        "details": {
          "function_name": "vzMigrationCookieFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2717-2727",
          "snippet": "static void\nvzMigrationCookieFree(vzMigrationCookiePtr mig)\n{\n    if (!mig)\n        return;\n\n    VIR_FREE(mig->session_uuid);\n    VIR_FREE(mig->uuid);\n    VIR_FREE(mig->name);\n    VIR_FREE(mig);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvzMigrationCookieFree(vzMigrationCookiePtr mig)\n{\n    if (!mig)\n        return;\n\n    VIR_FREE(mig->session_uuid);\n    VIR_FREE(mig->uuid);\n    VIR_FREE(mig->name);\n    VIR_FREE(mig);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virURIFree",
          "args": [
            "vzuri"
          ],
          "line": 3133
        },
        "resolved": true,
        "details": {
          "function_name": "virURIFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "277-298",
          "snippet": "void virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvoid virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 3132
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "driver->domains",
            "dom"
          ],
          "line": 3126
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkMigrate",
          "args": [
            "dom",
            "vzuri",
            "mig->session_uuid",
            "dname",
            "flags"
          ],
          "line": 3123
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkMigrate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4813-4840",
          "snippet": "int prlsdkMigrate(virDomainObjPtr dom, virURIPtr uri,\n                  const unsigned char *session_uuid,\n                  const char *dname,\n                  unsigned int flags)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    char uuidstr[VIR_UUID_STRING_BRACED_BUFLEN];\n    PRL_UINT32 vzflags = PRLSDK_MIGRATION_FLAGS;\n\n    if (flags & VIR_MIGRATE_PAUSED)\n        vzflags |= PVMT_DONT_RESUME_VM;\n\n    prlsdkUUIDFormat(session_uuid, uuidstr);\n    job = PrlVm_MigrateWithRenameEx(privdom->sdkdom, uri->server,\n                                    uri->port, uuidstr,\n                                    dname == NULL ? \"\" : dname,\n                                    \"\",\n                                    vzflags,\n                                    0,\n                                    PRL_TRUE\n                                    );\n\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PRLSDK_MIGRATION_FLAGS (PSL_HIGH_SECURITY | PVMT_DONT_CREATE_DISK)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define PRLSDK_MIGRATION_FLAGS (PSL_HIGH_SECURITY | PVMT_DONT_CREATE_DISK)\n\nint prlsdkMigrate(virDomainObjPtr dom, virURIPtr uri,\n                  const unsigned char *session_uuid,\n                  const char *dname,\n                  unsigned int flags)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    char uuidstr[VIR_UUID_STRING_BRACED_BUFLEN];\n    PRL_UINT32 vzflags = PRLSDK_MIGRATION_FLAGS;\n\n    if (flags & VIR_MIGRATE_PAUSED)\n        vzflags |= PVMT_DONT_RESUME_VM;\n\n    prlsdkUUIDFormat(session_uuid, uuidstr);\n    job = PrlVm_MigrateWithRenameEx(privdom->sdkdom, uri->server,\n                                    uri->port, uuidstr,\n                                    dname == NULL ? \"\" : dname,\n                                    \"\",\n                                    vzflags,\n                                    0,\n                                    PRL_TRUE\n                                    );\n\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzParseVzURI",
          "args": [
            "miguri"
          ],
          "line": 3120
        },
        "resolved": true,
        "details": {
          "function_name": "vzParseVzURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "3043-3077",
          "snippet": "static virURIPtr\nvzParseVzURI(const char *uri_str)\n{\n    virURIPtr uri = NULL;\n\n    if (!(uri = virURIParse(uri_str)))\n        goto error;\n\n    if (!uri->scheme || !uri->server) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"scheme and host are mandatory vz migration URI: %s\"),\n                       uri_str);\n        goto error;\n    }\n\n    if (uri->user || uri->path || uri->query || uri->fragment) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"only scheme, host and port are supported in \"\n                         \"vz migration URI: %s\"), uri_str);\n        goto error;\n    }\n\n    if (STRNEQ(uri->scheme, \"vzmigr\")) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"unsupported scheme %s in migration URI %s\"),\n                       uri->scheme, uri_str);\n        goto error;\n    }\n\n    return uri;\n\n error:\n    virURIFree(uri);\n    return NULL;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virURIPtr\nvzParseVzURI(const char *uri_str)\n{\n    virURIPtr uri = NULL;\n\n    if (!(uri = virURIParse(uri_str)))\n        goto error;\n\n    if (!uri->scheme || !uri->server) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"scheme and host are mandatory vz migration URI: %s\"),\n                       uri_str);\n        goto error;\n    }\n\n    if (uri->user || uri->path || uri->query || uri->fragment) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"only scheme, host and port are supported in \"\n                         \"vz migration URI: %s\"), uri_str);\n        goto error;\n    }\n\n    if (STRNEQ(uri->scheme, \"vzmigr\")) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"unsupported scheme %s in migration URI %s\"),\n                       uri->scheme, uri_str);\n        goto error;\n    }\n\n    return uri;\n\n error:\n    virURIFree(uri);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 3117
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 3112
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEatCookie",
          "args": [
            "cookiein",
            "cookieinlen",
            "VZ_MIGRATION_COOKIE_SESSION_UUID"
          ],
          "line": 3108
        },
        "resolved": true,
        "details": {
          "function_name": "vzEatCookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2780-2840",
          "snippet": "static vzMigrationCookiePtr\nvzEatCookie(const char *cookiein, int cookieinlen, unsigned int flags)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctx = NULL;\n    char *tmp = NULL;\n    vzMigrationCookiePtr mig = NULL;\n\n    if (VIR_ALLOC(mig) < 0)\n        return NULL;\n\n    if (!cookiein || cookieinlen <= 0 || cookiein[cookieinlen - 1] != '\\0') {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid migration cookie\"));\n        goto error;\n    }\n\n    if (!(doc = virXMLParseStringCtxt(cookiein,\n                                      _(\"(_migration_cookie)\"), &ctx)))\n        goto error;\n\n    if ((flags & VZ_MIGRATION_COOKIE_SESSION_UUID)\n        && (!(tmp = virXPathString(\"string(./session-uuid[1])\", ctx))\n            || (VIR_ALLOC_N(mig->session_uuid, VIR_UUID_BUFLEN) < 0)\n            || (virUUIDParse(tmp, mig->session_uuid) < 0))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing or malformed session-uuid element \"\n                         \"in migration data\"));\n        VIR_FREE(tmp);\n        goto error;\n    }\n    VIR_FREE(tmp);\n\n    if ((flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID)\n        && (!(tmp = virXPathString(\"string(./uuid[1])\", ctx))\n            || (VIR_ALLOC_N(mig->uuid, VIR_UUID_BUFLEN) < 0)\n            || (virUUIDParse(tmp, mig->uuid) < 0))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing or malformed uuid element in migration data\"));\n        VIR_FREE(tmp);\n        goto error;\n    }\n    VIR_FREE(tmp);\n\n    if ((flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME)\n        && !(mig->name = virXPathString(\"string(./name[1])\", ctx))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing name element in migration data\"));\n        goto error;\n    }\n\n cleanup:\n    xmlXPathFreeContext(ctx);\n    xmlFreeDoc(doc);\n    return mig;\n\n error:\n    vzMigrationCookieFree(mig);\n    mig = NULL;\n    goto cleanup;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic vzMigrationCookiePtr\nvzEatCookie(const char *cookiein, int cookieinlen, unsigned int flags)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctx = NULL;\n    char *tmp = NULL;\n    vzMigrationCookiePtr mig = NULL;\n\n    if (VIR_ALLOC(mig) < 0)\n        return NULL;\n\n    if (!cookiein || cookieinlen <= 0 || cookiein[cookieinlen - 1] != '\\0') {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid migration cookie\"));\n        goto error;\n    }\n\n    if (!(doc = virXMLParseStringCtxt(cookiein,\n                                      _(\"(_migration_cookie)\"), &ctx)))\n        goto error;\n\n    if ((flags & VZ_MIGRATION_COOKIE_SESSION_UUID)\n        && (!(tmp = virXPathString(\"string(./session-uuid[1])\", ctx))\n            || (VIR_ALLOC_N(mig->session_uuid, VIR_UUID_BUFLEN) < 0)\n            || (virUUIDParse(tmp, mig->session_uuid) < 0))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing or malformed session-uuid element \"\n                         \"in migration data\"));\n        VIR_FREE(tmp);\n        goto error;\n    }\n    VIR_FREE(tmp);\n\n    if ((flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID)\n        && (!(tmp = virXPathString(\"string(./uuid[1])\", ctx))\n            || (VIR_ALLOC_N(mig->uuid, VIR_UUID_BUFLEN) < 0)\n            || (virUUIDParse(tmp, mig->uuid) < 0))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing or malformed uuid element in migration data\"));\n        VIR_FREE(tmp);\n        goto error;\n    }\n    VIR_FREE(tmp);\n\n    if ((flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME)\n        && !(mig->name = virXPathString(\"string(./name[1])\", ctx))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing name element in migration data\"));\n        goto error;\n    }\n\n cleanup:\n    xmlXPathFreeContext(ctx);\n    xmlFreeDoc(doc);\n    return mig;\n\n error:\n    vzMigrationCookieFree(mig);\n    mig = NULL;\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"migrate uri is not set\")"
          ],
          "line": 3103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"migrate uri is not set\""
          ],
          "line": 3104
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "&dname"
          ],
          "line": 3098
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainMigratePerformStep(virDomainObjPtr dom,\n                           vzDriverPtr driver,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           const char *cookiein,\n                           int cookieinlen,\n                           unsigned int flags)\n{\n    int ret = -1;\n    vzDomObjPtr privdom = dom->privateData;\n    virURIPtr vzuri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    vzMigrationCookiePtr mig = NULL;\n    bool job = false;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0)\n        goto cleanup;\n\n    if (!miguri) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"migrate uri is not set\"));\n        goto cleanup;\n    }\n\n    if (!(mig = vzEatCookie(cookiein, cookieinlen,\n                            VZ_MIGRATION_COOKIE_SESSION_UUID)))\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n    privdom->job.hasProgress = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (!(vzuri = vzParseVzURI(miguri)))\n        goto cleanup;\n\n    if (prlsdkMigrate(dom, vzuri, mig->session_uuid, dname, flags) < 0)\n        goto cleanup;\n\n    virDomainObjListRemove(driver->domains, dom);\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virURIFree(vzuri);\n    vzMigrationCookieFree(mig);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzParseVzURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3043-3077",
    "snippet": "static virURIPtr\nvzParseVzURI(const char *uri_str)\n{\n    virURIPtr uri = NULL;\n\n    if (!(uri = virURIParse(uri_str)))\n        goto error;\n\n    if (!uri->scheme || !uri->server) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"scheme and host are mandatory vz migration URI: %s\"),\n                       uri_str);\n        goto error;\n    }\n\n    if (uri->user || uri->path || uri->query || uri->fragment) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"only scheme, host and port are supported in \"\n                         \"vz migration URI: %s\"), uri_str);\n        goto error;\n    }\n\n    if (STRNEQ(uri->scheme, \"vzmigr\")) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"unsupported scheme %s in migration URI %s\"),\n                       uri->scheme, uri_str);\n        goto error;\n    }\n\n    return uri;\n\n error:\n    virURIFree(uri);\n    return NULL;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virURIFree",
          "args": [
            "uri"
          ],
          "line": 3075
        },
        "resolved": true,
        "details": {
          "function_name": "virURIFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "277-298",
          "snippet": "void virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvoid virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "_(\"unsupported scheme %s in migration URI %s\")",
            "uri->scheme",
            "uri_str"
          ],
          "line": 3066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unsupported scheme %s in migration URI %s\""
          ],
          "line": 3067
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "uri->scheme",
            "\"vzmigr\""
          ],
          "line": 3065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"only scheme, host and port are supported in \"\n                         \"vz migration URI: %s\")",
            "uri_str"
          ],
          "line": 3059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"scheme and host are mandatory vz migration URI: %s\")",
            "uri_str"
          ],
          "line": 3052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virURIParse",
          "args": [
            "uri_str"
          ],
          "line": 3048
        },
        "resolved": true,
        "details": {
          "function_name": "virURIParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "143-194",
          "snippet": "virURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvirURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virURIPtr\nvzParseVzURI(const char *uri_str)\n{\n    virURIPtr uri = NULL;\n\n    if (!(uri = virURIParse(uri_str)))\n        goto error;\n\n    if (!uri->scheme || !uri->server) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"scheme and host are mandatory vz migration URI: %s\"),\n                       uri_str);\n        goto error;\n    }\n\n    if (uri->user || uri->path || uri->query || uri->fragment) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"only scheme, host and port are supported in \"\n                         \"vz migration URI: %s\"), uri_str);\n        goto error;\n    }\n\n    if (STRNEQ(uri->scheme, \"vzmigr\")) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"unsupported scheme %s in migration URI %s\"),\n                       uri->scheme, uri_str);\n        goto error;\n    }\n\n    return uri;\n\n error:\n    virURIFree(uri);\n    return NULL;\n}"
  },
  {
    "function_name": "vzConnectSupportsFeature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "3015-3041",
    "snippet": "static int\nvzConnectSupportsFeature(virConnectPtr conn G_GNUC_UNUSED, int feature)\n{\n    if (virConnectSupportsFeatureEnsureACL(conn) < 0)\n        return -1;\n\n    switch ((virDrvFeature) feature) {\n    case VIR_DRV_FEATURE_MIGRATION_PARAMS:\n    case VIR_DRV_FEATURE_MIGRATION_P2P:\n        return 1;\n    case VIR_DRV_FEATURE_FD_PASSING:\n    case VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION:\n    case VIR_DRV_FEATURE_MIGRATION_DIRECT:\n    case VIR_DRV_FEATURE_MIGRATION_OFFLINE:\n    case VIR_DRV_FEATURE_MIGRATION_V1:\n    case VIR_DRV_FEATURE_MIGRATION_V2:\n    case VIR_DRV_FEATURE_MIGRATION_V3:\n    case VIR_DRV_FEATURE_PROGRAM_KEEPALIVE:\n    case VIR_DRV_FEATURE_REMOTE:\n    case VIR_DRV_FEATURE_REMOTE_CLOSE_CALLBACK:\n    case VIR_DRV_FEATURE_REMOTE_EVENT_CALLBACK:\n    case VIR_DRV_FEATURE_TYPED_PARAM_STRING:\n    case VIR_DRV_FEATURE_XML_MIGRATABLE:\n    default:\n        return 0;\n    }\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectSupportsFeatureEnsureACL",
          "args": [
            "conn"
          ],
          "line": 3018
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectSupportsFeature(virConnectPtr conn G_GNUC_UNUSED, int feature)\n{\n    if (virConnectSupportsFeatureEnsureACL(conn) < 0)\n        return -1;\n\n    switch ((virDrvFeature) feature) {\n    case VIR_DRV_FEATURE_MIGRATION_PARAMS:\n    case VIR_DRV_FEATURE_MIGRATION_P2P:\n        return 1;\n    case VIR_DRV_FEATURE_FD_PASSING:\n    case VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION:\n    case VIR_DRV_FEATURE_MIGRATION_DIRECT:\n    case VIR_DRV_FEATURE_MIGRATION_OFFLINE:\n    case VIR_DRV_FEATURE_MIGRATION_V1:\n    case VIR_DRV_FEATURE_MIGRATION_V2:\n    case VIR_DRV_FEATURE_MIGRATION_V3:\n    case VIR_DRV_FEATURE_PROGRAM_KEEPALIVE:\n    case VIR_DRV_FEATURE_REMOTE:\n    case VIR_DRV_FEATURE_REMOTE_CLOSE_CALLBACK:\n    case VIR_DRV_FEATURE_REMOTE_EVENT_CALLBACK:\n    case VIR_DRV_FEATURE_TYPED_PARAM_STRING:\n    case VIR_DRV_FEATURE_XML_MIGRATABLE:\n    default:\n        return 0;\n    }\n}"
  },
  {
    "function_name": "vzDomainMigratePrepare3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2950-3013",
    "snippet": "static int\nvzDomainMigratePrepare3Params(virConnectPtr conn,\n                              virTypedParameterPtr params,\n                              int nparams,\n                              const char *cookiein G_GNUC_UNUSED,\n                              int cookieinlen G_GNUC_UNUSED,\n                              char **cookieout,\n                              int *cookieoutlen,\n                              char **uri_out,\n                              unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    const char *dom_xml = NULL;\n    virDomainDefPtr def = NULL;\n    int ret = -1;\n\n    virCheckFlags(VZ_MIGRATION_FLAGS, -1);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, &dom_xml) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0)\n        goto cleanup;\n\n    /* We must set uri_out if miguri is not set. This is direct\n     * managed migration requirement */\n    if (!miguri && !(*uri_out = vzMigrationCreateURI()))\n        goto cleanup;\n\n    /* domain uuid and domain name are for backward compat */\n    if (vzBakeCookie(privconn->driver, NULL,\n                     cookieout, cookieoutlen,\n                     VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME) < 0)\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(dom_xml, driver->xmlopt,\n                                        NULL,\n                                        VIR_DOMAIN_DEF_PARSE_INACTIVE)))\n        goto cleanup;\n\n    if (dname) {\n        VIR_FREE(def->name);\n        def->name = g_strdup(dname);\n    }\n\n    if (virDomainMigratePrepare3ParamsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainDefFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL",
      "#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 3011
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigratePrepare3ParamsEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 3005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "dname"
          ],
          "line": 3002
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->name"
          ],
          "line": 3001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "dom_xml",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_DEF_PARSE_INACTIVE"
          ],
          "line": 2995
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzBakeCookie",
          "args": [
            "privconn->driver",
            "NULL",
            "cookieout",
            "cookieoutlen",
            "VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME"
          ],
          "line": 2988
        },
        "resolved": true,
        "details": {
          "function_name": "vzBakeCookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2729-2778",
          "snippet": "static int\nvzBakeCookie(vzDriverPtr driver,\n             virDomainObjPtr dom,\n             char **cookieout, int *cookieoutlen,\n             unsigned int flags)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (!cookieout || !cookieoutlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Migration cookie parameters are not provided.\"));\n        return -1;\n    }\n\n    *cookieout = NULL;\n    *cookieoutlen = 0;\n\n    virBufferAddLit(&buf, \"<vz-migration>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (flags & VZ_MIGRATION_COOKIE_SESSION_UUID) {\n        virUUIDFormat(driver->session_uuid, uuidstr);\n        virBufferAsprintf(&buf, \"<session-uuid>%s</session-uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID) {\n        unsigned char fakeuuid[VIR_UUID_BUFLEN] = { 0 };\n\n        /* if dom is NULL just pass some parsable uuid for backward compat.\n         * It is not used by peer */\n        virUUIDFormat(dom ? dom->def->uuid : fakeuuid, uuidstr);\n        virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME) {\n        /* if dom is NULL just pass some name for backward compat.\n         * It is not used by peer */\n        virBufferAsprintf(&buf, \"<name>%s</name>\\n\", dom ? dom->def->name :\n                                                           \"__fakename__\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</vz-migration>\\n\");\n\n    *cookieout = virBufferContentAndReset(&buf);\n    *cookieoutlen = strlen(*cookieout) + 1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzBakeCookie(vzDriverPtr driver,\n             virDomainObjPtr dom,\n             char **cookieout, int *cookieoutlen,\n             unsigned int flags)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (!cookieout || !cookieoutlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Migration cookie parameters are not provided.\"));\n        return -1;\n    }\n\n    *cookieout = NULL;\n    *cookieoutlen = 0;\n\n    virBufferAddLit(&buf, \"<vz-migration>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (flags & VZ_MIGRATION_COOKIE_SESSION_UUID) {\n        virUUIDFormat(driver->session_uuid, uuidstr);\n        virBufferAsprintf(&buf, \"<session-uuid>%s</session-uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID) {\n        unsigned char fakeuuid[VIR_UUID_BUFLEN] = { 0 };\n\n        /* if dom is NULL just pass some parsable uuid for backward compat.\n         * It is not used by peer */\n        virUUIDFormat(dom ? dom->def->uuid : fakeuuid, uuidstr);\n        virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME) {\n        /* if dom is NULL just pass some name for backward compat.\n         * It is not used by peer */\n        virBufferAsprintf(&buf, \"<name>%s</name>\\n\", dom ? dom->def->name :\n                                                           \"__fakename__\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</vz-migration>\\n\");\n\n    *cookieout = virBufferContentAndReset(&buf);\n    *cookieoutlen = strlen(*cookieout) + 1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzMigrationCreateURI",
          "args": [],
          "line": 2984
        },
        "resolved": true,
        "details": {
          "function_name": "vzMigrationCreateURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2927-2948",
          "snippet": "static char*\nvzMigrationCreateURI(void)\n{\n    char *hostname = NULL;\n    char *uri = NULL;\n\n    if (!(hostname = virGetHostname()))\n        goto cleanup;\n\n    if (STRPREFIX(hostname, \"localhost\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"hostname on destination resolved to localhost,\"\n                         \" but migration requires an FQDN\"));\n        goto cleanup;\n    }\n\n    uri = g_strdup_printf(\"vzmigr://%s\", hostname);\n\n cleanup:\n    VIR_FREE(hostname);\n    return uri;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char*\nvzMigrationCreateURI(void)\n{\n    char *hostname = NULL;\n    char *uri = NULL;\n\n    if (!(hostname = virGetHostname()))\n        goto cleanup;\n\n    if (STRPREFIX(hostname, \"localhost\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"hostname on destination resolved to localhost,\"\n                         \" but migration requires an FQDN\"));\n        goto cleanup;\n    }\n\n    uri = g_strdup_printf(\"vzmigr://%s\", hostname);\n\n cleanup:\n    VIR_FREE(hostname);\n    return uri;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "&dname"
          ],
          "line": 2978
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VZ_MIGRATION_PARAMETERS"
          ],
          "line": 2971
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VZ_MIGRATION_FLAGS",
            "-1"
          ],
          "line": 2969
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL\n#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)\n\nstatic int\nvzDomainMigratePrepare3Params(virConnectPtr conn,\n                              virTypedParameterPtr params,\n                              int nparams,\n                              const char *cookiein G_GNUC_UNUSED,\n                              int cookieinlen G_GNUC_UNUSED,\n                              char **cookieout,\n                              int *cookieoutlen,\n                              char **uri_out,\n                              unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    const char *dom_xml = NULL;\n    virDomainDefPtr def = NULL;\n    int ret = -1;\n\n    virCheckFlags(VZ_MIGRATION_FLAGS, -1);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, &dom_xml) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0)\n        goto cleanup;\n\n    /* We must set uri_out if miguri is not set. This is direct\n     * managed migration requirement */\n    if (!miguri && !(*uri_out = vzMigrationCreateURI()))\n        goto cleanup;\n\n    /* domain uuid and domain name are for backward compat */\n    if (vzBakeCookie(privconn->driver, NULL,\n                     cookieout, cookieoutlen,\n                     VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME) < 0)\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(dom_xml, driver->xmlopt,\n                                        NULL,\n                                        VIR_DOMAIN_DEF_PARSE_INACTIVE)))\n        goto cleanup;\n\n    if (dname) {\n        VIR_FREE(def->name);\n        def->name = g_strdup(dname);\n    }\n\n    if (virDomainMigratePrepare3ParamsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainDefFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "vzMigrationCreateURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2927-2948",
    "snippet": "static char*\nvzMigrationCreateURI(void)\n{\n    char *hostname = NULL;\n    char *uri = NULL;\n\n    if (!(hostname = virGetHostname()))\n        goto cleanup;\n\n    if (STRPREFIX(hostname, \"localhost\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"hostname on destination resolved to localhost,\"\n                         \" but migration requires an FQDN\"));\n        goto cleanup;\n    }\n\n    uri = g_strdup_printf(\"vzmigr://%s\", hostname);\n\n cleanup:\n    VIR_FREE(hostname);\n    return uri;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "hostname"
          ],
          "line": 2946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"vzmigr://%s\"",
            "hostname"
          ],
          "line": 2943
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"hostname on destination resolved to localhost,\"\n                         \" but migration requires an FQDN\")"
          ],
          "line": 2937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "hostname",
            "\"localhost\""
          ],
          "line": 2936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetHostname",
          "args": [],
          "line": 2933
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostnameQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "560-564",
          "snippet": "char *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char*\nvzMigrationCreateURI(void)\n{\n    char *hostname = NULL;\n    char *uri = NULL;\n\n    if (!(hostname = virGetHostname()))\n        goto cleanup;\n\n    if (STRPREFIX(hostname, \"localhost\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"hostname on destination resolved to localhost,\"\n                         \" but migration requires an FQDN\"));\n        goto cleanup;\n    }\n\n    uri = g_strdup_printf(\"vzmigr://%s\", hostname);\n\n cleanup:\n    VIR_FREE(hostname);\n    return uri;\n}"
  },
  {
    "function_name": "vzDomainMigrateBegin3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2884-2925",
    "snippet": "static char *\nvzDomainMigrateBegin3Params(virDomainPtr domain,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            char **cookieout,\n                            int *cookieoutlen,\n                            unsigned int flags)\n{\n    char *xml = NULL;\n    virDomainObjPtr dom = NULL;\n    vzConnPtr privconn = domain->conn->privateData;\n    unsigned long long bandwidth = 0;\n\n    virCheckFlags(VZ_MIGRATION_FLAGS, NULL);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (virTypedParamsGetULLong(params, nparams, VIR_MIGRATE_PARAM_BANDWIDTH,\n                                &bandwidth) < 0)\n        goto cleanup;\n\n    if (bandwidth > 0) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Bandwidth rate limiting is not supported\"));\n        goto cleanup;\n    }\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainMigrateBegin3ParamsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    xml = vzDomainMigrateBeginStep(dom, privconn->driver, params, nparams,\n                                   cookieout, cookieoutlen);\n\n cleanup:\n\n    virDomainObjEndAPI(&dom);\n    return xml;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL",
      "#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2923
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainMigrateBeginStep",
          "args": [
            "dom",
            "privconn->driver",
            "params",
            "nparams",
            "cookieout",
            "cookieoutlen"
          ],
          "line": 2918
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainMigrateBeginStep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2856-2882",
          "snippet": "static char *\nvzDomainMigrateBeginStep(virDomainObjPtr dom,\n                         vzDriverPtr driver,\n                         virTypedParameterPtr params,\n                         int nparams,\n                         char **cookieout,\n                         int *cookieoutlen)\n{\n    /* we can't do this check via VZ_MIGRATION_PARAMETERS as on preparation\n     * step domain xml will be passed via this parameter and it is a common\n     * style to use single allowed parameter list definition in all steps */\n    if (virTypedParamsGet(params, nparams, VIR_MIGRATE_PARAM_DEST_XML)) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Changing destination XML is not supported\"));\n        return NULL;\n    }\n\n    /* session uuid, domain uuid and domain name are for backward compat */\n    if (vzBakeCookie(driver, dom, cookieout, cookieoutlen,\n                     VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME) < 0)\n        return NULL;\n\n    return virDomainDefFormat(dom->def, driver->xmlopt,\n                              VIR_DOMAIN_XML_MIGRATABLE);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL\n\nstatic char *\nvzDomainMigrateBeginStep(virDomainObjPtr dom,\n                         vzDriverPtr driver,\n                         virTypedParameterPtr params,\n                         int nparams,\n                         char **cookieout,\n                         int *cookieoutlen)\n{\n    /* we can't do this check via VZ_MIGRATION_PARAMETERS as on preparation\n     * step domain xml will be passed via this parameter and it is a common\n     * style to use single allowed parameter list definition in all steps */\n    if (virTypedParamsGet(params, nparams, VIR_MIGRATE_PARAM_DEST_XML)) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Changing destination XML is not supported\"));\n        return NULL;\n    }\n\n    /* session uuid, domain uuid and domain name are for backward compat */\n    if (vzBakeCookie(driver, dom, cookieout, cookieoutlen,\n                     VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME) < 0)\n        return NULL;\n\n    return virDomainDefFormat(dom->def, driver->xmlopt,\n                              VIR_DOMAIN_XML_MIGRATABLE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigrateBegin3ParamsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 2915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2912
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"Bandwidth rate limiting is not supported\")"
          ],
          "line": 2907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Bandwidth rate limiting is not supported\""
          ],
          "line": 2908
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetULLong",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_BANDWIDTH",
            "&bandwidth"
          ],
          "line": 2902
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "288-306",
          "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VZ_MIGRATION_PARAMETERS"
          ],
          "line": 2899
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VZ_MIGRATION_FLAGS",
            "NULL"
          ],
          "line": 2897
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL\n#define VZ_MIGRATION_FLAGS         (VIR_MIGRATE_PAUSED | \\\n                                    VIR_MIGRATE_PEER2PEER | \\\n                                    VIR_MIGRATE_LIVE | \\\n                                    VIR_MIGRATE_UNDEFINE_SOURCE | \\\n                                    VIR_MIGRATE_PERSIST_DEST | \\\n                                    VIR_MIGRATE_NON_SHARED_INC)\n\nstatic char *\nvzDomainMigrateBegin3Params(virDomainPtr domain,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            char **cookieout,\n                            int *cookieoutlen,\n                            unsigned int flags)\n{\n    char *xml = NULL;\n    virDomainObjPtr dom = NULL;\n    vzConnPtr privconn = domain->conn->privateData;\n    unsigned long long bandwidth = 0;\n\n    virCheckFlags(VZ_MIGRATION_FLAGS, NULL);\n\n    if (virTypedParamsValidate(params, nparams, VZ_MIGRATION_PARAMETERS) < 0)\n        goto cleanup;\n\n    if (virTypedParamsGetULLong(params, nparams, VIR_MIGRATE_PARAM_BANDWIDTH,\n                                &bandwidth) < 0)\n        goto cleanup;\n\n    if (bandwidth > 0) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Bandwidth rate limiting is not supported\"));\n        goto cleanup;\n    }\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainMigrateBegin3ParamsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    xml = vzDomainMigrateBeginStep(dom, privconn->driver, params, nparams,\n                                   cookieout, cookieoutlen);\n\n cleanup:\n\n    virDomainObjEndAPI(&dom);\n    return xml;\n}"
  },
  {
    "function_name": "vzDomainMigrateBeginStep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2856-2882",
    "snippet": "static char *\nvzDomainMigrateBeginStep(virDomainObjPtr dom,\n                         vzDriverPtr driver,\n                         virTypedParameterPtr params,\n                         int nparams,\n                         char **cookieout,\n                         int *cookieoutlen)\n{\n    /* we can't do this check via VZ_MIGRATION_PARAMETERS as on preparation\n     * step domain xml will be passed via this parameter and it is a common\n     * style to use single allowed parameter list definition in all steps */\n    if (virTypedParamsGet(params, nparams, VIR_MIGRATE_PARAM_DEST_XML)) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Changing destination XML is not supported\"));\n        return NULL;\n    }\n\n    /* session uuid, domain uuid and domain name are for backward compat */\n    if (vzBakeCookie(driver, dom, cookieout, cookieoutlen,\n                     VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME) < 0)\n        return NULL;\n\n    return virDomainDefFormat(dom->def, driver->xmlopt,\n                              VIR_DOMAIN_XML_MIGRATABLE);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFormat",
          "args": [
            "dom->def",
            "driver->xmlopt",
            "VIR_DOMAIN_XML_MIGRATABLE"
          ],
          "line": 2880
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29496-29508",
          "snippet": "char *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)\n\nchar *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzBakeCookie",
          "args": [
            "driver",
            "dom",
            "cookieout",
            "cookieoutlen",
            "VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME"
          ],
          "line": 2874
        },
        "resolved": true,
        "details": {
          "function_name": "vzBakeCookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2729-2778",
          "snippet": "static int\nvzBakeCookie(vzDriverPtr driver,\n             virDomainObjPtr dom,\n             char **cookieout, int *cookieoutlen,\n             unsigned int flags)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (!cookieout || !cookieoutlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Migration cookie parameters are not provided.\"));\n        return -1;\n    }\n\n    *cookieout = NULL;\n    *cookieoutlen = 0;\n\n    virBufferAddLit(&buf, \"<vz-migration>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (flags & VZ_MIGRATION_COOKIE_SESSION_UUID) {\n        virUUIDFormat(driver->session_uuid, uuidstr);\n        virBufferAsprintf(&buf, \"<session-uuid>%s</session-uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID) {\n        unsigned char fakeuuid[VIR_UUID_BUFLEN] = { 0 };\n\n        /* if dom is NULL just pass some parsable uuid for backward compat.\n         * It is not used by peer */\n        virUUIDFormat(dom ? dom->def->uuid : fakeuuid, uuidstr);\n        virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME) {\n        /* if dom is NULL just pass some name for backward compat.\n         * It is not used by peer */\n        virBufferAsprintf(&buf, \"<name>%s</name>\\n\", dom ? dom->def->name :\n                                                           \"__fakename__\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</vz-migration>\\n\");\n\n    *cookieout = virBufferContentAndReset(&buf);\n    *cookieoutlen = strlen(*cookieout) + 1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzBakeCookie(vzDriverPtr driver,\n             virDomainObjPtr dom,\n             char **cookieout, int *cookieoutlen,\n             unsigned int flags)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (!cookieout || !cookieoutlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Migration cookie parameters are not provided.\"));\n        return -1;\n    }\n\n    *cookieout = NULL;\n    *cookieoutlen = 0;\n\n    virBufferAddLit(&buf, \"<vz-migration>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (flags & VZ_MIGRATION_COOKIE_SESSION_UUID) {\n        virUUIDFormat(driver->session_uuid, uuidstr);\n        virBufferAsprintf(&buf, \"<session-uuid>%s</session-uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID) {\n        unsigned char fakeuuid[VIR_UUID_BUFLEN] = { 0 };\n\n        /* if dom is NULL just pass some parsable uuid for backward compat.\n         * It is not used by peer */\n        virUUIDFormat(dom ? dom->def->uuid : fakeuuid, uuidstr);\n        virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME) {\n        /* if dom is NULL just pass some name for backward compat.\n         * It is not used by peer */\n        virBufferAsprintf(&buf, \"<name>%s</name>\\n\", dom ? dom->def->name :\n                                                           \"__fakename__\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</vz-migration>\\n\");\n\n    *cookieout = virBufferContentAndReset(&buf);\n    *cookieoutlen = strlen(*cookieout) + 1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"Changing destination XML is not supported\")"
          ],
          "line": 2868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Changing destination XML is not supported\""
          ],
          "line": 2869
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_XML"
          ],
          "line": 2867
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VZ_MIGRATION_PARAMETERS \\\n    VIR_MIGRATE_PARAM_DEST_XML,         VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_URI,              VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_DEST_NAME,        VIR_TYPED_PARAM_STRING, \\\n    VIR_MIGRATE_PARAM_BANDWIDTH,        VIR_TYPED_PARAM_ULLONG, \\\n    NULL\n\nstatic char *\nvzDomainMigrateBeginStep(virDomainObjPtr dom,\n                         vzDriverPtr driver,\n                         virTypedParameterPtr params,\n                         int nparams,\n                         char **cookieout,\n                         int *cookieoutlen)\n{\n    /* we can't do this check via VZ_MIGRATION_PARAMETERS as on preparation\n     * step domain xml will be passed via this parameter and it is a common\n     * style to use single allowed parameter list definition in all steps */\n    if (virTypedParamsGet(params, nparams, VIR_MIGRATE_PARAM_DEST_XML)) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Changing destination XML is not supported\"));\n        return NULL;\n    }\n\n    /* session uuid, domain uuid and domain name are for backward compat */\n    if (vzBakeCookie(driver, dom, cookieout, cookieoutlen,\n                     VZ_MIGRATION_COOKIE_SESSION_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_UUID\n                     | VZ_MIGRATION_COOKIE_DOMAIN_NAME) < 0)\n        return NULL;\n\n    return virDomainDefFormat(dom->def, driver->xmlopt,\n                              VIR_DOMAIN_XML_MIGRATABLE);\n}"
  },
  {
    "function_name": "vzEatCookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2780-2840",
    "snippet": "static vzMigrationCookiePtr\nvzEatCookie(const char *cookiein, int cookieinlen, unsigned int flags)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctx = NULL;\n    char *tmp = NULL;\n    vzMigrationCookiePtr mig = NULL;\n\n    if (VIR_ALLOC(mig) < 0)\n        return NULL;\n\n    if (!cookiein || cookieinlen <= 0 || cookiein[cookieinlen - 1] != '\\0') {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid migration cookie\"));\n        goto error;\n    }\n\n    if (!(doc = virXMLParseStringCtxt(cookiein,\n                                      _(\"(_migration_cookie)\"), &ctx)))\n        goto error;\n\n    if ((flags & VZ_MIGRATION_COOKIE_SESSION_UUID)\n        && (!(tmp = virXPathString(\"string(./session-uuid[1])\", ctx))\n            || (VIR_ALLOC_N(mig->session_uuid, VIR_UUID_BUFLEN) < 0)\n            || (virUUIDParse(tmp, mig->session_uuid) < 0))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing or malformed session-uuid element \"\n                         \"in migration data\"));\n        VIR_FREE(tmp);\n        goto error;\n    }\n    VIR_FREE(tmp);\n\n    if ((flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID)\n        && (!(tmp = virXPathString(\"string(./uuid[1])\", ctx))\n            || (VIR_ALLOC_N(mig->uuid, VIR_UUID_BUFLEN) < 0)\n            || (virUUIDParse(tmp, mig->uuid) < 0))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing or malformed uuid element in migration data\"));\n        VIR_FREE(tmp);\n        goto error;\n    }\n    VIR_FREE(tmp);\n\n    if ((flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME)\n        && !(mig->name = virXPathString(\"string(./name[1])\", ctx))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing name element in migration data\"));\n        goto error;\n    }\n\n cleanup:\n    xmlXPathFreeContext(ctx);\n    xmlFreeDoc(doc);\n    return mig;\n\n error:\n    vzMigrationCookieFree(mig);\n    mig = NULL;\n    goto cleanup;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzMigrationCookieFree",
          "args": [
            "mig"
          ],
          "line": 2837
        },
        "resolved": true,
        "details": {
          "function_name": "vzMigrationCookieFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2717-2727",
          "snippet": "static void\nvzMigrationCookieFree(vzMigrationCookiePtr mig)\n{\n    if (!mig)\n        return;\n\n    VIR_FREE(mig->session_uuid);\n    VIR_FREE(mig->uuid);\n    VIR_FREE(mig->name);\n    VIR_FREE(mig);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvzMigrationCookieFree(vzMigrationCookiePtr mig)\n{\n    if (!mig)\n        return;\n\n    VIR_FREE(mig->session_uuid);\n    VIR_FREE(mig->uuid);\n    VIR_FREE(mig->name);\n    VIR_FREE(mig);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "doc"
          ],
          "line": 2833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeContext",
          "args": [
            "ctx"
          ],
          "line": 2832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing name element in migration data\")"
          ],
          "line": 2826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing name element in migration data\""
          ],
          "line": 2827
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./name[1])\"",
            "ctx"
          ],
          "line": 2825
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 2822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 2819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing or malformed uuid element in migration data\")"
          ],
          "line": 2817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "tmp",
            "mig->uuid"
          ],
          "line": 2816
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "mig->uuid",
            "VIR_UUID_BUFLEN"
          ],
          "line": 2815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 2811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 2808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing or malformed session-uuid element \"\n                         \"in migration data\")"
          ],
          "line": 2805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "mig->session_uuid",
            "VIR_UUID_BUFLEN"
          ],
          "line": 2803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLParseStringCtxt",
          "args": [
            "cookiein",
            "_(\"(_migration_cookie)\")",
            "&ctx"
          ],
          "line": 2797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Invalid migration cookie\")"
          ],
          "line": 2792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "mig"
          ],
          "line": 2788
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic vzMigrationCookiePtr\nvzEatCookie(const char *cookiein, int cookieinlen, unsigned int flags)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctx = NULL;\n    char *tmp = NULL;\n    vzMigrationCookiePtr mig = NULL;\n\n    if (VIR_ALLOC(mig) < 0)\n        return NULL;\n\n    if (!cookiein || cookieinlen <= 0 || cookiein[cookieinlen - 1] != '\\0') {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Invalid migration cookie\"));\n        goto error;\n    }\n\n    if (!(doc = virXMLParseStringCtxt(cookiein,\n                                      _(\"(_migration_cookie)\"), &ctx)))\n        goto error;\n\n    if ((flags & VZ_MIGRATION_COOKIE_SESSION_UUID)\n        && (!(tmp = virXPathString(\"string(./session-uuid[1])\", ctx))\n            || (VIR_ALLOC_N(mig->session_uuid, VIR_UUID_BUFLEN) < 0)\n            || (virUUIDParse(tmp, mig->session_uuid) < 0))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing or malformed session-uuid element \"\n                         \"in migration data\"));\n        VIR_FREE(tmp);\n        goto error;\n    }\n    VIR_FREE(tmp);\n\n    if ((flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID)\n        && (!(tmp = virXPathString(\"string(./uuid[1])\", ctx))\n            || (VIR_ALLOC_N(mig->uuid, VIR_UUID_BUFLEN) < 0)\n            || (virUUIDParse(tmp, mig->uuid) < 0))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing or malformed uuid element in migration data\"));\n        VIR_FREE(tmp);\n        goto error;\n    }\n    VIR_FREE(tmp);\n\n    if ((flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME)\n        && !(mig->name = virXPathString(\"string(./name[1])\", ctx))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing name element in migration data\"));\n        goto error;\n    }\n\n cleanup:\n    xmlXPathFreeContext(ctx);\n    xmlFreeDoc(doc);\n    return mig;\n\n error:\n    vzMigrationCookieFree(mig);\n    mig = NULL;\n    goto cleanup;\n}"
  },
  {
    "function_name": "vzBakeCookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2729-2778",
    "snippet": "static int\nvzBakeCookie(vzDriverPtr driver,\n             virDomainObjPtr dom,\n             char **cookieout, int *cookieoutlen,\n             unsigned int flags)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (!cookieout || !cookieoutlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Migration cookie parameters are not provided.\"));\n        return -1;\n    }\n\n    *cookieout = NULL;\n    *cookieoutlen = 0;\n\n    virBufferAddLit(&buf, \"<vz-migration>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (flags & VZ_MIGRATION_COOKIE_SESSION_UUID) {\n        virUUIDFormat(driver->session_uuid, uuidstr);\n        virBufferAsprintf(&buf, \"<session-uuid>%s</session-uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID) {\n        unsigned char fakeuuid[VIR_UUID_BUFLEN] = { 0 };\n\n        /* if dom is NULL just pass some parsable uuid for backward compat.\n         * It is not used by peer */\n        virUUIDFormat(dom ? dom->def->uuid : fakeuuid, uuidstr);\n        virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME) {\n        /* if dom is NULL just pass some name for backward compat.\n         * It is not used by peer */\n        virBufferAsprintf(&buf, \"<name>%s</name>\\n\", dom ? dom->def->name :\n                                                           \"__fakename__\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</vz-migration>\\n\");\n\n    *cookieout = virBufferContentAndReset(&buf);\n    *cookieoutlen = strlen(*cookieout) + 1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "*cookieout"
          ],
          "line": 2775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 2774
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</vz-migration>\\n\""
          ],
          "line": 2772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "&buf",
            "-2"
          ],
          "line": 2771
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\"<name>%s</name>\\n\"",
            "dom ? dom->def->name :\n                                                           \"__fakename__\""
          ],
          "line": 2767
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "dom ? dom->def->uuid : fakeuuid",
            "uuidstr"
          ],
          "line": 2760
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<vz-migration>\\n\""
          ],
          "line": 2747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Migration cookie parameters are not provided.\")"
          ],
          "line": 2739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Migration cookie parameters are not provided.\""
          ],
          "line": 2740
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzBakeCookie(vzDriverPtr driver,\n             virDomainObjPtr dom,\n             char **cookieout, int *cookieoutlen,\n             unsigned int flags)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (!cookieout || !cookieoutlen) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Migration cookie parameters are not provided.\"));\n        return -1;\n    }\n\n    *cookieout = NULL;\n    *cookieoutlen = 0;\n\n    virBufferAddLit(&buf, \"<vz-migration>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (flags & VZ_MIGRATION_COOKIE_SESSION_UUID) {\n        virUUIDFormat(driver->session_uuid, uuidstr);\n        virBufferAsprintf(&buf, \"<session-uuid>%s</session-uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_UUID) {\n        unsigned char fakeuuid[VIR_UUID_BUFLEN] = { 0 };\n\n        /* if dom is NULL just pass some parsable uuid for backward compat.\n         * It is not used by peer */\n        virUUIDFormat(dom ? dom->def->uuid : fakeuuid, uuidstr);\n        virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n    }\n\n    if (flags & VZ_MIGRATION_COOKIE_DOMAIN_NAME) {\n        /* if dom is NULL just pass some name for backward compat.\n         * It is not used by peer */\n        virBufferAsprintf(&buf, \"<name>%s</name>\\n\", dom ? dom->def->name :\n                                                           \"__fakename__\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</vz-migration>\\n\");\n\n    *cookieout = virBufferContentAndReset(&buf);\n    *cookieoutlen = strlen(*cookieout) + 1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzMigrationCookieFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2717-2727",
    "snippet": "static void\nvzMigrationCookieFree(vzMigrationCookiePtr mig)\n{\n    if (!mig)\n        return;\n\n    VIR_FREE(mig->session_uuid);\n    VIR_FREE(mig->uuid);\n    VIR_FREE(mig->name);\n    VIR_FREE(mig);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mig"
          ],
          "line": 2726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mig->name"
          ],
          "line": 2725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mig->uuid"
          ],
          "line": 2724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mig->session_uuid"
          ],
          "line": 2723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvzMigrationCookieFree(vzMigrationCookiePtr mig)\n{\n    if (!mig)\n        return;\n\n    VIR_FREE(mig->session_uuid);\n    VIR_FREE(mig->uuid);\n    VIR_FREE(mig->name);\n    VIR_FREE(mig);\n}"
  },
  {
    "function_name": "vzDomainRevertToSnapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2671-2701",
    "snippet": "static int\nvzDomainRevertToSnapshot(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainRevertToSnapshotEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSwitchToSnapshot(dom, snapshot->name,\n                                 flags & VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED);\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2698
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 2697
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkSwitchToSnapshot",
          "args": [
            "dom",
            "snapshot->name",
            "flags & VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED"
          ],
          "line": 2693
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkSwitchToSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4788-4802",
          "snippet": "int prlsdkSwitchToSnapshot(virDomainObjPtr dom, const char *uuid, bool paused)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    PRL_UINT32 flags = 0;\n\n    if (paused)\n        flags |= PSSF_SKIP_RESUME;\n\n    job = PrlVm_SwitchToSnapshotEx(privdom->sdkdom, uuid, flags);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nprlsdkUUIDParse(const char *uuidstr, unsigned char *uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nprlsdkUUIDParse(const char *uuidstr, unsigned char *uuid);\n\nint prlsdkSwitchToSnapshot(virDomainObjPtr dom, const char *uuid, bool paused)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    PRL_UINT32 flags = 0;\n\n    if (paused)\n        flags |= PSSF_SKIP_RESUME;\n\n    job = PrlVm_SwitchToSnapshotEx(privdom->sdkdom, uuid, flags);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 2690
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 2686
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainRevertToSnapshotEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def"
          ],
          "line": 2683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2680
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED",
            "-1"
          ],
          "line": 2678
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainRevertToSnapshot(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainRevertToSnapshotEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSwitchToSnapshot(dom, snapshot->name,\n                                 flags & VIR_DOMAIN_SNAPSHOT_REVERT_PAUSED);\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSnapshotDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2648-2669",
    "snippet": "static int\nvzDomainSnapshotDelete(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotDeleteEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = prlsdkDeleteSnapshot(dom, snapshot->name,\n                               flags & VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2666
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkDeleteSnapshot",
          "args": [
            "dom",
            "snapshot->name",
            "flags & VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN"
          ],
          "line": 2662
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkDeleteSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4776-4786",
          "snippet": "int prlsdkDeleteSnapshot(virDomainObjPtr dom, const char *uuid, bool children)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n\n    job = PrlVm_DeleteSnapshot(privdom->sdkdom, uuid, children);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nprlsdkUUIDParse(const char *uuidstr, unsigned char *uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nprlsdkUUIDParse(const char *uuidstr, unsigned char *uuid);\n\nint prlsdkDeleteSnapshot(virDomainObjPtr dom, const char *uuid, bool children)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n\n    job = PrlVm_DeleteSnapshot(privdom->sdkdom, uuid, children);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotDeleteEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def"
          ],
          "line": 2659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2656
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN",
            "-1"
          ],
          "line": 2654
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSnapshotDelete(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotDeleteEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = prlsdkDeleteSnapshot(dom, snapshot->name,\n                               flags & VIR_DOMAIN_SNAPSHOT_DELETE_CHILDREN);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSnapshotCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2573-2646",
    "snippet": "static virDomainSnapshotPtr\nvzDomainSnapshotCreateXML(virDomainPtr domain,\n                          const char *xmlDesc,\n                          unsigned int flags)\n{\n    virDomainSnapshotPtr snapshot = NULL;\n    virDomainObjPtr dom;\n    vzConnPtr privconn = domain->conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    unsigned int parse_flags = VIR_DOMAIN_SNAPSHOT_PARSE_DISKS;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    virDomainMomentObjPtr current;\n    bool job = false;\n    g_autoptr(virDomainSnapshotDef) def = NULL;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_CREATE_VALIDATE, NULL);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainSnapshotCreateXMLEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (flags & VIR_DOMAIN_SNAPSHOT_CREATE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_SNAPSHOT_PARSE_VALIDATE;\n\n    if (!(def = virDomainSnapshotDefParseString(xmlDesc,\n                                                driver->xmlopt, NULL, NULL,\n                                                parse_flags)))\n        goto cleanup;\n\n    if (def->ndisks > 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"configuring disks is not supported for vz snapshots\"));\n        goto cleanup;\n    }\n\n    if (def->memory) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"configuring memory location is not supported\"));\n        goto cleanup;\n    }\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    /* snaphot name is ignored, it will be set to auto generated by sdk uuid */\n    if (prlsdkCreateSnapshot(dom, def->parent.description) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(current = virDomainSnapshotGetCurrent(snapshots))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"can't find created snapshot\"));\n        goto cleanup;\n    }\n\n    /* hopefully new current snapshot is newly created one */\n    snapshot = virGetDomainSnapshot(domain, current->def->name);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return snapshot;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2643
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 2642
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2640
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomainSnapshot",
          "args": [
            "domain",
            "current->def->name"
          ],
          "line": 2637
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomainSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "1023-1045",
          "snippet": "virDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainSnapshotClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainSnapshotClass;\n\nvirDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"can't find created snapshot\")"
          ],
          "line": 2631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"can't find created snapshot\""
          ],
          "line": 2632
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotGetCurrent",
          "args": [
            "snapshots"
          ],
          "line": 2630
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "184-188",
          "snippet": "const char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2627
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkCreateSnapshot",
          "args": [
            "dom",
            "def->parent.description"
          ],
          "line": 2624
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkCreateSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4763-4774",
          "snippet": "int prlsdkCreateSnapshot(virDomainObjPtr dom, const char *description)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n\n    job = PrlVm_CreateSnapshot(privdom->sdkdom, \"\",\n                               description ? : \"\");\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint prlsdkCreateSnapshot(virDomainObjPtr dom, const char *description)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n\n    job = PrlVm_CreateSnapshot(privdom->sdkdom, \"\",\n                               description ? : \"\");\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 2620
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 2616
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"configuring memory location is not supported\")"
          ],
          "line": 2611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"configuring disks is not supported for vz snapshots\")"
          ],
          "line": 2605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotDefParseString",
          "args": [
            "xmlDesc",
            "driver->xmlopt",
            "NULL",
            "NULL",
            "parse_flags"
          ],
          "line": 2599
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/snapshot_conf.c",
          "lines": "452-473",
          "snippet": "virDomainSnapshotDefPtr\nvirDomainSnapshotDefParseString(const char *xmlStr,\n                                virDomainXMLOptionPtr xmlopt,\n                                void *parseOpaque,\n                                bool *current,\n                                unsigned int flags)\n{\n    virDomainSnapshotDefPtr ret = NULL;\n    xmlDocPtr xml;\n    int keepBlanksDefault = xmlKeepBlanksDefault(0);\n\n    if ((xml = virXMLParse(NULL, xmlStr, _(\"(domain_snapshot)\")))) {\n        xmlKeepBlanksDefault(keepBlanksDefault);\n        ret = virDomainSnapshotDefParseNode(xml, xmlDocGetRootElement(xml),\n                                            xmlopt, parseOpaque,\n                                            current, flags);\n        xmlFreeDoc(xml);\n    }\n    xmlKeepBlanksDefault(keepBlanksDefault);\n\n    return ret;\n}",
          "includes": [
            "#include \"snapshot_conf_priv.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"snapshot_conf_priv.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"snapshot_conf.h\"\n#include \"secret_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainSnapshotDefPtr\nvirDomainSnapshotDefParseString(const char *xmlStr,\n                                virDomainXMLOptionPtr xmlopt,\n                                void *parseOpaque,\n                                bool *current,\n                                unsigned int flags)\n{\n    virDomainSnapshotDefPtr ret = NULL;\n    xmlDocPtr xml;\n    int keepBlanksDefault = xmlKeepBlanksDefault(0);\n\n    if ((xml = virXMLParse(NULL, xmlStr, _(\"(domain_snapshot)\")))) {\n        xmlKeepBlanksDefault(keepBlanksDefault);\n        ret = virDomainSnapshotDefParseNode(xml, xmlDocGetRootElement(xml),\n                                            xmlopt, parseOpaque,\n                                            current, flags);\n        xmlFreeDoc(xml);\n    }\n    xmlKeepBlanksDefault(keepBlanksDefault);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotCreateXMLEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 2593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2590
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_CREATE_VALIDATE",
            "NULL"
          ],
          "line": 2588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainSnapshotPtr\nvzDomainSnapshotCreateXML(virDomainPtr domain,\n                          const char *xmlDesc,\n                          unsigned int flags)\n{\n    virDomainSnapshotPtr snapshot = NULL;\n    virDomainObjPtr dom;\n    vzConnPtr privconn = domain->conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    unsigned int parse_flags = VIR_DOMAIN_SNAPSHOT_PARSE_DISKS;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    virDomainMomentObjPtr current;\n    bool job = false;\n    g_autoptr(virDomainSnapshotDef) def = NULL;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_CREATE_VALIDATE, NULL);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainSnapshotCreateXMLEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (flags & VIR_DOMAIN_SNAPSHOT_CREATE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_SNAPSHOT_PARSE_VALIDATE;\n\n    if (!(def = virDomainSnapshotDefParseString(xmlDesc,\n                                                driver->xmlopt, NULL, NULL,\n                                                parse_flags)))\n        goto cleanup;\n\n    if (def->ndisks > 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"configuring disks is not supported for vz snapshots\"));\n        goto cleanup;\n    }\n\n    if (def->memory) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"configuring memory location is not supported\"));\n        goto cleanup;\n    }\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    /* snaphot name is ignored, it will be set to auto generated by sdk uuid */\n    if (prlsdkCreateSnapshot(dom, def->parent.description) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(current = virDomainSnapshotGetCurrent(snapshots))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"can't find created snapshot\"));\n        goto cleanup;\n    }\n\n    /* hopefully new current snapshot is newly created one */\n    snapshot = virGetDomainSnapshot(domain, current->def->name);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return snapshot;\n}"
  },
  {
    "function_name": "vzDomainSnapshotHasMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2541-2571",
    "snippet": "static int\nvzDomainSnapshotHasMetadata(virDomainSnapshotPtr snapshot,\n                              unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotHasMetadataEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    ret = 1;\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2568
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2567
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzSnapObjFromSnapshot",
          "args": [
            "snapshots",
            "snapshot"
          ],
          "line": 2561
        },
        "resolved": true,
        "details": {
          "function_name": "vzSnapObjFromSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2146-2151",
          "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2558
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotHasMetadataEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def"
          ],
          "line": 2555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2552
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 2550
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSnapshotHasMetadata(virDomainSnapshotPtr snapshot,\n                              unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotHasMetadataEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    ret = 1;\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSnapshotIsCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2512-2539",
    "snippet": "static int\nvzDomainSnapshotIsCurrent(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    virDomainMomentObjPtr current;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotIsCurrentEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    current = virDomainSnapshotGetCurrent(snapshots);\n    ret = current && STREQ(snapshot->name, current->def->name);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2536
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2535
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "snapshot->name",
            "current->def->name"
          ],
          "line": 2532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotGetCurrent",
          "args": [
            "snapshots"
          ],
          "line": 2531
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "184-188",
          "snippet": "const char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2528
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotIsCurrentEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def"
          ],
          "line": 2525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2522
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 2520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSnapshotIsCurrent(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    virDomainMomentObjPtr current;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotIsCurrentEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    current = virDomainSnapshotGetCurrent(snapshots);\n    ret = current && STREQ(snapshot->name, current->def->name);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSnapshotCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2478-2510",
    "snippet": "static virDomainSnapshotPtr\nvzDomainSnapshotCurrent(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotPtr snapshot = NULL;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    virDomainMomentObjPtr current;\n\n    virCheckFlags(0, NULL);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainSnapshotCurrentEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(current = virDomainSnapshotGetCurrent(snapshots))) {\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT, \"%s\",\n                       _(\"the domain does not have a current snapshot\"));\n        goto cleanup;\n    }\n\n    snapshot = virGetDomainSnapshot(domain, current->def->name);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return snapshot;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2507
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2506
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomainSnapshot",
          "args": [
            "domain",
            "current->def->name"
          ],
          "line": 2503
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomainSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "1023-1045",
          "snippet": "virDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainSnapshotClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainSnapshotClass;\n\nvirDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN_SNAPSHOT",
            "\"%s\"",
            "_(\"the domain does not have a current snapshot\")"
          ],
          "line": 2498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"the domain does not have a current snapshot\""
          ],
          "line": 2499
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotGetCurrent",
          "args": [
            "snapshots"
          ],
          "line": 2497
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "184-188",
          "snippet": "const char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2494
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotCurrentEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 2491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2488
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 2486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainSnapshotPtr\nvzDomainSnapshotCurrent(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotPtr snapshot = NULL;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    virDomainMomentObjPtr current;\n\n    virCheckFlags(0, NULL);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainSnapshotCurrentEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(current = virDomainSnapshotGetCurrent(snapshots))) {\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT, \"%s\",\n                       _(\"the domain does not have a current snapshot\"));\n        goto cleanup;\n    }\n\n    snapshot = virGetDomainSnapshot(domain, current->def->name);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return snapshot;\n}"
  },
  {
    "function_name": "vzDomainSnapshotGetParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2440-2476",
    "snippet": "static virDomainSnapshotPtr\nvzDomainSnapshotGetParent(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotPtr parent = NULL;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return NULL;\n\n    if (virDomainSnapshotGetParentEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    if (!snap->def->parent_name) {\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT,\n                       _(\"snapshot '%s' does not have a parent\"),\n                       snap->def->name);\n        goto cleanup;\n    }\n\n    parent = virGetDomainSnapshot(snapshot->domain, snap->def->parent_name);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return parent;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2473
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2472
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomainSnapshot",
          "args": [
            "snapshot->domain",
            "snap->def->parent_name"
          ],
          "line": 2469
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomainSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "1023-1045",
          "snippet": "virDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainSnapshotClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainSnapshotClass;\n\nvirDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN_SNAPSHOT",
            "_(\"snapshot '%s' does not have a parent\")",
            "snap->def->name"
          ],
          "line": 2463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"snapshot '%s' does not have a parent\""
          ],
          "line": 2464
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzSnapObjFromSnapshot",
          "args": [
            "snapshots",
            "snapshot"
          ],
          "line": 2459
        },
        "resolved": true,
        "details": {
          "function_name": "vzSnapObjFromSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2146-2151",
          "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2456
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotGetParentEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def"
          ],
          "line": 2453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2450
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 2448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainSnapshotPtr\nvzDomainSnapshotGetParent(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotPtr parent = NULL;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return NULL;\n\n    if (virDomainSnapshotGetParentEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    if (!snap->def->parent_name) {\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT,\n                       _(\"snapshot '%s' does not have a parent\"),\n                       snap->def->name);\n        goto cleanup;\n    }\n\n    parent = virGetDomainSnapshot(snapshot->domain, snap->def->parent_name);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return parent;\n}"
  },
  {
    "function_name": "vzDomainHasCurrentSnapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2413-2438",
    "snippet": "static int\nvzDomainHasCurrentSnapshot(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainHasCurrentSnapshotEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    ret = virDomainSnapshotGetCurrent(snapshots) != NULL;\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2435
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2434
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotGetCurrent",
          "args": [
            "snapshots"
          ],
          "line": 2431
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "184-188",
          "snippet": "const char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2428
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHasCurrentSnapshotEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 2425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2422
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 2420
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainHasCurrentSnapshot(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainHasCurrentSnapshotEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    ret = virDomainSnapshotGetCurrent(snapshots) != NULL;\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSnapshotLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2380-2411",
    "snippet": "static virDomainSnapshotPtr\nvzDomainSnapshotLookupByName(virDomainPtr domain,\n                             const char *name,\n                             unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotPtr snapshot = NULL;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainSnapshotLookupByNameEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromName(snapshots, name)))\n        goto cleanup;\n\n    snapshot = virGetDomainSnapshot(domain, snap->def->name);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    virDomainSnapshotObjListFree(snapshots);\n\n    return snapshot;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2408
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2407
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomainSnapshot",
          "args": [
            "domain",
            "snap->def->name"
          ],
          "line": 2404
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomainSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "1023-1045",
          "snippet": "virDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainSnapshotClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainSnapshotClass;\n\nvirDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzSnapObjFromName",
          "args": [
            "snapshots",
            "name"
          ],
          "line": 2401
        },
        "resolved": true,
        "details": {
          "function_name": "vzSnapObjFromName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2134-2144",
          "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromName(virDomainSnapshotObjListPtr snapshots, const char *name)\n{\n    virDomainMomentObjPtr snap = NULL;\n    snap = virDomainSnapshotFindByName(snapshots, name);\n    if (!snap)\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT,\n                       _(\"no domain snapshot with matching name '%s'\"), name);\n\n    return snap;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromName(virDomainSnapshotObjListPtr snapshots, const char *name)\n{\n    virDomainMomentObjPtr snap = NULL;\n    snap = virDomainSnapshotFindByName(snapshots, name);\n    if (!snap)\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT,\n                       _(\"no domain snapshot with matching name '%s'\"), name);\n\n    return snap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2398
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotLookupByNameEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 2395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2392
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 2390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainSnapshotPtr\nvzDomainSnapshotLookupByName(virDomainPtr domain,\n                             const char *name,\n                             unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotPtr snapshot = NULL;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainSnapshotLookupByNameEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromName(snapshots, name)))\n        goto cleanup;\n\n    snapshot = virGetDomainSnapshot(domain, snap->def->name);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    virDomainSnapshotObjListFree(snapshots);\n\n    return snapshot;\n}"
  },
  {
    "function_name": "vzDomainSnapshotListAllChildren",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2346-2378",
    "snippet": "static int\nvzDomainSnapshotListAllChildren(virDomainSnapshotPtr snapshot,\n                                virDomainSnapshotPtr **snaps,\n                                unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotListAllChildrenEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    n = virDomainListSnapshots(snapshots, snap, snapshot->domain, snaps, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2375
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2374
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainListSnapshots",
          "args": [
            "snapshots",
            "snap",
            "snapshot->domain",
            "snaps",
            "flags"
          ],
          "line": 2371
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainListSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "255-294",
          "snippet": "int\nvirDomainListSnapshots(virDomainSnapshotObjListPtr snapshots,\n                       virDomainMomentObjPtr from,\n                       virDomainPtr dom,\n                       virDomainSnapshotPtr **snaps,\n                       unsigned int flags)\n{\n    int count = virDomainSnapshotObjListNum(snapshots, from, flags);\n    virDomainSnapshotPtr *list = NULL;\n    char **names;\n    int ret = -1;\n    size_t i;\n\n    if (!snaps || count < 0)\n        return count;\n    if (VIR_ALLOC_N(names, count) < 0 ||\n        VIR_ALLOC_N(list, count + 1) < 0)\n        goto cleanup;\n\n    if (virDomainSnapshotObjListGetNames(snapshots, from, names, count,\n                                         flags) < 0)\n        goto cleanup;\n    for (i = 0; i < count; i++)\n        if ((list[i] = virGetDomainSnapshot(dom, names[i])) == NULL)\n            goto cleanup;\n\n    ret = count;\n    *snaps = list;\n\n cleanup:\n    for (i = 0; i < count; i++)\n        VIR_FREE(names[i]);\n    VIR_FREE(names);\n    if (ret < 0 && list) {\n        for (i = 0; i < count; i++)\n            virObjectUnref(list[i]);\n        VIR_FREE(list);\n    }\n    return ret;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainListSnapshots(virDomainSnapshotObjListPtr snapshots,\n                       virDomainMomentObjPtr from,\n                       virDomainPtr dom,\n                       virDomainSnapshotPtr **snaps,\n                       unsigned int flags)\n{\n    int count = virDomainSnapshotObjListNum(snapshots, from, flags);\n    virDomainSnapshotPtr *list = NULL;\n    char **names;\n    int ret = -1;\n    size_t i;\n\n    if (!snaps || count < 0)\n        return count;\n    if (VIR_ALLOC_N(names, count) < 0 ||\n        VIR_ALLOC_N(list, count + 1) < 0)\n        goto cleanup;\n\n    if (virDomainSnapshotObjListGetNames(snapshots, from, names, count,\n                                         flags) < 0)\n        goto cleanup;\n    for (i = 0; i < count; i++)\n        if ((list[i] = virGetDomainSnapshot(dom, names[i])) == NULL)\n            goto cleanup;\n\n    ret = count;\n    *snaps = list;\n\n cleanup:\n    for (i = 0; i < count; i++)\n        VIR_FREE(names[i]);\n    VIR_FREE(names);\n    if (ret < 0 && list) {\n        for (i = 0; i < count; i++)\n            virObjectUnref(list[i]);\n        VIR_FREE(list);\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzSnapObjFromSnapshot",
          "args": [
            "snapshots",
            "snapshot"
          ],
          "line": 2368
        },
        "resolved": true,
        "details": {
          "function_name": "vzSnapObjFromSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2146-2151",
          "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2365
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotListAllChildrenEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def"
          ],
          "line": 2362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2359
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL",
            "-1"
          ],
          "line": 2356
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSnapshotListAllChildren(virDomainSnapshotPtr snapshot,\n                                virDomainSnapshotPtr **snaps,\n                                unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotListAllChildrenEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    n = virDomainListSnapshots(snapshots, snap, snapshot->domain, snaps, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}"
  },
  {
    "function_name": "vzDomainSnapshotListChildrenNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2311-2344",
    "snippet": "static int\nvzDomainSnapshotListChildrenNames(virDomainSnapshotPtr snapshot,\n                                  char **names,\n                                  int nameslen,\n                                  unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotListChildrenNamesEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    n = virDomainSnapshotObjListGetNames(snapshots, snap, names, nameslen, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2341
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2340
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListGetNames",
          "args": [
            "snapshots",
            "snap",
            "names",
            "nameslen",
            "flags"
          ],
          "line": 2337
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "109-155",
          "snippet": "int\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzSnapObjFromSnapshot",
          "args": [
            "snapshots",
            "snapshot"
          ],
          "line": 2334
        },
        "resolved": true,
        "details": {
          "function_name": "vzSnapObjFromSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2146-2151",
          "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2331
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotListChildrenNamesEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def"
          ],
          "line": 2328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2325
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL",
            "-1"
          ],
          "line": 2322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSnapshotListChildrenNames(virDomainSnapshotPtr snapshot,\n                                  char **names,\n                                  int nameslen,\n                                  unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotListChildrenNamesEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    n = virDomainSnapshotObjListGetNames(snapshots, snap, names, nameslen, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}"
  },
  {
    "function_name": "vzDomainSnapshotNumChildren",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2279-2309",
    "snippet": "static int\nvzDomainSnapshotNumChildren(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotNumChildrenEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    n = virDomainSnapshotObjListNum(snapshots, snap, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2306
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2305
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListNum",
          "args": [
            "snapshots",
            "snap",
            "flags"
          ],
          "line": 2302
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListNum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "158-164",
          "snippet": "int\nvirDomainSnapshotObjListNum(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr from,\n                            unsigned int flags)\n{\n    return virDomainSnapshotObjListGetNames(snapshots, from, NULL, 0, flags);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListNum(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr from,\n                            unsigned int flags)\n{\n    return virDomainSnapshotObjListGetNames(snapshots, from, NULL, 0, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzSnapObjFromSnapshot",
          "args": [
            "snapshots",
            "snapshot"
          ],
          "line": 2299
        },
        "resolved": true,
        "details": {
          "function_name": "vzSnapObjFromSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2146-2151",
          "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2296
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotNumChildrenEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def"
          ],
          "line": 2293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2290
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL",
            "-1"
          ],
          "line": 2287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSnapshotNumChildren(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainMomentObjPtr snap;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_DESCENDANTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return -1;\n\n    if (virDomainSnapshotNumChildrenEnsureACL(snapshot->domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    n = virDomainSnapshotObjListNum(snapshots, snap, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}"
  },
  {
    "function_name": "vzDomainSnapshotGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2242-2277",
    "snippet": "static char *\nvzDomainSnapshotGetXMLDesc(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    char *xml = NULL;\n    virDomainMomentObjPtr snap;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    vzConnPtr privconn = snapshot->domain->conn->privateData;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_XML_SECURE, NULL);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return NULL;\n\n    if (virDomainSnapshotGetXMLDescEnsureACL(snapshot->domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    virUUIDFormat(snapshot->domain->uuid, uuidstr);\n\n    xml = virDomainSnapshotDefFormat(uuidstr, virDomainSnapshotObjGetDef(snap),\n                                     privconn->driver->xmlopt,\n                                     virDomainSnapshotFormatConvertXMLFlags(flags));\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return xml;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2274
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2273
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotDefFormat",
          "args": [
            "uuidstr",
            "virDomainSnapshotObjGetDef(snap)",
            "privconn->driver->xmlopt",
            "virDomainSnapshotFormatConvertXMLFlags(flags)"
          ],
          "line": 2268
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/snapshot_conf.c",
          "lines": "926-942",
          "snippet": "char *\nvirDomainSnapshotDefFormat(const char *uuidstr,\n                           virDomainSnapshotDefPtr def,\n                           virDomainXMLOptionPtr xmlopt,\n                           unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_FORMAT_SECURE |\n                  VIR_DOMAIN_SNAPSHOT_FORMAT_INTERNAL |\n                  VIR_DOMAIN_SNAPSHOT_FORMAT_CURRENT, NULL);\n    if (virDomainSnapshotDefFormatInternal(&buf, uuidstr, def,\n                                           xmlopt, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"snapshot_conf_priv.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"snapshot_conf_priv.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"snapshot_conf.h\"\n#include \"secret_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar *\nvirDomainSnapshotDefFormat(const char *uuidstr,\n                           virDomainSnapshotDefPtr def,\n                           virDomainXMLOptionPtr xmlopt,\n                           unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_FORMAT_SECURE |\n                  VIR_DOMAIN_SNAPSHOT_FORMAT_INTERNAL |\n                  VIR_DOMAIN_SNAPSHOT_FORMAT_CURRENT, NULL);\n    if (virDomainSnapshotDefFormatInternal(&buf, uuidstr, def,\n                                           xmlopt, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotFormatConvertXMLFlags",
          "args": [
            "flags"
          ],
          "line": 2270
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotFormatConvertXMLFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/snapshot_conf.c",
          "lines": "783-792",
          "snippet": "unsigned int\nvirDomainSnapshotFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_SNAPSHOT_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_SNAPSHOT_FORMAT_SECURE;\n\n    return formatFlags;\n}",
          "includes": [
            "#include \"snapshot_conf_priv.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"snapshot_conf_priv.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"snapshot_conf.h\"\n#include \"secret_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainSnapshotFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_SNAPSHOT_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_SNAPSHOT_FORMAT_SECURE;\n\n    return formatFlags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjGetDef",
          "args": [
            "snap"
          ],
          "line": 2268
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.h",
          "lines": "91-95",
          "snippet": "static inline virDomainSnapshotDefPtr\nvirDomainSnapshotObjGetDef(virDomainMomentObjPtr obj)\n{\n    return (virDomainSnapshotDefPtr) obj->def;\n}",
          "includes": [
            "#include \"virbuffer.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "virDomainMomentObjPtr virDomainSnapshotAssignDef(virDomainSnapshotObjListPtr snapshots,\n                                                 virDomainSnapshotDefPtr def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virbuffer.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n\nvirDomainMomentObjPtr virDomainSnapshotAssignDef(virDomainSnapshotObjListPtr snapshots,\n                                                 virDomainSnapshotDefPtr def);\n\nstatic inline virDomainSnapshotDefPtr\nvirDomainSnapshotObjGetDef(virDomainMomentObjPtr obj)\n{\n    return (virDomainSnapshotDefPtr) obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "snapshot->domain->uuid",
            "uuidstr"
          ],
          "line": 2266
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzSnapObjFromSnapshot",
          "args": [
            "snapshots",
            "snapshot"
          ],
          "line": 2263
        },
        "resolved": true,
        "details": {
          "function_name": "vzSnapObjFromSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2146-2151",
          "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2260
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotGetXMLDescEnsureACL",
          "args": [
            "snapshot->domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 2257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "snapshot->domain"
          ],
          "line": 2254
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_XML_SECURE",
            "NULL"
          ],
          "line": 2252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nvzDomainSnapshotGetXMLDesc(virDomainSnapshotPtr snapshot, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    char *xml = NULL;\n    virDomainMomentObjPtr snap;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    vzConnPtr privconn = snapshot->domain->conn->privateData;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_XML_SECURE, NULL);\n\n    if (!(dom = vzDomObjFromDomain(snapshot->domain)))\n        return NULL;\n\n    if (virDomainSnapshotGetXMLDescEnsureACL(snapshot->domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    if (!(snap = vzSnapObjFromSnapshot(snapshots, snapshot)))\n        goto cleanup;\n\n    virUUIDFormat(snapshot->domain->uuid, uuidstr);\n\n    xml = virDomainSnapshotDefFormat(uuidstr, virDomainSnapshotObjGetDef(snap),\n                                     privconn->driver->xmlopt,\n                                     virDomainSnapshotFormatConvertXMLFlags(flags));\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return xml;\n}"
  },
  {
    "function_name": "vzDomainListAllSnapshots",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2212-2240",
    "snippet": "static int\nvzDomainListAllSnapshots(virDomainPtr domain,\n                         virDomainSnapshotPtr **snaps,\n                         unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainListAllSnapshotsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    n = virDomainListSnapshots(snapshots, NULL, domain, snaps, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2237
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2236
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainListSnapshots",
          "args": [
            "snapshots",
            "NULL",
            "domain",
            "snaps",
            "flags"
          ],
          "line": 2233
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainListSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "255-294",
          "snippet": "int\nvirDomainListSnapshots(virDomainSnapshotObjListPtr snapshots,\n                       virDomainMomentObjPtr from,\n                       virDomainPtr dom,\n                       virDomainSnapshotPtr **snaps,\n                       unsigned int flags)\n{\n    int count = virDomainSnapshotObjListNum(snapshots, from, flags);\n    virDomainSnapshotPtr *list = NULL;\n    char **names;\n    int ret = -1;\n    size_t i;\n\n    if (!snaps || count < 0)\n        return count;\n    if (VIR_ALLOC_N(names, count) < 0 ||\n        VIR_ALLOC_N(list, count + 1) < 0)\n        goto cleanup;\n\n    if (virDomainSnapshotObjListGetNames(snapshots, from, names, count,\n                                         flags) < 0)\n        goto cleanup;\n    for (i = 0; i < count; i++)\n        if ((list[i] = virGetDomainSnapshot(dom, names[i])) == NULL)\n            goto cleanup;\n\n    ret = count;\n    *snaps = list;\n\n cleanup:\n    for (i = 0; i < count; i++)\n        VIR_FREE(names[i]);\n    VIR_FREE(names);\n    if (ret < 0 && list) {\n        for (i = 0; i < count; i++)\n            virObjectUnref(list[i]);\n        VIR_FREE(list);\n    }\n    return ret;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainListSnapshots(virDomainSnapshotObjListPtr snapshots,\n                       virDomainMomentObjPtr from,\n                       virDomainPtr dom,\n                       virDomainSnapshotPtr **snaps,\n                       unsigned int flags)\n{\n    int count = virDomainSnapshotObjListNum(snapshots, from, flags);\n    virDomainSnapshotPtr *list = NULL;\n    char **names;\n    int ret = -1;\n    size_t i;\n\n    if (!snaps || count < 0)\n        return count;\n    if (VIR_ALLOC_N(names, count) < 0 ||\n        VIR_ALLOC_N(list, count + 1) < 0)\n        goto cleanup;\n\n    if (virDomainSnapshotObjListGetNames(snapshots, from, names, count,\n                                         flags) < 0)\n        goto cleanup;\n    for (i = 0; i < count; i++)\n        if ((list[i] = virGetDomainSnapshot(dom, names[i])) == NULL)\n            goto cleanup;\n\n    ret = count;\n    *snaps = list;\n\n cleanup:\n    for (i = 0; i < count; i++)\n        VIR_FREE(names[i]);\n    VIR_FREE(names);\n    if (ret < 0 && list) {\n        for (i = 0; i < count; i++)\n            virObjectUnref(list[i]);\n        VIR_FREE(list);\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2230
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainListAllSnapshotsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 2227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2224
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL",
            "-1"
          ],
          "line": 2221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainListAllSnapshots(virDomainPtr domain,\n                         virDomainSnapshotPtr **snaps,\n                         unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainListAllSnapshotsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    n = virDomainListSnapshots(snapshots, NULL, domain, snaps, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}"
  },
  {
    "function_name": "vzDomainSnapshotListNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2181-2210",
    "snippet": "static int\nvzDomainSnapshotListNames(virDomainPtr domain,\n                          char **names,\n                          int nameslen,\n                          unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSnapshotListNamesEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    n = virDomainSnapshotObjListGetNames(snapshots, NULL, names, nameslen, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2207
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2206
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListGetNames",
          "args": [
            "snapshots",
            "NULL",
            "names",
            "nameslen",
            "flags"
          ],
          "line": 2203
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "109-155",
          "snippet": "int\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2200
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotListNamesEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 2197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2194
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL",
            "-1"
          ],
          "line": 2191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSnapshotListNames(virDomainPtr domain,\n                          char **names,\n                          int nameslen,\n                          unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSnapshotListNamesEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    n = virDomainSnapshotObjListGetNames(snapshots, NULL, names, nameslen, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}"
  },
  {
    "function_name": "vzDomainSnapshotNum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2153-2179",
    "snippet": "static int\nvzDomainSnapshotNum(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSnapshotNumEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    n = virDomainSnapshotObjListNum(snapshots, NULL, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2176
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListFree",
          "args": [
            "snapshots"
          ],
          "line": 2175
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "99-106",
          "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListNum",
          "args": [
            "snapshots",
            "NULL",
            "flags"
          ],
          "line": 2172
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListNum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "158-164",
          "snippet": "int\nvirDomainSnapshotObjListNum(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr from,\n                            unsigned int flags)\n{\n    return virDomainSnapshotObjListGetNames(snapshots, from, NULL, 0, flags);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListNum(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr from,\n                            unsigned int flags)\n{\n    return virDomainSnapshotObjListGetNames(snapshots, from, NULL, 0, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkLoadSnapshots",
          "args": [
            "dom"
          ],
          "line": 2169
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadSnapshots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4739-4761",
          "snippet": "virDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nprlsdkLoadSnapshots(virDomainObjPtr dom)\n{\n    virDomainSnapshotObjListPtr ret = NULL;\n    PRL_HANDLE job;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    char *treexml = NULL;\n\n    job = PrlVm_GetSnapshotsTreeEx(privdom->sdkdom, PGST_WITHOUT_SCREENSHOTS);\n    if (PRL_FAILED(getDomainJobResult(job, dom, &result)))\n        goto cleanup;\n\n    if (!(treexml = prlsdkGetStringParamVar(PrlResult_GetParamAsString, result)))\n        goto cleanup;\n\n    ret = prlsdkParseSnapshotTree(treexml);\n cleanup:\n\n    PrlHandle_Free(result);\n    VIR_FREE(treexml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotNumEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 2166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2163
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL",
            "-1"
          ],
          "line": 2160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSnapshotNum(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    int n = -1;\n\n    virCheckFlags(VIR_DOMAIN_SNAPSHOT_LIST_ROOTS |\n                  VIR_DOMAIN_SNAPSHOT_FILTERS_ALL, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSnapshotNumEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        goto cleanup;\n\n    n = virDomainSnapshotObjListNum(snapshots, NULL, flags);\n\n cleanup:\n    virDomainSnapshotObjListFree(snapshots);\n    virDomainObjEndAPI(&dom);\n\n    return n;\n}"
  },
  {
    "function_name": "vzSnapObjFromSnapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2146-2151",
    "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzSnapObjFromName",
          "args": [
            "snapshots",
            "snapshot->name"
          ],
          "line": 2150
        },
        "resolved": true,
        "details": {
          "function_name": "vzSnapObjFromName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "2134-2144",
          "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromName(virDomainSnapshotObjListPtr snapshots, const char *name)\n{\n    virDomainMomentObjPtr snap = NULL;\n    snap = virDomainSnapshotFindByName(snapshots, name);\n    if (!snap)\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT,\n                       _(\"no domain snapshot with matching name '%s'\"), name);\n\n    return snap;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromName(virDomainSnapshotObjListPtr snapshots, const char *name)\n{\n    virDomainMomentObjPtr snap = NULL;\n    snap = virDomainSnapshotFindByName(snapshots, name);\n    if (!snap)\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT,\n                       _(\"no domain snapshot with matching name '%s'\"), name);\n\n    return snap;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromSnapshot(virDomainSnapshotObjListPtr snapshots,\n                      virDomainSnapshotPtr snapshot)\n{\n    return vzSnapObjFromName(snapshots, snapshot->name);\n}"
  },
  {
    "function_name": "vzSnapObjFromName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2134-2144",
    "snippet": "static virDomainMomentObjPtr\nvzSnapObjFromName(virDomainSnapshotObjListPtr snapshots, const char *name)\n{\n    virDomainMomentObjPtr snap = NULL;\n    snap = virDomainSnapshotFindByName(snapshots, name);\n    if (!snap)\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT,\n                       _(\"no domain snapshot with matching name '%s'\"), name);\n\n    return snap;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN_SNAPSHOT",
            "_(\"no domain snapshot with matching name '%s'\")",
            "name"
          ],
          "line": 2140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain snapshot with matching name '%s'\""
          ],
          "line": 2141
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotFindByName",
          "args": [
            "snapshots",
            "name"
          ],
          "line": 2138
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "167-172",
          "snippet": "virDomainMomentObjPtr\nvirDomainSnapshotFindByName(virDomainSnapshotObjListPtr snapshots,\n                            const char *name)\n{\n    return virDomainMomentFindByName(snapshots->base, name);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainSnapshotFindByName(virDomainSnapshotObjListPtr snapshots,\n                            const char *name)\n{\n    return virDomainMomentFindByName(snapshots->base, name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvzSnapObjFromName(virDomainSnapshotObjListPtr snapshots, const char *name)\n{\n    virDomainMomentObjPtr snap = NULL;\n    snap = virDomainSnapshotFindByName(snapshots, name);\n    if (!snap)\n        virReportError(VIR_ERR_NO_DOMAIN_SNAPSHOT,\n                       _(\"no domain snapshot with matching name '%s'\"), name);\n\n    return snap;\n}"
  },
  {
    "function_name": "vzDomainSetMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2105-2132",
    "snippet": "static int vzDomainSetMemory(virDomainPtr domain, unsigned long memory)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSetMemoryEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSetMemsize(dom, memory >> 10);\n\n cleanup:\n\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2130
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 2129
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkSetMemsize",
          "args": [
            "dom",
            "memory >> 10"
          ],
          "line": 2124
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkSetMemsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4559-4577",
          "snippet": "int prlsdkSetMemsize(virDomainObjPtr dom, unsigned int memsize)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    PRL_RESULT pret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    pret = PrlVmCfg_SetRamSize(privdom->sdkdom, memsize);\n    prlsdkCheckRetExit(pret, -1);\n\n    job = PrlVm_CommitEx(privdom->sdkdom, 0);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkSetMemsize(virDomainObjPtr dom, unsigned int memsize)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    PRL_RESULT pret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    pret = PrlVmCfg_SetRamSize(privdom->sdkdom, memsize);\n    prlsdkCheckRetExit(pret, -1);\n\n    job = PrlVm_CommitEx(privdom->sdkdom, 0);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 2121
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 2117
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetMemoryEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 2114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2111
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainSetMemory(virDomainPtr domain, unsigned long memory)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSetMemoryEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSetMemsize(dom, memory >> 10);\n\n cleanup:\n\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSetMemoryFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2069-2103",
    "snippet": "static int vzDomainSetMemoryFlags(virDomainPtr domain, unsigned long memory,\n                                  unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainSetMemoryFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSetMemsize(dom, memory >> 10);\n\n cleanup:\n\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 2101
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 2100
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkSetMemsize",
          "args": [
            "dom",
            "memory >> 10"
          ],
          "line": 2095
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkSetMemsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4559-4577",
          "snippet": "int prlsdkSetMemsize(virDomainObjPtr dom, unsigned int memsize)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    PRL_RESULT pret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    pret = PrlVmCfg_SetRamSize(privdom->sdkdom, memsize);\n    prlsdkCheckRetExit(pret, -1);\n\n    job = PrlVm_CommitEx(privdom->sdkdom, 0);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkSetMemsize(virDomainObjPtr dom, unsigned int memsize)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    PRL_RESULT pret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    pret = PrlVmCfg_SetRamSize(privdom->sdkdom, memsize);\n    prlsdkCheckRetExit(pret, -1);\n\n    job = PrlVm_CommitEx(privdom->sdkdom, 0);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 2088
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetMemoryFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 2085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzCheckConfigUpdateFlags",
          "args": [
            "dom",
            "&flags"
          ],
          "line": 2082
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckConfigUpdateFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1456-1476",
          "snippet": "static int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 2079
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 2076
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainSetMemoryFlags(virDomainPtr domain, unsigned long memory,\n                                  unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainSetMemoryFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkSetMemsize(dom, memory >> 10);\n\n cleanup:\n\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzConnectUnregisterCloseCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2043-2067",
    "snippet": "static int\nvzConnectUnregisterCloseCallback(virConnectPtr conn, virConnectCloseFunc cb)\n{\n    vzConnPtr privconn = conn->privateData;\n    int ret = -1;\n\n    if (virConnectUnregisterCloseCallbackEnsureACL(conn) < 0)\n        return -1;\n\n    virObjectLock(privconn->driver);\n\n    if (virConnectCloseCallbackDataGetCallback(privconn->closeCallback) != cb) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"A different callback was requested\"));\n        goto cleanup;\n    }\n\n    virConnectCloseCallbackDataUnregister(privconn->closeCallback, cb);\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(privconn->driver);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "privconn->driver"
          ],
          "line": 2064
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectCloseCallbackDataUnregister",
          "args": [
            "privconn->closeCallback",
            "cb"
          ],
          "line": 2060
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectCloseCallbackDataUnregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "214-231",
          "snippet": "void virConnectCloseCallbackDataUnregister(virConnectCloseCallbackDataPtr closeData,\n                                           virConnectCloseFunc cb)\n{\n    virObjectLock(closeData);\n\n    if (closeData->callback != cb) {\n        VIR_WARN(\"Attempt to unregister different callback on \"\n                 \" close callback object %p\", closeData);\n        goto cleanup;\n    }\n\n    virConnectCloseCallbackDataReset(closeData);\n    closeData->callback = NULL;\n\n cleanup:\n\n    virObjectUnlock(closeData);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virConnectCloseCallbackDataUnregister(virConnectCloseCallbackDataPtr closeData,\n                                           virConnectCloseFunc cb)\n{\n    virObjectLock(closeData);\n\n    if (closeData->callback != cb) {\n        VIR_WARN(\"Attempt to unregister different callback on \"\n                 \" close callback object %p\", closeData);\n        goto cleanup;\n    }\n\n    virConnectCloseCallbackDataReset(closeData);\n    closeData->callback = NULL;\n\n cleanup:\n\n    virObjectUnlock(closeData);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"A different callback was requested\")"
          ],
          "line": 2055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"A different callback was requested\""
          ],
          "line": 2056
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectCloseCallbackDataGetCallback",
          "args": [
            "privconn->closeCallback"
          ],
          "line": 2054
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectCloseCallbackDataGetCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "251-261",
          "snippet": "virConnectCloseFunc\nvirConnectCloseCallbackDataGetCallback(virConnectCloseCallbackDataPtr closeData)\n{\n    virConnectCloseFunc cb;\n\n    virObjectLock(closeData);\n    cb = closeData->callback;\n    virObjectUnlock(closeData);\n\n    return cb;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirConnectCloseFunc\nvirConnectCloseCallbackDataGetCallback(virConnectCloseCallbackDataPtr closeData)\n{\n    virConnectCloseFunc cb;\n\n    virObjectLock(closeData);\n    cb = closeData->callback;\n    virObjectUnlock(closeData);\n\n    return cb;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "privconn->driver"
          ],
          "line": 2052
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectUnregisterCloseCallbackEnsureACL",
          "args": [
            "conn"
          ],
          "line": 2049
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectUnregisterCloseCallback(virConnectPtr conn, virConnectCloseFunc cb)\n{\n    vzConnPtr privconn = conn->privateData;\n    int ret = -1;\n\n    if (virConnectUnregisterCloseCallbackEnsureACL(conn) < 0)\n        return -1;\n\n    virObjectLock(privconn->driver);\n\n    if (virConnectCloseCallbackDataGetCallback(privconn->closeCallback) != cb) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"A different callback was requested\"));\n        goto cleanup;\n    }\n\n    virConnectCloseCallbackDataUnregister(privconn->closeCallback, cb);\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(privconn->driver);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzConnectRegisterCloseCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2013-2041",
    "snippet": "static int\nvzConnectRegisterCloseCallback(virConnectPtr conn,\n                               virConnectCloseFunc cb,\n                               void *opaque,\n                               virFreeCallback freecb)\n{\n    vzConnPtr privconn = conn->privateData;\n    int ret = -1;\n\n    if (virConnectRegisterCloseCallbackEnsureACL(conn) < 0)\n        return -1;\n\n    virObjectLock(privconn->driver);\n\n    if (virConnectCloseCallbackDataGetCallback(privconn->closeCallback) != NULL) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"A close callback is already registered\"));\n        goto cleanup;\n    }\n\n    virConnectCloseCallbackDataRegister(privconn->closeCallback, conn, cb,\n                                        opaque, freecb);\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(privconn->driver);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "privconn->driver"
          ],
          "line": 2038
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectCloseCallbackDataRegister",
          "args": [
            "privconn->closeCallback",
            "conn",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 2033
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectCloseCallbackDataRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "190-212",
          "snippet": "void virConnectCloseCallbackDataRegister(virConnectCloseCallbackDataPtr closeData,\n                                         virConnectPtr conn,\n                                         virConnectCloseFunc cb,\n                                         void *opaque,\n                                         virFreeCallback freecb)\n{\n    virObjectLock(closeData);\n\n    if (closeData->callback != NULL) {\n        VIR_WARN(\"Attempt to register callback on armed\"\n                 \" close callback object %p\", closeData);\n        goto cleanup;\n    }\n\n    closeData->conn = virObjectRef(conn);\n    closeData->callback = cb;\n    closeData->opaque = opaque;\n    closeData->freeCallback = freecb;\n\n cleanup:\n\n    virObjectUnlock(closeData);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virConnectCloseCallbackDataRegister(virConnectCloseCallbackDataPtr closeData,\n                                         virConnectPtr conn,\n                                         virConnectCloseFunc cb,\n                                         void *opaque,\n                                         virFreeCallback freecb)\n{\n    virObjectLock(closeData);\n\n    if (closeData->callback != NULL) {\n        VIR_WARN(\"Attempt to register callback on armed\"\n                 \" close callback object %p\", closeData);\n        goto cleanup;\n    }\n\n    closeData->conn = virObjectRef(conn);\n    closeData->callback = cb;\n    closeData->opaque = opaque;\n    closeData->freeCallback = freecb;\n\n cleanup:\n\n    virObjectUnlock(closeData);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"A close callback is already registered\")"
          ],
          "line": 2028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"A close callback is already registered\""
          ],
          "line": 2029
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectCloseCallbackDataGetCallback",
          "args": [
            "privconn->closeCallback"
          ],
          "line": 2027
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectCloseCallbackDataGetCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "251-261",
          "snippet": "virConnectCloseFunc\nvirConnectCloseCallbackDataGetCallback(virConnectCloseCallbackDataPtr closeData)\n{\n    virConnectCloseFunc cb;\n\n    virObjectLock(closeData);\n    cb = closeData->callback;\n    virObjectUnlock(closeData);\n\n    return cb;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirConnectCloseFunc\nvirConnectCloseCallbackDataGetCallback(virConnectCloseCallbackDataPtr closeData)\n{\n    virConnectCloseFunc cb;\n\n    virObjectLock(closeData);\n    cb = closeData->callback;\n    virObjectUnlock(closeData);\n\n    return cb;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "privconn->driver"
          ],
          "line": 2025
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectRegisterCloseCallbackEnsureACL",
          "args": [
            "conn"
          ],
          "line": 2022
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectRegisterCloseCallback(virConnectPtr conn,\n                               virConnectCloseFunc cb,\n                               void *opaque,\n                               virFreeCallback freecb)\n{\n    vzConnPtr privconn = conn->privateData;\n    int ret = -1;\n\n    if (virConnectRegisterCloseCallbackEnsureACL(conn) < 0)\n        return -1;\n\n    virObjectLock(privconn->driver);\n\n    if (virConnectCloseCallbackDataGetCallback(privconn->closeCallback) != NULL) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"A close callback is already registered\"));\n        goto cleanup;\n    }\n\n    virConnectCloseCallbackDataRegister(privconn->closeCallback, conn, cb,\n                                        opaque, freecb);\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(privconn->driver);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzNodeGetFreeMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "2000-2011",
    "snippet": "static unsigned long long\nvzNodeGetFreeMemory(virConnectPtr conn)\n{\n    unsigned long long freeMem;\n\n    if (virNodeGetFreeMemoryEnsureACL(conn) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(NULL, &freeMem) < 0)\n        return 0;\n    return freeMem;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetInfo",
          "args": [
            "NULL",
            "&freeMem"
          ],
          "line": 2008
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "790-826",
          "snippet": "int\nvirHostMemGetInfo(unsigned long long *mem,\n                  unsigned long long *freeMem)\n{\n    int max_node;\n    int n;\n\n    if (mem)\n        *mem = 0;\n\n    if (freeMem)\n        *freeMem = 0;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetInfoFake(mem, freeMem);\n\n    if ((max_node = virNumaGetMaxNode()) < 0)\n        return -1;\n\n    for (n = 0; n <= max_node; n++) {\n        unsigned long long tmp_mem = 0, tmp_freeMem = 0;\n\n        if (!virNumaNodeIsAvailable(n))\n            continue;\n\n        if (virNumaGetNodeMemory(n, &tmp_mem, &tmp_freeMem) < 0)\n            return -1;\n\n        if (mem)\n            *mem += tmp_mem;\n\n        if (freeMem)\n            *freeMem += tmp_freeMem;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetInfo(unsigned long long *mem,\n                  unsigned long long *freeMem)\n{\n    int max_node;\n    int n;\n\n    if (mem)\n        *mem = 0;\n\n    if (freeMem)\n        *freeMem = 0;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetInfoFake(mem, freeMem);\n\n    if ((max_node = virNumaGetMaxNode()) < 0)\n        return -1;\n\n    for (n = 0; n <= max_node; n++) {\n        unsigned long long tmp_mem = 0, tmp_freeMem = 0;\n\n        if (!virNumaNodeIsAvailable(n))\n            continue;\n\n        if (virNumaGetNodeMemory(n, &tmp_mem, &tmp_freeMem) < 0)\n            return -1;\n\n        if (mem)\n            *mem += tmp_mem;\n\n        if (freeMem)\n            *freeMem += tmp_freeMem;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetFreeMemoryEnsureACL",
          "args": [
            "conn"
          ],
          "line": 2005
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic unsigned long long\nvzNodeGetFreeMemory(virConnectPtr conn)\n{\n    unsigned long long freeMem;\n\n    if (virNodeGetFreeMemoryEnsureACL(conn) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(NULL, &freeMem) < 0)\n        return 0;\n    return freeMem;\n}"
  },
  {
    "function_name": "vzNodeGetCellsFreeMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1988-1998",
    "snippet": "static int\nvzNodeGetCellsFreeMemory(virConnectPtr conn,\n                         unsigned long long *freeMems,\n                         int startCell,\n                         int maxCells)\n{\n    if (virNodeGetCellsFreeMemoryEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetCellsFree(freeMems, startCell, maxCells);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetCellsFree",
          "args": [
            "freeMems",
            "startCell",
            "maxCells"
          ],
          "line": 1997
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetCellsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "756-788",
          "snippet": "int\nvirHostMemGetCellsFree(unsigned long long *freeMems,\n                       int startCell,\n                       int maxCells)\n{\n    unsigned long long mem;\n    int n, lastCell, numCells;\n    int maxCell;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetCellsFreeFake(freeMems,\n                                          startCell, maxCells);\n\n    if ((maxCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > maxCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, maxCell);\n        return -1;\n    }\n    lastCell = startCell + maxCells - 1;\n    if (lastCell > maxCell)\n        lastCell = maxCell;\n\n    for (numCells = 0, n = startCell; n <= lastCell; n++) {\n        virNumaGetNodeMemory(n, NULL, &mem);\n\n        freeMems[numCells++] = mem;\n    }\n    return numCells;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetCellsFree(unsigned long long *freeMems,\n                       int startCell,\n                       int maxCells)\n{\n    unsigned long long mem;\n    int n, lastCell, numCells;\n    int maxCell;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetCellsFreeFake(freeMems,\n                                          startCell, maxCells);\n\n    if ((maxCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > maxCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, maxCell);\n        return -1;\n    }\n    lastCell = startCell + maxCells - 1;\n    if (lastCell > maxCell)\n        lastCell = maxCell;\n\n    for (numCells = 0, n = startCell; n <= lastCell; n++) {\n        virNumaGetNodeMemory(n, NULL, &mem);\n\n        freeMems[numCells++] = mem;\n    }\n    return numCells;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetCellsFreeMemoryEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1994
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzNodeGetCellsFreeMemory(virConnectPtr conn,\n                         unsigned long long *freeMems,\n                         int startCell,\n                         int maxCells)\n{\n    if (virNodeGetCellsFreeMemoryEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetCellsFree(freeMems, startCell, maxCells);\n}"
  },
  {
    "function_name": "vzNodeGetMemoryStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1975-1986",
    "snippet": "static int\nvzNodeGetMemoryStats(virConnectPtr conn,\n                     int cellNum,\n                     virNodeMemoryStatsPtr params,\n                     int *nparams,\n                     unsigned int flags)\n{\n    if (virNodeGetMemoryStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetStats(cellNum, params, nparams, flags);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetStats",
          "args": [
            "cellNum",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1985
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "244-302",
          "snippet": "int\nvirHostMemGetStats(int cellNum G_GNUC_UNUSED,\n                   virNodeMemoryStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        g_autofree char *meminfo_path = NULL;\n        FILE *meminfo;\n        int max_node;\n\n        /*\n         * Even if built without numactl, libvirt claims\n         * to have a one-cells NUMA topology. In such a\n         * case return the statistics for the entire host.\n         */\n        if (!virNumaIsAvailable() && cellNum == 0)\n            cellNum = VIR_NODE_MEMORY_STATS_ALL_CELLS;\n\n        if (cellNum == VIR_NODE_MEMORY_STATS_ALL_CELLS) {\n            meminfo_path = g_strdup(MEMINFO_PATH);\n        } else {\n            if ((max_node = virNumaGetMaxNode()) < 0)\n                return -1;\n\n            if (cellNum > max_node) {\n                virReportInvalidArg(cellNum,\n                                    _(\"cellNum in %s must be less than or equal to %d\"),\n                                    __FUNCTION__, max_node);\n                return -1;\n            }\n\n            meminfo_path = g_strdup_printf(\n                                           SYSFS_SYSTEM_PATH \"/node/node%d/meminfo\", cellNum);\n        }\n        meminfo = fopen(meminfo_path, \"r\");\n\n        if (!meminfo) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), meminfo_path);\n            return -1;\n        }\n        ret = virHostMemGetStatsLinux(meminfo, cellNum, params, nparams);\n        VIR_FORCE_FCLOSE(meminfo);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostMemGetStatsFreeBSD(params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node memory stats not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetStats(int cellNum G_GNUC_UNUSED,\n                   virNodeMemoryStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        g_autofree char *meminfo_path = NULL;\n        FILE *meminfo;\n        int max_node;\n\n        /*\n         * Even if built without numactl, libvirt claims\n         * to have a one-cells NUMA topology. In such a\n         * case return the statistics for the entire host.\n         */\n        if (!virNumaIsAvailable() && cellNum == 0)\n            cellNum = VIR_NODE_MEMORY_STATS_ALL_CELLS;\n\n        if (cellNum == VIR_NODE_MEMORY_STATS_ALL_CELLS) {\n            meminfo_path = g_strdup(MEMINFO_PATH);\n        } else {\n            if ((max_node = virNumaGetMaxNode()) < 0)\n                return -1;\n\n            if (cellNum > max_node) {\n                virReportInvalidArg(cellNum,\n                                    _(\"cellNum in %s must be less than or equal to %d\"),\n                                    __FUNCTION__, max_node);\n                return -1;\n            }\n\n            meminfo_path = g_strdup_printf(\n                                           SYSFS_SYSTEM_PATH \"/node/node%d/meminfo\", cellNum);\n        }\n        meminfo = fopen(meminfo_path, \"r\");\n\n        if (!meminfo) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), meminfo_path);\n            return -1;\n        }\n        ret = virHostMemGetStatsLinux(meminfo, cellNum, params, nparams);\n        VIR_FORCE_FCLOSE(meminfo);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostMemGetStatsFreeBSD(params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node memory stats not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetMemoryStatsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1982
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzNodeGetMemoryStats(virConnectPtr conn,\n                     int cellNum,\n                     virNodeMemoryStatsPtr params,\n                     int *nparams,\n                     unsigned int flags)\n{\n    if (virNodeGetMemoryStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetStats(cellNum, params, nparams, flags);\n}"
  },
  {
    "function_name": "vzNodeGetCPUStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1962-1973",
    "snippet": "static int\nvzNodeGetCPUStats(virConnectPtr conn,\n                  int cpuNum,\n                  virNodeCPUStatsPtr params,\n                  int *nparams,\n                  unsigned int flags)\n{\n    if (virNodeGetCPUStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetStats(cpuNum, params, nparams, flags);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostCPUGetStats",
          "args": [
            "cpuNum",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1972
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "998-1027",
          "snippet": "int\nvirHostCPUGetStats(int cpuNum G_GNUC_UNUSED,\n                   virNodeCPUStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        FILE *procstat = fopen(PROCSTAT_PATH, \"r\");\n        if (!procstat) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), PROCSTAT_PATH);\n            return -1;\n        }\n        ret = virHostCPUGetStatsLinux(procstat, cpuNum, params, nparams);\n        VIR_FORCE_FCLOSE(procstat);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostCPUGetStatsFreeBSD(cpuNum, params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node CPU stats not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetStats(int cpuNum G_GNUC_UNUSED,\n                   virNodeCPUStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        FILE *procstat = fopen(PROCSTAT_PATH, \"r\");\n        if (!procstat) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), PROCSTAT_PATH);\n            return -1;\n        }\n        ret = virHostCPUGetStatsLinux(procstat, cpuNum, params, nparams);\n        VIR_FORCE_FCLOSE(procstat);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostCPUGetStatsFreeBSD(cpuNum, params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node CPU stats not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetCPUStatsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1969
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzNodeGetCPUStats(virConnectPtr conn,\n                  int cpuNum,\n                  virNodeCPUStatsPtr params,\n                  int *nparams,\n                  unsigned int flags)\n{\n    if (virNodeGetCPUStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetStats(cpuNum, params, nparams, flags);\n}"
  },
  {
    "function_name": "vzConnectGetMaxVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1946-1960",
    "snippet": "static int vzConnectGetMaxVcpus(virConnectPtr conn,\n                                const char *type)\n{\n    if (virConnectGetMaxVcpusEnsureACL(conn) < 0)\n        return -1;\n\n    /* As far as we have no limitation for containers\n     * we report maximum */\n    if (type == NULL || STRCASEEQ(type, \"vz\") || STRCASEEQ(type, \"parallels\"))\n        return 1028;\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unknown type '%s'\"), type);\n    return -1;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown type '%s'\")",
            "type"
          ],
          "line": 1957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown type '%s'\""
          ],
          "line": 1958
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "type",
            "\"parallels\""
          ],
          "line": 1954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "type",
            "\"vz\""
          ],
          "line": 1954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectGetMaxVcpusEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1949
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzConnectGetMaxVcpus(virConnectPtr conn,\n                                const char *type)\n{\n    if (virConnectGetMaxVcpusEnsureACL(conn) < 0)\n        return -1;\n\n    /* As far as we have no limitation for containers\n     * we report maximum */\n    if (type == NULL || STRCASEEQ(type, \"vz\") || STRCASEEQ(type, \"parallels\"))\n        return 1028;\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unknown type '%s'\"), type);\n    return -1;\n}"
  },
  {
    "function_name": "vzDomainIsUpdated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1926-1944",
    "snippet": "static int vzDomainIsUpdated(virDomainPtr domain)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    /* As far as VZ domains are always updated (e.g. current==persistent),\n     * we just check for domain existence */\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainIsUpdatedEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1942
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainIsUpdatedEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1933
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainIsUpdated(virDomainPtr domain)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    /* As far as VZ domains are always updated (e.g. current==persistent),\n     * we just check for domain existence */\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainIsUpdatedEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainGetMaxVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1920-1924",
    "snippet": "static int vzDomainGetMaxVcpus(virDomainPtr domain)\n{\n    return vzDomainGetVcpusFlags(domain, (VIR_DOMAIN_AFFECT_LIVE |\n                                          VIR_DOMAIN_VCPU_MAXIMUM));\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainGetVcpusFlags",
          "args": [
            "domain",
            "(VIR_DOMAIN_AFFECT_LIVE |\n                                          VIR_DOMAIN_VCPU_MAXIMUM)"
          ],
          "line": 1922
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainGetVcpusFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1892-1918",
          "snippet": "static int\nvzDomainGetVcpusFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_VCPU_MAXIMUM, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetVcpusFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (flags & VIR_DOMAIN_VCPU_MAXIMUM)\n        ret = virDomainDefGetVcpusMax(dom->def);\n    else\n        ret = virDomainDefGetVcpus(dom->def);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetVcpusFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_VCPU_MAXIMUM, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetVcpusFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (flags & VIR_DOMAIN_VCPU_MAXIMUM)\n        ret = virDomainDefGetVcpusMax(dom->def);\n    else\n        ret = virDomainDefGetVcpus(dom->def);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainGetMaxVcpus(virDomainPtr domain)\n{\n    return vzDomainGetVcpusFlags(domain, (VIR_DOMAIN_AFFECT_LIVE |\n                                          VIR_DOMAIN_VCPU_MAXIMUM));\n}"
  },
  {
    "function_name": "vzDomainGetVcpusFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1892-1918",
    "snippet": "static int\nvzDomainGetVcpusFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_VCPU_MAXIMUM, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetVcpusFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (flags & VIR_DOMAIN_VCPU_MAXIMUM)\n        ret = virDomainDefGetVcpusMax(dom->def);\n    else\n        ret = virDomainDefGetVcpus(dom->def);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1915
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpus",
          "args": [
            "dom->def"
          ],
          "line": 1912
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1912-1924",
          "snippet": "unsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpusMax",
          "args": [
            "dom->def"
          ],
          "line": 1910
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpusMax",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1882-1886",
          "snippet": "unsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpusMax(const virDomainDef *def)\n{\n    return def->maxvcpus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetVcpusFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 1906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1903
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_VCPU_MAXIMUM",
            "-1"
          ],
          "line": 1899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetVcpusFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_VCPU_MAXIMUM, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetVcpusFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (flags & VIR_DOMAIN_VCPU_MAXIMUM)\n        ret = virDomainDefGetVcpusMax(dom->def);\n    else\n        ret = virDomainDefGetVcpus(dom->def);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainMemoryStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1865-1890",
    "snippet": "static int\nvzDomainMemoryStats(virDomainPtr domain,\n                    virDomainMemoryStatPtr stats,\n                    unsigned int nr_stats,\n                    unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    vzDomObjPtr privdom;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainMemoryStatsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    privdom = dom->privateData;\n\n    ret = prlsdkGetMemoryStats(privdom->stats, stats, nr_stats);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1887
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkGetMemoryStats",
          "args": [
            "privdom->stats",
            "stats",
            "nr_stats"
          ],
          "line": 1884
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetMemoryStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4501-4556",
          "snippet": "int\nprlsdkGetMemoryStats(PRL_HANDLE sdkstats,\n                     virDomainMemoryStatPtr stats,\n                     unsigned int nr_stats)\n{\n    long long v = 0, t = 0, u = 0;\n    size_t i = 0;\n\n#define PRLSDK_GET_COUNTER(NAME, VALUE) \\\n    if (prlsdkExtractStatsParam(sdkstats, NAME, &VALUE) < 0) \\\n        return -1; \\\n\n#define PRLSDK_MEMORY_STAT_SET(TAG, VALUE) \\\n    if (i < nr_stats) { \\\n        stats[i].tag = (TAG); \\\n        stats[i].val = (VALUE); \\\n        i++; \\\n    }\n\n    i = 0;\n\n    // count to kb\n    PRLSDK_GET_COUNTER(\"guest.ram.swap_in\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_SWAP_IN, v << 12)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.swap_out\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_SWAP_OUT, v << 12)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.minor_fault\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_MINOR_FAULT, v)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.major_fault\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_MAJOR_FAULT, v)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.total\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_AVAILABLE, v << 10)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.balloon_actual\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_ACTUAL_BALLOON, v << 10)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.usage\", u)\n    PRLSDK_GET_COUNTER(\"guest.ram.total\", t)\n    if (u != -1 && t != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_UNUSED, (t - u) << 10)\n\n#undef PRLSDK_GET_COUNTER\n#undef PRLSDK_MEMORY_STAT_SET\n\n    return i;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkGetMemoryStats(PRL_HANDLE sdkstats,\n                     virDomainMemoryStatPtr stats,\n                     unsigned int nr_stats)\n{\n    long long v = 0, t = 0, u = 0;\n    size_t i = 0;\n\n#define PRLSDK_GET_COUNTER(NAME, VALUE) \\\n    if (prlsdkExtractStatsParam(sdkstats, NAME, &VALUE) < 0) \\\n        return -1; \\\n\n#define PRLSDK_MEMORY_STAT_SET(TAG, VALUE) \\\n    if (i < nr_stats) { \\\n        stats[i].tag = (TAG); \\\n        stats[i].val = (VALUE); \\\n        i++; \\\n    }\n\n    i = 0;\n\n    // count to kb\n    PRLSDK_GET_COUNTER(\"guest.ram.swap_in\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_SWAP_IN, v << 12)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.swap_out\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_SWAP_OUT, v << 12)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.minor_fault\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_MINOR_FAULT, v)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.major_fault\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_MAJOR_FAULT, v)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.total\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_AVAILABLE, v << 10)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.balloon_actual\", v)\n    if (v != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_ACTUAL_BALLOON, v << 10)\n\n    PRLSDK_GET_COUNTER(\"guest.ram.usage\", u)\n    PRLSDK_GET_COUNTER(\"guest.ram.total\", t)\n    if (u != -1 && t != -1)\n        PRLSDK_MEMORY_STAT_SET(VIR_DOMAIN_MEMORY_STAT_UNUSED, (t - u) << 10)\n\n#undef PRLSDK_GET_COUNTER\n#undef PRLSDK_MEMORY_STAT_SET\n\n    return i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMemoryStatsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1876
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainMemoryStats(virDomainPtr domain,\n                    virDomainMemoryStatPtr stats,\n                    unsigned int nr_stats,\n                    unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    vzDomObjPtr privdom;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainMemoryStatsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    privdom = dom->privateData;\n\n    ret = prlsdkGetMemoryStats(privdom->stats, stats, nr_stats);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainInterfaceStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1840-1863",
    "snippet": "static int\nvzDomainInterfaceStats(virDomainPtr domain,\n                         const char *device,\n                         virDomainInterfaceStatsPtr stats)\n{\n    virDomainObjPtr dom = NULL;\n    vzDomObjPtr privdom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainInterfaceStatsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    privdom = dom->privateData;\n\n    ret = prlsdkGetNetStats(privdom->stats, privdom->sdkdom, device, stats);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1860
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkGetNetStats",
          "args": [
            "privdom->stats",
            "privdom->sdkdom",
            "device",
            "stats"
          ],
          "line": 1857
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetNetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4436-4481",
          "snippet": "int\nprlsdkGetNetStats(PRL_HANDLE sdkstats, PRL_HANDLE sdkdom, const char *device,\n                  virDomainInterfaceStatsPtr stats)\n{\n    int ret = -1;\n    PRL_UINT32 net_index = -1;\n    char *name = NULL;\n    PRL_RESULT pret;\n    PRL_HANDLE net = PRL_INVALID_HANDLE;\n    virMacAddr mac;\n\n    if (virMacAddrParse(device, &mac) == 0)\n        net = prlsdkFindNetByMAC(sdkdom, &mac);\n    else\n        net = prlsdkFindNetByPath(sdkdom, device);\n\n    if (net == PRL_INVALID_HANDLE)\n       goto cleanup;\n\n    pret = PrlVmDev_GetIndex(net, &net_index);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n#define PRLSDK_GET_NET_COUNTER(VAL, NAME) \\\n    name = g_strdup_printf(\"net.nic%u.%s\", net_index, NAME); \\\n    if (prlsdkExtractStatsParam(sdkstats, name, &stats->VAL) < 0) \\\n        goto cleanup; \\\n    VIR_FREE(name);\n\n    PRLSDK_GET_NET_COUNTER(rx_bytes, \"bytes_in\")\n    PRLSDK_GET_NET_COUNTER(rx_packets, \"pkts_in\")\n    PRLSDK_GET_NET_COUNTER(tx_bytes, \"bytes_out\")\n    PRLSDK_GET_NET_COUNTER(tx_packets, \"pkts_out\")\n    stats->rx_errs = -1;\n    stats->rx_drop = -1;\n    stats->tx_errs = -1;\n    stats->tx_drop = -1;\n\n#undef PRLSDK_GET_NET_COUNTER\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    PrlHandle_Free(net);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);",
            "static PRL_HANDLE\nprlsdkFindNetByMAC(PRL_HANDLE sdkdom, virMacAddrPtr mac);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\nstatic PRL_HANDLE\nprlsdkFindNetByMAC(PRL_HANDLE sdkdom, virMacAddrPtr mac);\n\nint\nprlsdkGetNetStats(PRL_HANDLE sdkstats, PRL_HANDLE sdkdom, const char *device,\n                  virDomainInterfaceStatsPtr stats)\n{\n    int ret = -1;\n    PRL_UINT32 net_index = -1;\n    char *name = NULL;\n    PRL_RESULT pret;\n    PRL_HANDLE net = PRL_INVALID_HANDLE;\n    virMacAddr mac;\n\n    if (virMacAddrParse(device, &mac) == 0)\n        net = prlsdkFindNetByMAC(sdkdom, &mac);\n    else\n        net = prlsdkFindNetByPath(sdkdom, device);\n\n    if (net == PRL_INVALID_HANDLE)\n       goto cleanup;\n\n    pret = PrlVmDev_GetIndex(net, &net_index);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n#define PRLSDK_GET_NET_COUNTER(VAL, NAME) \\\n    name = g_strdup_printf(\"net.nic%u.%s\", net_index, NAME); \\\n    if (prlsdkExtractStatsParam(sdkstats, name, &stats->VAL) < 0) \\\n        goto cleanup; \\\n    VIR_FREE(name);\n\n    PRLSDK_GET_NET_COUNTER(rx_bytes, \"bytes_in\")\n    PRLSDK_GET_NET_COUNTER(rx_packets, \"pkts_in\")\n    PRLSDK_GET_NET_COUNTER(tx_bytes, \"bytes_out\")\n    PRLSDK_GET_NET_COUNTER(tx_packets, \"pkts_out\")\n    stats->rx_errs = -1;\n    stats->rx_drop = -1;\n    stats->tx_errs = -1;\n    stats->tx_drop = -1;\n\n#undef PRLSDK_GET_NET_COUNTER\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    PrlHandle_Free(net);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainInterfaceStatsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1849
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainInterfaceStats(virDomainPtr domain,\n                         const char *device,\n                         virDomainInterfaceStatsPtr stats)\n{\n    virDomainObjPtr dom = NULL;\n    vzDomObjPtr privdom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainInterfaceStatsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    privdom = dom->privateData;\n\n    ret = prlsdkGetNetStats(privdom->stats, privdom->sdkdom, device, stats);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainBlockStatsFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1805-1838",
    "snippet": "static int\nvzDomainBlockStatsFlags(virDomainPtr domain,\n                        const char *path,\n                        virTypedParameterPtr params,\n                        int *nparams,\n                        unsigned int flags)\n{\n    virDomainBlockStatsStruct stats;\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainBlockStatsFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainBlockStatsImpl(dom, path, &stats) < 0)\n        goto cleanup;\n\n    if (vzDomainBlockStatsToParams(&stats, params, nparams) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1835
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainBlockStatsToParams",
          "args": [
            "&stats",
            "params",
            "nparams"
          ],
          "line": 1829
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainBlockStatsToParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1770-1803",
          "snippet": "static int\nvzDomainBlockStatsToParams(virDomainBlockStatsPtr stats,\n                           virTypedParameterPtr params,\n                           int *nparams)\n{\n    size_t i;\n\n    if (*nparams == 0) {\n#define PARALLELS_COUNT_STATS(VAR, TYPE, NAME) \\\n        if ((stats->VAR) != -1) \\\n            ++*nparams;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_COUNT_STATS)\n\n#undef PARALLELS_COUNT_STATS\n        return 0;\n    }\n\n    i = 0;\n#define PARALLELS_BLOCK_STATS_ASSIGN_PARAM(VAR, TYPE, NAME) \\\n    if (i < *nparams && (stats->VAR) != -1) { \\\n        if (virTypedParameterAssign(params + i, TYPE, \\\n                                    VIR_TYPED_PARAM_LLONG, (stats->VAR)) < 0) \\\n            return -1; \\\n        i++; \\\n    }\n\n    PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_BLOCK_STATS_ASSIGN_PARAM)\n\n#undef PARALLELS_BLOCK_STATS_ASSIGN_PARAM\n\n    *nparams = i;\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainBlockStatsToParams(virDomainBlockStatsPtr stats,\n                           virTypedParameterPtr params,\n                           int *nparams)\n{\n    size_t i;\n\n    if (*nparams == 0) {\n#define PARALLELS_COUNT_STATS(VAR, TYPE, NAME) \\\n        if ((stats->VAR) != -1) \\\n            ++*nparams;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_COUNT_STATS)\n\n#undef PARALLELS_COUNT_STATS\n        return 0;\n    }\n\n    i = 0;\n#define PARALLELS_BLOCK_STATS_ASSIGN_PARAM(VAR, TYPE, NAME) \\\n    if (i < *nparams && (stats->VAR) != -1) { \\\n        if (virTypedParameterAssign(params + i, TYPE, \\\n                                    VIR_TYPED_PARAM_LLONG, (stats->VAR)) < 0) \\\n            return -1; \\\n        i++; \\\n    }\n\n    PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_BLOCK_STATS_ASSIGN_PARAM)\n\n#undef PARALLELS_BLOCK_STATS_ASSIGN_PARAM\n\n    *nparams = i;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainBlockStatsImpl",
          "args": [
            "dom",
            "path",
            "&stats"
          ],
          "line": 1826
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainBlockStatsImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1696-1743",
          "snippet": "static int\nvzDomainBlockStatsImpl(virDomainObjPtr dom,\n                       const char *path,\n                       virDomainBlockStatsPtr stats)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    int idx;\n\n    if (*path) {\n        if ((idx = virDomainDiskIndexByName(dom->def, path, false)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, _(\"invalid path: %s\"), path);\n            return -1;\n        }\n        if (prlsdkGetBlockStats(privdom->stats,\n                                dom->def->disks[idx],\n                                stats,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n    } else {\n        virDomainBlockStatsStruct s;\n\n#define PARALLELS_ZERO_STATS(VAR, TYPE, NAME) \\\n        stats->VAR = 0;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_ZERO_STATS)\n\n#undef PARALLELS_ZERO_STATS\n\n        for (i = 0; i < dom->def->ndisks; i++) {\n            if (prlsdkGetBlockStats(privdom->stats,\n                                    dom->def->disks[i],\n                                    &s,\n                                    IS_CT(dom->def)) < 0)\n                return -1;\n\n#define PARALLELS_SUM_STATS(VAR, TYPE, NAME) \\\n    if (s.VAR != -1) \\\n        stats->VAR += s.VAR;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_SUM_STATS)\n\n#undef PARALLELS_SUM_STATS\n        }\n    }\n    stats->errs = -1;\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainBlockStatsImpl(virDomainObjPtr dom,\n                       const char *path,\n                       virDomainBlockStatsPtr stats)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    int idx;\n\n    if (*path) {\n        if ((idx = virDomainDiskIndexByName(dom->def, path, false)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, _(\"invalid path: %s\"), path);\n            return -1;\n        }\n        if (prlsdkGetBlockStats(privdom->stats,\n                                dom->def->disks[idx],\n                                stats,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n    } else {\n        virDomainBlockStatsStruct s;\n\n#define PARALLELS_ZERO_STATS(VAR, TYPE, NAME) \\\n        stats->VAR = 0;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_ZERO_STATS)\n\n#undef PARALLELS_ZERO_STATS\n\n        for (i = 0; i < dom->def->ndisks; i++) {\n            if (prlsdkGetBlockStats(privdom->stats,\n                                    dom->def->disks[i],\n                                    &s,\n                                    IS_CT(dom->def)) < 0)\n                return -1;\n\n#define PARALLELS_SUM_STATS(VAR, TYPE, NAME) \\\n    if (s.VAR != -1) \\\n        stats->VAR += s.VAR;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_SUM_STATS)\n\n#undef PARALLELS_SUM_STATS\n        }\n    }\n    stats->errs = -1;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainBlockStatsFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1820
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_TYPED_PARAM_STRING_OKAY",
            "-1"
          ],
          "line": 1816
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainBlockStatsFlags(virDomainPtr domain,\n                        const char *path,\n                        virTypedParameterPtr params,\n                        int *nparams,\n                        unsigned int flags)\n{\n    virDomainBlockStatsStruct stats;\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainBlockStatsFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainBlockStatsImpl(dom, path, &stats) < 0)\n        goto cleanup;\n\n    if (vzDomainBlockStatsToParams(&stats, params, nparams) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainBlockStatsToParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1770-1803",
    "snippet": "static int\nvzDomainBlockStatsToParams(virDomainBlockStatsPtr stats,\n                           virTypedParameterPtr params,\n                           int *nparams)\n{\n    size_t i;\n\n    if (*nparams == 0) {\n#define PARALLELS_COUNT_STATS(VAR, TYPE, NAME) \\\n        if ((stats->VAR) != -1) \\\n            ++*nparams;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_COUNT_STATS)\n\n#undef PARALLELS_COUNT_STATS\n        return 0;\n    }\n\n    i = 0;\n#define PARALLELS_BLOCK_STATS_ASSIGN_PARAM(VAR, TYPE, NAME) \\\n    if (i < *nparams && (stats->VAR) != -1) { \\\n        if (virTypedParameterAssign(params + i, TYPE, \\\n                                    VIR_TYPED_PARAM_LLONG, (stats->VAR)) < 0) \\\n            return -1; \\\n        i++; \\\n    }\n\n    PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_BLOCK_STATS_ASSIGN_PARAM)\n\n#undef PARALLELS_BLOCK_STATS_ASSIGN_PARAM\n\n    *nparams = i;\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainBlockStatsToParams(virDomainBlockStatsPtr stats,\n                           virTypedParameterPtr params,\n                           int *nparams)\n{\n    size_t i;\n\n    if (*nparams == 0) {\n#define PARALLELS_COUNT_STATS(VAR, TYPE, NAME) \\\n        if ((stats->VAR) != -1) \\\n            ++*nparams;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_COUNT_STATS)\n\n#undef PARALLELS_COUNT_STATS\n        return 0;\n    }\n\n    i = 0;\n#define PARALLELS_BLOCK_STATS_ASSIGN_PARAM(VAR, TYPE, NAME) \\\n    if (i < *nparams && (stats->VAR) != -1) { \\\n        if (virTypedParameterAssign(params + i, TYPE, \\\n                                    VIR_TYPED_PARAM_LLONG, (stats->VAR)) < 0) \\\n            return -1; \\\n        i++; \\\n    }\n\n    PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_BLOCK_STATS_ASSIGN_PARAM)\n\n#undef PARALLELS_BLOCK_STATS_ASSIGN_PARAM\n\n    *nparams = i;\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainBlockStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1745-1768",
    "snippet": "static int\nvzDomainBlockStats(virDomainPtr domain,\n                   const char *path,\n                   virDomainBlockStatsPtr stats)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainBlockStatsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainBlockStatsImpl(dom, path, stats) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1765
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainBlockStatsImpl",
          "args": [
            "dom",
            "path",
            "stats"
          ],
          "line": 1759
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainBlockStatsImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1696-1743",
          "snippet": "static int\nvzDomainBlockStatsImpl(virDomainObjPtr dom,\n                       const char *path,\n                       virDomainBlockStatsPtr stats)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    int idx;\n\n    if (*path) {\n        if ((idx = virDomainDiskIndexByName(dom->def, path, false)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, _(\"invalid path: %s\"), path);\n            return -1;\n        }\n        if (prlsdkGetBlockStats(privdom->stats,\n                                dom->def->disks[idx],\n                                stats,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n    } else {\n        virDomainBlockStatsStruct s;\n\n#define PARALLELS_ZERO_STATS(VAR, TYPE, NAME) \\\n        stats->VAR = 0;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_ZERO_STATS)\n\n#undef PARALLELS_ZERO_STATS\n\n        for (i = 0; i < dom->def->ndisks; i++) {\n            if (prlsdkGetBlockStats(privdom->stats,\n                                    dom->def->disks[i],\n                                    &s,\n                                    IS_CT(dom->def)) < 0)\n                return -1;\n\n#define PARALLELS_SUM_STATS(VAR, TYPE, NAME) \\\n    if (s.VAR != -1) \\\n        stats->VAR += s.VAR;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_SUM_STATS)\n\n#undef PARALLELS_SUM_STATS\n        }\n    }\n    stats->errs = -1;\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainBlockStatsImpl(virDomainObjPtr dom,\n                       const char *path,\n                       virDomainBlockStatsPtr stats)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    int idx;\n\n    if (*path) {\n        if ((idx = virDomainDiskIndexByName(dom->def, path, false)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, _(\"invalid path: %s\"), path);\n            return -1;\n        }\n        if (prlsdkGetBlockStats(privdom->stats,\n                                dom->def->disks[idx],\n                                stats,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n    } else {\n        virDomainBlockStatsStruct s;\n\n#define PARALLELS_ZERO_STATS(VAR, TYPE, NAME) \\\n        stats->VAR = 0;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_ZERO_STATS)\n\n#undef PARALLELS_ZERO_STATS\n\n        for (i = 0; i < dom->def->ndisks; i++) {\n            if (prlsdkGetBlockStats(privdom->stats,\n                                    dom->def->disks[i],\n                                    &s,\n                                    IS_CT(dom->def)) < 0)\n                return -1;\n\n#define PARALLELS_SUM_STATS(VAR, TYPE, NAME) \\\n    if (s.VAR != -1) \\\n        stats->VAR += s.VAR;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_SUM_STATS)\n\n#undef PARALLELS_SUM_STATS\n        }\n    }\n    stats->errs = -1;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainBlockStatsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1753
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainBlockStats(virDomainPtr domain,\n                   const char *path,\n                   virDomainBlockStatsPtr stats)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainBlockStatsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainBlockStatsImpl(dom, path, stats) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainBlockStatsImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1696-1743",
    "snippet": "static int\nvzDomainBlockStatsImpl(virDomainObjPtr dom,\n                       const char *path,\n                       virDomainBlockStatsPtr stats)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    int idx;\n\n    if (*path) {\n        if ((idx = virDomainDiskIndexByName(dom->def, path, false)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, _(\"invalid path: %s\"), path);\n            return -1;\n        }\n        if (prlsdkGetBlockStats(privdom->stats,\n                                dom->def->disks[idx],\n                                stats,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n    } else {\n        virDomainBlockStatsStruct s;\n\n#define PARALLELS_ZERO_STATS(VAR, TYPE, NAME) \\\n        stats->VAR = 0;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_ZERO_STATS)\n\n#undef PARALLELS_ZERO_STATS\n\n        for (i = 0; i < dom->def->ndisks; i++) {\n            if (prlsdkGetBlockStats(privdom->stats,\n                                    dom->def->disks[i],\n                                    &s,\n                                    IS_CT(dom->def)) < 0)\n                return -1;\n\n#define PARALLELS_SUM_STATS(VAR, TYPE, NAME) \\\n    if (s.VAR != -1) \\\n        stats->VAR += s.VAR;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_SUM_STATS)\n\n#undef PARALLELS_SUM_STATS\n        }\n    }\n    stats->errs = -1;\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prlsdkGetBlockStats",
          "args": [
            "privdom->stats",
            "dom->def->disks[i]",
            "&s",
            "IS_CT(dom->def)"
          ],
          "line": 1726
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetBlockStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4339-4394",
          "snippet": "int\nprlsdkGetBlockStats(PRL_HANDLE sdkstats,\n                    virDomainDiskDefPtr disk,\n                    virDomainBlockStatsPtr stats,\n                    bool isCt)\n{\n    virDomainDeviceDriveAddressPtr address;\n    int idx;\n    const char *prefix;\n    int ret = -1;\n    char *name = NULL;\n\n    address = &disk->info.addr.drive;\n\n    if (isCt) {\n        prefix = \"hdd\";\n        idx = address->unit;\n    } else {\n        switch (disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_IDE:\n            prefix = \"ide\";\n            idx = address->bus * 2 + address->unit;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SATA:\n            prefix = \"sata\";\n            idx = address->unit;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            prefix = \"scsi\";\n            idx = address->unit;\n            break;\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unknown disk bus: %X\"), disk->bus);\n            goto cleanup;\n        }\n    }\n\n\n#define PRLSDK_GET_STAT_PARAM(VAL, TYPE, NAME) \\\n    name = g_strdup_printf(\"devices.%s%d.%s\", prefix, idx, NAME); \\\n    if (prlsdkExtractStatsParam(sdkstats, name, &stats->VAL) < 0) \\\n        goto cleanup; \\\n    VIR_FREE(name);\n\n    PARALLELS_BLOCK_STATS_FOREACH(PRLSDK_GET_STAT_PARAM)\n\n#undef PRLSDK_GET_STAT_PARAM\n\n    ret = 0;\n\n cleanup:\n\n    VIR_FREE(name);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);\n\nint\nprlsdkGetBlockStats(PRL_HANDLE sdkstats,\n                    virDomainDiskDefPtr disk,\n                    virDomainBlockStatsPtr stats,\n                    bool isCt)\n{\n    virDomainDeviceDriveAddressPtr address;\n    int idx;\n    const char *prefix;\n    int ret = -1;\n    char *name = NULL;\n\n    address = &disk->info.addr.drive;\n\n    if (isCt) {\n        prefix = \"hdd\";\n        idx = address->unit;\n    } else {\n        switch (disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_IDE:\n            prefix = \"ide\";\n            idx = address->bus * 2 + address->unit;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SATA:\n            prefix = \"sata\";\n            idx = address->unit;\n            break;\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            prefix = \"scsi\";\n            idx = address->unit;\n            break;\n        default:\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unknown disk bus: %X\"), disk->bus);\n            goto cleanup;\n        }\n    }\n\n\n#define PRLSDK_GET_STAT_PARAM(VAL, TYPE, NAME) \\\n    name = g_strdup_printf(\"devices.%s%d.%s\", prefix, idx, NAME); \\\n    if (prlsdkExtractStatsParam(sdkstats, name, &stats->VAL) < 0) \\\n        goto cleanup; \\\n    VIR_FREE(name);\n\n    PARALLELS_BLOCK_STATS_FOREACH(PRLSDK_GET_STAT_PARAM)\n\n#undef PRLSDK_GET_STAT_PARAM\n\n    ret = 0;\n\n cleanup:\n\n    VIR_FREE(name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_CT",
          "args": [
            "dom->def"
          ],
          "line": 1729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_CT",
          "args": [
            "dom->def"
          ],
          "line": 1713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid path: %s\")",
            "path"
          ],
          "line": 1707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"invalid path: %s\""
          ],
          "line": 1707
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskIndexByName",
          "args": [
            "dom->def",
            "path",
            "false"
          ],
          "line": 1706
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskIndexByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17299-17325",
          "snippet": "int\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainBlockStatsImpl(virDomainObjPtr dom,\n                       const char *path,\n                       virDomainBlockStatsPtr stats)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    size_t i;\n    int idx;\n\n    if (*path) {\n        if ((idx = virDomainDiskIndexByName(dom->def, path, false)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, _(\"invalid path: %s\"), path);\n            return -1;\n        }\n        if (prlsdkGetBlockStats(privdom->stats,\n                                dom->def->disks[idx],\n                                stats,\n                                IS_CT(dom->def)) < 0)\n            return -1;\n    } else {\n        virDomainBlockStatsStruct s;\n\n#define PARALLELS_ZERO_STATS(VAR, TYPE, NAME) \\\n        stats->VAR = 0;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_ZERO_STATS)\n\n#undef PARALLELS_ZERO_STATS\n\n        for (i = 0; i < dom->def->ndisks; i++) {\n            if (prlsdkGetBlockStats(privdom->stats,\n                                    dom->def->disks[i],\n                                    &s,\n                                    IS_CT(dom->def)) < 0)\n                return -1;\n\n#define PARALLELS_SUM_STATS(VAR, TYPE, NAME) \\\n    if (s.VAR != -1) \\\n        stats->VAR += s.VAR;\n\n        PARALLELS_BLOCK_STATS_FOREACH(PARALLELS_SUM_STATS)\n\n#undef PARALLELS_SUM_STATS\n        }\n    }\n    stats->errs = -1;\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainGetMaxMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1677-1694",
    "snippet": "static unsigned long long\nvzDomainGetMaxMemory(virDomainPtr domain)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetMaxMemoryEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virDomainDefGetMemoryTotal(dom->def);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1692
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "dom->def"
          ],
          "line": 1689
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetMaxMemoryEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1683
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic unsigned long long\nvzDomainGetMaxMemory(virDomainPtr domain)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetMaxMemoryEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virDomainDefGetMemoryTotal(dom->def);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainUpdateDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1625-1674",
    "snippet": "static int vzDomainUpdateDeviceFlags(virDomainPtr domain,\n                                     const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom = NULL;\n    virDomainDeviceDefPtr dev = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainUpdateDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (!(dev = virDomainDeviceDefParse(xml, dom->def,\n                                        driver->xmlopt, NULL,\n                                        VIR_DOMAIN_XML_INACTIVE)))\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1672
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1671
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefFree",
          "args": [
            "dev"
          ],
          "line": 1669
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3062-3146",
          "snippet": "void virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "driver",
            "dom"
          ],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDevice",
          "args": [
            "driver",
            "dom",
            "dev"
          ],
          "line": 1660
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "3697-3745",
          "snippet": "int\nprlsdkUpdateDevice(vzDriverPtr driver,\n                   virDomainObjPtr dom,\n                   virDomainDeviceDefPtr dev)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (prlsdkConfigureDisk(driver, privdom->sdkdom, dev->data.disk,\n                                false) < 0)\n            return -1;\n\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (prlsdkConfigureNet(driver, dom, privdom->sdkdom, dev->data.net,\n                               IS_CT(dom->def), false) < 0)\n            return -1;\n\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (dom->def->ngraphics < 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot find VNC graphics device\"));\n            return -1;\n        }\n\n        if (prlsdkApplyGraphicsParams(privdom->sdkdom, dev->data.graphics) < 0)\n            return -1;\n\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"updating device type '%s' is unsupported\"),\n                       virDomainDeviceTypeToString(dev->type));\n        return -1;\n    }\n\n    job = PrlVm_CommitEx(privdom->sdkdom, PVCF_DETACH_HDD_BUNDLE);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);\n\nint\nprlsdkUpdateDevice(vzDriverPtr driver,\n                   virDomainObjPtr dom,\n                   virDomainDeviceDefPtr dev)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (prlsdkConfigureDisk(driver, privdom->sdkdom, dev->data.disk,\n                                false) < 0)\n            return -1;\n\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (prlsdkConfigureNet(driver, dom, privdom->sdkdom, dev->data.net,\n                               IS_CT(dom->def), false) < 0)\n            return -1;\n\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (dom->def->ngraphics < 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot find VNC graphics device\"));\n            return -1;\n        }\n\n        if (prlsdkApplyGraphicsParams(privdom->sdkdom, dev->data.graphics) < 0)\n            return -1;\n\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"updating device type '%s' is unsupported\"),\n                       virDomainDeviceTypeToString(dev->type));\n        return -1;\n    }\n\n    job = PrlVm_CommitEx(privdom->sdkdom, PVCF_DETACH_HDD_BUNDLE);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1657
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1653
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefParse",
          "args": [
            "xml",
            "dom->def",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_XML_INACTIVE"
          ],
          "line": 1648
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "16792-16961",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzCheckConfigUpdateFlags",
          "args": [
            "dom",
            "&flags"
          ],
          "line": 1645
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckConfigUpdateFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1456-1476",
          "snippet": "static int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainUpdateDeviceFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1639
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 1636
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainUpdateDeviceFlags(virDomainPtr domain,\n                                     const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom = NULL;\n    virDomainDeviceDefPtr dev = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainUpdateDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (!(dev = virDomainDeviceDefParse(xml, dom->def,\n                                        driver->xmlopt, NULL,\n                                        VIR_DOMAIN_XML_INACTIVE)))\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSetUserPassword",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1592-1623",
    "snippet": "static int\nvzDomainSetUserPassword(virDomainPtr domain,\n                        const char *user,\n                        const char *password,\n                        unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSetUserPasswordEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkDomainSetUserPassword(dom, user, password);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1621
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1620
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkDomainSetUserPassword",
          "args": [
            "dom",
            "user",
            "password"
          ],
          "line": 1616
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkDomainSetUserPassword",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "3875-3892",
          "snippet": "int\nprlsdkDomainSetUserPassword(virDomainObjPtr dom,\n                            const char *user,\n                            const char *password)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n\n    job = PrlVm_SetUserPasswd(privdom->sdkdom,\n                              user,\n                              password,\n                              0);\n\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkDomainSetUserPassword(virDomainObjPtr dom,\n                            const char *user,\n                            const char *password)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n\n    job = PrlVm_SetUserPasswd(privdom->sdkdom,\n                              user,\n                              password,\n                              0);\n\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1613
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1609
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetUserPasswordEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1603
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1602
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSetUserPassword(virDomainPtr domain,\n                        const char *user,\n                        const char *password,\n                        unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSetUserPasswordEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkDomainSetUserPassword(dom, user, password);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainDetachDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1586-1590",
    "snippet": "static int vzDomainDetachDevice(virDomainPtr domain, const char *xml)\n{\n    return vzDomainDetachDeviceFlags(domain, xml,\n                                     VIR_DOMAIN_AFFECT_CONFIG | VIR_DOMAIN_AFFECT_LIVE);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainDetachDeviceFlags",
          "args": [
            "domain",
            "xml",
            "VIR_DOMAIN_AFFECT_CONFIG | VIR_DOMAIN_AFFECT_LIVE"
          ],
          "line": 1588
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainDetachDeviceFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1533-1584",
          "snippet": "static int vzDomainDetachDeviceFlags(virDomainPtr domain, const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr dom = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    dom = vzDomObjFromDomain(domain);\n    if (dom == NULL)\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainDetachDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, dom->def,\n                                  driver->xmlopt, NULL,\n                                  VIR_DOMAIN_XML_INACTIVE |\n                                  VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n    if (dev == NULL)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkDetachDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainDetachDeviceFlags(virDomainPtr domain, const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr dom = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    dom = vzDomObjFromDomain(domain);\n    if (dom == NULL)\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainDetachDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, dom->def,\n                                  driver->xmlopt, NULL,\n                                  VIR_DOMAIN_XML_INACTIVE |\n                                  VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n    if (dev == NULL)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkDetachDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainDetachDevice(virDomainPtr domain, const char *xml)\n{\n    return vzDomainDetachDeviceFlags(domain, xml,\n                                     VIR_DOMAIN_AFFECT_CONFIG | VIR_DOMAIN_AFFECT_LIVE);\n}"
  },
  {
    "function_name": "vzDomainDetachDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1533-1584",
    "snippet": "static int vzDomainDetachDeviceFlags(virDomainPtr domain, const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr dom = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    dom = vzDomObjFromDomain(domain);\n    if (dom == NULL)\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainDetachDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, dom->def,\n                                  driver->xmlopt, NULL,\n                                  VIR_DOMAIN_XML_INACTIVE |\n                                  VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n    if (dev == NULL)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkDetachDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1581
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1580
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefFree",
          "args": [
            "dev"
          ],
          "line": 1578
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3062-3146",
          "snippet": "void virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "driver",
            "dom"
          ],
          "line": 1573
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkDetachDevice",
          "args": [
            "driver",
            "dom",
            "dev"
          ],
          "line": 1570
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkDetachDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "3627-3695",
          "snippet": "int\nprlsdkDetachDevice(vzDriverPtr driver G_GNUC_UNUSED,\n                   virDomainObjPtr dom,\n                   virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE sdkdev = PRL_INVALID_HANDLE;\n    PRL_RESULT pret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        goto cleanup;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        sdkdev = prlsdkGetDisk(privdom->sdkdom, dev->data.disk);\n        if (sdkdev == PRL_INVALID_HANDLE)\n            goto cleanup;\n\n        pret = PrlVmDev_Remove(sdkdev);\n        prlsdkCheckRetGoto(pret, cleanup);\n\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!IS_CT(dom->def)) {\n            virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                           _(\"detaching network device from VM is unsupported\"));\n            goto cleanup;\n        }\n\n        sdkdev = prlsdkFindNetByMAC(privdom->sdkdom, &dev->data.net->mac);\n        if (sdkdev == PRL_INVALID_HANDLE)\n            goto cleanup;\n\n        pret = PrlVmDev_Remove(sdkdev);\n        prlsdkCheckRetGoto(pret, cleanup);\n\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (dom->def->ngraphics < 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot find VNC graphics device\"));\n            goto cleanup;\n        }\n\n        if (prlsdkApplyGraphicsParams(privdom->sdkdom, NULL) < 0)\n            goto cleanup;\n\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"detaching device type '%s' is unsupported\"),\n                       virDomainDeviceTypeToString(dev->type));\n        goto cleanup;\n    }\n\n    job = PrlVm_CommitEx(privdom->sdkdom, PVCF_DETACH_HDD_BUNDLE);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n\n    PrlHandle_Free(sdkdev);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);",
            "static PRL_HANDLE\nprlsdkFindNetByMAC(PRL_HANDLE sdkdom, virMacAddrPtr mac);",
            "static PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\nstatic PRL_HANDLE\nprlsdkFindNetByMAC(PRL_HANDLE sdkdom, virMacAddrPtr mac);\nstatic PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);\n\nint\nprlsdkDetachDevice(vzDriverPtr driver G_GNUC_UNUSED,\n                   virDomainObjPtr dom,\n                   virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE sdkdev = PRL_INVALID_HANDLE;\n    PRL_RESULT pret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        goto cleanup;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        sdkdev = prlsdkGetDisk(privdom->sdkdom, dev->data.disk);\n        if (sdkdev == PRL_INVALID_HANDLE)\n            goto cleanup;\n\n        pret = PrlVmDev_Remove(sdkdev);\n        prlsdkCheckRetGoto(pret, cleanup);\n\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!IS_CT(dom->def)) {\n            virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                           _(\"detaching network device from VM is unsupported\"));\n            goto cleanup;\n        }\n\n        sdkdev = prlsdkFindNetByMAC(privdom->sdkdom, &dev->data.net->mac);\n        if (sdkdev == PRL_INVALID_HANDLE)\n            goto cleanup;\n\n        pret = PrlVmDev_Remove(sdkdev);\n        prlsdkCheckRetGoto(pret, cleanup);\n\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (dom->def->ngraphics < 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot find VNC graphics device\"));\n            goto cleanup;\n        }\n\n        if (prlsdkApplyGraphicsParams(privdom->sdkdom, NULL) < 0)\n            goto cleanup;\n\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"detaching device type '%s' is unsupported\"),\n                       virDomainDeviceTypeToString(dev->type));\n        goto cleanup;\n    }\n\n    job = PrlVm_CommitEx(privdom->sdkdom, PVCF_DETACH_HDD_BUNDLE);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n\n    PrlHandle_Free(sdkdev);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1567
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1563
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefParse",
          "args": [
            "xml",
            "dom->def",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_XML_INACTIVE |\n                                  VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE"
          ],
          "line": 1556
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "16792-16961",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDetachDeviceFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 1553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzCheckConfigUpdateFlags",
          "args": [
            "dom",
            "&flags"
          ],
          "line": 1550
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckConfigUpdateFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1456-1476",
          "snippet": "static int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1546
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 1543
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainDetachDeviceFlags(virDomainPtr domain, const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr dom = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    dom = vzDomObjFromDomain(domain);\n    if (dom == NULL)\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainDetachDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, dom->def,\n                                  driver->xmlopt, NULL,\n                                  VIR_DOMAIN_XML_INACTIVE |\n                                  VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n    if (dev == NULL)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkDetachDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainAttachDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1527-1531",
    "snippet": "static int vzDomainAttachDevice(virDomainPtr domain, const char *xml)\n{\n    return vzDomainAttachDeviceFlags(domain, xml,\n                                     VIR_DOMAIN_AFFECT_CONFIG | VIR_DOMAIN_AFFECT_LIVE);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainAttachDeviceFlags",
          "args": [
            "domain",
            "xml",
            "VIR_DOMAIN_AFFECT_CONFIG | VIR_DOMAIN_AFFECT_LIVE"
          ],
          "line": 1529
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainAttachDeviceFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1478-1525",
          "snippet": "static int vzDomainAttachDeviceFlags(virDomainPtr domain, const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr dom = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainAttachDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, dom->def,\n                                  driver->xmlopt, NULL, VIR_DOMAIN_XML_INACTIVE);\n    if (dev == NULL)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkAttachDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainAttachDeviceFlags(virDomainPtr domain, const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr dom = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainAttachDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, dom->def,\n                                  driver->xmlopt, NULL, VIR_DOMAIN_XML_INACTIVE);\n    if (dev == NULL)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkAttachDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainAttachDevice(virDomainPtr domain, const char *xml)\n{\n    return vzDomainAttachDeviceFlags(domain, xml,\n                                     VIR_DOMAIN_AFFECT_CONFIG | VIR_DOMAIN_AFFECT_LIVE);\n}"
  },
  {
    "function_name": "vzDomainAttachDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1478-1525",
    "snippet": "static int vzDomainAttachDeviceFlags(virDomainPtr domain, const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr dom = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainAttachDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, dom->def,\n                                  driver->xmlopt, NULL, VIR_DOMAIN_XML_INACTIVE);\n    if (dev == NULL)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkAttachDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1523
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1522
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefFree",
          "args": [
            "dev"
          ],
          "line": 1520
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3062-3146",
          "snippet": "void virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "driver",
            "dom"
          ],
          "line": 1515
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkAttachDevice",
          "args": [
            "driver",
            "dom",
            "dev"
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkAttachDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "3571-3625",
          "snippet": "int\nprlsdkAttachDevice(vzDriverPtr driver,\n                   virDomainObjPtr dom,\n                   virDomainDeviceDefPtr dev)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (prlsdkConfigureDisk(driver, privdom->sdkdom,\n                                dev->data.disk, true) < 0)\n            return -1;\n\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!IS_CT(dom->def)) {\n            virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                           _(\"attaching network device to VM is unsupported\"));\n            return -1;\n        }\n\n        if (prlsdkConfigureNet(driver, dom, privdom->sdkdom, dev->data.net,\n                               IS_CT(dom->def), true) < 0)\n            return -1;\n\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (dom->def->ngraphics > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"domain already has VNC graphics\"));\n            return -1;\n        }\n\n        if (prlsdkApplyGraphicsParams(privdom->sdkdom, dev->data.graphics) < 0)\n            return -1;\n\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"attaching device type '%s' is unsupported\"),\n                       virDomainDeviceTypeToString(dev->type));\n        return -1;\n    }\n\n    job = PrlVm_CommitEx(privdom->sdkdom, PVCF_DETACH_HDD_BUNDLE);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic PRL_HANDLE\nprlsdkGetDisk(PRL_HANDLE sdkdom, virDomainDiskDefPtr disk);\n\nint\nprlsdkAttachDevice(vzDriverPtr driver,\n                   virDomainObjPtr dom,\n                   virDomainDeviceDefPtr dev)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (prlsdkConfigureDisk(driver, privdom->sdkdom,\n                                dev->data.disk, true) < 0)\n            return -1;\n\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!IS_CT(dom->def)) {\n            virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                           _(\"attaching network device to VM is unsupported\"));\n            return -1;\n        }\n\n        if (prlsdkConfigureNet(driver, dom, privdom->sdkdom, dev->data.net,\n                               IS_CT(dom->def), true) < 0)\n            return -1;\n\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (dom->def->ngraphics > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"domain already has VNC graphics\"));\n            return -1;\n        }\n\n        if (prlsdkApplyGraphicsParams(privdom->sdkdom, dev->data.graphics) < 0)\n            return -1;\n\n        break;\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"attaching device type '%s' is unsupported\"),\n                       virDomainDeviceTypeToString(dev->type));\n        return -1;\n    }\n\n    job = PrlVm_CommitEx(privdom->sdkdom, PVCF_DETACH_HDD_BUNDLE);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1509
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1505
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefParse",
          "args": [
            "xml",
            "dom->def",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_XML_INACTIVE"
          ],
          "line": 1500
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "16792-16961",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAttachDeviceFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzCheckConfigUpdateFlags",
          "args": [
            "dom",
            "&flags"
          ],
          "line": 1494
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckConfigUpdateFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1456-1476",
          "snippet": "static int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 1488
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainAttachDeviceFlags(virDomainPtr domain, const char *xml,\n                                     unsigned int flags)\n{\n    int ret = -1;\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainDeviceDefPtr dev = NULL;\n    virDomainObjPtr dom = NULL;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (vzCheckConfigUpdateFlags(dom, &flags) < 0)\n        goto cleanup;\n\n    if (virDomainAttachDeviceFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    dev = virDomainDeviceDefParse(xml, dom->def,\n                                  driver->xmlopt, NULL, VIR_DOMAIN_XML_INACTIVE);\n    if (dev == NULL)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkAttachDevice(driver, dom, dev) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainDeviceDefFree(dev);\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzCheckConfigUpdateFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1456-1476",
    "snippet": "static int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\")"
          ],
          "line": 1469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\""
          ],
          "line": 1470
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "dom"
          ],
          "line": 1468
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\")"
          ],
          "line": 1462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjUpdateModificationImpact",
          "args": [
            "dom",
            "flags"
          ],
          "line": 1458
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjUpdateModificationImpact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3786-3814",
          "snippet": "int\nvirDomainObjUpdateModificationImpact(virDomainObjPtr vm,\n                                     unsigned int *flags)\n{\n    bool isActive = virDomainObjIsActive(vm);\n\n    if ((*flags & (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG)) ==\n        VIR_DOMAIN_AFFECT_CURRENT) {\n        if (isActive)\n            *flags |= VIR_DOMAIN_AFFECT_LIVE;\n        else\n            *flags |= VIR_DOMAIN_AFFECT_CONFIG;\n    }\n\n    if (!isActive && (*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    if (!vm->persistent && (*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"transient domains do not have any \"\n                         \"persistent config\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjUpdateModificationImpact(virDomainObjPtr vm,\n                                     unsigned int *flags)\n{\n    bool isActive = virDomainObjIsActive(vm);\n\n    if ((*flags & (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG)) ==\n        VIR_DOMAIN_AFFECT_CURRENT) {\n        if (isActive)\n            *flags |= VIR_DOMAIN_AFFECT_LIVE;\n        else\n            *flags |= VIR_DOMAIN_AFFECT_CONFIG;\n    }\n\n    if (!isActive && (*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    if (!vm->persistent && (*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"transient domains do not have any \"\n                         \"persistent config\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzCheckConfigUpdateFlags(virDomainObjPtr dom, unsigned int *flags)\n{\n    if (virDomainObjUpdateModificationImpact(dom, flags) < 0)\n        return -1;\n\n    if (!(*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain config update needs VIR_DOMAIN_AFFECT_CONFIG \"\n                         \"flag to be set\"));\n        return -1;\n    }\n\n    if (virDomainObjIsActive(dom) && !(*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Updates on a running domain need \"\n                         \"VIR_DOMAIN_AFFECT_LIVE flag\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainManagedSaveRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1429-1454",
    "snippet": "static int\nvzDomainManagedSaveRemove(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int state, reason;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainManagedSaveRemoveEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    state = virDomainObjGetState(dom, &reason);\n\n    if (!(state == VIR_DOMAIN_SHUTOFF && reason == VIR_DOMAIN_SHUTOFF_SAVED))\n        goto cleanup;\n\n    ret = prlsdkDomainManagedSaveRemove(dom);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1452
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkDomainManagedSaveRemove",
          "args": [
            "dom"
          ],
          "line": 1449
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkDomainManagedSaveRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4296-4307",
          "snippet": "int\nprlsdkDomainManagedSaveRemove(virDomainObjPtr dom)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n\n    job = PrlVm_DropSuspendedState(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkDomainManagedSaveRemove(virDomainObjPtr dom)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n\n    job = PrlVm_DropSuspendedState(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "dom",
            "&reason"
          ],
          "line": 1444
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainManagedSaveRemoveEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1438
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainManagedSaveRemove(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int state, reason;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainManagedSaveRemoveEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    state = virDomainObjGetState(dom, &reason);\n\n    if (!(state == VIR_DOMAIN_SHUTOFF && reason == VIR_DOMAIN_SHUTOFF_SAVED))\n        goto cleanup;\n\n    ret = prlsdkDomainManagedSaveRemove(dom);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainManagedSave",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1383-1427",
    "snippet": "static int\nvzDomainManagedSave(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom = NULL;\n    int state, reason;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_SAVE_RUNNING |\n                  VIR_DOMAIN_SAVE_PAUSED, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainManagedSaveEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    state = virDomainObjGetState(dom, &reason);\n\n    if (state == VIR_DOMAIN_RUNNING && (flags & VIR_DOMAIN_SAVE_PAUSED) &&\n        prlsdkPause(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkSuspend(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1425
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "privconn->driver",
            "dom"
          ],
          "line": 1417
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkSuspend",
          "args": [
            "dom"
          ],
          "line": 1414
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkSuspend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2401-2414",
          "snippet": "int prlsdkSuspend(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Suspend(privdom->sdkdom);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkSuspend(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Suspend(privdom->sdkdom);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkPause",
          "args": [
            "dom"
          ],
          "line": 1411
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkPause",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2371-2384",
          "snippet": "int prlsdkPause(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Pause(privdom->sdkdom, false);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkPause(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Pause(privdom->sdkdom, false);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "dom",
            "&reason"
          ],
          "line": 1408
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1405
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainManagedSaveEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1395
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SAVE_RUNNING |\n                  VIR_DOMAIN_SAVE_PAUSED",
            "-1"
          ],
          "line": 1392
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainManagedSave(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom = NULL;\n    int state, reason;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_SAVE_RUNNING |\n                  VIR_DOMAIN_SAVE_PAUSED, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainManagedSaveEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    state = virDomainObjGetState(dom, &reason);\n\n    if (state == VIR_DOMAIN_RUNNING && (flags & VIR_DOMAIN_SAVE_PAUSED) &&\n        prlsdkPause(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkSuspend(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainHasManagedSaveImage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1356-1381",
    "snippet": "static int\nvzDomainHasManagedSaveImage(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int state, reason;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainHasManagedSaveImageEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    state = virDomainObjGetState(dom, &reason);\n    if (state == VIR_DOMAIN_SHUTOFF && reason == VIR_DOMAIN_SHUTOFF_SAVED)\n        ret = 1;\n    else\n        ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1378
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "dom",
            "&reason"
          ],
          "line": 1371
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHasManagedSaveImageEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1365
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainHasManagedSaveImage(virDomainPtr domain, unsigned int flags)\n{\n    virDomainObjPtr dom = NULL;\n    int state, reason;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainHasManagedSaveImageEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    state = virDomainObjGetState(dom, &reason);\n    if (state == VIR_DOMAIN_SHUTOFF && reason == VIR_DOMAIN_SHUTOFF_SAVED)\n        ret = 1;\n    else\n        ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1350-1354",
    "snippet": "static int\nvzDomainUndefine(virDomainPtr domain)\n{\n    return vzDomainUndefineFlags(domain, 0);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainUndefineFlags",
          "args": [
            "domain",
            "0"
          ],
          "line": 1353
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainUndefineFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1314-1348",
          "snippet": "static int\nvzDomainUndefineFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_UNDEFINE_MANAGED_SAVE |\n                  VIR_DOMAIN_UNDEFINE_SNAPSHOTS_METADATA, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainUndefineFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkUnregisterDomain(privconn->driver, dom, flags);\n\n cleanup:\n\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainUndefineFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_UNDEFINE_MANAGED_SAVE |\n                  VIR_DOMAIN_UNDEFINE_SNAPSHOTS_METADATA, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainUndefineFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkUnregisterDomain(privconn->driver, dom, flags);\n\n cleanup:\n\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainUndefine(virDomainPtr domain)\n{\n    return vzDomainUndefineFlags(domain, 0);\n}"
  },
  {
    "function_name": "vzDomainUndefineFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1314-1348",
    "snippet": "static int\nvzDomainUndefineFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_UNDEFINE_MANAGED_SAVE |\n                  VIR_DOMAIN_UNDEFINE_SNAPSHOTS_METADATA, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainUndefineFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkUnregisterDomain(privconn->driver, dom, flags);\n\n cleanup:\n\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1345
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1344
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUnregisterDomain",
          "args": [
            "privconn->driver",
            "dom",
            "flags"
          ],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUnregisterDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4243-4294",
          "snippet": "int\nprlsdkUnregisterDomain(vzDriverPtr driver, virDomainObjPtr dom, unsigned int flags)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    VIRTUAL_MACHINE_STATE domainState;\n    int ret = -1;\n    int num;\n\n    if (prlsdkGetDomainState(dom, privdom->sdkdom, &domainState) < 0)\n        return -1;\n\n    if (VMS_SUSPENDED == domainState &&\n        !(flags & VIR_DOMAIN_UNDEFINE_MANAGED_SAVE)) {\n\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Refusing to undefine while domain managed \"\n                         \"save image exists\"));\n        return -1;\n    }\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        return -1;\n\n    if ((num = virDomainSnapshotObjListNum(snapshots, NULL, 0)) < 0)\n        goto cleanup;\n\n    if (num > 0 && !(flags & VIR_DOMAIN_UNDEFINE_SNAPSHOTS_METADATA)) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Refusing to undefine while snapshots exist\"));\n        goto cleanup;\n    }\n\n    if (prlsdkDetachDomainHardDisks(dom))\n        goto cleanup;\n\n    job = PrlVm_Delete(privdom->sdkdom, PRL_INVALID_HANDLE);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        goto cleanup;\n\n    prlsdkSendEvent(driver, dom, VIR_DOMAIN_EVENT_UNDEFINED,\n                    VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    virDomainObjListRemove(driver->domains, dom);\n\n    ret = 0;\n cleanup:\n\n    virDomainSnapshotObjListFree(snapshots);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUnregisterDomain(vzDriverPtr driver, virDomainObjPtr dom, unsigned int flags)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job;\n    virDomainSnapshotObjListPtr snapshots = NULL;\n    VIRTUAL_MACHINE_STATE domainState;\n    int ret = -1;\n    int num;\n\n    if (prlsdkGetDomainState(dom, privdom->sdkdom, &domainState) < 0)\n        return -1;\n\n    if (VMS_SUSPENDED == domainState &&\n        !(flags & VIR_DOMAIN_UNDEFINE_MANAGED_SAVE)) {\n\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Refusing to undefine while domain managed \"\n                         \"save image exists\"));\n        return -1;\n    }\n\n    if (!(snapshots = prlsdkLoadSnapshots(dom)))\n        return -1;\n\n    if ((num = virDomainSnapshotObjListNum(snapshots, NULL, 0)) < 0)\n        goto cleanup;\n\n    if (num > 0 && !(flags & VIR_DOMAIN_UNDEFINE_SNAPSHOTS_METADATA)) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Refusing to undefine while snapshots exist\"));\n        goto cleanup;\n    }\n\n    if (prlsdkDetachDomainHardDisks(dom))\n        goto cleanup;\n\n    job = PrlVm_Delete(privdom->sdkdom, PRL_INVALID_HANDLE);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        goto cleanup;\n\n    prlsdkSendEvent(driver, dom, VIR_DOMAIN_EVENT_UNDEFINED,\n                    VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    virDomainObjListRemove(driver->domains, dom);\n\n    ret = 0;\n cleanup:\n\n    virDomainSnapshotObjListFree(snapshots);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainUndefineFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1326
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_UNDEFINE_MANAGED_SAVE |\n                  VIR_DOMAIN_UNDEFINE_SNAPSHOTS_METADATA",
            "-1"
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainUndefineFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_UNDEFINE_MANAGED_SAVE |\n                  VIR_DOMAIN_UNDEFINE_SNAPSHOTS_METADATA, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainUndefineFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    ret = prlsdkUnregisterDomain(privconn->driver, dom, flags);\n\n cleanup:\n\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1308-1312",
    "snippet": "static int\nvzDomainCreate(virDomainPtr domain)\n{\n    return vzDomainCreateWithFlags(domain, 0);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainCreateWithFlags",
          "args": [
            "domain",
            "0"
          ],
          "line": 1311
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainCreateWithFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1122-1159",
          "snippet": "static int\nvzDomainCreateWithFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainCreateWithFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkStart(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainCreateWithFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainCreateWithFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkStart(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainCreate(virDomainPtr domain)\n{\n    return vzDomainCreateWithFlags(domain, 0);\n}"
  },
  {
    "function_name": "vzDomainIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1289-1306",
    "snippet": "static int vzDomainIsActive(virDomainPtr domain)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainIsActiveEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjIsActive(dom);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "dom"
          ],
          "line": 1300
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainIsActiveEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1294
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainIsActive(virDomainPtr domain)\n{\n    virDomainObjPtr dom = NULL;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainIsActiveEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjIsActive(dom);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainReboot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1250-1287",
    "snippet": "static int\nvzDomainReboot(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainRebootEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkRestart(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1284
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "privconn->driver",
            "dom"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkRestart",
          "args": [
            "dom"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2416-2429",
          "snippet": "int prlsdkRestart(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Restart(privdom->sdkdom);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkRestart(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Restart(privdom->sdkdom);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1270
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainRebootEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 1263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1260
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainReboot(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainRebootEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkRestart(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainShutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1245-1248",
    "snippet": "static int vzDomainShutdown(virDomainPtr dom)\n{\n    return vzDomainShutdownFlags(dom, 0);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainShutdownFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 1247
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainShutdownFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1206-1243",
          "snippet": "static int\nvzDomainShutdownFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainShutdownFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkStop(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainShutdownFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainShutdownFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkStop(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDomainShutdown(virDomainPtr dom)\n{\n    return vzDomainShutdownFlags(dom, 0);\n}"
  },
  {
    "function_name": "vzDomainShutdownFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1206-1243",
    "snippet": "static int\nvzDomainShutdownFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainShutdownFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkStop(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1239
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "privconn->driver",
            "dom"
          ],
          "line": 1232
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkStop",
          "args": [
            "dom"
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkStop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2356-2369",
          "snippet": "int prlsdkStop(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_StopEx(privdom->sdkdom, PSM_SHUTDOWN, 0);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkStop(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_StopEx(privdom->sdkdom, PSM_SHUTDOWN, 0);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1226
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1222
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainShutdownFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1216
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainShutdownFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainShutdownFlagsEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkStop(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1200-1204",
    "snippet": "static int\nvzDomainDestroy(virDomainPtr dom)\n{\n    return vzDomainDestroyFlags(dom, 0);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainDestroyFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainDestroyFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "1161-1198",
          "snippet": "static int\nvzDomainDestroyFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainDestroyFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkKill(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDestroyFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainDestroyFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkKill(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDestroy(virDomainPtr dom)\n{\n    return vzDomainDestroyFlags(dom, 0);\n}"
  },
  {
    "function_name": "vzDomainDestroyFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1161-1198",
    "snippet": "static int\nvzDomainDestroyFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainDestroyFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkKill(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1195
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "privconn->driver",
            "dom"
          ],
          "line": 1187
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkKill",
          "args": [
            "dom"
          ],
          "line": 1184
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkKill",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2341-2354",
          "snippet": "int prlsdkKill(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_StopEx(privdom->sdkdom, PSM_KILL, 0);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkKill(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_StopEx(privdom->sdkdom, PSM_KILL, 0);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1181
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDestroyFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDestroyFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainDestroyFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkKill(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainCreateWithFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1122-1159",
    "snippet": "static int\nvzDomainCreateWithFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainCreateWithFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkStart(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1156
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1155
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "privconn->driver",
            "dom"
          ],
          "line": 1148
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkStart",
          "args": [
            "dom"
          ],
          "line": 1145
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2326-2339",
          "snippet": "int prlsdkStart(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_StartEx(privdom->sdkdom, PSM_VM_START, 0);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkStart(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_StartEx(privdom->sdkdom, PSM_VM_START, 0);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCreateWithFlagsEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1132
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainCreateWithFlags(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainCreateWithFlagsEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkStart(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainResume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1085-1120",
    "snippet": "static int\nvzDomainResume(virDomainPtr domain)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainResumeEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkResume(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1116
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "privconn->driver",
            "dom"
          ],
          "line": 1109
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkResume",
          "args": [
            "dom"
          ],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkResume",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2386-2399",
          "snippet": "int prlsdkResume(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Resume(privdom->sdkdom);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkResume(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Resume(privdom->sdkdom);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1103
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainResumeEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainResume(virDomainPtr domain)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainResumeEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkResume(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainSuspend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1048-1083",
    "snippet": "static int\nvzDomainSuspend(virDomainPtr domain)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSuspendEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkPause(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "privconn->driver",
            "dom"
          ],
          "line": 1072
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkPause",
          "args": [
            "dom"
          ],
          "line": 1069
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkPause",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2371-2384",
          "snippet": "int prlsdkPause(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Pause(privdom->sdkdom, false);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint prlsdkPause(virDomainObjPtr dom)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_RESULT pret;\n\n    job = PrlVm_Pause(privdom->sdkdom, false);\n    if (PRL_FAILED(pret = waitDomainJob(job, dom))) {\n        prlsdkConvertError(pret);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 1062
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSuspendEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 1056
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainSuspend(virDomainPtr domain)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    virDomainObjPtr dom;\n    int ret = -1;\n    bool job = false;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainSuspendEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (vzDomainObjBeginJob(dom) < 0)\n        goto cleanup;\n    job = true;\n\n    if (vzEnsureDomainExists(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkPause(dom) < 0)\n        goto cleanup;\n\n    if (prlsdkUpdateDomain(privconn->driver, dom) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n\n    return ret;\n}"
  },
  {
    "function_name": "vzConnectDomainEventDeregisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1031-1046",
    "snippet": "static int\nvzConnectDomainEventDeregisterAny(virConnectPtr conn,\n                                  int callbackID)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectDomainEventDeregisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virObjectEventStateDeregisterID(conn,\n                                        privconn->driver->domainEventState,\n                                        callbackID, true) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateDeregisterID",
          "args": [
            "conn",
            "privconn->driver->domainEventState",
            "callbackID",
            "true"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateDeregisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "936-957",
          "snippet": "int\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectDomainEventDeregisterAnyEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectDomainEventDeregisterAny(virConnectPtr conn,\n                                  int callbackID)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectDomainEventDeregisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virObjectEventStateDeregisterID(conn,\n                                        privconn->driver->domainEventState,\n                                        callbackID, true) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzConnectDomainEventRegisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "1009-1029",
    "snippet": "static int\nvzConnectDomainEventRegisterAny(virConnectPtr conn,\n                                virDomainPtr domain,\n                                int eventID,\n                                virConnectDomainEventGenericCallback callback,\n                                void *opaque,\n                                virFreeCallback freecb)\n{\n    int ret = -1;\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectDomainEventRegisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateRegisterID(conn,\n                                      privconn->driver->domainEventState,\n                                      domain, eventID,\n                                      callback, opaque, freecb, &ret) < 0)\n        ret = -1;\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainEventStateRegisterID",
          "args": [
            "conn",
            "privconn->driver->domainEventState",
            "domain",
            "eventID",
            "callback",
            "opaque",
            "freecb",
            "&ret"
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "2036-2059",
          "snippet": "int\nvirDomainEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virDomainPtr dom,\n                              int eventID,\n                              virConnectDomainEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virDomainEventsInitialize() < 0)\n        return -1;\n\n    if (dom)\n        virUUIDFormat(dom->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, dom ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virDomainEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainEventClass;\n\nint\nvirDomainEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virDomainPtr dom,\n                              int eventID,\n                              virConnectDomainEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virDomainEventsInitialize() < 0)\n        return -1;\n\n    if (dom)\n        virUUIDFormat(dom->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, dom ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virDomainEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectDomainEventRegisterAnyEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectDomainEventRegisterAny(virConnectPtr conn,\n                                virDomainPtr domain,\n                                int eventID,\n                                virConnectDomainEventGenericCallback callback,\n                                void *opaque,\n                                virFreeCallback freecb)\n{\n    int ret = -1;\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectDomainEventRegisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateRegisterID(conn,\n                                      privconn->driver->domainEventState,\n                                      domain, eventID,\n                                      callback, opaque, freecb, &ret) < 0)\n        ret = -1;\n    return ret;\n}"
  },
  {
    "function_name": "vzNodeGetCPUMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "997-1007",
    "snippet": "static int\nvzNodeGetCPUMap(virConnectPtr conn,\n                unsigned char **cpumap,\n                unsigned int *online,\n                unsigned int flags)\n{\n    if (virNodeGetCPUMapEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetMap(cpumap, online, flags);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostCPUGetMap",
          "args": [
            "cpumap",
            "online",
            "flags"
          ],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetMap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "1087-1116",
          "snippet": "int\nvirHostCPUGetMap(unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    virBitmapPtr cpus = NULL;\n    int ret = -1;\n    int dummy;\n\n    virCheckFlags(0, -1);\n\n    if (!cpumap && !online)\n        return virHostCPUGetCount();\n\n    if (!(cpus = virHostCPUGetOnlineBitmap()))\n        goto cleanup;\n\n    if (cpumap && virBitmapToData(cpus, cpumap, &dummy) < 0)\n        goto cleanup;\n    if (online)\n        *online = virBitmapCountBits(cpus);\n\n    ret = virHostCPUGetCount();\n\n cleanup:\n    if (ret < 0 && cpumap)\n        VIR_FREE(*cpumap);\n    virBitmapFree(cpus);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetMap(unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    virBitmapPtr cpus = NULL;\n    int ret = -1;\n    int dummy;\n\n    virCheckFlags(0, -1);\n\n    if (!cpumap && !online)\n        return virHostCPUGetCount();\n\n    if (!(cpus = virHostCPUGetOnlineBitmap()))\n        goto cleanup;\n\n    if (cpumap && virBitmapToData(cpus, cpumap, &dummy) < 0)\n        goto cleanup;\n    if (online)\n        *online = virBitmapCountBits(cpus);\n\n    ret = virHostCPUGetCount();\n\n cleanup:\n    if (ret < 0 && cpumap)\n        VIR_FREE(*cpumap);\n    virBitmapFree(cpus);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetCPUMapEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzNodeGetCPUMap(virConnectPtr conn,\n                unsigned char **cpumap,\n                unsigned int *online,\n                unsigned int flags)\n{\n    if (virNodeGetCPUMapEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetMap(cpumap, online, flags);\n}"
  },
  {
    "function_name": "vzDomainGetVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "943-994",
    "snippet": "static int\nvzDomainGetVcpus(virDomainPtr domain,\n                 virVcpuInfoPtr info,\n                 int maxinfo,\n                 unsigned char *cpumaps,\n                 int maplen)\n{\n    virDomainObjPtr dom = NULL;\n    size_t i;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetVcpusEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\",\n                       _(\"cannot list vcpu pinning for an inactive domain\"));\n        goto cleanup;\n    }\n\n    if (maxinfo >= 1) {\n        if (info != NULL) {\n        vzDomObjPtr privdom;\n\n            memset(info, 0, sizeof(*info) * maxinfo);\n            privdom = dom->privateData;\n\n            for (i = 0; i < maxinfo; i++) {\n                info[i].number = i;\n                info[i].state = VIR_VCPU_RUNNING;\n                if (prlsdkGetVcpuStats(privdom->stats, i, &info[i].cpuTime) < 0)\n                    goto cleanup;\n            }\n        }\n        if (cpumaps != NULL) {\n            memset(cpumaps, 0, maplen * maxinfo);\n            for (i = 0; i < maxinfo; i++)\n                virBitmapToDataBuf(dom->def->cpumask,\n                                   VIR_GET_CPUMAP(cpumaps, maplen, i),\n                                   maplen);\n        }\n    }\n    ret = maxinfo;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 992
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapToDataBuf",
          "args": [
            "dom->def->cpumask",
            "VIR_GET_CPUMAP(cpumaps, maplen, i)",
            "maplen"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapToDataBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "805-828",
          "snippet": "void\nvirBitmapToDataBuf(virBitmapPtr bitmap,\n                   unsigned char *bytes,\n                   size_t len)\n{\n    size_t nbytes = bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT);\n    unsigned long *l;\n    size_t i, j;\n\n    memset(bytes, 0, len);\n\n    /* If bitmap and buffer differ in size, only fill to the smaller length */\n    len = MIN(len, nbytes);\n\n    /* htole64 is not available, so we do the conversion by hand */\n    l = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*l)) {\n            j = 0;\n            l++;\n        }\n        bytes[i] = *l >> (j * CHAR_BIT);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvoid\nvirBitmapToDataBuf(virBitmapPtr bitmap,\n                   unsigned char *bytes,\n                   size_t len)\n{\n    size_t nbytes = bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT);\n    unsigned long *l;\n    size_t i, j;\n\n    memset(bytes, 0, len);\n\n    /* If bitmap and buffer differ in size, only fill to the smaller length */\n    len = MIN(len, nbytes);\n\n    /* htole64 is not available, so we do the conversion by hand */\n    l = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*l)) {\n            j = 0;\n            l++;\n        }\n        bytes[i] = *l >> (j * CHAR_BIT);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_GET_CPUMAP",
          "args": [
            "cpumaps",
            "maplen",
            "i"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cpumaps",
            "0",
            "maplen * maxinfo"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prlsdkGetVcpuStats",
          "args": [
            "privdom->stats",
            "i",
            "&info[i].cpuTime"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetVcpuStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4483-4499",
          "snippet": "int\nprlsdkGetVcpuStats(PRL_HANDLE sdkstats, int idx, unsigned long long *vtime)\n{\n    char *name = NULL;\n    long long ptime = 0;\n    int ret = -1;\n\n    name = g_strdup_printf(\"guest.vcpu%u.time\", (unsigned int)idx);\n    if (prlsdkExtractStatsParam(sdkstats, name, &ptime) < 0)\n        goto cleanup;\n    *vtime = ptime == -1 ? 0 : ptime;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkGetVcpuStats(PRL_HANDLE sdkstats, int idx, unsigned long long *vtime)\n{\n    char *name = NULL;\n    long long ptime = 0;\n    int ret = -1;\n\n    name = g_strdup_printf(\"guest.vcpu%u.time\", (unsigned int)idx);\n    if (prlsdkExtractStatsParam(sdkstats, name, &ptime) < 0)\n        goto cleanup;\n    *vtime = ptime == -1 ? 0 : ptime;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info) * maxinfo"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cannot list vcpu pinning for an inactive domain\")"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot list vcpu pinning for an inactive domain\""
          ],
          "line": 963
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "dom"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetVcpusEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetVcpus(virDomainPtr domain,\n                 virVcpuInfoPtr info,\n                 int maxinfo,\n                 unsigned char *cpumaps,\n                 int maplen)\n{\n    virDomainObjPtr dom = NULL;\n    size_t i;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetVcpusEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\",\n                       _(\"cannot list vcpu pinning for an inactive domain\"));\n        goto cleanup;\n    }\n\n    if (maxinfo >= 1) {\n        if (info != NULL) {\n        vzDomObjPtr privdom;\n\n            memset(info, 0, sizeof(*info) * maxinfo);\n            privdom = dom->privateData;\n\n            for (i = 0; i < maxinfo; i++) {\n                info[i].number = i;\n                info[i].state = VIR_VCPU_RUNNING;\n                if (prlsdkGetVcpuStats(privdom->stats, i, &info[i].cpuTime) < 0)\n                    goto cleanup;\n            }\n        }\n        if (cpumaps != NULL) {\n            memset(cpumaps, 0, maplen * maxinfo);\n            for (i = 0; i < maxinfo; i++)\n                virBitmapToDataBuf(dom->def->cpumask,\n                                   VIR_GET_CPUMAP(cpumaps, maplen, i),\n                                   maplen);\n        }\n    }\n    ret = maxinfo;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzConnectBaselineCPU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "908-940",
    "snippet": "static char *\nvzConnectBaselineCPU(virConnectPtr conn,\n                     const char **xmlCPUs,\n                     unsigned int ncpus,\n                     unsigned int flags)\n{\n    virCPUDefPtr *cpus = NULL;\n    virCPUDefPtr cpu = NULL;\n    char *cpustr = NULL;\n\n    virCheckFlags(VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES, NULL);\n\n    if (virConnectBaselineCPUEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!(cpus = virCPUDefListParse(xmlCPUs, ncpus, VIR_CPU_TYPE_HOST)))\n        goto cleanup;\n\n    if (!(cpu = virCPUBaseline(VIR_ARCH_NONE, cpus, ncpus, NULL, NULL, false)))\n        goto cleanup;\n\n    if ((flags & VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES) &&\n        virCPUExpandFeatures(cpus[0]->arch, cpu) < 0)\n        goto cleanup;\n\n    cpustr = virCPUDefFormat(cpu, NULL);\n\n cleanup:\n    virCPUDefListFree(cpus);\n    virCPUDefFree(cpu);\n\n    return cpustr;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCPUDefFree",
          "args": [
            "cpu"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "120-132",
          "snippet": "void\nvirCPUDefFree(virCPUDefPtr def)\n{\n    if (!def)\n        return;\n\n    if (g_atomic_int_dec_and_test(&def->refs)) {\n        virCPUDefFreeModel(def);\n        VIR_FREE(def->cache);\n        VIR_FREE(def->tsc);\n        VIR_FREE(def);\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirCPUDefFree(virCPUDefPtr def)\n{\n    if (!def)\n        return;\n\n    if (g_atomic_int_dec_and_test(&def->refs)) {\n        virCPUDefFreeModel(def);\n        VIR_FREE(def->cache);\n        VIR_FREE(def->tsc);\n        VIR_FREE(def);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefListFree",
          "args": [
            "cpus"
          ],
          "line": 936
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "1192-1204",
          "snippet": "void\nvirCPUDefListFree(virCPUDefPtr *cpus)\n{\n    virCPUDefPtr *cpu;\n\n    if (!cpus)\n        return;\n\n    for (cpu = cpus; *cpu != NULL; cpu++)\n        virCPUDefFree(*cpu);\n\n    VIR_FREE(cpus);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirCPUDefListFree(virCPUDefPtr *cpus)\n{\n    virCPUDefPtr *cpu;\n\n    if (!cpus)\n        return;\n\n    for (cpu = cpus; *cpu != NULL; cpu++)\n        virCPUDefFree(*cpu);\n\n    VIR_FREE(cpus);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefFormat",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "775-882",
          "snippet": "int\nvirCPUDefFormatBuf(virBufferPtr buf,\n                   virCPUDefPtr def)\n{\n    size_t i;\n    bool formatModel;\n\n    if (!def)\n        return 0;\n\n    formatModel = (def->mode == VIR_CPU_MODE_CUSTOM ||\n                   def->mode == VIR_CPU_MODE_HOST_MODEL);\n\n    if (!def->model && def->mode == VIR_CPU_MODE_CUSTOM && def->nfeatures) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Non-empty feature list specified without CPU model\"));\n        return -1;\n    }\n\n    if (formatModel && (def->model || def->vendor_id)) {\n        virBufferAddLit(buf, \"<model\");\n\n        if (def->type == VIR_CPU_TYPE_GUEST && def->model) {\n            const char *fallback;\n\n            fallback = virCPUFallbackTypeToString(def->fallback);\n            if (!fallback) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU fallback value: %d\"),\n                               def->fallback);\n                return -1;\n            }\n            virBufferAsprintf(buf, \" fallback='%s'\", fallback);\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST)\n            virBufferEscapeString(buf, \" vendor_id='%s'\", def->vendor_id);\n\n        if (def->model)\n            virBufferEscapeString(buf, \">%s</model>\\n\", def->model);\n        else\n            virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (formatModel && def->vendor)\n        virBufferEscapeString(buf, \"<vendor>%s</vendor>\\n\", def->vendor);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->microcodeVersion)\n        virBufferAsprintf(buf, \"<microcode version='%u'/>\\n\",\n                          def->microcodeVersion);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->tsc) {\n        virBufferAddLit(buf, \"<counter name='tsc'\");\n        virBufferAsprintf(buf, \" frequency='%llu'\", def->tsc->frequency);\n        if (def->tsc->scaling) {\n            virBufferAsprintf(buf, \" scaling='%s'\",\n                              virTristateBoolTypeToString(def->tsc->scaling));\n        }\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->sockets && def->dies && def->cores && def->threads) {\n        virBufferAddLit(buf, \"<topology\");\n        virBufferAsprintf(buf, \" sockets='%u'\", def->sockets);\n        virBufferAsprintf(buf, \" dies='%u'\", def->dies);\n        virBufferAsprintf(buf, \" cores='%u'\", def->cores);\n        virBufferAsprintf(buf, \" threads='%u'\", def->threads);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->cache) {\n        virBufferAddLit(buf, \"<cache \");\n        if (def->cache->level != -1)\n            virBufferAsprintf(buf, \"level='%d' \", def->cache->level);\n        virBufferAsprintf(buf, \"mode='%s'\",\n                          virCPUCacheModeTypeToString(def->cache->mode));\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    for (i = 0; i < def->nfeatures; i++) {\n        virCPUFeatureDefPtr feature = def->features + i;\n\n        if (!feature->name) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Missing CPU feature name\"));\n            return -1;\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST) {\n            const char *policy;\n\n            policy = virCPUFeaturePolicyTypeToString(feature->policy);\n            if (!policy) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU feature policy %d\"),\n                               feature->policy);\n                return -1;\n            }\n            virBufferAsprintf(buf, \"<feature policy='%s' name='%s'/>\\n\",\n                              policy, feature->name);\n        } else {\n            virBufferAsprintf(buf, \"<feature name='%s'/>\\n\",\n                              feature->name);\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirCPUDefFormatBuf(virBufferPtr buf,\n                   virCPUDefPtr def)\n{\n    size_t i;\n    bool formatModel;\n\n    if (!def)\n        return 0;\n\n    formatModel = (def->mode == VIR_CPU_MODE_CUSTOM ||\n                   def->mode == VIR_CPU_MODE_HOST_MODEL);\n\n    if (!def->model && def->mode == VIR_CPU_MODE_CUSTOM && def->nfeatures) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Non-empty feature list specified without CPU model\"));\n        return -1;\n    }\n\n    if (formatModel && (def->model || def->vendor_id)) {\n        virBufferAddLit(buf, \"<model\");\n\n        if (def->type == VIR_CPU_TYPE_GUEST && def->model) {\n            const char *fallback;\n\n            fallback = virCPUFallbackTypeToString(def->fallback);\n            if (!fallback) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU fallback value: %d\"),\n                               def->fallback);\n                return -1;\n            }\n            virBufferAsprintf(buf, \" fallback='%s'\", fallback);\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST)\n            virBufferEscapeString(buf, \" vendor_id='%s'\", def->vendor_id);\n\n        if (def->model)\n            virBufferEscapeString(buf, \">%s</model>\\n\", def->model);\n        else\n            virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (formatModel && def->vendor)\n        virBufferEscapeString(buf, \"<vendor>%s</vendor>\\n\", def->vendor);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->microcodeVersion)\n        virBufferAsprintf(buf, \"<microcode version='%u'/>\\n\",\n                          def->microcodeVersion);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->tsc) {\n        virBufferAddLit(buf, \"<counter name='tsc'\");\n        virBufferAsprintf(buf, \" frequency='%llu'\", def->tsc->frequency);\n        if (def->tsc->scaling) {\n            virBufferAsprintf(buf, \" scaling='%s'\",\n                              virTristateBoolTypeToString(def->tsc->scaling));\n        }\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->sockets && def->dies && def->cores && def->threads) {\n        virBufferAddLit(buf, \"<topology\");\n        virBufferAsprintf(buf, \" sockets='%u'\", def->sockets);\n        virBufferAsprintf(buf, \" dies='%u'\", def->dies);\n        virBufferAsprintf(buf, \" cores='%u'\", def->cores);\n        virBufferAsprintf(buf, \" threads='%u'\", def->threads);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->cache) {\n        virBufferAddLit(buf, \"<cache \");\n        if (def->cache->level != -1)\n            virBufferAsprintf(buf, \"level='%d' \", def->cache->level);\n        virBufferAsprintf(buf, \"mode='%s'\",\n                          virCPUCacheModeTypeToString(def->cache->mode));\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    for (i = 0; i < def->nfeatures; i++) {\n        virCPUFeatureDefPtr feature = def->features + i;\n\n        if (!feature->name) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Missing CPU feature name\"));\n            return -1;\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST) {\n            const char *policy;\n\n            policy = virCPUFeaturePolicyTypeToString(feature->policy);\n            if (!policy) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU feature policy %d\"),\n                               feature->policy);\n                return -1;\n            }\n            virBufferAsprintf(buf, \"<feature policy='%s' name='%s'/>\\n\",\n                              policy, feature->name);\n        } else {\n            virBufferAsprintf(buf, \"<feature name='%s'/>\\n\",\n                              feature->name);\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUExpandFeatures",
          "args": [
            "cpus[0]->arch",
            "cpu"
          ],
          "line": 930
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUExpandFeatures",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu.c",
          "lines": "986-1007",
          "snippet": "int\nvirCPUExpandFeatures(virArch arch,\n                     virCPUDefPtr cpu)\n{\n    struct cpuArchDriver *driver;\n\n    VIR_DEBUG(\"arch=%s, cpu=%p, model=%s, nfeatures=%zu\",\n              virArchToString(arch), cpu, NULLSTR(cpu->model), cpu->nfeatures);\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return -1;\n\n    if (driver->expandFeatures &&\n        driver->expandFeatures(cpu) < 0)\n        return -1;\n\n    qsort(cpu->features, cpu->nfeatures, sizeof(*cpu->features),\n          virCPUFeatureCompare);\n\n    VIR_DEBUG(\"nfeatures=%zu\", cpu->nfeatures);\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"capabilities.h\"",
            "#include \"cpu_arm.h\"",
            "#include \"cpu_s390.h\"",
            "#include \"cpu_ppc64.h\"",
            "#include \"cpu_x86.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"capabilities.h\"\n#include \"cpu_arm.h\"\n#include \"cpu_s390.h\"\n#include \"cpu_ppc64.h\"\n#include \"cpu_x86.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nint\nvirCPUExpandFeatures(virArch arch,\n                     virCPUDefPtr cpu)\n{\n    struct cpuArchDriver *driver;\n\n    VIR_DEBUG(\"arch=%s, cpu=%p, model=%s, nfeatures=%zu\",\n              virArchToString(arch), cpu, NULLSTR(cpu->model), cpu->nfeatures);\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return -1;\n\n    if (driver->expandFeatures &&\n        driver->expandFeatures(cpu) < 0)\n        return -1;\n\n    qsort(cpu->features, cpu->nfeatures, sizeof(*cpu->features),\n          virCPUFeatureCompare);\n\n    VIR_DEBUG(\"nfeatures=%zu\", cpu->nfeatures);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUBaseline",
          "args": [
            "VIR_ARCH_NONE",
            "cpus",
            "ncpus",
            "NULL",
            "NULL",
            "false"
          ],
          "line": 926
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUBaseline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu.c",
          "lines": "483-543",
          "snippet": "virCPUDefPtr\nvirCPUBaseline(virArch arch,\n               virCPUDefPtr *cpus,\n               unsigned int ncpus,\n               virDomainCapsCPUModelsPtr models,\n               const char **features,\n               bool migratable)\n{\n    struct cpuArchDriver *driver;\n    size_t i;\n\n    VIR_DEBUG(\"arch=%s, ncpus=%u, models=%p, features=%p, migratable=%d\",\n              virArchToString(arch), ncpus, models, features, migratable);\n    if (cpus) {\n        for (i = 0; i < ncpus; i++)\n            VIR_DEBUG(\"cpus[%zu]=%p\", i, cpus[i]);\n    }\n    if (models) {\n        for (i = 0; i < models->nmodels; i++)\n            VIR_DEBUG(\"models[%zu]=%s\", i, models->models[i].name);\n    }\n\n    if (!cpus && ncpus != 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"nonzero ncpus doesn't match with NULL cpus\"));\n        return NULL;\n    }\n\n    if (ncpus < 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"no CPUs given\"));\n        return NULL;\n    }\n\n    for (i = 0; i < ncpus; i++) {\n        if (!cpus[i]) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"invalid CPU definition at index %zu\"), i);\n            return NULL;\n        }\n        if (!cpus[i]->model) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"no CPU model specified at index %zu\"), i);\n            return NULL;\n        }\n    }\n\n    if (arch == VIR_ARCH_NONE)\n        arch = cpus[0]->arch;\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return NULL;\n\n    if (!driver->baseline) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"cannot compute baseline CPU of %s architecture\"),\n                       virArchToString(arch));\n        return NULL;\n    }\n\n    return driver->baseline(cpus, ncpus, models, features, migratable);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"capabilities.h\"",
            "#include \"cpu_arm.h\"",
            "#include \"cpu_s390.h\"",
            "#include \"cpu_ppc64.h\"",
            "#include \"cpu_x86.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"capabilities.h\"\n#include \"cpu_arm.h\"\n#include \"cpu_s390.h\"\n#include \"cpu_ppc64.h\"\n#include \"cpu_x86.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirCPUDefPtr\nvirCPUBaseline(virArch arch,\n               virCPUDefPtr *cpus,\n               unsigned int ncpus,\n               virDomainCapsCPUModelsPtr models,\n               const char **features,\n               bool migratable)\n{\n    struct cpuArchDriver *driver;\n    size_t i;\n\n    VIR_DEBUG(\"arch=%s, ncpus=%u, models=%p, features=%p, migratable=%d\",\n              virArchToString(arch), ncpus, models, features, migratable);\n    if (cpus) {\n        for (i = 0; i < ncpus; i++)\n            VIR_DEBUG(\"cpus[%zu]=%p\", i, cpus[i]);\n    }\n    if (models) {\n        for (i = 0; i < models->nmodels; i++)\n            VIR_DEBUG(\"models[%zu]=%s\", i, models->models[i].name);\n    }\n\n    if (!cpus && ncpus != 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"nonzero ncpus doesn't match with NULL cpus\"));\n        return NULL;\n    }\n\n    if (ncpus < 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"no CPUs given\"));\n        return NULL;\n    }\n\n    for (i = 0; i < ncpus; i++) {\n        if (!cpus[i]) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"invalid CPU definition at index %zu\"), i);\n            return NULL;\n        }\n        if (!cpus[i]->model) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"no CPU model specified at index %zu\"), i);\n            return NULL;\n        }\n    }\n\n    if (arch == VIR_ARCH_NONE)\n        arch = cpus[0]->arch;\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return NULL;\n\n    if (!driver->baseline) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"cannot compute baseline CPU of %s architecture\"),\n                       virArchToString(arch));\n        return NULL;\n    }\n\n    return driver->baseline(cpus, ncpus, models, features, migratable);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefListParse",
          "args": [
            "xmlCPUs",
            "ncpus",
            "VIR_CPU_TYPE_HOST"
          ],
          "line": 923
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefListParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "1135-1186",
          "snippet": "virCPUDefPtr *\nvirCPUDefListParse(const char **xmlCPUs,\n                   unsigned int ncpus,\n                   virCPUType cpuType)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virCPUDefPtr *cpus = NULL;\n    size_t i;\n\n    VIR_DEBUG(\"xmlCPUs=%p, ncpus=%u\", xmlCPUs, ncpus);\n\n    if (xmlCPUs) {\n        for (i = 0; i < ncpus; i++)\n            VIR_DEBUG(\"xmlCPUs[%zu]=%s\", i, NULLSTR(xmlCPUs[i]));\n    }\n\n    if (!xmlCPUs && ncpus != 0) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"nonzero ncpus doesn't match with NULL xmlCPUs\"));\n        goto error;\n    }\n\n    if (ncpus == 0) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"no CPUs given\"));\n        goto error;\n    }\n\n    if (VIR_ALLOC_N(cpus, ncpus + 1))\n        goto error;\n\n    for (i = 0; i < ncpus; i++) {\n        if (!(doc = virXMLParseStringCtxt(xmlCPUs[i], _(\"(CPU_definition)\"), &ctxt)))\n            goto error;\n\n        if (virCPUDefParseXML(ctxt, NULL, cpuType, &cpus[i]) < 0)\n            goto error;\n\n        xmlXPathFreeContext(ctxt);\n        xmlFreeDoc(doc);\n        ctxt = NULL;\n        doc = NULL;\n    }\n\n    return cpus;\n\n error:\n    virCPUDefListFree(cpus);\n    xmlXPathFreeContext(ctxt);\n    xmlFreeDoc(doc);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirCPUDefPtr *\nvirCPUDefListParse(const char **xmlCPUs,\n                   unsigned int ncpus,\n                   virCPUType cpuType)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virCPUDefPtr *cpus = NULL;\n    size_t i;\n\n    VIR_DEBUG(\"xmlCPUs=%p, ncpus=%u\", xmlCPUs, ncpus);\n\n    if (xmlCPUs) {\n        for (i = 0; i < ncpus; i++)\n            VIR_DEBUG(\"xmlCPUs[%zu]=%s\", i, NULLSTR(xmlCPUs[i]));\n    }\n\n    if (!xmlCPUs && ncpus != 0) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"nonzero ncpus doesn't match with NULL xmlCPUs\"));\n        goto error;\n    }\n\n    if (ncpus == 0) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"no CPUs given\"));\n        goto error;\n    }\n\n    if (VIR_ALLOC_N(cpus, ncpus + 1))\n        goto error;\n\n    for (i = 0; i < ncpus; i++) {\n        if (!(doc = virXMLParseStringCtxt(xmlCPUs[i], _(\"(CPU_definition)\"), &ctxt)))\n            goto error;\n\n        if (virCPUDefParseXML(ctxt, NULL, cpuType, &cpus[i]) < 0)\n            goto error;\n\n        xmlXPathFreeContext(ctxt);\n        xmlFreeDoc(doc);\n        ctxt = NULL;\n        doc = NULL;\n    }\n\n    return cpus;\n\n error:\n    virCPUDefListFree(cpus);\n    xmlXPathFreeContext(ctxt);\n    xmlFreeDoc(doc);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectBaselineCPUEnsureACL",
          "args": [
            "conn"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES",
            "NULL"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nvzConnectBaselineCPU(virConnectPtr conn,\n                     const char **xmlCPUs,\n                     unsigned int ncpus,\n                     unsigned int flags)\n{\n    virCPUDefPtr *cpus = NULL;\n    virCPUDefPtr cpu = NULL;\n    char *cpustr = NULL;\n\n    virCheckFlags(VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES, NULL);\n\n    if (virConnectBaselineCPUEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!(cpus = virCPUDefListParse(xmlCPUs, ncpus, VIR_CPU_TYPE_HOST)))\n        goto cleanup;\n\n    if (!(cpu = virCPUBaseline(VIR_ARCH_NONE, cpus, ncpus, NULL, NULL, false)))\n        goto cleanup;\n\n    if ((flags & VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES) &&\n        virCPUExpandFeatures(cpus[0]->arch, cpu) < 0)\n        goto cleanup;\n\n    cpustr = virCPUDefFormat(cpu, NULL);\n\n cleanup:\n    virCPUDefListFree(cpus);\n    virCPUDefFree(cpu);\n\n    return cpustr;\n}"
  },
  {
    "function_name": "vzConnectIsAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "902-905",
    "snippet": "static int vzConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}"
  },
  {
    "function_name": "vzConnectIsSecure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "896-900",
    "snippet": "static int vzConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* We run CLI tools directly so this is secure */\n    return 1;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* We run CLI tools directly so this is secure */\n    return 1;\n}"
  },
  {
    "function_name": "vzConnectIsEncrypted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "890-894",
    "snippet": "static int vzConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Encryption is not relevant / applicable to way we talk to PCS */\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Encryption is not relevant / applicable to way we talk to PCS */\n    return 0;\n}"
  },
  {
    "function_name": "vzNodeGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "880-888",
    "snippet": "static int\nvzNodeGetInfo(virConnectPtr conn,\n              virNodeInfoPtr nodeinfo)\n{\n    if (virNodeGetInfoEnsureACL(conn) < 0)\n        return -1;\n\n    return virCapabilitiesGetNodeInfo(nodeinfo);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesGetNodeInfo",
          "args": [
            "nodeinfo"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesGetNodeInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1434-1456",
          "snippet": "int\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetInfoEnsureACL",
          "args": [
            "conn"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzNodeGetInfo(virConnectPtr conn,\n              virNodeInfoPtr nodeinfo)\n{\n    if (virNodeGetInfoEnsureACL(conn) < 0)\n        return -1;\n\n    return virCapabilitiesGetNodeInfo(nodeinfo);\n}"
  },
  {
    "function_name": "vzDomainDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "873-877",
    "snippet": "static virDomainPtr\nvzDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    return vzDomainDefineXMLFlags(conn, xml, 0);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainDefineXMLFlags",
          "args": [
            "conn",
            "xml",
            "0"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainDefineXMLFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "780-871",
          "snippet": "static virDomainPtr\nvzDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr retdom = NULL;\n    virDomainDefPtr def;\n    virDomainObjPtr dom = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    if ((def = virDomainDefParseString(xml, driver->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    dom = virDomainObjListFindByUUID(driver->domains, def->uuid);\n    if (dom == NULL) {\n        virResetLastError();\n        if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n            if (prlsdkCreateVm(driver, def))\n                goto cleanup;\n        } else if (def->os.type == VIR_DOMAIN_OSTYPE_EXE) {\n            if (prlsdkCreateCt(conn, def))\n                goto cleanup;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Unsupported OS type: %s\"),\n                           virDomainOSTypeToString(def->os.type));\n            goto cleanup;\n        }\n\n        if (!(dom = prlsdkAddDomainByUUID(driver, def->uuid)))\n            goto cleanup;\n    } else {\n        int state, reason;\n\n        state = virDomainObjGetState(dom, &reason);\n\n        if (state == VIR_DOMAIN_SHUTOFF &&\n            reason == VIR_DOMAIN_SHUTOFF_SAVED) {\n\n            /* PCS doesn't store domain config in managed save state file.\n             * It's forbidden to change config for VMs in this state.\n             * It's possible to change config for containers, but after\n             * restoring domain will have that new config, not a config,\n             * which domain had at the moment of virDomainManagedSave.\n             *\n             * So forbid this operation, if config is changed. If it's\n             * not changed - just do nothing. */\n\n            if (!virDomainDefCheckABIStability(dom->def, def, driver->xmlopt)) {\n                virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                               _(\"Can't change domain configuration \"\n                                 \"in managed save state\"));\n                goto cleanup;\n            }\n        } else {\n            if (vzDomainObjBeginJob(dom) < 0)\n                goto cleanup;\n            job = true;\n\n            if (vzEnsureDomainExists(dom) < 0)\n                goto cleanup;\n\n            if (prlsdkApplyConfig(driver, dom, def))\n                goto cleanup;\n\n            if (prlsdkUpdateDomain(driver, dom))\n                goto cleanup;\n        }\n    }\n\n    retdom = virGetDomain(conn, def->name, def->uuid, def->id);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    virDomainDefFree(def);\n    return retdom;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainPtr\nvzDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr retdom = NULL;\n    virDomainDefPtr def;\n    virDomainObjPtr dom = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    if ((def = virDomainDefParseString(xml, driver->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    dom = virDomainObjListFindByUUID(driver->domains, def->uuid);\n    if (dom == NULL) {\n        virResetLastError();\n        if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n            if (prlsdkCreateVm(driver, def))\n                goto cleanup;\n        } else if (def->os.type == VIR_DOMAIN_OSTYPE_EXE) {\n            if (prlsdkCreateCt(conn, def))\n                goto cleanup;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Unsupported OS type: %s\"),\n                           virDomainOSTypeToString(def->os.type));\n            goto cleanup;\n        }\n\n        if (!(dom = prlsdkAddDomainByUUID(driver, def->uuid)))\n            goto cleanup;\n    } else {\n        int state, reason;\n\n        state = virDomainObjGetState(dom, &reason);\n\n        if (state == VIR_DOMAIN_SHUTOFF &&\n            reason == VIR_DOMAIN_SHUTOFF_SAVED) {\n\n            /* PCS doesn't store domain config in managed save state file.\n             * It's forbidden to change config for VMs in this state.\n             * It's possible to change config for containers, but after\n             * restoring domain will have that new config, not a config,\n             * which domain had at the moment of virDomainManagedSave.\n             *\n             * So forbid this operation, if config is changed. If it's\n             * not changed - just do nothing. */\n\n            if (!virDomainDefCheckABIStability(dom->def, def, driver->xmlopt)) {\n                virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                               _(\"Can't change domain configuration \"\n                                 \"in managed save state\"));\n                goto cleanup;\n            }\n        } else {\n            if (vzDomainObjBeginJob(dom) < 0)\n                goto cleanup;\n            job = true;\n\n            if (vzEnsureDomainExists(dom) < 0)\n                goto cleanup;\n\n            if (prlsdkApplyConfig(driver, dom, def))\n                goto cleanup;\n\n            if (prlsdkUpdateDomain(driver, dom))\n                goto cleanup;\n        }\n    }\n\n    retdom = virGetDomain(conn, def->name, def->uuid, def->id);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    virDomainDefFree(def);\n    return retdom;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainPtr\nvzDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    return vzDomainDefineXMLFlags(conn, xml, 0);\n}"
  },
  {
    "function_name": "vzDomainDefineXMLFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "780-871",
    "snippet": "static virDomainPtr\nvzDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr retdom = NULL;\n    virDomainDefPtr def;\n    virDomainObjPtr dom = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    if ((def = virDomainDefParseString(xml, driver->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    dom = virDomainObjListFindByUUID(driver->domains, def->uuid);\n    if (dom == NULL) {\n        virResetLastError();\n        if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n            if (prlsdkCreateVm(driver, def))\n                goto cleanup;\n        } else if (def->os.type == VIR_DOMAIN_OSTYPE_EXE) {\n            if (prlsdkCreateCt(conn, def))\n                goto cleanup;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Unsupported OS type: %s\"),\n                           virDomainOSTypeToString(def->os.type));\n            goto cleanup;\n        }\n\n        if (!(dom = prlsdkAddDomainByUUID(driver, def->uuid)))\n            goto cleanup;\n    } else {\n        int state, reason;\n\n        state = virDomainObjGetState(dom, &reason);\n\n        if (state == VIR_DOMAIN_SHUTOFF &&\n            reason == VIR_DOMAIN_SHUTOFF_SAVED) {\n\n            /* PCS doesn't store domain config in managed save state file.\n             * It's forbidden to change config for VMs in this state.\n             * It's possible to change config for containers, but after\n             * restoring domain will have that new config, not a config,\n             * which domain had at the moment of virDomainManagedSave.\n             *\n             * So forbid this operation, if config is changed. If it's\n             * not changed - just do nothing. */\n\n            if (!virDomainDefCheckABIStability(dom->def, def, driver->xmlopt)) {\n                virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                               _(\"Can't change domain configuration \"\n                                 \"in managed save state\"));\n                goto cleanup;\n            }\n        } else {\n            if (vzDomainObjBeginJob(dom) < 0)\n                goto cleanup;\n            job = true;\n\n            if (vzEnsureDomainExists(dom) < 0)\n                goto cleanup;\n\n            if (prlsdkApplyConfig(driver, dom, def))\n                goto cleanup;\n\n            if (prlsdkUpdateDomain(driver, dom))\n                goto cleanup;\n        }\n    }\n\n    retdom = virGetDomain(conn, def->name, def->uuid, def->id);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    virDomainDefFree(def);\n    return retdom;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjEndJob",
          "args": [
            "dom"
          ],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "627-635",
          "snippet": "void\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvzDomainObjEndJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n\n    pdom->job.active = false;\n    pdom->job.cancelled = false;\n    virCondSignal(&pdom->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "def->name",
            "def->uuid",
            "def->id"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkUpdateDomain",
          "args": [
            "driver",
            "dom"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkUpdateDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2043-2054",
          "snippet": "int\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkUpdateDomain(vzDriverPtr driver, virDomainObjPtr dom)\n{\n    PRL_HANDLE job;\n    vzDomObjPtr pdom = dom->privateData;\n\n    job = PrlVm_RefreshConfig(pdom->sdkdom);\n    if (waitDomainJob(job, dom))\n        return -1;\n\n    return prlsdkLoadDomain(driver, pdom->sdkdom, dom) ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkApplyConfig",
          "args": [
            "driver",
            "dom",
            "def"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkApplyConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4014-4036",
          "snippet": "int\nprlsdkApplyConfig(vzDriverPtr driver,\n                  virDomainObjPtr dom,\n                  virDomainDefPtr new)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    int ret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    ret = prlsdkDoApplyConfig(driver, dom, privdom->sdkdom, new);\n\n    if (ret == 0) {\n        job = PrlVm_CommitEx(privdom->sdkdom, PVCF_DETACH_HDD_BUNDLE);\n        if (PRL_FAILED(waitDomainJob(job, dom)))\n            ret = -1;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkApplyConfig(vzDriverPtr driver,\n                  virDomainObjPtr dom,\n                  virDomainDefPtr new)\n{\n    vzDomObjPtr privdom = dom->privateData;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    int ret;\n\n    job = PrlVm_BeginEdit(privdom->sdkdom);\n    if (PRL_FAILED(waitDomainJob(job, dom)))\n        return -1;\n\n    ret = prlsdkDoApplyConfig(driver, dom, privdom->sdkdom, new);\n\n    if (ret == 0) {\n        job = PrlVm_CommitEx(privdom->sdkdom, PVCF_DETACH_HDD_BUNDLE);\n        if (PRL_FAILED(waitDomainJob(job, dom)))\n            ret = -1;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzEnsureDomainExists",
          "args": [
            "dom"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "vzEnsureDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "764-778",
          "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDomainObjBeginJob",
          "args": [
            "dom"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "591-625",
          "snippet": "int\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VZ_JOB_WAIT_TIME (1000 * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define VZ_JOB_WAIT_TIME (1000 * 30)\n\nint\nvzDomainObjBeginJob(virDomainObjPtr dom)\n{\n    vzDomObjPtr pdom = dom->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + VZ_JOB_WAIT_TIME;\n\n    while (pdom->job.active) {\n        if (virCondWaitUntil(&pdom->job.cond, &dom->parent.lock, then) < 0)\n            goto error;\n    }\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    pdom->job.active = true;\n    pdom->job.started = now;\n    pdom->job.elapsed = 0;\n    pdom->job.progress = 0;\n    pdom->job.hasProgress = false;\n    return 0;\n\n error:\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Can't change domain configuration \"\n                                 \"in managed save state\")"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Can't change domain configuration \"\n                                 \"in managed save state\""
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefCheckABIStability",
          "args": [
            "dom->def",
            "def",
            "driver->xmlopt"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefCheckABIStability",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "24133-24139",
          "snippet": "bool\nvirDomainDefCheckABIStability(virDomainDefPtr src,\n                              virDomainDefPtr dst,\n                              virDomainXMLOptionPtr xmlopt)\n{\n    return virDomainDefCheckABIStabilityFlags(src, dst, xmlopt, 0);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainDefCheckABIStability(virDomainDefPtr src,\n                              virDomainDefPtr dst,\n                              virDomainXMLOptionPtr xmlopt)\n{\n    return virDomainDefCheckABIStabilityFlags(src, dst, xmlopt, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "dom",
            "&reason"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkAddDomainByUUID",
          "args": [
            "driver",
            "def->uuid"
          ],
          "line": 822
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkAddDomainByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "2011-2025",
          "snippet": "virDomainObjPtr\nprlsdkAddDomainByUUID(vzDriverPtr driver, const unsigned char *uuid)\n{\n    PRL_HANDLE sdkdom;\n    virDomainObjPtr dom;\n\n    sdkdom = prlsdkSdkDomainLookupByUUID(driver, uuid);\n    if (sdkdom == PRL_INVALID_HANDLE)\n        return NULL;\n\n    dom = prlsdkLoadDomain(driver, sdkdom, NULL);\n\n    PrlHandle_Free(sdkdom);\n    return dom;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nprlsdkUUIDParse(const char *uuidstr, unsigned char *uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nprlsdkUUIDParse(const char *uuidstr, unsigned char *uuid);\n\nvirDomainObjPtr\nprlsdkAddDomainByUUID(vzDriverPtr driver, const unsigned char *uuid)\n{\n    PRL_HANDLE sdkdom;\n    virDomainObjPtr dom;\n\n    sdkdom = prlsdkSdkDomainLookupByUUID(driver, uuid);\n    if (sdkdom == PRL_INVALID_HANDLE)\n        return NULL;\n\n    dom = prlsdkLoadDomain(driver, sdkdom, NULL);\n\n    PrlHandle_Free(sdkdom);\n    return dom;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Unsupported OS type: %s\")",
            "virDomainOSTypeToString(def->os.type)"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainOSTypeToString",
          "args": [
            "def->os.type"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prlsdkCreateCt",
          "args": [
            "conn",
            "def"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkCreateCt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4124-4193",
          "snippet": "int\nprlsdkCreateCt(virConnectPtr conn, virDomainDefPtr def)\n{\n    PRL_HANDLE sdkdom = PRL_INVALID_HANDLE;\n    PRL_GET_VM_CONFIG_PARAM_DATA confParam;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    PRL_RESULT pret;\n    PRL_UINT32 flags;\n    vzConnPtr privconn = conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    int ret = -1;\n    int useTemplate = 0;\n    size_t i;\n\n    for (i = 0; i < def->nfss; i++) {\n        if (useTemplate) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Unsupported configuration\"));\n            return -1;\n        }\n        if (def->fss[i]->type == VIR_DOMAIN_FS_TYPE_TEMPLATE)\n            useTemplate = 1;\n        if (def->fss[i]->type == VIR_DOMAIN_FS_TYPE_VOLUME) {\n            if (virStorageTranslatePoolLocal(conn, def->fss[i]->src) < 0)\n                goto cleanup;\n        }\n\n    }\n\n    if (useTemplate && def->nfss > 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Unsupported configuration\"));\n        return -1;\n    }\n\n    confParam.nVmType = PVT_CT;\n    confParam.sConfigSample = \"vswap.1024MB\";\n    confParam.nOsVersion = 0;\n\n    job = PrlSrv_GetDefaultVmConfig(driver->server, &confParam, 0);\n    if (PRL_FAILED(getJobResult(job, &result)))\n        goto cleanup;\n\n    pret = PrlResult_GetParamByIndex(result, 0, &sdkdom);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    if (useTemplate) {\n        pret = PrlVmCfg_SetOsTemplate(sdkdom, def->fss[0]->src->path);\n        prlsdkCheckRetGoto(pret, cleanup);\n\n    }\n\n    if (prlsdkDoApplyConfig(driver, NULL, sdkdom, def) < 0)\n        goto cleanup;\n\n    flags = PACF_NON_INTERACTIVE_MODE;\n    if (!useTemplate)\n        flags |= PRNVM_PRESERVE_DISK;\n    job = PrlVm_RegEx(sdkdom, \"\", flags);\n    if (PRL_FAILED(waitJob(job)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    PrlHandle_Free(sdkdom);\n    PrlHandle_Free(result);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint\nprlsdkCreateCt(virConnectPtr conn, virDomainDefPtr def)\n{\n    PRL_HANDLE sdkdom = PRL_INVALID_HANDLE;\n    PRL_GET_VM_CONFIG_PARAM_DATA confParam;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    PRL_RESULT pret;\n    PRL_UINT32 flags;\n    vzConnPtr privconn = conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    int ret = -1;\n    int useTemplate = 0;\n    size_t i;\n\n    for (i = 0; i < def->nfss; i++) {\n        if (useTemplate) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Unsupported configuration\"));\n            return -1;\n        }\n        if (def->fss[i]->type == VIR_DOMAIN_FS_TYPE_TEMPLATE)\n            useTemplate = 1;\n        if (def->fss[i]->type == VIR_DOMAIN_FS_TYPE_VOLUME) {\n            if (virStorageTranslatePoolLocal(conn, def->fss[i]->src) < 0)\n                goto cleanup;\n        }\n\n    }\n\n    if (useTemplate && def->nfss > 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Unsupported configuration\"));\n        return -1;\n    }\n\n    confParam.nVmType = PVT_CT;\n    confParam.sConfigSample = \"vswap.1024MB\";\n    confParam.nOsVersion = 0;\n\n    job = PrlSrv_GetDefaultVmConfig(driver->server, &confParam, 0);\n    if (PRL_FAILED(getJobResult(job, &result)))\n        goto cleanup;\n\n    pret = PrlResult_GetParamByIndex(result, 0, &sdkdom);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    if (useTemplate) {\n        pret = PrlVmCfg_SetOsTemplate(sdkdom, def->fss[0]->src->path);\n        prlsdkCheckRetGoto(pret, cleanup);\n\n    }\n\n    if (prlsdkDoApplyConfig(driver, NULL, sdkdom, def) < 0)\n        goto cleanup;\n\n    flags = PACF_NON_INTERACTIVE_MODE;\n    if (!useTemplate)\n        flags |= PRNVM_PRESERVE_DISK;\n    job = PrlVm_RegEx(sdkdom, \"\", flags);\n    if (PRL_FAILED(waitJob(job)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    PrlHandle_Free(sdkdom);\n    PrlHandle_Free(result);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkCreateVm",
          "args": [
            "driver",
            "def"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkCreateVm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4038-4079",
          "snippet": "int\nprlsdkCreateVm(vzDriverPtr driver, virDomainDefPtr def)\n{\n    PRL_HANDLE sdkdom = PRL_INVALID_HANDLE;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    PRL_HANDLE srvconf = PRL_INVALID_HANDLE;\n    PRL_RESULT pret;\n    int ret = -1;\n\n    pret = PrlSrv_CreateVm(driver->server, &sdkdom);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    job = PrlSrv_GetSrvConfig(driver->server);\n    if (PRL_FAILED(getJobResult(job, &result)))\n        goto cleanup;\n\n    pret = PrlResult_GetParamByIndex(result, 0, &srvconf);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    pret = PrlVmCfg_SetDefaultConfig(sdkdom, srvconf, PVS_GUEST_VER_LIN_REDHAT, 0);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    pret = PrlVmCfg_SetOfflineManagementEnabled(sdkdom, 0);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    if (prlsdkDoApplyConfig(driver, NULL, sdkdom, def) < 0)\n        goto cleanup;\n\n    job = PrlVm_Reg(sdkdom, \"\", 1);\n    if (PRL_FAILED(waitJob(job)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    PrlHandle_Free(sdkdom);\n    PrlHandle_Free(srvconf);\n    PrlHandle_Free(result);\n\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint\nprlsdkCreateVm(vzDriverPtr driver, virDomainDefPtr def)\n{\n    PRL_HANDLE sdkdom = PRL_INVALID_HANDLE;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    PRL_HANDLE srvconf = PRL_INVALID_HANDLE;\n    PRL_RESULT pret;\n    int ret = -1;\n\n    pret = PrlSrv_CreateVm(driver->server, &sdkdom);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    job = PrlSrv_GetSrvConfig(driver->server);\n    if (PRL_FAILED(getJobResult(job, &result)))\n        goto cleanup;\n\n    pret = PrlResult_GetParamByIndex(result, 0, &srvconf);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    pret = PrlVmCfg_SetDefaultConfig(sdkdom, srvconf, PVS_GUEST_VER_LIN_REDHAT, 0);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    pret = PrlVmCfg_SetOfflineManagementEnabled(sdkdom, 0);\n    prlsdkCheckRetGoto(pret, cleanup);\n\n    if (prlsdkDoApplyConfig(driver, NULL, sdkdom, def) < 0)\n        goto cleanup;\n\n    job = PrlVm_Reg(sdkdom, \"\", 1);\n    if (PRL_FAILED(waitJob(job)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    PrlHandle_Free(sdkdom);\n    PrlHandle_Free(srvconf);\n    PrlHandle_Free(result);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByUUID",
          "args": [
            "driver->domains",
            "def->uuid"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "162-179",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefineXMLFlagsEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLCheckIllegalChars",
          "args": [
            "\"name\"",
            "def->name",
            "\"\\n\""
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLCheckIllegalChars",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "490-502",
          "snippet": "int\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "xml",
            "driver->xmlopt",
            "NULL",
            "parse_flags"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_DEFINE_VALIDATE",
            "NULL"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainPtr\nvzDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr retdom = NULL;\n    virDomainDefPtr def;\n    virDomainObjPtr dom = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n    vzDriverPtr driver = privconn->driver;\n    bool job = false;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    if ((def = virDomainDefParseString(xml, driver->xmlopt,\n                                       NULL, parse_flags)) == NULL)\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    dom = virDomainObjListFindByUUID(driver->domains, def->uuid);\n    if (dom == NULL) {\n        virResetLastError();\n        if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n            if (prlsdkCreateVm(driver, def))\n                goto cleanup;\n        } else if (def->os.type == VIR_DOMAIN_OSTYPE_EXE) {\n            if (prlsdkCreateCt(conn, def))\n                goto cleanup;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Unsupported OS type: %s\"),\n                           virDomainOSTypeToString(def->os.type));\n            goto cleanup;\n        }\n\n        if (!(dom = prlsdkAddDomainByUUID(driver, def->uuid)))\n            goto cleanup;\n    } else {\n        int state, reason;\n\n        state = virDomainObjGetState(dom, &reason);\n\n        if (state == VIR_DOMAIN_SHUTOFF &&\n            reason == VIR_DOMAIN_SHUTOFF_SAVED) {\n\n            /* PCS doesn't store domain config in managed save state file.\n             * It's forbidden to change config for VMs in this state.\n             * It's possible to change config for containers, but after\n             * restoring domain will have that new config, not a config,\n             * which domain had at the moment of virDomainManagedSave.\n             *\n             * So forbid this operation, if config is changed. If it's\n             * not changed - just do nothing. */\n\n            if (!virDomainDefCheckABIStability(dom->def, def, driver->xmlopt)) {\n                virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                               _(\"Can't change domain configuration \"\n                                 \"in managed save state\"));\n                goto cleanup;\n            }\n        } else {\n            if (vzDomainObjBeginJob(dom) < 0)\n                goto cleanup;\n            job = true;\n\n            if (vzEnsureDomainExists(dom) < 0)\n                goto cleanup;\n\n            if (prlsdkApplyConfig(driver, dom, def))\n                goto cleanup;\n\n            if (prlsdkUpdateDomain(driver, dom))\n                goto cleanup;\n        }\n    }\n\n    retdom = virGetDomain(conn, def->name, def->uuid, def->id);\n\n cleanup:\n    if (job)\n        vzDomainObjEndJob(dom);\n    virDomainObjEndAPI(&dom);\n    virDomainDefFree(def);\n    return retdom;\n}"
  },
  {
    "function_name": "vzEnsureDomainExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "764-778",
    "snippet": "static int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching uuid '%s' (%s)\")",
            "uuidstr",
            "dom->def->name"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching uuid '%s' (%s)\""
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "dom->def->uuid",
            "uuidstr"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzEnsureDomainExists(virDomainObjPtr dom)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!dom->removing)\n        return 0;\n\n    virUUIDFormat(dom->def->uuid, uuidstr);\n    virReportError(VIR_ERR_NO_DOMAIN,\n                   _(\"no domain with matching uuid '%s' (%s)\"),\n                   uuidstr, dom->def->name);\n\n    return -1;\n}"
  },
  {
    "function_name": "vzDomainGetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "744-762",
    "snippet": "static int\nvzDomainGetAutostart(virDomainPtr domain, int *autostart)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetAutostartEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    *autostart = dom->autostart;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetAutostartEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetAutostart(virDomainPtr domain, int *autostart)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetAutostartEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    *autostart = dom->autostart;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "717-742",
    "snippet": "static char *\nvzDomainGetXMLDesc(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    virDomainDefPtr def;\n    virDomainObjPtr dom;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_XML_COMMON_FLAGS, NULL);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainGetXMLDescEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    def = (flags & VIR_DOMAIN_XML_INACTIVE) &&\n        dom->newDef ? dom->newDef : dom->def;\n\n    ret = virDomainDefFormat(def, driver->xmlopt, flags);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormat",
          "args": [
            "def",
            "driver->xmlopt",
            "flags"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29496-29508",
          "snippet": "char *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)\n\nchar *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetXMLDescEnsureACL",
          "args": [
            "domain->conn",
            "dom->def",
            "flags"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_XML_COMMON_FLAGS",
            "NULL"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nvzDomainGetXMLDesc(virDomainPtr domain, unsigned int flags)\n{\n    vzConnPtr privconn = domain->conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    virDomainDefPtr def;\n    virDomainObjPtr dom;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_XML_COMMON_FLAGS, NULL);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainGetXMLDescEnsureACL(domain->conn, dom->def, flags) < 0)\n        goto cleanup;\n\n    def = (flags & VIR_DOMAIN_XML_INACTIVE) &&\n        dom->newDef ? dom->newDef : dom->def;\n\n    ret = virDomainDefFormat(def, driver->xmlopt, flags);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainGetState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "694-715",
    "snippet": "static int\nvzDomainGetState(virDomainPtr domain,\n                 int *state, int *reason, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetStateEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    *state = virDomainObjGetState(dom, reason);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "dom",
            "reason"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetStateEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetState(virDomainPtr domain,\n                 int *state, int *reason, unsigned int flags)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainGetStateEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    *state = virDomainObjGetState(dom, reason);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "675-692",
    "snippet": "static int\nvzDomainIsPersistent(virDomainPtr domain)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainIsPersistentEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = 1;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainIsPersistentEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainIsPersistent(virDomainPtr domain)\n{\n    virDomainObjPtr dom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return -1;\n\n    if (virDomainIsPersistentEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = 1;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainGetOSType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "656-673",
    "snippet": "static char *\nvzDomainGetOSType(virDomainPtr domain)\n{\n    virDomainObjPtr dom;\n    char *ret = NULL;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainGetOSTypeEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = g_strdup(virDomainOSTypeToString(dom->def->os.type));\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "virDomainOSTypeToString(dom->def->os.type)"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainOSTypeToString",
          "args": [
            "dom->def->os.type"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainGetOSTypeEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nvzDomainGetOSType(virDomainPtr domain)\n{\n    virDomainObjPtr dom;\n    char *ret = NULL;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        return NULL;\n\n    if (virDomainGetOSTypeEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = g_strdup(virDomainOSTypeToString(dom->def->os.type));\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "615-654",
    "snippet": "static int\nvzDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virDomainObjPtr dom;\n    vzDomObjPtr privdom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetInfoEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    info->state = virDomainObjGetState(dom, NULL);\n    info->memory = dom->def->mem.cur_balloon;\n    info->maxMem = virDomainDefGetMemoryTotal(dom->def);\n    info->nrVirtCpu = virDomainDefGetVcpus(dom->def);\n    info->cpuTime = 0;\n\n    privdom = dom->privateData;\n\n    if (PRL_INVALID_HANDLE != privdom->stats && virDomainObjIsActive(dom)) {\n        unsigned long long vtime;\n        size_t i;\n\n        for (i = 0; i < virDomainDefGetVcpus(dom->def); ++i) {\n            if (prlsdkGetVcpuStats(privdom->stats, i, &vtime) < 0) {\n                virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                               _(\"cannot read cputime for domain\"));\n                goto cleanup;\n            }\n            info->cpuTime += vtime;\n        }\n    }\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"cannot read cputime for domain\")"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot read cputime for domain\""
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkGetVcpuStats",
          "args": [
            "privdom->stats",
            "i",
            "&vtime"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkGetVcpuStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "4483-4499",
          "snippet": "int\nprlsdkGetVcpuStats(PRL_HANDLE sdkstats, int idx, unsigned long long *vtime)\n{\n    char *name = NULL;\n    long long ptime = 0;\n    int ret = -1;\n\n    name = g_strdup_printf(\"guest.vcpu%u.time\", (unsigned int)idx);\n    if (prlsdkExtractStatsParam(sdkstats, name, &ptime) < 0)\n        goto cleanup;\n    *vtime = ptime == -1 ? 0 : ptime;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nprlsdkGetVcpuStats(PRL_HANDLE sdkstats, int idx, unsigned long long *vtime)\n{\n    char *name = NULL;\n    long long ptime = 0;\n    int ret = -1;\n\n    name = g_strdup_printf(\"guest.vcpu%u.time\", (unsigned int)idx);\n    if (prlsdkExtractStatsParam(sdkstats, name, &ptime) < 0)\n        goto cleanup;\n    *vtime = ptime == -1 ? 0 : ptime;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpus",
          "args": [
            "dom->def"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1912-1924",
          "snippet": "unsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "dom"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "dom->def"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "dom",
            "NULL"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetInfoEnsureACL",
          "args": [
            "domain->conn",
            "dom->def"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzDomObjFromDomain",
          "args": [
            "domain"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "72-90",
          "snippet": "virDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirDomainObjPtr\nvzDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    vzConnPtr privconn = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    vzDriverPtr driver = privconn->driver;\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virDomainObjPtr dom;\n    vzDomObjPtr privdom;\n    int ret = -1;\n\n    if (!(dom = vzDomObjFromDomain(domain)))\n        goto cleanup;\n\n    if (virDomainGetInfoEnsureACL(domain->conn, dom->def) < 0)\n        goto cleanup;\n\n    info->state = virDomainObjGetState(dom, NULL);\n    info->memory = dom->def->mem.cur_balloon;\n    info->maxMem = virDomainDefGetMemoryTotal(dom->def);\n    info->nrVirtCpu = virDomainDefGetVcpus(dom->def);\n    info->cpuTime = 0;\n\n    privdom = dom->privateData;\n\n    if (PRL_INVALID_HANDLE != privdom->stats && virDomainObjIsActive(dom)) {\n        unsigned long long vtime;\n        size_t i;\n\n        for (i = 0; i < virDomainDefGetVcpus(dom->def); ++i) {\n            if (prlsdkGetVcpuStats(privdom->stats, i, &vtime) < 0) {\n                virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                               _(\"cannot read cputime for domain\"));\n                goto cleanup;\n            }\n            info->cpuTime += vtime;\n        }\n    }\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "590-613",
    "snippet": "static virDomainPtr\nvzDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr ret = NULL;\n    virDomainObjPtr dom;\n\n    dom = virDomainObjListFindByName(privconn->driver->domains, name);\n\n    if (dom == NULL) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), name);\n        return NULL;\n    }\n\n    if (virDomainLookupByNameEnsureACL(conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "dom->def->name",
            "dom->def->uuid",
            "dom->def->id"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByNameEnsureACL",
          "args": [
            "conn",
            "dom->def"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching name '%s'\")",
            "name"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching name '%s'\""
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByName",
          "args": [
            "privconn->driver->domains",
            "name"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "205-222",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainPtr\nvzDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr ret = NULL;\n    virDomainObjPtr dom;\n\n    dom = virDomainObjListFindByName(privconn->driver->domains, name);\n\n    if (dom == NULL) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching name '%s'\"), name);\n        return NULL;\n    }\n\n    if (virDomainLookupByNameEnsureACL(conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "563-588",
    "snippet": "static virDomainPtr\nvzDomainLookupByUUID(virConnectPtr conn, const unsigned char *uuid)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr ret = NULL;\n    virDomainObjPtr dom;\n\n    dom = virDomainObjListFindByUUID(privconn->driver->domains, uuid);\n\n    if (dom == NULL) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    if (virDomainLookupByUUIDEnsureACL(conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "dom->def->name",
            "dom->def->uuid",
            "dom->def->id"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByUUIDEnsureACL",
          "args": [
            "conn",
            "dom->def"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching uuid '%s'\")",
            "uuidstr"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching uuid '%s'\""
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByUUID",
          "args": [
            "privconn->driver->domains",
            "uuid"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "162-179",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainPtr\nvzDomainLookupByUUID(virConnectPtr conn, const unsigned char *uuid)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr ret = NULL;\n    virDomainObjPtr dom;\n\n    dom = virDomainObjListFindByUUID(privconn->driver->domains, uuid);\n\n    if (dom == NULL) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s'\"), uuidstr);\n        return NULL;\n    }\n\n    if (virDomainLookupByUUIDEnsureACL(conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzDomainLookupByID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "539-561",
    "snippet": "static virDomainPtr\nvzDomainLookupByID(virConnectPtr conn, int id)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr ret = NULL;\n    virDomainObjPtr dom;\n\n    dom = virDomainObjListFindByID(privconn->driver->domains, id);\n\n    if (dom == NULL) {\n        virReportError(VIR_ERR_NO_DOMAIN, NULL);\n        return NULL;\n    }\n\n    if (virDomainLookupByIDEnsureACL(conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "dom->def->name",
            "dom->def->uuid",
            "dom->def->id"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByIDEnsureACL",
          "args": [
            "conn",
            "dom->def"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "NULL"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByID",
          "args": [
            "privconn->driver->domains",
            "id"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "114-134",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByID(virDomainObjListPtr doms,\n                         int id)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virHashSearch(doms->objs, virDomainObjListSearchID, &id, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(doms);\n    if (obj) {\n        virObjectLock(obj);\n        if (obj->removing) {\n            virObjectUnlock(obj);\n            virObjectUnref(obj);\n            obj = NULL;\n        }\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByID(virDomainObjListPtr doms,\n                         int id)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virHashSearch(doms->objs, virDomainObjListSearchID, &id, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(doms);\n    if (obj) {\n        virObjectLock(obj);\n        if (obj->removing) {\n            virObjectUnlock(obj);\n            virObjectUnref(obj);\n            obj = NULL;\n        }\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virDomainPtr\nvzDomainLookupByID(virConnectPtr conn, int id)\n{\n    vzConnPtr privconn = conn->privateData;\n    virDomainPtr ret = NULL;\n    virDomainObjPtr dom;\n\n    dom = virDomainObjListFindByID(privconn->driver->domains, id);\n\n    if (dom == NULL) {\n        virReportError(VIR_ERR_NO_DOMAIN, NULL);\n        return NULL;\n    }\n\n    if (virDomainLookupByIDEnsureACL(conn, dom->def) < 0)\n        goto cleanup;\n\n    ret = virGetDomain(conn, dom->def->name, dom->def->uuid, dom->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&dom);\n    return ret;\n}"
  },
  {
    "function_name": "vzConnectListAllDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "523-537",
    "snippet": "static int\nvzConnectListAllDomains(virConnectPtr conn,\n                        virDomainPtr **domains,\n                        unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL, -1);\n\n    if (virConnectListAllDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListExport(privconn->driver->domains, conn, domains,\n                                  virConnectListAllDomainsCheckACL, flags);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListExport",
          "args": [
            "privconn->driver->domains",
            "conn",
            "domains",
            "virConnectListAllDomainsCheckACL",
            "flags"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListExport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "1060-1101",
          "snippet": "int\nvirDomainObjListExport(virDomainObjListPtr domlist,\n                       virConnectPtr conn,\n                       virDomainPtr **domains,\n                       virDomainObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virDomainObjPtr *vms = NULL;\n    virDomainPtr *doms = NULL;\n    size_t nvms = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virDomainObjListCollect(domlist, conn, &vms, &nvms, filter, flags) < 0)\n        return -1;\n\n    if (domains) {\n        if (VIR_ALLOC_N(doms, nvms + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nvms; i++) {\n            virDomainObjPtr vm = vms[i];\n\n            virObjectLock(vm);\n            doms[i] = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n            virObjectUnlock(vm);\n\n            if (!doms[i])\n                goto cleanup;\n        }\n\n        *domains = doms;\n        doms = NULL;\n    }\n\n    ret = nvms;\n\n cleanup:\n    virObjectListFree(doms);\n    virObjectListFreeCount(vms, nvms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListExport(virDomainObjListPtr domlist,\n                       virConnectPtr conn,\n                       virDomainPtr **domains,\n                       virDomainObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virDomainObjPtr *vms = NULL;\n    virDomainPtr *doms = NULL;\n    size_t nvms = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virDomainObjListCollect(domlist, conn, &vms, &nvms, filter, flags) < 0)\n        return -1;\n\n    if (domains) {\n        if (VIR_ALLOC_N(doms, nvms + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nvms; i++) {\n            virDomainObjPtr vm = vms[i];\n\n            virObjectLock(vm);\n            doms[i] = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n            virObjectUnlock(vm);\n\n            if (!doms[i])\n                goto cleanup;\n        }\n\n        *domains = doms;\n        doms = NULL;\n    }\n\n    ret = nvms;\n\n cleanup:\n    virObjectListFree(doms);\n    virObjectListFreeCount(vms, nvms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListAllDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL",
            "-1"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectListAllDomains(virConnectPtr conn,\n                        virDomainPtr **domains,\n                        unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL, -1);\n\n    if (virConnectListAllDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListExport(privconn->driver->domains, conn, domains,\n                                  virConnectListAllDomainsCheckACL, flags);\n}"
  },
  {
    "function_name": "vzConnectNumOfDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "510-521",
    "snippet": "static int\nvzConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectNumOfDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(privconn->driver->domains, false,\n                                        virConnectNumOfDefinedDomainsCheckACL,\n                                        conn);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListNumOfDomains",
          "args": [
            "privconn->driver->domains",
            "false",
            "virConnectNumOfDefinedDomainsCheckACL",
            "conn"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNumOfDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "674-685",
          "snippet": "int\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfDefinedDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectNumOfDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(privconn->driver->domains, false,\n                                        virConnectNumOfDefinedDomainsCheckACL,\n                                        conn);\n}"
  },
  {
    "function_name": "vzConnectListDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "495-508",
    "snippet": "static int\nvzConnectListDefinedDomains(virConnectPtr conn, char **const names, int maxnames)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectListDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    memset(names, 0, sizeof(*names) * maxnames);\n    return virDomainObjListGetInactiveNames(privconn->driver->domains, names,\n                                            maxnames,\n                                            virConnectListDefinedDomainsCheckACL,\n                                            conn);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListGetInactiveNames",
          "args": [
            "privconn->driver->domains",
            "names",
            "maxnames",
            "virConnectListDefinedDomainsCheckACL",
            "conn"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListGetInactiveNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "768-788",
          "snippet": "int\nvirDomainObjListGetInactiveNames(virDomainObjListPtr doms,\n                                 char **const names,\n                                 int maxnames,\n                                 virDomainObjListACLFilter filter,\n                                 virConnectPtr conn)\n{\n    struct virDomainNameData data = { filter, conn,\n                                      0, 0, maxnames, names };\n    size_t i;\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyInactiveNames, &data);\n    virObjectRWUnlock(doms);\n    if (data.oom) {\n        for (i = 0; i < data.numnames; i++)\n            VIR_FREE(data.names[i]);\n        return -1;\n    }\n\n    return data.numnames;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListGetInactiveNames(virDomainObjListPtr doms,\n                                 char **const names,\n                                 int maxnames,\n                                 virDomainObjListACLFilter filter,\n                                 virConnectPtr conn)\n{\n    struct virDomainNameData data = { filter, conn,\n                                      0, 0, maxnames, names };\n    size_t i;\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyInactiveNames, &data);\n    virObjectRWUnlock(doms);\n    if (data.oom) {\n        for (i = 0; i < data.numnames; i++)\n            VIR_FREE(data.names[i]);\n        return -1;\n    }\n\n    return data.numnames;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "names",
            "0",
            "sizeof(*names) * maxnames"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectListDefinedDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectListDefinedDomains(virConnectPtr conn, char **const names, int maxnames)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectListDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    memset(names, 0, sizeof(*names) * maxnames);\n    return virDomainObjListGetInactiveNames(privconn->driver->domains, names,\n                                            maxnames,\n                                            virConnectListDefinedDomainsCheckACL,\n                                            conn);\n}"
  },
  {
    "function_name": "vzConnectNumOfDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "483-493",
    "snippet": "static int\nvzConnectNumOfDomains(virConnectPtr conn)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectNumOfDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(privconn->driver->domains, true,\n                                        virConnectNumOfDomainsCheckACL, conn);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListNumOfDomains",
          "args": [
            "privconn->driver->domains",
            "true",
            "virConnectNumOfDomainsCheckACL",
            "conn"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNumOfDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "674-685",
          "snippet": "int\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectNumOfDomains(virConnectPtr conn)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectNumOfDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(privconn->driver->domains, true,\n                                        virConnectNumOfDomainsCheckACL, conn);\n}"
  },
  {
    "function_name": "vzConnectListDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "470-481",
    "snippet": "static int\nvzConnectListDomains(virConnectPtr conn, int *ids, int maxids)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectListDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListGetActiveIDs(privconn->driver->domains, ids,\n                                        maxids, virConnectListDomainsCheckACL,\n                                        conn);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListGetActiveIDs",
          "args": [
            "privconn->driver->domains",
            "ids",
            "maxids",
            "virConnectListDomainsCheckACL",
            "conn"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListGetActiveIDs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "716-729",
          "snippet": "int\nvirDomainObjListGetActiveIDs(virDomainObjListPtr doms,\n                             int *ids,\n                             int maxids,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainIDData data = { filter, conn,\n                                    0, maxids, ids };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyActiveIDs, &data);\n    virObjectRWUnlock(doms);\n    return data.numids;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListGetActiveIDs(virDomainObjListPtr doms,\n                             int *ids,\n                             int maxids,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainIDData data = { filter, conn,\n                                    0, maxids, ids };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyActiveIDs, &data);\n    virObjectRWUnlock(doms);\n    return data.numids;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectListDomains(virConnectPtr conn, int *ids, int maxids)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectListDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListGetActiveIDs(privconn->driver->domains, ids,\n                                        maxids, virConnectListDomainsCheckACL,\n                                        conn);\n}"
  },
  {
    "function_name": "vzConnectGetSysinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "446-468",
    "snippet": "static char *\nvzConnectGetSysinfo(virConnectPtr conn, unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectGetSysinfoEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!driver->hostsysinfo) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Host SMBIOS information is not available\"));\n        return NULL;\n    }\n\n    if (virSysinfoFormat(&buf, driver->hostsysinfo) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoFormat",
          "args": [
            "&buf",
            "driver->hostsysinfo"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1446-1474",
          "snippet": "int\nvirSysinfoFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    virBuffer attrBuf = VIR_BUFFER_INITIALIZER;\n    virBuffer childrenBuf = VIR_BUFFER_INIT_CHILD(buf);\n    const char *type = virSysinfoTypeToString(def->type);\n\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected sysinfo type model %d\"),\n                       def->type);\n        virBufferFreeAndReset(buf);\n        return -1;\n    }\n\n    virSysinfoBIOSFormat(&childrenBuf, def->bios);\n    virSysinfoSystemFormat(&childrenBuf, def->system);\n    virSysinfoBaseBoardFormat(&childrenBuf, def->baseBoard, def->nbaseBoard);\n    virSysinfoChassisFormat(&childrenBuf, def->chassis);\n    virSysinfoProcessorFormat(&childrenBuf, def);\n    virSysinfoMemoryFormat(&childrenBuf, def);\n    virSysinfoOEMStringsFormat(&childrenBuf, def->oemStrings);\n\n    virBufferAsprintf(&attrBuf, \" type='%s'\", type);\n\n    virXMLFormatElement(buf, \"sysinfo\", &attrBuf, &childrenBuf);\n\n    return 0;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSysinfoFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    virBuffer attrBuf = VIR_BUFFER_INITIALIZER;\n    virBuffer childrenBuf = VIR_BUFFER_INIT_CHILD(buf);\n    const char *type = virSysinfoTypeToString(def->type);\n\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected sysinfo type model %d\"),\n                       def->type);\n        virBufferFreeAndReset(buf);\n        return -1;\n    }\n\n    virSysinfoBIOSFormat(&childrenBuf, def->bios);\n    virSysinfoSystemFormat(&childrenBuf, def->system);\n    virSysinfoBaseBoardFormat(&childrenBuf, def->baseBoard, def->nbaseBoard);\n    virSysinfoChassisFormat(&childrenBuf, def->chassis);\n    virSysinfoProcessorFormat(&childrenBuf, def);\n    virSysinfoMemoryFormat(&childrenBuf, def);\n    virSysinfoOEMStringsFormat(&childrenBuf, def->oemStrings);\n\n    virBufferAsprintf(&attrBuf, \" type='%s'\", type);\n\n    virXMLFormatElement(buf, \"sysinfo\", &attrBuf, &childrenBuf);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Host SMBIOS information is not available\")"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Host SMBIOS information is not available\""
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetSysinfoEnsureACL",
          "args": [
            "conn"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nvzConnectGetSysinfo(virConnectPtr conn, unsigned int flags)\n{\n    vzConnPtr privconn = conn->privateData;\n    vzDriverPtr driver = privconn->driver;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectGetSysinfoEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!driver->hostsysinfo) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Host SMBIOS information is not available\"));\n        return NULL;\n    }\n\n    if (virSysinfoFormat(&buf, driver->hostsysinfo) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "vzConnectGetHostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "438-444",
    "snippet": "static char *vzConnectGetHostname(virConnectPtr conn)\n{\n    if (virConnectGetHostnameEnsureACL(conn) < 0)\n        return NULL;\n\n    return virGetHostname();\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetHostname",
          "args": [],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostnameQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "560-564",
          "snippet": "char *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetHostnameEnsureACL",
          "args": [
            "conn"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *vzConnectGetHostname(virConnectPtr conn)\n{\n    if (virConnectGetHostnameEnsureACL(conn) < 0)\n        return NULL;\n\n    return virGetHostname();\n}"
  },
  {
    "function_name": "vzConnectGetVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "425-435",
    "snippet": "static int\nvzConnectGetVersion(virConnectPtr conn, unsigned long *hvVer)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectGetVersionEnsureACL(conn) < 0)\n        return -1;\n\n    *hvVer = privconn->driver->vzVersion;\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectGetVersionEnsureACL",
          "args": [
            "conn"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzConnectGetVersion(virConnectPtr conn, unsigned long *hvVer)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectGetVersionEnsureACL(conn) < 0)\n        return -1;\n\n    *hvVer = privconn->driver->vzVersion;\n    return 0;\n}"
  },
  {
    "function_name": "vzConnectClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "399-423",
    "snippet": "static int\nvzConnectClose(virConnectPtr conn)\n{\n    vzConnPtr curr, *prev = &vz_conn_list;\n    vzConnPtr privconn = conn->privateData;\n\n    if (!privconn)\n        return 0;\n\n    virMutexLock(&vz_driver_lock);\n    for (curr = vz_conn_list; curr; prev = &curr->next, curr = curr->next) {\n        if (curr == privconn) {\n            *prev = curr->next;\n            break;\n        }\n    }\n\n    virMutexUnlock(&vz_driver_lock);\n\n    virObjectUnref(privconn->closeCallback);\n    virObjectUnref(privconn->driver);\n    VIR_FREE(privconn);\n    conn->privateData = NULL;\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virMutex vz_driver_lock;",
      "static vzConnPtr vz_conn_list;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "privconn"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "privconn->driver"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virMutex vz_driver_lock;\nstatic vzConnPtr vz_conn_list;\n\nstatic int\nvzConnectClose(virConnectPtr conn)\n{\n    vzConnPtr curr, *prev = &vz_conn_list;\n    vzConnPtr privconn = conn->privateData;\n\n    if (!privconn)\n        return 0;\n\n    virMutexLock(&vz_driver_lock);\n    for (curr = vz_conn_list; curr; prev = &curr->next, curr = curr->next) {\n        if (curr == privconn) {\n            *prev = curr->next;\n            break;\n        }\n    }\n\n    virMutexUnlock(&vz_driver_lock);\n\n    virObjectUnref(privconn->closeCallback);\n    virObjectUnref(privconn->driver);\n    VIR_FREE(privconn);\n    conn->privateData = NULL;\n    return 0;\n}"
  },
  {
    "function_name": "vzConnectOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "350-397",
    "snippet": "static virDrvOpenStatus\nvzConnectOpen(virConnectPtr conn,\n              virConnectAuthPtr auth G_GNUC_UNUSED,\n              virConfPtr conf G_GNUC_UNUSED,\n              unsigned int flags)\n{\n    vzDriverPtr driver = NULL;\n    vzConnPtr privconn = NULL;\n\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    /* From this point on, the connection is for us. */\n    if (STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unexpected Virtuozzo URI path '%s', try vz:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    if (!(driver = vzGetDriverConnection()))\n        return VIR_DRV_OPEN_ERROR;\n\n    if (VIR_ALLOC(privconn) < 0)\n        goto error;\n\n    conn->privateData = privconn;\n    privconn->driver = driver;\n\n    if (!(privconn->closeCallback = virNewConnectCloseCallbackData()))\n        goto error;\n\n    virMutexLock(&vz_driver_lock);\n    privconn->next = vz_conn_list;\n    vz_conn_list = privconn;\n    virMutexUnlock(&vz_driver_lock);\n\n    return VIR_DRV_OPEN_SUCCESS;\n\n error:\n\n    conn->privateData = NULL;\n    virObjectUnref(driver);\n    VIR_FREE(privconn);\n    return VIR_DRV_OPEN_ERROR;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virMutex vz_driver_lock;",
      "static vzConnPtr vz_conn_list;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "privconn"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "driver"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNewConnectCloseCallbackData",
          "args": [],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "virNewConnectCloseCallbackData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "181-188",
          "snippet": "virConnectCloseCallbackDataPtr\nvirNewConnectCloseCallbackData(void)\n{\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableNew(virConnectCloseCallbackDataClass);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virConnectCloseCallbackDataClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virConnectCloseCallbackDataClass;\n\nvirConnectCloseCallbackDataPtr\nvirNewConnectCloseCallbackData(void)\n{\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableNew(virConnectCloseCallbackDataClass);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "privconn"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vzGetDriverConnection",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "vzGetDriverConnection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "172-187",
          "snippet": "vzDriverPtr\nvzGetDriverConnection(void)\n{\n    if (!vz_driver_privileged) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"vz state driver is not active\"));\n        return NULL;\n    }\n    virMutexLock(&vz_driver_lock);\n    if (!vz_driver)\n        vz_driver = vzDriverObjNew();\n    virObjectRef(vz_driver);\n    virMutexUnlock(&vz_driver_lock);\n\n    return vz_driver;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool vz_driver_privileged;",
            "static virMutex vz_driver_lock;",
            "static vzDriverPtr vz_driver;",
            "static vzDriverPtr\nvzDriverObjNew(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool vz_driver_privileged;\nstatic virMutex vz_driver_lock;\nstatic vzDriverPtr vz_driver;\nstatic vzDriverPtr\nvzDriverObjNew(void);\n\nvzDriverPtr\nvzGetDriverConnection(void)\n{\n    if (!vz_driver_privileged) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"vz state driver is not active\"));\n        return NULL;\n    }\n    virMutexLock(&vz_driver_lock);\n    if (!vz_driver)\n        vz_driver = vzDriverObjNew();\n    virObjectRef(vz_driver);\n    virMutexUnlock(&vz_driver_lock);\n\n    return vz_driver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectOpenEnsureACL",
          "args": [
            "conn"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unexpected Virtuozzo URI path '%s', try vz:///system\")",
            "conn->uri->path"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unexpected Virtuozzo URI path '%s', try vz:///system\""
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "conn->uri->path",
            "\"/system\""
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_RO",
            "VIR_DRV_OPEN_ERROR"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virMutex vz_driver_lock;\nstatic vzConnPtr vz_conn_list;\n\nstatic virDrvOpenStatus\nvzConnectOpen(virConnectPtr conn,\n              virConnectAuthPtr auth G_GNUC_UNUSED,\n              virConfPtr conf G_GNUC_UNUSED,\n              unsigned int flags)\n{\n    vzDriverPtr driver = NULL;\n    vzConnPtr privconn = NULL;\n\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    /* From this point on, the connection is for us. */\n    if (STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unexpected Virtuozzo URI path '%s', try vz:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    if (!(driver = vzGetDriverConnection()))\n        return VIR_DRV_OPEN_ERROR;\n\n    if (VIR_ALLOC(privconn) < 0)\n        goto error;\n\n    conn->privateData = privconn;\n    privconn->driver = driver;\n\n    if (!(privconn->closeCallback = virNewConnectCloseCallbackData()))\n        goto error;\n\n    virMutexLock(&vz_driver_lock);\n    privconn->next = vz_conn_list;\n    vz_conn_list = privconn;\n    virMutexUnlock(&vz_driver_lock);\n\n    return VIR_DRV_OPEN_SUCCESS;\n\n error:\n\n    conn->privateData = NULL;\n    virObjectUnref(driver);\n    VIR_FREE(privconn);\n    return VIR_DRV_OPEN_ERROR;\n}"
  },
  {
    "function_name": "vzDriverObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "315-348",
    "snippet": "static vzDriverPtr\nvzDriverObjNew(void)\n{\n    vzDriverPtr driver;\n\n    if (vzDriverInitialize() < 0)\n        return NULL;\n\n    if (!(driver = virObjectLockableNew(vzDriverClass)))\n        return NULL;\n\n    vzDomainDefParserConfig.priv = driver;\n\n    if (!(driver->caps = vzBuildCapabilities()) ||\n        !(driver->xmlopt = virDomainXMLOptionNew(&vzDomainDefParserConfig,\n                                                 &vzDomainXMLPrivateDataCallbacksPtr,\n                                                 NULL, NULL, NULL)) ||\n        !(driver->domains = virDomainObjListNew()) ||\n        !(driver->domainEventState = virObjectEventStateNew()) ||\n        (vzInitVersion(driver) < 0) ||\n        (prlsdkConnect(driver) < 0)) {\n        virObjectUnref(driver);\n        return NULL;\n    }\n\n    driver->hostsysinfo = virSysinfoRead();\n    ignore_value(prlsdkLoadDomains(driver));\n\n    /* As far as waitDomainJob finally calls virReportErrorHelper\n     * and we are not going to report it, reset it explicitly */\n    virResetLastError();\n\n    return driver;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr vzDriverClass;",
      "static vzDriverPtr\nvzDriverObjNew(void);",
      "static virDomainXMLPrivateDataCallbacks vzDomainXMLPrivateDataCallbacksPtr = {\n    .alloc = vzDomObjAlloc,\n    .free = vzDomObjFree,\n};",
      "static virDomainDefParserConfig vzDomainDefParserConfig = {\n    .macPrefix = {0x42, 0x1C, 0x00},\n    .domainPostParseCallback = vzDomainDefPostParse,\n    .devicesPostParseCallback = vzDomainDeviceDefPostParse,\n    .domainValidateCallback = vzDomainDefValidate,\n    .deviceValidateCallback = vzDomainDeviceDefValidate,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "prlsdkLoadDomains(driver)"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prlsdkLoadDomains",
          "args": [
            "driver"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkLoadDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "1972-2009",
          "snippet": "int\nprlsdkLoadDomains(vzDriverPtr driver)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE result;\n    PRL_HANDLE sdkdom = PRL_INVALID_HANDLE;\n    PRL_UINT32 paramsCount;\n    PRL_RESULT pret;\n    size_t i = 0;\n    virDomainObjPtr dom;\n\n    job = PrlSrv_GetVmListEx(driver->server, PVTF_VM | PVTF_CT);\n\n    if (PRL_FAILED(getJobResult(job, &result)))\n        return -1;\n\n    pret = PrlResult_GetParamsCount(result, &paramsCount);\n    prlsdkCheckRetGoto(pret, error);\n\n    for (i = 0; i < paramsCount; i++) {\n        pret = PrlResult_GetParamByIndex(result, i, &sdkdom);\n        prlsdkCheckRetGoto(pret, error);\n\n        dom = prlsdkLoadDomain(driver, sdkdom, NULL);\n        virDomainObjEndAPI(&dom);\n\n        PrlHandle_Free(sdkdom);\n        sdkdom = PRL_INVALID_HANDLE;\n    }\n\n    PrlHandle_Free(result);\n    return 0;\n\n error:\n    PrlHandle_Free(sdkdom);\n    PrlHandle_Free(result);\n    return -1;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint\nprlsdkLoadDomains(vzDriverPtr driver)\n{\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE result;\n    PRL_HANDLE sdkdom = PRL_INVALID_HANDLE;\n    PRL_UINT32 paramsCount;\n    PRL_RESULT pret;\n    size_t i = 0;\n    virDomainObjPtr dom;\n\n    job = PrlSrv_GetVmListEx(driver->server, PVTF_VM | PVTF_CT);\n\n    if (PRL_FAILED(getJobResult(job, &result)))\n        return -1;\n\n    pret = PrlResult_GetParamsCount(result, &paramsCount);\n    prlsdkCheckRetGoto(pret, error);\n\n    for (i = 0; i < paramsCount; i++) {\n        pret = PrlResult_GetParamByIndex(result, i, &sdkdom);\n        prlsdkCheckRetGoto(pret, error);\n\n        dom = prlsdkLoadDomain(driver, sdkdom, NULL);\n        virDomainObjEndAPI(&dom);\n\n        PrlHandle_Free(sdkdom);\n        sdkdom = PRL_INVALID_HANDLE;\n    }\n\n    PrlHandle_Free(result);\n    return 0;\n\n error:\n    PrlHandle_Free(sdkdom);\n    PrlHandle_Free(result);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoRead",
          "args": [],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1188-1211",
          "snippet": "virSysinfoDefPtr\nvirSysinfoRead(void)\n{\n#if defined(__powerpc__)\n    return virSysinfoReadPPC();\n#elif defined(__arm__) || defined(__aarch64__)\n    return virSysinfoReadARM();\n#elif defined(__s390__) || defined(__s390x__)\n    return virSysinfoReadS390();\n#elif !defined(WIN32) && \\\n    (defined(__x86_64__) || \\\n     defined(__i386__) || \\\n     defined(__amd64__))\n    return virSysinfoReadDMI();\n#else /* WIN32 || not supported arch */\n    /*\n     * this can probably be extracted from Windows using API or registry\n     * http://www.microsoft.com/whdc/system/platform/firmware/SMBIOS.mspx\n     */\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Host sysinfo extraction not supported on this platform\"));\n    return NULL;\n#endif /* WIN32 || not supported arch */\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirSysinfoDefPtr\nvirSysinfoRead(void)\n{\n#if defined(__powerpc__)\n    return virSysinfoReadPPC();\n#elif defined(__arm__) || defined(__aarch64__)\n    return virSysinfoReadARM();\n#elif defined(__s390__) || defined(__s390x__)\n    return virSysinfoReadS390();\n#elif !defined(WIN32) && \\\n    (defined(__x86_64__) || \\\n     defined(__i386__) || \\\n     defined(__amd64__))\n    return virSysinfoReadDMI();\n#else /* WIN32 || not supported arch */\n    /*\n     * this can probably be extracted from Windows using API or registry\n     * http://www.microsoft.com/whdc/system/platform/firmware/SMBIOS.mspx\n     */\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Host sysinfo extraction not supported on this platform\"));\n    return NULL;\n#endif /* WIN32 || not supported arch */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "driver"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkConnect",
          "args": [
            "driver"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkConnect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "353-403",
          "snippet": "int\nprlsdkConnect(vzDriverPtr driver)\n{\n    int ret = -1;\n    PRL_RESULT pret;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    PRL_HANDLE response = PRL_INVALID_HANDLE;\n    char session_uuid[VIR_UUID_STRING_BRACED_BUFLEN];\n\n    pret = PrlSrv_Create(&driver->server);\n    prlsdkCheckRetExit(pret, -1);\n\n    job = PrlSrv_LoginLocalEx(driver->server, NULL, 0,\n                              PSL_HIGH_SECURITY, PACF_NON_INTERACTIVE_MODE);\n    if (PRL_FAILED(getJobResult(job, &result)))\n        goto destroy;\n\n    pret = PrlResult_GetParam(result, &response);\n    prlsdkCheckRetGoto(pret, logoff);\n\n    pret = prlsdkGetStringParamBuf(PrlLoginResponse_GetSessionUuid,\n                                   response, session_uuid, sizeof(session_uuid));\n    prlsdkCheckRetGoto(pret, logoff);\n\n    if (prlsdkUUIDParse(session_uuid, driver->session_uuid) < 0)\n        goto logoff;\n\n    pret = PrlSrv_RegEventHandler(driver->server,\n                                  prlsdkEventsHandler,\n                                  driver);\n    prlsdkCheckRetGoto(pret, logoff);\n\n    ret = 0;\n\n cleanup:\n    PrlHandle_Free(result);\n    PrlHandle_Free(response);\n\n    return ret;\n\n logoff:\n    job = PrlSrv_Logoff(driver->server);\n    waitJob(job);\n\n destroy:\n    PrlHandle_Free(driver->server);\n    driver->server = PRL_INVALID_HANDLE;\n\n    goto cleanup;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void\nprlsdkConvertError(PRL_RESULT pret);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nprlsdkConvertError(PRL_RESULT pret);\n\nint\nprlsdkConnect(vzDriverPtr driver)\n{\n    int ret = -1;\n    PRL_RESULT pret;\n    PRL_HANDLE job = PRL_INVALID_HANDLE;\n    PRL_HANDLE result = PRL_INVALID_HANDLE;\n    PRL_HANDLE response = PRL_INVALID_HANDLE;\n    char session_uuid[VIR_UUID_STRING_BRACED_BUFLEN];\n\n    pret = PrlSrv_Create(&driver->server);\n    prlsdkCheckRetExit(pret, -1);\n\n    job = PrlSrv_LoginLocalEx(driver->server, NULL, 0,\n                              PSL_HIGH_SECURITY, PACF_NON_INTERACTIVE_MODE);\n    if (PRL_FAILED(getJobResult(job, &result)))\n        goto destroy;\n\n    pret = PrlResult_GetParam(result, &response);\n    prlsdkCheckRetGoto(pret, logoff);\n\n    pret = prlsdkGetStringParamBuf(PrlLoginResponse_GetSessionUuid,\n                                   response, session_uuid, sizeof(session_uuid));\n    prlsdkCheckRetGoto(pret, logoff);\n\n    if (prlsdkUUIDParse(session_uuid, driver->session_uuid) < 0)\n        goto logoff;\n\n    pret = PrlSrv_RegEventHandler(driver->server,\n                                  prlsdkEventsHandler,\n                                  driver);\n    prlsdkCheckRetGoto(pret, logoff);\n\n    ret = 0;\n\n cleanup:\n    PrlHandle_Free(result);\n    PrlHandle_Free(response);\n\n    return ret;\n\n logoff:\n    job = PrlSrv_Logoff(driver->server);\n    waitJob(job);\n\n destroy:\n    PrlHandle_Free(driver->server);\n    driver->server = PRL_INVALID_HANDLE;\n\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzInitVersion",
          "args": [
            "driver"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "vzInitVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "152-197",
          "snippet": "int\nvzInitVersion(vzDriverPtr driver)\n{\n    char *output, *sVer, *tmp;\n    const char *searchStr = \"prlsrvctl version \";\n    int ret = -1;\n\n    output = vzGetOutput(PRLSRVCTL, \"--help\", NULL);\n\n    if (!output) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    if (!(sVer = strstr(output, searchStr))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    sVer = sVer + strlen(searchStr);\n\n    /* parallels server has versions number like 6.0.17977.782218 or 7.0.0,\n     * In libvirt we handle only first two numbers. */\n    if (!(tmp = strchr(sVer, '.'))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    if (!(tmp = strchr(tmp + 1, '.'))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    tmp[0] = '\\0';\n    if (virParseVersionString(sVer, &(driver->vzVersion), true) < 0) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    vzInitCaps(driver->vzVersion, &driver->vzCaps);\n    ret = 0;\n\n cleanup:\n    VIR_FREE(output);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PRLSRVCTL \"prlsrvctl\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\n#define PRLSRVCTL \"prlsrvctl\"\n\nint\nvzInitVersion(vzDriverPtr driver)\n{\n    char *output, *sVer, *tmp;\n    const char *searchStr = \"prlsrvctl version \";\n    int ret = -1;\n\n    output = vzGetOutput(PRLSRVCTL, \"--help\", NULL);\n\n    if (!output) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    if (!(sVer = strstr(output, searchStr))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    sVer = sVer + strlen(searchStr);\n\n    /* parallels server has versions number like 6.0.17977.782218 or 7.0.0,\n     * In libvirt we handle only first two numbers. */\n    if (!(tmp = strchr(sVer, '.'))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    if (!(tmp = strchr(tmp + 1, '.'))) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    tmp[0] = '\\0';\n    if (virParseVersionString(sVer, &(driver->vzVersion), true) < 0) {\n        vzParseError();\n        goto cleanup;\n    }\n\n    vzInitCaps(driver->vzVersion, &driver->vzCaps);\n    ret = 0;\n\n cleanup:\n    VIR_FREE(output);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateNew",
          "args": [],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "558-582",
          "snippet": "virObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventStateClass;",
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventStateClass;\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvirObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListNew",
          "args": [],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "68-85",
          "snippet": "virDomainObjListPtr virDomainObjListNew(void)\n{\n    virDomainObjListPtr doms;\n\n    if (virDomainObjListInitialize() < 0)\n        return NULL;\n\n    if (!(doms = virObjectRWLockableNew(virDomainObjListClass)))\n        return NULL;\n\n    if (!(doms->objs = virHashCreate(50, virObjectFreeHashData)) ||\n        !(doms->objsName = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(doms);\n        return NULL;\n    }\n\n    return doms;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainObjListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainObjListClass;\n\nvirDomainObjListPtr virDomainObjListNew(void)\n{\n    virDomainObjListPtr doms;\n\n    if (virDomainObjListInitialize() < 0)\n        return NULL;\n\n    if (!(doms = virObjectRWLockableNew(virDomainObjListClass)))\n        return NULL;\n\n    if (!(doms->objs = virHashCreate(50, virObjectFreeHashData)) ||\n        !(doms->objsName = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(doms);\n        return NULL;\n    }\n\n    return doms;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainXMLOptionNew",
          "args": [
            "&vzDomainDefParserConfig",
            "&vzDomainXMLPrivateDataCallbacksPtr",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainXMLOptionNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1415-1458",
          "snippet": "virDomainXMLOptionPtr\nvirDomainXMLOptionNew(virDomainDefParserConfigPtr config,\n                      virDomainXMLPrivateDataCallbacksPtr priv,\n                      virXMLNamespacePtr xmlns,\n                      virDomainABIStabilityPtr abi,\n                      virSaveCookieCallbacksPtr saveCookie)\n{\n    virDomainXMLOptionPtr xmlopt;\n\n    if (virDomainObjInitialize() < 0)\n        return NULL;\n\n    if (!(xmlopt = virObjectNew(virDomainXMLOptionClass)))\n        return NULL;\n\n    if (priv)\n        xmlopt->privateData = *priv;\n\n    if (config)\n        xmlopt->config = *config;\n\n    if (xmlns)\n        xmlopt->ns = *xmlns;\n\n    if (abi)\n        xmlopt->abi = *abi;\n\n    if (saveCookie)\n        xmlopt->saveCookie = *saveCookie;\n\n    /* Technically this forbids to use one of Xerox's MAC address prefixes in\n     * our hypervisor drivers. This shouldn't ever be a problem.\n     *\n     * Use the KVM prefix as default as it's in the privately administered\n     * range */\n    if (xmlopt->config.macPrefix[0] == 0 &&\n        xmlopt->config.macPrefix[1] == 0 &&\n        xmlopt->config.macPrefix[2] == 0) {\n        xmlopt->config.macPrefix[0] = 0x52;\n        xmlopt->config.macPrefix[1] = 0x54;\n    }\n\n    return xmlopt;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainXMLOptionClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virClassPtr virDomainXMLOptionClass;\n\nvirDomainXMLOptionPtr\nvirDomainXMLOptionNew(virDomainDefParserConfigPtr config,\n                      virDomainXMLPrivateDataCallbacksPtr priv,\n                      virXMLNamespacePtr xmlns,\n                      virDomainABIStabilityPtr abi,\n                      virSaveCookieCallbacksPtr saveCookie)\n{\n    virDomainXMLOptionPtr xmlopt;\n\n    if (virDomainObjInitialize() < 0)\n        return NULL;\n\n    if (!(xmlopt = virObjectNew(virDomainXMLOptionClass)))\n        return NULL;\n\n    if (priv)\n        xmlopt->privateData = *priv;\n\n    if (config)\n        xmlopt->config = *config;\n\n    if (xmlns)\n        xmlopt->ns = *xmlns;\n\n    if (abi)\n        xmlopt->abi = *abi;\n\n    if (saveCookie)\n        xmlopt->saveCookie = *saveCookie;\n\n    /* Technically this forbids to use one of Xerox's MAC address prefixes in\n     * our hypervisor drivers. This shouldn't ever be a problem.\n     *\n     * Use the KVM prefix as default as it's in the privately administered\n     * range */\n    if (xmlopt->config.macPrefix[0] == 0 &&\n        xmlopt->config.macPrefix[1] == 0 &&\n        xmlopt->config.macPrefix[2] == 0) {\n        xmlopt->config.macPrefix[0] = 0x52;\n        xmlopt->config.macPrefix[1] = 0x54;\n    }\n\n    return xmlopt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzBuildCapabilities",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "vzBuildCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "98-149",
          "snippet": "static virCapsPtr\nvzBuildCapabilities(void)\n{\n    virCapsPtr caps = NULL;\n    virNodeInfo nodeinfo;\n    virDomainOSType ostypes[] = {\n        VIR_DOMAIN_OSTYPE_HVM,\n        VIR_DOMAIN_OSTYPE_EXE\n    };\n    virArch archs[] = { VIR_ARCH_I686, VIR_ARCH_X86_64 };\n    const char *const emulators[] = { \"vz\", \"parallels\"};\n    virDomainVirtType virt_types[] = {\n        VIR_DOMAIN_VIRT_VZ,\n        VIR_DOMAIN_VIRT_PARALLELS\n    };\n    size_t i, j, k;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if (!(caps->host.numa = virCapabilitiesHostNUMANewHost()))\n        goto error;\n\n    if (virCapabilitiesInitCaches(caps) < 0)\n        goto error;\n\n    G_STATIC_ASSERT(G_N_ELEMENTS(archs) == G_N_ELEMENTS(emulators));\n\n    for (i = 0; i < G_N_ELEMENTS(ostypes); i++)\n        for (j = 0; j < G_N_ELEMENTS(archs); j++)\n            for (k = 0; k < G_N_ELEMENTS(emulators); k++)\n                if (vzCapsAddGuestDomain(caps, ostypes[i], archs[j],\n                                         emulators[k], virt_types[k]) < 0)\n                    goto error;\n\n    if (virCapabilitiesGetNodeInfo(&nodeinfo))\n        goto error;\n\n    if (!(caps->host.cpu = virCPUGetHost(caps->host.arch, VIR_CPU_TYPE_HOST,\n                                         &nodeinfo, NULL)))\n        goto error;\n\n    if (virCapabilitiesAddHostMigrateTransport(caps, \"vzmigr\") < 0)\n        goto error;\n\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virCapsPtr\nvzBuildCapabilities(void)\n{\n    virCapsPtr caps = NULL;\n    virNodeInfo nodeinfo;\n    virDomainOSType ostypes[] = {\n        VIR_DOMAIN_OSTYPE_HVM,\n        VIR_DOMAIN_OSTYPE_EXE\n    };\n    virArch archs[] = { VIR_ARCH_I686, VIR_ARCH_X86_64 };\n    const char *const emulators[] = { \"vz\", \"parallels\"};\n    virDomainVirtType virt_types[] = {\n        VIR_DOMAIN_VIRT_VZ,\n        VIR_DOMAIN_VIRT_PARALLELS\n    };\n    size_t i, j, k;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if (!(caps->host.numa = virCapabilitiesHostNUMANewHost()))\n        goto error;\n\n    if (virCapabilitiesInitCaches(caps) < 0)\n        goto error;\n\n    G_STATIC_ASSERT(G_N_ELEMENTS(archs) == G_N_ELEMENTS(emulators));\n\n    for (i = 0; i < G_N_ELEMENTS(ostypes); i++)\n        for (j = 0; j < G_N_ELEMENTS(archs); j++)\n            for (k = 0; k < G_N_ELEMENTS(emulators); k++)\n                if (vzCapsAddGuestDomain(caps, ostypes[i], archs[j],\n                                         emulators[k], virt_types[k]) < 0)\n                    goto error;\n\n    if (virCapabilitiesGetNodeInfo(&nodeinfo))\n        goto error;\n\n    if (!(caps->host.cpu = virCPUGetHost(caps->host.arch, VIR_CPU_TYPE_HOST,\n                                         &nodeinfo, NULL)))\n        goto error;\n\n    if (virCapabilitiesAddHostMigrateTransport(caps, \"vzmigr\") < 0)\n        goto error;\n\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "vzDriverClass"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDriverInitialize",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virClassPtr vzDriverClass;\nstatic vzDriverPtr\nvzDriverObjNew(void);\nstatic virDomainXMLPrivateDataCallbacks vzDomainXMLPrivateDataCallbacksPtr = {\n    .alloc = vzDomObjAlloc,\n    .free = vzDomObjFree,\n};\nstatic virDomainDefParserConfig vzDomainDefParserConfig = {\n    .macPrefix = {0x42, 0x1C, 0x00},\n    .domainPostParseCallback = vzDomainDefPostParse,\n    .devicesPostParseCallback = vzDomainDeviceDefPostParse,\n    .domainValidateCallback = vzDomainDefValidate,\n    .deviceValidateCallback = vzDomainDeviceDefValidate,\n};\n\nstatic vzDriverPtr\nvzDriverObjNew(void)\n{\n    vzDriverPtr driver;\n\n    if (vzDriverInitialize() < 0)\n        return NULL;\n\n    if (!(driver = virObjectLockableNew(vzDriverClass)))\n        return NULL;\n\n    vzDomainDefParserConfig.priv = driver;\n\n    if (!(driver->caps = vzBuildCapabilities()) ||\n        !(driver->xmlopt = virDomainXMLOptionNew(&vzDomainDefParserConfig,\n                                                 &vzDomainXMLPrivateDataCallbacksPtr,\n                                                 NULL, NULL, NULL)) ||\n        !(driver->domains = virDomainObjListNew()) ||\n        !(driver->domainEventState = virObjectEventStateNew()) ||\n        (vzInitVersion(driver) < 0) ||\n        (prlsdkConnect(driver) < 0)) {\n        virObjectUnref(driver);\n        return NULL;\n    }\n\n    driver->hostsysinfo = virSysinfoRead();\n    ignore_value(prlsdkLoadDomains(driver));\n\n    /* As far as waitDomainJob finally calls virReportErrorHelper\n     * and we are not going to report it, reset it explicitly */\n    virResetLastError();\n\n    return driver;\n}"
  },
  {
    "function_name": "vzDomainDeviceDefValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "287-300",
    "snippet": "static int\nvzDomainDeviceDefValidate(const virDomainDeviceDef *dev,\n                          const virDomainDef *def,\n                          void *opaque)\n{\n    vzDriverPtr driver = opaque;\n\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK)\n        return vzCheckUnsupportedDisk(def, dev->data.disk, &driver->vzCaps);\n    else if (dev->type == VIR_DOMAIN_DEVICE_GRAPHICS)\n        return vzCheckUnsupportedGraphics(dev->data.graphics);\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzCheckUnsupportedGraphics",
          "args": [
            "dev->data.graphics"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckUnsupportedGraphics",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "491-552",
          "snippet": "int vzCheckUnsupportedGraphics(virDomainGraphicsDefPtr gr)\n{\n    if (gr->type != VIR_DOMAIN_GRAPHICS_TYPE_VNC) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver supports only \"\n                         \"VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.websocket != 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"websockets for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.keymap != 0 &&\n        STRNEQ(gr->data.vnc.keymap, \"en-us\")) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver supports only \"\n                         \"\\\"en-us\\\" keymap for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.sharePolicy == VIR_DOMAIN_GRAPHICS_VNC_SHARE_ALLOW_EXCLUSIVE) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"exclusive share policy for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.auth.connected == VIR_DOMAIN_GRAPHICS_AUTH_CONNECTED_FAIL ||\n        gr->data.vnc.auth.connected == VIR_DOMAIN_GRAPHICS_AUTH_CONNECTED_KEEP) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"given action in case of password change.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.auth.expires) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"setting password expire time.\"));\n        return -1;\n    }\n\n    if (gr->nListens > 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"vz driver doesn't support more than \"\n                         \"one listening VNC server per domain\"));\n        return -1;\n    }\n\n    if (gr->nListens == 1 &&\n        gr->listens[0].type != VIR_DOMAIN_GRAPHICS_LISTEN_TYPE_ADDRESS) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"vz driver supports only address-based VNC listening\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint vzCheckUnsupportedGraphics(virDomainGraphicsDefPtr gr)\n{\n    if (gr->type != VIR_DOMAIN_GRAPHICS_TYPE_VNC) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver supports only \"\n                         \"VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.websocket != 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"websockets for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.keymap != 0 &&\n        STRNEQ(gr->data.vnc.keymap, \"en-us\")) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver supports only \"\n                         \"\\\"en-us\\\" keymap for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.sharePolicy == VIR_DOMAIN_GRAPHICS_VNC_SHARE_ALLOW_EXCLUSIVE) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"exclusive share policy for VNC graphics.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.auth.connected == VIR_DOMAIN_GRAPHICS_AUTH_CONNECTED_FAIL ||\n        gr->data.vnc.auth.connected == VIR_DOMAIN_GRAPHICS_AUTH_CONNECTED_KEEP) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"given action in case of password change.\"));\n        return -1;\n    }\n\n    if (gr->data.vnc.auth.expires) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"vz driver doesn't support \"\n                         \"setting password expire time.\"));\n        return -1;\n    }\n\n    if (gr->nListens > 1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"vz driver doesn't support more than \"\n                         \"one listening VNC server per domain\"));\n        return -1;\n    }\n\n    if (gr->nListens == 1 &&\n        gr->listens[0].type != VIR_DOMAIN_GRAPHICS_LISTEN_TYPE_ADDRESS) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"vz driver supports only address-based VNC listening\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzCheckUnsupportedDisk",
          "args": [
            "def",
            "dev->data.disk",
            "&driver->vzCaps"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckUnsupportedDisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "389-434",
          "snippet": "int\nvzCheckUnsupportedDisk(const virDomainDef *def,\n                       virDomainDiskDefPtr disk,\n                       vzCapabilitiesPtr vzCaps)\n{\n    size_t i;\n    virStorageFileFormat diskFormat;\n\n    if (vzCheckDiskUnsupportedParams(disk) < 0)\n        return -1;\n\n    if (disk->src->type == VIR_STORAGE_TYPE_FILE) {\n        if (disk->device == VIR_DOMAIN_DISK_DEVICE_DISK) {\n            if (IS_CT(def))\n                diskFormat = vzCaps->ctDiskFormat;\n            else\n                diskFormat = vzCaps->vmDiskFormat;\n        } else {\n            diskFormat = VIR_STORAGE_FILE_RAW;\n        }\n    } else {\n        diskFormat = VIR_STORAGE_FILE_RAW;\n    }\n\n    if (virDomainDiskGetFormat(disk) != VIR_STORAGE_FILE_NONE &&\n        virDomainDiskGetFormat(disk) != diskFormat) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported format of disk %s\"),\n                       disk->src->path);\n        return -1;\n    }\n\n    for (i = 0; vzCaps->diskBuses[i] != VIR_DOMAIN_DISK_BUS_LAST; i++) {\n        if (disk->bus == vzCaps->diskBuses[i])\n            break;\n    }\n\n    if (vzCaps->diskBuses[i] == VIR_DOMAIN_DISK_BUS_LAST) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported disk bus type %s\"),\n                       virDomainDiskBusTypeToString(disk->bus));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvzCheckUnsupportedDisk(const virDomainDef *def,\n                       virDomainDiskDefPtr disk,\n                       vzCapabilitiesPtr vzCaps)\n{\n    size_t i;\n    virStorageFileFormat diskFormat;\n\n    if (vzCheckDiskUnsupportedParams(disk) < 0)\n        return -1;\n\n    if (disk->src->type == VIR_STORAGE_TYPE_FILE) {\n        if (disk->device == VIR_DOMAIN_DISK_DEVICE_DISK) {\n            if (IS_CT(def))\n                diskFormat = vzCaps->ctDiskFormat;\n            else\n                diskFormat = vzCaps->vmDiskFormat;\n        } else {\n            diskFormat = VIR_STORAGE_FILE_RAW;\n        }\n    } else {\n        diskFormat = VIR_STORAGE_FILE_RAW;\n    }\n\n    if (virDomainDiskGetFormat(disk) != VIR_STORAGE_FILE_NONE &&\n        virDomainDiskGetFormat(disk) != diskFormat) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported format of disk %s\"),\n                       disk->src->path);\n        return -1;\n    }\n\n    for (i = 0; vzCaps->diskBuses[i] != VIR_DOMAIN_DISK_BUS_LAST; i++) {\n        if (disk->bus == vzCaps->diskBuses[i])\n            break;\n    }\n\n    if (vzCaps->diskBuses[i] == VIR_DOMAIN_DISK_BUS_LAST) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported disk bus type %s\"),\n                       virDomainDiskBusTypeToString(disk->bus));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDeviceDefValidate(const virDomainDeviceDef *dev,\n                          const virDomainDef *def,\n                          void *opaque)\n{\n    vzDriverPtr driver = opaque;\n\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK)\n        return vzCheckUnsupportedDisk(def, dev->data.disk, &driver->vzCaps);\n    else if (dev->type == VIR_DOMAIN_DEVICE_GRAPHICS)\n        return vzCheckUnsupportedGraphics(dev->data.graphics);\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainDeviceDefPostParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "270-285",
    "snippet": "static int\nvzDomainDeviceDefPostParse(virDomainDeviceDefPtr dev,\n                           const virDomainDef *def,\n                           unsigned int parseFlags G_GNUC_UNUSED,\n                           void *opaque G_GNUC_UNUSED,\n                           void *parseOpaque G_GNUC_UNUSED)\n{\n    if (dev->type == VIR_DOMAIN_DEVICE_NET &&\n        (dev->data.net->type == VIR_DOMAIN_NET_TYPE_NETWORK ||\n         dev->data.net->type == VIR_DOMAIN_NET_TYPE_BRIDGE) &&\n        dev->data.net->model == VIR_DOMAIN_NET_MODEL_UNKNOWN &&\n        def->os.type == VIR_DOMAIN_OSTYPE_HVM)\n        dev->data.net->model = VIR_DOMAIN_NET_MODEL_E1000;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDeviceDefPostParse(virDomainDeviceDefPtr dev,\n                           const virDomainDef *def,\n                           unsigned int parseFlags G_GNUC_UNUSED,\n                           void *opaque G_GNUC_UNUSED,\n                           void *parseOpaque G_GNUC_UNUSED)\n{\n    if (dev->type == VIR_DOMAIN_DEVICE_NET &&\n        (dev->data.net->type == VIR_DOMAIN_NET_TYPE_NETWORK ||\n         dev->data.net->type == VIR_DOMAIN_NET_TYPE_BRIDGE) &&\n        dev->data.net->model == VIR_DOMAIN_NET_MODEL_UNKNOWN &&\n        def->os.type == VIR_DOMAIN_OSTYPE_HVM)\n        dev->data.net->model = VIR_DOMAIN_NET_MODEL_E1000;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainDefValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "260-268",
    "snippet": "static int\nvzDomainDefValidate(const virDomainDef *def,\n                    void *opaque)\n{\n    if (vzCheckUnsupportedControllers(def, opaque) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzCheckUnsupportedControllers",
          "args": [
            "def",
            "opaque"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "vzCheckUnsupportedControllers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_utils.c",
          "lines": "436-469",
          "snippet": "int\nvzCheckUnsupportedControllers(const virDomainDef *def, vzCapabilitiesPtr vzCaps)\n{\n    size_t i, j;\n    virDomainControllerDefPtr controller;\n\n    for (i = 0; i < def->ncontrollers; i++) {\n        controller = def->controllers[i];\n\n        for (j = 0; vzCaps->controllerTypes[j] != VIR_DOMAIN_CONTROLLER_TYPE_LAST; j++) {\n            if (controller->type == vzCaps->controllerTypes[j])\n                break;\n        }\n\n        if (vzCaps->controllerTypes[j] == VIR_DOMAIN_CONTROLLER_TYPE_LAST) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unsupported controller type %s\"),\n                           virDomainControllerTypeToString(controller->type));\n            return -1;\n        }\n\n        if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_SCSI &&\n            controller->model != -1 &&\n            controller->model != VIR_DOMAIN_CONTROLLER_MODEL_SCSI_AUTO &&\n            controller->model != vzCaps->scsiControllerModel) {\n\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"Unsupported SCSI controller model %s\"),\n                               virDomainControllerModelSCSITypeToString(controller->model));\n                return -1;\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtime.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"virjson.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtime.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"virjson.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvzCheckUnsupportedControllers(const virDomainDef *def, vzCapabilitiesPtr vzCaps)\n{\n    size_t i, j;\n    virDomainControllerDefPtr controller;\n\n    for (i = 0; i < def->ncontrollers; i++) {\n        controller = def->controllers[i];\n\n        for (j = 0; vzCaps->controllerTypes[j] != VIR_DOMAIN_CONTROLLER_TYPE_LAST; j++) {\n            if (controller->type == vzCaps->controllerTypes[j])\n                break;\n        }\n\n        if (vzCaps->controllerTypes[j] == VIR_DOMAIN_CONTROLLER_TYPE_LAST) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unsupported controller type %s\"),\n                           virDomainControllerTypeToString(controller->type));\n            return -1;\n        }\n\n        if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_SCSI &&\n            controller->model != -1 &&\n            controller->model != VIR_DOMAIN_CONTROLLER_MODEL_SCSI_AUTO &&\n            controller->model != vzCaps->scsiControllerModel) {\n\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"Unsupported SCSI controller model %s\"),\n                               virDomainControllerModelSCSITypeToString(controller->model));\n                return -1;\n        }\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDefValidate(const virDomainDef *def,\n                    void *opaque)\n{\n    if (vzCheckUnsupportedControllers(def, opaque) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainDefPostParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "242-258",
    "snippet": "static int\nvzDomainDefPostParse(virDomainDefPtr def,\n                     unsigned int parseFlags G_GNUC_UNUSED,\n                     void *opaque,\n                     void *parseOpaque G_GNUC_UNUSED)\n{\n    vzDriverPtr driver = opaque;\n    if (!virCapabilitiesDomainSupported(driver->caps, def->os.type,\n                                        def->os.arch,\n                                        def->virtType))\n        return -1;\n\n    if (vzDomainDefAddDefaultInputDevices(def) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vzDomainDefAddDefaultInputDevices",
          "args": [
            "def"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "vzDomainDefAddDefaultInputDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "220-240",
          "snippet": "static int\nvzDomainDefAddDefaultInputDevices(virDomainDefPtr def)\n{\n    if (def->ngraphics == 0)\n        return 0;\n\n    int bus = IS_CT(def) ? VIR_DOMAIN_INPUT_BUS_PARALLELS :\n                           VIR_DOMAIN_INPUT_BUS_PS2;\n\n    if (virDomainDefMaybeAddInput(def,\n                                  VIR_DOMAIN_INPUT_TYPE_MOUSE,\n                                  bus) < 0)\n        return -1;\n\n    if (virDomainDefMaybeAddInput(def,\n                                  VIR_DOMAIN_INPUT_TYPE_KBD,\n                                  bus) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDefAddDefaultInputDevices(virDomainDefPtr def)\n{\n    if (def->ngraphics == 0)\n        return 0;\n\n    int bus = IS_CT(def) ? VIR_DOMAIN_INPUT_BUS_PARALLELS :\n                           VIR_DOMAIN_INPUT_BUS_PS2;\n\n    if (virDomainDefMaybeAddInput(def,\n                                  VIR_DOMAIN_INPUT_TYPE_MOUSE,\n                                  bus) < 0)\n        return -1;\n\n    if (virDomainDefMaybeAddInput(def,\n                                  VIR_DOMAIN_INPUT_TYPE_KBD,\n                                  bus) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesDomainSupported",
          "args": [
            "driver->caps",
            "def->os.type",
            "def->os.arch",
            "def->virtType"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesDomainSupported",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "787-801",
          "snippet": "bool\nvirCapabilitiesDomainSupported(virCapsPtr caps,\n                               int ostype,\n                               virArch arch,\n                               int virttype)\n{\n    g_autofree virCapsDomainDataPtr capsdata = NULL;\n\n    capsdata = virCapabilitiesDomainDataLookup(caps, ostype,\n                                               arch,\n                                               virttype,\n                                               NULL, NULL);\n\n    return capsdata != NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirCapabilitiesDomainSupported(virCapsPtr caps,\n                               int ostype,\n                               virArch arch,\n                               int virttype)\n{\n    g_autofree virCapsDomainDataPtr capsdata = NULL;\n\n    capsdata = virCapabilitiesDomainDataLookup(caps, ostype,\n                                               arch,\n                                               virttype,\n                                               NULL, NULL);\n\n    return capsdata != NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDefPostParse(virDomainDefPtr def,\n                     unsigned int parseFlags G_GNUC_UNUSED,\n                     void *opaque,\n                     void *parseOpaque G_GNUC_UNUSED)\n{\n    vzDriverPtr driver = opaque;\n    if (!virCapabilitiesDomainSupported(driver->caps, def->os.type,\n                                        def->os.arch,\n                                        def->virtType))\n        return -1;\n\n    if (vzDomainDefAddDefaultInputDevices(def) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDomainDefAddDefaultInputDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "220-240",
    "snippet": "static int\nvzDomainDefAddDefaultInputDevices(virDomainDefPtr def)\n{\n    if (def->ngraphics == 0)\n        return 0;\n\n    int bus = IS_CT(def) ? VIR_DOMAIN_INPUT_BUS_PARALLELS :\n                           VIR_DOMAIN_INPUT_BUS_PS2;\n\n    if (virDomainDefMaybeAddInput(def,\n                                  VIR_DOMAIN_INPUT_TYPE_MOUSE,\n                                  bus) < 0)\n        return -1;\n\n    if (virDomainDefMaybeAddInput(def,\n                                  VIR_DOMAIN_INPUT_TYPE_KBD,\n                                  bus) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefMaybeAddInput",
          "args": [
            "def",
            "VIR_DOMAIN_INPUT_TYPE_KBD",
            "bus"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefMaybeAddInput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "19027-19053",
          "snippet": "int\nvirDomainDefMaybeAddInput(virDomainDefPtr def,\n                          int type,\n                          int bus)\n{\n    size_t i;\n    virDomainInputDefPtr input;\n\n    for (i = 0; i < def->ninputs; i++) {\n        if (def->inputs[i]->type == type &&\n            def->inputs[i]->bus == bus)\n            return 0;\n    }\n\n    if (VIR_ALLOC(input) < 0)\n        return -1;\n\n    input->type = type;\n    input->bus = bus;\n\n    if (VIR_APPEND_ELEMENT(def->inputs, def->ninputs, input) < 0) {\n        VIR_FREE(input);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefMaybeAddInput(virDomainDefPtr def,\n                          int type,\n                          int bus)\n{\n    size_t i;\n    virDomainInputDefPtr input;\n\n    for (i = 0; i < def->ninputs; i++) {\n        if (def->inputs[i]->type == type &&\n            def->inputs[i]->bus == bus)\n            return 0;\n    }\n\n    if (VIR_ALLOC(input) < 0)\n        return -1;\n\n    input->type = type;\n    input->bus = bus;\n\n    if (VIR_APPEND_ELEMENT(def->inputs, def->ninputs, input) < 0) {\n        VIR_FREE(input);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_CT",
          "args": [
            "def"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzDomainDefAddDefaultInputDevices(virDomainDefPtr def)\n{\n    if (def->ngraphics == 0)\n        return 0;\n\n    int bus = IS_CT(def) ? VIR_DOMAIN_INPUT_BUS_PARALLELS :\n                           VIR_DOMAIN_INPUT_BUS_PS2;\n\n    if (virDomainDefMaybeAddInput(def,\n                                  VIR_DOMAIN_INPUT_TYPE_MOUSE,\n                                  bus) < 0)\n        return -1;\n\n    if (virDomainDefMaybeAddInput(def,\n                                  VIR_DOMAIN_INPUT_TYPE_KBD,\n                                  bus) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzConnectGetCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "209-218",
    "snippet": "static char *\nvzConnectGetCapabilities(virConnectPtr conn)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectGetCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    return virCapabilitiesFormatXML(privconn->driver->caps);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesFormatXML",
          "args": [
            "privconn->driver->caps"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesFormatXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1335-1358",
          "snippet": "char *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetCapabilitiesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nvzConnectGetCapabilities(virConnectPtr conn)\n{\n    vzConnPtr privconn = conn->privateData;\n\n    if (virConnectGetCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    return virCapabilitiesFormatXML(privconn->driver->caps);\n}"
  },
  {
    "function_name": "vzDestroyDriverConnection",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "189-207",
    "snippet": "void\nvzDestroyDriverConnection(void)\n{\n    vzDriverPtr driver;\n    vzConnPtr privconn_list;\n\n    virMutexLock(&vz_driver_lock);\n    driver = g_steal_pointer(&vz_driver);\n    privconn_list = g_steal_pointer(&vz_conn_list);\n    virMutexUnlock(&vz_driver_lock);\n\n    while (privconn_list) {\n        vzConnPtr privconn = privconn_list;\n        privconn_list = privconn->next;\n        virConnectCloseCallbackDataCall(privconn->closeCallback,\n                                        VIR_CONNECT_CLOSE_REASON_EOF);\n    }\n    virObjectUnref(driver);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virMutex vz_driver_lock;",
      "static vzDriverPtr vz_driver;",
      "static vzConnPtr vz_conn_list;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "driver"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectCloseCallbackDataCall",
          "args": [
            "privconn->closeCallback",
            "VIR_CONNECT_CLOSE_REASON_EOF"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectCloseCallbackDataCall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "233-249",
          "snippet": "void virConnectCloseCallbackDataCall(virConnectCloseCallbackDataPtr closeData,\n                                     int reason)\n{\n    virObjectLock(closeData);\n\n    if (!closeData->conn)\n        goto exit;\n\n    VIR_DEBUG(\"Triggering connection close callback %p reason=%d, opaque=%p\",\n              closeData->callback, reason, closeData->opaque);\n    closeData->callback(closeData->conn, reason, closeData->opaque);\n\n    virConnectCloseCallbackDataReset(closeData);\n\n exit:\n    virObjectUnlock(closeData);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid virConnectCloseCallbackDataCall(virConnectCloseCallbackDataPtr closeData,\n                                     int reason)\n{\n    virObjectLock(closeData);\n\n    if (!closeData->conn)\n        goto exit;\n\n    VIR_DEBUG(\"Triggering connection close callback %p reason=%d, opaque=%p\",\n              closeData->callback, reason, closeData->opaque);\n    closeData->callback(closeData->conn, reason, closeData->opaque);\n\n    virConnectCloseCallbackDataReset(closeData);\n\n exit:\n    virObjectUnlock(closeData);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&vz_conn_list"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&vz_driver"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virMutex vz_driver_lock;\nstatic vzDriverPtr vz_driver;\nstatic vzConnPtr vz_conn_list;\n\nvoid\nvzDestroyDriverConnection(void)\n{\n    vzDriverPtr driver;\n    vzConnPtr privconn_list;\n\n    virMutexLock(&vz_driver_lock);\n    driver = g_steal_pointer(&vz_driver);\n    privconn_list = g_steal_pointer(&vz_conn_list);\n    virMutexUnlock(&vz_driver_lock);\n\n    while (privconn_list) {\n        vzConnPtr privconn = privconn_list;\n        privconn_list = privconn->next;\n        virConnectCloseCallbackDataCall(privconn->closeCallback,\n                                        VIR_CONNECT_CLOSE_REASON_EOF);\n    }\n    virObjectUnref(driver);\n}"
  },
  {
    "function_name": "vzGetDriverConnection",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "172-187",
    "snippet": "vzDriverPtr\nvzGetDriverConnection(void)\n{\n    if (!vz_driver_privileged) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"vz state driver is not active\"));\n        return NULL;\n    }\n    virMutexLock(&vz_driver_lock);\n    if (!vz_driver)\n        vz_driver = vzDriverObjNew();\n    virObjectRef(vz_driver);\n    virMutexUnlock(&vz_driver_lock);\n\n    return vz_driver;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool vz_driver_privileged;",
      "static virMutex vz_driver_lock;",
      "static vzDriverPtr vz_driver;",
      "static vzDriverPtr\nvzDriverObjNew(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "vz_driver"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzDriverObjNew",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "vzDriverObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "315-348",
          "snippet": "static vzDriverPtr\nvzDriverObjNew(void)\n{\n    vzDriverPtr driver;\n\n    if (vzDriverInitialize() < 0)\n        return NULL;\n\n    if (!(driver = virObjectLockableNew(vzDriverClass)))\n        return NULL;\n\n    vzDomainDefParserConfig.priv = driver;\n\n    if (!(driver->caps = vzBuildCapabilities()) ||\n        !(driver->xmlopt = virDomainXMLOptionNew(&vzDomainDefParserConfig,\n                                                 &vzDomainXMLPrivateDataCallbacksPtr,\n                                                 NULL, NULL, NULL)) ||\n        !(driver->domains = virDomainObjListNew()) ||\n        !(driver->domainEventState = virObjectEventStateNew()) ||\n        (vzInitVersion(driver) < 0) ||\n        (prlsdkConnect(driver) < 0)) {\n        virObjectUnref(driver);\n        return NULL;\n    }\n\n    driver->hostsysinfo = virSysinfoRead();\n    ignore_value(prlsdkLoadDomains(driver));\n\n    /* As far as waitDomainJob finally calls virReportErrorHelper\n     * and we are not going to report it, reset it explicitly */\n    virResetLastError();\n\n    return driver;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr vzDriverClass;",
            "static vzDriverPtr\nvzDriverObjNew(void);",
            "static virDomainXMLPrivateDataCallbacks vzDomainXMLPrivateDataCallbacksPtr = {\n    .alloc = vzDomObjAlloc,\n    .free = vzDomObjFree,\n};",
            "static virDomainDefParserConfig vzDomainDefParserConfig = {\n    .macPrefix = {0x42, 0x1C, 0x00},\n    .domainPostParseCallback = vzDomainDefPostParse,\n    .devicesPostParseCallback = vzDomainDeviceDefPostParse,\n    .domainValidateCallback = vzDomainDefValidate,\n    .deviceValidateCallback = vzDomainDeviceDefValidate,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virClassPtr vzDriverClass;\nstatic vzDriverPtr\nvzDriverObjNew(void);\nstatic virDomainXMLPrivateDataCallbacks vzDomainXMLPrivateDataCallbacksPtr = {\n    .alloc = vzDomObjAlloc,\n    .free = vzDomObjFree,\n};\nstatic virDomainDefParserConfig vzDomainDefParserConfig = {\n    .macPrefix = {0x42, 0x1C, 0x00},\n    .domainPostParseCallback = vzDomainDefPostParse,\n    .devicesPostParseCallback = vzDomainDeviceDefPostParse,\n    .domainValidateCallback = vzDomainDefValidate,\n    .deviceValidateCallback = vzDomainDeviceDefValidate,\n};\n\nstatic vzDriverPtr\nvzDriverObjNew(void)\n{\n    vzDriverPtr driver;\n\n    if (vzDriverInitialize() < 0)\n        return NULL;\n\n    if (!(driver = virObjectLockableNew(vzDriverClass)))\n        return NULL;\n\n    vzDomainDefParserConfig.priv = driver;\n\n    if (!(driver->caps = vzBuildCapabilities()) ||\n        !(driver->xmlopt = virDomainXMLOptionNew(&vzDomainDefParserConfig,\n                                                 &vzDomainXMLPrivateDataCallbacksPtr,\n                                                 NULL, NULL, NULL)) ||\n        !(driver->domains = virDomainObjListNew()) ||\n        !(driver->domainEventState = virObjectEventStateNew()) ||\n        (vzInitVersion(driver) < 0) ||\n        (prlsdkConnect(driver) < 0)) {\n        virObjectUnref(driver);\n        return NULL;\n    }\n\n    driver->hostsysinfo = virSysinfoRead();\n    ignore_value(prlsdkLoadDomains(driver));\n\n    /* As far as waitDomainJob finally calls virReportErrorHelper\n     * and we are not going to report it, reset it explicitly */\n    virResetLastError();\n\n    return driver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&vz_driver_lock"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"vz state driver is not active\")"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"vz state driver is not active\""
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool vz_driver_privileged;\nstatic virMutex vz_driver_lock;\nstatic vzDriverPtr vz_driver;\nstatic vzDriverPtr\nvzDriverObjNew(void);\n\nvzDriverPtr\nvzGetDriverConnection(void)\n{\n    if (!vz_driver_privileged) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"vz state driver is not active\"));\n        return NULL;\n    }\n    virMutexLock(&vz_driver_lock);\n    if (!vz_driver)\n        vz_driver = vzDriverObjNew();\n    virObjectRef(vz_driver);\n    virMutexUnlock(&vz_driver_lock);\n\n    return vz_driver;\n}"
  },
  {
    "function_name": "vzDriverOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "163-169",
    "snippet": "static int vzDriverOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(vzDriver, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "vzDriver",
            "virClassForObjectLockable()"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int vzDriverOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(vzDriver, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "vzDriverDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "151-161",
    "snippet": "static void vzDriverDispose(void * obj)\n{\n    vzDriverPtr driver = obj;\n\n    prlsdkDisconnect(driver);\n    virObjectUnref(driver->domains);\n    virObjectUnref(driver->caps);\n    virObjectUnref(driver->xmlopt);\n    virObjectUnref(driver->domainEventState);\n    virSysinfoDefFree(driver->hostsysinfo);\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoDefFree",
          "args": [
            "driver->hostsysinfo"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "144-191",
          "snippet": "void virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "driver->domainEventState"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prlsdkDisconnect",
          "args": [
            "driver"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "prlsdkDisconnect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_sdk.c",
          "lines": "405-425",
          "snippet": "void\nprlsdkDisconnect(vzDriverPtr driver)\n{\n    PRL_HANDLE job;\n    PRL_RESULT ret;\n\n    if (driver->server == PRL_INVALID_HANDLE)\n        return;\n\n    ret = PrlSrv_UnregEventHandler(driver->server,\n                                   prlsdkEventsHandler,\n                                   driver);\n    if (PRL_FAILED(ret))\n        logPrlError(ret);\n\n    job = PrlSrv_Logoff(driver->server);\n    waitJob(job);\n\n    PrlHandle_Free(driver->server);\n    driver->server = PRL_INVALID_HANDLE;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtime.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"virutil.h\"\n#include \"virsocketaddr.h\"\n#include \"virhostcpu.h\"\n#include \"virtime.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nprlsdkDisconnect(vzDriverPtr driver)\n{\n    PRL_HANDLE job;\n    PRL_RESULT ret;\n\n    if (driver->server == PRL_INVALID_HANDLE)\n        return;\n\n    ret = PrlSrv_UnregEventHandler(driver->server,\n                                   prlsdkEventsHandler,\n                                   driver);\n    if (PRL_FAILED(ret))\n        logPrlError(ret);\n\n    job = PrlSrv_Logoff(driver->server);\n    waitJob(job);\n\n    PrlHandle_Free(driver->server);\n    driver->server = PRL_INVALID_HANDLE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void vzDriverDispose(void * obj)\n{\n    vzDriverPtr driver = obj;\n\n    prlsdkDisconnect(driver);\n    virObjectUnref(driver->domains);\n    virObjectUnref(driver->caps);\n    virObjectUnref(driver->xmlopt);\n    virObjectUnref(driver->domainEventState);\n    virSysinfoDefFree(driver->hostsysinfo);\n}"
  },
  {
    "function_name": "vzBuildCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "98-149",
    "snippet": "static virCapsPtr\nvzBuildCapabilities(void)\n{\n    virCapsPtr caps = NULL;\n    virNodeInfo nodeinfo;\n    virDomainOSType ostypes[] = {\n        VIR_DOMAIN_OSTYPE_HVM,\n        VIR_DOMAIN_OSTYPE_EXE\n    };\n    virArch archs[] = { VIR_ARCH_I686, VIR_ARCH_X86_64 };\n    const char *const emulators[] = { \"vz\", \"parallels\"};\n    virDomainVirtType virt_types[] = {\n        VIR_DOMAIN_VIRT_VZ,\n        VIR_DOMAIN_VIRT_PARALLELS\n    };\n    size_t i, j, k;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if (!(caps->host.numa = virCapabilitiesHostNUMANewHost()))\n        goto error;\n\n    if (virCapabilitiesInitCaches(caps) < 0)\n        goto error;\n\n    G_STATIC_ASSERT(G_N_ELEMENTS(archs) == G_N_ELEMENTS(emulators));\n\n    for (i = 0; i < G_N_ELEMENTS(ostypes); i++)\n        for (j = 0; j < G_N_ELEMENTS(archs); j++)\n            for (k = 0; k < G_N_ELEMENTS(emulators); k++)\n                if (vzCapsAddGuestDomain(caps, ostypes[i], archs[j],\n                                         emulators[k], virt_types[k]) < 0)\n                    goto error;\n\n    if (virCapabilitiesGetNodeInfo(&nodeinfo))\n        goto error;\n\n    if (!(caps->host.cpu = virCPUGetHost(caps->host.arch, VIR_CPU_TYPE_HOST,\n                                         &nodeinfo, NULL)))\n        goto error;\n\n    if (virCapabilitiesAddHostMigrateTransport(caps, \"vzmigr\") < 0)\n        goto error;\n\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesAddHostMigrateTransport",
          "args": [
            "caps",
            "\"vzmigr\""
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesAddHostMigrateTransport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "300-312",
          "snippet": "int\nvirCapabilitiesAddHostMigrateTransport(virCapsPtr caps,\n                                       const char *name)\n{\n    if (VIR_RESIZE_N(caps->host.migrateTrans, caps->host.nmigrateTrans_max,\n                     caps->host.nmigrateTrans, 1) < 0)\n        return -1;\n\n    caps->host.migrateTrans[caps->host.nmigrateTrans] = g_strdup(name);\n    caps->host.nmigrateTrans++;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirCapabilitiesAddHostMigrateTransport(virCapsPtr caps,\n                                       const char *name)\n{\n    if (VIR_RESIZE_N(caps->host.migrateTrans, caps->host.nmigrateTrans_max,\n                     caps->host.nmigrateTrans, 1) < 0)\n        return -1;\n\n    caps->host.migrateTrans[caps->host.nmigrateTrans] = g_strdup(name);\n    caps->host.nmigrateTrans++;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUGetHost",
          "args": [
            "caps->host.arch",
            "VIR_CPU_TYPE_HOST",
            "&nodeinfo",
            "NULL"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUGetHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu.c",
          "lines": "380-451",
          "snippet": "virCPUDefPtr\nvirCPUGetHost(virArch arch,\n              virCPUType type,\n              virNodeInfoPtr nodeInfo,\n              virDomainCapsCPUModelsPtr models)\n{\n    struct cpuArchDriver *driver;\n    virCPUDefPtr cpu = NULL;\n\n    VIR_DEBUG(\"arch=%s, type=%s, nodeInfo=%p, models=%p\",\n              virArchToString(arch), virCPUTypeToString(type), nodeInfo,\n              models);\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return NULL;\n\n    cpu = virCPUDefNew();\n\n    switch (type) {\n    case VIR_CPU_TYPE_HOST:\n        cpu->arch = arch;\n        cpu->type = type;\n        break;\n\n    case VIR_CPU_TYPE_GUEST:\n        if (nodeInfo) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"cannot set topology for CPU type '%s'\"),\n                           virCPUTypeToString(type));\n            goto error;\n        }\n        cpu->type = type;\n        break;\n\n    case VIR_CPU_TYPE_AUTO:\n    case VIR_CPU_TYPE_LAST:\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported CPU type: %s\"),\n                       virCPUTypeToString(type));\n        goto error;\n    }\n\n    if (nodeInfo) {\n        cpu->sockets = nodeInfo->sockets;\n        cpu->dies = 1;\n        cpu->cores = nodeInfo->cores;\n        cpu->threads = nodeInfo->threads;\n    }\n\n    /* Try to get the host CPU model, but don't really fail if nodeInfo is\n     * filled in.\n     */\n    if (driver->getHost) {\n        if (driver->getHost(cpu, models) < 0 &&\n            !nodeInfo)\n            goto error;\n    } else if (nodeInfo) {\n        VIR_DEBUG(\"cannot detect host CPU model for %s architecture\",\n                  virArchToString(arch));\n    } else {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"cannot detect host CPU model for %s architecture\"),\n                       virArchToString(arch));\n        goto error;\n    }\n\n    return cpu;\n\n error:\n    virCPUDefFree(cpu);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"capabilities.h\"",
            "#include \"cpu_arm.h\"",
            "#include \"cpu_s390.h\"",
            "#include \"cpu_ppc64.h\"",
            "#include \"cpu_x86.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"capabilities.h\"\n#include \"cpu_arm.h\"\n#include \"cpu_s390.h\"\n#include \"cpu_ppc64.h\"\n#include \"cpu_x86.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirCPUDefPtr\nvirCPUGetHost(virArch arch,\n              virCPUType type,\n              virNodeInfoPtr nodeInfo,\n              virDomainCapsCPUModelsPtr models)\n{\n    struct cpuArchDriver *driver;\n    virCPUDefPtr cpu = NULL;\n\n    VIR_DEBUG(\"arch=%s, type=%s, nodeInfo=%p, models=%p\",\n              virArchToString(arch), virCPUTypeToString(type), nodeInfo,\n              models);\n\n    if (!(driver = cpuGetSubDriver(arch)))\n        return NULL;\n\n    cpu = virCPUDefNew();\n\n    switch (type) {\n    case VIR_CPU_TYPE_HOST:\n        cpu->arch = arch;\n        cpu->type = type;\n        break;\n\n    case VIR_CPU_TYPE_GUEST:\n        if (nodeInfo) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"cannot set topology for CPU type '%s'\"),\n                           virCPUTypeToString(type));\n            goto error;\n        }\n        cpu->type = type;\n        break;\n\n    case VIR_CPU_TYPE_AUTO:\n    case VIR_CPU_TYPE_LAST:\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported CPU type: %s\"),\n                       virCPUTypeToString(type));\n        goto error;\n    }\n\n    if (nodeInfo) {\n        cpu->sockets = nodeInfo->sockets;\n        cpu->dies = 1;\n        cpu->cores = nodeInfo->cores;\n        cpu->threads = nodeInfo->threads;\n    }\n\n    /* Try to get the host CPU model, but don't really fail if nodeInfo is\n     * filled in.\n     */\n    if (driver->getHost) {\n        if (driver->getHost(cpu, models) < 0 &&\n            !nodeInfo)\n            goto error;\n    } else if (nodeInfo) {\n        VIR_DEBUG(\"cannot detect host CPU model for %s architecture\",\n                  virArchToString(arch));\n    } else {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"cannot detect host CPU model for %s architecture\"),\n                       virArchToString(arch));\n        goto error;\n    }\n\n    return cpu;\n\n error:\n    virCPUDefFree(cpu);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesGetNodeInfo",
          "args": [
            "&nodeinfo"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesGetNodeInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1434-1456",
          "snippet": "int\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vzCapsAddGuestDomain",
          "args": [
            "caps",
            "ostypes[i]",
            "archs[j]",
            "emulators[k]",
            "virt_types[k]"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "vzCapsAddGuestDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
          "lines": "77-96",
          "snippet": "static int\nvzCapsAddGuestDomain(virCapsPtr caps,\n                     virDomainOSType ostype,\n                     virArch arch,\n                     const char * emulator,\n                     virDomainVirtType virt_type)\n{\n    virCapsGuestPtr guest;\n\n    if ((guest = virCapabilitiesAddGuest(caps, ostype, arch, emulator,\n                                         NULL, 0, NULL)) == NULL)\n        return -1;\n\n\n    if (virCapabilitiesAddGuestDomain(guest, virt_type,\n                                      NULL, NULL, 0, NULL) == NULL)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"vz_sdk.h\"",
            "#include \"vz_utils.h\"",
            "#include \"vz_driver.h\"",
            "#include \"virutil.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/time.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzCapsAddGuestDomain(virCapsPtr caps,\n                     virDomainOSType ostype,\n                     virArch arch,\n                     const char * emulator,\n                     virDomainVirtType virt_type)\n{\n    virCapsGuestPtr guest;\n\n    if ((guest = virCapabilitiesAddGuest(caps, ostype, arch, emulator,\n                                         NULL, 0, NULL)) == NULL)\n        return -1;\n\n\n    if (virCapabilitiesAddGuestDomain(guest, virt_type,\n                                      NULL, NULL, 0, NULL) == NULL)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "emulators"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "archs"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "ostypes"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_STATIC_ASSERT",
          "args": [
            "G_N_ELEMENTS(archs) == G_N_ELEMENTS(emulators)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "emulators"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "archs"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCapabilitiesInitCaches",
          "args": [
            "caps"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesInitCaches",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1857-2002",
          "snippet": "int\nvirCapabilitiesInitCaches(virCapsPtr caps)\n{\n    size_t i = 0;\n    virBitmapPtr cpus = NULL;\n    ssize_t pos = -1;\n    DIR *dirp = NULL;\n    int ret = -1;\n    char *path = NULL;\n    char *type = NULL;\n    struct dirent *ent = NULL;\n    virCapsHostCacheBankPtr bank = NULL;\n    const virResctrlMonitorType montype = VIR_RESCTRL_MONITOR_TYPE_CACHE;\n    const char *prefix = virResctrlMonitorPrefixTypeToString(montype);\n\n    /* Minimum level to expose in capabilities.  Can be lowered or removed (with\n     * the appropriate code below), but should not be increased, because we'd\n     * lose information. */\n    const int cache_min_level = 3;\n\n    if (virCapabilitiesInitResctrl(caps) < 0)\n        return -1;\n\n    /* offline CPUs don't provide cache info */\n    if (virFileReadValueBitmap(&cpus, \"%s/cpu/online\", SYSFS_SYSTEM_PATH) < 0)\n        return -1;\n\n    while ((pos = virBitmapNextSetBit(cpus, pos)) >= 0) {\n        int rv = -1;\n\n        VIR_FREE(path);\n        path = g_strdup_printf(\"%s/cpu/cpu%zd/cache/\", SYSFS_SYSTEM_PATH, pos);\n\n        VIR_DIR_CLOSE(dirp);\n\n        rv = virDirOpenIfExists(&dirp, path);\n        if (rv < 0)\n            goto cleanup;\n\n        if (!dirp)\n            continue;\n\n        while ((rv = virDirRead(dirp, &ent, path)) > 0) {\n            int kernel_type;\n            unsigned int level;\n\n            if (!STRPREFIX(ent->d_name, \"index\"))\n                continue;\n\n            if (virFileReadValueUint(&level,\n                                     \"%s/cpu/cpu%zd/cache/%s/level\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (level < cache_min_level)\n                continue;\n\n            if (VIR_ALLOC(bank) < 0)\n                goto cleanup;\n\n            bank->level = level;\n\n            if (virFileReadValueUint(&bank->id,\n                                     \"%s/cpu/cpu%zd/cache/%s/id\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueUint(&bank->level,\n                                     \"%s/cpu/cpu%zd/cache/%s/level\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueString(&type,\n                                       \"%s/cpu/cpu%zd/cache/%s/type\",\n                                       SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueScaledInt(&bank->size,\n                                          \"%s/cpu/cpu%zd/cache/%s/size\",\n                                          SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueBitmap(&bank->cpus,\n                                       \"%s/cpu/cpu%zd/cache/%s/shared_cpu_list\",\n                                       SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            kernel_type = virCacheKernelTypeFromString(type);\n            if (kernel_type < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unknown cache type '%s'\"), type);\n                goto cleanup;\n            }\n\n            bank->type = kernel_type;\n            VIR_FREE(type);\n\n            for (i = 0; i < caps->host.cache.nbanks; i++) {\n                if (virCapsHostCacheBankEquals(bank, caps->host.cache.banks[i]))\n                    break;\n            }\n            if (i == caps->host.cache.nbanks) {\n                /* If it is a new cache, then update its resctrl information. */\n                if (virResctrlInfoGetCache(caps->host.resctrl,\n                                           bank->level,\n                                           bank->size,\n                                           &bank->ncontrols,\n                                           &bank->controls) < 0)\n                    goto cleanup;\n\n                if (VIR_APPEND_ELEMENT(caps->host.cache.banks,\n                                       caps->host.cache.nbanks,\n                                       bank) < 0) {\n                    goto cleanup;\n                }\n            }\n\n            virCapsHostCacheBankFree(bank);\n            bank = NULL;\n        }\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    /* Sort the array in order for the tests to be predictable.  This way we can\n     * still traverse the directory instead of guessing names (in case there is\n     * 'index1' and 'index3' but no 'index2'). */\n    qsort(caps->host.cache.banks, caps->host.cache.nbanks,\n          sizeof(*caps->host.cache.banks), virCapsHostCacheBankSorter);\n\n    if (virCapabilitiesInitResctrlMemory(caps) < 0)\n        goto cleanup;\n\n    if (virResctrlInfoGetMonitorPrefix(caps->host.resctrl, prefix,\n                                       &caps->host.cache.monitor) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(type);\n    VIR_FREE(path);\n    VIR_DIR_CLOSE(dirp);\n    virCapsHostCacheBankFree(bank);\n    virBitmapFree(cpus);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSFS_SYSTEM_PATH \"/sys/devices/system\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\n#define SYSFS_SYSTEM_PATH \"/sys/devices/system\"\n\nint\nvirCapabilitiesInitCaches(virCapsPtr caps)\n{\n    size_t i = 0;\n    virBitmapPtr cpus = NULL;\n    ssize_t pos = -1;\n    DIR *dirp = NULL;\n    int ret = -1;\n    char *path = NULL;\n    char *type = NULL;\n    struct dirent *ent = NULL;\n    virCapsHostCacheBankPtr bank = NULL;\n    const virResctrlMonitorType montype = VIR_RESCTRL_MONITOR_TYPE_CACHE;\n    const char *prefix = virResctrlMonitorPrefixTypeToString(montype);\n\n    /* Minimum level to expose in capabilities.  Can be lowered or removed (with\n     * the appropriate code below), but should not be increased, because we'd\n     * lose information. */\n    const int cache_min_level = 3;\n\n    if (virCapabilitiesInitResctrl(caps) < 0)\n        return -1;\n\n    /* offline CPUs don't provide cache info */\n    if (virFileReadValueBitmap(&cpus, \"%s/cpu/online\", SYSFS_SYSTEM_PATH) < 0)\n        return -1;\n\n    while ((pos = virBitmapNextSetBit(cpus, pos)) >= 0) {\n        int rv = -1;\n\n        VIR_FREE(path);\n        path = g_strdup_printf(\"%s/cpu/cpu%zd/cache/\", SYSFS_SYSTEM_PATH, pos);\n\n        VIR_DIR_CLOSE(dirp);\n\n        rv = virDirOpenIfExists(&dirp, path);\n        if (rv < 0)\n            goto cleanup;\n\n        if (!dirp)\n            continue;\n\n        while ((rv = virDirRead(dirp, &ent, path)) > 0) {\n            int kernel_type;\n            unsigned int level;\n\n            if (!STRPREFIX(ent->d_name, \"index\"))\n                continue;\n\n            if (virFileReadValueUint(&level,\n                                     \"%s/cpu/cpu%zd/cache/%s/level\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (level < cache_min_level)\n                continue;\n\n            if (VIR_ALLOC(bank) < 0)\n                goto cleanup;\n\n            bank->level = level;\n\n            if (virFileReadValueUint(&bank->id,\n                                     \"%s/cpu/cpu%zd/cache/%s/id\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueUint(&bank->level,\n                                     \"%s/cpu/cpu%zd/cache/%s/level\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueString(&type,\n                                       \"%s/cpu/cpu%zd/cache/%s/type\",\n                                       SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueScaledInt(&bank->size,\n                                          \"%s/cpu/cpu%zd/cache/%s/size\",\n                                          SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueBitmap(&bank->cpus,\n                                       \"%s/cpu/cpu%zd/cache/%s/shared_cpu_list\",\n                                       SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            kernel_type = virCacheKernelTypeFromString(type);\n            if (kernel_type < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unknown cache type '%s'\"), type);\n                goto cleanup;\n            }\n\n            bank->type = kernel_type;\n            VIR_FREE(type);\n\n            for (i = 0; i < caps->host.cache.nbanks; i++) {\n                if (virCapsHostCacheBankEquals(bank, caps->host.cache.banks[i]))\n                    break;\n            }\n            if (i == caps->host.cache.nbanks) {\n                /* If it is a new cache, then update its resctrl information. */\n                if (virResctrlInfoGetCache(caps->host.resctrl,\n                                           bank->level,\n                                           bank->size,\n                                           &bank->ncontrols,\n                                           &bank->controls) < 0)\n                    goto cleanup;\n\n                if (VIR_APPEND_ELEMENT(caps->host.cache.banks,\n                                       caps->host.cache.nbanks,\n                                       bank) < 0) {\n                    goto cleanup;\n                }\n            }\n\n            virCapsHostCacheBankFree(bank);\n            bank = NULL;\n        }\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    /* Sort the array in order for the tests to be predictable.  This way we can\n     * still traverse the directory instead of guessing names (in case there is\n     * 'index1' and 'index3' but no 'index2'). */\n    qsort(caps->host.cache.banks, caps->host.cache.nbanks,\n          sizeof(*caps->host.cache.banks), virCapsHostCacheBankSorter);\n\n    if (virCapabilitiesInitResctrlMemory(caps) < 0)\n        goto cleanup;\n\n    if (virResctrlInfoGetMonitorPrefix(caps->host.resctrl, prefix,\n                                       &caps->host.cache.monitor) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(type);\n    VIR_FREE(path);\n    VIR_DIR_CLOSE(dirp);\n    virCapsHostCacheBankFree(bank);\n    virBitmapFree(cpus);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesHostNUMANewHost",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesHostNUMANewHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1714-1734",
          "snippet": "virCapsHostNUMAPtr\nvirCapabilitiesHostNUMANewHost(void)\n{\n    virCapsHostNUMAPtr caps = virCapabilitiesHostNUMANew();\n\n    if (virNumaIsAvailable()) {\n        if (virCapabilitiesHostNUMAInitReal(caps) == 0)\n            return caps;\n\n        virCapabilitiesHostNUMAUnref(caps);\n        caps = virCapabilitiesHostNUMANew();\n        VIR_WARN(\"Failed to query host NUMA topology, faking single NUMA node\");\n    }\n\n    if (virCapabilitiesHostNUMAInitFake(caps) < 0) {\n        virCapabilitiesHostNUMAUnref(caps);\n        return NULL;\n    }\n\n    return caps;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsHostNUMAPtr\nvirCapabilitiesHostNUMANewHost(void)\n{\n    virCapsHostNUMAPtr caps = virCapabilitiesHostNUMANew();\n\n    if (virNumaIsAvailable()) {\n        if (virCapabilitiesHostNUMAInitReal(caps) == 0)\n            return caps;\n\n        virCapabilitiesHostNUMAUnref(caps);\n        caps = virCapabilitiesHostNUMANew();\n        VIR_WARN(\"Failed to query host NUMA topology, faking single NUMA node\");\n    }\n\n    if (virCapabilitiesHostNUMAInitFake(caps) < 0) {\n        virCapabilitiesHostNUMAUnref(caps);\n        return NULL;\n    }\n\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesNew",
          "args": [
            "virArchFromHost()",
            "false",
            "false"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "78-96",
          "snippet": "virCapsPtr\nvirCapabilitiesNew(virArch hostarch,\n                   bool offlineMigrate,\n                   bool liveMigrate)\n{\n    virCapsPtr caps;\n\n    if (virCapabilitiesInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectNew(virCapsClass)))\n        return NULL;\n\n    caps->host.arch = hostarch;\n    caps->host.offlineMigrate = offlineMigrate;\n    caps->host.liveMigrate = liveMigrate;\n\n    return caps;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virCapsClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virCapsClass;\n\nvirCapsPtr\nvirCapabilitiesNew(virArch hostarch,\n                   bool offlineMigrate,\n                   bool liveMigrate)\n{\n    virCapsPtr caps;\n\n    if (virCapabilitiesInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectNew(virCapsClass)))\n        return NULL;\n\n    caps->host.arch = hostarch;\n    caps->host.offlineMigrate = offlineMigrate;\n    caps->host.liveMigrate = liveMigrate;\n\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virArchFromHost",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virArchFromHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarch.c",
          "lines": "206-235",
          "snippet": "virArch virArchFromHost(void)\n{\n    struct utsname ut;\n    virArch arch;\n\n    uname(&ut);\n\n    /* Some special cases we need to handle first\n     * for non-canonical names */\n    if (strlen(ut.machine) == 4 &&\n        ut.machine[0] == 'i' &&\n        ut.machine[2] == '8' &&\n        ut.machine[3] == '6' &&\n        ut.machine[4] == '\\0') {\n        arch = VIR_ARCH_I686;\n    } else if (STREQ(ut.machine, \"amd64\")) {\n        arch = VIR_ARCH_X86_64;\n    } else {\n        /* Otherwise assume the canonical name */\n        if ((arch = virArchFromString(ut.machine)) == VIR_ARCH_NONE) {\n            VIR_WARN(\"Unknown host arch %s, report to libvir-list@redhat.com\",\n                     ut.machine);\n        }\n    }\n\n    VIR_DEBUG(\"Mapped %s to %d (%s)\",\n              ut.machine, arch, virArchToString(arch));\n\n    return arch;\n}",
          "includes": [
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "# include <sys/utsname.h>",
            "# include <windows.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virarch.h\"\n#include \"virlog.h\"\n# include <sys/utsname.h>\n# include <windows.h>\n#include <config.h>\n\nvirArch virArchFromHost(void)\n{\n    struct utsname ut;\n    virArch arch;\n\n    uname(&ut);\n\n    /* Some special cases we need to handle first\n     * for non-canonical names */\n    if (strlen(ut.machine) == 4 &&\n        ut.machine[0] == 'i' &&\n        ut.machine[2] == '8' &&\n        ut.machine[3] == '6' &&\n        ut.machine[4] == '\\0') {\n        arch = VIR_ARCH_I686;\n    } else if (STREQ(ut.machine, \"amd64\")) {\n        arch = VIR_ARCH_X86_64;\n    } else {\n        /* Otherwise assume the canonical name */\n        if ((arch = virArchFromString(ut.machine)) == VIR_ARCH_NONE) {\n            VIR_WARN(\"Unknown host arch %s, report to libvir-list@redhat.com\",\n                     ut.machine);\n        }\n    }\n\n    VIR_DEBUG(\"Mapped %s to %d (%s)\",\n              ut.machine, arch, virArchToString(arch));\n\n    return arch;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virCapsPtr\nvzBuildCapabilities(void)\n{\n    virCapsPtr caps = NULL;\n    virNodeInfo nodeinfo;\n    virDomainOSType ostypes[] = {\n        VIR_DOMAIN_OSTYPE_HVM,\n        VIR_DOMAIN_OSTYPE_EXE\n    };\n    virArch archs[] = { VIR_ARCH_I686, VIR_ARCH_X86_64 };\n    const char *const emulators[] = { \"vz\", \"parallels\"};\n    virDomainVirtType virt_types[] = {\n        VIR_DOMAIN_VIRT_VZ,\n        VIR_DOMAIN_VIRT_PARALLELS\n    };\n    size_t i, j, k;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if (!(caps->host.numa = virCapabilitiesHostNUMANewHost()))\n        goto error;\n\n    if (virCapabilitiesInitCaches(caps) < 0)\n        goto error;\n\n    G_STATIC_ASSERT(G_N_ELEMENTS(archs) == G_N_ELEMENTS(emulators));\n\n    for (i = 0; i < G_N_ELEMENTS(ostypes); i++)\n        for (j = 0; j < G_N_ELEMENTS(archs); j++)\n            for (k = 0; k < G_N_ELEMENTS(emulators); k++)\n                if (vzCapsAddGuestDomain(caps, ostypes[i], archs[j],\n                                         emulators[k], virt_types[k]) < 0)\n                    goto error;\n\n    if (virCapabilitiesGetNodeInfo(&nodeinfo))\n        goto error;\n\n    if (!(caps->host.cpu = virCPUGetHost(caps->host.arch, VIR_CPU_TYPE_HOST,\n                                         &nodeinfo, NULL)))\n        goto error;\n\n    if (virCapabilitiesAddHostMigrateTransport(caps, \"vzmigr\") < 0)\n        goto error;\n\n    return caps;\n\n error:\n    virObjectUnref(caps);\n    return NULL;\n}"
  },
  {
    "function_name": "vzCapsAddGuestDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vz/vz_driver.c",
    "lines": "77-96",
    "snippet": "static int\nvzCapsAddGuestDomain(virCapsPtr caps,\n                     virDomainOSType ostype,\n                     virArch arch,\n                     const char * emulator,\n                     virDomainVirtType virt_type)\n{\n    virCapsGuestPtr guest;\n\n    if ((guest = virCapabilitiesAddGuest(caps, ostype, arch, emulator,\n                                         NULL, 0, NULL)) == NULL)\n        return -1;\n\n\n    if (virCapabilitiesAddGuestDomain(guest, virt_type,\n                                      NULL, NULL, 0, NULL) == NULL)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"vz_sdk.h\"",
      "#include \"vz_utils.h\"",
      "#include \"vz_driver.h\"",
      "#include \"virutil.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virstring.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"vircommand.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/statvfs.h>",
      "#include <sys/time.h>",
      "#include <pwd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/poll.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesAddGuestDomain",
          "args": [
            "guest",
            "virt_type",
            "NULL",
            "NULL",
            "0",
            "NULL"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesAddGuestDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "485-518",
          "snippet": "virCapsGuestDomainPtr\nvirCapabilitiesAddGuestDomain(virCapsGuestPtr guest,\n                              int hvtype,\n                              const char *emulator,\n                              const char *loader,\n                              int nmachines,\n                              virCapsGuestMachinePtr *machines)\n{\n    virCapsGuestDomainPtr dom;\n\n    if (VIR_ALLOC(dom) < 0)\n        goto error;\n\n    dom->type = hvtype;\n    dom->info.emulator = g_strdup(emulator);\n    dom->info.loader = g_strdup(loader);\n\n    if (VIR_RESIZE_N(guest->arch.domains, guest->arch.ndomains_max,\n                     guest->arch.ndomains, 1) < 0)\n        goto error;\n    guest->arch.domains[guest->arch.ndomains] = dom;\n    guest->arch.ndomains++;\n\n    if (nmachines) {\n        dom->info.nmachines = nmachines;\n        dom->info.machines = machines;\n    }\n\n    return dom;\n\n error:\n    virCapabilitiesFreeGuestDomain(dom);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsGuestDomainPtr\nvirCapabilitiesAddGuestDomain(virCapsGuestPtr guest,\n                              int hvtype,\n                              const char *emulator,\n                              const char *loader,\n                              int nmachines,\n                              virCapsGuestMachinePtr *machines)\n{\n    virCapsGuestDomainPtr dom;\n\n    if (VIR_ALLOC(dom) < 0)\n        goto error;\n\n    dom->type = hvtype;\n    dom->info.emulator = g_strdup(emulator);\n    dom->info.loader = g_strdup(loader);\n\n    if (VIR_RESIZE_N(guest->arch.domains, guest->arch.ndomains_max,\n                     guest->arch.ndomains, 1) < 0)\n        goto error;\n    guest->arch.domains[guest->arch.ndomains] = dom;\n    guest->arch.ndomains++;\n\n    if (nmachines) {\n        dom->info.nmachines = nmachines;\n        dom->info.machines = machines;\n    }\n\n    return dom;\n\n error:\n    virCapabilitiesFreeGuestDomain(dom);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesAddGuest",
          "args": [
            "caps",
            "ostype",
            "arch",
            "emulator",
            "NULL",
            "0",
            "NULL"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesAddGuest",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "434-470",
          "snippet": "virCapsGuestPtr\nvirCapabilitiesAddGuest(virCapsPtr caps,\n                        int ostype,\n                        virArch arch,\n                        const char *emulator,\n                        const char *loader,\n                        int nmachines,\n                        virCapsGuestMachinePtr *machines)\n{\n    virCapsGuestPtr guest;\n\n    if (VIR_ALLOC(guest) < 0)\n        goto error;\n\n    guest->ostype = ostype;\n    guest->arch.id = arch;\n    guest->arch.wordsize = virArchGetWordSize(arch);\n\n    guest->arch.defaultInfo.emulator = g_strdup(emulator);\n    guest->arch.defaultInfo.loader = g_strdup(loader);\n\n    if (VIR_RESIZE_N(caps->guests, caps->nguests_max,\n                     caps->nguests, 1) < 0)\n        goto error;\n    caps->guests[caps->nguests++] = guest;\n\n    if (nmachines) {\n        guest->arch.defaultInfo.nmachines = nmachines;\n        guest->arch.defaultInfo.machines = machines;\n    }\n\n    return guest;\n\n error:\n    virCapabilitiesFreeGuest(guest);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsGuestPtr\nvirCapabilitiesAddGuest(virCapsPtr caps,\n                        int ostype,\n                        virArch arch,\n                        const char *emulator,\n                        const char *loader,\n                        int nmachines,\n                        virCapsGuestMachinePtr *machines)\n{\n    virCapsGuestPtr guest;\n\n    if (VIR_ALLOC(guest) < 0)\n        goto error;\n\n    guest->ostype = ostype;\n    guest->arch.id = arch;\n    guest->arch.wordsize = virArchGetWordSize(arch);\n\n    guest->arch.defaultInfo.emulator = g_strdup(emulator);\n    guest->arch.defaultInfo.loader = g_strdup(loader);\n\n    if (VIR_RESIZE_N(caps->guests, caps->nguests_max,\n                     caps->nguests, 1) < 0)\n        goto error;\n    caps->guests[caps->nguests++] = guest;\n\n    if (nmachines) {\n        guest->arch.defaultInfo.nmachines = nmachines;\n        guest->arch.defaultInfo.machines = machines;\n    }\n\n    return guest;\n\n error:\n    virCapabilitiesFreeGuest(guest);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vz_sdk.h\"\n#include \"vz_utils.h\"\n#include \"vz_driver.h\"\n#include \"virutil.h\"\n#include \"viraccessapicheck.h\"\n#include \"virhostcpu.h\"\n#include \"virhostmem.h\"\n#include \"virtypedparam.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/statvfs.h>\n#include <sys/time.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvzCapsAddGuestDomain(virCapsPtr caps,\n                     virDomainOSType ostype,\n                     virArch arch,\n                     const char * emulator,\n                     virDomainVirtType virt_type)\n{\n    virCapsGuestPtr guest;\n\n    if ((guest = virCapabilitiesAddGuest(caps, ostype, arch, emulator,\n                                         NULL, 0, NULL)) == NULL)\n        return -1;\n\n\n    if (virCapabilitiesAddGuestDomain(guest, virt_type,\n                                      NULL, NULL, 0, NULL) == NULL)\n        return -1;\n\n    return 0;\n}"
  }
]