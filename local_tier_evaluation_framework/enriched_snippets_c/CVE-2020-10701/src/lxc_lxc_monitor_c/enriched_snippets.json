[
  {
    "function_name": "virLXCMonitorClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_monitor.c",
    "lines": "206-232",
    "snippet": "void virLXCMonitorClose(virLXCMonitorPtr mon)\n{\n    virDomainObjPtr vm;\n    virNetClientPtr client;\n\n    VIR_DEBUG(\"mon=%p\", mon);\n    if (mon->client) {\n        /* When manually closing the monitor, we don't\n         * want to have callbacks back into us, since\n         * the caller is not re-entrant safe\n         */\n        VIR_DEBUG(\"Clear EOF callback mon=%p\", mon);\n        vm = mon->vm;\n        client = mon->client;\n        mon->client = NULL;\n        mon->cb.eofNotify = NULL;\n\n        virObjectRef(vm);\n        virObjectUnlock(vm);\n\n        virNetClientClose(client);\n        virObjectUnref(client);\n\n        virObjectLock(vm);\n        virObjectUnref(vm);\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"rpc/virnetclient.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_monitor_dispatch.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_monitor.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "vm"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "vm"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetClientClose",
          "args": [
            "client"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virNetClientClose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetclient.c",
          "lines": "803-806",
          "snippet": "void virNetClientClose(virNetClientPtr client)\n{\n    virNetClientCloseInternal(client, VIR_CONNECT_CLOSE_REASON_CLIENT);\n}",
          "includes": [
            "#include \"vireventglibwatch.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virerror.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virnetclient.h\"",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vireventglibwatch.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virerror.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virkeepalive.h\"\n#include \"virnetsocket.h\"\n#include \"virnetclient.h\"\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid virNetClientClose(virNetClientPtr client)\n{\n    virNetClientCloseInternal(client, VIR_CONNECT_CLOSE_REASON_CLIENT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "vm"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "vm"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Clear EOF callback mon=%p\"",
            "mon"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"mon=%p\"",
            "mon"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"rpc/virnetclient.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"lxc_monitor_dispatch.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_monitor.h\"\n#include <config.h>\n\nvoid virLXCMonitorClose(virLXCMonitorPtr mon)\n{\n    virDomainObjPtr vm;\n    virNetClientPtr client;\n\n    VIR_DEBUG(\"mon=%p\", mon);\n    if (mon->client) {\n        /* When manually closing the monitor, we don't\n         * want to have callbacks back into us, since\n         * the caller is not re-entrant safe\n         */\n        VIR_DEBUG(\"Clear EOF callback mon=%p\", mon);\n        vm = mon->vm;\n        client = mon->client;\n        mon->client = NULL;\n        mon->cb.eofNotify = NULL;\n\n        virObjectRef(vm);\n        virObjectUnlock(vm);\n\n        virNetClientClose(client);\n        virObjectUnref(client);\n\n        virObjectLock(vm);\n        virObjectUnref(vm);\n    }\n}"
  },
  {
    "function_name": "virLXCMonitorDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_monitor.c",
    "lines": "194-203",
    "snippet": "static void virLXCMonitorDispose(void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n\n    VIR_DEBUG(\"mon=%p\", mon);\n    if (mon->cb.destroy)\n        (mon->cb.destroy)(mon, mon->vm);\n    virObjectUnref(mon->program);\n    virObjectUnref(mon->vm);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"rpc/virnetclient.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_monitor_dispatch.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_monitor.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);",
      "static void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "mon->vm"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "mon",
            "mon->vm"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"mon=%p\"",
            "mon"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"rpc/virnetclient.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"lxc_monitor_dispatch.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_monitor.h\"\n#include <config.h>\n\nstatic void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\nstatic void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\n\nstatic void virLXCMonitorDispose(void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n\n    VIR_DEBUG(\"mon=%p\", mon);\n    if (mon->cb.destroy)\n        (mon->cb.destroy)(mon, mon->vm);\n    virObjectUnref(mon->program);\n    virObjectUnref(mon->vm);\n}"
  },
  {
    "function_name": "virLXCMonitorNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_monitor.c",
    "lines": "141-191",
    "snippet": "virLXCMonitorPtr virLXCMonitorNew(virDomainObjPtr vm,\n                                  const char *socketdir,\n                                  virLXCMonitorCallbacksPtr cb)\n{\n    virLXCMonitorPtr mon;\n    char *sockpath = NULL;\n\n    if (virLXCMonitorInitialize() < 0)\n        return NULL;\n\n    if (!(mon = virObjectLockableNew(virLXCMonitorClass)))\n        return NULL;\n\n    sockpath = g_strdup_printf(\"%s/%s.sock\", socketdir, vm->def->name);\n\n    if (!(mon->client = virNetClientNewUNIX(sockpath, false, NULL)))\n        goto error;\n\n    if (virNetClientRegisterAsyncIO(mon->client) < 0)\n        goto error;\n\n    /* avoid deadlock by making this call before assigning virLXCMonitorEvents */\n    virNetClientSetCloseCallback(mon->client, virLXCMonitorEOFNotify, mon,\n                                 virLXCMonitorCloseFreeCallback);\n\n    /* close callback now has its own reference */\n    virObjectRef(mon);\n\n    if (!(mon->program = virNetClientProgramNew(VIR_LXC_MONITOR_PROGRAM,\n                                                VIR_LXC_MONITOR_PROGRAM_VERSION,\n                                                virLXCMonitorEvents,\n                                                G_N_ELEMENTS(virLXCMonitorEvents),\n                                                mon)))\n        goto error;\n\n    if (virNetClientAddProgram(mon->client,\n                               mon->program) < 0)\n        goto error;\n\n    mon->vm = virObjectRef(vm);\n    memcpy(&mon->cb, cb, sizeof(mon->cb));\n\n cleanup:\n    VIR_FREE(sockpath);\n    return mon;\n\n error:\n    virObjectUnref(mon);\n    mon = NULL;\n    goto cleanup;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"rpc/virnetclient.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_monitor_dispatch.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_monitor.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virLXCMonitorClass;",
      "static virNetClientProgramEvent virLXCMonitorEvents[] = {\n    { VIR_LXC_MONITOR_PROC_EXIT_EVENT,\n      virLXCMonitorHandleEventExit,\n      sizeof(virLXCMonitorExitEventMsg),\n      (xdrproc_t)xdr_virLXCMonitorExitEventMsg },\n    { VIR_LXC_MONITOR_PROC_INIT_EVENT,\n      virLXCMonitorHandleEventInit,\n      sizeof(virLXCMonitorInitEventMsg),\n      (xdrproc_t)xdr_virLXCMonitorInitEventMsg },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "mon"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "sockpath"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&mon->cb",
            "cb",
            "sizeof(mon->cb)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "vm"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetClientAddProgram",
          "args": [
            "mon->client",
            "mon->program"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "virNetClientAddProgram",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetclient.c",
          "lines": "1005-1021",
          "snippet": "int virNetClientAddProgram(virNetClientPtr client,\n                           virNetClientProgramPtr prog)\n{\n    virObjectLock(client);\n\n    if (VIR_EXPAND_N(client->programs, client->nprograms, 1) < 0)\n        goto error;\n\n    client->programs[client->nprograms-1] = virObjectRef(prog);\n\n    virObjectUnlock(client);\n    return 0;\n\n error:\n    virObjectUnlock(client);\n    return -1;\n}",
          "includes": [
            "#include \"vireventglibwatch.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virerror.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virnetclient.h\"",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vireventglibwatch.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virerror.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virkeepalive.h\"\n#include \"virnetsocket.h\"\n#include \"virnetclient.h\"\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <config.h>\n\nint virNetClientAddProgram(virNetClientPtr client,\n                           virNetClientProgramPtr prog)\n{\n    virObjectLock(client);\n\n    if (VIR_EXPAND_N(client->programs, client->nprograms, 1) < 0)\n        goto error;\n\n    client->programs[client->nprograms-1] = virObjectRef(prog);\n\n    virObjectUnlock(client);\n    return 0;\n\n error:\n    virObjectUnlock(client);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetClientProgramNew",
          "args": [
            "VIR_LXC_MONITOR_PROGRAM",
            "VIR_LXC_MONITOR_PROGRAM_VERSION",
            "virLXCMonitorEvents",
            "G_N_ELEMENTS(virLXCMonitorEvents)",
            "mon"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virNetClientProgramNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetclientprogram.c",
          "lines": "64-85",
          "snippet": "virNetClientProgramPtr virNetClientProgramNew(unsigned program,\n                                              unsigned version,\n                                              virNetClientProgramEventPtr events,\n                                              size_t nevents,\n                                              void *eventOpaque)\n{\n    virNetClientProgramPtr prog;\n\n    if (virNetClientProgramInitialize() < 0)\n        return NULL;\n\n    if (!(prog = virObjectNew(virNetClientProgramClass)))\n        return NULL;\n\n    prog->program = program;\n    prog->version = version;\n    prog->events = events;\n    prog->nevents = nevents;\n    prog->eventOpaque = eventOpaque;\n\n    return prog;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetprotocol.h\"",
            "#include \"virnetclient.h\"",
            "#include \"virnetclientprogram.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virNetClientProgramClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetprotocol.h\"\n#include \"virnetclient.h\"\n#include \"virnetclientprogram.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virNetClientProgramClass;\n\nvirNetClientProgramPtr virNetClientProgramNew(unsigned program,\n                                              unsigned version,\n                                              virNetClientProgramEventPtr events,\n                                              size_t nevents,\n                                              void *eventOpaque)\n{\n    virNetClientProgramPtr prog;\n\n    if (virNetClientProgramInitialize() < 0)\n        return NULL;\n\n    if (!(prog = virObjectNew(virNetClientProgramClass)))\n        return NULL;\n\n    prog->program = program;\n    prog->version = version;\n    prog->events = events;\n    prog->nevents = nevents;\n    prog->eventOpaque = eventOpaque;\n\n    return prog;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "virLXCMonitorEvents"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetClientSetCloseCallback",
          "args": [
            "mon->client",
            "virLXCMonitorEOFNotify",
            "mon",
            "virLXCMonitorCloseFreeCallback"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "virNetClientSetCloseCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetclient.c",
          "lines": "134-144",
          "snippet": "void virNetClientSetCloseCallback(virNetClientPtr client,\n                                  virNetClientCloseFunc cb,\n                                  void *opaque,\n                                  virFreeCallback ff)\n{\n    virObjectLock(client);\n    client->closeCb = cb;\n    client->closeOpaque = opaque;\n    client->closeFf = ff;\n    virObjectUnlock(client);\n}",
          "includes": [
            "#include \"vireventglibwatch.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virerror.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virnetclient.h\"",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetClientIncomingEvent(virNetSocketPtr sock,\n                                      int events,\n                                      void *opaque);",
            "static gboolean\nvirNetClientIOEventTLS(int fd,\n                       GIOCondition ev,\n                       gpointer opaque);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vireventglibwatch.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virerror.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virkeepalive.h\"\n#include \"virnetsocket.h\"\n#include \"virnetclient.h\"\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNetClientIncomingEvent(virNetSocketPtr sock,\n                                      int events,\n                                      void *opaque);\nstatic gboolean\nvirNetClientIOEventTLS(int fd,\n                       GIOCondition ev,\n                       gpointer opaque);\n\nvoid virNetClientSetCloseCallback(virNetClientPtr client,\n                                  virNetClientCloseFunc cb,\n                                  void *opaque,\n                                  virFreeCallback ff)\n{\n    virObjectLock(client);\n    client->closeCb = cb;\n    client->closeOpaque = opaque;\n    client->closeFf = ff;\n    virObjectUnlock(client);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetClientRegisterAsyncIO",
          "args": [
            "mon->client"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "virNetClientRegisterAsyncIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetclient.c",
          "lines": "594-614",
          "snippet": "int virNetClientRegisterAsyncIO(virNetClientPtr client)\n{\n    if (client->asyncIO)\n        return 0;\n\n    /* Set up a callback to listen on the socket data */\n    virObjectRef(client);\n    if (virNetSocketAddIOCallback(client->sock,\n                                  VIR_EVENT_HANDLE_READABLE,\n                                  virNetClientIncomingEvent,\n                                  client,\n                                  virObjectFreeCallback) < 0) {\n        virObjectUnref(client);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to register async IO callback\"));\n        return -1;\n    }\n\n    client->asyncIO = true;\n    return 0;\n}",
          "includes": [
            "#include \"vireventglibwatch.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virerror.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virnetclient.h\"",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vireventglibwatch.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virerror.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virkeepalive.h\"\n#include \"virnetsocket.h\"\n#include \"virnetclient.h\"\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <config.h>\n\nint virNetClientRegisterAsyncIO(virNetClientPtr client)\n{\n    if (client->asyncIO)\n        return 0;\n\n    /* Set up a callback to listen on the socket data */\n    virObjectRef(client);\n    if (virNetSocketAddIOCallback(client->sock,\n                                  VIR_EVENT_HANDLE_READABLE,\n                                  virNetClientIncomingEvent,\n                                  client,\n                                  virObjectFreeCallback) < 0) {\n        virObjectUnref(client);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to register async IO callback\"));\n        return -1;\n    }\n\n    client->asyncIO = true;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetClientNewUNIX",
          "args": [
            "sockpath",
            "false",
            "NULL"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "virNetClientNewUNIX",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetclient.c",
          "lines": "367-377",
          "snippet": "virNetClientPtr virNetClientNewUNIX(const char *path,\n                                    bool spawnDaemon,\n                                    const char *binary)\n{\n    virNetSocketPtr sock;\n\n    if (virNetSocketNewConnectUNIX(path, spawnDaemon, binary, &sock) < 0)\n        return NULL;\n\n    return virNetClientNew(sock, NULL);\n}",
          "includes": [
            "#include \"vireventglibwatch.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virerror.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virnetsocket.h\"",
            "#include \"virnetclient.h\"",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vireventglibwatch.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virerror.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virkeepalive.h\"\n#include \"virnetsocket.h\"\n#include \"virnetclient.h\"\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetClientPtr virNetClientNewUNIX(const char *path,\n                                    bool spawnDaemon,\n                                    const char *binary)\n{\n    virNetSocketPtr sock;\n\n    if (virNetSocketNewConnectUNIX(path, spawnDaemon, binary, &sock) < 0)\n        return NULL;\n\n    return virNetClientNew(sock, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s.sock\"",
            "socketdir",
            "vm->def->name"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virLXCMonitorClass"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCMonitorInitialize",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"rpc/virnetclient.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"lxc_monitor_dispatch.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_monitor.h\"\n#include <config.h>\n\nstatic virClassPtr virLXCMonitorClass;\nstatic virNetClientProgramEvent virLXCMonitorEvents[] = {\n    { VIR_LXC_MONITOR_PROC_EXIT_EVENT,\n      virLXCMonitorHandleEventExit,\n      sizeof(virLXCMonitorExitEventMsg),\n      (xdrproc_t)xdr_virLXCMonitorExitEventMsg },\n    { VIR_LXC_MONITOR_PROC_INIT_EVENT,\n      virLXCMonitorHandleEventInit,\n      sizeof(virLXCMonitorInitEventMsg),\n      (xdrproc_t)xdr_virLXCMonitorInitEventMsg },\n};\n\nvirLXCMonitorPtr virLXCMonitorNew(virDomainObjPtr vm,\n                                  const char *socketdir,\n                                  virLXCMonitorCallbacksPtr cb)\n{\n    virLXCMonitorPtr mon;\n    char *sockpath = NULL;\n\n    if (virLXCMonitorInitialize() < 0)\n        return NULL;\n\n    if (!(mon = virObjectLockableNew(virLXCMonitorClass)))\n        return NULL;\n\n    sockpath = g_strdup_printf(\"%s/%s.sock\", socketdir, vm->def->name);\n\n    if (!(mon->client = virNetClientNewUNIX(sockpath, false, NULL)))\n        goto error;\n\n    if (virNetClientRegisterAsyncIO(mon->client) < 0)\n        goto error;\n\n    /* avoid deadlock by making this call before assigning virLXCMonitorEvents */\n    virNetClientSetCloseCallback(mon->client, virLXCMonitorEOFNotify, mon,\n                                 virLXCMonitorCloseFreeCallback);\n\n    /* close callback now has its own reference */\n    virObjectRef(mon);\n\n    if (!(mon->program = virNetClientProgramNew(VIR_LXC_MONITOR_PROGRAM,\n                                                VIR_LXC_MONITOR_PROGRAM_VERSION,\n                                                virLXCMonitorEvents,\n                                                G_N_ELEMENTS(virLXCMonitorEvents),\n                                                mon)))\n        goto error;\n\n    if (virNetClientAddProgram(mon->client,\n                               mon->program) < 0)\n        goto error;\n\n    mon->vm = virObjectRef(vm);\n    memcpy(&mon->cb, cb, sizeof(mon->cb));\n\n cleanup:\n    VIR_FREE(sockpath);\n    return mon;\n\n error:\n    virObjectUnref(mon);\n    mon = NULL;\n    goto cleanup;\n}"
  },
  {
    "function_name": "virLXCMonitorCloseFreeCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_monitor.c",
    "lines": "134-138",
    "snippet": "static void virLXCMonitorCloseFreeCallback(void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n    virObjectUnref(mon);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"rpc/virnetclient.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_monitor_dispatch.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_monitor.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);",
      "static void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "mon"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"rpc/virnetclient.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"lxc_monitor_dispatch.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_monitor.h\"\n#include <config.h>\n\nstatic void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\nstatic void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\n\nstatic void virLXCMonitorCloseFreeCallback(void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n    virObjectUnref(mon);\n}"
  },
  {
    "function_name": "virLXCMonitorEOFNotify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_monitor.c",
    "lines": "111-131",
    "snippet": "static void virLXCMonitorEOFNotify(virNetClientPtr client G_GNUC_UNUSED,\n                                   int reason G_GNUC_UNUSED,\n                                   void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n    virLXCMonitorCallbackEOFNotify eofNotify;\n    virDomainObjPtr vm;\n\n    VIR_DEBUG(\"EOF notify mon=%p\", mon);\n    virObjectLock(mon);\n    eofNotify = mon->cb.eofNotify;\n    vm = mon->vm;\n    virObjectUnlock(mon);\n\n    if (eofNotify) {\n        VIR_DEBUG(\"EOF callback mon=%p vm=%p\", mon, vm);\n        eofNotify(mon, vm);\n    } else {\n        VIR_DEBUG(\"No EOF callback\");\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"rpc/virnetclient.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_monitor_dispatch.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_monitor.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);",
      "static void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"No EOF callback\""
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eofNotify",
          "args": [
            "mon",
            "vm"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"EOF callback mon=%p vm=%p\"",
            "mon",
            "vm"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "mon"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "mon"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"EOF notify mon=%p\"",
            "mon"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"rpc/virnetclient.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"lxc_monitor_dispatch.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_monitor.h\"\n#include <config.h>\n\nstatic void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\nstatic void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\n\nstatic void virLXCMonitorEOFNotify(virNetClientPtr client G_GNUC_UNUSED,\n                                   int reason G_GNUC_UNUSED,\n                                   void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n    virLXCMonitorCallbackEOFNotify eofNotify;\n    virDomainObjPtr vm;\n\n    VIR_DEBUG(\"EOF notify mon=%p\", mon);\n    virObjectLock(mon);\n    eofNotify = mon->cb.eofNotify;\n    vm = mon->vm;\n    virObjectUnlock(mon);\n\n    if (eofNotify) {\n        VIR_DEBUG(\"EOF callback mon=%p vm=%p\", mon, vm);\n        eofNotify(mon, vm);\n    } else {\n        VIR_DEBUG(\"No EOF callback\");\n    }\n}"
  },
  {
    "function_name": "virLXCMonitorHandleEventInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_monitor.c",
    "lines": "97-108",
    "snippet": "static void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog G_GNUC_UNUSED,\n                             virNetClientPtr client G_GNUC_UNUSED,\n                             void *evdata, void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n    virLXCMonitorInitEventMsg *msg = evdata;\n\n    VIR_DEBUG(\"Event init %lld\", (long long)msg->initpid);\n    if (mon->cb.initNotify)\n        mon->cb.initNotify(mon, (pid_t)msg->initpid, mon->vm);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"rpc/virnetclient.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_monitor_dispatch.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_monitor.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);",
      "static void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mon->cb.initNotify",
          "args": [
            "mon",
            "(pid_t)msg->initpid",
            "mon->vm"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Event init %lld\"",
            "(long long)msg->initpid"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"rpc/virnetclient.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"lxc_monitor_dispatch.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_monitor.h\"\n#include <config.h>\n\nstatic void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\nstatic void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\n\nstatic void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog G_GNUC_UNUSED,\n                             virNetClientPtr client G_GNUC_UNUSED,\n                             void *evdata, void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n    virLXCMonitorInitEventMsg *msg = evdata;\n\n    VIR_DEBUG(\"Event init %lld\", (long long)msg->initpid);\n    if (mon->cb.initNotify)\n        mon->cb.initNotify(mon, (pid_t)msg->initpid, mon->vm);\n}"
  },
  {
    "function_name": "virLXCMonitorHandleEventExit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_monitor.c",
    "lines": "83-94",
    "snippet": "static void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog G_GNUC_UNUSED,\n                             virNetClientPtr client G_GNUC_UNUSED,\n                             void *evdata, void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n    virLXCMonitorExitEventMsg *msg = evdata;\n\n    VIR_DEBUG(\"Event exit %d\", msg->status);\n    if (mon->cb.exitNotify)\n        mon->cb.exitNotify(mon, msg->status, mon->vm);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"rpc/virnetclient.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_monitor_dispatch.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_monitor.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);",
      "static void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mon->cb.exitNotify",
          "args": [
            "mon",
            "msg->status",
            "mon->vm"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Event exit %d\"",
            "msg->status"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"rpc/virnetclient.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"lxc_monitor_dispatch.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_monitor.h\"\n#include <config.h>\n\nstatic void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\nstatic void\nvirLXCMonitorHandleEventInit(virNetClientProgramPtr prog,\n                             virNetClientPtr client,\n                             void *evdata, void *opaque);\n\nstatic void\nvirLXCMonitorHandleEventExit(virNetClientProgramPtr prog G_GNUC_UNUSED,\n                             virNetClientPtr client G_GNUC_UNUSED,\n                             void *evdata, void *opaque)\n{\n    virLXCMonitorPtr mon = opaque;\n    virLXCMonitorExitEventMsg *msg = evdata;\n\n    VIR_DEBUG(\"Event exit %d\", msg->status);\n    if (mon->cb.exitNotify)\n        mon->cb.exitNotify(mon, msg->status, mon->vm);\n}"
  },
  {
    "function_name": "virLXCMonitorOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_monitor.c",
    "lines": "52-58",
    "snippet": "static int virLXCMonitorOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virLXCMonitor, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"rpc/virnetclient.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_monitor_dispatch.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_monitor.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virLXCMonitor",
            "virClassForObjectLockable()"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"rpc/virnetclient.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"lxc_monitor_dispatch.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_monitor.h\"\n#include <config.h>\n\nstatic int virLXCMonitorOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virLXCMonitor, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]