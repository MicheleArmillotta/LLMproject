[
  {
    "function_name": "virNodeDeviceObjSetSkipUpdateCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "922-927",
    "snippet": "void\nvirNodeDeviceObjSetSkipUpdateCaps(virNodeDeviceObjPtr obj,\n                                  bool skipUpdateCaps)\n{\n    obj->skipUpdateCaps = skipUpdateCaps;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjSetSkipUpdateCaps(virNodeDeviceObjPtr obj,\n                                  bool skipUpdateCaps)\n{\n    obj->skipUpdateCaps = skipUpdateCaps;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "885-919",
    "snippet": "int\nvirNodeDeviceObjListExport(virConnectPtr conn,\n                           virNodeDeviceObjListPtr devs,\n                           virNodeDevicePtr **devices,\n                           virNodeDeviceObjListFilter filter,\n                           unsigned int flags)\n{\n    virNodeDeviceObjListExportData data = {\n        .conn = conn, .filter = filter, .flags = flags,\n        .devices = NULL, .ndevices = 0, .error = false };\n\n    virObjectRWLockRead(devs);\n    if (devices &&\n        VIR_ALLOC_N(data.devices, virHashSize(devs->objs) + 1) < 0) {\n        virObjectRWUnlock(devs);\n        return -1;\n    }\n\n    virHashForEach(devs->objs, virNodeDeviceObjListExportCallback, &data);\n    virObjectRWUnlock(devs);\n\n    if (data.error)\n        goto cleanup;\n\n    if (data.devices) {\n        ignore_value(VIR_REALLOC_N(data.devices, data.ndevices + 1));\n        *devices = data.devices;\n     }\n\n    return data.ndevices;\n\n cleanup:\n    virObjectListFree(data.devices);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectListFree",
          "args": [
            "data.devices"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "603-615",
          "snippet": "void\nvirObjectListFree(void *list)\n{\n    void **next;\n\n    if (!list)\n        return;\n\n    for (next = (void **) list; *next; next++)\n        virObjectUnref(*next);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFree(void *list)\n{\n    void **next;\n\n    if (!list)\n        return;\n\n    for (next = (void **) list; *next; next++)\n        virObjectUnref(*next);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_REALLOC_N(data.devices, data.ndevices + 1)"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "data.devices",
            "data.ndevices + 1"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "devs"
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "devs->objs",
            "virNodeDeviceObjListExportCallback",
            "&data"
          ],
          "line": 903
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "data.devices",
            "virHashSize(devs->objs) + 1"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "devs->objs"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "devs"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceObjListExport(virConnectPtr conn,\n                           virNodeDeviceObjListPtr devs,\n                           virNodeDevicePtr **devices,\n                           virNodeDeviceObjListFilter filter,\n                           unsigned int flags)\n{\n    virNodeDeviceObjListExportData data = {\n        .conn = conn, .filter = filter, .flags = flags,\n        .devices = NULL, .ndevices = 0, .error = false };\n\n    virObjectRWLockRead(devs);\n    if (devices &&\n        VIR_ALLOC_N(data.devices, virHashSize(devs->objs) + 1) < 0) {\n        virObjectRWUnlock(devs);\n        return -1;\n    }\n\n    virHashForEach(devs->objs, virNodeDeviceObjListExportCallback, &data);\n    virObjectRWUnlock(devs);\n\n    if (data.error)\n        goto cleanup;\n\n    if (data.devices) {\n        ignore_value(VIR_REALLOC_N(data.devices, data.ndevices + 1));\n        *devices = data.devices;\n     }\n\n    return data.ndevices;\n\n cleanup:\n    virObjectListFree(data.devices);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListExportCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "849-882",
    "snippet": "static int\nvirNodeDeviceObjListExportCallback(void *payload,\n                                   const void *name G_GNUC_UNUSED,\n                                   void *opaque)\n{\n    virNodeDeviceObjPtr obj = payload;\n    virNodeDeviceDefPtr def;\n    virNodeDeviceObjListExportDataPtr data = opaque;\n    virNodeDevicePtr device = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if ((!data->filter || data->filter(data->conn, def)) &&\n        virNodeDeviceObjMatch(obj, data->flags)) {\n        if (data->devices) {\n            if (!(device = virGetNodeDevice(data->conn, def->name))) {\n                virObjectUnref(device);\n                data->error = true;\n                goto cleanup;\n            }\n            device->parentName = g_strdup(def->parent);\n            data->devices[data->ndevices] = device;\n        }\n        data->ndevices++;\n    }\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 880
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "def->parent"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "device"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNodeDevice",
          "args": [
            "data->conn",
            "def->name"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNodeDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "671-693",
          "snippet": "virNodeDevicePtr\nvirGetNodeDevice(virConnectPtr conn, const char *name)\n{\n    virNodeDevicePtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virNodeDeviceClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNodeDeviceClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNodeDeviceClass;\n\nvirNodeDevicePtr\nvirGetNodeDevice(virConnectPtr conn, const char *name)\n{\n    virNodeDevicePtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virNodeDeviceClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjMatch",
          "args": [
            "obj",
            "data->flags"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "803-834",
          "snippet": "static bool\nvirNodeDeviceObjMatch(virNodeDeviceObjPtr obj,\n                      unsigned int flags)\n{\n    /* Refresh the capabilities first, e.g. due to a driver change */\n    if (!obj->skipUpdateCaps &&\n        virNodeDeviceUpdateCaps(obj->def) < 0)\n        return false;\n\n    /* filter by cap type */\n    if (flags & VIR_CONNECT_LIST_NODE_DEVICES_FILTERS_CAP) {\n        if (!(MATCH(SYSTEM)        ||\n              MATCH(PCI_DEV)       ||\n              MATCH(USB_DEV)       ||\n              MATCH(USB_INTERFACE) ||\n              MATCH(NET)           ||\n              MATCH(SCSI_HOST)     ||\n              MATCH(SCSI_TARGET)   ||\n              MATCH(SCSI)          ||\n              MATCH(STORAGE)       ||\n              MATCH(FC_HOST)       ||\n              MATCH(VPORTS)        ||\n              MATCH(SCSI_GENERIC)  ||\n              MATCH(DRM)           ||\n              MATCH(MDEV_TYPES)    ||\n              MATCH(MDEV)          ||\n              MATCH(CCW_DEV)))\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic bool\nvirNodeDeviceObjMatch(virNodeDeviceObjPtr obj,\n                      unsigned int flags)\n{\n    /* Refresh the capabilities first, e.g. due to a driver change */\n    if (!obj->skipUpdateCaps &&\n        virNodeDeviceUpdateCaps(obj->def) < 0)\n        return false;\n\n    /* filter by cap type */\n    if (flags & VIR_CONNECT_LIST_NODE_DEVICES_FILTERS_CAP) {\n        if (!(MATCH(SYSTEM)        ||\n              MATCH(PCI_DEV)       ||\n              MATCH(USB_DEV)       ||\n              MATCH(USB_INTERFACE) ||\n              MATCH(NET)           ||\n              MATCH(SCSI_HOST)     ||\n              MATCH(SCSI_TARGET)   ||\n              MATCH(SCSI)          ||\n              MATCH(STORAGE)       ||\n              MATCH(FC_HOST)       ||\n              MATCH(VPORTS)        ||\n              MATCH(SCSI_GENERIC)  ||\n              MATCH(DRM)           ||\n              MATCH(MDEV_TYPES)    ||\n              MATCH(MDEV)          ||\n              MATCH(CCW_DEV)))\n            return false;\n    }\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "def"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\n\nstatic int\nvirNodeDeviceObjListExportCallback(void *payload,\n                                   const void *name G_GNUC_UNUSED,\n                                   void *opaque)\n{\n    virNodeDeviceObjPtr obj = payload;\n    virNodeDeviceDefPtr def;\n    virNodeDeviceObjListExportDataPtr data = opaque;\n    virNodeDevicePtr device = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if ((!data->filter || data->filter(data->conn, def)) &&\n        virNodeDeviceObjMatch(obj, data->flags)) {\n        if (data->devices) {\n            if (!(device = virGetNodeDevice(data->conn, def->name))) {\n                virObjectUnref(device);\n                data->error = true;\n                goto cleanup;\n            }\n            device->parentName = g_strdup(def->parent);\n            data->devices[data->ndevices] = device;\n        }\n        data->ndevices++;\n    }\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virNodeDeviceObjMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "803-834",
    "snippet": "static bool\nvirNodeDeviceObjMatch(virNodeDeviceObjPtr obj,\n                      unsigned int flags)\n{\n    /* Refresh the capabilities first, e.g. due to a driver change */\n    if (!obj->skipUpdateCaps &&\n        virNodeDeviceUpdateCaps(obj->def) < 0)\n        return false;\n\n    /* filter by cap type */\n    if (flags & VIR_CONNECT_LIST_NODE_DEVICES_FILTERS_CAP) {\n        if (!(MATCH(SYSTEM)        ||\n              MATCH(PCI_DEV)       ||\n              MATCH(USB_DEV)       ||\n              MATCH(USB_INTERFACE) ||\n              MATCH(NET)           ||\n              MATCH(SCSI_HOST)     ||\n              MATCH(SCSI_TARGET)   ||\n              MATCH(SCSI)          ||\n              MATCH(STORAGE)       ||\n              MATCH(FC_HOST)       ||\n              MATCH(VPORTS)        ||\n              MATCH(SCSI_GENERIC)  ||\n              MATCH(DRM)           ||\n              MATCH(MDEV_TYPES)    ||\n              MATCH(MDEV)          ||\n              MATCH(CCW_DEV)))\n            return false;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "CCW_DEV"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "MDEV"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "MDEV_TYPES"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "DRM"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "SCSI_GENERIC"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VPORTS"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "FC_HOST"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "STORAGE"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "SCSI"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "SCSI_TARGET"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "SCSI_HOST"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "NET"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "USB_INTERFACE"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "USB_DEV"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "PCI_DEV"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "SYSTEM"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNodeDeviceUpdateCaps",
          "args": [
            "obj->def"
          ],
          "line": 809
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceUpdateCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_conf.c",
          "lines": "2223-2274",
          "snippet": "int\nvirNodeDeviceUpdateCaps(virNodeDeviceDefPtr def)\n{\n    virNodeDevCapsDefPtr cap = def->caps;\n\n    while (cap) {\n        switch (cap->data.type) {\n        case VIR_NODE_DEV_CAP_SCSI_HOST:\n            virNodeDeviceGetSCSIHostCaps(&cap->data.scsi_host);\n            break;\n        case VIR_NODE_DEV_CAP_SCSI_TARGET:\n            virNodeDeviceGetSCSITargetCaps(def->sysfs_path,\n                                           &cap->data.scsi_target);\n            break;\n        case VIR_NODE_DEV_CAP_NET:\n            if (virNetDevGetLinkInfo(cap->data.net.ifname,\n                                     &cap->data.net.lnk) < 0)\n                return -1;\n            virBitmapFree(cap->data.net.features);\n            if (virNetDevGetFeatures(cap->data.net.ifname,\n                                     &cap->data.net.features) < 0)\n                return -1;\n            break;\n        case VIR_NODE_DEV_CAP_PCI_DEV:\n            if (virNodeDeviceGetPCIDynamicCaps(def->sysfs_path,\n                                               &cap->data.pci_dev) < 0)\n                return -1;\n            break;\n\n            /* all types that (supposedly) don't require any updates\n             * relative to what's in the cache.\n             */\n        case VIR_NODE_DEV_CAP_DRM:\n        case VIR_NODE_DEV_CAP_SYSTEM:\n        case VIR_NODE_DEV_CAP_USB_DEV:\n        case VIR_NODE_DEV_CAP_USB_INTERFACE:\n        case VIR_NODE_DEV_CAP_SCSI:\n        case VIR_NODE_DEV_CAP_STORAGE:\n        case VIR_NODE_DEV_CAP_FC_HOST:\n        case VIR_NODE_DEV_CAP_VPORTS:\n        case VIR_NODE_DEV_CAP_SCSI_GENERIC:\n        case VIR_NODE_DEV_CAP_MDEV_TYPES:\n        case VIR_NODE_DEV_CAP_MDEV:\n        case VIR_NODE_DEV_CAP_CCW_DEV:\n        case VIR_NODE_DEV_CAP_LAST:\n            break;\n        }\n        cap = cap->next;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virfcp.h\"",
            "#include \"virlog.h\"",
            "#include \"virrandom.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"device_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfcp.h\"\n#include \"virlog.h\"\n#include \"virrandom.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"device_conf.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNodeDeviceUpdateCaps(virNodeDeviceDefPtr def)\n{\n    virNodeDevCapsDefPtr cap = def->caps;\n\n    while (cap) {\n        switch (cap->data.type) {\n        case VIR_NODE_DEV_CAP_SCSI_HOST:\n            virNodeDeviceGetSCSIHostCaps(&cap->data.scsi_host);\n            break;\n        case VIR_NODE_DEV_CAP_SCSI_TARGET:\n            virNodeDeviceGetSCSITargetCaps(def->sysfs_path,\n                                           &cap->data.scsi_target);\n            break;\n        case VIR_NODE_DEV_CAP_NET:\n            if (virNetDevGetLinkInfo(cap->data.net.ifname,\n                                     &cap->data.net.lnk) < 0)\n                return -1;\n            virBitmapFree(cap->data.net.features);\n            if (virNetDevGetFeatures(cap->data.net.ifname,\n                                     &cap->data.net.features) < 0)\n                return -1;\n            break;\n        case VIR_NODE_DEV_CAP_PCI_DEV:\n            if (virNodeDeviceGetPCIDynamicCaps(def->sysfs_path,\n                                               &cap->data.pci_dev) < 0)\n                return -1;\n            break;\n\n            /* all types that (supposedly) don't require any updates\n             * relative to what's in the cache.\n             */\n        case VIR_NODE_DEV_CAP_DRM:\n        case VIR_NODE_DEV_CAP_SYSTEM:\n        case VIR_NODE_DEV_CAP_USB_DEV:\n        case VIR_NODE_DEV_CAP_USB_INTERFACE:\n        case VIR_NODE_DEV_CAP_SCSI:\n        case VIR_NODE_DEV_CAP_STORAGE:\n        case VIR_NODE_DEV_CAP_FC_HOST:\n        case VIR_NODE_DEV_CAP_VPORTS:\n        case VIR_NODE_DEV_CAP_SCSI_GENERIC:\n        case VIR_NODE_DEV_CAP_MDEV_TYPES:\n        case VIR_NODE_DEV_CAP_MDEV:\n        case VIR_NODE_DEV_CAP_CCW_DEV:\n        case VIR_NODE_DEV_CAP_LAST:\n            break;\n        }\n        cap = cap->next;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic bool\nvirNodeDeviceObjMatch(virNodeDeviceObjPtr obj,\n                      unsigned int flags)\n{\n    /* Refresh the capabilities first, e.g. due to a driver change */\n    if (!obj->skipUpdateCaps &&\n        virNodeDeviceUpdateCaps(obj->def) < 0)\n        return false;\n\n    /* filter by cap type */\n    if (flags & VIR_CONNECT_LIST_NODE_DEVICES_FILTERS_CAP) {\n        if (!(MATCH(SYSTEM)        ||\n              MATCH(PCI_DEV)       ||\n              MATCH(USB_DEV)       ||\n              MATCH(USB_INTERFACE) ||\n              MATCH(NET)           ||\n              MATCH(SCSI_HOST)     ||\n              MATCH(SCSI_TARGET)   ||\n              MATCH(SCSI)          ||\n              MATCH(STORAGE)       ||\n              MATCH(FC_HOST)       ||\n              MATCH(VPORTS)        ||\n              MATCH(SCSI_GENERIC)  ||\n              MATCH(DRM)           ||\n              MATCH(MDEV_TYPES)    ||\n              MATCH(MDEV)          ||\n              MATCH(CCW_DEV)))\n            return false;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "773-798",
    "snippet": "int\nvirNodeDeviceObjListGetNames(virNodeDeviceObjListPtr devs,\n                             virConnectPtr conn,\n                             virNodeDeviceObjListFilter filter,\n                             const char *cap,\n                             char **const names,\n                             int maxnames)\n{\n    struct virNodeDeviceGetNamesData data = {\n        .conn = conn, .filter = filter, .matchstr = cap, .names = names,\n        .nnames = 0, .maxnames = maxnames, .error = false };\n\n    virObjectRWLockRead(devs);\n    virHashForEach(devs->objs, virNodeDeviceObjListGetNamesCallback, &data);\n    virObjectRWUnlock(devs);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames)\n        VIR_FREE(data.names[data.nnames]);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.names[data.nnames]"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "devs"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "devs->objs",
            "virNodeDeviceObjListGetNamesCallback",
            "&data"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "devs"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceObjListGetNames(virNodeDeviceObjListPtr devs,\n                             virConnectPtr conn,\n                             virNodeDeviceObjListFilter filter,\n                             const char *cap,\n                             char **const names,\n                             int maxnames)\n{\n    struct virNodeDeviceGetNamesData data = {\n        .conn = conn, .filter = filter, .matchstr = cap, .names = names,\n        .nnames = 0, .maxnames = maxnames, .error = false };\n\n    virObjectRWLockRead(devs);\n    virHashForEach(devs->objs, virNodeDeviceObjListGetNamesCallback, &data);\n    virObjectRWUnlock(devs);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames)\n        VIR_FREE(data.names[data.nnames]);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListGetNamesCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "743-770",
    "snippet": "static int\nvirNodeDeviceObjListGetNamesCallback(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virNodeDeviceObjPtr obj = payload;\n    virNodeDeviceDefPtr def;\n    struct virNodeDeviceGetNamesData *data = opaque;\n    virNodeDeviceObjListFilter filter = data->filter;\n\n    if (data->error)\n        return 0;\n\n    if (data->nnames >= data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if ((!filter || filter(data->conn, def)) &&\n        (!data->matchstr || virNodeDeviceObjHasCapStr(obj, data->matchstr))) {\n        data->names[data->nnames] = g_strdup(def->name);\n        data->nnames++;\n     }\n\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "def->name"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjHasCapStr",
          "args": [
            "obj",
            "data->matchstr"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjHasCapStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "120-130",
          "snippet": "static bool\nvirNodeDeviceObjHasCapStr(const virNodeDeviceObj *obj,\n                          const char *cap)\n{\n    int type;\n\n    if ((type = virNodeDevCapTypeFromString(cap)) < 0)\n        return false;\n\n    return virNodeDeviceObjHasCap(obj, type);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic bool\nvirNodeDeviceObjHasCapStr(const virNodeDeviceObj *obj,\n                          const char *cap)\n{\n    int type;\n\n    if ((type = virNodeDevCapTypeFromString(cap)) < 0)\n        return false;\n\n    return virNodeDeviceObjHasCap(obj, type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter",
          "args": [
            "data->conn",
            "def"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "make_nonnull_nwfilter_binding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_dispatch.c",
          "lines": "7368-7373",
          "snippet": "static void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}",
          "includes": [
            "#include \"lxc_daemon_dispatch_stubs.h\"",
            "#include \"qemu_daemon_dispatch_stubs.h\"",
            "#include \"remote_daemon_dispatch_stubs.h\"",
            "#include \"access/viraccessapicheck.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virpolkit.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virprobe.h\"",
            "#include \"network_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"object_event.h\"",
            "#include \"virstring.h\"",
            "#include \"lxc_protocol.h\"",
            "#include \"qemu_protocol.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"virprocess.h\"",
            "#include \"virdbus.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virnetserverservice.h\"",
            "#include \"vircommand.h\"",
            "#include \"viruuid.h\"",
            "#include \"remote_daemon_stream.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"remote_daemon.h\"",
            "#include \"remote_daemon_dispatch.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc_daemon_dispatch_stubs.h\"\n#include \"qemu_daemon_dispatch_stubs.h\"\n#include \"remote_daemon_dispatch_stubs.h\"\n#include \"access/viraccessapicheck.h\"\n#include \"configmake.h\"\n#include \"virthreadjob.h\"\n#include \"virpolkit.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virprobe.h\"\n#include \"network_conf.h\"\n#include \"domain_conf.h\"\n#include \"object_event.h\"\n#include \"virstring.h\"\n#include \"lxc_protocol.h\"\n#include \"qemu_protocol.h\"\n#include \"remote_protocol.h\"\n#include \"virprocess.h\"\n#include \"virdbus.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virnetserver.h\"\n#include \"virnetserverservice.h\"\n#include \"vircommand.h\"\n#include \"viruuid.h\"\n#include \"remote_daemon_stream.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"libvirt_internal.h\"\n#include \"remote_daemon.h\"\n#include \"remote_daemon_dispatch.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);\n\nstatic void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\n\nstatic int\nvirNodeDeviceObjListGetNamesCallback(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virNodeDeviceObjPtr obj = payload;\n    virNodeDeviceDefPtr def;\n    struct virNodeDeviceGetNamesData *data = opaque;\n    virNodeDeviceObjListFilter filter = data->filter;\n\n    if (data->error)\n        return 0;\n\n    if (data->nnames >= data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if ((!filter || filter(data->conn, def)) &&\n        (!data->matchstr || virNodeDeviceObjHasCapStr(obj, data->matchstr))) {\n        data->names[data->nnames] = g_strdup(def->name);\n        data->nnames++;\n     }\n\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListNumOfDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "716-730",
    "snippet": "int\nvirNodeDeviceObjListNumOfDevices(virNodeDeviceObjListPtr devs,\n                                 virConnectPtr conn,\n                                 const char *cap,\n                                 virNodeDeviceObjListFilter filter)\n{\n    struct virNodeDeviceCountData data = {\n        .conn = conn, .filter = filter, .matchstr = cap, .count = 0 };\n\n    virObjectRWLockRead(devs);\n    virHashForEach(devs->objs, virNodeDeviceObjListNumOfDevicesCallback, &data);\n    virObjectRWUnlock(devs);\n\n    return data.count;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "devs"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "devs->objs",
            "virNodeDeviceObjListNumOfDevicesCallback",
            "&data"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "devs"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceObjListNumOfDevices(virNodeDeviceObjListPtr devs,\n                                 virConnectPtr conn,\n                                 const char *cap,\n                                 virNodeDeviceObjListFilter filter)\n{\n    struct virNodeDeviceCountData data = {\n        .conn = conn, .filter = filter, .matchstr = cap, .count = 0 };\n\n    virObjectRWLockRead(devs);\n    virHashForEach(devs->objs, virNodeDeviceObjListNumOfDevicesCallback, &data);\n    virObjectRWUnlock(devs);\n\n    return data.count;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListNumOfDevicesCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "695-713",
    "snippet": "static int\nvirNodeDeviceObjListNumOfDevicesCallback(void *payload,\n                                         const void *name G_GNUC_UNUSED,\n                                         void *opaque)\n{\n    virNodeDeviceObjPtr obj = payload;\n    virNodeDeviceDefPtr def;\n    struct virNodeDeviceCountData *data = opaque;\n    virNodeDeviceObjListFilter filter = data->filter;\n\n    virObjectLock(obj);\n    def = obj->def;\n    if ((!filter || filter(data->conn, def)) &&\n        (!data->matchstr || virNodeDeviceObjHasCapStr(obj, data->matchstr)))\n        data->count++;\n\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjHasCapStr",
          "args": [
            "obj",
            "data->matchstr"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjHasCapStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "120-130",
          "snippet": "static bool\nvirNodeDeviceObjHasCapStr(const virNodeDeviceObj *obj,\n                          const char *cap)\n{\n    int type;\n\n    if ((type = virNodeDevCapTypeFromString(cap)) < 0)\n        return false;\n\n    return virNodeDeviceObjHasCap(obj, type);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic bool\nvirNodeDeviceObjHasCapStr(const virNodeDeviceObj *obj,\n                          const char *cap)\n{\n    int type;\n\n    if ((type = virNodeDevCapTypeFromString(cap)) < 0)\n        return false;\n\n    return virNodeDeviceObjHasCap(obj, type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter",
          "args": [
            "data->conn",
            "def"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "make_nonnull_nwfilter_binding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_dispatch.c",
          "lines": "7368-7373",
          "snippet": "static void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}",
          "includes": [
            "#include \"lxc_daemon_dispatch_stubs.h\"",
            "#include \"qemu_daemon_dispatch_stubs.h\"",
            "#include \"remote_daemon_dispatch_stubs.h\"",
            "#include \"access/viraccessapicheck.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virpolkit.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virprobe.h\"",
            "#include \"network_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"object_event.h\"",
            "#include \"virstring.h\"",
            "#include \"lxc_protocol.h\"",
            "#include \"qemu_protocol.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"virprocess.h\"",
            "#include \"virdbus.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virnetserverservice.h\"",
            "#include \"vircommand.h\"",
            "#include \"viruuid.h\"",
            "#include \"remote_daemon_stream.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"remote_daemon.h\"",
            "#include \"remote_daemon_dispatch.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc_daemon_dispatch_stubs.h\"\n#include \"qemu_daemon_dispatch_stubs.h\"\n#include \"remote_daemon_dispatch_stubs.h\"\n#include \"access/viraccessapicheck.h\"\n#include \"configmake.h\"\n#include \"virthreadjob.h\"\n#include \"virpolkit.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virprobe.h\"\n#include \"network_conf.h\"\n#include \"domain_conf.h\"\n#include \"object_event.h\"\n#include \"virstring.h\"\n#include \"lxc_protocol.h\"\n#include \"qemu_protocol.h\"\n#include \"remote_protocol.h\"\n#include \"virprocess.h\"\n#include \"virdbus.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virnetserver.h\"\n#include \"virnetserverservice.h\"\n#include \"vircommand.h\"\n#include \"viruuid.h\"\n#include \"remote_daemon_stream.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"libvirt_internal.h\"\n#include \"remote_daemon.h\"\n#include \"remote_daemon_dispatch.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);\n\nstatic void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\n\nstatic int\nvirNodeDeviceObjListNumOfDevicesCallback(void *payload,\n                                         const void *name G_GNUC_UNUSED,\n                                         void *opaque)\n{\n    virNodeDeviceObjPtr obj = payload;\n    virNodeDeviceDefPtr def;\n    struct virNodeDeviceCountData *data = opaque;\n    virNodeDeviceObjListFilter filter = data->filter;\n\n    virObjectLock(obj);\n    def = obj->def;\n    if ((!filter || filter(data->conn, def)) &&\n        (!data->matchstr || virNodeDeviceObjHasCapStr(obj, data->matchstr)))\n        data->count++;\n\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virNodeDeviceObjHasCap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "638-685",
    "snippet": "static bool\nvirNodeDeviceObjHasCap(const virNodeDeviceObj *obj,\n                       int type)\n{\n    virNodeDevCapsDefPtr cap = NULL;\n\n    for (cap = obj->def->caps; cap; cap = cap->next) {\n        if (type == cap->data.type)\n            return true;\n\n        switch (cap->data.type) {\n        case VIR_NODE_DEV_CAP_PCI_DEV:\n            if (type == VIR_NODE_DEV_CAP_MDEV_TYPES &&\n                (cap->data.pci_dev.flags & VIR_NODE_DEV_CAP_FLAG_PCI_MDEV))\n                return true;\n            break;\n\n        case VIR_NODE_DEV_CAP_SCSI_HOST:\n            if (type == VIR_NODE_DEV_CAP_FC_HOST &&\n                (cap->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n                return true;\n\n            if (type == VIR_NODE_DEV_CAP_VPORTS &&\n                (cap->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n                return true;\n            break;\n\n        case VIR_NODE_DEV_CAP_SYSTEM:\n        case VIR_NODE_DEV_CAP_USB_DEV:\n        case VIR_NODE_DEV_CAP_USB_INTERFACE:\n        case VIR_NODE_DEV_CAP_NET:\n        case VIR_NODE_DEV_CAP_SCSI_TARGET:\n        case VIR_NODE_DEV_CAP_SCSI:\n        case VIR_NODE_DEV_CAP_STORAGE:\n        case VIR_NODE_DEV_CAP_FC_HOST:\n        case VIR_NODE_DEV_CAP_VPORTS:\n        case VIR_NODE_DEV_CAP_SCSI_GENERIC:\n        case VIR_NODE_DEV_CAP_DRM:\n        case VIR_NODE_DEV_CAP_MDEV_TYPES:\n        case VIR_NODE_DEV_CAP_MDEV:\n        case VIR_NODE_DEV_CAP_CCW_DEV:\n        case VIR_NODE_DEV_CAP_LAST:\n            break;\n        }\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic bool\nvirNodeDeviceObjHasCap(const virNodeDeviceObj *obj,\n                       int type)\n{\n    virNodeDevCapsDefPtr cap = NULL;\n\n    for (cap = obj->def->caps; cap; cap = cap->next) {\n        if (type == cap->data.type)\n            return true;\n\n        switch (cap->data.type) {\n        case VIR_NODE_DEV_CAP_PCI_DEV:\n            if (type == VIR_NODE_DEV_CAP_MDEV_TYPES &&\n                (cap->data.pci_dev.flags & VIR_NODE_DEV_CAP_FLAG_PCI_MDEV))\n                return true;\n            break;\n\n        case VIR_NODE_DEV_CAP_SCSI_HOST:\n            if (type == VIR_NODE_DEV_CAP_FC_HOST &&\n                (cap->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n                return true;\n\n            if (type == VIR_NODE_DEV_CAP_VPORTS &&\n                (cap->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n                return true;\n            break;\n\n        case VIR_NODE_DEV_CAP_SYSTEM:\n        case VIR_NODE_DEV_CAP_USB_DEV:\n        case VIR_NODE_DEV_CAP_USB_INTERFACE:\n        case VIR_NODE_DEV_CAP_NET:\n        case VIR_NODE_DEV_CAP_SCSI_TARGET:\n        case VIR_NODE_DEV_CAP_SCSI:\n        case VIR_NODE_DEV_CAP_STORAGE:\n        case VIR_NODE_DEV_CAP_FC_HOST:\n        case VIR_NODE_DEV_CAP_VPORTS:\n        case VIR_NODE_DEV_CAP_SCSI_GENERIC:\n        case VIR_NODE_DEV_CAP_DRM:\n        case VIR_NODE_DEV_CAP_MDEV_TYPES:\n        case VIR_NODE_DEV_CAP_MDEV:\n        case VIR_NODE_DEV_CAP_CCW_DEV:\n        case VIR_NODE_DEV_CAP_LAST:\n            break;\n        }\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListGetParentHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "612-635",
    "snippet": "int\nvirNodeDeviceObjListGetParentHost(virNodeDeviceObjListPtr devs,\n                                  virNodeDeviceDefPtr def)\n{\n    int parent_host = -1;\n\n    if (def->parent) {\n        parent_host = virNodeDeviceObjListGetParentHostByParent(devs, def->name,\n                                                                def->parent);\n    } else if (def->parent_wwnn && def->parent_wwpn) {\n        parent_host = virNodeDeviceObjListGetParentHostByWWNs(devs, def->name,\n                                                              def->parent_wwnn,\n                                                              def->parent_wwpn);\n    } else if (def->parent_fabric_wwn) {\n        parent_host =\n            virNodeDeviceObjListGetParentHostByFabricWWN(devs, def->name,\n                                                         def->parent_fabric_wwn);\n    } else {\n        /* Try to find a vport capable scsi_host when no parent supplied */\n        parent_host = virNodeDeviceObjListFindVportParentHost(devs);\n    }\n\n    return parent_host;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjListFindVportParentHost",
          "args": [
            "devs"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListFindVportParentHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "591-609",
          "snippet": "static int\nvirNodeDeviceObjListFindVportParentHost(virNodeDeviceObjListPtr devs)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    const char *cap = virNodeDevCapTypeToString(VIR_NODE_DEV_CAP_VPORTS);\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByCap(devs, cap))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any vport capable device\"));\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjListFindVportParentHost(virNodeDeviceObjListPtr devs)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    const char *cap = virNodeDevCapTypeToString(VIR_NODE_DEV_CAP_VPORTS);\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByCap(devs, cap))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any vport capable device\"));\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListGetParentHostByFabricWWN",
          "args": [
            "devs",
            "def->name",
            "def->parent_fabric_wwn"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListGetParentHostByFabricWWN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "568-588",
          "snippet": "static int\nvirNodeDeviceObjListGetParentHostByFabricWWN(virNodeDeviceObjListPtr devs,\n                                             const char *dev_name,\n                                             const char *parent_fabric_wwn)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByFabricWWN(devs, parent_fabric_wwn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjListGetParentHostByFabricWWN(virNodeDeviceObjListPtr devs,\n                                             const char *dev_name,\n                                             const char *parent_fabric_wwn)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByFabricWWN(devs, parent_fabric_wwn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListGetParentHostByWWNs",
          "args": [
            "devs",
            "def->name",
            "def->parent_wwnn",
            "def->parent_wwpn"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListGetParentHostByWWNs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "543-565",
          "snippet": "static int\nvirNodeDeviceObjListGetParentHostByWWNs(virNodeDeviceObjListPtr devs,\n                                        const char *dev_name,\n                                        const char *parent_wwnn,\n                                        const char *parent_wwpn)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByWWNs(devs, parent_wwnn,\n                                               parent_wwpn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjListGetParentHostByWWNs(virNodeDeviceObjListPtr devs,\n                                        const char *dev_name,\n                                        const char *parent_wwnn,\n                                        const char *parent_wwpn)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByWWNs(devs, parent_wwnn,\n                                               parent_wwpn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListGetParentHostByParent",
          "args": [
            "devs",
            "def->name",
            "def->parent"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListGetParentHostByParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "520-540",
          "snippet": "static int\nvirNodeDeviceObjListGetParentHostByParent(virNodeDeviceObjListPtr devs,\n                                          const char *dev_name,\n                                          const char *parent_name)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByName(devs, parent_name))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjListGetParentHostByParent(virNodeDeviceObjListPtr devs,\n                                          const char *dev_name,\n                                          const char *parent_name)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByName(devs, parent_name))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceObjListGetParentHost(virNodeDeviceObjListPtr devs,\n                                  virNodeDeviceDefPtr def)\n{\n    int parent_host = -1;\n\n    if (def->parent) {\n        parent_host = virNodeDeviceObjListGetParentHostByParent(devs, def->name,\n                                                                def->parent);\n    } else if (def->parent_wwnn && def->parent_wwpn) {\n        parent_host = virNodeDeviceObjListGetParentHostByWWNs(devs, def->name,\n                                                              def->parent_wwnn,\n                                                              def->parent_wwpn);\n    } else if (def->parent_fabric_wwn) {\n        parent_host =\n            virNodeDeviceObjListGetParentHostByFabricWWN(devs, def->name,\n                                                         def->parent_fabric_wwn);\n    } else {\n        /* Try to find a vport capable scsi_host when no parent supplied */\n        parent_host = virNodeDeviceObjListFindVportParentHost(devs);\n    }\n\n    return parent_host;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindVportParentHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "591-609",
    "snippet": "static int\nvirNodeDeviceObjListFindVportParentHost(virNodeDeviceObjListPtr devs)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    const char *cap = virNodeDevCapTypeToString(VIR_NODE_DEV_CAP_VPORTS);\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByCap(devs, cap))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any vport capable device\"));\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "101-110",
          "snippet": "void\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindFCParentHost",
          "args": [
            "obj"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindFCParentHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "503-517",
          "snippet": "static int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not find any vport capable device\")"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not find any vport capable device\""
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListFindByCap",
          "args": [
            "devs",
            "cap"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListFindByCap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "340-347",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByCap(virNodeDeviceObjListPtr devs,\n                              const char *cap)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByCapCallback,\n                                      cap);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByCap(virNodeDeviceObjListPtr devs,\n                              const char *cap)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByCapCallback,\n                                      cap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDevCapTypeToString",
          "args": [
            "VIR_NODE_DEV_CAP_VPORTS"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjListFindVportParentHost(virNodeDeviceObjListPtr devs)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    const char *cap = virNodeDevCapTypeToString(VIR_NODE_DEV_CAP_VPORTS);\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByCap(devs, cap))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any vport capable device\"));\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListGetParentHostByFabricWWN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "568-588",
    "snippet": "static int\nvirNodeDeviceObjListGetParentHostByFabricWWN(virNodeDeviceObjListPtr devs,\n                                             const char *dev_name,\n                                             const char *parent_fabric_wwn)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByFabricWWN(devs, parent_fabric_wwn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "101-110",
          "snippet": "void\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindFCParentHost",
          "args": [
            "obj"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindFCParentHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "503-517",
          "snippet": "static int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not find parent device for '%s'\")",
            "dev_name"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not find parent device for '%s'\""
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListFindByFabricWWN",
          "args": [
            "devs",
            "parent_fabric_wwn"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListFindByFabricWWN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "313-320",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByFabricWWN(virNodeDeviceObjListPtr devs,\n                                    const char *parent_fabric_wwn)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByFabricWWNCallback,\n                                      parent_fabric_wwn);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByFabricWWN(virNodeDeviceObjListPtr devs,\n                                    const char *parent_fabric_wwn)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByFabricWWNCallback,\n                                      parent_fabric_wwn);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjListGetParentHostByFabricWWN(virNodeDeviceObjListPtr devs,\n                                             const char *dev_name,\n                                             const char *parent_fabric_wwn)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByFabricWWN(devs, parent_fabric_wwn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListGetParentHostByWWNs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "543-565",
    "snippet": "static int\nvirNodeDeviceObjListGetParentHostByWWNs(virNodeDeviceObjListPtr devs,\n                                        const char *dev_name,\n                                        const char *parent_wwnn,\n                                        const char *parent_wwpn)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByWWNs(devs, parent_wwnn,\n                                               parent_wwpn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "101-110",
          "snippet": "void\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindFCParentHost",
          "args": [
            "obj"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindFCParentHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "503-517",
          "snippet": "static int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not find parent device for '%s'\")",
            "dev_name"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not find parent device for '%s'\""
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListFindByWWNs",
          "args": [
            "devs",
            "parent_wwnn",
            "parent_wwpn"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListFindByWWNs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "279-290",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByWWNs(virNodeDeviceObjListPtr devs,\n                               const char *parent_wwnn,\n                               const char *parent_wwpn)\n{\n    struct virNodeDeviceObjListFindByWWNsData data = {\n        .parent_wwnn = parent_wwnn, .parent_wwpn = parent_wwpn };\n\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByWWNsCallback,\n                                      &data);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByWWNs(virNodeDeviceObjListPtr devs,\n                               const char *parent_wwnn,\n                               const char *parent_wwpn)\n{\n    struct virNodeDeviceObjListFindByWWNsData data = {\n        .parent_wwnn = parent_wwnn, .parent_wwpn = parent_wwpn };\n\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByWWNsCallback,\n                                      &data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjListGetParentHostByWWNs(virNodeDeviceObjListPtr devs,\n                                        const char *dev_name,\n                                        const char *parent_wwnn,\n                                        const char *parent_wwpn)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByWWNs(devs, parent_wwnn,\n                                               parent_wwpn))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListGetParentHostByParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "520-540",
    "snippet": "static int\nvirNodeDeviceObjListGetParentHostByParent(virNodeDeviceObjListPtr devs,\n                                          const char *dev_name,\n                                          const char *parent_name)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByName(devs, parent_name))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "101-110",
          "snippet": "void\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindFCParentHost",
          "args": [
            "obj"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindFCParentHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "503-517",
          "snippet": "static int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not find parent device for '%s'\")",
            "dev_name"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not find parent device for '%s'\""
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListFindByName",
          "args": [
            "devs",
            "parent_name"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "236-249",
          "snippet": "virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByName(virNodeDeviceObjListPtr devs,\n                               const char *name)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virNodeDeviceObjListFindByNameLocked(devs, name);\n    virObjectRWUnlock(devs);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDeviceObjPtr\nvirNodeDeviceObjListFindByName(virNodeDeviceObjListPtr devs,\n                               const char *name)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virNodeDeviceObjListFindByNameLocked(devs, name);\n    virObjectRWUnlock(devs);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjListGetParentHostByParent(virNodeDeviceObjListPtr devs,\n                                          const char *dev_name,\n                                          const char *parent_name)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    int ret;\n\n    if (!(obj = virNodeDeviceObjListFindByName(devs, parent_name))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find parent device for '%s'\"),\n                       dev_name);\n        return -1;\n    }\n\n    ret = virNodeDeviceFindFCParentHost(obj);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNodeDeviceFindFCParentHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "503-517",
    "snippet": "static int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Parent device %s is not capable \"\n                         \"of vport operations\")",
            "obj->def->name"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Parent device %s is not capable \"\n                         \"of vport operations\""
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindVPORTCapDef",
          "args": [
            "obj"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindVPORTCapDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "165-178",
          "snippet": "static virNodeDevCapsDefPtr\nvirNodeDeviceFindVPORTCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic virNodeDevCapsDefPtr\nvirNodeDeviceFindVPORTCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceFindFCParentHost(virNodeDeviceObjPtr obj)\n{\n    virNodeDevCapsDefPtr cap = virNodeDeviceFindVPORTCapDef(obj);\n\n    if (!cap) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Parent device %s is not capable \"\n                         \"of vport operations\"),\n                       obj->def->name);\n        return -1;\n    }\n\n    return cap->data.scsi_host.host;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "470-488",
    "snippet": "void\nvirNodeDeviceObjListRemove(virNodeDeviceObjListPtr devs,\n                           virNodeDeviceObjPtr obj)\n{\n    virNodeDeviceDefPtr def;\n\n    if (!obj)\n        return;\n    def = obj->def;\n\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n    virObjectRWLockWrite(devs);\n    virObjectLock(obj);\n    virHashRemoveEntry(devs->objs, def->name);\n    virObjectUnlock(obj);\n    virObjectUnref(obj);\n    virObjectRWUnlock(devs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "devs"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "devs->objs",
            "def->name"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "devs"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjListRemove(virNodeDeviceObjListPtr devs,\n                           virNodeDeviceObjPtr obj)\n{\n    virNodeDeviceDefPtr def;\n\n    if (!obj)\n        return;\n    def = obj->def;\n\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n    virObjectRWLockWrite(devs);\n    virObjectLock(obj);\n    virHashRemoveEntry(devs->objs, def->name);\n    virObjectUnlock(obj);\n    virObjectUnref(obj);\n    virObjectRWUnlock(devs);\n}"
  },
  {
    "function_name": "virNodeDeviceObjListAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "439-467",
    "snippet": "virNodeDeviceObjPtr\nvirNodeDeviceObjListAssignDef(virNodeDeviceObjListPtr devs,\n                              virNodeDeviceDefPtr def)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockWrite(devs);\n\n    if ((obj = virNodeDeviceObjListFindByNameLocked(devs, def->name))) {\n        virObjectLock(obj);\n        virNodeDeviceDefFree(obj->def);\n        obj->def = def;\n    } else {\n        if (!(obj = virNodeDeviceObjNew()))\n            goto cleanup;\n\n        if (virHashAddEntry(devs->objs, def->name, obj) < 0) {\n            virNodeDeviceObjEndAPI(&obj);\n            goto cleanup;\n        }\n\n        obj->def = def;\n        virObjectRef(obj);\n    }\n\n cleanup:\n    virObjectRWUnlock(devs);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "devs"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "101-110",
          "snippet": "void\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "devs->objs",
            "def->name",
            "obj"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjNew",
          "args": [],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "84-98",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjNew(void)\n{\n    virNodeDeviceObjPtr obj;\n\n    if (virNodeDeviceObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virNodeDeviceObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virNodeDeviceObjClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virClassPtr virNodeDeviceObjClass;\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjNew(void)\n{\n    virNodeDeviceObjPtr obj;\n\n    if (virNodeDeviceObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virNodeDeviceObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceDefFree",
          "args": [
            "obj->def"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_conf.c",
          "lines": "98-125",
          "snippet": "void\nvirNodeDeviceDefFree(virNodeDeviceDefPtr def)\n{\n    virNodeDevCapsDefPtr caps;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->parent);\n    VIR_FREE(def->parent_wwnn);\n    VIR_FREE(def->parent_wwpn);\n    VIR_FREE(def->parent_fabric_wwn);\n    VIR_FREE(def->driver);\n    VIR_FREE(def->sysfs_path);\n    VIR_FREE(def->parent_sysfs_path);\n    VIR_FREE(def->devnode);\n    virStringListFree(def->devlinks);\n\n    caps = def->caps;\n    while (caps) {\n        virNodeDevCapsDefPtr next = caps->next;\n        virNodeDevCapsDefFree(caps);\n        caps = next;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virfcp.h\"",
            "#include \"virlog.h\"",
            "#include \"virrandom.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"device_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfcp.h\"\n#include \"virlog.h\"\n#include \"virrandom.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"device_conf.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNodeDeviceDefFree(virNodeDeviceDefPtr def)\n{\n    virNodeDevCapsDefPtr caps;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->parent);\n    VIR_FREE(def->parent_wwnn);\n    VIR_FREE(def->parent_wwpn);\n    VIR_FREE(def->parent_fabric_wwn);\n    VIR_FREE(def->driver);\n    VIR_FREE(def->sysfs_path);\n    VIR_FREE(def->parent_sysfs_path);\n    VIR_FREE(def->devnode);\n    virStringListFree(def->devlinks);\n\n    caps = def->caps;\n    while (caps) {\n        virNodeDevCapsDefPtr next = caps->next;\n        virNodeDevCapsDefFree(caps);\n        caps = next;\n    }\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListFindByNameLocked",
          "args": [
            "devs",
            "def->name"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListFindByNameLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "228-233",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByNameLocked(virNodeDeviceObjListPtr devs,\n                                     const char *name)\n{\n    return virObjectRef(virHashLookup(devs->objs, name));\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByNameLocked(virNodeDeviceObjListPtr devs,\n                                     const char *name)\n{\n    return virObjectRef(virHashLookup(devs->objs, name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "devs"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDeviceObjPtr\nvirNodeDeviceObjListAssignDef(virNodeDeviceObjListPtr devs,\n                              virNodeDeviceDefPtr def)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockWrite(devs);\n\n    if ((obj = virNodeDeviceObjListFindByNameLocked(devs, def->name))) {\n        virObjectLock(obj);\n        virNodeDeviceDefFree(obj->def);\n        obj->def = def;\n    } else {\n        if (!(obj = virNodeDeviceObjNew()))\n            goto cleanup;\n\n        if (virHashAddEntry(devs->objs, def->name, obj) < 0) {\n            virNodeDeviceObjEndAPI(&obj);\n            goto cleanup;\n        }\n\n        obj->def = def;\n        virObjectRef(obj);\n    }\n\n cleanup:\n    virObjectRWUnlock(devs);\n    return obj;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "432-436",
    "snippet": "void\nvirNodeDeviceObjListFree(virNodeDeviceObjListPtr devs)\n{\n    virObjectUnref(devs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "devs"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjListFree(virNodeDeviceObjListPtr devs)\n{\n    virObjectUnref(devs);\n}"
  },
  {
    "function_name": "virNodeDeviceObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "412-429",
    "snippet": "virNodeDeviceObjListPtr\nvirNodeDeviceObjListNew(void)\n{\n    virNodeDeviceObjListPtr devs;\n\n    if (virNodeDeviceObjInitialize() < 0)\n        return NULL;\n\n    if (!(devs = virObjectRWLockableNew(virNodeDeviceObjListClass)))\n        return NULL;\n\n    if (!(devs->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(devs);\n        return NULL;\n    }\n\n    return devs;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNodeDeviceObjListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "devs"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "50",
            "virObjectFreeHashData"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockableNew",
          "args": [
            "virNodeDeviceObjListClass"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "282-305",
          "snippet": "void *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjInitialize",
          "args": [],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virClassPtr virNodeDeviceObjListClass;\n\nvirNodeDeviceObjListPtr\nvirNodeDeviceObjListNew(void)\n{\n    virNodeDeviceObjListPtr devs;\n\n    if (virNodeDeviceObjInitialize() < 0)\n        return NULL;\n\n    if (!(devs = virObjectRWLockableNew(virNodeDeviceObjListClass)))\n        return NULL;\n\n    if (!(devs->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(devs);\n        return NULL;\n    }\n\n    return devs;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "403-409",
    "snippet": "static void\nvirNodeDeviceObjListDispose(void *obj)\n{\n    virNodeDeviceObjListPtr devs = obj;\n\n    virHashFree(devs->objs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "devs->objs"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void\nvirNodeDeviceObjListDispose(void *obj)\n{\n    virNodeDeviceObjListPtr devs = obj;\n\n    virHashFree(devs->objs);\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindSCSIHostByWWNs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "389-400",
    "snippet": "virNodeDeviceObjPtr\nvirNodeDeviceObjListFindSCSIHostByWWNs(virNodeDeviceObjListPtr devs,\n                                       const char *wwnn,\n                                       const char *wwpn)\n{\n    struct virNodeDeviceObjListFindSCSIHostByWWNsData data = {\n        .wwnn = wwnn, .wwpn = wwpn };\n\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindSCSIHostByWWNsCallback,\n                                      &data);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjListSearch",
          "args": [
            "devs",
            "virNodeDeviceObjListFindSCSIHostByWWNsCallback",
            "&data"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "181-197",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDeviceObjPtr\nvirNodeDeviceObjListFindSCSIHostByWWNs(virNodeDeviceObjListPtr devs,\n                                       const char *wwnn,\n                                       const char *wwpn)\n{\n    struct virNodeDeviceObjListFindSCSIHostByWWNsData data = {\n        .wwnn = wwnn, .wwpn = wwpn };\n\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindSCSIHostByWWNsCallback,\n                                      &data);\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindSCSIHostByWWNsCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "355-386",
    "snippet": "static int\nvirNodeDeviceObjListFindSCSIHostByWWNsCallback(const void *payload,\n                                               const void *name G_GNUC_UNUSED,\n                                               const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    struct virNodeDeviceObjListFindSCSIHostByWWNsData *data =\n        (struct virNodeDeviceObjListFindSCSIHostByWWNsData *) opaque;\n    virNodeDevCapsDefPtr cap;\n    int want = 0;\n\n    virObjectLock(obj);\n    cap = obj->def->caps;\n\n    while (cap) {\n        if (cap->data.type == VIR_NODE_DEV_CAP_SCSI_HOST) {\n            virNodeDeviceGetSCSIHostCaps(&cap->data.scsi_host);\n            if (cap->data.scsi_host.flags &\n                VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST) {\n                if (STREQ(cap->data.scsi_host.wwnn, data->wwnn) &&\n                    STREQ(cap->data.scsi_host.wwpn, data->wwpn)) {\n                    want = 1;\n                    break;\n                }\n            }\n        }\n        cap = cap->next;\n     }\n\n    virObjectUnlock(obj);\n    return want;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);",
      "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "cap->data.scsi_host.wwpn",
            "data->wwpn"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "cap->data.scsi_host.wwnn",
            "data->wwnn"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNodeDeviceGetSCSIHostCaps",
          "args": [
            "&cap->data.scsi_host"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceGetSCSIHostCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_conf.c",
          "lines": "2602-2606",
          "snippet": "int\nvirNodeDeviceGetSCSIHostCaps(virNodeDevCapSCSIHostPtr scsi_host G_GNUC_UNUSED)\n{\n    return -1;\n}",
          "includes": [
            "#include \"virfcp.h\"",
            "#include \"virlog.h\"",
            "#include \"virrandom.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"device_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfcp.h\"\n#include \"virlog.h\"\n#include \"virrandom.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"device_conf.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNodeDeviceGetSCSIHostCaps(virNodeDevCapSCSIHostPtr scsi_host G_GNUC_UNUSED)\n{\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic int\nvirNodeDeviceObjListFindSCSIHostByWWNsCallback(const void *payload,\n                                               const void *name G_GNUC_UNUSED,\n                                               const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    struct virNodeDeviceObjListFindSCSIHostByWWNsData *data =\n        (struct virNodeDeviceObjListFindSCSIHostByWWNsData *) opaque;\n    virNodeDevCapsDefPtr cap;\n    int want = 0;\n\n    virObjectLock(obj);\n    cap = obj->def->caps;\n\n    while (cap) {\n        if (cap->data.type == VIR_NODE_DEV_CAP_SCSI_HOST) {\n            virNodeDeviceGetSCSIHostCaps(&cap->data.scsi_host);\n            if (cap->data.scsi_host.flags &\n                VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST) {\n                if (STREQ(cap->data.scsi_host.wwnn, data->wwnn) &&\n                    STREQ(cap->data.scsi_host.wwpn, data->wwpn)) {\n                    want = 1;\n                    break;\n                }\n            }\n        }\n        cap = cap->next;\n     }\n\n    virObjectUnlock(obj);\n    return want;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindByCap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "340-347",
    "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByCap(virNodeDeviceObjListPtr devs,\n                              const char *cap)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByCapCallback,\n                                      cap);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjListSearch",
          "args": [
            "devs",
            "virNodeDeviceObjListFindByCapCallback",
            "cap"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "181-197",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByCap(virNodeDeviceObjListPtr devs,\n                              const char *cap)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByCapCallback,\n                                      cap);\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindByCapCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "323-337",
    "snippet": "static int\nvirNodeDeviceObjListFindByCapCallback(const void *payload,\n                                      const void *name G_GNUC_UNUSED,\n                                      const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    const char *matchstr = opaque;\n    int want = 0;\n\n    virObjectLock(obj);\n    if (virNodeDeviceObjHasCapStr(obj, matchstr))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjHasCapStr",
          "args": [
            "obj",
            "matchstr"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjHasCapStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "120-130",
          "snippet": "static bool\nvirNodeDeviceObjHasCapStr(const virNodeDeviceObj *obj,\n                          const char *cap)\n{\n    int type;\n\n    if ((type = virNodeDevCapTypeFromString(cap)) < 0)\n        return false;\n\n    return virNodeDeviceObjHasCap(obj, type);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic bool\nvirNodeDeviceObjHasCapStr(const virNodeDeviceObj *obj,\n                          const char *cap)\n{\n    int type;\n\n    if ((type = virNodeDevCapTypeFromString(cap)) < 0)\n        return false;\n\n    return virNodeDeviceObjHasCap(obj, type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\n\nstatic int\nvirNodeDeviceObjListFindByCapCallback(const void *payload,\n                                      const void *name G_GNUC_UNUSED,\n                                      const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    const char *matchstr = opaque;\n    int want = 0;\n\n    virObjectLock(obj);\n    if (virNodeDeviceObjHasCapStr(obj, matchstr))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindByFabricWWN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "313-320",
    "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByFabricWWN(virNodeDeviceObjListPtr devs,\n                                    const char *parent_fabric_wwn)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByFabricWWNCallback,\n                                      parent_fabric_wwn);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjListSearch",
          "args": [
            "devs",
            "virNodeDeviceObjListFindByFabricWWNCallback",
            "parent_fabric_wwn"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "181-197",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByFabricWWN(virNodeDeviceObjListPtr devs,\n                                    const char *parent_fabric_wwn)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByFabricWWNCallback,\n                                      parent_fabric_wwn);\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindByFabricWWNCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "293-310",
    "snippet": "static int\nvirNodeDeviceObjListFindByFabricWWNCallback(const void *payload,\n                                            const void *name G_GNUC_UNUSED,\n                                            const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    const char *matchstr = opaque;\n    virNodeDevCapsDefPtr cap;\n    int want = 0;\n\n    virObjectLock(obj);\n    if ((cap = virNodeDeviceFindFCCapDef(obj)) &&\n        STREQ_NULLABLE(cap->data.scsi_host.fabric_wwn, matchstr) &&\n        virNodeDeviceFindVPORTCapDef(obj))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindVPORTCapDef",
          "args": [
            "obj"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindVPORTCapDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "165-178",
          "snippet": "static virNodeDevCapsDefPtr\nvirNodeDeviceFindVPORTCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic virNodeDevCapsDefPtr\nvirNodeDeviceFindVPORTCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "cap->data.scsi_host.fabric_wwn",
            "matchstr"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindFCCapDef",
          "args": [
            "obj"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindFCCapDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "141-154",
          "snippet": "static virNodeDevCapsDefPtr\nvirNodeDeviceFindFCCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic virNodeDevCapsDefPtr\nvirNodeDeviceFindFCCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\n\nstatic int\nvirNodeDeviceObjListFindByFabricWWNCallback(const void *payload,\n                                            const void *name G_GNUC_UNUSED,\n                                            const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    const char *matchstr = opaque;\n    virNodeDevCapsDefPtr cap;\n    int want = 0;\n\n    virObjectLock(obj);\n    if ((cap = virNodeDeviceFindFCCapDef(obj)) &&\n        STREQ_NULLABLE(cap->data.scsi_host.fabric_wwn, matchstr) &&\n        virNodeDeviceFindVPORTCapDef(obj))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindByWWNs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "279-290",
    "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByWWNs(virNodeDeviceObjListPtr devs,\n                               const char *parent_wwnn,\n                               const char *parent_wwpn)\n{\n    struct virNodeDeviceObjListFindByWWNsData data = {\n        .parent_wwnn = parent_wwnn, .parent_wwpn = parent_wwpn };\n\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByWWNsCallback,\n                                      &data);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjListSearch",
          "args": [
            "devs",
            "virNodeDeviceObjListFindByWWNsCallback",
            "&data"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "181-197",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByWWNs(virNodeDeviceObjListPtr devs,\n                               const char *parent_wwnn,\n                               const char *parent_wwpn)\n{\n    struct virNodeDeviceObjListFindByWWNsData data = {\n        .parent_wwnn = parent_wwnn, .parent_wwpn = parent_wwpn };\n\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindByWWNsCallback,\n                                      &data);\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindByWWNsCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "257-276",
    "snippet": "static int\nvirNodeDeviceObjListFindByWWNsCallback(const void *payload,\n                                       const void *name G_GNUC_UNUSED,\n                                       const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    struct virNodeDeviceObjListFindByWWNsData *data =\n        (struct virNodeDeviceObjListFindByWWNsData *) opaque;\n    virNodeDevCapsDefPtr cap;\n    int want = 0;\n\n    virObjectLock(obj);\n    if ((cap = virNodeDeviceFindFCCapDef(obj)) &&\n        STREQ_NULLABLE(cap->data.scsi_host.wwnn, data->parent_wwnn) &&\n        STREQ_NULLABLE(cap->data.scsi_host.wwpn, data->parent_wwpn) &&\n        virNodeDeviceFindVPORTCapDef(obj))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindVPORTCapDef",
          "args": [
            "obj"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindVPORTCapDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "165-178",
          "snippet": "static virNodeDevCapsDefPtr\nvirNodeDeviceFindVPORTCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic virNodeDevCapsDefPtr\nvirNodeDeviceFindVPORTCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "cap->data.scsi_host.wwpn",
            "data->parent_wwpn"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "cap->data.scsi_host.wwnn",
            "data->parent_wwnn"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNodeDeviceFindFCCapDef",
          "args": [
            "obj"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceFindFCCapDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "141-154",
          "snippet": "static virNodeDevCapsDefPtr\nvirNodeDeviceFindFCCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic virNodeDevCapsDefPtr\nvirNodeDeviceFindFCCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\n\nstatic int\nvirNodeDeviceObjListFindByWWNsCallback(const void *payload,\n                                       const void *name G_GNUC_UNUSED,\n                                       const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    struct virNodeDeviceObjListFindByWWNsData *data =\n        (struct virNodeDeviceObjListFindByWWNsData *) opaque;\n    virNodeDevCapsDefPtr cap;\n    int want = 0;\n\n    virObjectLock(obj);\n    if ((cap = virNodeDeviceFindFCCapDef(obj)) &&\n        STREQ_NULLABLE(cap->data.scsi_host.wwnn, data->parent_wwnn) &&\n        STREQ_NULLABLE(cap->data.scsi_host.wwpn, data->parent_wwpn) &&\n        virNodeDeviceFindVPORTCapDef(obj))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "236-249",
    "snippet": "virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByName(virNodeDeviceObjListPtr devs,\n                               const char *name)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virNodeDeviceObjListFindByNameLocked(devs, name);\n    virObjectRWUnlock(devs);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "devs"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjListFindByNameLocked",
          "args": [
            "devs",
            "name"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListFindByNameLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "228-233",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByNameLocked(virNodeDeviceObjListPtr devs,\n                                     const char *name)\n{\n    return virObjectRef(virHashLookup(devs->objs, name));\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByNameLocked(virNodeDeviceObjListPtr devs,\n                                     const char *name)\n{\n    return virObjectRef(virHashLookup(devs->objs, name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "devs"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDeviceObjPtr\nvirNodeDeviceObjListFindByName(virNodeDeviceObjListPtr devs,\n                               const char *name)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virNodeDeviceObjListFindByNameLocked(devs, name);\n    virObjectRWUnlock(devs);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindByNameLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "228-233",
    "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByNameLocked(virNodeDeviceObjListPtr devs,\n                                     const char *name)\n{\n    return virObjectRef(virHashLookup(devs->objs, name));\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "virHashLookup(devs->objs, name)"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "devs->objs",
            "name"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListFindByNameLocked(virNodeDeviceObjListPtr devs,\n                                     const char *name)\n{\n    return virObjectRef(virHashLookup(devs->objs, name));\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindBySysfsPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "218-225",
    "snippet": "virNodeDeviceObjPtr\nvirNodeDeviceObjListFindBySysfsPath(virNodeDeviceObjListPtr devs,\n                                    const char *sysfs_path)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindBySysfsPathCallback,\n                                      sysfs_path);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjListSearch",
          "args": [
            "devs",
            "virNodeDeviceObjListFindBySysfsPathCallback",
            "sysfs_path"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjListSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "181-197",
          "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDeviceObjPtr\nvirNodeDeviceObjListFindBySysfsPath(virNodeDeviceObjListPtr devs,\n                                    const char *sysfs_path)\n{\n    return virNodeDeviceObjListSearch(devs,\n                                      virNodeDeviceObjListFindBySysfsPathCallback,\n                                      sysfs_path);\n}"
  },
  {
    "function_name": "virNodeDeviceObjListFindBySysfsPathCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "200-215",
    "snippet": "static int\nvirNodeDeviceObjListFindBySysfsPathCallback(const void *payload,\n                                            const void *name G_GNUC_UNUSED,\n                                            const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    const char *sysfs_path = opaque;\n    int want = 0;\n\n    virObjectLock(obj);\n    if (obj->def->sysfs_path &&\n        STREQ_NULLABLE(obj->def->sysfs_path, sysfs_path))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "obj->def->sysfs_path",
            "sysfs_path"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\n\nstatic int\nvirNodeDeviceObjListFindBySysfsPathCallback(const void *payload,\n                                            const void *name G_GNUC_UNUSED,\n                                            const void *opaque)\n{\n    virNodeDeviceObjPtr obj = (virNodeDeviceObjPtr) payload;\n    const char *sysfs_path = opaque;\n    int want = 0;\n\n    virObjectLock(obj);\n    if (obj->def->sysfs_path &&\n        STREQ_NULLABLE(obj->def->sysfs_path, sysfs_path))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}"
  },
  {
    "function_name": "virNodeDeviceObjListSearch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "181-197",
    "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "devs"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSearch",
          "args": [
            "devs->objs",
            "callback",
            "data",
            "NULL"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "736-761",
          "snippet": "void *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "devs"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjListSearch(virNodeDeviceObjListPtr devs,\n                           virHashSearcher callback,\n                           const void *data)\n{\n    virNodeDeviceObjPtr obj;\n\n    virObjectRWLockRead(devs);\n    obj = virHashSearch(devs->objs, callback, data, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(devs);\n\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
  },
  {
    "function_name": "virNodeDeviceFindVPORTCapDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "165-178",
    "snippet": "static virNodeDevCapsDefPtr\nvirNodeDeviceFindVPORTCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic virNodeDevCapsDefPtr\nvirNodeDeviceFindVPORTCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}"
  },
  {
    "function_name": "virNodeDeviceFindFCCapDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "141-154",
    "snippet": "static virNodeDevCapsDefPtr\nvirNodeDeviceFindFCCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic virNodeDevCapsDefPtr\nvirNodeDeviceFindFCCapDef(const virNodeDeviceObj *obj)\n{\n    virNodeDevCapsDefPtr caps = obj->def->caps;\n\n    while (caps) {\n        if (caps->data.type == VIR_NODE_DEV_CAP_SCSI_HOST &&\n            (caps->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n            break;\n\n        caps = caps->next;\n    }\n    return caps;\n}"
  },
  {
    "function_name": "virNodeDeviceObjHasCapStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "120-130",
    "snippet": "static bool\nvirNodeDeviceObjHasCapStr(const virNodeDeviceObj *obj,\n                          const char *cap)\n{\n    int type;\n\n    if ((type = virNodeDevCapTypeFromString(cap)) < 0)\n        return false;\n\n    return virNodeDeviceObjHasCap(obj, type);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceObjHasCap",
          "args": [
            "obj",
            "type"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceObjHasCap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
          "lines": "638-685",
          "snippet": "static bool\nvirNodeDeviceObjHasCap(const virNodeDeviceObj *obj,\n                       int type)\n{\n    virNodeDevCapsDefPtr cap = NULL;\n\n    for (cap = obj->def->caps; cap; cap = cap->next) {\n        if (type == cap->data.type)\n            return true;\n\n        switch (cap->data.type) {\n        case VIR_NODE_DEV_CAP_PCI_DEV:\n            if (type == VIR_NODE_DEV_CAP_MDEV_TYPES &&\n                (cap->data.pci_dev.flags & VIR_NODE_DEV_CAP_FLAG_PCI_MDEV))\n                return true;\n            break;\n\n        case VIR_NODE_DEV_CAP_SCSI_HOST:\n            if (type == VIR_NODE_DEV_CAP_FC_HOST &&\n                (cap->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n                return true;\n\n            if (type == VIR_NODE_DEV_CAP_VPORTS &&\n                (cap->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n                return true;\n            break;\n\n        case VIR_NODE_DEV_CAP_SYSTEM:\n        case VIR_NODE_DEV_CAP_USB_DEV:\n        case VIR_NODE_DEV_CAP_USB_INTERFACE:\n        case VIR_NODE_DEV_CAP_NET:\n        case VIR_NODE_DEV_CAP_SCSI_TARGET:\n        case VIR_NODE_DEV_CAP_SCSI:\n        case VIR_NODE_DEV_CAP_STORAGE:\n        case VIR_NODE_DEV_CAP_FC_HOST:\n        case VIR_NODE_DEV_CAP_VPORTS:\n        case VIR_NODE_DEV_CAP_SCSI_GENERIC:\n        case VIR_NODE_DEV_CAP_DRM:\n        case VIR_NODE_DEV_CAP_MDEV_TYPES:\n        case VIR_NODE_DEV_CAP_MDEV:\n        case VIR_NODE_DEV_CAP_CCW_DEV:\n        case VIR_NODE_DEV_CAP_LAST:\n            break;\n        }\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include \"virnodedeviceobj.h\"",
            "#include \"viralloc.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic bool\nvirNodeDeviceObjHasCap(const virNodeDeviceObj *obj,\n                       int type)\n{\n    virNodeDevCapsDefPtr cap = NULL;\n\n    for (cap = obj->def->caps; cap; cap = cap->next) {\n        if (type == cap->data.type)\n            return true;\n\n        switch (cap->data.type) {\n        case VIR_NODE_DEV_CAP_PCI_DEV:\n            if (type == VIR_NODE_DEV_CAP_MDEV_TYPES &&\n                (cap->data.pci_dev.flags & VIR_NODE_DEV_CAP_FLAG_PCI_MDEV))\n                return true;\n            break;\n\n        case VIR_NODE_DEV_CAP_SCSI_HOST:\n            if (type == VIR_NODE_DEV_CAP_FC_HOST &&\n                (cap->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_FC_HOST))\n                return true;\n\n            if (type == VIR_NODE_DEV_CAP_VPORTS &&\n                (cap->data.scsi_host.flags & VIR_NODE_DEV_CAP_FLAG_HBA_VPORT_OPS))\n                return true;\n            break;\n\n        case VIR_NODE_DEV_CAP_SYSTEM:\n        case VIR_NODE_DEV_CAP_USB_DEV:\n        case VIR_NODE_DEV_CAP_USB_INTERFACE:\n        case VIR_NODE_DEV_CAP_NET:\n        case VIR_NODE_DEV_CAP_SCSI_TARGET:\n        case VIR_NODE_DEV_CAP_SCSI:\n        case VIR_NODE_DEV_CAP_STORAGE:\n        case VIR_NODE_DEV_CAP_FC_HOST:\n        case VIR_NODE_DEV_CAP_VPORTS:\n        case VIR_NODE_DEV_CAP_SCSI_GENERIC:\n        case VIR_NODE_DEV_CAP_DRM:\n        case VIR_NODE_DEV_CAP_MDEV_TYPES:\n        case VIR_NODE_DEV_CAP_MDEV:\n        case VIR_NODE_DEV_CAP_CCW_DEV:\n        case VIR_NODE_DEV_CAP_LAST:\n            break;\n        }\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDevCapTypeFromString",
          "args": [
            "cap"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic bool virNodeDeviceObjHasCap(const virNodeDeviceObj *obj, int type);\n\nstatic bool\nvirNodeDeviceObjHasCapStr(const virNodeDeviceObj *obj,\n                          const char *cap)\n{\n    int type;\n\n    if ((type = virNodeDevCapTypeFromString(cap)) < 0)\n        return false;\n\n    return virNodeDeviceObjHasCap(obj, type);\n}"
  },
  {
    "function_name": "virNodeDeviceObjGetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "113-117",
    "snippet": "virNodeDeviceDefPtr\nvirNodeDeviceObjGetDef(virNodeDeviceObjPtr obj)\n{\n    return obj->def;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDeviceDefPtr\nvirNodeDeviceObjGetDef(virNodeDeviceObjPtr obj)\n{\n    return obj->def;\n}"
  },
  {
    "function_name": "virNodeDeviceObjEndAPI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "101-110",
    "snippet": "void\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "*obj"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "*obj"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNodeDeviceObjEndAPI(virNodeDeviceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
  },
  {
    "function_name": "virNodeDeviceObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "84-98",
    "snippet": "static virNodeDeviceObjPtr\nvirNodeDeviceObjNew(void)\n{\n    virNodeDeviceObjPtr obj;\n\n    if (virNodeDeviceObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virNodeDeviceObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNodeDeviceObjClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNodeDeviceObjClass"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeDeviceObjInitialize",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virClassPtr virNodeDeviceObjClass;\n\nstatic virNodeDeviceObjPtr\nvirNodeDeviceObjNew(void)\n{\n    virNodeDeviceObjPtr obj;\n\n    if (virNodeDeviceObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virNodeDeviceObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}"
  },
  {
    "function_name": "virNodeDeviceObjDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "75-81",
    "snippet": "static void\nvirNodeDeviceObjDispose(void *opaque)\n{\n    virNodeDeviceObjPtr obj = opaque;\n\n    virNodeDeviceDefFree(obj->def);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNodeDeviceObjDispose(void *opaque);",
      "static void virNodeDeviceObjListDispose(void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeDeviceDefFree",
          "args": [
            "obj->def"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/node_device_conf.c",
          "lines": "98-125",
          "snippet": "void\nvirNodeDeviceDefFree(virNodeDeviceDefPtr def)\n{\n    virNodeDevCapsDefPtr caps;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->parent);\n    VIR_FREE(def->parent_wwnn);\n    VIR_FREE(def->parent_wwpn);\n    VIR_FREE(def->parent_fabric_wwn);\n    VIR_FREE(def->driver);\n    VIR_FREE(def->sysfs_path);\n    VIR_FREE(def->parent_sysfs_path);\n    VIR_FREE(def->devnode);\n    virStringListFree(def->devlinks);\n\n    caps = def->caps;\n    while (caps) {\n        virNodeDevCapsDefPtr next = caps->next;\n        virNodeDevCapsDefFree(caps);\n        caps = next;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virfcp.h\"",
            "#include \"virlog.h\"",
            "#include \"virrandom.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"device_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfcp.h\"\n#include \"virlog.h\"\n#include \"virrandom.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"device_conf.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNodeDeviceDefFree(virNodeDeviceDefPtr def)\n{\n    virNodeDevCapsDefPtr caps;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->parent);\n    VIR_FREE(def->parent_wwnn);\n    VIR_FREE(def->parent_wwpn);\n    VIR_FREE(def->parent_fabric_wwn);\n    VIR_FREE(def->driver);\n    VIR_FREE(def->sysfs_path);\n    VIR_FREE(def->parent_sysfs_path);\n    VIR_FREE(def->devnode);\n    virStringListFree(def->devlinks);\n\n    caps = def->caps;\n    while (caps) {\n        virNodeDevCapsDefPtr next = caps->next;\n        virNodeDevCapsDefFree(caps);\n        caps = next;\n    }\n\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virNodeDeviceObjDispose(void *opaque);\nstatic void virNodeDeviceObjListDispose(void *opaque);\n\nstatic void\nvirNodeDeviceObjDispose(void *opaque)\n{\n    virNodeDeviceObjPtr obj = opaque;\n\n    virNodeDeviceDefFree(obj->def);\n}"
  },
  {
    "function_name": "virNodeDeviceObjOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnodedeviceobj.c",
    "lines": "60-70",
    "snippet": "static int\nvirNodeDeviceObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNodeDeviceObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virNodeDeviceObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virerror.h\"",
      "#include \"virnodedeviceobj.h\"",
      "#include \"viralloc.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNodeDeviceObjList",
            "virClassForObjectRWLockable()"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectRWLockable",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNodeDeviceObj",
            "virClassForObjectLockable()"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include \"virnodedeviceobj.h\"\n#include \"viralloc.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirNodeDeviceObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNodeDeviceObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virNodeDeviceObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]