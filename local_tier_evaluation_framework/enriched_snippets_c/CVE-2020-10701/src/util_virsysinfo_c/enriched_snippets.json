[
  {
    "function_name": "virSysinfoIsEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1580-1624",
    "snippet": "bool virSysinfoIsEqual(virSysinfoDefPtr src,\n                       virSysinfoDefPtr dst)\n{\n    size_t i;\n\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    if (src->type != dst->type) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Target sysinfo %s does not match source %s\"),\n                       virSysinfoTypeToString(dst->type),\n                       virSysinfoTypeToString(src->type));\n        return false;\n    }\n\n    if (!virSysinfoBIOSIsEqual(src->bios, dst->bios))\n        return false;\n\n    if (!virSysinfoSystemIsEqual(src->system, dst->system))\n        return false;\n\n    if (src->nbaseBoard != dst->nbaseBoard) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Target sysinfo base board count '%zu' does not match source '%zu'\"),\n                       dst->nbaseBoard, src->nbaseBoard);\n        return false;\n    }\n\n    for (i = 0; i < src->nbaseBoard; i++)\n        if (!virSysinfoBaseBoardIsEqual(src->baseBoard + i,\n                                        dst->baseBoard + i))\n            return false;\n\n    if (!virSysinfoChassisIsEqual(src->chassis, dst->chassis))\n        return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoChassisIsEqual",
          "args": [
            "src->chassis",
            "dst->chassis"
          ],
          "line": 1620
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoChassisIsEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1555-1575",
          "snippet": "static bool\nvirSysinfoChassisIsEqual(virSysinfoChassisDefPtr src,\n                         virSysinfoChassisDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target chassis does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"chassis vendor\");\n    CHECK_FIELD(version, \"chassis version\");\n    CHECK_FIELD(serial, \"chassis serial\");\n    CHECK_FIELD(asset, \"chassis asset\");\n    CHECK_FIELD(sku, \"chassis sku\");\n\n    return true;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoChassisIsEqual(virSysinfoChassisDefPtr src,\n                         virSysinfoChassisDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target chassis does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"chassis vendor\");\n    CHECK_FIELD(version, \"chassis version\");\n    CHECK_FIELD(serial, \"chassis serial\");\n    CHECK_FIELD(asset, \"chassis asset\");\n    CHECK_FIELD(sku, \"chassis sku\");\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoBaseBoardIsEqual",
          "args": [
            "src->baseBoard + i",
            "dst->baseBoard + i"
          ],
          "line": 1616
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoBaseBoardIsEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1531-1552",
          "snippet": "static bool\nvirSysinfoBaseBoardIsEqual(virSysinfoBaseBoardDefPtr src,\n                           virSysinfoBaseBoardDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target base board does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"base board vendor\");\n    CHECK_FIELD(product, \"base board product\");\n    CHECK_FIELD(version, \"base board version\");\n    CHECK_FIELD(serial, \"base board serial\");\n    CHECK_FIELD(asset, \"base board asset\");\n    CHECK_FIELD(location, \"base board location\");\n\n    return true;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoBaseBoardIsEqual(virSysinfoBaseBoardDefPtr src,\n                           virSysinfoBaseBoardDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target base board does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"base board vendor\");\n    CHECK_FIELD(product, \"base board product\");\n    CHECK_FIELD(version, \"base board version\");\n    CHECK_FIELD(serial, \"base board serial\");\n    CHECK_FIELD(asset, \"base board asset\");\n    CHECK_FIELD(location, \"base board location\");\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Target sysinfo base board count '%zu' does not match source '%zu'\")",
            "dst->nbaseBoard",
            "src->nbaseBoard"
          ],
          "line": 1609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Target sysinfo base board count '%zu' does not match source '%zu'\""
          ],
          "line": 1610
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoSystemIsEqual",
          "args": [
            "src->system",
            "dst->system"
          ],
          "line": 1605
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoSystemIsEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1507-1529",
          "snippet": "static bool\nvirSysinfoSystemIsEqual(virSysinfoSystemDefPtr src,\n                        virSysinfoSystemDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"system vendor\");\n    CHECK_FIELD(product, \"system product\");\n    CHECK_FIELD(version, \"system version\");\n    CHECK_FIELD(serial, \"system serial\");\n    CHECK_FIELD(uuid, \"system uuid\");\n    CHECK_FIELD(sku, \"system sku\");\n    CHECK_FIELD(family, \"system family\");\n\n    return true;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoSystemIsEqual(virSysinfoSystemDefPtr src,\n                        virSysinfoSystemDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"system vendor\");\n    CHECK_FIELD(product, \"system product\");\n    CHECK_FIELD(version, \"system version\");\n    CHECK_FIELD(serial, \"system serial\");\n    CHECK_FIELD(uuid, \"system uuid\");\n    CHECK_FIELD(sku, \"system sku\");\n    CHECK_FIELD(family, \"system family\");\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoBIOSIsEqual",
          "args": [
            "src->bios",
            "dst->bios"
          ],
          "line": 1602
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoBIOSIsEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1486-1505",
          "snippet": "static bool\nvirSysinfoBIOSIsEqual(virSysinfoBIOSDefPtr src,\n                      virSysinfoBIOSDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(vendor, \"BIOS vendor\");\n    CHECK_FIELD(version, \"BIOS version\");\n    CHECK_FIELD(date, \"BIOS date\");\n    CHECK_FIELD(release, \"BIOS release\");\n\n    return true;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoBIOSIsEqual(virSysinfoBIOSDefPtr src,\n                      virSysinfoBIOSDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(vendor, \"BIOS vendor\");\n    CHECK_FIELD(version, \"BIOS version\");\n    CHECK_FIELD(date, \"BIOS date\");\n    CHECK_FIELD(release, \"BIOS release\");\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Target sysinfo %s does not match source %s\")",
            "virSysinfoTypeToString(dst->type)",
            "virSysinfoTypeToString(src->type)"
          ],
          "line": 1595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoTypeToString",
          "args": [
            "src->type"
          ],
          "line": 1598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoTypeToString",
          "args": [
            "dst->type"
          ],
          "line": 1597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Target sysinfo does not match source\")"
          ],
          "line": 1589
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool virSysinfoIsEqual(virSysinfoDefPtr src,\n                       virSysinfoDefPtr dst)\n{\n    size_t i;\n\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    if (src->type != dst->type) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Target sysinfo %s does not match source %s\"),\n                       virSysinfoTypeToString(dst->type),\n                       virSysinfoTypeToString(src->type));\n        return false;\n    }\n\n    if (!virSysinfoBIOSIsEqual(src->bios, dst->bios))\n        return false;\n\n    if (!virSysinfoSystemIsEqual(src->system, dst->system))\n        return false;\n\n    if (src->nbaseBoard != dst->nbaseBoard) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Target sysinfo base board count '%zu' does not match source '%zu'\"),\n                       dst->nbaseBoard, src->nbaseBoard);\n        return false;\n    }\n\n    for (i = 0; i < src->nbaseBoard; i++)\n        if (!virSysinfoBaseBoardIsEqual(src->baseBoard + i,\n                                        dst->baseBoard + i))\n            return false;\n\n    if (!virSysinfoChassisIsEqual(src->chassis, dst->chassis))\n        return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virSysinfoChassisIsEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1555-1575",
    "snippet": "static bool\nvirSysinfoChassisIsEqual(virSysinfoChassisDefPtr src,\n                         virSysinfoChassisDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target chassis does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"chassis vendor\");\n    CHECK_FIELD(version, \"chassis version\");\n    CHECK_FIELD(serial, \"chassis serial\");\n    CHECK_FIELD(asset, \"chassis asset\");\n    CHECK_FIELD(sku, \"chassis sku\");\n\n    return true;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "sku",
            "\"chassis sku\""
          ],
          "line": 1572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "asset",
            "\"chassis asset\""
          ],
          "line": 1571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "serial",
            "\"chassis serial\""
          ],
          "line": 1570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "version",
            "\"chassis version\""
          ],
          "line": 1569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "manufacturer",
            "\"chassis vendor\""
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Target chassis does not match source\")"
          ],
          "line": 1563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Target chassis does not match source\""
          ],
          "line": 1564
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoChassisIsEqual(virSysinfoChassisDefPtr src,\n                         virSysinfoChassisDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target chassis does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"chassis vendor\");\n    CHECK_FIELD(version, \"chassis version\");\n    CHECK_FIELD(serial, \"chassis serial\");\n    CHECK_FIELD(asset, \"chassis asset\");\n    CHECK_FIELD(sku, \"chassis sku\");\n\n    return true;\n}"
  },
  {
    "function_name": "virSysinfoBaseBoardIsEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1531-1552",
    "snippet": "static bool\nvirSysinfoBaseBoardIsEqual(virSysinfoBaseBoardDefPtr src,\n                           virSysinfoBaseBoardDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target base board does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"base board vendor\");\n    CHECK_FIELD(product, \"base board product\");\n    CHECK_FIELD(version, \"base board version\");\n    CHECK_FIELD(serial, \"base board serial\");\n    CHECK_FIELD(asset, \"base board asset\");\n    CHECK_FIELD(location, \"base board location\");\n\n    return true;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "location",
            "\"base board location\""
          ],
          "line": 1549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "asset",
            "\"base board asset\""
          ],
          "line": 1548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "serial",
            "\"base board serial\""
          ],
          "line": 1547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "version",
            "\"base board version\""
          ],
          "line": 1546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "product",
            "\"base board product\""
          ],
          "line": 1545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "manufacturer",
            "\"base board vendor\""
          ],
          "line": 1544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Target base board does not match source\")"
          ],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Target base board does not match source\""
          ],
          "line": 1540
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoBaseBoardIsEqual(virSysinfoBaseBoardDefPtr src,\n                           virSysinfoBaseBoardDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target base board does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"base board vendor\");\n    CHECK_FIELD(product, \"base board product\");\n    CHECK_FIELD(version, \"base board version\");\n    CHECK_FIELD(serial, \"base board serial\");\n    CHECK_FIELD(asset, \"base board asset\");\n    CHECK_FIELD(location, \"base board location\");\n\n    return true;\n}"
  },
  {
    "function_name": "virSysinfoSystemIsEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1507-1529",
    "snippet": "static bool\nvirSysinfoSystemIsEqual(virSysinfoSystemDefPtr src,\n                        virSysinfoSystemDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"system vendor\");\n    CHECK_FIELD(product, \"system product\");\n    CHECK_FIELD(version, \"system version\");\n    CHECK_FIELD(serial, \"system serial\");\n    CHECK_FIELD(uuid, \"system uuid\");\n    CHECK_FIELD(sku, \"system sku\");\n    CHECK_FIELD(family, \"system family\");\n\n    return true;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "family",
            "\"system family\""
          ],
          "line": 1526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "sku",
            "\"system sku\""
          ],
          "line": 1525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "uuid",
            "\"system uuid\""
          ],
          "line": 1524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "serial",
            "\"system serial\""
          ],
          "line": 1523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "version",
            "\"system version\""
          ],
          "line": 1522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "product",
            "\"system product\""
          ],
          "line": 1521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "manufacturer",
            "\"system vendor\""
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Target sysinfo does not match source\")"
          ],
          "line": 1515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Target sysinfo does not match source\""
          ],
          "line": 1516
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoSystemIsEqual(virSysinfoSystemDefPtr src,\n                        virSysinfoSystemDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(manufacturer, \"system vendor\");\n    CHECK_FIELD(product, \"system product\");\n    CHECK_FIELD(version, \"system version\");\n    CHECK_FIELD(serial, \"system serial\");\n    CHECK_FIELD(uuid, \"system uuid\");\n    CHECK_FIELD(sku, \"system sku\");\n    CHECK_FIELD(family, \"system family\");\n\n    return true;\n}"
  },
  {
    "function_name": "virSysinfoBIOSIsEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1486-1505",
    "snippet": "static bool\nvirSysinfoBIOSIsEqual(virSysinfoBIOSDefPtr src,\n                      virSysinfoBIOSDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(vendor, \"BIOS vendor\");\n    CHECK_FIELD(version, \"BIOS version\");\n    CHECK_FIELD(date, \"BIOS date\");\n    CHECK_FIELD(release, \"BIOS release\");\n\n    return true;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "release",
            "\"BIOS release\""
          ],
          "line": 1502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "date",
            "\"BIOS date\""
          ],
          "line": 1501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "version",
            "\"BIOS version\""
          ],
          "line": 1500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FIELD",
          "args": [
            "vendor",
            "\"BIOS vendor\""
          ],
          "line": 1499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Target sysinfo does not match source\")"
          ],
          "line": 1494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Target sysinfo does not match source\""
          ],
          "line": 1495
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoBIOSIsEqual(virSysinfoBIOSDefPtr src,\n                      virSysinfoBIOSDefPtr dst)\n{\n    if (!src && !dst)\n        return true;\n\n    if ((src && !dst) || (!src && dst)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Target sysinfo does not match source\"));\n        return false;\n    }\n\n    CHECK_FIELD(vendor, \"BIOS vendor\");\n    CHECK_FIELD(version, \"BIOS version\");\n    CHECK_FIELD(date, \"BIOS date\");\n    CHECK_FIELD(release, \"BIOS release\");\n\n    return true;\n}"
  },
  {
    "function_name": "virSysinfoFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1446-1474",
    "snippet": "int\nvirSysinfoFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    virBuffer attrBuf = VIR_BUFFER_INITIALIZER;\n    virBuffer childrenBuf = VIR_BUFFER_INIT_CHILD(buf);\n    const char *type = virSysinfoTypeToString(def->type);\n\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected sysinfo type model %d\"),\n                       def->type);\n        virBufferFreeAndReset(buf);\n        return -1;\n    }\n\n    virSysinfoBIOSFormat(&childrenBuf, def->bios);\n    virSysinfoSystemFormat(&childrenBuf, def->system);\n    virSysinfoBaseBoardFormat(&childrenBuf, def->baseBoard, def->nbaseBoard);\n    virSysinfoChassisFormat(&childrenBuf, def->chassis);\n    virSysinfoProcessorFormat(&childrenBuf, def);\n    virSysinfoMemoryFormat(&childrenBuf, def);\n    virSysinfoOEMStringsFormat(&childrenBuf, def->oemStrings);\n\n    virBufferAsprintf(&attrBuf, \" type='%s'\", type);\n\n    virXMLFormatElement(buf, \"sysinfo\", &attrBuf, &childrenBuf);\n\n    return 0;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLFormatElement",
          "args": [
            "buf",
            "\"sysinfo\"",
            "&attrBuf",
            "&childrenBuf"
          ],
          "line": 1471
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLFormatElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1374-1399",
          "snippet": "void\nvirXMLFormatElement(virBufferPtr buf,\n                    const char *name,\n                    virBufferPtr attrBuf,\n                    virBufferPtr childBuf)\n{\n    if ((!attrBuf || virBufferUse(attrBuf) == 0) &&\n        (!childBuf || virBufferUse(childBuf) == 0))\n        return;\n\n    virBufferAsprintf(buf, \"<%s\", name);\n\n    if (attrBuf && virBufferUse(attrBuf) > 0)\n        virBufferAddBuffer(buf, attrBuf);\n\n    if (childBuf && virBufferUse(childBuf) > 0) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAddBuffer(buf, childBuf);\n        virBufferAsprintf(buf, \"</%s>\\n\", name);\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    virBufferFreeAndReset(attrBuf);\n    virBufferFreeAndReset(childBuf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLFormatElement(virBufferPtr buf,\n                    const char *name,\n                    virBufferPtr attrBuf,\n                    virBufferPtr childBuf)\n{\n    if ((!attrBuf || virBufferUse(attrBuf) == 0) &&\n        (!childBuf || virBufferUse(childBuf) == 0))\n        return;\n\n    virBufferAsprintf(buf, \"<%s\", name);\n\n    if (attrBuf && virBufferUse(attrBuf) > 0)\n        virBufferAddBuffer(buf, attrBuf);\n\n    if (childBuf && virBufferUse(childBuf) > 0) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAddBuffer(buf, childBuf);\n        virBufferAsprintf(buf, \"</%s>\\n\", name);\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    virBufferFreeAndReset(attrBuf);\n    virBufferFreeAndReset(childBuf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&attrBuf",
            "\" type='%s'\"",
            "type"
          ],
          "line": 1469
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoOEMStringsFormat",
          "args": [
            "&childrenBuf",
            "def->oemStrings"
          ],
          "line": 1467
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoOEMStringsFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1421-1437",
          "snippet": "static void\nvirSysinfoOEMStringsFormat(virBufferPtr buf, virSysinfoOEMStringsDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<oemStrings>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    for (i = 0; i < def->nvalues; i++) {\n        virBufferEscapeString(buf, \"<entry>%s</entry>\\n\",\n                              def->values[i]);\n    }\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</oemStrings>\\n\");\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoOEMStringsFormat(virBufferPtr buf, virSysinfoOEMStringsDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<oemStrings>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    for (i = 0; i < def->nvalues; i++) {\n        virBufferEscapeString(buf, \"<entry>%s</entry>\\n\",\n                              def->values[i]);\n    }\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</oemStrings>\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoMemoryFormat",
          "args": [
            "&childrenBuf",
            "def"
          ],
          "line": 1466
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoMemoryFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1367-1419",
          "snippet": "static void\nvirSysinfoMemoryFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    size_t i;\n    virSysinfoMemoryDefPtr memory;\n\n    for (i = 0; i < def->nmemory; i++) {\n        memory = &def->memory[i];\n\n        if (!memory->memory_size &&\n            !memory->memory_form_factor &&\n            !memory->memory_locator &&\n            !memory->memory_bank_locator &&\n            !memory->memory_type &&\n            !memory->memory_type_detail &&\n            !memory->memory_speed &&\n            !memory->memory_manufacturer &&\n            !memory->memory_serial_number &&\n            !memory->memory_part_number)\n            continue;\n\n        virBufferAddLit(buf, \"<memory_device>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<entry name='size'>%s</entry>\\n\",\n                              memory->memory_size);\n        virBufferEscapeString(buf,\n                              \"<entry name='form_factor'>%s</entry>\\n\",\n                              memory->memory_form_factor);\n        virBufferEscapeString(buf, \"<entry name='locator'>%s</entry>\\n\",\n                              memory->memory_locator);\n        virBufferEscapeString(buf,\n                              \"<entry name='bank_locator'>%s</entry>\\n\",\n                              memory->memory_bank_locator);\n        virBufferEscapeString(buf, \"<entry name='type'>%s</entry>\\n\",\n                              memory->memory_type);\n        virBufferEscapeString(buf,\n                              \"<entry name='type_detail'>%s</entry>\\n\",\n                              memory->memory_type_detail);\n        virBufferEscapeString(buf, \"<entry name='speed'>%s</entry>\\n\",\n                              memory->memory_speed);\n        virBufferEscapeString(buf,\n                              \"<entry name='manufacturer'>%s</entry>\\n\",\n                              memory->memory_manufacturer);\n        virBufferEscapeString(buf,\n                              \"<entry name='serial_number'>%s</entry>\\n\",\n                              memory->memory_serial_number);\n        virBufferEscapeString(buf,\n                              \"<entry name='part_number'>%s</entry>\\n\",\n                              memory->memory_part_number);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</memory_device>\\n\");\n    }\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoMemoryFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    size_t i;\n    virSysinfoMemoryDefPtr memory;\n\n    for (i = 0; i < def->nmemory; i++) {\n        memory = &def->memory[i];\n\n        if (!memory->memory_size &&\n            !memory->memory_form_factor &&\n            !memory->memory_locator &&\n            !memory->memory_bank_locator &&\n            !memory->memory_type &&\n            !memory->memory_type_detail &&\n            !memory->memory_speed &&\n            !memory->memory_manufacturer &&\n            !memory->memory_serial_number &&\n            !memory->memory_part_number)\n            continue;\n\n        virBufferAddLit(buf, \"<memory_device>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<entry name='size'>%s</entry>\\n\",\n                              memory->memory_size);\n        virBufferEscapeString(buf,\n                              \"<entry name='form_factor'>%s</entry>\\n\",\n                              memory->memory_form_factor);\n        virBufferEscapeString(buf, \"<entry name='locator'>%s</entry>\\n\",\n                              memory->memory_locator);\n        virBufferEscapeString(buf,\n                              \"<entry name='bank_locator'>%s</entry>\\n\",\n                              memory->memory_bank_locator);\n        virBufferEscapeString(buf, \"<entry name='type'>%s</entry>\\n\",\n                              memory->memory_type);\n        virBufferEscapeString(buf,\n                              \"<entry name='type_detail'>%s</entry>\\n\",\n                              memory->memory_type_detail);\n        virBufferEscapeString(buf, \"<entry name='speed'>%s</entry>\\n\",\n                              memory->memory_speed);\n        virBufferEscapeString(buf,\n                              \"<entry name='manufacturer'>%s</entry>\\n\",\n                              memory->memory_manufacturer);\n        virBufferEscapeString(buf,\n                              \"<entry name='serial_number'>%s</entry>\\n\",\n                              memory->memory_serial_number);\n        virBufferEscapeString(buf,\n                              \"<entry name='part_number'>%s</entry>\\n\",\n                              memory->memory_part_number);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</memory_device>\\n\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoProcessorFormat",
          "args": [
            "&childrenBuf",
            "def"
          ],
          "line": 1465
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoProcessorFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1315-1365",
          "snippet": "static void\nvirSysinfoProcessorFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    size_t i;\n    virSysinfoProcessorDefPtr processor;\n\n    for (i = 0; i < def->nprocessor; i++) {\n        processor = &def->processor[i];\n\n        if (!processor->processor_socket_destination &&\n            !processor->processor_type &&\n            !processor->processor_family &&\n            !processor->processor_manufacturer &&\n            !processor->processor_signature &&\n            !processor->processor_version &&\n            !processor->processor_external_clock &&\n            !processor->processor_max_speed &&\n            !processor->processor_status &&\n            !processor->processor_serial_number &&\n            !processor->processor_part_number)\n            continue;\n\n        virBufferAddLit(buf, \"<processor>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf,\n                              \"<entry name='socket_destination'>%s</entry>\\n\",\n                              processor->processor_socket_destination);\n        virBufferEscapeString(buf, \"<entry name='type'>%s</entry>\\n\",\n                              processor->processor_type);\n        virBufferEscapeString(buf, \"<entry name='family'>%s</entry>\\n\",\n                              processor->processor_family);\n        virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                              processor->processor_manufacturer);\n        virBufferEscapeString(buf, \"<entry name='signature'>%s</entry>\\n\",\n                              processor->processor_signature);\n        virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                              processor->processor_version);\n        virBufferEscapeString(buf, \"<entry name='external_clock'>%s</entry>\\n\",\n                              processor->processor_external_clock);\n        virBufferEscapeString(buf, \"<entry name='max_speed'>%s</entry>\\n\",\n                              processor->processor_max_speed);\n        virBufferEscapeString(buf, \"<entry name='status'>%s</entry>\\n\",\n                              processor->processor_status);\n        virBufferEscapeString(buf, \"<entry name='serial_number'>%s</entry>\\n\",\n                              processor->processor_serial_number);\n        virBufferEscapeString(buf, \"<entry name='part_number'>%s</entry>\\n\",\n                              processor->processor_part_number);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</processor>\\n\");\n    }\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoProcessorFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    size_t i;\n    virSysinfoProcessorDefPtr processor;\n\n    for (i = 0; i < def->nprocessor; i++) {\n        processor = &def->processor[i];\n\n        if (!processor->processor_socket_destination &&\n            !processor->processor_type &&\n            !processor->processor_family &&\n            !processor->processor_manufacturer &&\n            !processor->processor_signature &&\n            !processor->processor_version &&\n            !processor->processor_external_clock &&\n            !processor->processor_max_speed &&\n            !processor->processor_status &&\n            !processor->processor_serial_number &&\n            !processor->processor_part_number)\n            continue;\n\n        virBufferAddLit(buf, \"<processor>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf,\n                              \"<entry name='socket_destination'>%s</entry>\\n\",\n                              processor->processor_socket_destination);\n        virBufferEscapeString(buf, \"<entry name='type'>%s</entry>\\n\",\n                              processor->processor_type);\n        virBufferEscapeString(buf, \"<entry name='family'>%s</entry>\\n\",\n                              processor->processor_family);\n        virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                              processor->processor_manufacturer);\n        virBufferEscapeString(buf, \"<entry name='signature'>%s</entry>\\n\",\n                              processor->processor_signature);\n        virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                              processor->processor_version);\n        virBufferEscapeString(buf, \"<entry name='external_clock'>%s</entry>\\n\",\n                              processor->processor_external_clock);\n        virBufferEscapeString(buf, \"<entry name='max_speed'>%s</entry>\\n\",\n                              processor->processor_max_speed);\n        virBufferEscapeString(buf, \"<entry name='status'>%s</entry>\\n\",\n                              processor->processor_status);\n        virBufferEscapeString(buf, \"<entry name='serial_number'>%s</entry>\\n\",\n                              processor->processor_serial_number);\n        virBufferEscapeString(buf, \"<entry name='part_number'>%s</entry>\\n\",\n                              processor->processor_part_number);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</processor>\\n\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoChassisFormat",
          "args": [
            "&childrenBuf",
            "def->chassis"
          ],
          "line": 1464
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoChassisFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1291-1312",
          "snippet": "static void\nvirSysinfoChassisFormat(virBufferPtr buf,\n                        virSysinfoChassisDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<chassis>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                          def->manufacturer);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                          def->serial);\n    virBufferEscapeString(buf, \"<entry name='asset'>%s</entry>\\n\",\n                          def->asset);\n    virBufferEscapeString(buf, \"<entry name='sku'>%s</entry>\\n\",\n                          def->sku);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</chassis>\\n\");\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoChassisFormat(virBufferPtr buf,\n                        virSysinfoChassisDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<chassis>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                          def->manufacturer);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                          def->serial);\n    virBufferEscapeString(buf, \"<entry name='asset'>%s</entry>\\n\",\n                          def->asset);\n    virBufferEscapeString(buf, \"<entry name='sku'>%s</entry>\\n\",\n                          def->sku);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</chassis>\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoBaseBoardFormat",
          "args": [
            "&childrenBuf",
            "def->baseBoard",
            "def->nbaseBoard"
          ],
          "line": 1463
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoBaseBoardFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1260-1288",
          "snippet": "static void\nvirSysinfoBaseBoardFormat(virBufferPtr buf,\n                          virSysinfoBaseBoardDefPtr baseBoard,\n                          size_t nbaseBoard)\n{\n    virSysinfoBaseBoardDefPtr def;\n    size_t i;\n\n    for (i = 0; i < nbaseBoard; i++) {\n        def = baseBoard + i;\n\n        virBufferAddLit(buf, \"<baseBoard>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                              def->manufacturer);\n        virBufferEscapeString(buf, \"<entry name='product'>%s</entry>\\n\",\n                              def->product);\n        virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                              def->version);\n        virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                              def->serial);\n        virBufferEscapeString(buf, \"<entry name='asset'>%s</entry>\\n\",\n                              def->asset);\n        virBufferEscapeString(buf, \"<entry name='location'>%s</entry>\\n\",\n                              def->location);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</baseBoard>\\n\");\n    }\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoBaseBoardFormat(virBufferPtr buf,\n                          virSysinfoBaseBoardDefPtr baseBoard,\n                          size_t nbaseBoard)\n{\n    virSysinfoBaseBoardDefPtr def;\n    size_t i;\n\n    for (i = 0; i < nbaseBoard; i++) {\n        def = baseBoard + i;\n\n        virBufferAddLit(buf, \"<baseBoard>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                              def->manufacturer);\n        virBufferEscapeString(buf, \"<entry name='product'>%s</entry>\\n\",\n                              def->product);\n        virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                              def->version);\n        virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                              def->serial);\n        virBufferEscapeString(buf, \"<entry name='asset'>%s</entry>\\n\",\n                              def->asset);\n        virBufferEscapeString(buf, \"<entry name='location'>%s</entry>\\n\",\n                              def->location);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</baseBoard>\\n\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoSystemFormat",
          "args": [
            "&childrenBuf",
            "def->system"
          ],
          "line": 1462
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoSystemFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1234-1258",
          "snippet": "static void\nvirSysinfoSystemFormat(virBufferPtr buf, virSysinfoSystemDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<system>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                          def->manufacturer);\n    virBufferEscapeString(buf, \"<entry name='product'>%s</entry>\\n\",\n                          def->product);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                          def->serial);\n    virBufferEscapeString(buf, \"<entry name='uuid'>%s</entry>\\n\",\n                          def->uuid);\n    virBufferEscapeString(buf, \"<entry name='sku'>%s</entry>\\n\",\n                          def->sku);\n    virBufferEscapeString(buf, \"<entry name='family'>%s</entry>\\n\",\n                          def->family);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</system>\\n\");\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoSystemFormat(virBufferPtr buf, virSysinfoSystemDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<system>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                          def->manufacturer);\n    virBufferEscapeString(buf, \"<entry name='product'>%s</entry>\\n\",\n                          def->product);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                          def->serial);\n    virBufferEscapeString(buf, \"<entry name='uuid'>%s</entry>\\n\",\n                          def->uuid);\n    virBufferEscapeString(buf, \"<entry name='sku'>%s</entry>\\n\",\n                          def->sku);\n    virBufferEscapeString(buf, \"<entry name='family'>%s</entry>\\n\",\n                          def->family);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</system>\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoBIOSFormat",
          "args": [
            "&childrenBuf",
            "def->bios"
          ],
          "line": 1461
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoBIOSFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1214-1232",
          "snippet": "static void\nvirSysinfoBIOSFormat(virBufferPtr buf, virSysinfoBIOSDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<bios>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='vendor'>%s</entry>\\n\",\n                          def->vendor);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='date'>%s</entry>\\n\",\n                          def->date);\n    virBufferEscapeString(buf, \"<entry name='release'>%s</entry>\\n\",\n                          def->release);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</bios>\\n\");\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoBIOSFormat(virBufferPtr buf, virSysinfoBIOSDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<bios>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='vendor'>%s</entry>\\n\",\n                          def->vendor);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='date'>%s</entry>\\n\",\n                          def->date);\n    virBufferEscapeString(buf, \"<entry name='release'>%s</entry>\\n\",\n                          def->release);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</bios>\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "buf"
          ],
          "line": 1457
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected sysinfo type model %d\")",
            "def->type"
          ],
          "line": 1454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected sysinfo type model %d\""
          ],
          "line": 1455
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoTypeToString",
          "args": [
            "def->type"
          ],
          "line": 1451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_BUFFER_INIT_CHILD",
          "args": [
            "buf"
          ],
          "line": 1450
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSysinfoFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    virBuffer attrBuf = VIR_BUFFER_INITIALIZER;\n    virBuffer childrenBuf = VIR_BUFFER_INIT_CHILD(buf);\n    const char *type = virSysinfoTypeToString(def->type);\n\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected sysinfo type model %d\"),\n                       def->type);\n        virBufferFreeAndReset(buf);\n        return -1;\n    }\n\n    virSysinfoBIOSFormat(&childrenBuf, def->bios);\n    virSysinfoSystemFormat(&childrenBuf, def->system);\n    virSysinfoBaseBoardFormat(&childrenBuf, def->baseBoard, def->nbaseBoard);\n    virSysinfoChassisFormat(&childrenBuf, def->chassis);\n    virSysinfoProcessorFormat(&childrenBuf, def);\n    virSysinfoMemoryFormat(&childrenBuf, def);\n    virSysinfoOEMStringsFormat(&childrenBuf, def->oemStrings);\n\n    virBufferAsprintf(&attrBuf, \" type='%s'\", type);\n\n    virXMLFormatElement(buf, \"sysinfo\", &attrBuf, &childrenBuf);\n\n    return 0;\n}"
  },
  {
    "function_name": "virSysinfoOEMStringsFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1421-1437",
    "snippet": "static void\nvirSysinfoOEMStringsFormat(virBufferPtr buf, virSysinfoOEMStringsDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<oemStrings>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    for (i = 0; i < def->nvalues; i++) {\n        virBufferEscapeString(buf, \"<entry>%s</entry>\\n\",\n                              def->values[i]);\n    }\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</oemStrings>\\n\");\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</oemStrings>\\n\""
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1435
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<entry>%s</entry>\\n\"",
            "def->values[i]"
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<oemStrings>\\n\""
          ],
          "line": 1429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoOEMStringsFormat(virBufferPtr buf, virSysinfoOEMStringsDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<oemStrings>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    for (i = 0; i < def->nvalues; i++) {\n        virBufferEscapeString(buf, \"<entry>%s</entry>\\n\",\n                              def->values[i]);\n    }\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</oemStrings>\\n\");\n}"
  },
  {
    "function_name": "virSysinfoMemoryFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1367-1419",
    "snippet": "static void\nvirSysinfoMemoryFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    size_t i;\n    virSysinfoMemoryDefPtr memory;\n\n    for (i = 0; i < def->nmemory; i++) {\n        memory = &def->memory[i];\n\n        if (!memory->memory_size &&\n            !memory->memory_form_factor &&\n            !memory->memory_locator &&\n            !memory->memory_bank_locator &&\n            !memory->memory_type &&\n            !memory->memory_type_detail &&\n            !memory->memory_speed &&\n            !memory->memory_manufacturer &&\n            !memory->memory_serial_number &&\n            !memory->memory_part_number)\n            continue;\n\n        virBufferAddLit(buf, \"<memory_device>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<entry name='size'>%s</entry>\\n\",\n                              memory->memory_size);\n        virBufferEscapeString(buf,\n                              \"<entry name='form_factor'>%s</entry>\\n\",\n                              memory->memory_form_factor);\n        virBufferEscapeString(buf, \"<entry name='locator'>%s</entry>\\n\",\n                              memory->memory_locator);\n        virBufferEscapeString(buf,\n                              \"<entry name='bank_locator'>%s</entry>\\n\",\n                              memory->memory_bank_locator);\n        virBufferEscapeString(buf, \"<entry name='type'>%s</entry>\\n\",\n                              memory->memory_type);\n        virBufferEscapeString(buf,\n                              \"<entry name='type_detail'>%s</entry>\\n\",\n                              memory->memory_type_detail);\n        virBufferEscapeString(buf, \"<entry name='speed'>%s</entry>\\n\",\n                              memory->memory_speed);\n        virBufferEscapeString(buf,\n                              \"<entry name='manufacturer'>%s</entry>\\n\",\n                              memory->memory_manufacturer);\n        virBufferEscapeString(buf,\n                              \"<entry name='serial_number'>%s</entry>\\n\",\n                              memory->memory_serial_number);\n        virBufferEscapeString(buf,\n                              \"<entry name='part_number'>%s</entry>\\n\",\n                              memory->memory_part_number);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</memory_device>\\n\");\n    }\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</memory_device>\\n\""
          ],
          "line": 1417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1416
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<entry name='part_number'>%s</entry>\\n\"",
            "memory->memory_part_number"
          ],
          "line": 1413
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<memory_device>\\n\""
          ],
          "line": 1388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoMemoryFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    size_t i;\n    virSysinfoMemoryDefPtr memory;\n\n    for (i = 0; i < def->nmemory; i++) {\n        memory = &def->memory[i];\n\n        if (!memory->memory_size &&\n            !memory->memory_form_factor &&\n            !memory->memory_locator &&\n            !memory->memory_bank_locator &&\n            !memory->memory_type &&\n            !memory->memory_type_detail &&\n            !memory->memory_speed &&\n            !memory->memory_manufacturer &&\n            !memory->memory_serial_number &&\n            !memory->memory_part_number)\n            continue;\n\n        virBufferAddLit(buf, \"<memory_device>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<entry name='size'>%s</entry>\\n\",\n                              memory->memory_size);\n        virBufferEscapeString(buf,\n                              \"<entry name='form_factor'>%s</entry>\\n\",\n                              memory->memory_form_factor);\n        virBufferEscapeString(buf, \"<entry name='locator'>%s</entry>\\n\",\n                              memory->memory_locator);\n        virBufferEscapeString(buf,\n                              \"<entry name='bank_locator'>%s</entry>\\n\",\n                              memory->memory_bank_locator);\n        virBufferEscapeString(buf, \"<entry name='type'>%s</entry>\\n\",\n                              memory->memory_type);\n        virBufferEscapeString(buf,\n                              \"<entry name='type_detail'>%s</entry>\\n\",\n                              memory->memory_type_detail);\n        virBufferEscapeString(buf, \"<entry name='speed'>%s</entry>\\n\",\n                              memory->memory_speed);\n        virBufferEscapeString(buf,\n                              \"<entry name='manufacturer'>%s</entry>\\n\",\n                              memory->memory_manufacturer);\n        virBufferEscapeString(buf,\n                              \"<entry name='serial_number'>%s</entry>\\n\",\n                              memory->memory_serial_number);\n        virBufferEscapeString(buf,\n                              \"<entry name='part_number'>%s</entry>\\n\",\n                              memory->memory_part_number);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</memory_device>\\n\");\n    }\n}"
  },
  {
    "function_name": "virSysinfoProcessorFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1315-1365",
    "snippet": "static void\nvirSysinfoProcessorFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    size_t i;\n    virSysinfoProcessorDefPtr processor;\n\n    for (i = 0; i < def->nprocessor; i++) {\n        processor = &def->processor[i];\n\n        if (!processor->processor_socket_destination &&\n            !processor->processor_type &&\n            !processor->processor_family &&\n            !processor->processor_manufacturer &&\n            !processor->processor_signature &&\n            !processor->processor_version &&\n            !processor->processor_external_clock &&\n            !processor->processor_max_speed &&\n            !processor->processor_status &&\n            !processor->processor_serial_number &&\n            !processor->processor_part_number)\n            continue;\n\n        virBufferAddLit(buf, \"<processor>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf,\n                              \"<entry name='socket_destination'>%s</entry>\\n\",\n                              processor->processor_socket_destination);\n        virBufferEscapeString(buf, \"<entry name='type'>%s</entry>\\n\",\n                              processor->processor_type);\n        virBufferEscapeString(buf, \"<entry name='family'>%s</entry>\\n\",\n                              processor->processor_family);\n        virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                              processor->processor_manufacturer);\n        virBufferEscapeString(buf, \"<entry name='signature'>%s</entry>\\n\",\n                              processor->processor_signature);\n        virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                              processor->processor_version);\n        virBufferEscapeString(buf, \"<entry name='external_clock'>%s</entry>\\n\",\n                              processor->processor_external_clock);\n        virBufferEscapeString(buf, \"<entry name='max_speed'>%s</entry>\\n\",\n                              processor->processor_max_speed);\n        virBufferEscapeString(buf, \"<entry name='status'>%s</entry>\\n\",\n                              processor->processor_status);\n        virBufferEscapeString(buf, \"<entry name='serial_number'>%s</entry>\\n\",\n                              processor->processor_serial_number);\n        virBufferEscapeString(buf, \"<entry name='part_number'>%s</entry>\\n\",\n                              processor->processor_part_number);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</processor>\\n\");\n    }\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</processor>\\n\""
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1362
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<entry name='part_number'>%s</entry>\\n\"",
            "processor->processor_part_number"
          ],
          "line": 1360
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<processor>\\n\""
          ],
          "line": 1337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoProcessorFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    size_t i;\n    virSysinfoProcessorDefPtr processor;\n\n    for (i = 0; i < def->nprocessor; i++) {\n        processor = &def->processor[i];\n\n        if (!processor->processor_socket_destination &&\n            !processor->processor_type &&\n            !processor->processor_family &&\n            !processor->processor_manufacturer &&\n            !processor->processor_signature &&\n            !processor->processor_version &&\n            !processor->processor_external_clock &&\n            !processor->processor_max_speed &&\n            !processor->processor_status &&\n            !processor->processor_serial_number &&\n            !processor->processor_part_number)\n            continue;\n\n        virBufferAddLit(buf, \"<processor>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf,\n                              \"<entry name='socket_destination'>%s</entry>\\n\",\n                              processor->processor_socket_destination);\n        virBufferEscapeString(buf, \"<entry name='type'>%s</entry>\\n\",\n                              processor->processor_type);\n        virBufferEscapeString(buf, \"<entry name='family'>%s</entry>\\n\",\n                              processor->processor_family);\n        virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                              processor->processor_manufacturer);\n        virBufferEscapeString(buf, \"<entry name='signature'>%s</entry>\\n\",\n                              processor->processor_signature);\n        virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                              processor->processor_version);\n        virBufferEscapeString(buf, \"<entry name='external_clock'>%s</entry>\\n\",\n                              processor->processor_external_clock);\n        virBufferEscapeString(buf, \"<entry name='max_speed'>%s</entry>\\n\",\n                              processor->processor_max_speed);\n        virBufferEscapeString(buf, \"<entry name='status'>%s</entry>\\n\",\n                              processor->processor_status);\n        virBufferEscapeString(buf, \"<entry name='serial_number'>%s</entry>\\n\",\n                              processor->processor_serial_number);\n        virBufferEscapeString(buf, \"<entry name='part_number'>%s</entry>\\n\",\n                              processor->processor_part_number);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</processor>\\n\");\n    }\n}"
  },
  {
    "function_name": "virSysinfoChassisFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1291-1312",
    "snippet": "static void\nvirSysinfoChassisFormat(virBufferPtr buf,\n                        virSysinfoChassisDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<chassis>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                          def->manufacturer);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                          def->serial);\n    virBufferEscapeString(buf, \"<entry name='asset'>%s</entry>\\n\",\n                          def->asset);\n    virBufferEscapeString(buf, \"<entry name='sku'>%s</entry>\\n\",\n                          def->sku);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</chassis>\\n\");\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</chassis>\\n\""
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1310
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<entry name='sku'>%s</entry>\\n\"",
            "def->sku"
          ],
          "line": 1308
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<chassis>\\n\""
          ],
          "line": 1298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoChassisFormat(virBufferPtr buf,\n                        virSysinfoChassisDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<chassis>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                          def->manufacturer);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                          def->serial);\n    virBufferEscapeString(buf, \"<entry name='asset'>%s</entry>\\n\",\n                          def->asset);\n    virBufferEscapeString(buf, \"<entry name='sku'>%s</entry>\\n\",\n                          def->sku);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</chassis>\\n\");\n}"
  },
  {
    "function_name": "virSysinfoBaseBoardFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1260-1288",
    "snippet": "static void\nvirSysinfoBaseBoardFormat(virBufferPtr buf,\n                          virSysinfoBaseBoardDefPtr baseBoard,\n                          size_t nbaseBoard)\n{\n    virSysinfoBaseBoardDefPtr def;\n    size_t i;\n\n    for (i = 0; i < nbaseBoard; i++) {\n        def = baseBoard + i;\n\n        virBufferAddLit(buf, \"<baseBoard>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                              def->manufacturer);\n        virBufferEscapeString(buf, \"<entry name='product'>%s</entry>\\n\",\n                              def->product);\n        virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                              def->version);\n        virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                              def->serial);\n        virBufferEscapeString(buf, \"<entry name='asset'>%s</entry>\\n\",\n                              def->asset);\n        virBufferEscapeString(buf, \"<entry name='location'>%s</entry>\\n\",\n                              def->location);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</baseBoard>\\n\");\n    }\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</baseBoard>\\n\""
          ],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1285
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<entry name='location'>%s</entry>\\n\"",
            "def->location"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<baseBoard>\\n\""
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoBaseBoardFormat(virBufferPtr buf,\n                          virSysinfoBaseBoardDefPtr baseBoard,\n                          size_t nbaseBoard)\n{\n    virSysinfoBaseBoardDefPtr def;\n    size_t i;\n\n    for (i = 0; i < nbaseBoard; i++) {\n        def = baseBoard + i;\n\n        virBufferAddLit(buf, \"<baseBoard>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                              def->manufacturer);\n        virBufferEscapeString(buf, \"<entry name='product'>%s</entry>\\n\",\n                              def->product);\n        virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                              def->version);\n        virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                              def->serial);\n        virBufferEscapeString(buf, \"<entry name='asset'>%s</entry>\\n\",\n                              def->asset);\n        virBufferEscapeString(buf, \"<entry name='location'>%s</entry>\\n\",\n                              def->location);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</baseBoard>\\n\");\n    }\n}"
  },
  {
    "function_name": "virSysinfoSystemFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1234-1258",
    "snippet": "static void\nvirSysinfoSystemFormat(virBufferPtr buf, virSysinfoSystemDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<system>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                          def->manufacturer);\n    virBufferEscapeString(buf, \"<entry name='product'>%s</entry>\\n\",\n                          def->product);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                          def->serial);\n    virBufferEscapeString(buf, \"<entry name='uuid'>%s</entry>\\n\",\n                          def->uuid);\n    virBufferEscapeString(buf, \"<entry name='sku'>%s</entry>\\n\",\n                          def->sku);\n    virBufferEscapeString(buf, \"<entry name='family'>%s</entry>\\n\",\n                          def->family);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</system>\\n\");\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</system>\\n\""
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1256
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<entry name='family'>%s</entry>\\n\"",
            "def->family"
          ],
          "line": 1254
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<system>\\n\""
          ],
          "line": 1240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoSystemFormat(virBufferPtr buf, virSysinfoSystemDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<system>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='manufacturer'>%s</entry>\\n\",\n                          def->manufacturer);\n    virBufferEscapeString(buf, \"<entry name='product'>%s</entry>\\n\",\n                          def->product);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='serial'>%s</entry>\\n\",\n                          def->serial);\n    virBufferEscapeString(buf, \"<entry name='uuid'>%s</entry>\\n\",\n                          def->uuid);\n    virBufferEscapeString(buf, \"<entry name='sku'>%s</entry>\\n\",\n                          def->sku);\n    virBufferEscapeString(buf, \"<entry name='family'>%s</entry>\\n\",\n                          def->family);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</system>\\n\");\n}"
  },
  {
    "function_name": "virSysinfoBIOSFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1214-1232",
    "snippet": "static void\nvirSysinfoBIOSFormat(virBufferPtr buf, virSysinfoBIOSDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<bios>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='vendor'>%s</entry>\\n\",\n                          def->vendor);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='date'>%s</entry>\\n\",\n                          def->date);\n    virBufferEscapeString(buf, \"<entry name='release'>%s</entry>\\n\",\n                          def->release);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</bios>\\n\");\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</bios>\\n\""
          ],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<entry name='release'>%s</entry>\\n\"",
            "def->release"
          ],
          "line": 1228
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<bios>\\n\""
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirSysinfoBIOSFormat(virBufferPtr buf, virSysinfoBIOSDefPtr def)\n{\n    if (!def)\n        return;\n\n    virBufferAddLit(buf, \"<bios>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<entry name='vendor'>%s</entry>\\n\",\n                          def->vendor);\n    virBufferEscapeString(buf, \"<entry name='version'>%s</entry>\\n\",\n                          def->version);\n    virBufferEscapeString(buf, \"<entry name='date'>%s</entry>\\n\",\n                          def->date);\n    virBufferEscapeString(buf, \"<entry name='release'>%s</entry>\\n\",\n                          def->release);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</bios>\\n\");\n}"
  },
  {
    "function_name": "virSysinfoRead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1188-1211",
    "snippet": "virSysinfoDefPtr\nvirSysinfoRead(void)\n{\n#if defined(__powerpc__)\n    return virSysinfoReadPPC();\n#elif defined(__arm__) || defined(__aarch64__)\n    return virSysinfoReadARM();\n#elif defined(__s390__) || defined(__s390x__)\n    return virSysinfoReadS390();\n#elif !defined(WIN32) && \\\n    (defined(__x86_64__) || \\\n     defined(__i386__) || \\\n     defined(__amd64__))\n    return virSysinfoReadDMI();\n#else /* WIN32 || not supported arch */\n    /*\n     * this can probably be extracted from Windows using API or registry\n     * http://www.microsoft.com/whdc/system/platform/firmware/SMBIOS.mspx\n     */\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Host sysinfo extraction not supported on this platform\"));\n    return NULL;\n#endif /* WIN32 || not supported arch */\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Host sysinfo extraction not supported on this platform\")"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Host sysinfo extraction not supported on this platform\""
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoReadDMI",
          "args": [],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoReadDMI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1119-1178",
          "snippet": "virSysinfoDefPtr\nvirSysinfoReadDMI(void)\n{\n    char *path;\n    virSysinfoDefPtr ret = NULL;\n    char *outbuf = NULL;\n    virCommandPtr cmd;\n\n    path = virFindFileInPath(SYSINFO_SMBIOS_DECODER);\n    if (path == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find path for %s binary\"),\n                       SYSINFO_SMBIOS_DECODER);\n        return NULL;\n    }\n\n    cmd = virCommandNewArgList(path, \"-q\", \"-t\", \"0,1,2,3,4,17\", NULL);\n    VIR_FREE(path);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->type = VIR_SYSINFO_SMBIOS;\n\n    if (virSysinfoParseBIOS(outbuf, &ret->bios) < 0)\n        goto error;\n\n    if (virSysinfoParseX86System(outbuf, &ret->system) < 0)\n        goto error;\n\n    if (virSysinfoParseX86BaseBoard(outbuf, &ret->baseBoard, &ret->nbaseBoard) < 0)\n        goto error;\n\n    if (virSysinfoParseX86Chassis(outbuf, &ret->chassis) < 0)\n        goto error;\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseX86Processor(outbuf, ret) < 0)\n        goto error;\n\n    ret->nmemory = 0;\n    ret->memory = NULL;\n    if (virSysinfoParseX86Memory(outbuf, ret) < 0)\n        goto error;\n\n cleanup:\n    VIR_FREE(outbuf);\n    virCommandFree(cmd);\n\n    return ret;\n\n error:\n    virSysinfoDefFree(ret);\n    ret = NULL;\n    goto cleanup;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSINFO_SMBIOS_DECODER sysinfoDmidecode"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define SYSINFO_SMBIOS_DECODER sysinfoDmidecode\n\nvirSysinfoDefPtr\nvirSysinfoReadDMI(void)\n{\n    char *path;\n    virSysinfoDefPtr ret = NULL;\n    char *outbuf = NULL;\n    virCommandPtr cmd;\n\n    path = virFindFileInPath(SYSINFO_SMBIOS_DECODER);\n    if (path == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find path for %s binary\"),\n                       SYSINFO_SMBIOS_DECODER);\n        return NULL;\n    }\n\n    cmd = virCommandNewArgList(path, \"-q\", \"-t\", \"0,1,2,3,4,17\", NULL);\n    VIR_FREE(path);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->type = VIR_SYSINFO_SMBIOS;\n\n    if (virSysinfoParseBIOS(outbuf, &ret->bios) < 0)\n        goto error;\n\n    if (virSysinfoParseX86System(outbuf, &ret->system) < 0)\n        goto error;\n\n    if (virSysinfoParseX86BaseBoard(outbuf, &ret->baseBoard, &ret->nbaseBoard) < 0)\n        goto error;\n\n    if (virSysinfoParseX86Chassis(outbuf, &ret->chassis) < 0)\n        goto error;\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseX86Processor(outbuf, ret) < 0)\n        goto error;\n\n    ret->nmemory = 0;\n    ret->memory = NULL;\n    if (virSysinfoParseX86Memory(outbuf, ret) < 0)\n        goto error;\n\n cleanup:\n    VIR_FREE(outbuf);\n    virCommandFree(cmd);\n\n    return ret;\n\n error:\n    virSysinfoDefFree(ret);\n    ret = NULL;\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoReadS390",
          "args": [],
          "line": 1196
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoReadS390",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "595-628",
          "snippet": "virSysinfoDefPtr\nvirSysinfoReadS390(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    /* Gather info from /proc/cpuinfo */\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    if (virSysinfoParseS390Processor(outbuf, ret) < 0)\n        return NULL;\n\n    /* Free buffer before reading next file */\n    VIR_FREE(outbuf);\n\n    /* Gather info from /proc/sysinfo */\n    if (virFileReadAll(SYSINFO, 8192, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), SYSINFO);\n        return NULL;\n    }\n\n    if (virSysinfoParseS390System(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */",
            "#define CPUINFO sysinfoCpuinfo",
            "#define SYSINFO sysinfoSysinfo"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */\n#define CPUINFO sysinfoCpuinfo\n#define SYSINFO sysinfoSysinfo\n\nvirSysinfoDefPtr\nvirSysinfoReadS390(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    /* Gather info from /proc/cpuinfo */\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    if (virSysinfoParseS390Processor(outbuf, ret) < 0)\n        return NULL;\n\n    /* Free buffer before reading next file */\n    VIR_FREE(outbuf);\n\n    /* Gather info from /proc/sysinfo */\n    if (virFileReadAll(SYSINFO, 8192, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), SYSINFO);\n        return NULL;\n    }\n\n    if (virSysinfoParseS390System(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoReadARM",
          "args": [],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoReadARM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "426-460",
          "snippet": "virSysinfoDefPtr\nvirSysinfoReadARM(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    /* Some ARM systems have DMI tables available. */\n    if ((ret = virSysinfoReadDMI())) {\n        if (!virSysinfoDefIsEmpty(ret))\n            return g_steal_pointer(&ret);\n        virSysinfoDefFree(ret);\n    }\n\n    /* Well, we've tried. Fall back to parsing cpuinfo */\n    virResetLastError();\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseARMProcessor(outbuf, ret) < 0)\n        return NULL;\n\n    if (virSysinfoParseARMSystem(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */",
            "#define CPUINFO sysinfoCpuinfo"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */\n#define CPUINFO sysinfoCpuinfo\n\nvirSysinfoDefPtr\nvirSysinfoReadARM(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    /* Some ARM systems have DMI tables available. */\n    if ((ret = virSysinfoReadDMI())) {\n        if (!virSysinfoDefIsEmpty(ret))\n            return g_steal_pointer(&ret);\n        virSysinfoDefFree(ret);\n    }\n\n    /* Well, we've tried. Fall back to parsing cpuinfo */\n    virResetLastError();\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseARMProcessor(outbuf, ret) < 0)\n        return NULL;\n\n    if (virSysinfoParseARMSystem(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoReadPPC",
          "args": [],
          "line": 1192
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoReadPPC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "301-325",
          "snippet": "virSysinfoDefPtr\nvirSysinfoReadPPC(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParsePPCProcessor(outbuf, ret) < 0)\n        return NULL;\n\n    if (virSysinfoParsePPCSystem(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */",
            "#define CPUINFO sysinfoCpuinfo"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */\n#define CPUINFO sysinfoCpuinfo\n\nvirSysinfoDefPtr\nvirSysinfoReadPPC(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParsePPCProcessor(outbuf, ret) < 0)\n        return NULL;\n\n    if (virSysinfoParsePPCSystem(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirSysinfoDefPtr\nvirSysinfoRead(void)\n{\n#if defined(__powerpc__)\n    return virSysinfoReadPPC();\n#elif defined(__arm__) || defined(__aarch64__)\n    return virSysinfoReadARM();\n#elif defined(__s390__) || defined(__s390x__)\n    return virSysinfoReadS390();\n#elif !defined(WIN32) && \\\n    (defined(__x86_64__) || \\\n     defined(__i386__) || \\\n     defined(__amd64__))\n    return virSysinfoReadDMI();\n#else /* WIN32 || not supported arch */\n    /*\n     * this can probably be extracted from Windows using API or registry\n     * http://www.microsoft.com/whdc/system/platform/firmware/SMBIOS.mspx\n     */\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Host sysinfo extraction not supported on this platform\"));\n    return NULL;\n#endif /* WIN32 || not supported arch */\n}"
  },
  {
    "function_name": "virSysinfoReadDMI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1119-1178",
    "snippet": "virSysinfoDefPtr\nvirSysinfoReadDMI(void)\n{\n    char *path;\n    virSysinfoDefPtr ret = NULL;\n    char *outbuf = NULL;\n    virCommandPtr cmd;\n\n    path = virFindFileInPath(SYSINFO_SMBIOS_DECODER);\n    if (path == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find path for %s binary\"),\n                       SYSINFO_SMBIOS_DECODER);\n        return NULL;\n    }\n\n    cmd = virCommandNewArgList(path, \"-q\", \"-t\", \"0,1,2,3,4,17\", NULL);\n    VIR_FREE(path);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->type = VIR_SYSINFO_SMBIOS;\n\n    if (virSysinfoParseBIOS(outbuf, &ret->bios) < 0)\n        goto error;\n\n    if (virSysinfoParseX86System(outbuf, &ret->system) < 0)\n        goto error;\n\n    if (virSysinfoParseX86BaseBoard(outbuf, &ret->baseBoard, &ret->nbaseBoard) < 0)\n        goto error;\n\n    if (virSysinfoParseX86Chassis(outbuf, &ret->chassis) < 0)\n        goto error;\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseX86Processor(outbuf, ret) < 0)\n        goto error;\n\n    ret->nmemory = 0;\n    ret->memory = NULL;\n    if (virSysinfoParseX86Memory(outbuf, ret) < 0)\n        goto error;\n\n cleanup:\n    VIR_FREE(outbuf);\n    virCommandFree(cmd);\n\n    return ret;\n\n error:\n    virSysinfoDefFree(ret);\n    ret = NULL;\n    goto cleanup;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SYSINFO_SMBIOS_DECODER sysinfoDmidecode"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoDefFree",
          "args": [
            "ret"
          ],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "144-191",
          "snippet": "void virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 1170
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "outbuf"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoParseX86Memory",
          "args": [
            "outbuf",
            "ret"
          ],
          "line": 1165
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseX86Memory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1023-1117",
          "snippet": "static int\nvirSysinfoParseX86Memory(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur, *tmp_base;\n    char *eol;\n    virSysinfoMemoryDefPtr memory;\n\n    while ((tmp_base = strstr(base, \"Memory Device\")) != NULL) {\n        base = tmp_base;\n        eol = NULL;\n\n        if (VIR_EXPAND_N(ret->memory, ret->nmemory, 1) < 0)\n            return -1;\n        memory = &ret->memory[ret->nmemory - 1];\n\n        if ((cur = strstr(base, \"Size: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            if (STREQLEN(cur, \"No Module Installed\", eol - cur))\n                goto next;\n\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_size = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Form Factor: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_form_factor = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Locator: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_locator = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Bank Locator: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_bank_locator = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Type: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_type = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Type Detail: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_type_detail = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Speed: \")) != NULL) {\n            cur += 7;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_speed = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_serial_number = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Part Number: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_part_number = g_strndup(cur, eol - cur);\n        }\n\n    next:\n        base += strlen(\"Memory Device\");\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86Memory(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur, *tmp_base;\n    char *eol;\n    virSysinfoMemoryDefPtr memory;\n\n    while ((tmp_base = strstr(base, \"Memory Device\")) != NULL) {\n        base = tmp_base;\n        eol = NULL;\n\n        if (VIR_EXPAND_N(ret->memory, ret->nmemory, 1) < 0)\n            return -1;\n        memory = &ret->memory[ret->nmemory - 1];\n\n        if ((cur = strstr(base, \"Size: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            if (STREQLEN(cur, \"No Module Installed\", eol - cur))\n                goto next;\n\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_size = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Form Factor: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_form_factor = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Locator: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_locator = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Bank Locator: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_bank_locator = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Type: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_type = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Type Detail: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_type_detail = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Speed: \")) != NULL) {\n            cur += 7;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_speed = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_serial_number = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Part Number: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_part_number = g_strndup(cur, eol - cur);\n        }\n\n    next:\n        base += strlen(\"Memory Device\");\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoParseX86Processor",
          "args": [
            "outbuf",
            "ret"
          ],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseX86Processor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "922-1021",
          "snippet": "static int\nvirSysinfoParseX86Processor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur, *tmp_base;\n    char *eol;\n    virSysinfoProcessorDefPtr processor;\n\n    while ((tmp_base = strstr(base, \"Processor Information\")) != NULL) {\n        base = tmp_base;\n        eol = NULL;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            return -1;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        if ((cur = strstr(base, \"Socket Designation: \")) != NULL) {\n            cur += 20;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_socket_destination = g_strndup(cur,\n                                                                    eol - cur);\n        }\n        if ((cur = strstr(base, \"Type: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_type = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Family: \")) != NULL) {\n            cur += 8;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_family = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Signature: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_signature = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Version: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_version = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"External Clock: \")) != NULL) {\n            cur += 16;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_external_clock = g_strndup(cur,\n                                                                eol - cur);\n        }\n        if ((cur = strstr(base, \"Max Speed: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_max_speed = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Status: \")) != NULL) {\n            cur += 8;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_status = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_serial_number = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Part Number: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_part_number = g_strndup(cur, eol - cur);\n        }\n\n        base += strlen(\"Processor Information\");\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86Processor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur, *tmp_base;\n    char *eol;\n    virSysinfoProcessorDefPtr processor;\n\n    while ((tmp_base = strstr(base, \"Processor Information\")) != NULL) {\n        base = tmp_base;\n        eol = NULL;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            return -1;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        if ((cur = strstr(base, \"Socket Designation: \")) != NULL) {\n            cur += 20;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_socket_destination = g_strndup(cur,\n                                                                    eol - cur);\n        }\n        if ((cur = strstr(base, \"Type: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_type = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Family: \")) != NULL) {\n            cur += 8;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_family = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Signature: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_signature = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Version: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_version = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"External Clock: \")) != NULL) {\n            cur += 16;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_external_clock = g_strndup(cur,\n                                                                eol - cur);\n        }\n        if ((cur = strstr(base, \"Max Speed: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_max_speed = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Status: \")) != NULL) {\n            cur += 8;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_status = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_serial_number = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Part Number: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_part_number = g_strndup(cur, eol - cur);\n        }\n\n        base += strlen(\"Processor Information\");\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoParseX86Chassis",
          "args": [
            "outbuf",
            "&ret->chassis"
          ],
          "line": 1155
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseX86Chassis",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "856-919",
          "snippet": "static int\nvirSysinfoParseX86Chassis(const char *base,\n                          virSysinfoChassisDefPtr *chassisdef)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoChassisDefPtr def;\n\n    if ((cur = strstr(base, \"Chassis Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->manufacturer = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Asset Tag: \")) != NULL) {\n        cur += 11;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->asset = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"SKU Number: \")) != NULL) {\n        cur += 12;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->sku = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->version &&\n        !def->serial && !def->asset && !def->sku) {\n        virSysinfoChassisDefFree(def);\n        def = NULL;\n    }\n\n    *chassisdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoChassisDefFree(def);\n    return ret;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86Chassis(const char *base,\n                          virSysinfoChassisDefPtr *chassisdef)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoChassisDefPtr def;\n\n    if ((cur = strstr(base, \"Chassis Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->manufacturer = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Asset Tag: \")) != NULL) {\n        cur += 11;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->asset = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"SKU Number: \")) != NULL) {\n        cur += 12;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->sku = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->version &&\n        !def->serial && !def->asset && !def->sku) {\n        virSysinfoChassisDefFree(def);\n        def = NULL;\n    }\n\n    *chassisdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoChassisDefFree(def);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoParseX86BaseBoard",
          "args": [
            "outbuf",
            "&ret->baseBoard",
            "&ret->nbaseBoard"
          ],
          "line": 1152
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseX86BaseBoard",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "766-853",
          "snippet": "static int\nvirSysinfoParseX86BaseBoard(const char *base,\n                            virSysinfoBaseBoardDefPtr *baseBoard,\n                            size_t *nbaseBoard)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoBaseBoardDefPtr boards = NULL;\n    size_t nboards = 0;\n    char *board_type = NULL;\n\n    while (base && (cur = strstr(base, \"Base Board Information\"))) {\n        virSysinfoBaseBoardDefPtr def;\n\n        if (VIR_EXPAND_N(boards, nboards, 1) < 0)\n            goto cleanup;\n\n        def = &boards[nboards - 1];\n\n        base = cur + 22;\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Product Name: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->product = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Version: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->version = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->serial = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Asset Tag: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->asset = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Location In Chassis: \")) != NULL) {\n            cur += 21;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->location = g_strndup(cur, eol - cur);\n        }\n\n        if (!def->manufacturer && !def->product && !def->version &&\n            !def->serial && !def->asset && !def->location)\n            nboards--;\n    }\n\n    if (nboards == 0) {\n        VIR_FREE(boards);\n    } else {\n        /* This is safe, as we can be only shrinking the memory */\n        ignore_value(VIR_REALLOC_N(boards, nboards));\n    }\n\n    *baseBoard = boards;\n    *nbaseBoard = nboards;\n    boards = NULL;\n    nboards = 0;\n    ret = 0;\n cleanup:\n    while (nboards--)\n        virSysinfoBaseBoardDefClear(&boards[nboards]);\n    VIR_FREE(boards);\n    VIR_FREE(board_type);\n    return ret;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86BaseBoard(const char *base,\n                            virSysinfoBaseBoardDefPtr *baseBoard,\n                            size_t *nbaseBoard)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoBaseBoardDefPtr boards = NULL;\n    size_t nboards = 0;\n    char *board_type = NULL;\n\n    while (base && (cur = strstr(base, \"Base Board Information\"))) {\n        virSysinfoBaseBoardDefPtr def;\n\n        if (VIR_EXPAND_N(boards, nboards, 1) < 0)\n            goto cleanup;\n\n        def = &boards[nboards - 1];\n\n        base = cur + 22;\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Product Name: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->product = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Version: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->version = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->serial = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Asset Tag: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->asset = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Location In Chassis: \")) != NULL) {\n            cur += 21;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->location = g_strndup(cur, eol - cur);\n        }\n\n        if (!def->manufacturer && !def->product && !def->version &&\n            !def->serial && !def->asset && !def->location)\n            nboards--;\n    }\n\n    if (nboards == 0) {\n        VIR_FREE(boards);\n    } else {\n        /* This is safe, as we can be only shrinking the memory */\n        ignore_value(VIR_REALLOC_N(boards, nboards));\n    }\n\n    *baseBoard = boards;\n    *nbaseBoard = nboards;\n    boards = NULL;\n    nboards = 0;\n    ret = 0;\n cleanup:\n    while (nboards--)\n        virSysinfoBaseBoardDefClear(&boards[nboards]);\n    VIR_FREE(boards);\n    VIR_FREE(board_type);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoParseX86System",
          "args": [
            "outbuf",
            "&ret->system"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseX86System",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "688-764",
          "snippet": "static int\nvirSysinfoParseX86System(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"System Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->manufacturer = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Product Name: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->product = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"UUID: \")) != NULL) {\n        cur += 6;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->uuid = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"SKU Number: \")) != NULL) {\n        cur += 12;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->sku = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Family: \")) != NULL) {\n        cur += 8;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->family = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86System(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"System Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->manufacturer = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Product Name: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->product = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"UUID: \")) != NULL) {\n        cur += 6;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->uuid = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"SKU Number: \")) != NULL) {\n        cur += 12;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->sku = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Family: \")) != NULL) {\n        cur += 8;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->family = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoParseBIOS",
          "args": [
            "outbuf",
            "&ret->bios"
          ],
          "line": 1146
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseBIOS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "631-686",
          "snippet": "static int\nvirSysinfoParseBIOS(const char *base, virSysinfoBIOSDefPtr *bios)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoBIOSDefPtr def;\n\n    if ((cur = strstr(base, \"BIOS Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Vendor: \")) != NULL) {\n        cur += 8;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->vendor = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Release Date: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->date = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"BIOS Revision: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->release = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->vendor && !def->version &&\n        !def->date && !def->release) {\n        virSysinfoBIOSDefFree(def);\n        def = NULL;\n    }\n\n    *bios = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoBIOSDefFree(def);\n    return ret;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseBIOS(const char *base, virSysinfoBIOSDefPtr *bios)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoBIOSDefPtr def;\n\n    if ((cur = strstr(base, \"BIOS Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Vendor: \")) != NULL) {\n        cur += 8;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->vendor = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Release Date: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->date = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"BIOS Revision: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->release = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->vendor && !def->version &&\n        !def->date && !def->release) {\n        virSysinfoBIOSDefFree(def);\n        def = NULL;\n    }\n\n    *bios = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoBIOSDefFree(def);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "&outbuf"
          ],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "path",
            "\"-q\"",
            "\"-t\"",
            "\"0,1,2,3,4,17\"",
            "NULL"
          ],
          "line": 1135
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to find path for %s binary\")",
            "SYSINFO_SMBIOS_DECODER"
          ],
          "line": 1129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to find path for %s binary\""
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFindFileInPath",
          "args": [
            "SYSINFO_SMBIOS_DECODER"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "virFindFileInPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1657-1709",
          "snippet": "char *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define SYSINFO_SMBIOS_DECODER sysinfoDmidecode\n\nvirSysinfoDefPtr\nvirSysinfoReadDMI(void)\n{\n    char *path;\n    virSysinfoDefPtr ret = NULL;\n    char *outbuf = NULL;\n    virCommandPtr cmd;\n\n    path = virFindFileInPath(SYSINFO_SMBIOS_DECODER);\n    if (path == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find path for %s binary\"),\n                       SYSINFO_SMBIOS_DECODER);\n        return NULL;\n    }\n\n    cmd = virCommandNewArgList(path, \"-q\", \"-t\", \"0,1,2,3,4,17\", NULL);\n    VIR_FREE(path);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->type = VIR_SYSINFO_SMBIOS;\n\n    if (virSysinfoParseBIOS(outbuf, &ret->bios) < 0)\n        goto error;\n\n    if (virSysinfoParseX86System(outbuf, &ret->system) < 0)\n        goto error;\n\n    if (virSysinfoParseX86BaseBoard(outbuf, &ret->baseBoard, &ret->nbaseBoard) < 0)\n        goto error;\n\n    if (virSysinfoParseX86Chassis(outbuf, &ret->chassis) < 0)\n        goto error;\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseX86Processor(outbuf, ret) < 0)\n        goto error;\n\n    ret->nmemory = 0;\n    ret->memory = NULL;\n    if (virSysinfoParseX86Memory(outbuf, ret) < 0)\n        goto error;\n\n cleanup:\n    VIR_FREE(outbuf);\n    virCommandFree(cmd);\n\n    return ret;\n\n error:\n    virSysinfoDefFree(ret);\n    ret = NULL;\n    goto cleanup;\n}"
  },
  {
    "function_name": "virSysinfoParseX86Memory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "1023-1117",
    "snippet": "static int\nvirSysinfoParseX86Memory(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur, *tmp_base;\n    char *eol;\n    virSysinfoMemoryDefPtr memory;\n\n    while ((tmp_base = strstr(base, \"Memory Device\")) != NULL) {\n        base = tmp_base;\n        eol = NULL;\n\n        if (VIR_EXPAND_N(ret->memory, ret->nmemory, 1) < 0)\n            return -1;\n        memory = &ret->memory[ret->nmemory - 1];\n\n        if ((cur = strstr(base, \"Size: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            if (STREQLEN(cur, \"No Module Installed\", eol - cur))\n                goto next;\n\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_size = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Form Factor: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_form_factor = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Locator: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_locator = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Bank Locator: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_bank_locator = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Type: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_type = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Type Detail: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_type_detail = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Speed: \")) != NULL) {\n            cur += 7;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_speed = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_serial_number = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Part Number: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_part_number = g_strndup(cur, eol - cur);\n        }\n\n    next:\n        base += strlen(\"Memory Device\");\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"Memory Device\""
          ],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpacesBackwards",
          "args": [
            "cur",
            "&eol"
          ],
          "line": 1107
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesBackwards",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "862-874",
          "snippet": "void\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Part Number: \""
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Serial Number: \""
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Manufacturer: \""
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Speed: \""
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Type Detail: \""
          ],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Type: \""
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Bank Locator: \""
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Locator: \""
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Form Factor: \""
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQLEN",
          "args": [
            "cur",
            "\"No Module Installed\"",
            "eol - cur"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Size: \""
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "ret->memory",
            "ret->nmemory",
            "1"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Memory Device\""
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86Memory(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur, *tmp_base;\n    char *eol;\n    virSysinfoMemoryDefPtr memory;\n\n    while ((tmp_base = strstr(base, \"Memory Device\")) != NULL) {\n        base = tmp_base;\n        eol = NULL;\n\n        if (VIR_EXPAND_N(ret->memory, ret->nmemory, 1) < 0)\n            return -1;\n        memory = &ret->memory[ret->nmemory - 1];\n\n        if ((cur = strstr(base, \"Size: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            if (STREQLEN(cur, \"No Module Installed\", eol - cur))\n                goto next;\n\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_size = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Form Factor: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_form_factor = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Locator: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_locator = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Bank Locator: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_bank_locator = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Type: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_type = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Type Detail: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_type_detail = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Speed: \")) != NULL) {\n            cur += 7;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_speed = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_serial_number = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Part Number: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                memory->memory_part_number = g_strndup(cur, eol - cur);\n        }\n\n    next:\n        base += strlen(\"Memory Device\");\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virSysinfoParseX86Processor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "922-1021",
    "snippet": "static int\nvirSysinfoParseX86Processor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur, *tmp_base;\n    char *eol;\n    virSysinfoProcessorDefPtr processor;\n\n    while ((tmp_base = strstr(base, \"Processor Information\")) != NULL) {\n        base = tmp_base;\n        eol = NULL;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            return -1;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        if ((cur = strstr(base, \"Socket Designation: \")) != NULL) {\n            cur += 20;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_socket_destination = g_strndup(cur,\n                                                                    eol - cur);\n        }\n        if ((cur = strstr(base, \"Type: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_type = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Family: \")) != NULL) {\n            cur += 8;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_family = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Signature: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_signature = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Version: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_version = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"External Clock: \")) != NULL) {\n            cur += 16;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_external_clock = g_strndup(cur,\n                                                                eol - cur);\n        }\n        if ((cur = strstr(base, \"Max Speed: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_max_speed = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Status: \")) != NULL) {\n            cur += 8;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_status = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_serial_number = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Part Number: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_part_number = g_strndup(cur, eol - cur);\n        }\n\n        base += strlen(\"Processor Information\");\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"Processor Information\""
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpacesBackwards",
          "args": [
            "cur",
            "&eol"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesBackwards",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "862-874",
          "snippet": "void\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Part Number: \""
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Serial Number: \""
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Status: \""
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Max Speed: \""
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"External Clock: \""
          ],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Version: \""
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Signature: \""
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Manufacturer: \""
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Family: \""
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Type: \""
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Socket Designation: \""
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "ret->processor",
            "ret->nprocessor",
            "1"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Processor Information\""
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86Processor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur, *tmp_base;\n    char *eol;\n    virSysinfoProcessorDefPtr processor;\n\n    while ((tmp_base = strstr(base, \"Processor Information\")) != NULL) {\n        base = tmp_base;\n        eol = NULL;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            return -1;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        if ((cur = strstr(base, \"Socket Designation: \")) != NULL) {\n            cur += 20;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_socket_destination = g_strndup(cur,\n                                                                    eol - cur);\n        }\n        if ((cur = strstr(base, \"Type: \")) != NULL) {\n            cur += 6;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_type = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Family: \")) != NULL) {\n            cur += 8;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_family = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Signature: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_signature = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Version: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_version = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"External Clock: \")) != NULL) {\n            cur += 16;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_external_clock = g_strndup(cur,\n                                                                eol - cur);\n        }\n        if ((cur = strstr(base, \"Max Speed: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_max_speed = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Status: \")) != NULL) {\n            cur += 8;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_status = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_serial_number = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Part Number: \")) != NULL) {\n            cur += 13;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                processor->processor_part_number = g_strndup(cur, eol - cur);\n        }\n\n        base += strlen(\"Processor Information\");\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virSysinfoParseX86Chassis",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "856-919",
    "snippet": "static int\nvirSysinfoParseX86Chassis(const char *base,\n                          virSysinfoChassisDefPtr *chassisdef)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoChassisDefPtr def;\n\n    if ((cur = strstr(base, \"Chassis Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->manufacturer = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Asset Tag: \")) != NULL) {\n        cur += 11;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->asset = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"SKU Number: \")) != NULL) {\n        cur += 12;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->sku = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->version &&\n        !def->serial && !def->asset && !def->sku) {\n        virSysinfoChassisDefFree(def);\n        def = NULL;\n    }\n\n    *chassisdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoChassisDefFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoChassisDefFree",
          "args": [
            "def"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoChassisDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "109-120",
          "snippet": "void virSysinfoChassisDefFree(virSysinfoChassisDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->sku);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoChassisDefFree(virSysinfoChassisDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->sku);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpacesBackwards",
          "args": [
            "cur",
            "&eol"
          ],
          "line": 903
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesBackwards",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "862-874",
          "snippet": "void\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"SKU Number: \""
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Asset Tag: \""
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Serial Number: \""
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Version: \""
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Manufacturer: \""
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Chassis Information\""
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86Chassis(const char *base,\n                          virSysinfoChassisDefPtr *chassisdef)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoChassisDefPtr def;\n\n    if ((cur = strstr(base, \"Chassis Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->manufacturer = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Asset Tag: \")) != NULL) {\n        cur += 11;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->asset = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"SKU Number: \")) != NULL) {\n        cur += 12;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->sku = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->version &&\n        !def->serial && !def->asset && !def->sku) {\n        virSysinfoChassisDefFree(def);\n        def = NULL;\n    }\n\n    *chassisdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoChassisDefFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "virSysinfoParseX86BaseBoard",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "766-853",
    "snippet": "static int\nvirSysinfoParseX86BaseBoard(const char *base,\n                            virSysinfoBaseBoardDefPtr *baseBoard,\n                            size_t *nbaseBoard)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoBaseBoardDefPtr boards = NULL;\n    size_t nboards = 0;\n    char *board_type = NULL;\n\n    while (base && (cur = strstr(base, \"Base Board Information\"))) {\n        virSysinfoBaseBoardDefPtr def;\n\n        if (VIR_EXPAND_N(boards, nboards, 1) < 0)\n            goto cleanup;\n\n        def = &boards[nboards - 1];\n\n        base = cur + 22;\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Product Name: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->product = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Version: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->version = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->serial = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Asset Tag: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->asset = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Location In Chassis: \")) != NULL) {\n            cur += 21;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->location = g_strndup(cur, eol - cur);\n        }\n\n        if (!def->manufacturer && !def->product && !def->version &&\n            !def->serial && !def->asset && !def->location)\n            nboards--;\n    }\n\n    if (nboards == 0) {\n        VIR_FREE(boards);\n    } else {\n        /* This is safe, as we can be only shrinking the memory */\n        ignore_value(VIR_REALLOC_N(boards, nboards));\n    }\n\n    *baseBoard = boards;\n    *nbaseBoard = nboards;\n    boards = NULL;\n    nboards = 0;\n    ret = 0;\n cleanup:\n    while (nboards--)\n        virSysinfoBaseBoardDefClear(&boards[nboards]);\n    VIR_FREE(boards);\n    VIR_FREE(board_type);\n    return ret;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "board_type"
          ],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "boards"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoBaseBoardDefClear",
          "args": [
            "&boards[nboards]"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoBaseBoardDefClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "95-106",
          "snippet": "void virSysinfoBaseBoardDefClear(virSysinfoBaseBoardDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->location);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoBaseBoardDefClear(virSysinfoBaseBoardDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->location);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_REALLOC_N(boards, nboards)"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "boards",
            "nboards"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "boards"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpacesBackwards",
          "args": [
            "cur",
            "&eol"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesBackwards",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "862-874",
          "snippet": "void\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Location In Chassis: \""
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Asset Tag: \""
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Serial Number: \""
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Version: \""
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Product Name: \""
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Manufacturer: \""
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "boards",
            "nboards",
            "1"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Base Board Information\""
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86BaseBoard(const char *base,\n                            virSysinfoBaseBoardDefPtr *baseBoard,\n                            size_t *nbaseBoard)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoBaseBoardDefPtr boards = NULL;\n    size_t nboards = 0;\n    char *board_type = NULL;\n\n    while (base && (cur = strstr(base, \"Base Board Information\"))) {\n        virSysinfoBaseBoardDefPtr def;\n\n        if (VIR_EXPAND_N(boards, nboards, 1) < 0)\n            goto cleanup;\n\n        def = &boards[nboards - 1];\n\n        base = cur + 22;\n        if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->manufacturer = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Product Name: \")) != NULL) {\n            cur += 14;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->product = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Version: \")) != NULL) {\n            cur += 9;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->version = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n            cur += 15;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->serial = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Asset Tag: \")) != NULL) {\n            cur += 11;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->asset = g_strndup(cur, eol - cur);\n        }\n        if ((cur = strstr(base, \"Location In Chassis: \")) != NULL) {\n            cur += 21;\n            eol = strchr(cur, '\\n');\n            virSkipSpacesBackwards(cur, &eol);\n            if (eol)\n                def->location = g_strndup(cur, eol - cur);\n        }\n\n        if (!def->manufacturer && !def->product && !def->version &&\n            !def->serial && !def->asset && !def->location)\n            nboards--;\n    }\n\n    if (nboards == 0) {\n        VIR_FREE(boards);\n    } else {\n        /* This is safe, as we can be only shrinking the memory */\n        ignore_value(VIR_REALLOC_N(boards, nboards));\n    }\n\n    *baseBoard = boards;\n    *nbaseBoard = nboards;\n    boards = NULL;\n    nboards = 0;\n    ret = 0;\n cleanup:\n    while (nboards--)\n        virSysinfoBaseBoardDefClear(&boards[nboards]);\n    VIR_FREE(boards);\n    VIR_FREE(board_type);\n    return ret;\n}"
  },
  {
    "function_name": "virSysinfoParseX86System",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "688-764",
    "snippet": "static int\nvirSysinfoParseX86System(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"System Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->manufacturer = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Product Name: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->product = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"UUID: \")) != NULL) {\n        cur += 6;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->uuid = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"SKU Number: \")) != NULL) {\n        cur += 12;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->sku = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Family: \")) != NULL) {\n        cur += 8;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->family = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoSystemDefFree",
          "args": [
            "def"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoSystemDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "80-93",
          "snippet": "void virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpacesBackwards",
          "args": [
            "cur",
            "&eol"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesBackwards",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "862-874",
          "snippet": "void\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Family: \""
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"SKU Number: \""
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"UUID: \""
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Serial Number: \""
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Version: \""
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Product Name: \""
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Manufacturer: \""
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"System Information\""
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseX86System(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"System Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Manufacturer: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->manufacturer = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Product Name: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->product = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Serial Number: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"UUID: \")) != NULL) {\n        cur += 6;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->uuid = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"SKU Number: \")) != NULL) {\n        cur += 12;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->sku = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Family: \")) != NULL) {\n        cur += 8;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->family = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "virSysinfoParseBIOS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "631-686",
    "snippet": "static int\nvirSysinfoParseBIOS(const char *base, virSysinfoBIOSDefPtr *bios)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoBIOSDefPtr def;\n\n    if ((cur = strstr(base, \"BIOS Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Vendor: \")) != NULL) {\n        cur += 8;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->vendor = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Release Date: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->date = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"BIOS Revision: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->release = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->vendor && !def->version &&\n        !def->date && !def->release) {\n        virSysinfoBIOSDefFree(def);\n        def = NULL;\n    }\n\n    *bios = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoBIOSDefFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoBIOSDefFree",
          "args": [
            "def"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoBIOSDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "68-78",
          "snippet": "void virSysinfoBIOSDefFree(virSysinfoBIOSDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->version);\n    VIR_FREE(def->date);\n    VIR_FREE(def->release);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoBIOSDefFree(virSysinfoBIOSDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->version);\n    VIR_FREE(def->date);\n    VIR_FREE(def->release);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpacesBackwards",
          "args": [
            "cur",
            "&eol"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesBackwards",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "862-874",
          "snippet": "void\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"BIOS Revision: \""
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Release Date: \""
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Version: \""
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Vendor: \""
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"BIOS Information\""
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseBIOS(const char *base, virSysinfoBIOSDefPtr *bios)\n{\n    int ret = -1;\n    const char *cur;\n    char *eol = NULL;\n    virSysinfoBIOSDefPtr def;\n\n    if ((cur = strstr(base, \"BIOS Information\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    if ((cur = strstr(base, \"Vendor: \")) != NULL) {\n        cur += 8;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->vendor = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Version: \")) != NULL) {\n        cur += 9;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"Release Date: \")) != NULL) {\n        cur += 14;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->date = g_strndup(cur, eol - cur);\n    }\n    if ((cur = strstr(base, \"BIOS Revision: \")) != NULL) {\n        cur += 15;\n        eol = strchr(cur, '\\n');\n        virSkipSpacesBackwards(cur, &eol);\n        if (eol)\n            def->release = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->vendor && !def->version &&\n        !def->date && !def->release) {\n        virSysinfoBIOSDefFree(def);\n        def = NULL;\n    }\n\n    *bios = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoBIOSDefFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "virSysinfoReadS390",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "595-628",
    "snippet": "virSysinfoDefPtr\nvirSysinfoReadS390(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    /* Gather info from /proc/cpuinfo */\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    if (virSysinfoParseS390Processor(outbuf, ret) < 0)\n        return NULL;\n\n    /* Free buffer before reading next file */\n    VIR_FREE(outbuf);\n\n    /* Gather info from /proc/sysinfo */\n    if (virFileReadAll(SYSINFO, 8192, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), SYSINFO);\n        return NULL;\n    }\n\n    if (virSysinfoParseS390System(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */",
      "#define CPUINFO sysinfoCpuinfo",
      "#define SYSINFO sysinfoSysinfo"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&ret"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoParseS390System",
          "args": [
            "outbuf",
            "&ret->system"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseS390System",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "490-520",
          "snippet": "static int\nvirSysinfoParseS390System(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    virSysinfoSystemDefPtr def;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    if (!virSysinfoParseS390Line(base, \"Manufacturer\", &def->manufacturer))\n        goto cleanup;\n\n    if (!virSysinfoParseS390Line(base, \"Type\", &def->family))\n        goto cleanup;\n\n    if (!virSysinfoParseS390Line(base, \"Sequence Code\", &def->serial))\n        goto cleanup;\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n cleanup:\n    virSysinfoSystemDefFree(def);\n    return ret;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseS390System(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    virSysinfoSystemDefPtr def;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    if (!virSysinfoParseS390Line(base, \"Manufacturer\", &def->manufacturer))\n        goto cleanup;\n\n    if (!virSysinfoParseS390Line(base, \"Type\", &def->family))\n        goto cleanup;\n\n    if (!virSysinfoParseS390Line(base, \"Sequence Code\", &def->serial))\n        goto cleanup;\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n cleanup:\n    virSysinfoSystemDefFree(def);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to open %s\")",
            "SYSINFO"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to open %s\""
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "SYSINFO",
            "8192",
            "&outbuf"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "outbuf"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoParseS390Processor",
          "args": [
            "outbuf",
            "ret"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseS390Processor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "522-591",
          "snippet": "static int\nvirSysinfoParseS390Processor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *tmp_base;\n    char *manufacturer = NULL;\n    char *procline = NULL;\n    char *ncpu = NULL;\n    int result = -1;\n    virSysinfoProcessorDefPtr processor;\n\n    if (!(tmp_base = virSysinfoParseS390Line(base, \"vendor_id\", &manufacturer)))\n        goto error;\n\n    /* Find processor N: line and gather the processor manufacturer,\n       version, serial number, and family */\n    while ((tmp_base = strstr(tmp_base, \"processor \"))\n           && (tmp_base = virSysinfoParseS390Line(tmp_base, \"processor \",\n                                                  &procline))) {\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            goto error;\n        processor = &ret->processor[ret->nprocessor - 1];\n        processor->processor_manufacturer = g_strdup(manufacturer);\n        if (!virSysinfoParseS390Delimited(procline, \"version\",\n                                          &processor->processor_version,\n                                          '=', ',') ||\n            !virSysinfoParseS390Delimited(procline, \"identification\",\n                                          &processor->processor_serial_number,\n                                          '=', ',') ||\n            !virSysinfoParseS390Delimited(procline, \"machine\",\n                                          &processor->processor_family,\n                                          '=', '\\n'))\n            goto error;\n\n        VIR_FREE(procline);\n    }\n\n    /* now, for each processor found, extract the frequency information */\n    tmp_base = base;\n\n    while ((tmp_base = strstr(tmp_base, \"cpu number\")) &&\n           (tmp_base = virSysinfoParseS390Line(tmp_base, \"cpu number\", &ncpu))) {\n        unsigned int n;\n        char *mhz = NULL;\n\n        if (virStrToLong_uip(ncpu, NULL, 10, &n) < 0)\n            goto error;\n\n        if (n >= ret->nprocessor) {\n            VIR_DEBUG(\"CPU number '%u' out of range\", n);\n            goto cleanup;\n        }\n\n        if (!(tmp_base = strstr(tmp_base, \"cpu MHz static\")) ||\n            !virSysinfoParseS390Line(tmp_base, \"cpu MHz static\", &mhz))\n            goto cleanup;\n\n        ret->processor[n].processor_max_speed = mhz;\n\n        VIR_FREE(ncpu);\n    }\n\n cleanup:\n    result = 0;\n\n error:\n    VIR_FREE(manufacturer);\n    VIR_FREE(procline);\n    VIR_FREE(ncpu);\n    return result;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseS390Processor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *tmp_base;\n    char *manufacturer = NULL;\n    char *procline = NULL;\n    char *ncpu = NULL;\n    int result = -1;\n    virSysinfoProcessorDefPtr processor;\n\n    if (!(tmp_base = virSysinfoParseS390Line(base, \"vendor_id\", &manufacturer)))\n        goto error;\n\n    /* Find processor N: line and gather the processor manufacturer,\n       version, serial number, and family */\n    while ((tmp_base = strstr(tmp_base, \"processor \"))\n           && (tmp_base = virSysinfoParseS390Line(tmp_base, \"processor \",\n                                                  &procline))) {\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            goto error;\n        processor = &ret->processor[ret->nprocessor - 1];\n        processor->processor_manufacturer = g_strdup(manufacturer);\n        if (!virSysinfoParseS390Delimited(procline, \"version\",\n                                          &processor->processor_version,\n                                          '=', ',') ||\n            !virSysinfoParseS390Delimited(procline, \"identification\",\n                                          &processor->processor_serial_number,\n                                          '=', ',') ||\n            !virSysinfoParseS390Delimited(procline, \"machine\",\n                                          &processor->processor_family,\n                                          '=', '\\n'))\n            goto error;\n\n        VIR_FREE(procline);\n    }\n\n    /* now, for each processor found, extract the frequency information */\n    tmp_base = base;\n\n    while ((tmp_base = strstr(tmp_base, \"cpu number\")) &&\n           (tmp_base = virSysinfoParseS390Line(tmp_base, \"cpu number\", &ncpu))) {\n        unsigned int n;\n        char *mhz = NULL;\n\n        if (virStrToLong_uip(ncpu, NULL, 10, &n) < 0)\n            goto error;\n\n        if (n >= ret->nprocessor) {\n            VIR_DEBUG(\"CPU number '%u' out of range\", n);\n            goto cleanup;\n        }\n\n        if (!(tmp_base = strstr(tmp_base, \"cpu MHz static\")) ||\n            !virSysinfoParseS390Line(tmp_base, \"cpu MHz static\", &mhz))\n            goto cleanup;\n\n        ret->processor[n].processor_max_speed = mhz;\n\n        VIR_FREE(ncpu);\n    }\n\n cleanup:\n    result = 0;\n\n error:\n    VIR_FREE(manufacturer);\n    VIR_FREE(procline);\n    VIR_FREE(ncpu);\n    return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to open %s\")",
            "CPUINFO"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */\n#define CPUINFO sysinfoCpuinfo\n#define SYSINFO sysinfoSysinfo\n\nvirSysinfoDefPtr\nvirSysinfoReadS390(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    /* Gather info from /proc/cpuinfo */\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    if (virSysinfoParseS390Processor(outbuf, ret) < 0)\n        return NULL;\n\n    /* Free buffer before reading next file */\n    VIR_FREE(outbuf);\n\n    /* Gather info from /proc/sysinfo */\n    if (virFileReadAll(SYSINFO, 8192, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), SYSINFO);\n        return NULL;\n    }\n\n    if (virSysinfoParseS390System(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
  },
  {
    "function_name": "virSysinfoParseS390Processor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "522-591",
    "snippet": "static int\nvirSysinfoParseS390Processor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *tmp_base;\n    char *manufacturer = NULL;\n    char *procline = NULL;\n    char *ncpu = NULL;\n    int result = -1;\n    virSysinfoProcessorDefPtr processor;\n\n    if (!(tmp_base = virSysinfoParseS390Line(base, \"vendor_id\", &manufacturer)))\n        goto error;\n\n    /* Find processor N: line and gather the processor manufacturer,\n       version, serial number, and family */\n    while ((tmp_base = strstr(tmp_base, \"processor \"))\n           && (tmp_base = virSysinfoParseS390Line(tmp_base, \"processor \",\n                                                  &procline))) {\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            goto error;\n        processor = &ret->processor[ret->nprocessor - 1];\n        processor->processor_manufacturer = g_strdup(manufacturer);\n        if (!virSysinfoParseS390Delimited(procline, \"version\",\n                                          &processor->processor_version,\n                                          '=', ',') ||\n            !virSysinfoParseS390Delimited(procline, \"identification\",\n                                          &processor->processor_serial_number,\n                                          '=', ',') ||\n            !virSysinfoParseS390Delimited(procline, \"machine\",\n                                          &processor->processor_family,\n                                          '=', '\\n'))\n            goto error;\n\n        VIR_FREE(procline);\n    }\n\n    /* now, for each processor found, extract the frequency information */\n    tmp_base = base;\n\n    while ((tmp_base = strstr(tmp_base, \"cpu number\")) &&\n           (tmp_base = virSysinfoParseS390Line(tmp_base, \"cpu number\", &ncpu))) {\n        unsigned int n;\n        char *mhz = NULL;\n\n        if (virStrToLong_uip(ncpu, NULL, 10, &n) < 0)\n            goto error;\n\n        if (n >= ret->nprocessor) {\n            VIR_DEBUG(\"CPU number '%u' out of range\", n);\n            goto cleanup;\n        }\n\n        if (!(tmp_base = strstr(tmp_base, \"cpu MHz static\")) ||\n            !virSysinfoParseS390Line(tmp_base, \"cpu MHz static\", &mhz))\n            goto cleanup;\n\n        ret->processor[n].processor_max_speed = mhz;\n\n        VIR_FREE(ncpu);\n    }\n\n cleanup:\n    result = 0;\n\n error:\n    VIR_FREE(manufacturer);\n    VIR_FREE(procline);\n    VIR_FREE(ncpu);\n    return result;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ncpu"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "procline"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "manufacturer"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ncpu"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoParseS390Line",
          "args": [
            "tmp_base",
            "\"cpu MHz static\"",
            "&mhz"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseS390Line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "484-488",
          "snippet": "static const char *\nvirSysinfoParseS390Line(const char *base, const char *name, char **value)\n{\n    return virSysinfoParseS390Delimited(base, name, value, ':', '\\n');\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic const char *\nvirSysinfoParseS390Line(const char *base, const char *name, char **value)\n{\n    return virSysinfoParseS390Delimited(base, name, value, ':', '\\n');\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "tmp_base",
            "\"cpu MHz static\""
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"CPU number '%u' out of range\"",
            "n"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "ncpu",
            "NULL",
            "10",
            "&n"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "tmp_base",
            "\"cpu number\""
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "procline"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoParseS390Delimited",
          "args": [
            "procline",
            "\"machine\"",
            "&processor->processor_family",
            "'='",
            "'\\n'"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseS390Delimited",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "462-482",
          "snippet": "static const char *\nvirSysinfoParseS390Delimited(const char *base, const char *name, char **value,\n                             char delim1, char delim2)\n{\n    const char *start;\n    const char *end;\n\n    if (delim1 != delim2 &&\n        (start = strstr(base, name)) &&\n        (start = strchr(start, delim1))) {\n        start += 1;\n        end = strchr(start, delim2);\n        if (!end)\n            end = start + strlen(start);\n        virSkipSpaces(&start);\n        *value = g_strndup(start, end - start);\n        virTrimSpaces(*value, NULL);\n        return end;\n    }\n    return NULL;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic const char *\nvirSysinfoParseS390Delimited(const char *base, const char *name, char **value,\n                             char delim1, char delim2)\n{\n    const char *start;\n    const char *end;\n\n    if (delim1 != delim2 &&\n        (start = strstr(base, name)) &&\n        (start = strchr(start, delim1))) {\n        start += 1;\n        end = strchr(start, delim2);\n        if (!end)\n            end = start + strlen(start);\n        virSkipSpaces(&start);\n        *value = g_strndup(start, end - start);\n        virTrimSpaces(*value, NULL);\n        return end;\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "manufacturer"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "ret->processor",
            "ret->nprocessor",
            "1"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "tmp_base",
            "\"processor \""
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseS390Processor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *tmp_base;\n    char *manufacturer = NULL;\n    char *procline = NULL;\n    char *ncpu = NULL;\n    int result = -1;\n    virSysinfoProcessorDefPtr processor;\n\n    if (!(tmp_base = virSysinfoParseS390Line(base, \"vendor_id\", &manufacturer)))\n        goto error;\n\n    /* Find processor N: line and gather the processor manufacturer,\n       version, serial number, and family */\n    while ((tmp_base = strstr(tmp_base, \"processor \"))\n           && (tmp_base = virSysinfoParseS390Line(tmp_base, \"processor \",\n                                                  &procline))) {\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            goto error;\n        processor = &ret->processor[ret->nprocessor - 1];\n        processor->processor_manufacturer = g_strdup(manufacturer);\n        if (!virSysinfoParseS390Delimited(procline, \"version\",\n                                          &processor->processor_version,\n                                          '=', ',') ||\n            !virSysinfoParseS390Delimited(procline, \"identification\",\n                                          &processor->processor_serial_number,\n                                          '=', ',') ||\n            !virSysinfoParseS390Delimited(procline, \"machine\",\n                                          &processor->processor_family,\n                                          '=', '\\n'))\n            goto error;\n\n        VIR_FREE(procline);\n    }\n\n    /* now, for each processor found, extract the frequency information */\n    tmp_base = base;\n\n    while ((tmp_base = strstr(tmp_base, \"cpu number\")) &&\n           (tmp_base = virSysinfoParseS390Line(tmp_base, \"cpu number\", &ncpu))) {\n        unsigned int n;\n        char *mhz = NULL;\n\n        if (virStrToLong_uip(ncpu, NULL, 10, &n) < 0)\n            goto error;\n\n        if (n >= ret->nprocessor) {\n            VIR_DEBUG(\"CPU number '%u' out of range\", n);\n            goto cleanup;\n        }\n\n        if (!(tmp_base = strstr(tmp_base, \"cpu MHz static\")) ||\n            !virSysinfoParseS390Line(tmp_base, \"cpu MHz static\", &mhz))\n            goto cleanup;\n\n        ret->processor[n].processor_max_speed = mhz;\n\n        VIR_FREE(ncpu);\n    }\n\n cleanup:\n    result = 0;\n\n error:\n    VIR_FREE(manufacturer);\n    VIR_FREE(procline);\n    VIR_FREE(ncpu);\n    return result;\n}"
  },
  {
    "function_name": "virSysinfoParseS390System",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "490-520",
    "snippet": "static int\nvirSysinfoParseS390System(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    virSysinfoSystemDefPtr def;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    if (!virSysinfoParseS390Line(base, \"Manufacturer\", &def->manufacturer))\n        goto cleanup;\n\n    if (!virSysinfoParseS390Line(base, \"Type\", &def->family))\n        goto cleanup;\n\n    if (!virSysinfoParseS390Line(base, \"Sequence Code\", &def->serial))\n        goto cleanup;\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n cleanup:\n    virSysinfoSystemDefFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoSystemDefFree",
          "args": [
            "def"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoSystemDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "80-93",
          "snippet": "void virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoParseS390Line",
          "args": [
            "base",
            "\"Sequence Code\"",
            "&def->serial"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseS390Line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "484-488",
          "snippet": "static const char *\nvirSysinfoParseS390Line(const char *base, const char *name, char **value)\n{\n    return virSysinfoParseS390Delimited(base, name, value, ':', '\\n');\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic const char *\nvirSysinfoParseS390Line(const char *base, const char *name, char **value)\n{\n    return virSysinfoParseS390Delimited(base, name, value, ':', '\\n');\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseS390System(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    virSysinfoSystemDefPtr def;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    if (!virSysinfoParseS390Line(base, \"Manufacturer\", &def->manufacturer))\n        goto cleanup;\n\n    if (!virSysinfoParseS390Line(base, \"Type\", &def->family))\n        goto cleanup;\n\n    if (!virSysinfoParseS390Line(base, \"Sequence Code\", &def->serial))\n        goto cleanup;\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n cleanup:\n    virSysinfoSystemDefFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "virSysinfoParseS390Line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "484-488",
    "snippet": "static const char *\nvirSysinfoParseS390Line(const char *base, const char *name, char **value)\n{\n    return virSysinfoParseS390Delimited(base, name, value, ':', '\\n');\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoParseS390Delimited",
          "args": [
            "base",
            "name",
            "value",
            "':'",
            "'\\n'"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseS390Delimited",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "462-482",
          "snippet": "static const char *\nvirSysinfoParseS390Delimited(const char *base, const char *name, char **value,\n                             char delim1, char delim2)\n{\n    const char *start;\n    const char *end;\n\n    if (delim1 != delim2 &&\n        (start = strstr(base, name)) &&\n        (start = strchr(start, delim1))) {\n        start += 1;\n        end = strchr(start, delim2);\n        if (!end)\n            end = start + strlen(start);\n        virSkipSpaces(&start);\n        *value = g_strndup(start, end - start);\n        virTrimSpaces(*value, NULL);\n        return end;\n    }\n    return NULL;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic const char *\nvirSysinfoParseS390Delimited(const char *base, const char *name, char **value,\n                             char delim1, char delim2)\n{\n    const char *start;\n    const char *end;\n\n    if (delim1 != delim2 &&\n        (start = strstr(base, name)) &&\n        (start = strchr(start, delim1))) {\n        start += 1;\n        end = strchr(start, delim2);\n        if (!end)\n            end = start + strlen(start);\n        virSkipSpaces(&start);\n        *value = g_strndup(start, end - start);\n        virTrimSpaces(*value, NULL);\n        return end;\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic const char *\nvirSysinfoParseS390Line(const char *base, const char *name, char **value)\n{\n    return virSysinfoParseS390Delimited(base, name, value, ':', '\\n');\n}"
  },
  {
    "function_name": "virSysinfoParseS390Delimited",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "462-482",
    "snippet": "static const char *\nvirSysinfoParseS390Delimited(const char *base, const char *name, char **value,\n                             char delim1, char delim2)\n{\n    const char *start;\n    const char *end;\n\n    if (delim1 != delim2 &&\n        (start = strstr(base, name)) &&\n        (start = strchr(start, delim1))) {\n        start += 1;\n        end = strchr(start, delim2);\n        if (!end)\n            end = start + strlen(start);\n        virSkipSpaces(&start);\n        *value = g_strndup(start, end - start);\n        virTrimSpaces(*value, NULL);\n        return end;\n    }\n    return NULL;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTrimSpaces",
          "args": [
            "*value",
            "NULL"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "virTrimSpaces",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "835-853",
          "snippet": "void\nvirTrimSpaces(char *str, char **endp)\n{\n    char *end;\n\n    if (!endp || !*endp)\n        end = str + strlen(str);\n    else\n        end = *endp;\n    while (end > str && g_ascii_isspace(end[-1]))\n        end--;\n    if (endp) {\n        if (!*endp)\n            *end = '\\0';\n        *endp = end;\n    } else {\n        *end = '\\0';\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirTrimSpaces(char *str, char **endp)\n{\n    char *end;\n\n    if (!endp || !*endp)\n        end = str + strlen(str);\n    else\n        end = *endp;\n    while (end > str && g_ascii_isspace(end[-1]))\n        end--;\n    if (endp) {\n        if (!*endp)\n            *end = '\\0';\n        *endp = end;\n    } else {\n        *end = '\\0';\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "start",
            "end - start"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&start"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "start"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "start",
            "delim2"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "start",
            "delim1"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "name"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic const char *\nvirSysinfoParseS390Delimited(const char *base, const char *name, char **value,\n                             char delim1, char delim2)\n{\n    const char *start;\n    const char *end;\n\n    if (delim1 != delim2 &&\n        (start = strstr(base, name)) &&\n        (start = strchr(start, delim1))) {\n        start += 1;\n        end = strchr(start, delim2);\n        if (!end)\n            end = start + strlen(start);\n        virSkipSpaces(&start);\n        *value = g_strndup(start, end - start);\n        virTrimSpaces(*value, NULL);\n        return end;\n    }\n    return NULL;\n}"
  },
  {
    "function_name": "virSysinfoReadARM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "426-460",
    "snippet": "virSysinfoDefPtr\nvirSysinfoReadARM(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    /* Some ARM systems have DMI tables available. */\n    if ((ret = virSysinfoReadDMI())) {\n        if (!virSysinfoDefIsEmpty(ret))\n            return g_steal_pointer(&ret);\n        virSysinfoDefFree(ret);\n    }\n\n    /* Well, we've tried. Fall back to parsing cpuinfo */\n    virResetLastError();\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseARMProcessor(outbuf, ret) < 0)\n        return NULL;\n\n    if (virSysinfoParseARMSystem(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */",
      "#define CPUINFO sysinfoCpuinfo"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&ret"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoParseARMSystem",
          "args": [
            "outbuf",
            "&ret->system"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseARMSystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "328-377",
          "snippet": "static int\nvirSysinfoParseARMSystem(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    char *eol = NULL;\n    const char *cur;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"platform\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    /* Account for format 'platform    : XXXX'*/\n    cur = strchr(cur, ':') + 1;\n    eol = strchr(cur, '\\n');\n    virSkipSpaces(&cur);\n    if (eol)\n        def->family = g_strndup(cur, eol - cur);\n\n    if ((cur = strstr(base, \"model\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n\n    if ((cur = strstr(base, \"machine\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseARMSystem(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    char *eol = NULL;\n    const char *cur;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"platform\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    /* Account for format 'platform    : XXXX'*/\n    cur = strchr(cur, ':') + 1;\n    eol = strchr(cur, '\\n');\n    virSkipSpaces(&cur);\n    if (eol)\n        def->family = g_strndup(cur, eol - cur);\n\n    if ((cur = strstr(base, \"model\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n\n    if ((cur = strstr(base, \"machine\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoParseARMProcessor",
          "args": [
            "outbuf",
            "ret"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParseARMProcessor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "379-422",
          "snippet": "static int\nvirSysinfoParseARMProcessor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur;\n    char *eol, *tmp_base;\n    virSysinfoProcessorDefPtr processor;\n    char *processor_type = NULL;\n\n    if (!(tmp_base = strstr(base, \"model name\")) &&\n        !(tmp_base = strstr(base, \"Processor\")))\n        return 0;\n\n    eol = strchr(tmp_base, '\\n');\n    cur = strchr(tmp_base, ':') + 1;\n    virSkipSpaces(&cur);\n    if (eol)\n        processor_type = g_strndup(cur, eol - cur);\n\n    while ((tmp_base = strstr(base, \"processor\")) != NULL) {\n        base = tmp_base;\n        eol = strchr(base, '\\n');\n        cur = strchr(base, ':') + 1;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            goto error;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        virSkipSpaces(&cur);\n        if (eol)\n            processor->processor_socket_destination = g_strndup(cur,\n                                                                eol - cur);\n\n        processor->processor_type = g_strdup(processor_type);\n\n        base = cur;\n    }\n\n    VIR_FREE(processor_type);\n    return 0;\n\n error:\n    VIR_FREE(processor_type);\n    return -1;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseARMProcessor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur;\n    char *eol, *tmp_base;\n    virSysinfoProcessorDefPtr processor;\n    char *processor_type = NULL;\n\n    if (!(tmp_base = strstr(base, \"model name\")) &&\n        !(tmp_base = strstr(base, \"Processor\")))\n        return 0;\n\n    eol = strchr(tmp_base, '\\n');\n    cur = strchr(tmp_base, ':') + 1;\n    virSkipSpaces(&cur);\n    if (eol)\n        processor_type = g_strndup(cur, eol - cur);\n\n    while ((tmp_base = strstr(base, \"processor\")) != NULL) {\n        base = tmp_base;\n        eol = strchr(base, '\\n');\n        cur = strchr(base, ':') + 1;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            goto error;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        virSkipSpaces(&cur);\n        if (eol)\n            processor->processor_socket_destination = g_strndup(cur,\n                                                                eol - cur);\n\n        processor->processor_type = g_strdup(processor_type);\n\n        base = cur;\n    }\n\n    VIR_FREE(processor_type);\n    return 0;\n\n error:\n    VIR_FREE(processor_type);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to open %s\")",
            "CPUINFO"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to open %s\""
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "CPUINFO",
            "CPUINFO_FILE_LEN",
            "&outbuf"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoDefFree",
          "args": [
            "ret"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "144-191",
          "snippet": "void virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&ret"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoDefIsEmpty",
          "args": [
            "ret"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoDefIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "194-200",
          "snippet": "static bool\nvirSysinfoDefIsEmpty(const virSysinfoDef *def)\n{\n    return !(def->bios || def->system || def->nbaseBoard > 0 ||\n             def->chassis || def->nprocessor > 0 ||\n             def->nmemory > 0 || def->oemStrings);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoDefIsEmpty(const virSysinfoDef *def)\n{\n    return !(def->bios || def->system || def->nbaseBoard > 0 ||\n             def->chassis || def->nprocessor > 0 ||\n             def->nmemory > 0 || def->oemStrings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoReadDMI",
          "args": [],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoReadDMI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1119-1178",
          "snippet": "virSysinfoDefPtr\nvirSysinfoReadDMI(void)\n{\n    char *path;\n    virSysinfoDefPtr ret = NULL;\n    char *outbuf = NULL;\n    virCommandPtr cmd;\n\n    path = virFindFileInPath(SYSINFO_SMBIOS_DECODER);\n    if (path == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find path for %s binary\"),\n                       SYSINFO_SMBIOS_DECODER);\n        return NULL;\n    }\n\n    cmd = virCommandNewArgList(path, \"-q\", \"-t\", \"0,1,2,3,4,17\", NULL);\n    VIR_FREE(path);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->type = VIR_SYSINFO_SMBIOS;\n\n    if (virSysinfoParseBIOS(outbuf, &ret->bios) < 0)\n        goto error;\n\n    if (virSysinfoParseX86System(outbuf, &ret->system) < 0)\n        goto error;\n\n    if (virSysinfoParseX86BaseBoard(outbuf, &ret->baseBoard, &ret->nbaseBoard) < 0)\n        goto error;\n\n    if (virSysinfoParseX86Chassis(outbuf, &ret->chassis) < 0)\n        goto error;\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseX86Processor(outbuf, ret) < 0)\n        goto error;\n\n    ret->nmemory = 0;\n    ret->memory = NULL;\n    if (virSysinfoParseX86Memory(outbuf, ret) < 0)\n        goto error;\n\n cleanup:\n    VIR_FREE(outbuf);\n    virCommandFree(cmd);\n\n    return ret;\n\n error:\n    virSysinfoDefFree(ret);\n    ret = NULL;\n    goto cleanup;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSINFO_SMBIOS_DECODER sysinfoDmidecode"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define SYSINFO_SMBIOS_DECODER sysinfoDmidecode\n\nvirSysinfoDefPtr\nvirSysinfoReadDMI(void)\n{\n    char *path;\n    virSysinfoDefPtr ret = NULL;\n    char *outbuf = NULL;\n    virCommandPtr cmd;\n\n    path = virFindFileInPath(SYSINFO_SMBIOS_DECODER);\n    if (path == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to find path for %s binary\"),\n                       SYSINFO_SMBIOS_DECODER);\n        return NULL;\n    }\n\n    cmd = virCommandNewArgList(path, \"-q\", \"-t\", \"0,1,2,3,4,17\", NULL);\n    VIR_FREE(path);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->type = VIR_SYSINFO_SMBIOS;\n\n    if (virSysinfoParseBIOS(outbuf, &ret->bios) < 0)\n        goto error;\n\n    if (virSysinfoParseX86System(outbuf, &ret->system) < 0)\n        goto error;\n\n    if (virSysinfoParseX86BaseBoard(outbuf, &ret->baseBoard, &ret->nbaseBoard) < 0)\n        goto error;\n\n    if (virSysinfoParseX86Chassis(outbuf, &ret->chassis) < 0)\n        goto error;\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseX86Processor(outbuf, ret) < 0)\n        goto error;\n\n    ret->nmemory = 0;\n    ret->memory = NULL;\n    if (virSysinfoParseX86Memory(outbuf, ret) < 0)\n        goto error;\n\n cleanup:\n    VIR_FREE(outbuf);\n    virCommandFree(cmd);\n\n    return ret;\n\n error:\n    virSysinfoDefFree(ret);\n    ret = NULL;\n    goto cleanup;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */\n#define CPUINFO sysinfoCpuinfo\n\nvirSysinfoDefPtr\nvirSysinfoReadARM(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    /* Some ARM systems have DMI tables available. */\n    if ((ret = virSysinfoReadDMI())) {\n        if (!virSysinfoDefIsEmpty(ret))\n            return g_steal_pointer(&ret);\n        virSysinfoDefFree(ret);\n    }\n\n    /* Well, we've tried. Fall back to parsing cpuinfo */\n    virResetLastError();\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParseARMProcessor(outbuf, ret) < 0)\n        return NULL;\n\n    if (virSysinfoParseARMSystem(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
  },
  {
    "function_name": "virSysinfoParseARMProcessor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "379-422",
    "snippet": "static int\nvirSysinfoParseARMProcessor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur;\n    char *eol, *tmp_base;\n    virSysinfoProcessorDefPtr processor;\n    char *processor_type = NULL;\n\n    if (!(tmp_base = strstr(base, \"model name\")) &&\n        !(tmp_base = strstr(base, \"Processor\")))\n        return 0;\n\n    eol = strchr(tmp_base, '\\n');\n    cur = strchr(tmp_base, ':') + 1;\n    virSkipSpaces(&cur);\n    if (eol)\n        processor_type = g_strndup(cur, eol - cur);\n\n    while ((tmp_base = strstr(base, \"processor\")) != NULL) {\n        base = tmp_base;\n        eol = strchr(base, '\\n');\n        cur = strchr(base, ':') + 1;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            goto error;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        virSkipSpaces(&cur);\n        if (eol)\n            processor->processor_socket_destination = g_strndup(cur,\n                                                                eol - cur);\n\n        processor->processor_type = g_strdup(processor_type);\n\n        base = cur;\n    }\n\n    VIR_FREE(processor_type);\n    return 0;\n\n error:\n    VIR_FREE(processor_type);\n    return -1;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "processor_type"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "processor_type"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "processor_type"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&cur"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "ret->processor",
            "ret->nprocessor",
            "1"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "base",
            "':'"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "base",
            "'\\n'"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"processor\""
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tmp_base",
            "':'"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tmp_base",
            "'\\n'"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"Processor\""
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"model name\""
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseARMProcessor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur;\n    char *eol, *tmp_base;\n    virSysinfoProcessorDefPtr processor;\n    char *processor_type = NULL;\n\n    if (!(tmp_base = strstr(base, \"model name\")) &&\n        !(tmp_base = strstr(base, \"Processor\")))\n        return 0;\n\n    eol = strchr(tmp_base, '\\n');\n    cur = strchr(tmp_base, ':') + 1;\n    virSkipSpaces(&cur);\n    if (eol)\n        processor_type = g_strndup(cur, eol - cur);\n\n    while ((tmp_base = strstr(base, \"processor\")) != NULL) {\n        base = tmp_base;\n        eol = strchr(base, '\\n');\n        cur = strchr(base, ':') + 1;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            goto error;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        virSkipSpaces(&cur);\n        if (eol)\n            processor->processor_socket_destination = g_strndup(cur,\n                                                                eol - cur);\n\n        processor->processor_type = g_strdup(processor_type);\n\n        base = cur;\n    }\n\n    VIR_FREE(processor_type);\n    return 0;\n\n error:\n    VIR_FREE(processor_type);\n    return -1;\n}"
  },
  {
    "function_name": "virSysinfoParseARMSystem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "328-377",
    "snippet": "static int\nvirSysinfoParseARMSystem(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    char *eol = NULL;\n    const char *cur;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"platform\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    /* Account for format 'platform    : XXXX'*/\n    cur = strchr(cur, ':') + 1;\n    eol = strchr(cur, '\\n');\n    virSkipSpaces(&cur);\n    if (eol)\n        def->family = g_strndup(cur, eol - cur);\n\n    if ((cur = strstr(base, \"model\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n\n    if ((cur = strstr(base, \"machine\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoSystemDefFree",
          "args": [
            "def"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoSystemDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "80-93",
          "snippet": "void virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&cur"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "':'"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"machine\""
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "':'"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"model\""
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "':'"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"platform\""
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParseARMSystem(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    char *eol = NULL;\n    const char *cur;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"platform\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    /* Account for format 'platform    : XXXX'*/\n    cur = strchr(cur, ':') + 1;\n    eol = strchr(cur, '\\n');\n    virSkipSpaces(&cur);\n    if (eol)\n        def->family = g_strndup(cur, eol - cur);\n\n    if ((cur = strstr(base, \"model\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n\n    if ((cur = strstr(base, \"machine\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "virSysinfoReadPPC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "301-325",
    "snippet": "virSysinfoDefPtr\nvirSysinfoReadPPC(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParsePPCProcessor(outbuf, ret) < 0)\n        return NULL;\n\n    if (virSysinfoParsePPCSystem(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */",
      "#define CPUINFO sysinfoCpuinfo"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&ret"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoParsePPCSystem",
          "args": [
            "outbuf",
            "&ret->system"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParsePPCSystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "203-252",
          "snippet": "static int\nvirSysinfoParsePPCSystem(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    char *eol = NULL;\n    const char *cur;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"platform\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    /* Account for format 'platform    : XXXX'*/\n    cur = strchr(cur, ':') + 1;\n    eol = strchr(cur, '\\n');\n    virSkipSpaces(&cur);\n    if (eol)\n        def->family = g_strndup(cur, eol - cur);\n\n    if ((cur = strstr(base, \"model\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n\n    if ((cur = strstr(base, \"machine\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParsePPCSystem(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    char *eol = NULL;\n    const char *cur;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"platform\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    /* Account for format 'platform    : XXXX'*/\n    cur = strchr(cur, ':') + 1;\n    eol = strchr(cur, '\\n');\n    virSkipSpaces(&cur);\n    if (eol)\n        def->family = g_strndup(cur, eol - cur);\n\n    if ((cur = strstr(base, \"model\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n\n    if ((cur = strstr(base, \"machine\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoParsePPCProcessor",
          "args": [
            "outbuf",
            "ret"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoParsePPCProcessor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "254-297",
          "snippet": "static int\nvirSysinfoParsePPCProcessor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur;\n    char *eol, *tmp_base;\n    virSysinfoProcessorDefPtr processor;\n\n    while ((tmp_base = strstr(base, \"processor\")) != NULL) {\n        base = tmp_base;\n        eol = strchr(base, '\\n');\n        cur = strchr(base, ':') + 1;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            return -1;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        virSkipSpaces(&cur);\n        if (eol)\n            processor->processor_socket_destination = g_strndup(cur,\n                                                                eol - cur);\n        base = cur;\n\n        if ((cur = strstr(base, \"cpu\")) != NULL) {\n            cur = strchr(cur, ':') + 1;\n            eol = strchr(cur, '\\n');\n            virSkipSpaces(&cur);\n            if (eol)\n                processor->processor_type = g_strndup(cur, eol - cur);\n            base = cur;\n        }\n\n        if ((cur = strstr(base, \"revision\")) != NULL) {\n            cur = strchr(cur, ':') + 1;\n            eol = strchr(cur, '\\n');\n            virSkipSpaces(&cur);\n            if (eol)\n                processor->processor_version = g_strndup(cur, eol - cur);\n            base = cur;\n        }\n\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParsePPCProcessor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur;\n    char *eol, *tmp_base;\n    virSysinfoProcessorDefPtr processor;\n\n    while ((tmp_base = strstr(base, \"processor\")) != NULL) {\n        base = tmp_base;\n        eol = strchr(base, '\\n');\n        cur = strchr(base, ':') + 1;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            return -1;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        virSkipSpaces(&cur);\n        if (eol)\n            processor->processor_socket_destination = g_strndup(cur,\n                                                                eol - cur);\n        base = cur;\n\n        if ((cur = strstr(base, \"cpu\")) != NULL) {\n            cur = strchr(cur, ':') + 1;\n            eol = strchr(cur, '\\n');\n            virSkipSpaces(&cur);\n            if (eol)\n                processor->processor_type = g_strndup(cur, eol - cur);\n            base = cur;\n        }\n\n        if ((cur = strstr(base, \"revision\")) != NULL) {\n            cur = strchr(cur, ':') + 1;\n            eol = strchr(cur, '\\n');\n            virSkipSpaces(&cur);\n            if (eol)\n                processor->processor_version = g_strndup(cur, eol - cur);\n            base = cur;\n        }\n\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to open %s\")",
            "CPUINFO"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to open %s\""
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "CPUINFO",
            "CPUINFO_FILE_LEN",
            "&outbuf"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define CPUINFO_FILE_LEN (1024*1024)    /* 1MB limit for /proc/cpuinfo file */\n#define CPUINFO sysinfoCpuinfo\n\nvirSysinfoDefPtr\nvirSysinfoReadPPC(void)\n{\n    g_auto(virSysinfoDefPtr) ret = NULL;\n    g_autofree char *outbuf = NULL;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (virFileReadAll(CPUINFO, CPUINFO_FILE_LEN, &outbuf) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to open %s\"), CPUINFO);\n        return NULL;\n    }\n\n    ret->nprocessor = 0;\n    ret->processor = NULL;\n    if (virSysinfoParsePPCProcessor(outbuf, ret) < 0)\n        return NULL;\n\n    if (virSysinfoParsePPCSystem(outbuf, &ret->system) < 0)\n        return NULL;\n\n    return g_steal_pointer(&ret);\n}"
  },
  {
    "function_name": "virSysinfoParsePPCProcessor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "254-297",
    "snippet": "static int\nvirSysinfoParsePPCProcessor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur;\n    char *eol, *tmp_base;\n    virSysinfoProcessorDefPtr processor;\n\n    while ((tmp_base = strstr(base, \"processor\")) != NULL) {\n        base = tmp_base;\n        eol = strchr(base, '\\n');\n        cur = strchr(base, ':') + 1;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            return -1;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        virSkipSpaces(&cur);\n        if (eol)\n            processor->processor_socket_destination = g_strndup(cur,\n                                                                eol - cur);\n        base = cur;\n\n        if ((cur = strstr(base, \"cpu\")) != NULL) {\n            cur = strchr(cur, ':') + 1;\n            eol = strchr(cur, '\\n');\n            virSkipSpaces(&cur);\n            if (eol)\n                processor->processor_type = g_strndup(cur, eol - cur);\n            base = cur;\n        }\n\n        if ((cur = strstr(base, \"revision\")) != NULL) {\n            cur = strchr(cur, ':') + 1;\n            eol = strchr(cur, '\\n');\n            virSkipSpaces(&cur);\n            if (eol)\n                processor->processor_version = g_strndup(cur, eol - cur);\n            base = cur;\n        }\n\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&cur"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "':'"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"revision\""
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "':'"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"cpu\""
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "ret->processor",
            "ret->nprocessor",
            "1"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "base",
            "':'"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "base",
            "'\\n'"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"processor\""
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParsePPCProcessor(const char *base, virSysinfoDefPtr ret)\n{\n    const char *cur;\n    char *eol, *tmp_base;\n    virSysinfoProcessorDefPtr processor;\n\n    while ((tmp_base = strstr(base, \"processor\")) != NULL) {\n        base = tmp_base;\n        eol = strchr(base, '\\n');\n        cur = strchr(base, ':') + 1;\n\n        if (VIR_EXPAND_N(ret->processor, ret->nprocessor, 1) < 0)\n            return -1;\n        processor = &ret->processor[ret->nprocessor - 1];\n\n        virSkipSpaces(&cur);\n        if (eol)\n            processor->processor_socket_destination = g_strndup(cur,\n                                                                eol - cur);\n        base = cur;\n\n        if ((cur = strstr(base, \"cpu\")) != NULL) {\n            cur = strchr(cur, ':') + 1;\n            eol = strchr(cur, '\\n');\n            virSkipSpaces(&cur);\n            if (eol)\n                processor->processor_type = g_strndup(cur, eol - cur);\n            base = cur;\n        }\n\n        if ((cur = strstr(base, \"revision\")) != NULL) {\n            cur = strchr(cur, ':') + 1;\n            eol = strchr(cur, '\\n');\n            virSkipSpaces(&cur);\n            if (eol)\n                processor->processor_version = g_strndup(cur, eol - cur);\n            base = cur;\n        }\n\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virSysinfoParsePPCSystem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "203-252",
    "snippet": "static int\nvirSysinfoParsePPCSystem(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    char *eol = NULL;\n    const char *cur;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"platform\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    /* Account for format 'platform    : XXXX'*/\n    cur = strchr(cur, ':') + 1;\n    eol = strchr(cur, '\\n');\n    virSkipSpaces(&cur);\n    if (eol)\n        def->family = g_strndup(cur, eol - cur);\n\n    if ((cur = strstr(base, \"model\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n\n    if ((cur = strstr(base, \"machine\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSysinfoSystemDefFree",
          "args": [
            "def"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoSystemDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "80-93",
          "snippet": "void virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&cur"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "':'"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"machine\""
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "':'"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"model\""
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "cur",
            "eol - cur"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "':'"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "base",
            "\"platform\""
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirSysinfoParsePPCSystem(const char *base, virSysinfoSystemDefPtr *sysdef)\n{\n    int ret = -1;\n    char *eol = NULL;\n    const char *cur;\n    virSysinfoSystemDefPtr def;\n\n    if ((cur = strstr(base, \"platform\")) == NULL)\n        return 0;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    base = cur;\n    /* Account for format 'platform    : XXXX'*/\n    cur = strchr(cur, ':') + 1;\n    eol = strchr(cur, '\\n');\n    virSkipSpaces(&cur);\n    if (eol)\n        def->family = g_strndup(cur, eol - cur);\n\n    if ((cur = strstr(base, \"model\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->serial = g_strndup(cur, eol - cur);\n    }\n\n    if ((cur = strstr(base, \"machine\")) != NULL) {\n        cur = strchr(cur, ':') + 1;\n        eol = strchr(cur, '\\n');\n        virSkipSpaces(&cur);\n        if (eol)\n            def->version = g_strndup(cur, eol - cur);\n    }\n\n    if (!def->manufacturer && !def->product && !def->version &&\n        !def->serial && !def->uuid && !def->sku && !def->family) {\n        virSysinfoSystemDefFree(def);\n        def = NULL;\n    }\n\n    *sysdef = def;\n    def = NULL;\n    ret = 0;\n    virSysinfoSystemDefFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "virSysinfoDefIsEmpty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "194-200",
    "snippet": "static bool\nvirSysinfoDefIsEmpty(const virSysinfoDef *def)\n{\n    return !(def->bios || def->system || def->nbaseBoard > 0 ||\n             def->chassis || def->nprocessor > 0 ||\n             def->nmemory > 0 || def->oemStrings);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirSysinfoDefIsEmpty(const virSysinfoDef *def)\n{\n    return !(def->bios || def->system || def->nbaseBoard > 0 ||\n             def->chassis || def->nprocessor > 0 ||\n             def->nmemory > 0 || def->oemStrings);\n}"
  },
  {
    "function_name": "virSysinfoDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "144-191",
    "snippet": "void virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoOEMStringsDefFree",
          "args": [
            "def->oemStrings"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoOEMStringsDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "123-135",
          "snippet": "void virSysinfoOEMStringsDefFree(virSysinfoOEMStringsDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    for (i = 0; i < def->nvalues; i++)\n        VIR_FREE(def->values[i]);\n    VIR_FREE(def->values);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoOEMStringsDefFree(virSysinfoOEMStringsDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    for (i = 0; i < def->nvalues; i++)\n        VIR_FREE(def->values[i]);\n    VIR_FREE(def->values);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_part_number"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_serial_number"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_manufacturer"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_speed"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_type_detail"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_type"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_bank_locator"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_locator"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_form_factor"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->memory[i].memory_size"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_part_number"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_serial_number"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_status"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_max_speed"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_external_clock"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_version"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_signature"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_manufacturer"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_family"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_type"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->processor[i].processor_socket_destination"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoChassisDefFree",
          "args": [
            "def->chassis"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoChassisDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "109-120",
          "snippet": "void virSysinfoChassisDefFree(virSysinfoChassisDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->sku);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoChassisDefFree(virSysinfoChassisDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->sku);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->baseBoard"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSysinfoBaseBoardDefClear",
          "args": [
            "def->baseBoard + i"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoBaseBoardDefClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "95-106",
          "snippet": "void virSysinfoBaseBoardDefClear(virSysinfoBaseBoardDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->location);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoBaseBoardDefClear(virSysinfoBaseBoardDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->location);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoSystemDefFree",
          "args": [
            "def->system"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoSystemDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "80-93",
          "snippet": "void virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoBIOSDefFree",
          "args": [
            "def->bios"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoBIOSDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "68-78",
          "snippet": "void virSysinfoBIOSDefFree(virSysinfoBIOSDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->version);\n    VIR_FREE(def->date);\n    VIR_FREE(def->release);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoBIOSDefFree(virSysinfoBIOSDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->version);\n    VIR_FREE(def->date);\n    VIR_FREE(def->release);\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virSysinfoOEMStringsDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "123-135",
    "snippet": "void virSysinfoOEMStringsDefFree(virSysinfoOEMStringsDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    for (i = 0; i < def->nvalues; i++)\n        VIR_FREE(def->values[i]);\n    VIR_FREE(def->values);\n\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->values"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->values[i]"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoOEMStringsDefFree(virSysinfoOEMStringsDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    for (i = 0; i < def->nvalues; i++)\n        VIR_FREE(def->values[i]);\n    VIR_FREE(def->values);\n\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virSysinfoChassisDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "109-120",
    "snippet": "void virSysinfoChassisDefFree(virSysinfoChassisDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->sku);\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->sku"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->asset"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->serial"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->version"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->manufacturer"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoChassisDefFree(virSysinfoChassisDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->sku);\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virSysinfoBaseBoardDefClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "95-106",
    "snippet": "void virSysinfoBaseBoardDefClear(virSysinfoBaseBoardDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->location);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->location"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->asset"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->serial"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->version"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->product"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->manufacturer"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoBaseBoardDefClear(virSysinfoBaseBoardDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->asset);\n    VIR_FREE(def->location);\n}"
  },
  {
    "function_name": "virSysinfoSystemDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "80-93",
    "snippet": "void virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->family"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->sku"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->uuid"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->serial"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->version"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->product"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->manufacturer"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoSystemDefFree(virSysinfoSystemDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->manufacturer);\n    VIR_FREE(def->product);\n    VIR_FREE(def->version);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->uuid);\n    VIR_FREE(def->sku);\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virSysinfoBIOSDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "68-78",
    "snippet": "void virSysinfoBIOSDefFree(virSysinfoBIOSDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->version);\n    VIR_FREE(def->date);\n    VIR_FREE(def->release);\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->release"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->date"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->version"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->vendor"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoBIOSDefFree(virSysinfoBIOSDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->version);\n    VIR_FREE(def->date);\n    VIR_FREE(def->release);\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virSysinfoSetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
    "lines": "58-66",
    "snippet": "void\nvirSysinfoSetup(const char *dmidecode,\n                const char *sysinfo,\n                const char *cpuinfo)\n{\n    sysinfoDmidecode = dmidecode;\n    sysinfoSysinfo = sysinfo;\n    sysinfoCpuinfo = cpuinfo;\n}",
    "includes": [
      "#include \"virsysinfopriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsysinfo.h\"",
      "#include \"virerror.h\"",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *sysinfoDmidecode = DMIDECODE;",
      "static const char *sysinfoSysinfo = \"/proc/sysinfo\";",
      "static const char *sysinfoCpuinfo = \"/proc/cpuinfo\";"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic const char *sysinfoDmidecode = DMIDECODE;\nstatic const char *sysinfoSysinfo = \"/proc/sysinfo\";\nstatic const char *sysinfoCpuinfo = \"/proc/cpuinfo\";\n\nvoid\nvirSysinfoSetup(const char *dmidecode,\n                const char *sysinfo,\n                const char *cpuinfo)\n{\n    sysinfoDmidecode = dmidecode;\n    sysinfoSysinfo = sysinfo;\n    sysinfoCpuinfo = cpuinfo;\n}"
  }
]