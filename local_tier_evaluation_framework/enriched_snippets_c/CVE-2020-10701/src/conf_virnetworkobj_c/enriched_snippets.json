[
  {
    "function_name": "virNetworkObjLoadAllPorts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1868-1913",
    "snippet": "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir)\n{\n    g_autofree char *dir = NULL;\n    DIR *dh = NULL;\n    struct dirent *de;\n    int ret = -1;\n    int rc;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autoptr(virNetworkPortDef) portdef = NULL;\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        goto cleanup;\n\n    if ((rc = virDirOpenIfExists(&dh, dir)) <= 0) {\n        ret = rc;\n        goto cleanup;\n    }\n\n    while ((rc = virDirRead(dh, &de, dir)) > 0) {\n        g_autofree char *file = NULL;\n\n        if (!virStringStripSuffix(de->d_name, \".xml\"))\n            continue;\n\n        file = g_strdup_printf(\"%s/%s.xml\", dir, de->d_name);\n\n        portdef = virNetworkPortDefParseFile(file);\n        if (!portdef) {\n            VIR_WARN(\"Cannot parse port %s\", file);\n            continue;\n        }\n\n        virUUIDFormat(portdef->uuid, uuidstr);\n        if (virHashAddEntry(net->ports, uuidstr, portdef) < 0)\n            goto cleanup;\n\n        portdef = NULL;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dh"
          ],
          "line": 1911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "net->ports",
            "uuidstr",
            "portdef"
          ],
          "line": 1903
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "portdef->uuid",
            "uuidstr"
          ],
          "line": 1902
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Cannot parse port %s\"",
            "file"
          ],
          "line": 1898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkPortDefParseFile",
          "args": [
            "file"
          ],
          "line": 1896
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkPortDefParseFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkportdef.c",
          "lines": "317-321",
          "snippet": "virNetworkPortDefPtr\nvirNetworkPortDefParseFile(const char *filename)\n{\n    return virNetworkPortDefParse(NULL, filename);\n}",
          "includes": [
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_vport_profile_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"network_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNetworkPortDefPtr\nvirNetworkPortDefParseFile(const char *filename)\n{\n    return virNetworkPortDefParse(NULL, filename);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s.xml\"",
            "dir",
            "de->d_name"
          ],
          "line": 1894
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringStripSuffix",
          "args": [
            "de->d_name",
            "\".xml\""
          ],
          "line": 1891
        },
        "resolved": true,
        "details": {
          "function_name": "virStringStripSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1123-1139",
          "snippet": "bool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dh",
            "&de",
            "dir"
          ],
          "line": 1888
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dh",
            "dir"
          ],
          "line": 1883
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjGetPortStatusDir",
          "args": [
            "net",
            "stateDir"
          ],
          "line": 1880
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjGetPortStatusDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "1619-1626",
          "snippet": "char *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nchar *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir)\n{\n    g_autofree char *dir = NULL;\n    DIR *dh = NULL;\n    struct dirent *de;\n    int ret = -1;\n    int rc;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autoptr(virNetworkPortDef) portdef = NULL;\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        goto cleanup;\n\n    if ((rc = virDirOpenIfExists(&dh, dir)) <= 0) {\n        ret = rc;\n        goto cleanup;\n    }\n\n    while ((rc = virDirRead(dh, &de, dir)) > 0) {\n        g_autofree char *file = NULL;\n\n        if (!virStringStripSuffix(de->d_name, \".xml\"))\n            continue;\n\n        file = g_strdup_printf(\"%s/%s.xml\", dir, de->d_name);\n\n        portdef = virNetworkPortDefParseFile(file);\n        if (!portdef) {\n            VIR_WARN(\"Cannot parse port %s\", file);\n            continue;\n        }\n\n        virUUIDFormat(portdef->uuid, uuidstr);\n        if (virHashAddEntry(net->ports, uuidstr, portdef) < 0)\n            goto cleanup;\n\n        portdef = NULL;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjPortForEach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1855-1865",
    "snippet": "int\nvirNetworkObjPortForEach(virNetworkObjPtr obj,\n                         virNetworkPortListIter iter,\n                         void *opaque)\n{\n    virNetworkObjPortListForEachData data = { iter, opaque, false };\n    virHashForEach(obj->ports, virNetworkObjPortForEachCallback, &data);\n    if (data.err)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "obj->ports",
            "virNetworkObjPortForEachCallback",
            "&data"
          ],
          "line": 1861
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjPortForEach(virNetworkObjPtr obj,\n                         virNetworkPortListIter iter,\n                         void *opaque)\n{\n    virNetworkObjPortListForEachData data = { iter, opaque, false };\n    virHashForEach(obj->ports, virNetworkObjPortForEachCallback, &data);\n    if (data.err)\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjPortForEachCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1842-1853",
    "snippet": "static int\nvirNetworkObjPortForEachCallback(void *payload,\n                                 const void *name G_GNUC_UNUSED,\n                                 void *opaque)\n{\n    virNetworkObjPortListForEachData *data = opaque;\n\n    if (!data->iter(payload, data->opaque))\n        data->err = true;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data->iter",
          "args": [
            "payload",
            "data->opaque"
          ],
          "line": 1849
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjPortForEachCallback(void *payload,\n                                 const void *name G_GNUC_UNUSED,\n                                 void *opaque)\n{\n    virNetworkObjPortListForEachData *data = opaque;\n\n    if (!data->iter(payload, data->opaque))\n        data->err = true;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjPortListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1795-1832",
    "snippet": "int\nvirNetworkObjPortListExport(virNetworkPtr net,\n                            virNetworkObjPtr obj,\n                            virNetworkPortPtr **ports,\n                            virNetworkPortListFilter filter)\n{\n    virNetworkObjPortListExportData data = {\n        net, obj->def, NULL, filter, 0, false,\n    };\n    int ret = -1;\n\n    if (ports) {\n        *ports = NULL;\n\n        if (VIR_ALLOC_N(data.ports, virHashSize(obj->ports) + 1) < 0)\n            goto cleanup;\n    }\n\n    virHashForEach(obj->ports, virNetworkObjPortListExportCallback, &data);\n\n    if (data.error)\n        goto cleanup;\n\n    if (data.ports) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.ports, data.nports + 1));\n        *ports = data.ports;\n        data.ports = NULL;\n    }\n\n    ret = data.nports;\n cleanup:\n    while (data.ports && data.nports)\n        virObjectUnref(data.ports[--data.nports]);\n\n    VIR_FREE(data.ports);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.ports"
          ],
          "line": 1830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "data.ports[--data.nports]"
          ],
          "line": 1828
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_REALLOC_N(data.ports, data.nports + 1)"
          ],
          "line": 1820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "data.ports",
            "data.nports + 1"
          ],
          "line": 1820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "obj->ports",
            "virNetworkObjPortListExportCallback",
            "&data"
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "data.ports",
            "virHashSize(obj->ports) + 1"
          ],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "obj->ports"
          ],
          "line": 1809
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjPortListExport(virNetworkPtr net,\n                            virNetworkObjPtr obj,\n                            virNetworkPortPtr **ports,\n                            virNetworkPortListFilter filter)\n{\n    virNetworkObjPortListExportData data = {\n        net, obj->def, NULL, filter, 0, false,\n    };\n    int ret = -1;\n\n    if (ports) {\n        *ports = NULL;\n\n        if (VIR_ALLOC_N(data.ports, virHashSize(obj->ports) + 1) < 0)\n            goto cleanup;\n    }\n\n    virHashForEach(obj->ports, virNetworkObjPortListExportCallback, &data);\n\n    if (data.error)\n        goto cleanup;\n\n    if (data.ports) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.ports, data.nports + 1));\n        *ports = data.ports;\n        data.ports = NULL;\n    }\n\n    ret = data.nports;\n cleanup:\n    while (data.ports && data.nports)\n        virObjectUnref(data.ports[--data.nports]);\n\n    VIR_FREE(data.ports);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjPortListExportCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1763-1792",
    "snippet": "static int\nvirNetworkObjPortListExportCallback(void *payload,\n                                    const void *name G_GNUC_UNUSED,\n                                    void *opaque)\n{\n    virNetworkObjPortListExportDataPtr data = opaque;\n    virNetworkPortDefPtr def = payload;\n    virNetworkPortPtr port;\n\n    if (data->error)\n        return 0;\n\n    if (data->filter &&\n        !data->filter(data->net->conn, data->def, def))\n        return 0;\n\n    if (!data->ports) {\n        data->nports++;\n        return 0;\n    }\n\n    if (!(port = virGetNetworkPort(data->net, def->uuid))) {\n        data->error = true;\n        return 0;\n    }\n\n    data->ports[data->nports++] = port;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetNetworkPort",
          "args": [
            "data->net",
            "def->uuid"
          ],
          "line": 1784
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNetworkPort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "402-424",
          "snippet": "virNetworkPortPtr\nvirGetNetworkPort(virNetworkPtr net, const unsigned char *uuid)\n{\n    virNetworkPortPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckNetworkGoto(net, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virNetworkPortClass)))\n        goto error;\n\n    ret->net = virObjectRef(net);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNetworkPortClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNetworkPortClass;\n\nvirNetworkPortPtr\nvirGetNetworkPort(virNetworkPtr net, const unsigned char *uuid)\n{\n    virNetworkPortPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckNetworkGoto(net, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virNetworkPortClass)))\n        goto error;\n\n    ret->net = virObjectRef(net);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->net->conn",
            "data->def",
            "def"
          ],
          "line": 1776
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjPortListExportCallback(void *payload,\n                                    const void *name G_GNUC_UNUSED,\n                                    void *opaque)\n{\n    virNetworkObjPortListExportDataPtr data = opaque;\n    virNetworkPortDefPtr def = payload;\n    virNetworkPortPtr port;\n\n    if (data->error)\n        return 0;\n\n    if (data->filter &&\n        !data->filter(data->net->conn, data->def, def))\n        return 0;\n\n    if (!data->ports) {\n        data->nports++;\n        return 0;\n    }\n\n    if (!(port = virGetNetworkPort(data->net, def->uuid))) {\n        data->error = true;\n        return 0;\n    }\n\n    data->ports[data->nports++] = port;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjDeleteAllPorts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1711-1749",
    "snippet": "int\nvirNetworkObjDeleteAllPorts(virNetworkObjPtr net,\n                            const char *stateDir)\n{\n    g_autofree char *dir = NULL;\n    DIR *dh = NULL;\n    struct dirent *de;\n    int rc;\n    int ret = -1;\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        goto cleanup;\n\n    if ((rc = virDirOpenIfExists(&dh, dir)) <= 0) {\n        ret = rc;\n        goto cleanup;\n    }\n\n    while ((rc = virDirRead(dh, &de, dir)) > 0) {\n        char *file = NULL;\n\n        if (!virStringStripSuffix(de->d_name, \".xml\"))\n            continue;\n\n        file = g_strdup_printf(\"%s/%s.xml\", dir, de->d_name);\n\n        if (unlink(file) < 0 && errno != ENOENT)\n            VIR_WARN(\"Unable to delete %s\", file);\n\n        VIR_FREE(file);\n    }\n\n    virHashRemoveAll(net->ports);\n\n    ret = 0;\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dh"
          ],
          "line": 1747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashRemoveAll",
          "args": [
            "net->ports"
          ],
          "line": 1743
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "715-721",
          "snippet": "ssize_t\nvirHashRemoveAll(virHashTablePtr table)\n{\n    return virHashRemoveSet(table,\n                            _virHashRemoveAllIter,\n                            NULL);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashRemoveAll(virHashTablePtr table)\n{\n    return virHashRemoveSet(table,\n                            _virHashRemoveAllIter,\n                            NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "file"
          ],
          "line": 1740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to delete %s\"",
            "file"
          ],
          "line": 1738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "file"
          ],
          "line": 1737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s.xml\"",
            "dir",
            "de->d_name"
          ],
          "line": 1735
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringStripSuffix",
          "args": [
            "de->d_name",
            "\".xml\""
          ],
          "line": 1732
        },
        "resolved": true,
        "details": {
          "function_name": "virStringStripSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1123-1139",
          "snippet": "bool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dh",
            "&de",
            "dir"
          ],
          "line": 1729
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dh",
            "dir"
          ],
          "line": 1724
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjGetPortStatusDir",
          "args": [
            "net",
            "stateDir"
          ],
          "line": 1721
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjGetPortStatusDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "1619-1626",
          "snippet": "char *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nchar *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nint\nvirNetworkObjDeleteAllPorts(virNetworkObjPtr net,\n                            const char *stateDir)\n{\n    g_autofree char *dir = NULL;\n    DIR *dh = NULL;\n    struct dirent *de;\n    int rc;\n    int ret = -1;\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        goto cleanup;\n\n    if ((rc = virDirOpenIfExists(&dh, dir)) <= 0) {\n        ret = rc;\n        goto cleanup;\n    }\n\n    while ((rc = virDirRead(dh, &de, dir)) > 0) {\n        char *file = NULL;\n\n        if (!virStringStripSuffix(de->d_name, \".xml\"))\n            continue;\n\n        file = g_strdup_printf(\"%s/%s.xml\", dir, de->d_name);\n\n        if (unlink(file) < 0 && errno != ENOENT)\n            VIR_WARN(\"Unable to delete %s\", file);\n\n        VIR_FREE(file);\n    }\n\n    virHashRemoveAll(net->ports);\n\n    ret = 0;\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjDeletePort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1680-1708",
    "snippet": "int\nvirNetworkObjDeletePort(virNetworkObjPtr net,\n                        const unsigned char *uuid,\n                        const char *stateDir)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *dir = NULL;\n    virNetworkPortDefPtr portdef;\n\n    virUUIDFormat(uuid, uuidstr);\n\n    if (!(portdef = virHashLookup(net->ports, uuidstr))) {\n        virReportError(VIR_ERR_NO_NETWORK_PORT,\n                       _(\"Network port with UUID %s does not exist\"),\n                       uuidstr);\n        return -1;\n    }\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        return -1;\n\n    if (virNetworkPortDefDeleteStatus(portdef, dir) < 0)\n        return -1;\n\n    if (virHashRemoveEntry(net->ports, uuidstr) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "net->ports",
            "uuidstr"
          ],
          "line": 1704
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkPortDefDeleteStatus",
          "args": [
            "portdef",
            "dir"
          ],
          "line": 1701
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkPortDefDeleteStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkportdef.c",
          "lines": "468-491",
          "snippet": "int\nvirNetworkPortDefDeleteStatus(virNetworkPortDef *def,\n                              const char *dir)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *path;\n    int ret = -1;\n\n    virUUIDFormat(def->uuid, uuidstr);\n\n    if (!(path = virNetworkPortDefConfigFile(dir, uuidstr)))\n        goto cleanup;\n\n    if (unlink(path) < 0 && errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Unable to delete %s\"), path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(path);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_vport_profile_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"network_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetworkPortDefDeleteStatus(virNetworkPortDef *def,\n                              const char *dir)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *path;\n    int ret = -1;\n\n    virUUIDFormat(def->uuid, uuidstr);\n\n    if (!(path = virNetworkPortDefConfigFile(dir, uuidstr)))\n        goto cleanup;\n\n    if (unlink(path) < 0 && errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Unable to delete %s\"), path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(path);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjGetPortStatusDir",
          "args": [
            "net",
            "stateDir"
          ],
          "line": 1698
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjGetPortStatusDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "1619-1626",
          "snippet": "char *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nchar *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_NETWORK_PORT",
            "_(\"Network port with UUID %s does not exist\")",
            "uuidstr"
          ],
          "line": 1692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Network port with UUID %s does not exist\""
          ],
          "line": 1693
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "net->ports",
            "uuidstr"
          ],
          "line": 1691
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 1689
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nint\nvirNetworkObjDeletePort(virNetworkObjPtr net,\n                        const unsigned char *uuid,\n                        const char *stateDir)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *dir = NULL;\n    virNetworkPortDefPtr portdef;\n\n    virUUIDFormat(uuid, uuidstr);\n\n    if (!(portdef = virHashLookup(net->ports, uuidstr))) {\n        virReportError(VIR_ERR_NO_NETWORK_PORT,\n                       _(\"Network port with UUID %s does not exist\"),\n                       uuidstr);\n        return -1;\n    }\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        return -1;\n\n    if (virNetworkPortDefDeleteStatus(portdef, dir) < 0)\n        return -1;\n\n    if (virHashRemoveEntry(net->ports, uuidstr) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjLookupPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1660-1677",
    "snippet": "virNetworkPortDefPtr\nvirNetworkObjLookupPort(virNetworkObjPtr net,\n                        const unsigned char *uuid)\n{\n    virNetworkPortDefPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    if (!(ret = virHashLookup(net->ports, uuidstr))) {\n        virReportError(VIR_ERR_NO_NETWORK_PORT,\n                       _(\"Network port with UUID %s does not exist\"),\n                       uuidstr);\n        return NULL;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_NETWORK_PORT",
            "_(\"Network port with UUID %s does not exist\")",
            "uuidstr"
          ],
          "line": 1670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Network port with UUID %s does not exist\""
          ],
          "line": 1671
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "net->ports",
            "uuidstr"
          ],
          "line": 1669
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 1667
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNetworkPortDefPtr\nvirNetworkObjLookupPort(virNetworkObjPtr net,\n                        const unsigned char *uuid)\n{\n    virNetworkPortDefPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    if (!(ret = virHashLookup(net->ports, uuidstr))) {\n        virReportError(VIR_ERR_NO_NETWORK_PORT,\n                       _(\"Network port with UUID %s does not exist\"),\n                       uuidstr);\n        return NULL;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjAddPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1628-1657",
    "snippet": "int\nvirNetworkObjAddPort(virNetworkObjPtr net,\n                     virNetworkPortDefPtr portdef,\n                     const char *stateDir)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *dir = NULL;\n\n    virUUIDFormat(portdef->uuid, uuidstr);\n\n    if (virHashLookup(net->ports, uuidstr)) {\n        virReportError(VIR_ERR_NETWORK_PORT_EXIST,\n                       _(\"Network port with UUID %s already exists\"),\n                       uuidstr);\n        return -1;\n    }\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        return -1;\n\n    if (virHashAddEntry(net->ports, uuidstr, portdef) < 0)\n        return -1;\n\n    if (virNetworkPortDefSaveStatus(portdef, dir) < 0) {\n        virHashRemoveEntry(net->ports, uuidstr);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "net->ports",
            "uuidstr"
          ],
          "line": 1652
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkPortDefSaveStatus",
          "args": [
            "portdef",
            "dir"
          ],
          "line": 1651
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkPortDefSaveStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkportdef.c",
          "lines": "442-465",
          "snippet": "int\nvirNetworkPortDefSaveStatus(virNetworkPortDef *def,\n                            const char *dir)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *path = NULL;\n    g_autofree char *xml = NULL;\n\n    virUUIDFormat(def->uuid, uuidstr);\n\n    if (virFileMakePath(dir) < 0)\n        return -1;\n\n    if (!(path = virNetworkPortDefConfigFile(dir, uuidstr)))\n        return -1;\n\n    if (!(xml = virNetworkPortDefFormat(def)))\n        return -1;\n\n    if (virXMLSaveFile(path, uuidstr, \"net-port-create\", xml) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_vport_profile_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"network_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetworkPortDefSaveStatus(virNetworkPortDef *def,\n                            const char *dir)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *path = NULL;\n    g_autofree char *xml = NULL;\n\n    virUUIDFormat(def->uuid, uuidstr);\n\n    if (virFileMakePath(dir) < 0)\n        return -1;\n\n    if (!(path = virNetworkPortDefConfigFile(dir, uuidstr)))\n        return -1;\n\n    if (!(xml = virNetworkPortDefFormat(def)))\n        return -1;\n\n    if (virXMLSaveFile(path, uuidstr, \"net-port-create\", xml) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "net->ports",
            "uuidstr",
            "portdef"
          ],
          "line": 1648
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjGetPortStatusDir",
          "args": [
            "net",
            "stateDir"
          ],
          "line": 1645
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjGetPortStatusDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "1619-1626",
          "snippet": "char *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nchar *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NETWORK_PORT_EXIST",
            "_(\"Network port with UUID %s already exists\")",
            "uuidstr"
          ],
          "line": 1639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Network port with UUID %s already exists\""
          ],
          "line": 1640
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "net->ports",
            "uuidstr"
          ],
          "line": 1638
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "portdef->uuid",
            "uuidstr"
          ],
          "line": 1636
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nint\nvirNetworkObjAddPort(virNetworkObjPtr net,\n                     virNetworkPortDefPtr portdef,\n                     const char *stateDir)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *dir = NULL;\n\n    virUUIDFormat(portdef->uuid, uuidstr);\n\n    if (virHashLookup(net->ports, uuidstr)) {\n        virReportError(VIR_ERR_NETWORK_PORT_EXIST,\n                       _(\"Network port with UUID %s already exists\"),\n                       uuidstr);\n        return -1;\n    }\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        return -1;\n\n    if (virHashAddEntry(net->ports, uuidstr, portdef) < 0)\n        return -1;\n\n    if (virNetworkPortDefSaveStatus(portdef, dir) < 0) {\n        virHashRemoveEntry(net->ports, uuidstr);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjGetPortStatusDir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1619-1626",
    "snippet": "char *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s/ports\"",
            "stateDir",
            "net->def->name"
          ],
          "line": 1624
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nchar *\nvirNetworkObjGetPortStatusDir(virNetworkObjPtr net,\n                              const char *stateDir)\n{\n    char *ret;\n    ret = g_strdup_printf(\"%s/%s/ports\", stateDir, net->def->name);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjListPrune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1607-1616",
    "snippet": "void\nvirNetworkObjListPrune(virNetworkObjListPtr nets,\n                       unsigned int flags)\n{\n    struct virNetworkObjListPruneHelperData data = {flags};\n\n    virObjectRWLockWrite(nets);\n    virHashRemoveSet(nets->objs, virNetworkObjListPruneHelper, &data);\n    virObjectRWUnlock(nets);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 1615
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveSet",
          "args": [
            "nets->objs",
            "virNetworkObjListPruneHelper",
            "&data"
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "665-696",
          "snippet": "ssize_t\nvirHashRemoveSet(virHashTablePtr table,\n                 virHashSearcher iter,\n                 const void *data)\n{\n    size_t i, count = 0;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr *nextptr = table->table + i;\n\n        while (*nextptr) {\n            virHashEntryPtr entry = *nextptr;\n            if (!iter(entry->payload, entry->name, data)) {\n                nextptr = &entry->next;\n            } else {\n                count++;\n                if (table->dataFree)\n                    table->dataFree(entry->payload);\n                if (table->keyFree)\n                    table->keyFree(entry->name);\n                *nextptr = entry->next;\n                VIR_FREE(entry);\n                table->nbElems--;\n            }\n        }\n    }\n\n    return count;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashRemoveSet(virHashTablePtr table,\n                 virHashSearcher iter,\n                 const void *data)\n{\n    size_t i, count = 0;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr *nextptr = table->table + i;\n\n        while (*nextptr) {\n            virHashEntryPtr entry = *nextptr;\n            if (!iter(entry->payload, entry->name, data)) {\n                nextptr = &entry->next;\n            } else {\n                count++;\n                if (table->dataFree)\n                    table->dataFree(entry->payload);\n                if (table->keyFree)\n                    table->keyFree(entry->name);\n                *nextptr = entry->next;\n                VIR_FREE(entry);\n                table->nbElems--;\n            }\n        }\n    }\n\n    return count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "nets"
          ],
          "line": 1613
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNetworkObjListPrune(virNetworkObjListPtr nets,\n                       unsigned int flags)\n{\n    struct virNetworkObjListPruneHelperData data = {flags};\n\n    virObjectRWLockWrite(nets);\n    virHashRemoveSet(nets->objs, virNetworkObjListPruneHelper, &data);\n    virObjectRWUnlock(nets);\n}"
  },
  {
    "function_name": "virNetworkObjListPruneHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1583-1596",
    "snippet": "static int\nvirNetworkObjListPruneHelper(const void *payload,\n                             const void *name G_GNUC_UNUSED,\n                             const void *opaque)\n{\n    const struct virNetworkObjListPruneHelperData *data = opaque;\n    virNetworkObjPtr obj = (virNetworkObjPtr) payload;\n    int want = 0;\n\n    virObjectLock(obj);\n    want = virNetworkObjMatch(obj, data->flags);\n    virObjectUnlock(obj);\n    return want;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 1594
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjMatch",
          "args": [
            "obj",
            "data->flags"
          ],
          "line": 1593
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "1318-1347",
          "snippet": "static bool\nvirNetworkObjMatch(virNetworkObjPtr obj,\n                   unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_ACTIVE) &&\n           virNetworkObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_INACTIVE) &&\n           !virNetworkObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_PERSISTENT) &&\n           obj->persistent) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_TRANSIENT) &&\n           !obj->persistent)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic bool\nvirNetworkObjMatch(virNetworkObjPtr obj,\n                   unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_ACTIVE) &&\n           virNetworkObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_INACTIVE) &&\n           !virNetworkObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_PERSISTENT) &&\n           obj->persistent) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_TRANSIENT) &&\n           !obj->persistent)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 1592
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic int\nvirNetworkObjListPruneHelper(const void *payload,\n                             const void *name G_GNUC_UNUSED,\n                             const void *opaque)\n{\n    const struct virNetworkObjListPruneHelperData *data = opaque;\n    virNetworkObjPtr obj = (virNetworkObjPtr) payload;\n    int want = 0;\n\n    virObjectLock(obj);\n    want = virNetworkObjMatch(obj, data->flags);\n    virObjectUnlock(obj);\n    return want;\n}"
  },
  {
    "function_name": "virNetworkObjListNumOfNetworks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1561-1576",
    "snippet": "int\nvirNetworkObjListNumOfNetworks(virNetworkObjListPtr nets,\n                               bool active,\n                               virNetworkObjListFilter filter,\n                               virConnectPtr conn)\n{\n    struct virNetworkObjListGetHelperData data = {\n        .conn = conn, .filter = filter, .names = NULL, .nnames = 0,\n        .maxnames = -1, .active = active, .error = false};\n\n    virObjectRWLockRead(nets);\n    virHashForEach(nets->objs, virNetworkObjListGetHelper, &data);\n    virObjectRWUnlock(nets);\n\n    return data.nnames;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 1573
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "nets->objs",
            "virNetworkObjListGetHelper",
            "&data"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "nets"
          ],
          "line": 1571
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNetworkObjListNumOfNetworks(virNetworkObjListPtr nets,\n                               bool active,\n                               virNetworkObjListFilter filter,\n                               virConnectPtr conn)\n{\n    struct virNetworkObjListGetHelperData data = {\n        .conn = conn, .filter = filter, .names = NULL, .nnames = 0,\n        .maxnames = -1, .active = active, .error = false};\n\n    virObjectRWLockRead(nets);\n    virHashForEach(nets->objs, virNetworkObjListGetHelper, &data);\n    virObjectRWUnlock(nets);\n\n    return data.nnames;\n}"
  },
  {
    "function_name": "virNetworkObjListGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1530-1558",
    "snippet": "int\nvirNetworkObjListGetNames(virNetworkObjListPtr nets,\n                          bool active,\n                          char **names,\n                          int maxnames,\n                          virNetworkObjListFilter filter,\n                          virConnectPtr conn)\n{\n    int ret = -1;\n\n    struct virNetworkObjListGetHelperData data = {\n        .conn = conn, .filter = filter, .names = names, .nnames = 0,\n        .maxnames = maxnames, .active = active, .error = false};\n\n    virObjectRWLockRead(nets);\n    virHashForEach(nets->objs, virNetworkObjListGetHelper, &data);\n    virObjectRWUnlock(nets);\n\n    if (data.error)\n        goto cleanup;\n\n    ret = data.nnames;\n cleanup:\n    if (ret < 0) {\n        while (data.nnames)\n            VIR_FREE(data.names[--data.nnames]);\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.names[--data.nnames]"
          ],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 1546
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "nets->objs",
            "virNetworkObjListGetHelper",
            "&data"
          ],
          "line": 1545
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "nets"
          ],
          "line": 1544
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNetworkObjListGetNames(virNetworkObjListPtr nets,\n                          bool active,\n                          char **names,\n                          int maxnames,\n                          virNetworkObjListFilter filter,\n                          virConnectPtr conn)\n{\n    int ret = -1;\n\n    struct virNetworkObjListGetHelperData data = {\n        .conn = conn, .filter = filter, .names = names, .nnames = 0,\n        .maxnames = maxnames, .active = active, .error = false};\n\n    virObjectRWLockRead(nets);\n    virHashForEach(nets->objs, virNetworkObjListGetHelper, &data);\n    virObjectRWUnlock(nets);\n\n    if (data.error)\n        goto cleanup;\n\n    ret = data.nnames;\n cleanup:\n    if (ret < 0) {\n        while (data.nnames)\n            VIR_FREE(data.names[--data.nnames]);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjListGetHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1496-1527",
    "snippet": "static int\nvirNetworkObjListGetHelper(void *payload,\n                           const void *name G_GNUC_UNUSED,\n                           void *opaque)\n{\n    struct virNetworkObjListGetHelperData *data = opaque;\n    virNetworkObjPtr obj = payload;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxnames >= 0 &&\n        data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter &&\n        !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if ((data->active && virNetworkObjIsActive(obj)) ||\n        (!data->active && !virNetworkObjIsActive(obj))) {\n        if (data->names)\n            data->names[data->nnames] = g_strdup(obj->def->name);\n        data->nnames++;\n    }\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 1525
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "obj->def->name"
          ],
          "line": 1520
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1518
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "170-174",
          "snippet": "bool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "obj->def"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 1511
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic int\nvirNetworkObjListGetHelper(void *payload,\n                           const void *name G_GNUC_UNUSED,\n                           void *opaque)\n{\n    struct virNetworkObjListGetHelperData *data = opaque;\n    virNetworkObjPtr obj = payload;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxnames >= 0 &&\n        data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter &&\n        !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if ((data->active && virNetworkObjIsActive(obj)) ||\n        (!data->active && !virNetworkObjIsActive(obj))) {\n        if (data->names)\n            data->names[data->nnames] = g_strdup(obj->def->name);\n        data->nnames++;\n    }\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjListForEach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1472-1483",
    "snippet": "int\nvirNetworkObjListForEach(virNetworkObjListPtr nets,\n                         virNetworkObjListIterator callback,\n                         void *opaque)\n{\n    struct virNetworkObjListForEachHelperData data = {\n        .callback = callback, .opaque = opaque, .ret = 0};\n    virObjectRWLockRead(nets);\n    virHashForEach(nets->objs, virNetworkObjListForEachHelper, &data);\n    virObjectRWUnlock(nets);\n    return data.ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "nets->objs",
            "virNetworkObjListForEachHelper",
            "&data"
          ],
          "line": 1480
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "nets"
          ],
          "line": 1479
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNetworkObjListForEach(virNetworkObjListPtr nets,\n                         virNetworkObjListIterator callback,\n                         void *opaque)\n{\n    struct virNetworkObjListForEachHelperData data = {\n        .callback = callback, .opaque = opaque, .ret = 0};\n    virObjectRWLockRead(nets);\n    virHashForEach(nets->objs, virNetworkObjListForEachHelper, &data);\n    virObjectRWUnlock(nets);\n    return data.ret;\n}"
  },
  {
    "function_name": "virNetworkObjListForEachHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1446-1456",
    "snippet": "static int\nvirNetworkObjListForEachHelper(void *payload,\n                               const void *name G_GNUC_UNUSED,\n                               void *opaque)\n{\n    struct virNetworkObjListForEachHelperData *data = opaque;\n\n    if (data->callback(payload, data->opaque) < 0)\n        data->ret = -1;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data->callback",
          "args": [
            "payload",
            "data->opaque"
          ],
          "line": 1453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjListForEachHelper(void *payload,\n                               const void *name G_GNUC_UNUSED,\n                               void *opaque)\n{\n    struct virNetworkObjListForEachHelperData *data = opaque;\n\n    if (data->callback(payload, data->opaque) < 0)\n        data->ret = -1;\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1401-1437",
    "snippet": "int\nvirNetworkObjListExport(virConnectPtr conn,\n                        virNetworkObjListPtr netobjs,\n                        virNetworkPtr **nets,\n                        virNetworkObjListFilter filter,\n                        unsigned int flags)\n{\n    int ret = -1;\n    virNetworkObjListExportData data = {\n        .conn = conn, .nets = NULL, .filter = filter, .flags = flags,\n        .nnets = 0, .error = false };\n\n    virObjectRWLockRead(netobjs);\n    if (nets && VIR_ALLOC_N(data.nets, virHashSize(netobjs->objs) + 1) < 0)\n        goto cleanup;\n\n    virHashForEach(netobjs->objs, virNetworkObjListExportCallback, &data);\n\n    if (data.error)\n        goto cleanup;\n\n    if (data.nets) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.nets, data.nnets + 1));\n        *nets = data.nets;\n        data.nets = NULL;\n    }\n\n    ret = data.nnets;\n cleanup:\n    virObjectRWUnlock(netobjs);\n    while (data.nets && data.nnets)\n        virObjectUnref(data.nets[--data.nnets]);\n\n    VIR_FREE(data.nets);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.nets"
          ],
          "line": 1435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "data.nets[--data.nnets]"
          ],
          "line": 1433
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "netobjs"
          ],
          "line": 1431
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_REALLOC_N(data.nets, data.nnets + 1)"
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "data.nets",
            "data.nnets + 1"
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "netobjs->objs",
            "virNetworkObjListExportCallback",
            "&data"
          ],
          "line": 1417
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "data.nets",
            "virHashSize(netobjs->objs) + 1"
          ],
          "line": 1414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "netobjs->objs"
          ],
          "line": 1414
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "netobjs"
          ],
          "line": 1413
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNetworkObjListExport(virConnectPtr conn,\n                        virNetworkObjListPtr netobjs,\n                        virNetworkPtr **nets,\n                        virNetworkObjListFilter filter,\n                        unsigned int flags)\n{\n    int ret = -1;\n    virNetworkObjListExportData data = {\n        .conn = conn, .nets = NULL, .filter = filter, .flags = flags,\n        .nnets = 0, .error = false };\n\n    virObjectRWLockRead(netobjs);\n    if (nets && VIR_ALLOC_N(data.nets, virHashSize(netobjs->objs) + 1) < 0)\n        goto cleanup;\n\n    virHashForEach(netobjs->objs, virNetworkObjListExportCallback, &data);\n\n    if (data.error)\n        goto cleanup;\n\n    if (data.nets) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.nets, data.nnets + 1));\n        *nets = data.nets;\n        data.nets = NULL;\n    }\n\n    ret = data.nnets;\n cleanup:\n    virObjectRWUnlock(netobjs);\n    while (data.nets && data.nnets)\n        virObjectUnref(data.nets[--data.nnets]);\n\n    VIR_FREE(data.nets);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjListExportCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1362-1398",
    "snippet": "static int\nvirNetworkObjListExportCallback(void *payload,\n                                const void *name G_GNUC_UNUSED,\n                                void *opaque)\n{\n    virNetworkObjListExportDataPtr data = opaque;\n    virNetworkObjPtr obj = payload;\n    virNetworkPtr net = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter &&\n        !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (!virNetworkObjMatch(obj, data->flags))\n        goto cleanup;\n\n    if (!data->nets) {\n        data->nnets++;\n        goto cleanup;\n    }\n\n    if (!(net = virGetNetwork(data->conn, obj->def->name, obj->def->uuid))) {\n        data->error = true;\n        goto cleanup;\n    }\n\n    data->nets[data->nnets++] = net;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 1396
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNetwork",
          "args": [
            "data->conn",
            "obj->def->name",
            "obj->def->uuid"
          ],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "341-366",
          "snippet": "virNetworkPtr\nvirGetNetwork(virConnectPtr conn, const char *name, const unsigned char *uuid)\n{\n    virNetworkPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virNetworkClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNetworkClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNetworkClass;\n\nvirNetworkPtr\nvirGetNetwork(virConnectPtr conn, const char *name, const unsigned char *uuid)\n{\n    virNetworkPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virNetworkClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjMatch",
          "args": [
            "obj",
            "data->flags"
          ],
          "line": 1380
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "1318-1347",
          "snippet": "static bool\nvirNetworkObjMatch(virNetworkObjPtr obj,\n                   unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_ACTIVE) &&\n           virNetworkObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_INACTIVE) &&\n           !virNetworkObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_PERSISTENT) &&\n           obj->persistent) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_TRANSIENT) &&\n           !obj->persistent)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic bool\nvirNetworkObjMatch(virNetworkObjPtr obj,\n                   unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_ACTIVE) &&\n           virNetworkObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_INACTIVE) &&\n           !virNetworkObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_PERSISTENT) &&\n           obj->persistent) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_TRANSIENT) &&\n           !obj->persistent)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "obj->def"
          ],
          "line": 1377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 1374
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic int\nvirNetworkObjListExportCallback(void *payload,\n                                const void *name G_GNUC_UNUSED,\n                                void *opaque)\n{\n    virNetworkObjListExportDataPtr data = opaque;\n    virNetworkObjPtr obj = payload;\n    virNetworkPtr net = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter &&\n        !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (!virNetworkObjMatch(obj, data->flags))\n        goto cleanup;\n\n    if (!data->nets) {\n        data->nnets++;\n        goto cleanup;\n    }\n\n    if (!(net = virGetNetwork(data->conn, obj->def->name, obj->def->uuid))) {\n        data->error = true;\n        goto cleanup;\n    }\n\n    data->nets[data->nnets++] = net;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1318-1347",
    "snippet": "static bool\nvirNetworkObjMatch(virNetworkObjPtr obj,\n                   unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_ACTIVE) &&\n           virNetworkObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_INACTIVE) &&\n           !virNetworkObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_PERSISTENT) &&\n           obj->persistent) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_TRANSIENT) &&\n           !obj->persistent)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_NO_AUTOSTART"
          ],
          "line": 1342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_AUTOSTART"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_FILTERS_AUTOSTART"
          ],
          "line": 1339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_TRANSIENT"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_PERSISTENT"
          ],
          "line": 1332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_FILTERS_PERSISTENT"
          ],
          "line": 1331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkObjIsActive",
          "args": [
            "obj"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "170-174",
          "snippet": "bool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_INACTIVE"
          ],
          "line": 1326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_ACTIVE"
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_NETWORKS_FILTERS_ACTIVE"
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic bool\nvirNetworkObjMatch(virNetworkObjPtr obj,\n                   unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_ACTIVE) &&\n           virNetworkObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_INACTIVE) &&\n           !virNetworkObjIsActive(obj))))\n        return false;\n\n    /* filter by persistence */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_PERSISTENT) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_PERSISTENT) &&\n           obj->persistent) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_TRANSIENT) &&\n           !obj->persistent)))\n        return false;\n\n    /* filter by autostart option */\n    if (MATCH(VIR_CONNECT_LIST_NETWORKS_FILTERS_AUTOSTART) &&\n        !((MATCH(VIR_CONNECT_LIST_NETWORKS_AUTOSTART) &&\n           obj->autostart) ||\n          (MATCH(VIR_CONNECT_LIST_NETWORKS_NO_AUTOSTART) &&\n           !obj->autostart)))\n        return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virNetworkObjUpdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1241-1314",
    "snippet": "int\nvirNetworkObjUpdate(virNetworkObjPtr obj,\n                    unsigned int command, /* virNetworkUpdateCommand */\n                    unsigned int section, /* virNetworkUpdateSection */\n                    int parentIndex,\n                    const char *xml,\n                    virNetworkXMLOptionPtr xmlopt,\n                    unsigned int flags)  /* virNetworkUpdateFlags */\n{\n    int ret = -1;\n    virNetworkDefPtr livedef = NULL, configdef = NULL;\n\n    /* normalize config data, and check for common invalid requests. */\n    if (virNetworkObjConfigChangeSetup(obj, xmlopt, flags) < 0)\n       goto cleanup;\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE) {\n        virNetworkDefPtr checkdef;\n\n        /* work on a copy of the def */\n        if (!(livedef = virNetworkDefCopy(obj->def, xmlopt, 0)))\n            goto cleanup;\n        if (virNetworkDefUpdateSection(livedef, command, section,\n                                       parentIndex, xml, flags) < 0) {\n            goto cleanup;\n        }\n        /* run a final format/parse cycle to make sure we didn't\n         * add anything illegal to the def\n         */\n        if (!(checkdef = virNetworkDefCopy(livedef, xmlopt, 0)))\n            goto cleanup;\n        virNetworkDefFree(checkdef);\n    }\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_CONFIG) {\n        virNetworkDefPtr checkdef;\n\n        /* work on a copy of the def */\n        if (!(configdef = virNetworkDefCopy(virNetworkObjGetPersistentDef(obj),\n                                            xmlopt,\n                                            VIR_NETWORK_XML_INACTIVE))) {\n            goto cleanup;\n        }\n        if (virNetworkDefUpdateSection(configdef, command, section,\n                                       parentIndex, xml, flags) < 0) {\n            goto cleanup;\n        }\n        if (!(checkdef = virNetworkDefCopy(configdef,\n                                           xmlopt,\n                                           VIR_NETWORK_XML_INACTIVE))) {\n            goto cleanup;\n        }\n        virNetworkDefFree(checkdef);\n    }\n\n    if (configdef) {\n        /* successfully modified copy, now replace original */\n        if (virNetworkObjReplacePersistentDef(obj, configdef) < 0)\n           goto cleanup;\n        configdef = NULL;\n    }\n    if (livedef) {\n        /* successfully modified copy, now replace original */\n        virNetworkDefFree(obj->def);\n        obj->def = livedef;\n        livedef = NULL;\n    }\n\n    ret = 0;\n cleanup:\n    virNetworkDefFree(livedef);\n    virNetworkDefFree(configdef);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkDefFree",
          "args": [
            "configdef"
          ],
          "line": 1312
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "235-274",
          "snippet": "void\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjReplacePersistentDef",
          "args": [
            "obj",
            "configdef"
          ],
          "line": 1298
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjReplacePersistentDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "737-749",
          "snippet": "int\nvirNetworkObjReplacePersistentDef(virNetworkObjPtr obj,\n                                  virNetworkDefPtr def)\n{\n    if (virNetworkObjIsActive(obj)) {\n        virNetworkDefFree(obj->newDef);\n        obj->newDef = def;\n    } else {\n        virNetworkDefFree(obj->def);\n        obj->def = def;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjReplacePersistentDef(virNetworkObjPtr obj,\n                                  virNetworkDefPtr def)\n{\n    if (virNetworkObjIsActive(obj)) {\n        virNetworkDefFree(obj->newDef);\n        obj->newDef = def;\n    } else {\n        virNetworkDefFree(obj->def);\n        obj->def = def;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkDefCopy",
          "args": [
            "configdef",
            "xmlopt",
            "VIR_NETWORK_XML_INACTIVE"
          ],
          "line": 1288
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "286-307",
          "snippet": "virNetworkDefPtr\nvirNetworkDefCopy(virNetworkDefPtr def,\n                  virNetworkXMLOptionPtr xmlopt,\n                  unsigned int flags)\n{\n    char *xml = NULL;\n    virNetworkDefPtr newDef = NULL;\n\n    if (!def) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"NULL NetworkDef\"));\n        return NULL;\n    }\n\n    /* deep copy with a format/parse cycle */\n    if (!(xml = virNetworkDefFormat(def, xmlopt, flags)))\n        goto cleanup;\n    newDef = virNetworkDefParseString(xml, xmlopt);\n cleanup:\n    VIR_FREE(xml);\n    return newDef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetworkDefPtr\nvirNetworkDefCopy(virNetworkDefPtr def,\n                  virNetworkXMLOptionPtr xmlopt,\n                  unsigned int flags)\n{\n    char *xml = NULL;\n    virNetworkDefPtr newDef = NULL;\n\n    if (!def) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"NULL NetworkDef\"));\n        return NULL;\n    }\n\n    /* deep copy with a format/parse cycle */\n    if (!(xml = virNetworkDefFormat(def, xmlopt, flags)))\n        goto cleanup;\n    newDef = virNetworkDefParseString(xml, xmlopt);\n cleanup:\n    VIR_FREE(xml);\n    return newDef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkDefUpdateSection",
          "args": [
            "configdef",
            "command",
            "section",
            "parentIndex",
            "xml",
            "flags"
          ],
          "line": 1284
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefUpdateSection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "3644-3710",
          "snippet": "int\nvirNetworkDefUpdateSection(virNetworkDefPtr def,\n                           unsigned int command, /* virNetworkUpdateCommand */\n                           unsigned int section, /* virNetworkUpdateSection */\n                           int parentIndex,\n                           const char *xml,\n                           unsigned int flags)  /* virNetworkUpdateFlags */\n{\n    g_autoptr(xmlDoc) doc = NULL;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!(doc = virXMLParseStringCtxt(xml, _(\"network_update_xml\"), &ctxt)))\n        return -1;\n\n    switch (section) {\n    case VIR_NETWORK_SECTION_BRIDGE:\n        return virNetworkDefUpdateBridge(def, command, parentIndex, ctxt, flags);\n        break;\n\n    case VIR_NETWORK_SECTION_DOMAIN:\n        return virNetworkDefUpdateDomain(def, command, parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_IP:\n        return virNetworkDefUpdateIP(def, command, parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_IP_DHCP_HOST:\n        return virNetworkDefUpdateIPDHCPHost(def, command,\n                                             parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_IP_DHCP_RANGE:\n        return virNetworkDefUpdateIPDHCPRange(def, command,\n                                              parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_FORWARD:\n        return virNetworkDefUpdateForward(def, command,\n                                          parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_FORWARD_INTERFACE:\n        return virNetworkDefUpdateForwardInterface(def, command,\n                                                   parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_FORWARD_PF:\n        return virNetworkDefUpdateForwardPF(def, command,\n                                            parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_PORTGROUP:\n        return virNetworkDefUpdatePortGroup(def, command,\n                                            parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_DNS_HOST:\n        return virNetworkDefUpdateDNSHost(def, command,\n                                          parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_DNS_TXT:\n        return virNetworkDefUpdateDNSTxt(def, command, parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_DNS_SRV:\n        return virNetworkDefUpdateDNSSrv(def, command, parentIndex, ctxt, flags);\n        break;\n    default:\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"can't update unrecognized section of network\"));\n        break;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetworkDefUpdateSection(virNetworkDefPtr def,\n                           unsigned int command, /* virNetworkUpdateCommand */\n                           unsigned int section, /* virNetworkUpdateSection */\n                           int parentIndex,\n                           const char *xml,\n                           unsigned int flags)  /* virNetworkUpdateFlags */\n{\n    g_autoptr(xmlDoc) doc = NULL;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!(doc = virXMLParseStringCtxt(xml, _(\"network_update_xml\"), &ctxt)))\n        return -1;\n\n    switch (section) {\n    case VIR_NETWORK_SECTION_BRIDGE:\n        return virNetworkDefUpdateBridge(def, command, parentIndex, ctxt, flags);\n        break;\n\n    case VIR_NETWORK_SECTION_DOMAIN:\n        return virNetworkDefUpdateDomain(def, command, parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_IP:\n        return virNetworkDefUpdateIP(def, command, parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_IP_DHCP_HOST:\n        return virNetworkDefUpdateIPDHCPHost(def, command,\n                                             parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_IP_DHCP_RANGE:\n        return virNetworkDefUpdateIPDHCPRange(def, command,\n                                              parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_FORWARD:\n        return virNetworkDefUpdateForward(def, command,\n                                          parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_FORWARD_INTERFACE:\n        return virNetworkDefUpdateForwardInterface(def, command,\n                                                   parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_FORWARD_PF:\n        return virNetworkDefUpdateForwardPF(def, command,\n                                            parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_PORTGROUP:\n        return virNetworkDefUpdatePortGroup(def, command,\n                                            parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_DNS_HOST:\n        return virNetworkDefUpdateDNSHost(def, command,\n                                          parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_DNS_TXT:\n        return virNetworkDefUpdateDNSTxt(def, command, parentIndex, ctxt, flags);\n        break;\n    case VIR_NETWORK_SECTION_DNS_SRV:\n        return virNetworkDefUpdateDNSSrv(def, command, parentIndex, ctxt, flags);\n        break;\n    default:\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"can't update unrecognized section of network\"));\n        break;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjGetPersistentDef",
          "args": [
            "obj"
          ],
          "line": 1279
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjGetPersistentDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "716-723",
          "snippet": "virNetworkDefPtr\nvirNetworkObjGetPersistentDef(virNetworkObjPtr obj)\n{\n    if (obj->newDef)\n        return obj->newDef;\n    else\n        return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkDefPtr\nvirNetworkObjGetPersistentDef(virNetworkObjPtr obj)\n{\n    if (obj->newDef)\n        return obj->newDef;\n    else\n        return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjConfigChangeSetup",
          "args": [
            "obj",
            "xmlopt",
            "flags"
          ],
          "line": 1254
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjConfigChangeSetup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "763-793",
          "snippet": "static int\nvirNetworkObjConfigChangeSetup(virNetworkObjPtr obj,\n                               virNetworkXMLOptionPtr xmlopt,\n                               unsigned int flags)\n{\n    bool isActive;\n\n    isActive = virNetworkObjIsActive(obj);\n\n    if (!isActive && (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"network is not running\"));\n        return -1;\n    }\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_CONFIG) {\n        if (!obj->persistent) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"cannot change persistent config of a \"\n                             \"transient network\"));\n            return -1;\n        }\n        /* this should already have been done by the driver, but do it\n         * anyway just in case.\n         */\n        if (isActive && (virNetworkObjSetDefTransient(obj, false, xmlopt) < 0))\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic int\nvirNetworkObjConfigChangeSetup(virNetworkObjPtr obj,\n                               virNetworkXMLOptionPtr xmlopt,\n                               unsigned int flags)\n{\n    bool isActive;\n\n    isActive = virNetworkObjIsActive(obj);\n\n    if (!isActive && (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"network is not running\"));\n        return -1;\n    }\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_CONFIG) {\n        if (!obj->persistent) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"cannot change persistent config of a \"\n                             \"transient network\"));\n            return -1;\n        }\n        /* this should already have been done by the driver, but do it\n         * anyway just in case.\n         */\n        if (isActive && (virNetworkObjSetDefTransient(obj, false, xmlopt) < 0))\n            return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjUpdate(virNetworkObjPtr obj,\n                    unsigned int command, /* virNetworkUpdateCommand */\n                    unsigned int section, /* virNetworkUpdateSection */\n                    int parentIndex,\n                    const char *xml,\n                    virNetworkXMLOptionPtr xmlopt,\n                    unsigned int flags)  /* virNetworkUpdateFlags */\n{\n    int ret = -1;\n    virNetworkDefPtr livedef = NULL, configdef = NULL;\n\n    /* normalize config data, and check for common invalid requests. */\n    if (virNetworkObjConfigChangeSetup(obj, xmlopt, flags) < 0)\n       goto cleanup;\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE) {\n        virNetworkDefPtr checkdef;\n\n        /* work on a copy of the def */\n        if (!(livedef = virNetworkDefCopy(obj->def, xmlopt, 0)))\n            goto cleanup;\n        if (virNetworkDefUpdateSection(livedef, command, section,\n                                       parentIndex, xml, flags) < 0) {\n            goto cleanup;\n        }\n        /* run a final format/parse cycle to make sure we didn't\n         * add anything illegal to the def\n         */\n        if (!(checkdef = virNetworkDefCopy(livedef, xmlopt, 0)))\n            goto cleanup;\n        virNetworkDefFree(checkdef);\n    }\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_CONFIG) {\n        virNetworkDefPtr checkdef;\n\n        /* work on a copy of the def */\n        if (!(configdef = virNetworkDefCopy(virNetworkObjGetPersistentDef(obj),\n                                            xmlopt,\n                                            VIR_NETWORK_XML_INACTIVE))) {\n            goto cleanup;\n        }\n        if (virNetworkDefUpdateSection(configdef, command, section,\n                                       parentIndex, xml, flags) < 0) {\n            goto cleanup;\n        }\n        if (!(checkdef = virNetworkDefCopy(configdef,\n                                           xmlopt,\n                                           VIR_NETWORK_XML_INACTIVE))) {\n            goto cleanup;\n        }\n        virNetworkDefFree(checkdef);\n    }\n\n    if (configdef) {\n        /* successfully modified copy, now replace original */\n        if (virNetworkObjReplacePersistentDef(obj, configdef) < 0)\n           goto cleanup;\n        configdef = NULL;\n    }\n    if (livedef) {\n        /* successfully modified copy, now replace original */\n        virNetworkDefFree(obj->def);\n        obj->def = livedef;\n        livedef = NULL;\n    }\n\n    ret = 0;\n cleanup:\n    virNetworkDefFree(livedef);\n    virNetworkDefFree(configdef);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjBridgeInUse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1211-1224",
    "snippet": "bool\nvirNetworkObjBridgeInUse(virNetworkObjListPtr nets,\n                         const char *bridge,\n                         const char *skipname)\n{\n    virNetworkObjPtr obj;\n    struct virNetworkObjBridgeInUseHelperData data = {bridge, skipname};\n\n    virObjectRWLockRead(nets);\n    obj = virHashSearch(nets->objs, virNetworkObjBridgeInUseHelper, &data, NULL);\n    virObjectRWUnlock(nets);\n\n    return obj != NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSearch",
          "args": [
            "nets->objs",
            "virNetworkObjBridgeInUseHelper",
            "&data",
            "NULL"
          ],
          "line": 1220
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "736-761",
          "snippet": "void *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "nets"
          ],
          "line": 1219
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjBridgeInUse(virNetworkObjListPtr nets,\n                         const char *bridge,\n                         const char *skipname)\n{\n    virNetworkObjPtr obj;\n    struct virNetworkObjBridgeInUseHelperData data = {bridge, skipname};\n\n    virObjectRWLockRead(nets);\n    obj = virHashSearch(nets->objs, virNetworkObjBridgeInUseHelper, &data, NULL);\n    virObjectRWUnlock(nets);\n\n    return obj != NULL;\n}"
  },
  {
    "function_name": "virNetworkObjBridgeInUseHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1185-1208",
    "snippet": "static int\nvirNetworkObjBridgeInUseHelper(const void *payload,\n                               const void *name G_GNUC_UNUSED,\n                               const void *opaque)\n{\n    int ret;\n    virNetworkObjPtr obj = (virNetworkObjPtr) payload;\n    const struct virNetworkObjBridgeInUseHelperData *data = opaque;\n\n    virObjectLock(obj);\n    if (data->skipname &&\n        ((obj->def && STREQ(obj->def->name, data->skipname)) ||\n         (obj->newDef && STREQ(obj->newDef->name, data->skipname))))\n        ret = 0;\n    else if ((obj->def && obj->def->bridge &&\n              STREQ(obj->def->bridge, data->bridge)) ||\n             (obj->newDef && obj->newDef->bridge &&\n              STREQ(obj->newDef->bridge, data->bridge)))\n        ret = 1;\n    else\n        ret = 0;\n    virObjectUnlock(obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 1206
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->newDef->bridge",
            "data->bridge"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->bridge",
            "data->bridge"
          ],
          "line": 1200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->newDef->name",
            "data->skipname"
          ],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->name",
            "data->skipname"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic int\nvirNetworkObjBridgeInUseHelper(const void *payload,\n                               const void *name G_GNUC_UNUSED,\n                               const void *opaque)\n{\n    int ret;\n    virNetworkObjPtr obj = (virNetworkObjPtr) payload;\n    const struct virNetworkObjBridgeInUseHelperData *data = opaque;\n\n    virObjectLock(obj);\n    if (data->skipname &&\n        ((obj->def && STREQ(obj->def->name, data->skipname)) ||\n         (obj->newDef && STREQ(obj->newDef->name, data->skipname))))\n        ret = 0;\n    else if ((obj->def && obj->def->bridge &&\n              STREQ(obj->def->bridge, data->bridge)) ||\n             (obj->newDef && obj->newDef->bridge &&\n              STREQ(obj->newDef->bridge, data->bridge)))\n        ret = 1;\n    else\n        ret = 0;\n    virObjectUnlock(obj);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjDeleteConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1146-1177",
    "snippet": "int\nvirNetworkObjDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virNetworkObjPtr obj)\n{\n    char *configFile = NULL;\n    char *autostartLink = NULL;\n    int ret = -1;\n\n    if (!(configFile = virNetworkConfigFile(configDir, obj->def->name)))\n        goto error;\n    if (!(autostartLink = virNetworkConfigFile(autostartDir, obj->def->name)))\n        goto error;\n\n    /* Not fatal if this doesn't work */\n    unlink(autostartLink);\n    obj->autostart = false;\n\n    if (unlink(configFile) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot remove config file '%s'\"),\n                             configFile);\n        goto error;\n    }\n\n    ret = 0;\n\n error:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "autostartLink"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot remove config file '%s'\")",
            "configFile"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot remove config file '%s'\""
          ],
          "line": 1166
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "configFile"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "autostartLink"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkConfigFile",
          "args": [
            "autostartDir",
            "obj->def->name"
          ],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "2770-2778",
          "snippet": "char *\nvirNetworkConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret = NULL;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirNetworkConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret = NULL;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virNetworkObjPtr obj)\n{\n    char *configFile = NULL;\n    char *autostartLink = NULL;\n    int ret = -1;\n\n    if (!(configFile = virNetworkConfigFile(configDir, obj->def->name)))\n        goto error;\n    if (!(autostartLink = virNetworkConfigFile(autostartDir, obj->def->name)))\n        goto error;\n\n    /* Not fatal if this doesn't work */\n    unlink(autostartLink);\n    obj->autostart = false;\n\n    if (unlink(configFile) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot remove config file '%s'\"),\n                             configFile);\n        goto error;\n    }\n\n    ret = 0;\n\n error:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjLoadAllConfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1111-1143",
    "snippet": "int\nvirNetworkObjLoadAllConfigs(virNetworkObjListPtr nets,\n                            const char *configDir,\n                            const char *autostartDir,\n                            virNetworkXMLOptionPtr xmlopt)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNetworkObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        obj = virNetworkLoadConfig(nets,\n                                   configDir,\n                                   autostartDir,\n                                   entry->d_name,\n                                   xmlopt);\n        virNetworkObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dir"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "136-145",
          "snippet": "void\nvirNetworkObjEndAPI(virNetworkObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjEndAPI(virNetworkObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkLoadConfig",
          "args": [
            "nets",
            "configDir",
            "autostartDir",
            "entry->d_name",
            "xmlopt"
          ],
          "line": 1133
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkLoadConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "1000-1073",
          "snippet": "static virNetworkObjPtr\nvirNetworkLoadConfig(virNetworkObjListPtr nets,\n                     const char *configDir,\n                     const char *autostartDir,\n                     const char *name,\n                     virNetworkXMLOptionPtr xmlopt)\n{\n    char *configFile = NULL, *autostartLink = NULL;\n    virNetworkDefPtr def = NULL;\n    virNetworkObjPtr obj;\n    int autostart;\n\n    if ((configFile = virNetworkConfigFile(configDir, name)) == NULL)\n        goto error;\n    if ((autostartLink = virNetworkConfigFile(autostartDir, name)) == NULL)\n        goto error;\n\n    if ((autostart = virFileLinkPointsTo(autostartLink, configFile)) < 0)\n        goto error;\n\n    if (!(def = virNetworkDefParseFile(configFile, xmlopt)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        if (!def->mac_specified) {\n            virNetworkSetBridgeMacAddr(def);\n            virNetworkSaveConfig(configDir, def, xmlopt);\n        }\n        break;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        /* Throw away MAC address for other forward types,\n         * which could have been generated by older libvirt RPMs */\n        def->mac_specified = false;\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        goto error;\n    }\n\n    if (!(obj = virNetworkObjAssignDef(nets, def, 0)))\n        goto error;\n\n    obj->autostart = (autostart == 1);\n\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n\n    return obj;\n\n error:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virNetworkDefFree(def);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkLoadConfig(virNetworkObjListPtr nets,\n                     const char *configDir,\n                     const char *autostartDir,\n                     const char *name,\n                     virNetworkXMLOptionPtr xmlopt)\n{\n    char *configFile = NULL, *autostartLink = NULL;\n    virNetworkDefPtr def = NULL;\n    virNetworkObjPtr obj;\n    int autostart;\n\n    if ((configFile = virNetworkConfigFile(configDir, name)) == NULL)\n        goto error;\n    if ((autostartLink = virNetworkConfigFile(autostartDir, name)) == NULL)\n        goto error;\n\n    if ((autostart = virFileLinkPointsTo(autostartLink, configFile)) < 0)\n        goto error;\n\n    if (!(def = virNetworkDefParseFile(configFile, xmlopt)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        if (!def->mac_specified) {\n            virNetworkSetBridgeMacAddr(def);\n            virNetworkSaveConfig(configDir, def, xmlopt);\n        }\n        break;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        /* Throw away MAC address for other forward types,\n         * which could have been generated by older libvirt RPMs */\n        def->mac_specified = false;\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        goto error;\n    }\n\n    if (!(obj = virNetworkObjAssignDef(nets, def, 0)))\n        goto error;\n\n    obj->autostart = (autostart == 1);\n\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n\n    return obj;\n\n error:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virNetworkDefFree(def);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringStripSuffix",
          "args": [
            "entry->d_name",
            "\".xml\""
          ],
          "line": 1128
        },
        "resolved": true,
        "details": {
          "function_name": "virStringStripSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1123-1139",
          "snippet": "bool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&entry",
            "configDir"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dir",
            "configDir"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjLoadAllConfigs(virNetworkObjListPtr nets,\n                            const char *configDir,\n                            const char *autostartDir,\n                            virNetworkXMLOptionPtr xmlopt)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNetworkObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        obj = virNetworkLoadConfig(nets,\n                                   configDir,\n                                   autostartDir,\n                                   entry->d_name,\n                                   xmlopt);\n        virNetworkObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjLoadAllState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1076-1108",
    "snippet": "int\nvirNetworkObjLoadAllState(virNetworkObjListPtr nets,\n                          const char *stateDir,\n                          virNetworkXMLOptionPtr xmlopt)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, stateDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, stateDir)) > 0) {\n        virNetworkObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        obj = virNetworkLoadState(nets, stateDir, entry->d_name, xmlopt);\n\n        if (obj &&\n            virNetworkObjLoadAllPorts(obj, stateDir) < 0) {\n            virNetworkObjEndAPI(&obj);\n            goto cleanup;\n        }\n        virNetworkObjEndAPI(&obj);\n    }\n\n cleanup:\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);",
      "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dir"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "136-145",
          "snippet": "void\nvirNetworkObjEndAPI(virNetworkObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjEndAPI(virNetworkObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjLoadAllPorts",
          "args": [
            "obj",
            "stateDir"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjLoadAllPorts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "1868-1913",
          "snippet": "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir)\n{\n    g_autofree char *dir = NULL;\n    DIR *dh = NULL;\n    struct dirent *de;\n    int ret = -1;\n    int rc;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autoptr(virNetworkPortDef) portdef = NULL;\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        goto cleanup;\n\n    if ((rc = virDirOpenIfExists(&dh, dir)) <= 0) {\n        ret = rc;\n        goto cleanup;\n    }\n\n    while ((rc = virDirRead(dh, &de, dir)) > 0) {\n        g_autofree char *file = NULL;\n\n        if (!virStringStripSuffix(de->d_name, \".xml\"))\n            continue;\n\n        file = g_strdup_printf(\"%s/%s.xml\", dir, de->d_name);\n\n        portdef = virNetworkPortDefParseFile(file);\n        if (!portdef) {\n            VIR_WARN(\"Cannot parse port %s\", file);\n            continue;\n        }\n\n        virUUIDFormat(portdef->uuid, uuidstr);\n        if (virHashAddEntry(net->ports, uuidstr, portdef) < 0)\n            goto cleanup;\n\n        portdef = NULL;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir)\n{\n    g_autofree char *dir = NULL;\n    DIR *dh = NULL;\n    struct dirent *de;\n    int ret = -1;\n    int rc;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autoptr(virNetworkPortDef) portdef = NULL;\n\n    if (!(dir = virNetworkObjGetPortStatusDir(net, stateDir)))\n        goto cleanup;\n\n    if ((rc = virDirOpenIfExists(&dh, dir)) <= 0) {\n        ret = rc;\n        goto cleanup;\n    }\n\n    while ((rc = virDirRead(dh, &de, dir)) > 0) {\n        g_autofree char *file = NULL;\n\n        if (!virStringStripSuffix(de->d_name, \".xml\"))\n            continue;\n\n        file = g_strdup_printf(\"%s/%s.xml\", dir, de->d_name);\n\n        portdef = virNetworkPortDefParseFile(file);\n        if (!portdef) {\n            VIR_WARN(\"Cannot parse port %s\", file);\n            continue;\n        }\n\n        virUUIDFormat(portdef->uuid, uuidstr);\n        if (virHashAddEntry(net->ports, uuidstr, portdef) < 0)\n            goto cleanup;\n\n        portdef = NULL;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkLoadState",
          "args": [
            "nets",
            "stateDir",
            "entry->d_name",
            "xmlopt"
          ],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkLoadState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "873-997",
          "snippet": "static virNetworkObjPtr\nvirNetworkLoadState(virNetworkObjListPtr nets,\n                    const char *stateDir,\n                    const char *name,\n                    virNetworkXMLOptionPtr xmlopt)\n{\n    char *configFile = NULL;\n    virNetworkDefPtr def = NULL;\n    virNetworkObjPtr obj = NULL;\n    xmlDocPtr xml = NULL;\n    xmlNodePtr node = NULL, *nodes = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virBitmapPtr classIdMap = NULL;\n    unsigned long long floor_sum_val = 0;\n    unsigned int taint = 0;\n    int n;\n    size_t i;\n\n\n    if ((configFile = virNetworkConfigFile(stateDir, name)) == NULL)\n        goto error;\n\n    if (!(xml = virXMLParseCtxt(configFile, NULL, _(\"(network status)\"), &ctxt)))\n        goto error;\n\n    if (!(node = virXPathNode(\"//network\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any 'network' element in status file\"));\n        goto error;\n    }\n\n    /* parse the definition first */\n    ctxt->node = node;\n    if (!(def = virNetworkDefParseXML(ctxt, xmlopt)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    /* now parse possible status data */\n    node = xmlDocGetRootElement(xml);\n    if (virXMLNodeNameEqual(node, \"networkstatus\")) {\n        /* Newer network status file. Contains useful\n         * info which are not to be found in bare config XML */\n        char *classIdStr = NULL;\n        char *floor_sum = NULL;\n\n        ctxt->node = node;\n        if ((classIdStr = virXPathString(\"string(./class_id[1]/@bitmap)\",\n                                         ctxt))) {\n            if (!(classIdMap = virBitmapParseUnlimited(classIdStr))) {\n                VIR_FREE(classIdStr);\n                goto error;\n            }\n        }\n        VIR_FREE(classIdStr);\n\n        floor_sum = virXPathString(\"string(./floor[1]/@sum)\", ctxt);\n        if (floor_sum &&\n            virStrToLong_ull(floor_sum, NULL, 10, &floor_sum_val) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Malformed 'floor_sum' attribute: %s\"),\n                           floor_sum);\n            VIR_FREE(floor_sum);\n            goto error;\n        }\n        VIR_FREE(floor_sum);\n\n        if ((n = virXPathNodeSet(\"./taint\", ctxt, &nodes)) < 0)\n            goto error;\n\n        for (i = 0; i < n; i++) {\n            char *str = virXMLPropString(nodes[i], \"flag\");\n            if (str) {\n                int flag = virNetworkTaintTypeFromString(str);\n                if (flag < 0) {\n                    virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                                   _(\"Unknown taint flag %s\"), str);\n                    VIR_FREE(str);\n                    goto error;\n                }\n                VIR_FREE(str);\n                /* Compute taint mask here. The network object does not\n                 * exist yet, so we can't use virNetworkObjtTaint. */\n                taint |= (1 << flag);\n            }\n        }\n        VIR_FREE(nodes);\n    }\n\n    /* create the object */\n    if (!(obj = virNetworkObjAssignDef(nets, def,\n                                       VIR_NETWORK_OBJ_LIST_ADD_LIVE)))\n        goto error;\n    /* do not put any \"goto error\" below this comment */\n\n    /* assign status data stored in the network object */\n    if (classIdMap) {\n        virBitmapFree(obj->classIdMap);\n        obj->classIdMap = classIdMap;\n    }\n\n    if (floor_sum_val > 0)\n        obj->floor_sum = floor_sum_val;\n\n    obj->taint = taint;\n    obj->active = true; /* network with a state file is by definition active */\n\n cleanup:\n    VIR_FREE(configFile);\n    xmlFreeDoc(xml);\n    xmlXPathFreeContext(ctxt);\n    return obj;\n\n error:\n    VIR_FREE(nodes);\n    virBitmapFree(classIdMap);\n    virNetworkDefFree(def);\n    goto cleanup;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);",
            "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nstatic virNetworkObjPtr\nvirNetworkLoadState(virNetworkObjListPtr nets,\n                    const char *stateDir,\n                    const char *name,\n                    virNetworkXMLOptionPtr xmlopt)\n{\n    char *configFile = NULL;\n    virNetworkDefPtr def = NULL;\n    virNetworkObjPtr obj = NULL;\n    xmlDocPtr xml = NULL;\n    xmlNodePtr node = NULL, *nodes = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virBitmapPtr classIdMap = NULL;\n    unsigned long long floor_sum_val = 0;\n    unsigned int taint = 0;\n    int n;\n    size_t i;\n\n\n    if ((configFile = virNetworkConfigFile(stateDir, name)) == NULL)\n        goto error;\n\n    if (!(xml = virXMLParseCtxt(configFile, NULL, _(\"(network status)\"), &ctxt)))\n        goto error;\n\n    if (!(node = virXPathNode(\"//network\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any 'network' element in status file\"));\n        goto error;\n    }\n\n    /* parse the definition first */\n    ctxt->node = node;\n    if (!(def = virNetworkDefParseXML(ctxt, xmlopt)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    /* now parse possible status data */\n    node = xmlDocGetRootElement(xml);\n    if (virXMLNodeNameEqual(node, \"networkstatus\")) {\n        /* Newer network status file. Contains useful\n         * info which are not to be found in bare config XML */\n        char *classIdStr = NULL;\n        char *floor_sum = NULL;\n\n        ctxt->node = node;\n        if ((classIdStr = virXPathString(\"string(./class_id[1]/@bitmap)\",\n                                         ctxt))) {\n            if (!(classIdMap = virBitmapParseUnlimited(classIdStr))) {\n                VIR_FREE(classIdStr);\n                goto error;\n            }\n        }\n        VIR_FREE(classIdStr);\n\n        floor_sum = virXPathString(\"string(./floor[1]/@sum)\", ctxt);\n        if (floor_sum &&\n            virStrToLong_ull(floor_sum, NULL, 10, &floor_sum_val) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Malformed 'floor_sum' attribute: %s\"),\n                           floor_sum);\n            VIR_FREE(floor_sum);\n            goto error;\n        }\n        VIR_FREE(floor_sum);\n\n        if ((n = virXPathNodeSet(\"./taint\", ctxt, &nodes)) < 0)\n            goto error;\n\n        for (i = 0; i < n; i++) {\n            char *str = virXMLPropString(nodes[i], \"flag\");\n            if (str) {\n                int flag = virNetworkTaintTypeFromString(str);\n                if (flag < 0) {\n                    virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                                   _(\"Unknown taint flag %s\"), str);\n                    VIR_FREE(str);\n                    goto error;\n                }\n                VIR_FREE(str);\n                /* Compute taint mask here. The network object does not\n                 * exist yet, so we can't use virNetworkObjtTaint. */\n                taint |= (1 << flag);\n            }\n        }\n        VIR_FREE(nodes);\n    }\n\n    /* create the object */\n    if (!(obj = virNetworkObjAssignDef(nets, def,\n                                       VIR_NETWORK_OBJ_LIST_ADD_LIVE)))\n        goto error;\n    /* do not put any \"goto error\" below this comment */\n\n    /* assign status data stored in the network object */\n    if (classIdMap) {\n        virBitmapFree(obj->classIdMap);\n        obj->classIdMap = classIdMap;\n    }\n\n    if (floor_sum_val > 0)\n        obj->floor_sum = floor_sum_val;\n\n    obj->taint = taint;\n    obj->active = true; /* network with a state file is by definition active */\n\n cleanup:\n    VIR_FREE(configFile);\n    xmlFreeDoc(xml);\n    xmlXPathFreeContext(ctxt);\n    return obj;\n\n error:\n    VIR_FREE(nodes);\n    virBitmapFree(classIdMap);\n    virNetworkDefFree(def);\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringStripSuffix",
          "args": [
            "entry->d_name",
            "\".xml\""
          ],
          "line": 1092
        },
        "resolved": true,
        "details": {
          "function_name": "virStringStripSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1123-1139",
          "snippet": "bool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&entry",
            "stateDir"
          ],
          "line": 1089
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dir",
            "stateDir"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nint\nvirNetworkObjLoadAllState(virNetworkObjListPtr nets,\n                          const char *stateDir,\n                          virNetworkXMLOptionPtr xmlopt)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, stateDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, stateDir)) > 0) {\n        virNetworkObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        obj = virNetworkLoadState(nets, stateDir, entry->d_name, xmlopt);\n\n        if (obj &&\n            virNetworkObjLoadAllPorts(obj, stateDir) < 0) {\n            virNetworkObjEndAPI(&obj);\n            goto cleanup;\n        }\n        virNetworkObjEndAPI(&obj);\n    }\n\n cleanup:\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkLoadConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "1000-1073",
    "snippet": "static virNetworkObjPtr\nvirNetworkLoadConfig(virNetworkObjListPtr nets,\n                     const char *configDir,\n                     const char *autostartDir,\n                     const char *name,\n                     virNetworkXMLOptionPtr xmlopt)\n{\n    char *configFile = NULL, *autostartLink = NULL;\n    virNetworkDefPtr def = NULL;\n    virNetworkObjPtr obj;\n    int autostart;\n\n    if ((configFile = virNetworkConfigFile(configDir, name)) == NULL)\n        goto error;\n    if ((autostartLink = virNetworkConfigFile(autostartDir, name)) == NULL)\n        goto error;\n\n    if ((autostart = virFileLinkPointsTo(autostartLink, configFile)) < 0)\n        goto error;\n\n    if (!(def = virNetworkDefParseFile(configFile, xmlopt)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        if (!def->mac_specified) {\n            virNetworkSetBridgeMacAddr(def);\n            virNetworkSaveConfig(configDir, def, xmlopt);\n        }\n        break;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        /* Throw away MAC address for other forward types,\n         * which could have been generated by older libvirt RPMs */\n        def->mac_specified = false;\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        goto error;\n    }\n\n    if (!(obj = virNetworkObjAssignDef(nets, def, 0)))\n        goto error;\n\n    obj->autostart = (autostart == 1);\n\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n\n    return obj;\n\n error:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virNetworkDefFree(def);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkDefFree",
          "args": [
            "def"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "235-274",
          "snippet": "void\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "autostartLink"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "autostartLink"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkObjAssignDef",
          "args": [
            "nets",
            "def",
            "0"
          ],
          "line": 1058
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "646-657",
          "snippet": "virNetworkObjPtr\nvirNetworkObjAssignDef(virNetworkObjListPtr nets,\n                       virNetworkDefPtr def,\n                       unsigned int flags)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockWrite(nets);\n    obj = virNetworkObjAssignDefLocked(nets, def, flags);\n    virObjectRWUnlock(nets);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkObjPtr\nvirNetworkObjAssignDef(virNetworkObjListPtr nets,\n                       virNetworkDefPtr def,\n                       unsigned int flags)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockWrite(nets);\n    obj = virNetworkObjAssignDefLocked(nets, def, flags);\n    virObjectRWUnlock(nets);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virNetworkForwardType",
            "def->forward.type"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkSaveConfig",
          "args": [
            "configDir",
            "def",
            "xmlopt"
          ],
          "line": 1038
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkSaveConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "2749-2767",
          "snippet": "int\nvirNetworkSaveConfig(const char *configDir,\n                     virNetworkDefPtr def,\n                     virNetworkXMLOptionPtr xmlopt)\n{\n    int ret = -1;\n    char *xml;\n\n    if (!(xml = virNetworkDefFormat(def, xmlopt, VIR_NETWORK_XML_INACTIVE)))\n        goto cleanup;\n\n    if (virNetworkSaveXML(configDir, def, xml))\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(xml);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetworkSaveConfig(const char *configDir,\n                     virNetworkDefPtr def,\n                     virNetworkXMLOptionPtr xmlopt)\n{\n    int ret = -1;\n    char *xml;\n\n    if (!(xml = virNetworkDefFormat(def, xmlopt, VIR_NETWORK_XML_INACTIVE)))\n        goto cleanup;\n\n    if (virNetworkSaveXML(configDir, def, xml))\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(xml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkSetBridgeMacAddr",
          "args": [
            "def"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkSetBridgeMacAddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "2781-2792",
          "snippet": "void\nvirNetworkSetBridgeMacAddr(virNetworkDefPtr def)\n{\n    if (!def->mac_specified) {\n        /* if the bridge doesn't have a mac address explicitly defined,\n         * autogenerate a random one.\n         */\n        virMacAddrGenerate((unsigned char[]){ 0x52, 0x54, 0 },\n                           &def->mac);\n        def->mac_specified = true;\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkSetBridgeMacAddr(virNetworkDefPtr def)\n{\n    if (!def->mac_specified) {\n        /* if the bridge doesn't have a mac address explicitly defined,\n         * autogenerate a random one.\n         */\n        virMacAddrGenerate((unsigned char[]){ 0x52, 0x54, 0 },\n                           &def->mac);\n        def->mac_specified = true;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\")",
            "configFile",
            "def->name"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Network config filename '%s'\"\n                         \" does not match network name '%s'\""
          ],
          "line": 1025
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "name",
            "def->name"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkDefParseFile",
          "args": [
            "configFile",
            "xmlopt"
          ],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefParseFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "2122-2127",
          "snippet": "virNetworkDefPtr\nvirNetworkDefParseFile(const char *filename,\n                       virNetworkXMLOptionPtr xmlopt)\n{\n    return virNetworkDefParse(NULL, filename, xmlopt);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetworkDefPtr\nvirNetworkDefParseFile(const char *filename,\n                       virNetworkXMLOptionPtr xmlopt)\n{\n    return virNetworkDefParse(NULL, filename, xmlopt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileLinkPointsTo",
          "args": [
            "autostartLink",
            "configFile"
          ],
          "line": 1017
        },
        "resolved": true,
        "details": {
          "function_name": "virFileLinkPointsTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1533-1543",
          "snippet": "int\nvirFileLinkPointsTo(const char *checkLink,\n                    const char *checkDest)\n{\n    struct stat src_sb;\n    struct stat dest_sb;\n\n    return (stat(checkLink, &src_sb) == 0\n            && stat(checkDest, &dest_sb) == 0\n            && SAME_INODE(src_sb, dest_sb));\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileLinkPointsTo(const char *checkLink,\n                    const char *checkDest)\n{\n    struct stat src_sb;\n    struct stat dest_sb;\n\n    return (stat(checkLink, &src_sb) == 0\n            && stat(checkDest, &dest_sb) == 0\n            && SAME_INODE(src_sb, dest_sb));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkConfigFile",
          "args": [
            "autostartDir",
            "name"
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "2770-2778",
          "snippet": "char *\nvirNetworkConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret = NULL;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirNetworkConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret = NULL;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkLoadConfig(virNetworkObjListPtr nets,\n                     const char *configDir,\n                     const char *autostartDir,\n                     const char *name,\n                     virNetworkXMLOptionPtr xmlopt)\n{\n    char *configFile = NULL, *autostartLink = NULL;\n    virNetworkDefPtr def = NULL;\n    virNetworkObjPtr obj;\n    int autostart;\n\n    if ((configFile = virNetworkConfigFile(configDir, name)) == NULL)\n        goto error;\n    if ((autostartLink = virNetworkConfigFile(autostartDir, name)) == NULL)\n        goto error;\n\n    if ((autostart = virFileLinkPointsTo(autostartLink, configFile)) < 0)\n        goto error;\n\n    if (!(def = virNetworkDefParseFile(configFile, xmlopt)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        if (!def->mac_specified) {\n            virNetworkSetBridgeMacAddr(def);\n            virNetworkSaveConfig(configDir, def, xmlopt);\n        }\n        break;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        /* Throw away MAC address for other forward types,\n         * which could have been generated by older libvirt RPMs */\n        def->mac_specified = false;\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        goto error;\n    }\n\n    if (!(obj = virNetworkObjAssignDef(nets, def, 0)))\n        goto error;\n\n    obj->autostart = (autostart == 1);\n\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n\n    return obj;\n\n error:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virNetworkDefFree(def);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkLoadState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "873-997",
    "snippet": "static virNetworkObjPtr\nvirNetworkLoadState(virNetworkObjListPtr nets,\n                    const char *stateDir,\n                    const char *name,\n                    virNetworkXMLOptionPtr xmlopt)\n{\n    char *configFile = NULL;\n    virNetworkDefPtr def = NULL;\n    virNetworkObjPtr obj = NULL;\n    xmlDocPtr xml = NULL;\n    xmlNodePtr node = NULL, *nodes = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virBitmapPtr classIdMap = NULL;\n    unsigned long long floor_sum_val = 0;\n    unsigned int taint = 0;\n    int n;\n    size_t i;\n\n\n    if ((configFile = virNetworkConfigFile(stateDir, name)) == NULL)\n        goto error;\n\n    if (!(xml = virXMLParseCtxt(configFile, NULL, _(\"(network status)\"), &ctxt)))\n        goto error;\n\n    if (!(node = virXPathNode(\"//network\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any 'network' element in status file\"));\n        goto error;\n    }\n\n    /* parse the definition first */\n    ctxt->node = node;\n    if (!(def = virNetworkDefParseXML(ctxt, xmlopt)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    /* now parse possible status data */\n    node = xmlDocGetRootElement(xml);\n    if (virXMLNodeNameEqual(node, \"networkstatus\")) {\n        /* Newer network status file. Contains useful\n         * info which are not to be found in bare config XML */\n        char *classIdStr = NULL;\n        char *floor_sum = NULL;\n\n        ctxt->node = node;\n        if ((classIdStr = virXPathString(\"string(./class_id[1]/@bitmap)\",\n                                         ctxt))) {\n            if (!(classIdMap = virBitmapParseUnlimited(classIdStr))) {\n                VIR_FREE(classIdStr);\n                goto error;\n            }\n        }\n        VIR_FREE(classIdStr);\n\n        floor_sum = virXPathString(\"string(./floor[1]/@sum)\", ctxt);\n        if (floor_sum &&\n            virStrToLong_ull(floor_sum, NULL, 10, &floor_sum_val) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Malformed 'floor_sum' attribute: %s\"),\n                           floor_sum);\n            VIR_FREE(floor_sum);\n            goto error;\n        }\n        VIR_FREE(floor_sum);\n\n        if ((n = virXPathNodeSet(\"./taint\", ctxt, &nodes)) < 0)\n            goto error;\n\n        for (i = 0; i < n; i++) {\n            char *str = virXMLPropString(nodes[i], \"flag\");\n            if (str) {\n                int flag = virNetworkTaintTypeFromString(str);\n                if (flag < 0) {\n                    virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                                   _(\"Unknown taint flag %s\"), str);\n                    VIR_FREE(str);\n                    goto error;\n                }\n                VIR_FREE(str);\n                /* Compute taint mask here. The network object does not\n                 * exist yet, so we can't use virNetworkObjtTaint. */\n                taint |= (1 << flag);\n            }\n        }\n        VIR_FREE(nodes);\n    }\n\n    /* create the object */\n    if (!(obj = virNetworkObjAssignDef(nets, def,\n                                       VIR_NETWORK_OBJ_LIST_ADD_LIVE)))\n        goto error;\n    /* do not put any \"goto error\" below this comment */\n\n    /* assign status data stored in the network object */\n    if (classIdMap) {\n        virBitmapFree(obj->classIdMap);\n        obj->classIdMap = classIdMap;\n    }\n\n    if (floor_sum_val > 0)\n        obj->floor_sum = floor_sum_val;\n\n    obj->taint = taint;\n    obj->active = true; /* network with a state file is by definition active */\n\n cleanup:\n    VIR_FREE(configFile);\n    xmlFreeDoc(xml);\n    xmlXPathFreeContext(ctxt);\n    return obj;\n\n error:\n    VIR_FREE(nodes);\n    virBitmapFree(classIdMap);\n    virNetworkDefFree(def);\n    goto cleanup;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);",
      "static int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkDefFree",
          "args": [
            "def"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "235-274",
          "snippet": "void\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "classIdMap"
          ],
          "line": 994
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodes"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeContext",
          "args": [
            "ctxt"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "xml"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkObjAssignDef",
          "args": [
            "nets",
            "def",
            "VIR_NETWORK_OBJ_LIST_ADD_LIVE"
          ],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "646-657",
          "snippet": "virNetworkObjPtr\nvirNetworkObjAssignDef(virNetworkObjListPtr nets,\n                       virNetworkDefPtr def,\n                       unsigned int flags)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockWrite(nets);\n    obj = virNetworkObjAssignDefLocked(nets, def, flags);\n    virObjectRWUnlock(nets);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkObjPtr\nvirNetworkObjAssignDef(virNetworkObjListPtr nets,\n                       virNetworkDefPtr def,\n                       unsigned int flags)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockWrite(nets);\n    obj = virNetworkObjAssignDefLocked(nets, def, flags);\n    virObjectRWUnlock(nets);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodes"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "str"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "str"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unknown taint flag %s\")",
            "str"
          ],
          "line": 954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown taint flag %s\""
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkTaintTypeFromString",
          "args": [
            "str"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "nodes[i]",
            "\"flag\""
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNodeSet",
          "args": [
            "\"./taint\"",
            "ctxt",
            "&nodes"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNodeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "647-694",
          "snippet": "int\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "floor_sum"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "floor_sum"
          ],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Malformed 'floor_sum' attribute: %s\")",
            "floor_sum"
          ],
          "line": 938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "floor_sum",
            "NULL",
            "10",
            "&floor_sum_val"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./floor[1]/@sum)\"",
            "ctxt"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "classIdStr"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "classIdStr"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapParseUnlimited",
          "args": [
            "classIdStr"
          ],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapParseUnlimited",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "605-695",
          "snippet": "virBitmapPtr\nvirBitmapParseUnlimited(const char *str)\n{\n    virBitmapPtr bitmap = virBitmapNewEmpty();\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0) {\n            if (neg) {\n                if (virBitmapClearBitExpand(bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBitExpand(bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBitExpand(bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return bitmap;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), NULLSTR(str));\n    virBitmapFree(bitmap);\n    return NULL;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapParseUnlimited(const char *str)\n{\n    virBitmapPtr bitmap = virBitmapNewEmpty();\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0) {\n            if (neg) {\n                if (virBitmapClearBitExpand(bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBitExpand(bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBitExpand(bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return bitmap;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), NULLSTR(str));\n    virBitmapFree(bitmap);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLNodeNameEqual",
          "args": [
            "node",
            "\"networkstatus\""
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeNameEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1013-1018",
          "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlDocGetRootElement",
          "args": [
            "xml"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\")",
            "configFile",
            "def->name"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "name",
            "def->name"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkDefParseXML",
          "args": [
            "ctxt",
            "xmlopt"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "1645-2092",
          "snippet": "virNetworkDefPtr\nvirNetworkDefParseXML(xmlXPathContextPtr ctxt,\n                      virNetworkXMLOptionPtr xmlopt)\n{\n    virNetworkDefPtr def;\n    char *tmp = NULL;\n    char *stp = NULL;\n    xmlNodePtr *ipNodes = NULL;\n    xmlNodePtr *routeNodes = NULL;\n    xmlNodePtr *portGroupNodes = NULL;\n    int nips, nPortGroups, nRoutes;\n    xmlNodePtr dnsNode = NULL;\n    xmlNodePtr virtPortNode = NULL;\n    xmlNodePtr forwardNode = NULL;\n    char *ipv6nogwStr = NULL;\n    char *trustGuestRxFilters = NULL;\n    xmlNodePtr save = ctxt->node;\n    xmlNodePtr bandwidthNode = NULL;\n    xmlNodePtr vlanNode;\n    xmlNodePtr metadataNode = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    /* Extract network name */\n    def->name = virXPathString(\"string(./name[1])\", ctxt);\n    if (!def->name) {\n        virReportError(VIR_ERR_NO_NAME, NULL);\n        goto error;\n    }\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"/\") < 0)\n        goto error;\n\n    /* Extract network uuid */\n    tmp = virXPathString(\"string(./uuid[1])\", ctxt);\n    if (!tmp) {\n        if (virUUIDGenerate(def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"Failed to generate UUID\"));\n            goto error;\n        }\n    } else {\n        if (virUUIDParse(tmp, def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"malformed uuid element\"));\n            goto error;\n        }\n        VIR_FREE(tmp);\n        def->uuid_specified = true;\n    }\n\n    /* check if definitions with no IPv6 gateway addresses is to\n     * allow guest-to-guest communications.\n     */\n    ipv6nogwStr = virXPathString(\"string(./@ipv6)\", ctxt);\n    if (ipv6nogwStr) {\n        if (virStringParseYesNo(ipv6nogwStr, &def->ipv6nogw) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid ipv6 setting '%s' in network '%s'\"),\n                           ipv6nogwStr, def->name);\n            goto error;\n        }\n        VIR_FREE(ipv6nogwStr);\n    }\n\n    trustGuestRxFilters\n        = virXPathString(\"string(./@trustGuestRxFilters)\", ctxt);\n    if (trustGuestRxFilters) {\n        if ((def->trustGuestRxFilters\n             = virTristateBoolTypeFromString(trustGuestRxFilters)) <= 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid trustGuestRxFilters setting '%s' \"\n                             \"in network '%s'\"),\n                           trustGuestRxFilters, def->name);\n            goto error;\n        }\n        VIR_FREE(trustGuestRxFilters);\n    }\n\n    /* Parse network domain information */\n    def->domain = virXPathString(\"string(./domain[1]/@name)\", ctxt);\n    tmp = virXPathString(\"string(./domain[1]/@localOnly)\", ctxt);\n    if (tmp) {\n        def->domainLocalOnly = virTristateBoolTypeFromString(tmp);\n        if (def->domainLocalOnly <= 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid domain localOnly setting '%s' \"\n                             \"in network '%s'\"),\n                           tmp, def->name);\n            goto error;\n        }\n        VIR_FREE(tmp);\n    }\n\n    if ((bandwidthNode = virXPathNode(\"./bandwidth\", ctxt)) &&\n        virNetDevBandwidthParse(&def->bandwidth, NULL, bandwidthNode, false) < 0)\n        goto error;\n\n    vlanNode = virXPathNode(\"./vlan\", ctxt);\n    if (vlanNode && virNetDevVlanParse(vlanNode, ctxt, &def->vlan) < 0)\n        goto error;\n\n    if (virNetworkPortOptionsParseXML(ctxt, &def->isolatedPort) < 0)\n        goto error;\n\n    /* Parse bridge information */\n    def->bridge = virXPathString(\"string(./bridge[1]/@name)\", ctxt);\n    def->bridgeZone = virXPathString(\"string(./bridge[1]/@zone)\", ctxt);\n    stp = virXPathString(\"string(./bridge[1]/@stp)\", ctxt);\n    def->stp = (stp && STREQ(stp, \"off\")) ? false : true;\n\n    tmp = virXPathString(\"string(./bridge[1]/@delay)\", ctxt);\n    if (tmp) {\n        if (virStrToLong_ulp(tmp, NULL, 10, &def->delay) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid delay value in network '%s'\"),\n                           def->name);\n            goto error;\n        }\n    }\n    VIR_FREE(tmp);\n\n    tmp = virXPathString(\"string(./bridge[1]/@macTableManager)\", ctxt);\n    if (tmp) {\n        if ((def->macTableManager\n             = virNetworkBridgeMACTableManagerTypeFromString(tmp)) <= 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid macTableManager setting '%s' \"\n                             \"in network '%s'\"), tmp, def->name);\n            goto error;\n        }\n        VIR_FREE(tmp);\n    }\n\n    tmp = virXPathString(\"string(./mac[1]/@address)\", ctxt);\n    if (tmp) {\n        if (virMacAddrParse(tmp, &def->mac) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid bridge mac address '%s' in network '%s'\"),\n                           tmp, def->name);\n            goto error;\n        }\n        if (virMacAddrIsMulticast(&def->mac)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid multicast bridge mac address '%s' in network '%s'\"),\n                           tmp, def->name);\n            goto error;\n        }\n        VIR_FREE(tmp);\n        def->mac_specified = true;\n    }\n\n    tmp = virXPathString(\"string(./mtu/@size)\", ctxt);\n    if (tmp) {\n        if (virStrToLong_ui(tmp, NULL, 10, &def->mtu) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid mtu size '%s' in network '%s'\"),\n                           tmp, def->name);\n            goto error;\n        }\n    }\n    VIR_FREE(tmp);\n\n    dnsNode = virXPathNode(\"./dns\", ctxt);\n    if (dnsNode != NULL &&\n        virNetworkDNSDefParseXML(def->name, dnsNode, ctxt, &def->dns) < 0) {\n        goto error;\n    }\n\n    virtPortNode = virXPathNode(\"./virtualport\", ctxt);\n    if (virtPortNode &&\n        (!(def->virtPortProfile = virNetDevVPortProfileParse(virtPortNode,\n                                                             VIR_VPORT_XML_REQUIRE_TYPE)))) {\n        goto error;\n    }\n\n    nPortGroups = virXPathNodeSet(\"./portgroup\", ctxt, &portGroupNodes);\n    if (nPortGroups < 0)\n        goto error;\n\n    if (nPortGroups > 0) {\n        size_t i;\n\n        /* allocate array to hold all the portgroups */\n        if (VIR_ALLOC_N(def->portGroups, nPortGroups) < 0)\n            goto error;\n        /* parse each portgroup */\n        for (i = 0; i < nPortGroups; i++) {\n            if (virNetworkPortGroupParseXML(&def->portGroups[i],\n                                            portGroupNodes[i],\n                                            ctxt) < 0)\n                goto error;\n            def->nPortGroups++;\n        }\n    }\n    VIR_FREE(portGroupNodes);\n\n    nips = virXPathNodeSet(\"./ip\", ctxt, &ipNodes);\n    if (nips < 0)\n        goto error;\n\n    if (nips > 0) {\n        size_t i;\n\n        /* allocate array to hold all the addrs */\n        if (VIR_ALLOC_N(def->ips, nips) < 0)\n            goto error;\n        /* parse each addr */\n        for (i = 0; i < nips; i++) {\n            if (virNetworkIPDefParseXML(def->name,\n                                        ipNodes[i],\n                                        ctxt,\n                                        &def->ips[i]) < 0)\n                goto error;\n            def->nips++;\n        }\n    }\n    VIR_FREE(ipNodes);\n\n    nRoutes = virXPathNodeSet(\"./route\", ctxt, &routeNodes);\n    if (nRoutes < 0)\n        goto error;\n\n    if (nRoutes > 0) {\n        size_t i;\n\n        /* allocate array to hold all the route definitions */\n        if (VIR_ALLOC_N(def->routes, nRoutes) < 0)\n            goto error;\n        /* parse each definition */\n        for (i = 0; i < nRoutes; i++) {\n            virNetDevIPRoutePtr route = NULL;\n\n            if (!(route = virNetDevIPRouteParseXML(def->name,\n                                                   routeNodes[i],\n                                                   ctxt)))\n                goto error;\n            def->routes[i] = route;\n            def->nroutes++;\n        }\n\n        /* now validate the correctness of any static route gateways specified\n         *\n         * note: the parameters within each definition are verified/assumed valid;\n         * the question being asked and answered here is if the specified gateway\n         * is directly reachable from this bridge.\n         */\n        nRoutes = def->nroutes;\n        nips = def->nips;\n        for (i = 0; i < nRoutes; i++) {\n            size_t j;\n            virSocketAddr testAddr, testGw;\n            bool addrMatch;\n            virNetDevIPRoutePtr gwdef = def->routes[i];\n            virSocketAddrPtr gateway = virNetDevIPRouteGetGateway(gwdef);\n            addrMatch = false;\n            for (j = 0; j < nips; j++) {\n                virNetworkIPDefPtr def2 = &def->ips[j];\n                if (VIR_SOCKET_ADDR_FAMILY(gateway)\n                    != VIR_SOCKET_ADDR_FAMILY(&def2->address)) {\n                    continue;\n                }\n                int prefix = virNetworkIPDefPrefix(def2);\n                virSocketAddrMaskByPrefix(&def2->address, prefix, &testAddr);\n                virSocketAddrMaskByPrefix(gateway, prefix, &testGw);\n                if (VIR_SOCKET_ADDR_VALID(&testAddr) &&\n                    VIR_SOCKET_ADDR_VALID(&testGw) &&\n                    virSocketAddrEqual(&testAddr, &testGw)) {\n                    addrMatch = true;\n                    break;\n                }\n            }\n            if (!addrMatch) {\n                char *gw = virSocketAddrFormat(gateway);\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"unreachable static route gateway '%s' specified for network '%s'\"),\n                               gw, def->name);\n                VIR_FREE(gw);\n                goto error;\n            }\n        }\n    }\n    VIR_FREE(routeNodes);\n\n    forwardNode = virXPathNode(\"./forward\", ctxt);\n    if (forwardNode &&\n        virNetworkForwardDefParseXML(def->name, forwardNode, ctxt, &def->forward) < 0) {\n        goto error;\n    }\n\n    /* Validate some items in the main NetworkDef that need to align\n     * with the chosen forward mode.\n     */\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n        break;\n\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_OPEN:\n        /* It's pointless to specify L3 forwarding without specifying\n         * the network we're on.\n         */\n        if (def->nips == 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s forwarding requested, \"\n                             \"but no IP address provided for network '%s'\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        if (def->forward.nifs > 1) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"multiple forwarding interfaces specified \"\n                             \"for network '%s', only one is supported\"),\n                           def->name);\n            goto error;\n        }\n\n        if (def->forward.type == VIR_NETWORK_FORWARD_OPEN && def->forward.nifs) {\n            /* an open network by definition can't place any restrictions\n             * on what traffic is allowed or where it goes, so specifying\n             * a forwarding device is nonsensical.\n             */\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"forward dev not allowed for \"\n                             \"network '%s' with forward mode='%s'\"),\n                           def->name,\n                           virNetworkForwardTypeToString(def->forward.type));\n            goto error;\n        }\n        break;\n\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        if (def->bridge) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"bridge name not allowed in %s mode (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        if (def->bridgeZone) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"bridge zone not allowed in %s mode (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        if (def->macTableManager) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"bridge macTableManager setting not allowed \"\n                             \"in %s mode (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n        if (def->delay || stp || def->bridgeZone) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"bridge delay/stp/zone options only allowed in \"\n                             \"route, nat, and isolated mode, not in %s \"\n                             \"(network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        if (def->bridge && (def->forward.nifs || def->forward.npfs)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"A network with forward mode='%s' can specify \"\n                             \"a bridge name or a forward dev, but not \"\n                             \"both (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        goto error;\n    }\n\n    VIR_FREE(stp);\n\n    if (def->mtu) {\n        switch ((virNetworkForwardType) def->forward.type) {\n        case VIR_NETWORK_FORWARD_NONE:\n        case VIR_NETWORK_FORWARD_NAT:\n        case VIR_NETWORK_FORWARD_ROUTE:\n        case VIR_NETWORK_FORWARD_OPEN:\n            break;\n\n        case VIR_NETWORK_FORWARD_BRIDGE:\n        case VIR_NETWORK_FORWARD_PRIVATE:\n        case VIR_NETWORK_FORWARD_VEPA:\n        case VIR_NETWORK_FORWARD_PASSTHROUGH:\n        case VIR_NETWORK_FORWARD_HOSTDEV:\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"mtu size only allowed in open, route, nat, \"\n                             \"and isolated mode, not in %s (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n\n        case VIR_NETWORK_FORWARD_LAST:\n        default:\n            virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n            goto error;\n        }\n    }\n\n    /* Extract custom metadata */\n    if ((metadataNode = virXPathNode(\"./metadata[1]\", ctxt)) != NULL) {\n        def->metadata = xmlCopyNode(metadataNode, 1);\n        virXMLNodeSanitizeNamespaces(def->metadata);\n    }\n\n    if (xmlopt)\n        def->ns = xmlopt->ns;\n    if (def->ns.parse) {\n        if (virXMLNamespaceRegister(ctxt, &def->ns) < 0)\n            goto error;\n        if ((def->ns.parse)(ctxt, &def->namespaceData) < 0)\n            goto error;\n    }\n\n    ctxt->node = save;\n    return def;\n\n error:\n    VIR_FREE(tmp);\n    VIR_FREE(routeNodes);\n    VIR_FREE(stp);\n    virNetworkDefFree(def);\n    VIR_FREE(ipNodes);\n    VIR_FREE(portGroupNodes);\n    VIR_FREE(ipv6nogwStr);\n    VIR_FREE(trustGuestRxFilters);\n    ctxt->node = save;\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetworkDefPtr\nvirNetworkDefParseXML(xmlXPathContextPtr ctxt,\n                      virNetworkXMLOptionPtr xmlopt)\n{\n    virNetworkDefPtr def;\n    char *tmp = NULL;\n    char *stp = NULL;\n    xmlNodePtr *ipNodes = NULL;\n    xmlNodePtr *routeNodes = NULL;\n    xmlNodePtr *portGroupNodes = NULL;\n    int nips, nPortGroups, nRoutes;\n    xmlNodePtr dnsNode = NULL;\n    xmlNodePtr virtPortNode = NULL;\n    xmlNodePtr forwardNode = NULL;\n    char *ipv6nogwStr = NULL;\n    char *trustGuestRxFilters = NULL;\n    xmlNodePtr save = ctxt->node;\n    xmlNodePtr bandwidthNode = NULL;\n    xmlNodePtr vlanNode;\n    xmlNodePtr metadataNode = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    /* Extract network name */\n    def->name = virXPathString(\"string(./name[1])\", ctxt);\n    if (!def->name) {\n        virReportError(VIR_ERR_NO_NAME, NULL);\n        goto error;\n    }\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"/\") < 0)\n        goto error;\n\n    /* Extract network uuid */\n    tmp = virXPathString(\"string(./uuid[1])\", ctxt);\n    if (!tmp) {\n        if (virUUIDGenerate(def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"Failed to generate UUID\"));\n            goto error;\n        }\n    } else {\n        if (virUUIDParse(tmp, def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"malformed uuid element\"));\n            goto error;\n        }\n        VIR_FREE(tmp);\n        def->uuid_specified = true;\n    }\n\n    /* check if definitions with no IPv6 gateway addresses is to\n     * allow guest-to-guest communications.\n     */\n    ipv6nogwStr = virXPathString(\"string(./@ipv6)\", ctxt);\n    if (ipv6nogwStr) {\n        if (virStringParseYesNo(ipv6nogwStr, &def->ipv6nogw) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid ipv6 setting '%s' in network '%s'\"),\n                           ipv6nogwStr, def->name);\n            goto error;\n        }\n        VIR_FREE(ipv6nogwStr);\n    }\n\n    trustGuestRxFilters\n        = virXPathString(\"string(./@trustGuestRxFilters)\", ctxt);\n    if (trustGuestRxFilters) {\n        if ((def->trustGuestRxFilters\n             = virTristateBoolTypeFromString(trustGuestRxFilters)) <= 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid trustGuestRxFilters setting '%s' \"\n                             \"in network '%s'\"),\n                           trustGuestRxFilters, def->name);\n            goto error;\n        }\n        VIR_FREE(trustGuestRxFilters);\n    }\n\n    /* Parse network domain information */\n    def->domain = virXPathString(\"string(./domain[1]/@name)\", ctxt);\n    tmp = virXPathString(\"string(./domain[1]/@localOnly)\", ctxt);\n    if (tmp) {\n        def->domainLocalOnly = virTristateBoolTypeFromString(tmp);\n        if (def->domainLocalOnly <= 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid domain localOnly setting '%s' \"\n                             \"in network '%s'\"),\n                           tmp, def->name);\n            goto error;\n        }\n        VIR_FREE(tmp);\n    }\n\n    if ((bandwidthNode = virXPathNode(\"./bandwidth\", ctxt)) &&\n        virNetDevBandwidthParse(&def->bandwidth, NULL, bandwidthNode, false) < 0)\n        goto error;\n\n    vlanNode = virXPathNode(\"./vlan\", ctxt);\n    if (vlanNode && virNetDevVlanParse(vlanNode, ctxt, &def->vlan) < 0)\n        goto error;\n\n    if (virNetworkPortOptionsParseXML(ctxt, &def->isolatedPort) < 0)\n        goto error;\n\n    /* Parse bridge information */\n    def->bridge = virXPathString(\"string(./bridge[1]/@name)\", ctxt);\n    def->bridgeZone = virXPathString(\"string(./bridge[1]/@zone)\", ctxt);\n    stp = virXPathString(\"string(./bridge[1]/@stp)\", ctxt);\n    def->stp = (stp && STREQ(stp, \"off\")) ? false : true;\n\n    tmp = virXPathString(\"string(./bridge[1]/@delay)\", ctxt);\n    if (tmp) {\n        if (virStrToLong_ulp(tmp, NULL, 10, &def->delay) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid delay value in network '%s'\"),\n                           def->name);\n            goto error;\n        }\n    }\n    VIR_FREE(tmp);\n\n    tmp = virXPathString(\"string(./bridge[1]/@macTableManager)\", ctxt);\n    if (tmp) {\n        if ((def->macTableManager\n             = virNetworkBridgeMACTableManagerTypeFromString(tmp)) <= 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid macTableManager setting '%s' \"\n                             \"in network '%s'\"), tmp, def->name);\n            goto error;\n        }\n        VIR_FREE(tmp);\n    }\n\n    tmp = virXPathString(\"string(./mac[1]/@address)\", ctxt);\n    if (tmp) {\n        if (virMacAddrParse(tmp, &def->mac) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid bridge mac address '%s' in network '%s'\"),\n                           tmp, def->name);\n            goto error;\n        }\n        if (virMacAddrIsMulticast(&def->mac)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid multicast bridge mac address '%s' in network '%s'\"),\n                           tmp, def->name);\n            goto error;\n        }\n        VIR_FREE(tmp);\n        def->mac_specified = true;\n    }\n\n    tmp = virXPathString(\"string(./mtu/@size)\", ctxt);\n    if (tmp) {\n        if (virStrToLong_ui(tmp, NULL, 10, &def->mtu) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"Invalid mtu size '%s' in network '%s'\"),\n                           tmp, def->name);\n            goto error;\n        }\n    }\n    VIR_FREE(tmp);\n\n    dnsNode = virXPathNode(\"./dns\", ctxt);\n    if (dnsNode != NULL &&\n        virNetworkDNSDefParseXML(def->name, dnsNode, ctxt, &def->dns) < 0) {\n        goto error;\n    }\n\n    virtPortNode = virXPathNode(\"./virtualport\", ctxt);\n    if (virtPortNode &&\n        (!(def->virtPortProfile = virNetDevVPortProfileParse(virtPortNode,\n                                                             VIR_VPORT_XML_REQUIRE_TYPE)))) {\n        goto error;\n    }\n\n    nPortGroups = virXPathNodeSet(\"./portgroup\", ctxt, &portGroupNodes);\n    if (nPortGroups < 0)\n        goto error;\n\n    if (nPortGroups > 0) {\n        size_t i;\n\n        /* allocate array to hold all the portgroups */\n        if (VIR_ALLOC_N(def->portGroups, nPortGroups) < 0)\n            goto error;\n        /* parse each portgroup */\n        for (i = 0; i < nPortGroups; i++) {\n            if (virNetworkPortGroupParseXML(&def->portGroups[i],\n                                            portGroupNodes[i],\n                                            ctxt) < 0)\n                goto error;\n            def->nPortGroups++;\n        }\n    }\n    VIR_FREE(portGroupNodes);\n\n    nips = virXPathNodeSet(\"./ip\", ctxt, &ipNodes);\n    if (nips < 0)\n        goto error;\n\n    if (nips > 0) {\n        size_t i;\n\n        /* allocate array to hold all the addrs */\n        if (VIR_ALLOC_N(def->ips, nips) < 0)\n            goto error;\n        /* parse each addr */\n        for (i = 0; i < nips; i++) {\n            if (virNetworkIPDefParseXML(def->name,\n                                        ipNodes[i],\n                                        ctxt,\n                                        &def->ips[i]) < 0)\n                goto error;\n            def->nips++;\n        }\n    }\n    VIR_FREE(ipNodes);\n\n    nRoutes = virXPathNodeSet(\"./route\", ctxt, &routeNodes);\n    if (nRoutes < 0)\n        goto error;\n\n    if (nRoutes > 0) {\n        size_t i;\n\n        /* allocate array to hold all the route definitions */\n        if (VIR_ALLOC_N(def->routes, nRoutes) < 0)\n            goto error;\n        /* parse each definition */\n        for (i = 0; i < nRoutes; i++) {\n            virNetDevIPRoutePtr route = NULL;\n\n            if (!(route = virNetDevIPRouteParseXML(def->name,\n                                                   routeNodes[i],\n                                                   ctxt)))\n                goto error;\n            def->routes[i] = route;\n            def->nroutes++;\n        }\n\n        /* now validate the correctness of any static route gateways specified\n         *\n         * note: the parameters within each definition are verified/assumed valid;\n         * the question being asked and answered here is if the specified gateway\n         * is directly reachable from this bridge.\n         */\n        nRoutes = def->nroutes;\n        nips = def->nips;\n        for (i = 0; i < nRoutes; i++) {\n            size_t j;\n            virSocketAddr testAddr, testGw;\n            bool addrMatch;\n            virNetDevIPRoutePtr gwdef = def->routes[i];\n            virSocketAddrPtr gateway = virNetDevIPRouteGetGateway(gwdef);\n            addrMatch = false;\n            for (j = 0; j < nips; j++) {\n                virNetworkIPDefPtr def2 = &def->ips[j];\n                if (VIR_SOCKET_ADDR_FAMILY(gateway)\n                    != VIR_SOCKET_ADDR_FAMILY(&def2->address)) {\n                    continue;\n                }\n                int prefix = virNetworkIPDefPrefix(def2);\n                virSocketAddrMaskByPrefix(&def2->address, prefix, &testAddr);\n                virSocketAddrMaskByPrefix(gateway, prefix, &testGw);\n                if (VIR_SOCKET_ADDR_VALID(&testAddr) &&\n                    VIR_SOCKET_ADDR_VALID(&testGw) &&\n                    virSocketAddrEqual(&testAddr, &testGw)) {\n                    addrMatch = true;\n                    break;\n                }\n            }\n            if (!addrMatch) {\n                char *gw = virSocketAddrFormat(gateway);\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"unreachable static route gateway '%s' specified for network '%s'\"),\n                               gw, def->name);\n                VIR_FREE(gw);\n                goto error;\n            }\n        }\n    }\n    VIR_FREE(routeNodes);\n\n    forwardNode = virXPathNode(\"./forward\", ctxt);\n    if (forwardNode &&\n        virNetworkForwardDefParseXML(def->name, forwardNode, ctxt, &def->forward) < 0) {\n        goto error;\n    }\n\n    /* Validate some items in the main NetworkDef that need to align\n     * with the chosen forward mode.\n     */\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n        break;\n\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_OPEN:\n        /* It's pointless to specify L3 forwarding without specifying\n         * the network we're on.\n         */\n        if (def->nips == 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s forwarding requested, \"\n                             \"but no IP address provided for network '%s'\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        if (def->forward.nifs > 1) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"multiple forwarding interfaces specified \"\n                             \"for network '%s', only one is supported\"),\n                           def->name);\n            goto error;\n        }\n\n        if (def->forward.type == VIR_NETWORK_FORWARD_OPEN && def->forward.nifs) {\n            /* an open network by definition can't place any restrictions\n             * on what traffic is allowed or where it goes, so specifying\n             * a forwarding device is nonsensical.\n             */\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"forward dev not allowed for \"\n                             \"network '%s' with forward mode='%s'\"),\n                           def->name,\n                           virNetworkForwardTypeToString(def->forward.type));\n            goto error;\n        }\n        break;\n\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        if (def->bridge) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"bridge name not allowed in %s mode (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        if (def->bridgeZone) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"bridge zone not allowed in %s mode (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        if (def->macTableManager) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"bridge macTableManager setting not allowed \"\n                             \"in %s mode (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n        if (def->delay || stp || def->bridgeZone) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"bridge delay/stp/zone options only allowed in \"\n                             \"route, nat, and isolated mode, not in %s \"\n                             \"(network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        if (def->bridge && (def->forward.nifs || def->forward.npfs)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"A network with forward mode='%s' can specify \"\n                             \"a bridge name or a forward dev, but not \"\n                             \"both (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n        }\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        goto error;\n    }\n\n    VIR_FREE(stp);\n\n    if (def->mtu) {\n        switch ((virNetworkForwardType) def->forward.type) {\n        case VIR_NETWORK_FORWARD_NONE:\n        case VIR_NETWORK_FORWARD_NAT:\n        case VIR_NETWORK_FORWARD_ROUTE:\n        case VIR_NETWORK_FORWARD_OPEN:\n            break;\n\n        case VIR_NETWORK_FORWARD_BRIDGE:\n        case VIR_NETWORK_FORWARD_PRIVATE:\n        case VIR_NETWORK_FORWARD_VEPA:\n        case VIR_NETWORK_FORWARD_PASSTHROUGH:\n        case VIR_NETWORK_FORWARD_HOSTDEV:\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"mtu size only allowed in open, route, nat, \"\n                             \"and isolated mode, not in %s (network '%s')\"),\n                           virNetworkForwardTypeToString(def->forward.type),\n                           def->name);\n            goto error;\n\n        case VIR_NETWORK_FORWARD_LAST:\n        default:\n            virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n            goto error;\n        }\n    }\n\n    /* Extract custom metadata */\n    if ((metadataNode = virXPathNode(\"./metadata[1]\", ctxt)) != NULL) {\n        def->metadata = xmlCopyNode(metadataNode, 1);\n        virXMLNodeSanitizeNamespaces(def->metadata);\n    }\n\n    if (xmlopt)\n        def->ns = xmlopt->ns;\n    if (def->ns.parse) {\n        if (virXMLNamespaceRegister(ctxt, &def->ns) < 0)\n            goto error;\n        if ((def->ns.parse)(ctxt, &def->namespaceData) < 0)\n            goto error;\n    }\n\n    ctxt->node = save;\n    return def;\n\n error:\n    VIR_FREE(tmp);\n    VIR_FREE(routeNodes);\n    VIR_FREE(stp);\n    virNetworkDefFree(def);\n    VIR_FREE(ipNodes);\n    VIR_FREE(portGroupNodes);\n    VIR_FREE(ipv6nogwStr);\n    VIR_FREE(trustGuestRxFilters);\n    ctxt->node = save;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not find any 'network' element in status file\")"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"//network\"",
            "ctxt"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLParseCtxt",
          "args": [
            "configFile",
            "NULL",
            "_(\"(network status)\")",
            "&ctxt"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkConfigFile",
          "args": [
            "stateDir",
            "name"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "2770-2778",
          "snippet": "char *\nvirNetworkConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret = NULL;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirNetworkConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret = NULL;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\nstatic int\nvirNetworkObjLoadAllPorts(virNetworkObjPtr net,\n                          const char *stateDir);\n\nstatic virNetworkObjPtr\nvirNetworkLoadState(virNetworkObjListPtr nets,\n                    const char *stateDir,\n                    const char *name,\n                    virNetworkXMLOptionPtr xmlopt)\n{\n    char *configFile = NULL;\n    virNetworkDefPtr def = NULL;\n    virNetworkObjPtr obj = NULL;\n    xmlDocPtr xml = NULL;\n    xmlNodePtr node = NULL, *nodes = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    virBitmapPtr classIdMap = NULL;\n    unsigned long long floor_sum_val = 0;\n    unsigned int taint = 0;\n    int n;\n    size_t i;\n\n\n    if ((configFile = virNetworkConfigFile(stateDir, name)) == NULL)\n        goto error;\n\n    if (!(xml = virXMLParseCtxt(configFile, NULL, _(\"(network status)\"), &ctxt)))\n        goto error;\n\n    if (!(node = virXPathNode(\"//network\", ctxt))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not find any 'network' element in status file\"));\n        goto error;\n    }\n\n    /* parse the definition first */\n    ctxt->node = node;\n    if (!(def = virNetworkDefParseXML(ctxt, xmlopt)))\n        goto error;\n\n    if (STRNEQ(name, def->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Network config filename '%s'\"\n                         \" does not match network name '%s'\"),\n                       configFile, def->name);\n        goto error;\n    }\n\n    /* now parse possible status data */\n    node = xmlDocGetRootElement(xml);\n    if (virXMLNodeNameEqual(node, \"networkstatus\")) {\n        /* Newer network status file. Contains useful\n         * info which are not to be found in bare config XML */\n        char *classIdStr = NULL;\n        char *floor_sum = NULL;\n\n        ctxt->node = node;\n        if ((classIdStr = virXPathString(\"string(./class_id[1]/@bitmap)\",\n                                         ctxt))) {\n            if (!(classIdMap = virBitmapParseUnlimited(classIdStr))) {\n                VIR_FREE(classIdStr);\n                goto error;\n            }\n        }\n        VIR_FREE(classIdStr);\n\n        floor_sum = virXPathString(\"string(./floor[1]/@sum)\", ctxt);\n        if (floor_sum &&\n            virStrToLong_ull(floor_sum, NULL, 10, &floor_sum_val) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Malformed 'floor_sum' attribute: %s\"),\n                           floor_sum);\n            VIR_FREE(floor_sum);\n            goto error;\n        }\n        VIR_FREE(floor_sum);\n\n        if ((n = virXPathNodeSet(\"./taint\", ctxt, &nodes)) < 0)\n            goto error;\n\n        for (i = 0; i < n; i++) {\n            char *str = virXMLPropString(nodes[i], \"flag\");\n            if (str) {\n                int flag = virNetworkTaintTypeFromString(str);\n                if (flag < 0) {\n                    virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                                   _(\"Unknown taint flag %s\"), str);\n                    VIR_FREE(str);\n                    goto error;\n                }\n                VIR_FREE(str);\n                /* Compute taint mask here. The network object does not\n                 * exist yet, so we can't use virNetworkObjtTaint. */\n                taint |= (1 << flag);\n            }\n        }\n        VIR_FREE(nodes);\n    }\n\n    /* create the object */\n    if (!(obj = virNetworkObjAssignDef(nets, def,\n                                       VIR_NETWORK_OBJ_LIST_ADD_LIVE)))\n        goto error;\n    /* do not put any \"goto error\" below this comment */\n\n    /* assign status data stored in the network object */\n    if (classIdMap) {\n        virBitmapFree(obj->classIdMap);\n        obj->classIdMap = classIdMap;\n    }\n\n    if (floor_sum_val > 0)\n        obj->floor_sum = floor_sum_val;\n\n    obj->taint = taint;\n    obj->active = true; /* network with a state file is by definition active */\n\n cleanup:\n    VIR_FREE(configFile);\n    xmlFreeDoc(xml);\n    xmlXPathFreeContext(ctxt);\n    return obj;\n\n error:\n    VIR_FREE(nodes);\n    virBitmapFree(classIdMap);\n    virNetworkDefFree(def);\n    goto cleanup;\n}"
  },
  {
    "function_name": "virNetworkObjSaveStatus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "851-870",
    "snippet": "int\nvirNetworkObjSaveStatus(const char *statusDir,\n                        virNetworkObjPtr obj,\n                        virNetworkXMLOptionPtr xmlopt)\n{\n    int ret = -1;\n    int flags = 0;\n    char *xml;\n\n    if (!(xml = virNetworkObjFormat(obj, xmlopt, flags)))\n        goto cleanup;\n\n    if (virNetworkSaveXML(statusDir, obj->def, xml))\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(xml);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "xml"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkSaveXML",
          "args": [
            "statusDir",
            "obj->def",
            "xml"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkSaveXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "2719-2746",
          "snippet": "int\nvirNetworkSaveXML(const char *configDir,\n                  virNetworkDefPtr def,\n                  const char *xml)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *configFile = NULL;\n    int ret = -1;\n\n    if ((configFile = virNetworkConfigFile(configDir, def->name)) == NULL)\n        goto cleanup;\n\n    if (virFileMakePath(configDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot create config directory '%s'\"),\n                             configDir);\n        goto cleanup;\n    }\n\n    virUUIDFormat(def->uuid, uuidstr);\n    ret = virXMLSaveFile(configFile,\n                         virXMLPickShellSafeComment(def->name, uuidstr),\n                         \"net-edit\", xml);\n\n cleanup:\n    VIR_FREE(configFile);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetworkSaveXML(const char *configDir,\n                  virNetworkDefPtr def,\n                  const char *xml)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *configFile = NULL;\n    int ret = -1;\n\n    if ((configFile = virNetworkConfigFile(configDir, def->name)) == NULL)\n        goto cleanup;\n\n    if (virFileMakePath(configDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot create config directory '%s'\"),\n                             configDir);\n        goto cleanup;\n    }\n\n    virUUIDFormat(def->uuid, uuidstr);\n    ret = virXMLSaveFile(configFile,\n                         virXMLPickShellSafeComment(def->name, uuidstr),\n                         \"net-edit\", xml);\n\n cleanup:\n    VIR_FREE(configFile);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjFormat",
          "args": [
            "obj",
            "xmlopt",
            "flags"
          ],
          "line": 860
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "813-848",
          "snippet": "static char *\nvirNetworkObjFormat(virNetworkObjPtr obj,\n                    virNetworkXMLOptionPtr xmlopt,\n                    unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *classIdStr = virBitmapFormat(obj->classIdMap);\n    size_t i;\n\n    if (!classIdStr)\n        goto error;\n\n    virBufferAddLit(&buf, \"<networkstatus>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n    virBufferAsprintf(&buf, \"<class_id bitmap='%s'/>\\n\", classIdStr);\n    virBufferAsprintf(&buf, \"<floor sum='%llu'/>\\n\", obj->floor_sum);\n    VIR_FREE(classIdStr);\n\n    for (i = 0; i < VIR_NETWORK_TAINT_LAST; i++) {\n        if (obj->taint & (1 << i))\n            virBufferAsprintf(&buf, \"<taint flag='%s'/>\\n\",\n                              virNetworkTaintTypeToString(i));\n    }\n\n    if (virNetworkDefFormatBuf(&buf, obj->def, xmlopt, flags) < 0)\n        goto error;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</networkstatus>\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic char *\nvirNetworkObjFormat(virNetworkObjPtr obj,\n                    virNetworkXMLOptionPtr xmlopt,\n                    unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *classIdStr = virBitmapFormat(obj->classIdMap);\n    size_t i;\n\n    if (!classIdStr)\n        goto error;\n\n    virBufferAddLit(&buf, \"<networkstatus>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n    virBufferAsprintf(&buf, \"<class_id bitmap='%s'/>\\n\", classIdStr);\n    virBufferAsprintf(&buf, \"<floor sum='%llu'/>\\n\", obj->floor_sum);\n    VIR_FREE(classIdStr);\n\n    for (i = 0; i < VIR_NETWORK_TAINT_LAST; i++) {\n        if (obj->taint & (1 << i))\n            virBufferAsprintf(&buf, \"<taint flag='%s'/>\\n\",\n                              virNetworkTaintTypeToString(i));\n    }\n\n    if (virNetworkDefFormatBuf(&buf, obj->def, xmlopt, flags) < 0)\n        goto error;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</networkstatus>\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjSaveStatus(const char *statusDir,\n                        virNetworkObjPtr obj,\n                        virNetworkXMLOptionPtr xmlopt)\n{\n    int ret = -1;\n    int flags = 0;\n    char *xml;\n\n    if (!(xml = virNetworkObjFormat(obj, xmlopt, flags)))\n        goto cleanup;\n\n    if (virNetworkSaveXML(statusDir, obj->def, xml))\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(xml);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "813-848",
    "snippet": "static char *\nvirNetworkObjFormat(virNetworkObjPtr obj,\n                    virNetworkXMLOptionPtr xmlopt,\n                    unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *classIdStr = virBitmapFormat(obj->classIdMap);\n    size_t i;\n\n    if (!classIdStr)\n        goto error;\n\n    virBufferAddLit(&buf, \"<networkstatus>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n    virBufferAsprintf(&buf, \"<class_id bitmap='%s'/>\\n\", classIdStr);\n    virBufferAsprintf(&buf, \"<floor sum='%llu'/>\\n\", obj->floor_sum);\n    VIR_FREE(classIdStr);\n\n    for (i = 0; i < VIR_NETWORK_TAINT_LAST; i++) {\n        if (obj->taint & (1 << i))\n            virBufferAsprintf(&buf, \"<taint flag='%s'/>\\n\",\n                              virNetworkTaintTypeToString(i));\n    }\n\n    if (virNetworkDefFormatBuf(&buf, obj->def, xmlopt, flags) < 0)\n        goto error;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</networkstatus>\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</networkstatus>\""
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "&buf",
            "-2"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkDefFormatBuf",
          "args": [
            "&buf",
            "obj->def",
            "xmlopt",
            "flags"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "2440-2670",
          "snippet": "int\nvirNetworkDefFormatBuf(virBufferPtr buf,\n                       const virNetworkDef *def,\n                       virNetworkXMLOptionPtr xmlopt G_GNUC_UNUSED,\n                       unsigned int flags)\n{\n    const unsigned char *uuid;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    size_t i;\n    bool shortforward;\n    bool hasbridge = false;\n\n    virBufferAddLit(buf, \"<network\");\n    if (def->namespaceData && def->ns.format)\n        virXMLNamespaceFormatNS(buf, &def->ns);\n    if (!(flags & VIR_NETWORK_XML_INACTIVE) && (def->connections > 0))\n        virBufferAsprintf(buf, \" connections='%d'\", def->connections);\n    if (def->ipv6nogw)\n        virBufferAddLit(buf, \" ipv6='yes'\");\n    if (def->trustGuestRxFilters)\n        virBufferAsprintf(buf, \" trustGuestRxFilters='%s'\",\n                          virTristateBoolTypeToString(def->trustGuestRxFilters));\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->name);\n\n    uuid = def->uuid;\n    virUUIDFormat(uuid, uuidstr);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n\n    if (def->metadata) {\n        xmlBufferPtr xmlbuf;\n        int oldIndentTreeOutput = xmlIndentTreeOutput;\n\n        /* Indentation on output requires that we previously set\n         * xmlKeepBlanksDefault to 0 when parsing; also, libxml does 2\n         * spaces per level of indentation of intermediate elements,\n         * but no leading indentation before the starting element.\n         * Thankfully, libxml maps what looks like globals into\n         * thread-local uses, so we are thread-safe.  */\n        xmlIndentTreeOutput = 1;\n        xmlbuf = xmlBufferCreate();\n        if (xmlNodeDump(xmlbuf, def->metadata->doc, def->metadata,\n                        virBufferGetIndent(buf) / 2, 1) < 0) {\n            xmlBufferFree(xmlbuf);\n            xmlIndentTreeOutput = oldIndentTreeOutput;\n            return -1;\n        }\n        virBufferAsprintf(buf, \"%s\\n\", (char *) xmlBufferContent(xmlbuf));\n        xmlBufferFree(xmlbuf);\n        xmlIndentTreeOutput = oldIndentTreeOutput;\n    }\n\n    if (def->forward.type != VIR_NETWORK_FORWARD_NONE) {\n        const char *dev = NULL;\n        if (!def->forward.npfs)\n            dev = virNetworkDefForwardIf(def, 0);\n        const char *mode = virNetworkForwardTypeToString(def->forward.type);\n\n        if (!mode) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unknown forward type %d in network '%s'\"),\n                           def->forward.type, def->name);\n            return -1;\n        }\n        virBufferAddLit(buf, \"<forward\");\n        virBufferEscapeString(buf, \" dev='%s'\", dev);\n        virBufferAsprintf(buf, \" mode='%s'\", mode);\n        if (def->forward.type == VIR_NETWORK_FORWARD_HOSTDEV) {\n            if (def->forward.managed)\n                virBufferAddLit(buf, \" managed='yes'\");\n            else\n                virBufferAddLit(buf, \" managed='no'\");\n        }\n        shortforward = !(def->forward.nifs || def->forward.npfs\n                         || VIR_SOCKET_ADDR_VALID(&def->forward.addr.start)\n                         || VIR_SOCKET_ADDR_VALID(&def->forward.addr.end)\n                         || def->forward.port.start\n                         || def->forward.port.end\n                         || (def->forward.driverName\n                             != VIR_NETWORK_FORWARD_DRIVER_NAME_DEFAULT));\n        virBufferAsprintf(buf, \"%s>\\n\", shortforward ? \"/\" : \"\");\n        virBufferAdjustIndent(buf, 2);\n\n        if (def->forward.driverName\n            != VIR_NETWORK_FORWARD_DRIVER_NAME_DEFAULT) {\n            const char *driverName\n                = virNetworkForwardDriverNameTypeToString(def->forward.driverName);\n            if (!driverName) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"unexpected hostdev driver name type %d \"),\n                               def->forward.driverName);\n                return -1;\n            }\n            virBufferAsprintf(buf, \"<driver name='%s'/>\\n\", driverName);\n        }\n        if (def->forward.type == VIR_NETWORK_FORWARD_NAT) {\n            if (virNetworkForwardNatDefFormat(buf, &def->forward) < 0)\n                return -1;\n        }\n\n        /* For now, hard-coded to at most 1 forward.pfs */\n        if (def->forward.npfs)\n            virBufferEscapeString(buf, \"<pf dev='%s'/>\\n\",\n                                  def->forward.pfs[0].dev);\n\n        if (def->forward.nifs &&\n            (!def->forward.npfs || !(flags & VIR_NETWORK_XML_INACTIVE))) {\n            for (i = 0; i < def->forward.nifs; i++) {\n                if (def->forward.ifs[i].type == VIR_NETWORK_FORWARD_HOSTDEV_DEVICE_NETDEV) {\n                    virBufferEscapeString(buf, \"<interface dev='%s'\",\n                                          def->forward.ifs[i].device.dev);\n                    if (!(flags & VIR_NETWORK_XML_INACTIVE) &&\n                        (def->forward.ifs[i].connections > 0)) {\n                        virBufferAsprintf(buf, \" connections='%d'\",\n                                          def->forward.ifs[i].connections);\n                    }\n                    virBufferAddLit(buf, \"/>\\n\");\n                } else {\n                    if (def->forward.ifs[i].type ==  VIR_NETWORK_FORWARD_HOSTDEV_DEVICE_PCI) {\n                        virPCIDeviceAddressFormat(buf,\n                                                  def->forward.ifs[i].device.pci,\n                                                  true);\n                    }\n                }\n            }\n        }\n        virBufferAdjustIndent(buf, -2);\n        if (!shortforward)\n            virBufferAddLit(buf, \"</forward>\\n\");\n    }\n\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        hasbridge = true;\n        break;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        return -1;\n    }\n\n    if (hasbridge || def->bridge || def->macTableManager) {\n        virBufferAddLit(buf, \"<bridge\");\n        virBufferEscapeString(buf, \" name='%s'\", def->bridge);\n        virBufferEscapeString(buf, \" zone='%s'\", def->bridgeZone);\n        if (hasbridge)\n            virBufferAsprintf(buf, \" stp='%s' delay='%ld'\",\n                              def->stp ? \"on\" : \"off\", def->delay);\n        if (def->macTableManager) {\n            virBufferAsprintf(buf, \" macTableManager='%s'\",\n                             virNetworkBridgeMACTableManagerTypeToString(def->macTableManager));\n        }\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->mtu)\n        virBufferAsprintf(buf, \"<mtu size='%u'/>\\n\", def->mtu);\n\n    if (def->mac_specified) {\n        char macaddr[VIR_MAC_STRING_BUFLEN];\n        virMacAddrFormat(&def->mac, macaddr);\n        virBufferAsprintf(buf, \"<mac address='%s'/>\\n\", macaddr);\n    }\n\n    if (def->domain) {\n        virBufferAsprintf(buf, \"<domain name='%s'\", def->domain);\n\n        /* default to \"no\", but don't format it in the XML */\n        if (def->domainLocalOnly) {\n            const char *local = virTristateBoolTypeToString(def->domainLocalOnly);\n\n            if (!local) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unknown localOnly type %d in network\"),\n                               def->domainLocalOnly);\n                return -1;\n            }\n            virBufferAsprintf(buf, \" localOnly='%s'\", local);\n        }\n\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (virNetworkDNSDefFormat(buf, &def->dns) < 0)\n        return -1;\n\n    if (virNetDevVlanFormat(&def->vlan, buf) < 0)\n        return -1;\n    if (virNetDevBandwidthFormat(def->bandwidth, 0, buf) < 0)\n        return -1;\n    virNetworkPortOptionsFormat(def->isolatedPort, buf);\n\n    for (i = 0; i < def->nips; i++) {\n        if (virNetworkIPDefFormat(buf, &def->ips[i]) < 0)\n            return -1;\n    }\n\n    for (i = 0; i < def->nroutes; i++) {\n        if (virNetDevIPRouteFormat(buf, def->routes[i]) < 0)\n            return -1;\n    }\n\n    if (virNetDevVPortProfileFormat(def->virtPortProfile, buf) < 0)\n        return -1;\n\n    for (i = 0; i < def->nPortGroups; i++)\n        if (virPortGroupDefFormat(buf, &def->portGroups[i]) < 0)\n            return -1;\n\n    if (def->namespaceData && def->ns.format) {\n        if ((def->ns.format)(buf, def->namespaceData) < 0)\n            return -1;\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</network>\\n\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetworkDefFormatBuf(virBufferPtr buf,\n                       const virNetworkDef *def,\n                       virNetworkXMLOptionPtr xmlopt G_GNUC_UNUSED,\n                       unsigned int flags)\n{\n    const unsigned char *uuid;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    size_t i;\n    bool shortforward;\n    bool hasbridge = false;\n\n    virBufferAddLit(buf, \"<network\");\n    if (def->namespaceData && def->ns.format)\n        virXMLNamespaceFormatNS(buf, &def->ns);\n    if (!(flags & VIR_NETWORK_XML_INACTIVE) && (def->connections > 0))\n        virBufferAsprintf(buf, \" connections='%d'\", def->connections);\n    if (def->ipv6nogw)\n        virBufferAddLit(buf, \" ipv6='yes'\");\n    if (def->trustGuestRxFilters)\n        virBufferAsprintf(buf, \" trustGuestRxFilters='%s'\",\n                          virTristateBoolTypeToString(def->trustGuestRxFilters));\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->name);\n\n    uuid = def->uuid;\n    virUUIDFormat(uuid, uuidstr);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n\n    if (def->metadata) {\n        xmlBufferPtr xmlbuf;\n        int oldIndentTreeOutput = xmlIndentTreeOutput;\n\n        /* Indentation on output requires that we previously set\n         * xmlKeepBlanksDefault to 0 when parsing; also, libxml does 2\n         * spaces per level of indentation of intermediate elements,\n         * but no leading indentation before the starting element.\n         * Thankfully, libxml maps what looks like globals into\n         * thread-local uses, so we are thread-safe.  */\n        xmlIndentTreeOutput = 1;\n        xmlbuf = xmlBufferCreate();\n        if (xmlNodeDump(xmlbuf, def->metadata->doc, def->metadata,\n                        virBufferGetIndent(buf) / 2, 1) < 0) {\n            xmlBufferFree(xmlbuf);\n            xmlIndentTreeOutput = oldIndentTreeOutput;\n            return -1;\n        }\n        virBufferAsprintf(buf, \"%s\\n\", (char *) xmlBufferContent(xmlbuf));\n        xmlBufferFree(xmlbuf);\n        xmlIndentTreeOutput = oldIndentTreeOutput;\n    }\n\n    if (def->forward.type != VIR_NETWORK_FORWARD_NONE) {\n        const char *dev = NULL;\n        if (!def->forward.npfs)\n            dev = virNetworkDefForwardIf(def, 0);\n        const char *mode = virNetworkForwardTypeToString(def->forward.type);\n\n        if (!mode) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unknown forward type %d in network '%s'\"),\n                           def->forward.type, def->name);\n            return -1;\n        }\n        virBufferAddLit(buf, \"<forward\");\n        virBufferEscapeString(buf, \" dev='%s'\", dev);\n        virBufferAsprintf(buf, \" mode='%s'\", mode);\n        if (def->forward.type == VIR_NETWORK_FORWARD_HOSTDEV) {\n            if (def->forward.managed)\n                virBufferAddLit(buf, \" managed='yes'\");\n            else\n                virBufferAddLit(buf, \" managed='no'\");\n        }\n        shortforward = !(def->forward.nifs || def->forward.npfs\n                         || VIR_SOCKET_ADDR_VALID(&def->forward.addr.start)\n                         || VIR_SOCKET_ADDR_VALID(&def->forward.addr.end)\n                         || def->forward.port.start\n                         || def->forward.port.end\n                         || (def->forward.driverName\n                             != VIR_NETWORK_FORWARD_DRIVER_NAME_DEFAULT));\n        virBufferAsprintf(buf, \"%s>\\n\", shortforward ? \"/\" : \"\");\n        virBufferAdjustIndent(buf, 2);\n\n        if (def->forward.driverName\n            != VIR_NETWORK_FORWARD_DRIVER_NAME_DEFAULT) {\n            const char *driverName\n                = virNetworkForwardDriverNameTypeToString(def->forward.driverName);\n            if (!driverName) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"unexpected hostdev driver name type %d \"),\n                               def->forward.driverName);\n                return -1;\n            }\n            virBufferAsprintf(buf, \"<driver name='%s'/>\\n\", driverName);\n        }\n        if (def->forward.type == VIR_NETWORK_FORWARD_NAT) {\n            if (virNetworkForwardNatDefFormat(buf, &def->forward) < 0)\n                return -1;\n        }\n\n        /* For now, hard-coded to at most 1 forward.pfs */\n        if (def->forward.npfs)\n            virBufferEscapeString(buf, \"<pf dev='%s'/>\\n\",\n                                  def->forward.pfs[0].dev);\n\n        if (def->forward.nifs &&\n            (!def->forward.npfs || !(flags & VIR_NETWORK_XML_INACTIVE))) {\n            for (i = 0; i < def->forward.nifs; i++) {\n                if (def->forward.ifs[i].type == VIR_NETWORK_FORWARD_HOSTDEV_DEVICE_NETDEV) {\n                    virBufferEscapeString(buf, \"<interface dev='%s'\",\n                                          def->forward.ifs[i].device.dev);\n                    if (!(flags & VIR_NETWORK_XML_INACTIVE) &&\n                        (def->forward.ifs[i].connections > 0)) {\n                        virBufferAsprintf(buf, \" connections='%d'\",\n                                          def->forward.ifs[i].connections);\n                    }\n                    virBufferAddLit(buf, \"/>\\n\");\n                } else {\n                    if (def->forward.ifs[i].type ==  VIR_NETWORK_FORWARD_HOSTDEV_DEVICE_PCI) {\n                        virPCIDeviceAddressFormat(buf,\n                                                  def->forward.ifs[i].device.pci,\n                                                  true);\n                    }\n                }\n            }\n        }\n        virBufferAdjustIndent(buf, -2);\n        if (!shortforward)\n            virBufferAddLit(buf, \"</forward>\\n\");\n    }\n\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        hasbridge = true;\n        break;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        return -1;\n    }\n\n    if (hasbridge || def->bridge || def->macTableManager) {\n        virBufferAddLit(buf, \"<bridge\");\n        virBufferEscapeString(buf, \" name='%s'\", def->bridge);\n        virBufferEscapeString(buf, \" zone='%s'\", def->bridgeZone);\n        if (hasbridge)\n            virBufferAsprintf(buf, \" stp='%s' delay='%ld'\",\n                              def->stp ? \"on\" : \"off\", def->delay);\n        if (def->macTableManager) {\n            virBufferAsprintf(buf, \" macTableManager='%s'\",\n                             virNetworkBridgeMACTableManagerTypeToString(def->macTableManager));\n        }\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->mtu)\n        virBufferAsprintf(buf, \"<mtu size='%u'/>\\n\", def->mtu);\n\n    if (def->mac_specified) {\n        char macaddr[VIR_MAC_STRING_BUFLEN];\n        virMacAddrFormat(&def->mac, macaddr);\n        virBufferAsprintf(buf, \"<mac address='%s'/>\\n\", macaddr);\n    }\n\n    if (def->domain) {\n        virBufferAsprintf(buf, \"<domain name='%s'\", def->domain);\n\n        /* default to \"no\", but don't format it in the XML */\n        if (def->domainLocalOnly) {\n            const char *local = virTristateBoolTypeToString(def->domainLocalOnly);\n\n            if (!local) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unknown localOnly type %d in network\"),\n                               def->domainLocalOnly);\n                return -1;\n            }\n            virBufferAsprintf(buf, \" localOnly='%s'\", local);\n        }\n\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (virNetworkDNSDefFormat(buf, &def->dns) < 0)\n        return -1;\n\n    if (virNetDevVlanFormat(&def->vlan, buf) < 0)\n        return -1;\n    if (virNetDevBandwidthFormat(def->bandwidth, 0, buf) < 0)\n        return -1;\n    virNetworkPortOptionsFormat(def->isolatedPort, buf);\n\n    for (i = 0; i < def->nips; i++) {\n        if (virNetworkIPDefFormat(buf, &def->ips[i]) < 0)\n            return -1;\n    }\n\n    for (i = 0; i < def->nroutes; i++) {\n        if (virNetDevIPRouteFormat(buf, def->routes[i]) < 0)\n            return -1;\n    }\n\n    if (virNetDevVPortProfileFormat(def->virtPortProfile, buf) < 0)\n        return -1;\n\n    for (i = 0; i < def->nPortGroups; i++)\n        if (virPortGroupDefFormat(buf, &def->portGroups[i]) < 0)\n            return -1;\n\n    if (def->namespaceData && def->ns.format) {\n        if ((def->ns.format)(buf, def->namespaceData) < 0)\n            return -1;\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</network>\\n\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\"<taint flag='%s'/>\\n\"",
            "virNetworkTaintTypeToString(i)"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkTaintTypeToString",
          "args": [
            "i"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "classIdStr"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<networkstatus>\\n\""
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapFormat",
          "args": [
            "obj->classIdMap"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "404-442",
          "snippet": "char *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic char *\nvirNetworkObjFormat(virNetworkObjPtr obj,\n                    virNetworkXMLOptionPtr xmlopt,\n                    unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char *classIdStr = virBitmapFormat(obj->classIdMap);\n    size_t i;\n\n    if (!classIdStr)\n        goto error;\n\n    virBufferAddLit(&buf, \"<networkstatus>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n    virBufferAsprintf(&buf, \"<class_id bitmap='%s'/>\\n\", classIdStr);\n    virBufferAsprintf(&buf, \"<floor sum='%llu'/>\\n\", obj->floor_sum);\n    VIR_FREE(classIdStr);\n\n    for (i = 0; i < VIR_NETWORK_TAINT_LAST; i++) {\n        if (obj->taint & (1 << i))\n            virBufferAsprintf(&buf, \"<taint flag='%s'/>\\n\",\n                              virNetworkTaintTypeToString(i));\n    }\n\n    if (virNetworkDefFormatBuf(&buf, obj->def, xmlopt, flags) < 0)\n        goto error;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</networkstatus>\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkObjRemoveInactive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "796-810",
    "snippet": "void\nvirNetworkObjRemoveInactive(virNetworkObjListPtr nets,\n                            virNetworkObjPtr obj)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(obj->def->uuid, uuidstr);\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n    virObjectRWLockWrite(nets);\n    virObjectLock(obj);\n    virHashRemoveEntry(nets->objs, uuidstr);\n    virObjectRWUnlock(nets);\n    virObjectUnref(obj);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 809
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "nets->objs",
            "uuidstr"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "nets"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "obj->def->uuid",
            "uuidstr"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjRemoveInactive(virNetworkObjListPtr nets,\n                            virNetworkObjPtr obj)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(obj->def->uuid, uuidstr);\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n    virObjectRWLockWrite(nets);\n    virObjectLock(obj);\n    virHashRemoveEntry(nets->objs, uuidstr);\n    virObjectRWUnlock(nets);\n    virObjectUnref(obj);\n}"
  },
  {
    "function_name": "virNetworkObjConfigChangeSetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "763-793",
    "snippet": "static int\nvirNetworkObjConfigChangeSetup(virNetworkObjPtr obj,\n                               virNetworkXMLOptionPtr xmlopt,\n                               unsigned int flags)\n{\n    bool isActive;\n\n    isActive = virNetworkObjIsActive(obj);\n\n    if (!isActive && (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"network is not running\"));\n        return -1;\n    }\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_CONFIG) {\n        if (!obj->persistent) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"cannot change persistent config of a \"\n                             \"transient network\"));\n            return -1;\n        }\n        /* this should already have been done by the driver, but do it\n         * anyway just in case.\n         */\n        if (isActive && (virNetworkObjSetDefTransient(obj, false, xmlopt) < 0))\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkObjSetDefTransient",
          "args": [
            "obj",
            "false",
            "xmlopt"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjSetDefTransient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "674-689",
          "snippet": "int\nvirNetworkObjSetDefTransient(virNetworkObjPtr obj,\n                             bool live,\n                             virNetworkXMLOptionPtr xmlopt)\n{\n    if (!virNetworkObjIsActive(obj) && !live)\n        return 0;\n\n    if (!obj->persistent || obj->newDef)\n        return 0;\n\n    obj->newDef = virNetworkDefCopy(obj->def,\n                                    xmlopt,\n                                    VIR_NETWORK_XML_INACTIVE);\n    return obj->newDef ? 0 : -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjSetDefTransient(virNetworkObjPtr obj,\n                             bool live,\n                             virNetworkXMLOptionPtr xmlopt)\n{\n    if (!virNetworkObjIsActive(obj) && !live)\n        return 0;\n\n    if (!obj->persistent || obj->newDef)\n        return 0;\n\n    obj->newDef = virNetworkDefCopy(obj->def,\n                                    xmlopt,\n                                    VIR_NETWORK_XML_INACTIVE);\n    return obj->newDef ? 0 : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cannot change persistent config of a \"\n                             \"transient network\")"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot change persistent config of a \"\n                             \"transient network\""
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"network is not running\")"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkObjIsActive",
          "args": [
            "obj"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "170-174",
          "snippet": "bool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic int\nvirNetworkObjConfigChangeSetup(virNetworkObjPtr obj,\n                               virNetworkXMLOptionPtr xmlopt,\n                               unsigned int flags)\n{\n    bool isActive;\n\n    isActive = virNetworkObjIsActive(obj);\n\n    if (!isActive && (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"network is not running\"));\n        return -1;\n    }\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_CONFIG) {\n        if (!obj->persistent) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"cannot change persistent config of a \"\n                             \"transient network\"));\n            return -1;\n        }\n        /* this should already have been done by the driver, but do it\n         * anyway just in case.\n         */\n        if (isActive && (virNetworkObjSetDefTransient(obj, false, xmlopt) < 0))\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjReplacePersistentDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "737-749",
    "snippet": "int\nvirNetworkObjReplacePersistentDef(virNetworkObjPtr obj,\n                                  virNetworkDefPtr def)\n{\n    if (virNetworkObjIsActive(obj)) {\n        virNetworkDefFree(obj->newDef);\n        obj->newDef = def;\n    } else {\n        virNetworkDefFree(obj->def);\n        obj->def = def;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkDefFree",
          "args": [
            "obj->def"
          ],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "235-274",
          "snippet": "void\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjIsActive",
          "args": [
            "obj"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "170-174",
          "snippet": "bool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjReplacePersistentDef(virNetworkObjPtr obj,\n                                  virNetworkDefPtr def)\n{\n    if (virNetworkObjIsActive(obj)) {\n        virNetworkDefFree(obj->newDef);\n        obj->newDef = def;\n    } else {\n        virNetworkDefFree(obj->def);\n        obj->def = def;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkObjGetPersistentDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "716-723",
    "snippet": "virNetworkDefPtr\nvirNetworkObjGetPersistentDef(virNetworkObjPtr obj)\n{\n    if (obj->newDef)\n        return obj->newDef;\n    else\n        return obj->def;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkDefPtr\nvirNetworkObjGetPersistentDef(virNetworkObjPtr obj)\n{\n    if (obj->newDef)\n        return obj->newDef;\n    else\n        return obj->def;\n}"
  },
  {
    "function_name": "virNetworkObjUnsetDefTransient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "696-704",
    "snippet": "void\nvirNetworkObjUnsetDefTransient(virNetworkObjPtr obj)\n{\n    if (obj->newDef) {\n        virNetworkDefFree(obj->def);\n        obj->def = obj->newDef;\n        obj->newDef = NULL;\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkDefFree",
          "args": [
            "obj->def"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "235-274",
          "snippet": "void\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjUnsetDefTransient(virNetworkObjPtr obj)\n{\n    if (obj->newDef) {\n        virNetworkDefFree(obj->def);\n        obj->def = obj->newDef;\n        obj->newDef = NULL;\n    }\n}"
  },
  {
    "function_name": "virNetworkObjSetDefTransient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "674-689",
    "snippet": "int\nvirNetworkObjSetDefTransient(virNetworkObjPtr obj,\n                             bool live,\n                             virNetworkXMLOptionPtr xmlopt)\n{\n    if (!virNetworkObjIsActive(obj) && !live)\n        return 0;\n\n    if (!obj->persistent || obj->newDef)\n        return 0;\n\n    obj->newDef = virNetworkDefCopy(obj->def,\n                                    xmlopt,\n                                    VIR_NETWORK_XML_INACTIVE);\n    return obj->newDef ? 0 : -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkDefCopy",
          "args": [
            "obj->def",
            "xmlopt",
            "VIR_NETWORK_XML_INACTIVE"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "286-307",
          "snippet": "virNetworkDefPtr\nvirNetworkDefCopy(virNetworkDefPtr def,\n                  virNetworkXMLOptionPtr xmlopt,\n                  unsigned int flags)\n{\n    char *xml = NULL;\n    virNetworkDefPtr newDef = NULL;\n\n    if (!def) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"NULL NetworkDef\"));\n        return NULL;\n    }\n\n    /* deep copy with a format/parse cycle */\n    if (!(xml = virNetworkDefFormat(def, xmlopt, flags)))\n        goto cleanup;\n    newDef = virNetworkDefParseString(xml, xmlopt);\n cleanup:\n    VIR_FREE(xml);\n    return newDef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNetworkDefPtr\nvirNetworkDefCopy(virNetworkDefPtr def,\n                  virNetworkXMLOptionPtr xmlopt,\n                  unsigned int flags)\n{\n    char *xml = NULL;\n    virNetworkDefPtr newDef = NULL;\n\n    if (!def) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"NULL NetworkDef\"));\n        return NULL;\n    }\n\n    /* deep copy with a format/parse cycle */\n    if (!(xml = virNetworkDefFormat(def, xmlopt, flags)))\n        goto cleanup;\n    newDef = virNetworkDefParseString(xml, xmlopt);\n cleanup:\n    VIR_FREE(xml);\n    return newDef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjIsActive",
          "args": [
            "obj"
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "170-174",
          "snippet": "bool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjSetDefTransient(virNetworkObjPtr obj,\n                             bool live,\n                             virNetworkXMLOptionPtr xmlopt)\n{\n    if (!virNetworkObjIsActive(obj) && !live)\n        return 0;\n\n    if (!obj->persistent || obj->newDef)\n        return 0;\n\n    obj->newDef = virNetworkDefCopy(obj->def,\n                                    xmlopt,\n                                    VIR_NETWORK_XML_INACTIVE);\n    return obj->newDef ? 0 : -1;\n}"
  },
  {
    "function_name": "virNetworkObjAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "646-657",
    "snippet": "virNetworkObjPtr\nvirNetworkObjAssignDef(virNetworkObjListPtr nets,\n                       virNetworkDefPtr def,\n                       unsigned int flags)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockWrite(nets);\n    obj = virNetworkObjAssignDefLocked(nets, def, flags);\n    virObjectRWUnlock(nets);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjAssignDefLocked",
          "args": [
            "nets",
            "def",
            "flags"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjAssignDefLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "567-628",
          "snippet": "static virNetworkObjPtr\nvirNetworkObjAssignDefLocked(virNetworkObjListPtr nets,\n                             virNetworkDefPtr def,\n                             unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkObjPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    /* See if a network with matching UUID already exists */\n    if ((obj = virNetworkObjFindByUUIDLocked(nets, def->uuid))) {\n        virObjectLock(obj);\n        /* UUID matches, but if names don't match, refuse it */\n        if (STRNEQ(obj->def->name, def->name)) {\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"network '%s' is already defined with uuid %s\"),\n                           obj->def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (flags & VIR_NETWORK_OBJ_LIST_ADD_CHECK_LIVE) {\n            /* UUID & name match, but if network is already active, refuse it */\n            if (virNetworkObjIsActive(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"network is already active as '%s'\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n        }\n\n        virNetworkObjUpdateAssignDef(obj, def,\n                                     !!(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE));\n    } else {\n        /* UUID does not match, but if a name matches, refuse it */\n        if ((obj = virNetworkObjFindByNameLocked(nets, def->name))) {\n            virObjectLock(obj);\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"network '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (!(obj = virNetworkObjNew()))\n              goto cleanup;\n\n        virUUIDFormat(def->uuid, uuidstr);\n        if (virHashAddEntry(nets->objs, uuidstr, obj) < 0)\n            goto cleanup;\n        virObjectRef(obj);\n\n        obj->def = def;\n        obj->persistent = !(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE);\n    }\n\n    ret = g_steal_pointer(&obj);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkObjAssignDefLocked(virNetworkObjListPtr nets,\n                             virNetworkDefPtr def,\n                             unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkObjPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    /* See if a network with matching UUID already exists */\n    if ((obj = virNetworkObjFindByUUIDLocked(nets, def->uuid))) {\n        virObjectLock(obj);\n        /* UUID matches, but if names don't match, refuse it */\n        if (STRNEQ(obj->def->name, def->name)) {\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"network '%s' is already defined with uuid %s\"),\n                           obj->def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (flags & VIR_NETWORK_OBJ_LIST_ADD_CHECK_LIVE) {\n            /* UUID & name match, but if network is already active, refuse it */\n            if (virNetworkObjIsActive(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"network is already active as '%s'\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n        }\n\n        virNetworkObjUpdateAssignDef(obj, def,\n                                     !!(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE));\n    } else {\n        /* UUID does not match, but if a name matches, refuse it */\n        if ((obj = virNetworkObjFindByNameLocked(nets, def->name))) {\n            virObjectLock(obj);\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"network '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (!(obj = virNetworkObjNew()))\n              goto cleanup;\n\n        virUUIDFormat(def->uuid, uuidstr);\n        if (virHashAddEntry(nets->objs, uuidstr, obj) < 0)\n            goto cleanup;\n        virObjectRef(obj);\n\n        obj->def = def;\n        obj->persistent = !(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE);\n    }\n\n    ret = g_steal_pointer(&obj);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "nets"
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkObjPtr\nvirNetworkObjAssignDef(virNetworkObjListPtr nets,\n                       virNetworkDefPtr def,\n                       unsigned int flags)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockWrite(nets);\n    obj = virNetworkObjAssignDefLocked(nets, def, flags);\n    virObjectRWUnlock(nets);\n    return obj;\n}"
  },
  {
    "function_name": "virNetworkObjAssignDefLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "567-628",
    "snippet": "static virNetworkObjPtr\nvirNetworkObjAssignDefLocked(virNetworkObjListPtr nets,\n                             virNetworkDefPtr def,\n                             unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkObjPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    /* See if a network with matching UUID already exists */\n    if ((obj = virNetworkObjFindByUUIDLocked(nets, def->uuid))) {\n        virObjectLock(obj);\n        /* UUID matches, but if names don't match, refuse it */\n        if (STRNEQ(obj->def->name, def->name)) {\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"network '%s' is already defined with uuid %s\"),\n                           obj->def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (flags & VIR_NETWORK_OBJ_LIST_ADD_CHECK_LIVE) {\n            /* UUID & name match, but if network is already active, refuse it */\n            if (virNetworkObjIsActive(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"network is already active as '%s'\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n        }\n\n        virNetworkObjUpdateAssignDef(obj, def,\n                                     !!(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE));\n    } else {\n        /* UUID does not match, but if a name matches, refuse it */\n        if ((obj = virNetworkObjFindByNameLocked(nets, def->name))) {\n            virObjectLock(obj);\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"network '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (!(obj = virNetworkObjNew()))\n              goto cleanup;\n\n        virUUIDFormat(def->uuid, uuidstr);\n        if (virHashAddEntry(nets->objs, uuidstr, obj) < 0)\n            goto cleanup;\n        virObjectRef(obj);\n\n        obj->def = def;\n        obj->persistent = !(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE);\n    }\n\n    ret = g_steal_pointer(&obj);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "136-145",
          "snippet": "void\nvirNetworkObjEndAPI(virNetworkObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjEndAPI(virNetworkObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&obj"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "nets->objs",
            "uuidstr",
            "obj"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuidstr"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjNew",
          "args": [],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "102-133",
          "snippet": "virNetworkObjPtr\nvirNetworkObjNew(void)\n{\n    virNetworkObjPtr obj;\n\n    if (virNetworkObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virNetworkObjClass)))\n        return NULL;\n\n    if (!(obj->classIdMap = virBitmapNew(INIT_CLASS_ID_BITMAP_SIZE)))\n        goto error;\n\n    /* The first three class IDs are already taken */\n    if (virBitmapSetBitExpand(obj->classIdMap, 0) < 0 ||\n        virBitmapSetBitExpand(obj->classIdMap, 1) < 0 ||\n        virBitmapSetBitExpand(obj->classIdMap, 2) < 0)\n        goto error;\n\n    if (!(obj->ports = virHashCreate(10,\n                                     virNetworkObjPortFree)))\n        goto error;\n\n    virObjectLock(obj);\n\n    return obj;\n\n error:\n    virObjectUnref(obj);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define INIT_CLASS_ID_BITMAP_SIZE (1<<4)"
          ],
          "globals_used": [
            "static virClassPtr virNetworkObjClass;",
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\n#define INIT_CLASS_ID_BITMAP_SIZE (1<<4)\n\nstatic virClassPtr virNetworkObjClass;\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkObjPtr\nvirNetworkObjNew(void)\n{\n    virNetworkObjPtr obj;\n\n    if (virNetworkObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virNetworkObjClass)))\n        return NULL;\n\n    if (!(obj->classIdMap = virBitmapNew(INIT_CLASS_ID_BITMAP_SIZE)))\n        goto error;\n\n    /* The first three class IDs are already taken */\n    if (virBitmapSetBitExpand(obj->classIdMap, 0) < 0 ||\n        virBitmapSetBitExpand(obj->classIdMap, 1) < 0 ||\n        virBitmapSetBitExpand(obj->classIdMap, 2) < 0)\n        goto error;\n\n    if (!(obj->ports = virHashCreate(10,\n                                     virNetworkObjPortFree)))\n        goto error;\n\n    virObjectLock(obj);\n\n    return obj;\n\n error:\n    virObjectUnref(obj);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"network '%s' already exists with uuid %s\")",
            "def->name",
            "uuidstr"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"network '%s' already exists with uuid %s\""
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjFindByNameLocked",
          "args": [
            "nets",
            "def->name"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjFindByNameLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "421-431",
          "snippet": "static virNetworkObjPtr\nvirNetworkObjFindByNameLocked(virNetworkObjListPtr nets,\n                              const char *name)\n{\n    virNetworkObjPtr obj = NULL;\n\n    obj = virHashSearch(nets->objs, virNetworkObjSearchName, name, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkObjFindByNameLocked(virNetworkObjListPtr nets,\n                              const char *name)\n{\n    virNetworkObjPtr obj = NULL;\n\n    obj = virHashSearch(nets->objs, virNetworkObjSearchName, name, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjUpdateAssignDef",
          "args": [
            "obj",
            "def",
            "!!(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE)"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjUpdateAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "511-554",
          "snippet": "void\nvirNetworkObjUpdateAssignDef(virNetworkObjPtr obj,\n                             virNetworkDefPtr def,\n                             bool live)\n{\n    if (live) {\n        /* before setting new live def, save (into newDef) any\n         * existing persistent (!live) def to be restored when the\n         * network is destroyed, unless there is one already saved.\n         */\n        if (obj->persistent && !obj->newDef)\n            obj->newDef = obj->def;\n        else\n            virNetworkDefFree(obj->def);\n        obj->def = def;\n    } else { /* !live */\n        virNetworkDefFree(obj->newDef);\n        if (virNetworkObjIsActive(obj)) {\n            /* save new configuration to be restored on network\n             * shutdown, leaving current live def alone\n             */\n            obj->newDef = def;\n        } else { /* !live and !active */\n            if (obj->def && !obj->persistent) {\n                /* network isn't (yet) marked active or persistent,\n                 * but already has a \"live\" def set. This means we are\n                 * currently setting the persistent def as a part of\n                 * the process of starting the network, so we need to\n                 * preserve the \"not yet live\" def in network->def.\n                 */\n                obj->newDef = def;\n            } else {\n                /* either there is no live def set, or this network\n                 * was already set as persistent, so the proper thing\n                 * is to overwrite network->def.\n                 */\n                obj->newDef = NULL;\n                virNetworkDefFree(obj->def);\n                obj->def = def;\n            }\n        }\n        obj->persistent = !!def;\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjUpdateAssignDef(virNetworkObjPtr obj,\n                             virNetworkDefPtr def,\n                             bool live)\n{\n    if (live) {\n        /* before setting new live def, save (into newDef) any\n         * existing persistent (!live) def to be restored when the\n         * network is destroyed, unless there is one already saved.\n         */\n        if (obj->persistent && !obj->newDef)\n            obj->newDef = obj->def;\n        else\n            virNetworkDefFree(obj->def);\n        obj->def = def;\n    } else { /* !live */\n        virNetworkDefFree(obj->newDef);\n        if (virNetworkObjIsActive(obj)) {\n            /* save new configuration to be restored on network\n             * shutdown, leaving current live def alone\n             */\n            obj->newDef = def;\n        } else { /* !live and !active */\n            if (obj->def && !obj->persistent) {\n                /* network isn't (yet) marked active or persistent,\n                 * but already has a \"live\" def set. This means we are\n                 * currently setting the persistent def as a part of\n                 * the process of starting the network, so we need to\n                 * preserve the \"not yet live\" def in network->def.\n                 */\n                obj->newDef = def;\n            } else {\n                /* either there is no live def set, or this network\n                 * was already set as persistent, so the proper thing\n                 * is to overwrite network->def.\n                 */\n                obj->newDef = NULL;\n                virNetworkDefFree(obj->def);\n                obj->def = def;\n            }\n        }\n        obj->persistent = !!def;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"network is already active as '%s'\")",
            "obj->def->name"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkObjIsActive",
          "args": [
            "obj"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "170-174",
          "snippet": "bool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"network '%s' is already defined with uuid %s\")",
            "obj->def->name",
            "uuidstr"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "obj->def->name",
            "def->name"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkObjFindByUUIDLocked",
          "args": [
            "nets",
            "def->uuid"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjFindByUUIDLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "364-377",
          "snippet": "static virNetworkObjPtr\nvirNetworkObjFindByUUIDLocked(virNetworkObjListPtr nets,\n                              const unsigned char *uuid)\n{\n    virNetworkObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    obj = virHashLookup(nets->objs, uuidstr);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkObjFindByUUIDLocked(virNetworkObjListPtr nets,\n                              const unsigned char *uuid)\n{\n    virNetworkObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    obj = virHashLookup(nets->objs, uuidstr);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkObjAssignDefLocked(virNetworkObjListPtr nets,\n                             virNetworkDefPtr def,\n                             unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkObjPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    /* See if a network with matching UUID already exists */\n    if ((obj = virNetworkObjFindByUUIDLocked(nets, def->uuid))) {\n        virObjectLock(obj);\n        /* UUID matches, but if names don't match, refuse it */\n        if (STRNEQ(obj->def->name, def->name)) {\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"network '%s' is already defined with uuid %s\"),\n                           obj->def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (flags & VIR_NETWORK_OBJ_LIST_ADD_CHECK_LIVE) {\n            /* UUID & name match, but if network is already active, refuse it */\n            if (virNetworkObjIsActive(obj)) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"network is already active as '%s'\"),\n                               obj->def->name);\n                goto cleanup;\n            }\n        }\n\n        virNetworkObjUpdateAssignDef(obj, def,\n                                     !!(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE));\n    } else {\n        /* UUID does not match, but if a name matches, refuse it */\n        if ((obj = virNetworkObjFindByNameLocked(nets, def->name))) {\n            virObjectLock(obj);\n            virUUIDFormat(obj->def->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"network '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            goto cleanup;\n        }\n\n        if (!(obj = virNetworkObjNew()))\n              goto cleanup;\n\n        virUUIDFormat(def->uuid, uuidstr);\n        if (virHashAddEntry(nets->objs, uuidstr, obj) < 0)\n            goto cleanup;\n        virObjectRef(obj);\n\n        obj->def = def;\n        obj->persistent = !(flags & VIR_NETWORK_OBJ_LIST_ADD_LIVE);\n    }\n\n    ret = g_steal_pointer(&obj);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjUpdateAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "511-554",
    "snippet": "void\nvirNetworkObjUpdateAssignDef(virNetworkObjPtr obj,\n                             virNetworkDefPtr def,\n                             bool live)\n{\n    if (live) {\n        /* before setting new live def, save (into newDef) any\n         * existing persistent (!live) def to be restored when the\n         * network is destroyed, unless there is one already saved.\n         */\n        if (obj->persistent && !obj->newDef)\n            obj->newDef = obj->def;\n        else\n            virNetworkDefFree(obj->def);\n        obj->def = def;\n    } else { /* !live */\n        virNetworkDefFree(obj->newDef);\n        if (virNetworkObjIsActive(obj)) {\n            /* save new configuration to be restored on network\n             * shutdown, leaving current live def alone\n             */\n            obj->newDef = def;\n        } else { /* !live and !active */\n            if (obj->def && !obj->persistent) {\n                /* network isn't (yet) marked active or persistent,\n                 * but already has a \"live\" def set. This means we are\n                 * currently setting the persistent def as a part of\n                 * the process of starting the network, so we need to\n                 * preserve the \"not yet live\" def in network->def.\n                 */\n                obj->newDef = def;\n            } else {\n                /* either there is no live def set, or this network\n                 * was already set as persistent, so the proper thing\n                 * is to overwrite network->def.\n                 */\n                obj->newDef = NULL;\n                virNetworkDefFree(obj->def);\n                obj->def = def;\n            }\n        }\n        obj->persistent = !!def;\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkDefFree",
          "args": [
            "obj->def"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "235-274",
          "snippet": "void\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjIsActive",
          "args": [
            "obj"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "170-174",
          "snippet": "bool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjUpdateAssignDef(virNetworkObjPtr obj,\n                             virNetworkDefPtr def,\n                             bool live)\n{\n    if (live) {\n        /* before setting new live def, save (into newDef) any\n         * existing persistent (!live) def to be restored when the\n         * network is destroyed, unless there is one already saved.\n         */\n        if (obj->persistent && !obj->newDef)\n            obj->newDef = obj->def;\n        else\n            virNetworkDefFree(obj->def);\n        obj->def = def;\n    } else { /* !live */\n        virNetworkDefFree(obj->newDef);\n        if (virNetworkObjIsActive(obj)) {\n            /* save new configuration to be restored on network\n             * shutdown, leaving current live def alone\n             */\n            obj->newDef = def;\n        } else { /* !live and !active */\n            if (obj->def && !obj->persistent) {\n                /* network isn't (yet) marked active or persistent,\n                 * but already has a \"live\" def set. This means we are\n                 * currently setting the persistent def as a part of\n                 * the process of starting the network, so we need to\n                 * preserve the \"not yet live\" def in network->def.\n                 */\n                obj->newDef = def;\n            } else {\n                /* either there is no live def set, or this network\n                 * was already set as persistent, so the proper thing\n                 * is to overwrite network->def.\n                 */\n                obj->newDef = NULL;\n                virNetworkDefFree(obj->def);\n                obj->def = def;\n            }\n        }\n        obj->persistent = !!def;\n    }\n}"
  },
  {
    "function_name": "virNetworkObjListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "486-492",
    "snippet": "static void\nvirNetworkObjListDispose(void *opaque)\n{\n    virNetworkObjListPtr nets = opaque;\n\n    virHashFree(nets->objs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "nets->objs"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirNetworkObjListDispose(void *opaque)\n{\n    virNetworkObjListPtr nets = opaque;\n\n    virHashFree(nets->objs);\n}"
  },
  {
    "function_name": "virNetworkObjDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "473-483",
    "snippet": "static void\nvirNetworkObjDispose(void *opaque)\n{\n    virNetworkObjPtr obj = opaque;\n\n    virHashFree(obj->ports);\n    virNetworkDefFree(obj->def);\n    virNetworkDefFree(obj->newDef);\n    virBitmapFree(obj->classIdMap);\n    virObjectUnref(obj->macmap);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj->macmap"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "obj->classIdMap"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkDefFree",
          "args": [
            "obj->newDef"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_conf.c",
          "lines": "235-274",
          "snippet": "void\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"network_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkDefFree(virNetworkDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->bridge);\n    VIR_FREE(def->bridgeZone);\n    VIR_FREE(def->domain);\n\n    virNetworkForwardDefClear(&def->forward);\n\n    for (i = 0; i < def->nips && def->ips; i++)\n        virNetworkIPDefClear(&def->ips[i]);\n    VIR_FREE(def->ips);\n\n    for (i = 0; i < def->nroutes && def->routes; i++)\n        virNetDevIPRouteFree(def->routes[i]);\n    VIR_FREE(def->routes);\n\n    for (i = 0; i < def->nPortGroups && def->portGroups; i++)\n        virPortGroupDefClear(&def->portGroups[i]);\n    VIR_FREE(def->portGroups);\n\n    virNetworkDNSDefClear(&def->dns);\n\n    VIR_FREE(def->virtPortProfile);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n\n    xmlFreeNode(def->metadata);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "obj->ports"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic void\nvirNetworkObjDispose(void *opaque)\n{\n    virNetworkObjPtr obj = opaque;\n\n    virHashFree(obj->ports);\n    virNetworkDefFree(obj->def);\n    virNetworkDefFree(obj->newDef);\n    virBitmapFree(obj->classIdMap);\n    virObjectUnref(obj->macmap);\n}"
  },
  {
    "function_name": "virNetworkObjTaint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "459-470",
    "snippet": "bool\nvirNetworkObjTaint(virNetworkObjPtr obj,\n                   virNetworkTaintFlags taint)\n{\n    unsigned int flag = (1 << taint);\n\n    if (obj->taint & flag)\n        return false;\n\n    obj->taint |= flag;\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjTaint(virNetworkObjPtr obj,\n                   virNetworkTaintFlags taint)\n{\n    unsigned int flag = (1 << taint);\n\n    if (obj->taint & flag)\n        return false;\n\n    obj->taint |= flag;\n    return true;\n}"
  },
  {
    "function_name": "virNetworkObjFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "444-456",
    "snippet": "virNetworkObjPtr\nvirNetworkObjFindByName(virNetworkObjListPtr nets,\n                        const char *name)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockRead(nets);\n    obj = virNetworkObjFindByNameLocked(nets, name);\n    virObjectRWUnlock(nets);\n    if (obj)\n        virObjectLock(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjFindByNameLocked",
          "args": [
            "nets",
            "name"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjFindByNameLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "421-431",
          "snippet": "static virNetworkObjPtr\nvirNetworkObjFindByNameLocked(virNetworkObjListPtr nets,\n                              const char *name)\n{\n    virNetworkObjPtr obj = NULL;\n\n    obj = virHashSearch(nets->objs, virNetworkObjSearchName, name, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkObjFindByNameLocked(virNetworkObjListPtr nets,\n                              const char *name)\n{\n    virNetworkObjPtr obj = NULL;\n\n    obj = virHashSearch(nets->objs, virNetworkObjSearchName, name, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "nets"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkObjPtr\nvirNetworkObjFindByName(virNetworkObjListPtr nets,\n                        const char *name)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockRead(nets);\n    obj = virNetworkObjFindByNameLocked(nets, name);\n    virObjectRWUnlock(nets);\n    if (obj)\n        virObjectLock(obj);\n    return obj;\n}"
  },
  {
    "function_name": "virNetworkObjFindByNameLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "421-431",
    "snippet": "static virNetworkObjPtr\nvirNetworkObjFindByNameLocked(virNetworkObjListPtr nets,\n                              const char *name)\n{\n    virNetworkObjPtr obj = NULL;\n\n    obj = virHashSearch(nets->objs, virNetworkObjSearchName, name, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSearch",
          "args": [
            "nets->objs",
            "virNetworkObjSearchName",
            "name",
            "NULL"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "736-761",
          "snippet": "void *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkObjFindByNameLocked(virNetworkObjListPtr nets,\n                              const char *name)\n{\n    virNetworkObjPtr obj = NULL;\n\n    obj = virHashSearch(nets->objs, virNetworkObjSearchName, name, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
  },
  {
    "function_name": "virNetworkObjSearchName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "405-418",
    "snippet": "static int\nvirNetworkObjSearchName(const void *payload,\n                        const void *name G_GNUC_UNUSED,\n                        const void *data)\n{\n    virNetworkObjPtr obj = (virNetworkObjPtr) payload;\n    int want = 0;\n\n    virObjectLock(obj);\n    if (STREQ(obj->def->name, (const char *)data))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "obj->def->name",
            "(const char *)data"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic int\nvirNetworkObjSearchName(const void *payload,\n                        const void *name G_GNUC_UNUSED,\n                        const void *data)\n{\n    virNetworkObjPtr obj = (virNetworkObjPtr) payload;\n    int want = 0;\n\n    virObjectLock(obj);\n    if (STREQ(obj->def->name, (const char *)data))\n        want = 1;\n    virObjectUnlock(obj);\n    return want;\n}"
  },
  {
    "function_name": "virNetworkObjFindByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "390-402",
    "snippet": "virNetworkObjPtr\nvirNetworkObjFindByUUID(virNetworkObjListPtr nets,\n                        const unsigned char *uuid)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockRead(nets);\n    obj = virNetworkObjFindByUUIDLocked(nets, uuid);\n    virObjectRWUnlock(nets);\n    if (obj)\n        virObjectLock(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "nets"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjFindByUUIDLocked",
          "args": [
            "nets",
            "uuid"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkObjFindByUUIDLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
          "lines": "364-377",
          "snippet": "static virNetworkObjPtr\nvirNetworkObjFindByUUIDLocked(virNetworkObjListPtr nets,\n                              const unsigned char *uuid)\n{\n    virNetworkObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    obj = virHashLookup(nets->objs, uuidstr);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetworkobj.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetworkObjDispose(void *obj);",
            "static void virNetworkObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkObjFindByUUIDLocked(virNetworkObjListPtr nets,\n                              const unsigned char *uuid)\n{\n    virNetworkObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    obj = virHashLookup(nets->objs, uuidstr);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "nets"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkObjPtr\nvirNetworkObjFindByUUID(virNetworkObjListPtr nets,\n                        const unsigned char *uuid)\n{\n    virNetworkObjPtr obj;\n\n    virObjectRWLockRead(nets);\n    obj = virNetworkObjFindByUUIDLocked(nets, uuid);\n    virObjectRWUnlock(nets);\n    if (obj)\n        virObjectLock(obj);\n    return obj;\n}"
  },
  {
    "function_name": "virNetworkObjFindByUUIDLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "364-377",
    "snippet": "static virNetworkObjPtr\nvirNetworkObjFindByUUIDLocked(virNetworkObjListPtr nets,\n                              const unsigned char *uuid)\n{\n    virNetworkObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    obj = virHashLookup(nets->objs, uuidstr);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "nets->objs",
            "uuidstr"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nstatic virNetworkObjPtr\nvirNetworkObjFindByUUIDLocked(virNetworkObjListPtr nets,\n                              const unsigned char *uuid)\n{\n    virNetworkObjPtr obj = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(uuid, uuidstr);\n\n    obj = virHashLookup(nets->objs, uuidstr);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
  },
  {
    "function_name": "virNetworkObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "344-361",
    "snippet": "virNetworkObjListPtr\nvirNetworkObjListNew(void)\n{\n    virNetworkObjListPtr nets;\n\n    if (virNetworkObjInitialize() < 0)\n        return NULL;\n\n    if (!(nets = virObjectRWLockableNew(virNetworkObjListClass)))\n        return NULL;\n\n    if (!(nets->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(nets);\n        return NULL;\n    }\n\n    return nets;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetworkObjListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "nets"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "50",
            "virObjectFreeHashData"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockableNew",
          "args": [
            "virNetworkObjListClass"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "282-305",
          "snippet": "void *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjInitialize",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virNetworkObjListClass;\n\nvirNetworkObjListPtr\nvirNetworkObjListNew(void)\n{\n    virNetworkObjListPtr nets;\n\n    if (virNetworkObjInitialize() < 0)\n        return NULL;\n\n    if (!(nets = virObjectRWLockableNew(virNetworkObjListClass)))\n        return NULL;\n\n    if (!(nets->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(nets);\n        return NULL;\n    }\n\n    return nets;\n}"
  },
  {
    "function_name": "virNetworkObjMacMgrDel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "313-341",
    "snippet": "int\nvirNetworkObjMacMgrDel(virNetworkObjPtr obj,\n                       const char *dnsmasqStateDir,\n                       const char *domain,\n                       const virMacAddr *mac)\n{\n    char macStr[VIR_MAC_STRING_BUFLEN];\n    char *file = NULL;\n    int ret = -1;\n\n    if (!obj->macmap)\n        return 0;\n\n    virMacAddrFormat(mac, macStr);\n\n    if (!(file = virMacMapFileName(dnsmasqStateDir, obj->def->bridge)))\n        goto cleanup;\n\n    if (virMacMapRemove(obj->macmap, domain, macStr) < 0)\n        goto cleanup;\n\n    if (virMacMapWriteFile(obj->macmap, file) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(file);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "file"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacMapWriteFile",
          "args": [
            "obj->macmap",
            "file"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "virMacMapWriteFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacmap.c",
          "lines": "360-370",
          "snippet": "int\nvirMacMapWriteFile(virMacMapPtr mgr,\n                   const char *filename)\n{\n    int ret;\n\n    virObjectLock(mgr);\n    ret = virMacMapWriteFileLocked(mgr, filename);\n    virObjectUnlock(mgr);\n    return ret;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virjson.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"virmacmap.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virjson.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"virmacmap.h\"\n#include <config.h>\n\nint\nvirMacMapWriteFile(virMacMapPtr mgr,\n                   const char *filename)\n{\n    int ret;\n\n    virObjectLock(mgr);\n    ret = virMacMapWriteFileLocked(mgr, filename);\n    virObjectUnlock(mgr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacMapRemove",
          "args": [
            "obj->macmap",
            "domain",
            "macStr"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "virMacMapRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacmap.c",
          "lines": "333-344",
          "snippet": "int\nvirMacMapRemove(virMacMapPtr mgr,\n                const char *domain,\n                const char *mac)\n{\n    int ret;\n\n    virObjectLock(mgr);\n    ret = virMacMapRemoveLocked(mgr, domain, mac);\n    virObjectUnlock(mgr);\n    return ret;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virjson.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"virmacmap.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virjson.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"virmacmap.h\"\n#include <config.h>\n\nint\nvirMacMapRemove(virMacMapPtr mgr,\n                const char *domain,\n                const char *mac)\n{\n    int ret;\n\n    virObjectLock(mgr);\n    ret = virMacMapRemoveLocked(mgr, domain, mac);\n    virObjectUnlock(mgr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacMapFileName",
          "args": [
            "dnsmasqStateDir",
            "obj->def->bridge"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "virMacMapFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacmap.c",
          "lines": "276-285",
          "snippet": "char *\nvirMacMapFileName(const char *dnsmasqStateDir,\n                  const char *bridge)\n{\n    char *filename;\n\n    filename = g_strdup_printf(\"%s/%s.macs\", dnsmasqStateDir, bridge);\n\n    return filename;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virjson.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"virmacmap.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virjson.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"virmacmap.h\"\n#include <config.h>\n\nchar *\nvirMacMapFileName(const char *dnsmasqStateDir,\n                  const char *bridge)\n{\n    char *filename;\n\n    filename = g_strdup_printf(\"%s/%s.macs\", dnsmasqStateDir, bridge);\n\n    return filename;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "mac",
            "macStr"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjMacMgrDel(virNetworkObjPtr obj,\n                       const char *dnsmasqStateDir,\n                       const char *domain,\n                       const virMacAddr *mac)\n{\n    char macStr[VIR_MAC_STRING_BUFLEN];\n    char *file = NULL;\n    int ret = -1;\n\n    if (!obj->macmap)\n        return 0;\n\n    virMacAddrFormat(mac, macStr);\n\n    if (!(file = virMacMapFileName(dnsmasqStateDir, obj->def->bridge)))\n        goto cleanup;\n\n    if (virMacMapRemove(obj->macmap, domain, macStr) < 0)\n        goto cleanup;\n\n    if (virMacMapWriteFile(obj->macmap, file) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(file);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjMacMgrAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "282-310",
    "snippet": "int\nvirNetworkObjMacMgrAdd(virNetworkObjPtr obj,\n                       const char *dnsmasqStateDir,\n                       const char *domain,\n                       const virMacAddr *mac)\n{\n    char macStr[VIR_MAC_STRING_BUFLEN];\n    char *file = NULL;\n    int ret = -1;\n\n    if (!obj->macmap)\n        return 0;\n\n    virMacAddrFormat(mac, macStr);\n\n    if (!(file = virMacMapFileName(dnsmasqStateDir, obj->def->bridge)))\n        goto cleanup;\n\n    if (virMacMapAdd(obj->macmap, domain, macStr) < 0)\n        goto cleanup;\n\n    if (virMacMapWriteFile(obj->macmap, file) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(file);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "file"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacMapWriteFile",
          "args": [
            "obj->macmap",
            "file"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virMacMapWriteFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacmap.c",
          "lines": "360-370",
          "snippet": "int\nvirMacMapWriteFile(virMacMapPtr mgr,\n                   const char *filename)\n{\n    int ret;\n\n    virObjectLock(mgr);\n    ret = virMacMapWriteFileLocked(mgr, filename);\n    virObjectUnlock(mgr);\n    return ret;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virjson.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"virmacmap.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virjson.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"virmacmap.h\"\n#include <config.h>\n\nint\nvirMacMapWriteFile(virMacMapPtr mgr,\n                   const char *filename)\n{\n    int ret;\n\n    virObjectLock(mgr);\n    ret = virMacMapWriteFileLocked(mgr, filename);\n    virObjectUnlock(mgr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacMapAdd",
          "args": [
            "obj->macmap",
            "domain",
            "macStr"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virMacMapAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacmap.c",
          "lines": "319-330",
          "snippet": "int\nvirMacMapAdd(virMacMapPtr mgr,\n             const char *domain,\n             const char *mac)\n{\n    int ret;\n\n    virObjectLock(mgr);\n    ret = virMacMapAddLocked(mgr, domain, mac);\n    virObjectUnlock(mgr);\n    return ret;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virjson.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"virmacmap.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virjson.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"virmacmap.h\"\n#include <config.h>\n\nint\nvirMacMapAdd(virMacMapPtr mgr,\n             const char *domain,\n             const char *mac)\n{\n    int ret;\n\n    virObjectLock(mgr);\n    ret = virMacMapAddLocked(mgr, domain, mac);\n    virObjectUnlock(mgr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacMapFileName",
          "args": [
            "dnsmasqStateDir",
            "obj->def->bridge"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virMacMapFileName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacmap.c",
          "lines": "276-285",
          "snippet": "char *\nvirMacMapFileName(const char *dnsmasqStateDir,\n                  const char *bridge)\n{\n    char *filename;\n\n    filename = g_strdup_printf(\"%s/%s.macs\", dnsmasqStateDir, bridge);\n\n    return filename;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virjson.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"virmacmap.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virjson.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"virmacmap.h\"\n#include <config.h>\n\nchar *\nvirMacMapFileName(const char *dnsmasqStateDir,\n                  const char *bridge)\n{\n    char *filename;\n\n    filename = g_strdup_printf(\"%s/%s.macs\", dnsmasqStateDir, bridge);\n\n    return filename;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "mac",
            "macStr"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nint\nvirNetworkObjMacMgrAdd(virNetworkObjPtr obj,\n                       const char *dnsmasqStateDir,\n                       const char *domain,\n                       const virMacAddr *mac)\n{\n    char macStr[VIR_MAC_STRING_BUFLEN];\n    char *file = NULL;\n    int ret = -1;\n\n    if (!obj->macmap)\n        return 0;\n\n    virMacAddrFormat(mac, macStr);\n\n    if (!(file = virMacMapFileName(dnsmasqStateDir, obj->def->bridge)))\n        goto cleanup;\n\n    if (virMacMapAdd(obj->macmap, domain, macStr) < 0)\n        goto cleanup;\n\n    if (virMacMapWriteFile(obj->macmap, file) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(file);\n    return ret;\n}"
  },
  {
    "function_name": "virNetworkObjUnrefMacMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "274-279",
    "snippet": "void\nvirNetworkObjUnrefMacMap(virNetworkObjPtr obj)\n{\n    virObjectUnref(obj->macmap);\n    obj->macmap = NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj->macmap"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjUnrefMacMap(virNetworkObjPtr obj)\n{\n    virObjectUnref(obj->macmap);\n    obj->macmap = NULL;\n}"
  },
  {
    "function_name": "virNetworkObjSetMacMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "266-271",
    "snippet": "void\nvirNetworkObjSetMacMap(virNetworkObjPtr obj,\n                       virMacMapPtr macmap)\n{\n    obj->macmap = macmap;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjSetMacMap(virNetworkObjPtr obj,\n                       virMacMapPtr macmap)\n{\n    obj->macmap = macmap;\n}"
  },
  {
    "function_name": "virNetworkObjSetFloorSum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "258-263",
    "snippet": "void\nvirNetworkObjSetFloorSum(virNetworkObjPtr obj,\n                         unsigned long long floor_sum)\n{\n    obj->floor_sum = floor_sum;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjSetFloorSum(virNetworkObjPtr obj,\n                         unsigned long long floor_sum)\n{\n    obj->floor_sum = floor_sum;\n}"
  },
  {
    "function_name": "virNetworkObjGetFloorSum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "251-255",
    "snippet": "unsigned long long\nvirNetworkObjGetFloorSum(virNetworkObjPtr obj)\n{\n    return obj->floor_sum;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nunsigned long long\nvirNetworkObjGetFloorSum(virNetworkObjPtr obj)\n{\n    return obj->floor_sum;\n}"
  },
  {
    "function_name": "virNetworkObjGetMacMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "244-248",
    "snippet": "virMacMapPtr\nvirNetworkObjGetMacMap(virNetworkObjPtr obj)\n{\n    return obj->macmap;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirMacMapPtr\nvirNetworkObjGetMacMap(virNetworkObjPtr obj)\n{\n    return obj->macmap;\n}"
  },
  {
    "function_name": "virNetworkObjGetClassIdMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "237-241",
    "snippet": "virBitmapPtr\nvirNetworkObjGetClassIdMap(virNetworkObjPtr obj)\n{\n    return obj->classIdMap;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirBitmapPtr\nvirNetworkObjGetClassIdMap(virNetworkObjPtr obj)\n{\n    return obj->classIdMap;\n}"
  },
  {
    "function_name": "virNetworkObjSetRadvdPid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "229-234",
    "snippet": "void\nvirNetworkObjSetRadvdPid(virNetworkObjPtr obj,\n                         pid_t radvdPid)\n{\n    obj->radvdPid = radvdPid;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjSetRadvdPid(virNetworkObjPtr obj,\n                         pid_t radvdPid)\n{\n    obj->radvdPid = radvdPid;\n}"
  },
  {
    "function_name": "virNetworkObjGetRadvdPid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "222-226",
    "snippet": "pid_t\nvirNetworkObjGetRadvdPid(virNetworkObjPtr obj)\n{\n    return obj->radvdPid;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\npid_t\nvirNetworkObjGetRadvdPid(virNetworkObjPtr obj)\n{\n    return obj->radvdPid;\n}"
  },
  {
    "function_name": "virNetworkObjSetDnsmasqPid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "214-219",
    "snippet": "void\nvirNetworkObjSetDnsmasqPid(virNetworkObjPtr obj,\n                           pid_t dnsmasqPid)\n{\n    obj->dnsmasqPid = dnsmasqPid;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjSetDnsmasqPid(virNetworkObjPtr obj,\n                           pid_t dnsmasqPid)\n{\n    obj->dnsmasqPid = dnsmasqPid;\n}"
  },
  {
    "function_name": "virNetworkObjGetDnsmasqPid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "207-211",
    "snippet": "pid_t\nvirNetworkObjGetDnsmasqPid(virNetworkObjPtr obj)\n{\n    return obj->dnsmasqPid;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\npid_t\nvirNetworkObjGetDnsmasqPid(virNetworkObjPtr obj)\n{\n    return obj->dnsmasqPid;\n}"
  },
  {
    "function_name": "virNetworkObjSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "199-204",
    "snippet": "void\nvirNetworkObjSetAutostart(virNetworkObjPtr obj,\n                          bool autostart)\n{\n    obj->autostart = autostart;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjSetAutostart(virNetworkObjPtr obj,\n                          bool autostart)\n{\n    obj->autostart = autostart;\n}"
  },
  {
    "function_name": "virNetworkObjIsAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "192-196",
    "snippet": "bool\nvirNetworkObjIsAutostart(virNetworkObjPtr obj)\n{\n    return obj->autostart;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsAutostart(virNetworkObjPtr obj)\n{\n    return obj->autostart;\n}"
  },
  {
    "function_name": "virNetworkObjIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "185-189",
    "snippet": "bool\nvirNetworkObjIsPersistent(virNetworkObjPtr obj)\n{\n    return obj->persistent;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsPersistent(virNetworkObjPtr obj)\n{\n    return obj->persistent;\n}"
  },
  {
    "function_name": "virNetworkObjSetActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "177-182",
    "snippet": "void\nvirNetworkObjSetActive(virNetworkObjPtr obj,\n                       bool active)\n{\n    obj->active = active;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjSetActive(virNetworkObjPtr obj,\n                       bool active)\n{\n    obj->active = active;\n}"
  },
  {
    "function_name": "virNetworkObjIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "170-174",
    "snippet": "bool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nbool\nvirNetworkObjIsActive(virNetworkObjPtr obj)\n{\n    return obj->active;\n}"
  },
  {
    "function_name": "virNetworkObjGetNewDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "163-167",
    "snippet": "virNetworkDefPtr\nvirNetworkObjGetNewDef(virNetworkObjPtr obj)\n{\n    return obj->newDef;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkDefPtr\nvirNetworkObjGetNewDef(virNetworkObjPtr obj)\n{\n    return obj->newDef;\n}"
  },
  {
    "function_name": "virNetworkObjSetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "155-160",
    "snippet": "void\nvirNetworkObjSetDef(virNetworkObjPtr obj,\n                    virNetworkDefPtr def)\n{\n    obj->def = def;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjSetDef(virNetworkObjPtr obj,\n                    virNetworkDefPtr def)\n{\n    obj->def = def;\n}"
  },
  {
    "function_name": "virNetworkObjGetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "148-152",
    "snippet": "virNetworkDefPtr\nvirNetworkObjGetDef(virNetworkObjPtr obj)\n{\n    return obj->def;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkDefPtr\nvirNetworkObjGetDef(virNetworkObjPtr obj)\n{\n    return obj->def;\n}"
  },
  {
    "function_name": "virNetworkObjEndAPI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "136-145",
    "snippet": "void\nvirNetworkObjEndAPI(virNetworkObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "*obj"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "*obj"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvoid\nvirNetworkObjEndAPI(virNetworkObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
  },
  {
    "function_name": "virNetworkObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "102-133",
    "snippet": "virNetworkObjPtr\nvirNetworkObjNew(void)\n{\n    virNetworkObjPtr obj;\n\n    if (virNetworkObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virNetworkObjClass)))\n        return NULL;\n\n    if (!(obj->classIdMap = virBitmapNew(INIT_CLASS_ID_BITMAP_SIZE)))\n        goto error;\n\n    /* The first three class IDs are already taken */\n    if (virBitmapSetBitExpand(obj->classIdMap, 0) < 0 ||\n        virBitmapSetBitExpand(obj->classIdMap, 1) < 0 ||\n        virBitmapSetBitExpand(obj->classIdMap, 2) < 0)\n        goto error;\n\n    if (!(obj->ports = virHashCreate(10,\n                                     virNetworkObjPortFree)))\n        goto error;\n\n    virObjectLock(obj);\n\n    return obj;\n\n error:\n    virObjectUnref(obj);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define INIT_CLASS_ID_BITMAP_SIZE (1<<4)"
    ],
    "globals_used": [
      "static virClassPtr virNetworkObjClass;",
      "static void virNetworkObjDispose(void *obj);",
      "static void virNetworkObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "10",
            "virNetworkObjPortFree"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapSetBitExpand",
          "args": [
            "obj->classIdMap",
            "2"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "INIT_CLASS_ID_BITMAP_SIZE"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNetworkObjClass"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkObjInitialize",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\n#define INIT_CLASS_ID_BITMAP_SIZE (1<<4)\n\nstatic virClassPtr virNetworkObjClass;\nstatic void virNetworkObjDispose(void *obj);\nstatic void virNetworkObjListDispose(void *obj);\n\nvirNetworkObjPtr\nvirNetworkObjNew(void)\n{\n    virNetworkObjPtr obj;\n\n    if (virNetworkObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virNetworkObjClass)))\n        return NULL;\n\n    if (!(obj->classIdMap = virBitmapNew(INIT_CLASS_ID_BITMAP_SIZE)))\n        goto error;\n\n    /* The first three class IDs are already taken */\n    if (virBitmapSetBitExpand(obj->classIdMap, 0) < 0 ||\n        virBitmapSetBitExpand(obj->classIdMap, 1) < 0 ||\n        virBitmapSetBitExpand(obj->classIdMap, 2) < 0)\n        goto error;\n\n    if (!(obj->ports = virHashCreate(10,\n                                     virNetworkObjPortFree)))\n        goto error;\n\n    virObjectLock(obj);\n\n    return obj;\n\n error:\n    virObjectUnref(obj);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkObjPortFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "96-100",
    "snippet": "static void\nvirNetworkObjPortFree(void *val)\n{\n    virNetworkPortDefFree(val);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetworkPortDefFree",
          "args": [
            "val"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkPortDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkportdef.c",
          "lines": "42-77",
          "snippet": "void\nvirNetworkPortDefFree(virNetworkPortDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->group);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n    VIR_FREE(def->virtPortProfile);\n\n    switch ((virNetworkPortPlugType)def->plugtype) {\n    case VIR_NETWORK_PORT_PLUG_TYPE_NONE:\n        break;\n\n    case VIR_NETWORK_PORT_PLUG_TYPE_NETWORK:\n    case VIR_NETWORK_PORT_PLUG_TYPE_BRIDGE:\n        VIR_FREE(def->plug.bridge.brname);\n        break;\n\n    case VIR_NETWORK_PORT_PLUG_TYPE_DIRECT:\n        VIR_FREE(def->plug.direct.linkdev);\n        break;\n\n    case VIR_NETWORK_PORT_PLUG_TYPE_HOSTDEV_PCI:\n        break;\n\n    case VIR_NETWORK_PORT_PLUG_TYPE_LAST:\n    default:\n        break;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_vport_profile_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"network_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetworkPortDefFree(virNetworkPortDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->group);\n\n    virNetDevBandwidthFree(def->bandwidth);\n    virNetDevVlanClear(&def->vlan);\n    VIR_FREE(def->virtPortProfile);\n\n    switch ((virNetworkPortPlugType)def->plugtype) {\n    case VIR_NETWORK_PORT_PLUG_TYPE_NONE:\n        break;\n\n    case VIR_NETWORK_PORT_PLUG_TYPE_NETWORK:\n    case VIR_NETWORK_PORT_PLUG_TYPE_BRIDGE:\n        VIR_FREE(def->plug.bridge.brname);\n        break;\n\n    case VIR_NETWORK_PORT_PLUG_TYPE_DIRECT:\n        VIR_FREE(def->plug.direct.linkdev);\n        break;\n\n    case VIR_NETWORK_PORT_PLUG_TYPE_HOSTDEV_PCI:\n        break;\n\n    case VIR_NETWORK_PORT_PLUG_TYPE_LAST:\n    default:\n        break;\n    }\n\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic void\nvirNetworkObjPortFree(void *val)\n{\n    virNetworkPortDefFree(val);\n}"
  },
  {
    "function_name": "virNetworkObjOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnetworkobj.c",
    "lines": "76-86",
    "snippet": "static int\nvirNetworkObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetworkObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virNetworkObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetworkobj.h\"",
      "#include \"datatypes.h\"",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNetworkObjList",
            "virClassForObjectRWLockable()"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectRWLockable",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNetworkObj",
            "virClassForObjectLockable()"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virnetworkobj.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirNetworkObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetworkObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virNetworkObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]