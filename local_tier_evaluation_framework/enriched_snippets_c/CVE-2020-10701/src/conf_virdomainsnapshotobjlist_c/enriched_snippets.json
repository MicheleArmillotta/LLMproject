[
  {
    "function_name": "virDomainListSnapshots",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "255-294",
    "snippet": "int\nvirDomainListSnapshots(virDomainSnapshotObjListPtr snapshots,\n                       virDomainMomentObjPtr from,\n                       virDomainPtr dom,\n                       virDomainSnapshotPtr **snaps,\n                       unsigned int flags)\n{\n    int count = virDomainSnapshotObjListNum(snapshots, from, flags);\n    virDomainSnapshotPtr *list = NULL;\n    char **names;\n    int ret = -1;\n    size_t i;\n\n    if (!snaps || count < 0)\n        return count;\n    if (VIR_ALLOC_N(names, count) < 0 ||\n        VIR_ALLOC_N(list, count + 1) < 0)\n        goto cleanup;\n\n    if (virDomainSnapshotObjListGetNames(snapshots, from, names, count,\n                                         flags) < 0)\n        goto cleanup;\n    for (i = 0; i < count; i++)\n        if ((list[i] = virGetDomainSnapshot(dom, names[i])) == NULL)\n            goto cleanup;\n\n    ret = count;\n    *snaps = list;\n\n cleanup:\n    for (i = 0; i < count; i++)\n        VIR_FREE(names[i]);\n    VIR_FREE(names);\n    if (ret < 0 && list) {\n        for (i = 0; i < count; i++)\n            virObjectUnref(list[i]);\n        VIR_FREE(list);\n    }\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "list[i]"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "names"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "names[i]"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetDomainSnapshot",
          "args": [
            "dom",
            "names[i]"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomainSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "1023-1045",
          "snippet": "virDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainSnapshotClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainSnapshotClass;\n\nvirDomainSnapshotPtr\nvirGetDomainSnapshot(virDomainPtr domain, const char *name)\n{\n    virDomainSnapshotPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckDomainGoto(domain, error);\n    virCheckNonNullArgGoto(name, error);\n\n    if (!(ret = virObjectNew(virDomainSnapshotClass)))\n        goto error;\n    ret->name = g_strdup(name);\n\n    ret->domain = virObjectRef(domain);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListGetNames",
          "args": [
            "snapshots",
            "from",
            "names",
            "count",
            "flags"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "109-155",
          "snippet": "int\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "list",
            "count + 1"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "names",
            "count"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListNum",
          "args": [
            "snapshots",
            "from",
            "flags"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListNum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "158-164",
          "snippet": "int\nvirDomainSnapshotObjListNum(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr from,\n                            unsigned int flags)\n{\n    return virDomainSnapshotObjListGetNames(snapshots, from, NULL, 0, flags);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListNum(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr from,\n                            unsigned int flags)\n{\n    return virDomainSnapshotObjListGetNames(snapshots, from, NULL, 0, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainListSnapshots(virDomainSnapshotObjListPtr snapshots,\n                       virDomainMomentObjPtr from,\n                       virDomainPtr dom,\n                       virDomainSnapshotPtr **snaps,\n                       unsigned int flags)\n{\n    int count = virDomainSnapshotObjListNum(snapshots, from, flags);\n    virDomainSnapshotPtr *list = NULL;\n    char **names;\n    int ret = -1;\n    size_t i;\n\n    if (!snaps || count < 0)\n        return count;\n    if (VIR_ALLOC_N(names, count) < 0 ||\n        VIR_ALLOC_N(list, count + 1) < 0)\n        goto cleanup;\n\n    if (virDomainSnapshotObjListGetNames(snapshots, from, names, count,\n                                         flags) < 0)\n        goto cleanup;\n    for (i = 0; i < count; i++)\n        if ((list[i] = virGetDomainSnapshot(dom, names[i])) == NULL)\n            goto cleanup;\n\n    ret = count;\n    *snaps = list;\n\n cleanup:\n    for (i = 0; i < count; i++)\n        VIR_FREE(names[i]);\n    VIR_FREE(names);\n    if (ret < 0 && list) {\n        for (i = 0; i < count; i++)\n            virObjectUnref(list[i]);\n        VIR_FREE(list);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virDomainSnapshotCheckCycles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "246-252",
    "snippet": "int\nvirDomainSnapshotCheckCycles(virDomainSnapshotObjListPtr snapshots,\n                             virDomainSnapshotDefPtr def,\n                             const char *domname)\n{\n    return virDomainMomentCheckCycles(snapshots->base, &def->parent, domname);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentCheckCycles",
          "args": [
            "snapshots->base",
            "&def->parent",
            "domname"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentCheckCycles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "550-587",
          "snippet": "int\nvirDomainMomentCheckCycles(virDomainMomentObjListPtr list,\n                           virDomainMomentDefPtr def,\n                           const char *domname)\n{\n    virDomainMomentObjPtr other;\n\n    if (def->parent_name) {\n        if (STREQ(def->name, def->parent_name)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"cannot set moment %s as its own parent\"),\n                           def->name);\n            return -1;\n        }\n        other = virDomainMomentFindByName(list, def->parent_name);\n        if (!other) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"parent %s for moment %s not found\"),\n                           def->parent_name, def->name);\n            return -1;\n        }\n        while (other->def->parent_name) {\n            if (STREQ(other->def->parent_name, def->name)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parent %s would create cycle to %s\"),\n                               other->def->name, def->name);\n                return -1;\n            }\n            other = virDomainMomentFindByName(list, other->def->parent_name);\n            if (!other) {\n                VIR_WARN(\"moments are inconsistent for domain %s\",\n                         domname);\n                break;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentCheckCycles(virDomainMomentObjListPtr list,\n                           virDomainMomentDefPtr def,\n                           const char *domname)\n{\n    virDomainMomentObjPtr other;\n\n    if (def->parent_name) {\n        if (STREQ(def->name, def->parent_name)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"cannot set moment %s as its own parent\"),\n                           def->name);\n            return -1;\n        }\n        other = virDomainMomentFindByName(list, def->parent_name);\n        if (!other) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"parent %s for moment %s not found\"),\n                           def->parent_name, def->name);\n            return -1;\n        }\n        while (other->def->parent_name) {\n            if (STREQ(other->def->parent_name, def->name)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parent %s would create cycle to %s\"),\n                               other->def->name, def->name);\n                return -1;\n            }\n            other = virDomainMomentFindByName(list, other->def->parent_name);\n            if (!other) {\n                VIR_WARN(\"moments are inconsistent for domain %s\",\n                         domname);\n                break;\n            }\n        }\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotCheckCycles(virDomainSnapshotObjListPtr snapshots,\n                             virDomainSnapshotDefPtr def,\n                             const char *domname)\n{\n    return virDomainMomentCheckCycles(snapshots->base, &def->parent, domname);\n}"
  },
  {
    "function_name": "virDomainSnapshotUpdateRelations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "239-243",
    "snippet": "int\nvirDomainSnapshotUpdateRelations(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentUpdateRelations(snapshots->base);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentUpdateRelations",
          "args": [
            "snapshots->base"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentUpdateRelations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "533-543",
          "snippet": "int\nvirDomainMomentUpdateRelations(virDomainMomentObjListPtr moments)\n{\n    struct moment_set_relation act = { moments, 0 };\n\n    virDomainMomentDropChildren(&moments->metaroot);\n    virHashForEach(moments->objs, virDomainMomentSetRelations, &act);\n    if (act.err)\n        moments->current = NULL;\n    return act.err;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentUpdateRelations(virDomainMomentObjListPtr moments)\n{\n    struct moment_set_relation act = { moments, 0 };\n\n    virDomainMomentDropChildren(&moments->metaroot);\n    virHashForEach(moments->objs, virDomainMomentSetRelations, &act);\n    if (act.err)\n        moments->current = NULL;\n    return act.err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotUpdateRelations(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentUpdateRelations(snapshots->base);\n}"
  },
  {
    "function_name": "virDomainSnapshotLinkParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "227-232",
    "snippet": "void\nvirDomainSnapshotLinkParent(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr snap)\n{\n    return virDomainMomentLinkParent(snapshots->base, snap);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentLinkParent",
          "args": [
            "snapshots->base",
            "snap"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentLinkParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "169-183",
          "snippet": "void\nvirDomainMomentLinkParent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr parent;\n\n    parent = virDomainMomentFindByName(moments, moment->def->parent_name);\n    if (!parent) {\n        parent = &moments->metaroot;\n        if (moment->def->parent_name)\n            VIR_WARN(\"moment %s lacks parent %s\", moment->def->name,\n                     moment->def->parent_name);\n    }\n    virDomainMomentSetParent(moment, parent);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentLinkParent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr parent;\n\n    parent = virDomainMomentFindByName(moments, moment->def->parent_name);\n    if (!parent) {\n        parent = &moments->metaroot;\n        if (moment->def->parent_name)\n            VIR_WARN(\"moment %s lacks parent %s\", moment->def->name,\n                     moment->def->parent_name);\n    }\n    virDomainMomentSetParent(moment, parent);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotLinkParent(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr snap)\n{\n    return virDomainMomentLinkParent(snapshots->base, snap);\n}"
  },
  {
    "function_name": "virDomainSnapshotForEach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "217-223",
    "snippet": "int\nvirDomainSnapshotForEach(virDomainSnapshotObjListPtr snapshots,\n                         virHashIterator iter,\n                         void *data)\n{\n    return virDomainMomentForEach(snapshots->base, iter, data);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentForEach",
          "args": [
            "snapshots->base",
            "iter",
            "data"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "475-481",
          "snippet": "int\nvirDomainMomentForEach(virDomainMomentObjListPtr moments,\n                       virHashIterator iter,\n                       void *data)\n{\n    return virHashForEach(moments->objs, iter, data);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEach(virDomainMomentObjListPtr moments,\n                       virHashIterator iter,\n                       void *data)\n{\n    return virHashForEach(moments->objs, iter, data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotForEach(virDomainSnapshotObjListPtr snapshots,\n                         virHashIterator iter,\n                         void *data)\n{\n    return virDomainMomentForEach(snapshots->base, iter, data);\n}"
  },
  {
    "function_name": "virDomainSnapshotObjListRemoveAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "210-214",
    "snippet": "void\nvirDomainSnapshotObjListRemoveAll(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentObjListRemoveAll(snapshots->base);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentObjListRemoveAll",
          "args": [
            "snapshots->base"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListRemoveAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "466-471",
          "snippet": "void\nvirDomainMomentObjListRemoveAll(virDomainMomentObjListPtr moments)\n{\n    virHashRemoveAll(moments->objs);\n    virDomainMomentDropChildren(&moments->metaroot);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentObjListRemoveAll(virDomainMomentObjListPtr moments)\n{\n    virHashRemoveAll(moments->objs);\n    virDomainMomentDropChildren(&moments->metaroot);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListRemoveAll(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentObjListRemoveAll(snapshots->base);\n}"
  },
  {
    "function_name": "virDomainSnapshotObjListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "201-206",
    "snippet": "bool\nvirDomainSnapshotObjListRemove(virDomainSnapshotObjListPtr snapshots,\n                               virDomainMomentObjPtr snapshot)\n{\n    return virDomainMomentObjListRemove(snapshots->base, snapshot);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentObjListRemove",
          "args": [
            "snapshots->base",
            "snapshot"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "452-462",
          "snippet": "bool\nvirDomainMomentObjListRemove(virDomainMomentObjListPtr moments,\n                             virDomainMomentObjPtr moment)\n{\n    bool ret = moments->current == moment;\n\n    virHashRemoveEntry(moments->objs, moment->def->name);\n    if (ret)\n        moments->current = NULL;\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirDomainMomentObjListRemove(virDomainMomentObjListPtr moments,\n                             virDomainMomentObjPtr moment)\n{\n    bool ret = moments->current == moment;\n\n    virHashRemoveEntry(moments->objs, moment->def->name);\n    if (ret)\n        moments->current = NULL;\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirDomainSnapshotObjListRemove(virDomainSnapshotObjListPtr snapshots,\n                               virDomainMomentObjPtr snapshot)\n{\n    return virDomainMomentObjListRemove(snapshots->base, snapshot);\n}"
  },
  {
    "function_name": "virDomainSnapshotSetCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "192-197",
    "snippet": "void\nvirDomainSnapshotSetCurrent(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr snapshot)\n{\n    virDomainMomentSetCurrent(snapshots->base, snapshot);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentSetCurrent",
          "args": [
            "snapshots->base",
            "snapshot"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentSetCurrent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "435-440",
          "snippet": "void\nvirDomainMomentSetCurrent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    moments->current = moment;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentSetCurrent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    moments->current = moment;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotSetCurrent(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr snapshot)\n{\n    virDomainMomentSetCurrent(snapshots->base, snapshot);\n}"
  },
  {
    "function_name": "virDomainSnapshotGetCurrentName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "184-188",
    "snippet": "const char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentGetCurrentName",
          "args": [
            "snapshots->base"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "425-431",
          "snippet": "const char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainSnapshotGetCurrentName(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrentName(snapshots->base);\n}"
  },
  {
    "function_name": "virDomainSnapshotGetCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "176-180",
    "snippet": "virDomainMomentObjPtr\nvirDomainSnapshotGetCurrent(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrent(snapshots->base);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentGetCurrent",
          "args": [
            "snapshots->base"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentGetCurrentName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "425-431",
          "snippet": "const char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainSnapshotGetCurrent(virDomainSnapshotObjListPtr snapshots)\n{\n    return virDomainMomentGetCurrent(snapshots->base);\n}"
  },
  {
    "function_name": "virDomainSnapshotFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "167-172",
    "snippet": "virDomainMomentObjPtr\nvirDomainSnapshotFindByName(virDomainSnapshotObjListPtr snapshots,\n                            const char *name)\n{\n    return virDomainMomentFindByName(snapshots->base, name);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentFindByName",
          "args": [
            "snapshots->base",
            "name"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "406-413",
          "snippet": "virDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainSnapshotFindByName(virDomainSnapshotObjListPtr snapshots,\n                            const char *name)\n{\n    return virDomainMomentFindByName(snapshots->base, name);\n}"
  },
  {
    "function_name": "virDomainSnapshotObjListNum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "158-164",
    "snippet": "int\nvirDomainSnapshotObjListNum(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr from,\n                            unsigned int flags)\n{\n    return virDomainSnapshotObjListGetNames(snapshots, from, NULL, 0, flags);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainSnapshotObjListGetNames",
          "args": [
            "snapshots",
            "from",
            "NULL",
            "0",
            "flags"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjListGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
          "lines": "109-155",
          "snippet": "int\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListNum(virDomainSnapshotObjListPtr snapshots,\n                            virDomainMomentObjPtr from,\n                            unsigned int flags)\n{\n    return virDomainSnapshotObjListGetNames(snapshots, from, NULL, 0, flags);\n}"
  },
  {
    "function_name": "virDomainSnapshotObjListGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "109-155",
    "snippet": "int\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentObjListGetNames",
          "args": [
            "snapshots->base",
            "from",
            "names",
            "maxnames",
            "moment_flags",
            "virDomainSnapshotFilter",
            "flags"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "337-403",
          "snippet": "int\nvirDomainMomentObjListGetNames(virDomainMomentObjListPtr moments,\n                               virDomainMomentObjPtr from,\n                               char **const names,\n                               int maxnames,\n                               unsigned int flags,\n                               virDomainMomentObjListFilter filter,\n                               unsigned int filter_flags)\n{\n    struct virDomainMomentNameData data = { names, maxnames, flags, 0,\n                                            false, filter, filter_flags };\n    size_t i;\n\n    virCheckFlags(VIR_DOMAIN_MOMENT_FILTERS_ALL, -1);\n    if (!from) {\n        /* LIST_ROOTS and LIST_DESCENDANTS have the same bit value,\n         * but opposite semantics.  Toggle here to get the correct\n         * traversal on the metaroot.  */\n        flags ^= VIR_DOMAIN_MOMENT_LIST_ROOTS;\n        from = &moments->metaroot;\n    }\n\n    /* We handle LIST_ROOT/LIST_DESCENDANTS and LIST_TOPOLOGICAL directly,\n     * mask those bits out to determine when we must use the filter callback. */\n    data.flags &= ~(VIR_DOMAIN_MOMENT_LIST_DESCENDANTS |\n                    VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n\n    /* If this common code is being used, we assume that all moments\n     * have metadata, and thus can handle METADATA up front as an\n     * all-or-none filter.  XXX This might not always be true, if we\n     * add the ability to track qcow2 internal snapshots without the\n     * use of metadata, in which case this check should move into the\n     * filter callback.  */\n    if ((data.flags & VIR_DOMAIN_MOMENT_FILTERS_METADATA) ==\n        VIR_DOMAIN_MOMENT_LIST_NO_METADATA)\n        return 0;\n    data.flags &= ~VIR_DOMAIN_MOMENT_FILTERS_METADATA;\n\n    if (flags & VIR_DOMAIN_MOMENT_LIST_DESCENDANTS) {\n        /* We could just always do a topological visit; but it is\n         * possible to optimize for less stack usage and time when a\n         * simpler full hashtable visit or counter will do. */\n        if (from->def || (names &&\n                          (flags & VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL)))\n            virDomainMomentForEachDescendant(from,\n                                             virDomainMomentObjListCopyNames,\n                                             &data);\n        else if (names || data.flags || filter_flags)\n            virHashForEach(moments->objs, virDomainMomentObjListCopyNames,\n                           &data);\n        else\n            data.count = virHashSize(moments->objs);\n    } else if (names || data.flags || filter_flags) {\n        virDomainMomentForEachChild(from,\n                                    virDomainMomentObjListCopyNames, &data);\n    } else {\n        data.count = from->nchildren;\n    }\n\n    if (data.error) {\n        for (i = 0; i < data.count; i++)\n            VIR_FREE(names[i]);\n        return -1;\n    }\n\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentObjListGetNames(virDomainMomentObjListPtr moments,\n                               virDomainMomentObjPtr from,\n                               char **const names,\n                               int maxnames,\n                               unsigned int flags,\n                               virDomainMomentObjListFilter filter,\n                               unsigned int filter_flags)\n{\n    struct virDomainMomentNameData data = { names, maxnames, flags, 0,\n                                            false, filter, filter_flags };\n    size_t i;\n\n    virCheckFlags(VIR_DOMAIN_MOMENT_FILTERS_ALL, -1);\n    if (!from) {\n        /* LIST_ROOTS and LIST_DESCENDANTS have the same bit value,\n         * but opposite semantics.  Toggle here to get the correct\n         * traversal on the metaroot.  */\n        flags ^= VIR_DOMAIN_MOMENT_LIST_ROOTS;\n        from = &moments->metaroot;\n    }\n\n    /* We handle LIST_ROOT/LIST_DESCENDANTS and LIST_TOPOLOGICAL directly,\n     * mask those bits out to determine when we must use the filter callback. */\n    data.flags &= ~(VIR_DOMAIN_MOMENT_LIST_DESCENDANTS |\n                    VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n\n    /* If this common code is being used, we assume that all moments\n     * have metadata, and thus can handle METADATA up front as an\n     * all-or-none filter.  XXX This might not always be true, if we\n     * add the ability to track qcow2 internal snapshots without the\n     * use of metadata, in which case this check should move into the\n     * filter callback.  */\n    if ((data.flags & VIR_DOMAIN_MOMENT_FILTERS_METADATA) ==\n        VIR_DOMAIN_MOMENT_LIST_NO_METADATA)\n        return 0;\n    data.flags &= ~VIR_DOMAIN_MOMENT_FILTERS_METADATA;\n\n    if (flags & VIR_DOMAIN_MOMENT_LIST_DESCENDANTS) {\n        /* We could just always do a topological visit; but it is\n         * possible to optimize for less stack usage and time when a\n         * simpler full hashtable visit or counter will do. */\n        if (from->def || (names &&\n                          (flags & VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL)))\n            virDomainMomentForEachDescendant(from,\n                                             virDomainMomentObjListCopyNames,\n                                             &data);\n        else if (names || data.flags || filter_flags)\n            virHashForEach(moments->objs, virDomainMomentObjListCopyNames,\n                           &data);\n        else\n            data.count = virHashSize(moments->objs);\n    } else if (names || data.flags || filter_flags) {\n        virDomainMomentForEachChild(from,\n                                    virDomainMomentObjListCopyNames, &data);\n    } else {\n        data.count = from->nchildren;\n    }\n\n    if (data.error) {\n        for (i = 0; i < data.count; i++)\n            VIR_FREE(names[i]);\n        return -1;\n    }\n\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "map"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainSnapshotObjListGetNames(virDomainSnapshotObjListPtr snapshots,\n                                 virDomainMomentObjPtr from,\n                                 char **const names,\n                                 int maxnames,\n                                 unsigned int flags)\n{\n    /* Convert public flags into common flags */\n    unsigned int moment_flags = 0;\n    struct { int snap_flag; int moment_flag; } map[] = {\n        { VIR_DOMAIN_SNAPSHOT_LIST_ROOTS,\n          VIR_DOMAIN_MOMENT_LIST_ROOTS, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_TOPOLOGICAL,\n          VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_LEAVES,\n          VIR_DOMAIN_MOMENT_LIST_NO_LEAVES, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_METADATA, },\n        { VIR_DOMAIN_SNAPSHOT_LIST_NO_METADATA,\n          VIR_DOMAIN_MOMENT_LIST_NO_METADATA, },\n    };\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(map); i++) {\n        if (flags & map[i].snap_flag) {\n            flags &= ~map[i].snap_flag;\n            moment_flags |= map[i].moment_flag;\n        }\n    }\n\n    /* For ease of coding the visitor, it is easier to zero each group\n     * where all of the bits are set.  */\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LEAVES;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION) ==\n        VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION)\n        flags &= ~VIR_DOMAIN_SNAPSHOT_FILTERS_LOCATION;\n    return virDomainMomentObjListGetNames(snapshots->base, from, names,\n                                          maxnames, moment_flags,\n                                          virDomainSnapshotFilter, flags);\n}"
  },
  {
    "function_name": "virDomainSnapshotObjListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "99-106",
    "snippet": "void\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "snapshots"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMomentObjListFree",
          "args": [
            "snapshots->base"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "288-295",
          "snippet": "void\nvirDomainMomentObjListFree(virDomainMomentObjListPtr moments)\n{\n    if (!moments)\n        return;\n    virHashFree(moments->objs);\n    VIR_FREE(moments);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentObjListFree(virDomainMomentObjListPtr moments)\n{\n    if (!moments)\n        return;\n    virHashFree(moments->objs);\n    VIR_FREE(moments);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainSnapshotObjListFree(virDomainSnapshotObjListPtr snapshots)\n{\n    if (!snapshots)\n        return;\n    virDomainMomentObjListFree(snapshots->base);\n    VIR_FREE(snapshots);\n}"
  },
  {
    "function_name": "virDomainSnapshotObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "83-96",
    "snippet": "virDomainSnapshotObjListPtr\nvirDomainSnapshotObjListNew(void)\n{\n    virDomainSnapshotObjListPtr snapshots;\n\n    if (VIR_ALLOC(snapshots) < 0)\n        return NULL;\n    snapshots->base = virDomainMomentObjListNew();\n    if (!snapshots->base) {\n        VIR_FREE(snapshots);\n        return NULL;\n    }\n    return snapshots;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "snapshots"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMomentObjListNew",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "273-286",
          "snippet": "virDomainMomentObjListPtr\nvirDomainMomentObjListNew(void)\n{\n    virDomainMomentObjListPtr moments;\n\n    if (VIR_ALLOC(moments) < 0)\n        return NULL;\n    moments->objs = virHashCreate(50, virDomainMomentObjListDataFree);\n    if (!moments->objs) {\n        VIR_FREE(moments);\n        return NULL;\n    }\n    return moments;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjListPtr\nvirDomainMomentObjListNew(void)\n{\n    virDomainMomentObjListPtr moments;\n\n    if (VIR_ALLOC(moments) < 0)\n        return NULL;\n    moments->objs = virHashCreate(50, virDomainMomentObjListDataFree);\n    if (!moments->objs) {\n        VIR_FREE(moments);\n        return NULL;\n    }\n    return moments;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "snapshots"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainSnapshotObjListPtr\nvirDomainSnapshotObjListNew(void)\n{\n    virDomainSnapshotObjListPtr snapshots;\n\n    if (VIR_ALLOC(snapshots) < 0)\n        return NULL;\n    snapshots->base = virDomainMomentObjListNew();\n    if (!snapshots->base) {\n        VIR_FREE(snapshots);\n        return NULL;\n    }\n    return snapshots;\n}"
  },
  {
    "function_name": "virDomainSnapshotFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "51-80",
    "snippet": "static bool\nvirDomainSnapshotFilter(virDomainMomentObjPtr obj,\n                        unsigned int flags)\n{\n    virDomainSnapshotDefPtr def = virDomainSnapshotObjGetDef(obj);\n\n    /* Caller has already sanitized flags and performed filtering on\n     * DESCENDANTS and LEAVES. */\n    if (flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) {\n        if (!(flags & VIR_DOMAIN_SNAPSHOT_LIST_INACTIVE) &&\n            def->state == VIR_DOMAIN_SNAPSHOT_SHUTOFF)\n            return false;\n        if (!(flags & VIR_DOMAIN_SNAPSHOT_LIST_DISK_ONLY) &&\n            def->state == VIR_DOMAIN_SNAPSHOT_DISK_SNAPSHOT)\n            return false;\n        if (!(flags & VIR_DOMAIN_SNAPSHOT_LIST_ACTIVE) &&\n            def->state != VIR_DOMAIN_SNAPSHOT_SHUTOFF &&\n            def->state != VIR_DOMAIN_SNAPSHOT_DISK_SNAPSHOT)\n            return false;\n    }\n\n    if ((flags & VIR_DOMAIN_SNAPSHOT_LIST_INTERNAL) &&\n        virDomainSnapshotIsExternal(obj))\n        return false;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_LIST_EXTERNAL) &&\n        !virDomainSnapshotIsExternal(obj))\n        return false;\n\n    return true;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainSnapshotIsExternal",
          "args": [
            "obj"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotIsExternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/snapshot_conf.c",
          "lines": "961-967",
          "snippet": "bool\nvirDomainSnapshotIsExternal(virDomainMomentObjPtr snap)\n{\n    virDomainSnapshotDefPtr def = virDomainSnapshotObjGetDef(snap);\n\n    return virDomainSnapshotDefIsExternal(def);\n}",
          "includes": [
            "#include \"snapshot_conf_priv.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virbitmap.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"snapshot_conf_priv.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virstoragefile.h\"\n#include \"snapshot_conf.h\"\n#include \"secret_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"virbitmap.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainSnapshotIsExternal(virDomainMomentObjPtr snap)\n{\n    virDomainSnapshotDefPtr def = virDomainSnapshotObjGetDef(snap);\n\n    return virDomainSnapshotDefIsExternal(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSnapshotObjGetDef",
          "args": [
            "obj"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainSnapshotObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.h",
          "lines": "91-95",
          "snippet": "static inline virDomainSnapshotDefPtr\nvirDomainSnapshotObjGetDef(virDomainMomentObjPtr obj)\n{\n    return (virDomainSnapshotDefPtr) obj->def;\n}",
          "includes": [
            "#include \"virbuffer.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "virDomainMomentObjPtr virDomainSnapshotAssignDef(virDomainSnapshotObjListPtr snapshots,\n                                                 virDomainSnapshotDefPtr def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virbuffer.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n\nvirDomainMomentObjPtr virDomainSnapshotAssignDef(virDomainSnapshotObjListPtr snapshots,\n                                                 virDomainSnapshotDefPtr def);\n\nstatic inline virDomainSnapshotDefPtr\nvirDomainSnapshotObjGetDef(virDomainMomentObjPtr obj)\n{\n    return (virDomainSnapshotDefPtr) obj->def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirDomainSnapshotFilter(virDomainMomentObjPtr obj,\n                        unsigned int flags)\n{\n    virDomainSnapshotDefPtr def = virDomainSnapshotObjGetDef(obj);\n\n    /* Caller has already sanitized flags and performed filtering on\n     * DESCENDANTS and LEAVES. */\n    if (flags & VIR_DOMAIN_SNAPSHOT_FILTERS_STATUS) {\n        if (!(flags & VIR_DOMAIN_SNAPSHOT_LIST_INACTIVE) &&\n            def->state == VIR_DOMAIN_SNAPSHOT_SHUTOFF)\n            return false;\n        if (!(flags & VIR_DOMAIN_SNAPSHOT_LIST_DISK_ONLY) &&\n            def->state == VIR_DOMAIN_SNAPSHOT_DISK_SNAPSHOT)\n            return false;\n        if (!(flags & VIR_DOMAIN_SNAPSHOT_LIST_ACTIVE) &&\n            def->state != VIR_DOMAIN_SNAPSHOT_SHUTOFF &&\n            def->state != VIR_DOMAIN_SNAPSHOT_DISK_SNAPSHOT)\n            return false;\n    }\n\n    if ((flags & VIR_DOMAIN_SNAPSHOT_LIST_INTERNAL) &&\n        virDomainSnapshotIsExternal(obj))\n        return false;\n    if ((flags & VIR_DOMAIN_SNAPSHOT_LIST_EXTERNAL) &&\n        !virDomainSnapshotIsExternal(obj))\n        return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virDomainSnapshotAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainsnapshotobjlist.c",
    "lines": "43-48",
    "snippet": "virDomainMomentObjPtr\nvirDomainSnapshotAssignDef(virDomainSnapshotObjListPtr snapshots,\n                           virDomainSnapshotDefPtr def)\n{\n    return virDomainMomentAssignDef(snapshots->base, &def->parent);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virstring.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"snapshot_conf.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentAssignDef",
          "args": [
            "snapshots->base",
            "&def->parent"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "238-261",
          "snippet": "virDomainMomentObjPtr\nvirDomainMomentAssignDef(virDomainMomentObjListPtr moments,\n                         virDomainMomentDefPtr def)\n{\n    virDomainMomentObjPtr moment;\n\n    if (virHashLookup(moments->objs, def->name) != NULL) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"domain moment %s already exists\"),\n                       def->name);\n        return NULL;\n    }\n\n    if (!(moment = virDomainMomentObjNew()))\n        return NULL;\n\n    if (virHashAddEntry(moments->objs, def->name, moment) < 0) {\n        VIR_FREE(moment);\n        return NULL;\n    }\n    moment->def = def;\n\n    return moment;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentAssignDef(virDomainMomentObjListPtr moments,\n                         virDomainMomentDefPtr def)\n{\n    virDomainMomentObjPtr moment;\n\n    if (virHashLookup(moments->objs, def->name) != NULL) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"domain moment %s already exists\"),\n                       def->name);\n        return NULL;\n    }\n\n    if (!(moment = virDomainMomentObjNew()))\n        return NULL;\n\n    if (virHashAddEntry(moments->objs, def->name, moment) < 0) {\n        VIR_FREE(moment);\n        return NULL;\n    }\n    moment->def = def;\n\n    return moment;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"snapshot_conf.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainSnapshotAssignDef(virDomainSnapshotObjListPtr snapshots,\n                           virDomainSnapshotDefPtr def)\n{\n    return virDomainMomentAssignDef(snapshots->base, &def->parent);\n}"
  }
]