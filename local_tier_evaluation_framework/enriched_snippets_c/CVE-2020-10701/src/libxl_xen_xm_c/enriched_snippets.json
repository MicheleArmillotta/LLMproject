[
  {
    "function_name": "xenFormatXM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "588-610",
    "snippet": "virConfPtr\nxenFormatXM(virConnectPtr conn,\n            virDomainDefPtr def)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (!(conf = virConfNew()))\n        return NULL;\n\n    if (xenFormatConfigCommon(conf, def, conn, XEN_CONFIG_FORMAT_XM) < 0)\n        return NULL;\n\n    if (xenFormatXMOS(conf, def) < 0)\n        return NULL;\n\n    if (xenFormatXMDisks(conf, def) < 0)\n        return NULL;\n\n    if (xenFormatXMInputDevs(conf, def) < 0)\n        return NULL;\n\n    return g_steal_pointer(&conf);\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&conf"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xenFormatXMInputDevs",
          "args": [
            "conf",
            "def"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "xenFormatXMInputDevs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
          "lines": "546-578",
          "snippet": "static int\nxenFormatXMInputDevs(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n    const char *devtype;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        for (i = 0; i < def->ninputs; i++) {\n            if (def->inputs[i]->bus == VIR_DOMAIN_INPUT_BUS_USB) {\n                if (xenConfigSetInt(conf, \"usb\", 1) < 0)\n                    return -1;\n\n                switch (def->inputs[i]->type) {\n                    case VIR_DOMAIN_INPUT_TYPE_MOUSE:\n                        devtype = \"mouse\";\n                        break;\n                    case VIR_DOMAIN_INPUT_TYPE_TABLET:\n                        devtype = \"tablet\";\n                        break;\n                    case VIR_DOMAIN_INPUT_TYPE_KBD:\n                        devtype = \"keyboard\";\n                        break;\n                    default:\n                        continue;\n                }\n                if (xenConfigSetString(conf, \"usbdevice\", devtype) < 0)\n                    return -1;\n                break;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xen_xm.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenFormatXMInputDevs(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n    const char *devtype;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        for (i = 0; i < def->ninputs; i++) {\n            if (def->inputs[i]->bus == VIR_DOMAIN_INPUT_BUS_USB) {\n                if (xenConfigSetInt(conf, \"usb\", 1) < 0)\n                    return -1;\n\n                switch (def->inputs[i]->type) {\n                    case VIR_DOMAIN_INPUT_TYPE_MOUSE:\n                        devtype = \"mouse\";\n                        break;\n                    case VIR_DOMAIN_INPUT_TYPE_TABLET:\n                        devtype = \"tablet\";\n                        break;\n                    case VIR_DOMAIN_INPUT_TYPE_KBD:\n                        devtype = \"keyboard\";\n                        break;\n                    default:\n                        continue;\n                }\n                if (xenConfigSetString(conf, \"usbdevice\", devtype) < 0)\n                    return -1;\n                break;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenFormatXMDisks",
          "args": [
            "conf",
            "def"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "xenFormatXMDisks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
          "lines": "369-402",
          "snippet": "static int\nxenFormatXMDisks(virConfPtr conf, virDomainDefPtr def)\n{\n    virConfValuePtr diskVal = NULL;\n    size_t i = 0;\n\n    if (VIR_ALLOC(diskVal) < 0)\n        goto cleanup;\n\n    diskVal->type = VIR_CONF_LIST;\n    diskVal->list = NULL;\n\n    for (i = 0; i < def->ndisks; i++) {\n        if (def->disks[i]->device == VIR_DOMAIN_DISK_DEVICE_FLOPPY)\n            continue;\n\n        if (xenFormatXMDisk(diskVal, def->disks[i]) < 0)\n            goto cleanup;\n    }\n\n    if (diskVal->list != NULL) {\n        int ret = virConfSetValue(conf, \"disk\", diskVal);\n        diskVal = NULL;\n        if (ret < 0)\n            goto cleanup;\n    }\n    VIR_FREE(diskVal);\n\n    return 0;\n\n cleanup:\n    virConfFreeValue(diskVal);\n    return -1;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xen_xm.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenFormatXMDisks(virConfPtr conf, virDomainDefPtr def)\n{\n    virConfValuePtr diskVal = NULL;\n    size_t i = 0;\n\n    if (VIR_ALLOC(diskVal) < 0)\n        goto cleanup;\n\n    diskVal->type = VIR_CONF_LIST;\n    diskVal->list = NULL;\n\n    for (i = 0; i < def->ndisks; i++) {\n        if (def->disks[i]->device == VIR_DOMAIN_DISK_DEVICE_FLOPPY)\n            continue;\n\n        if (xenFormatXMDisk(diskVal, def->disks[i]) < 0)\n            goto cleanup;\n    }\n\n    if (diskVal->list != NULL) {\n        int ret = virConfSetValue(conf, \"disk\", diskVal);\n        diskVal = NULL;\n        if (ret < 0)\n            goto cleanup;\n    }\n    VIR_FREE(diskVal);\n\n    return 0;\n\n cleanup:\n    virConfFreeValue(diskVal);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenFormatXMOS",
          "args": [
            "conf",
            "def"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "xenFormatXMOS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
          "lines": "477-543",
          "snippet": "static int\nxenFormatXMOS(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        char boot[VIR_DOMAIN_BOOT_LAST+1];\n        if (xenConfigSetString(conf, \"builder\", \"hvm\") < 0)\n            return -1;\n\n        if (def->os.loader && def->os.loader->path &&\n            xenConfigSetString(conf, \"kernel\", def->os.loader->path) < 0)\n            return -1;\n\n        for (i = 0; i < def->os.nBootDevs; i++) {\n            switch (def->os.bootDevs[i]) {\n            case VIR_DOMAIN_BOOT_FLOPPY:\n                boot[i] = 'a';\n                break;\n            case VIR_DOMAIN_BOOT_CDROM:\n                boot[i] = 'd';\n                break;\n            case VIR_DOMAIN_BOOT_NET:\n                boot[i] = 'n';\n                break;\n            case VIR_DOMAIN_BOOT_DISK:\n            default:\n                boot[i] = 'c';\n                break;\n            }\n        }\n\n        if (!def->os.nBootDevs) {\n            boot[0] = 'c';\n            boot[1] = '\\0';\n        } else {\n            boot[def->os.nBootDevs] = '\\0';\n        }\n\n        if (xenConfigSetString(conf, \"boot\", boot) < 0)\n            return -1;\n\n        /* XXX floppy disks */\n    } else {\n        if (def->os.bootloader &&\n             xenConfigSetString(conf, \"bootloader\", def->os.bootloader) < 0)\n            return -1;\n\n         if (def->os.bootloaderArgs &&\n             xenConfigSetString(conf, \"bootargs\", def->os.bootloaderArgs) < 0)\n            return -1;\n\n         if (def->os.kernel &&\n             xenConfigSetString(conf, \"kernel\", def->os.kernel) < 0)\n            return -1;\n\n         if (def->os.initrd &&\n             xenConfigSetString(conf, \"ramdisk\", def->os.initrd) < 0)\n            return -1;\n\n         if (def->os.cmdline &&\n             xenConfigSetString(conf, \"extra\", def->os.cmdline) < 0)\n            return -1;\n     } /* !hvm */\n\n    return 0;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xen_xm.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenFormatXMOS(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        char boot[VIR_DOMAIN_BOOT_LAST+1];\n        if (xenConfigSetString(conf, \"builder\", \"hvm\") < 0)\n            return -1;\n\n        if (def->os.loader && def->os.loader->path &&\n            xenConfigSetString(conf, \"kernel\", def->os.loader->path) < 0)\n            return -1;\n\n        for (i = 0; i < def->os.nBootDevs; i++) {\n            switch (def->os.bootDevs[i]) {\n            case VIR_DOMAIN_BOOT_FLOPPY:\n                boot[i] = 'a';\n                break;\n            case VIR_DOMAIN_BOOT_CDROM:\n                boot[i] = 'd';\n                break;\n            case VIR_DOMAIN_BOOT_NET:\n                boot[i] = 'n';\n                break;\n            case VIR_DOMAIN_BOOT_DISK:\n            default:\n                boot[i] = 'c';\n                break;\n            }\n        }\n\n        if (!def->os.nBootDevs) {\n            boot[0] = 'c';\n            boot[1] = '\\0';\n        } else {\n            boot[def->os.nBootDevs] = '\\0';\n        }\n\n        if (xenConfigSetString(conf, \"boot\", boot) < 0)\n            return -1;\n\n        /* XXX floppy disks */\n    } else {\n        if (def->os.bootloader &&\n             xenConfigSetString(conf, \"bootloader\", def->os.bootloader) < 0)\n            return -1;\n\n         if (def->os.bootloaderArgs &&\n             xenConfigSetString(conf, \"bootargs\", def->os.bootloaderArgs) < 0)\n            return -1;\n\n         if (def->os.kernel &&\n             xenConfigSetString(conf, \"kernel\", def->os.kernel) < 0)\n            return -1;\n\n         if (def->os.initrd &&\n             xenConfigSetString(conf, \"ramdisk\", def->os.initrd) < 0)\n            return -1;\n\n         if (def->os.cmdline &&\n             xenConfigSetString(conf, \"extra\", def->os.cmdline) < 0)\n            return -1;\n     } /* !hvm */\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenFormatConfigCommon",
          "args": [
            "conf",
            "def",
            "conn",
            "XEN_CONFIG_FORMAT_XM"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "xenFormatConfigCommon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_common.c",
          "lines": "2398-2450",
          "snippet": "int\nxenFormatConfigCommon(virConfPtr conf,\n                      virDomainDefPtr def,\n                      virConnectPtr conn,\n                      const char *nativeFormat)\n{\n    if (xenFormatGeneralMeta(conf, def) < 0)\n        return -1;\n\n    if (xenFormatMem(conf, def) < 0)\n        return -1;\n\n    if (xenFormatCPUAllocation(conf, def) < 0)\n        return -1;\n\n    if (xenFormatCPUFeatures(conf, def) < 0)\n        return -1;\n\n    if (xenFormatTimeOffset(conf, def) < 0)\n        return -1;\n\n    if (xenFormatEventActions(conf, def) < 0)\n        return -1;\n\n    if (xenFormatEmulator(conf, def) < 0)\n        return -1;\n\n    if (xenFormatVfb(conf, def) < 0)\n        return -1;\n\n    if (STREQ(nativeFormat, XEN_CONFIG_FORMAT_XL)) {\n        if (xenFormatVif(conf, conn, def, \"vif\") < 0)\n            return -1;\n    } else if (STREQ(nativeFormat, XEN_CONFIG_FORMAT_XM)) {\n        if (xenFormatVif(conf, conn, def, \"netfront\") < 0)\n            return -1;\n    } else {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported config type %s\"), nativeFormat);\n        return -1;\n    }\n\n    if (xenFormatPCI(conf, def) < 0)\n        return -1;\n\n    if (xenFormatCharDev(conf, def, nativeFormat) < 0)\n        return -1;\n\n    if (xenFormatSound(conf, def) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xenxs_private.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nxenFormatConfigCommon(virConfPtr conf,\n                      virDomainDefPtr def,\n                      virConnectPtr conn,\n                      const char *nativeFormat)\n{\n    if (xenFormatGeneralMeta(conf, def) < 0)\n        return -1;\n\n    if (xenFormatMem(conf, def) < 0)\n        return -1;\n\n    if (xenFormatCPUAllocation(conf, def) < 0)\n        return -1;\n\n    if (xenFormatCPUFeatures(conf, def) < 0)\n        return -1;\n\n    if (xenFormatTimeOffset(conf, def) < 0)\n        return -1;\n\n    if (xenFormatEventActions(conf, def) < 0)\n        return -1;\n\n    if (xenFormatEmulator(conf, def) < 0)\n        return -1;\n\n    if (xenFormatVfb(conf, def) < 0)\n        return -1;\n\n    if (STREQ(nativeFormat, XEN_CONFIG_FORMAT_XL)) {\n        if (xenFormatVif(conf, conn, def, \"vif\") < 0)\n            return -1;\n    } else if (STREQ(nativeFormat, XEN_CONFIG_FORMAT_XM)) {\n        if (xenFormatVif(conf, conn, def, \"netfront\") < 0)\n            return -1;\n    } else {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported config type %s\"), nativeFormat);\n        return -1;\n    }\n\n    if (xenFormatPCI(conf, def) < 0)\n        return -1;\n\n    if (xenFormatCharDev(conf, def, nativeFormat) < 0)\n        return -1;\n\n    if (xenFormatSound(conf, def) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfNew",
          "args": [],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "virConfNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "161-172",
          "snippet": "virConfPtr\nvirConfNew(void)\n{\n    virConfPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n    ret->filename = NULL;\n    ret->flags = 0;\n\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfPtr\nvirConfNew(void)\n{\n    virConfPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n    ret->filename = NULL;\n    ret->flags = 0;\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirConfPtr\nxenFormatXM(virConnectPtr conn,\n            virDomainDefPtr def)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (!(conf = virConfNew()))\n        return NULL;\n\n    if (xenFormatConfigCommon(conf, def, conn, XEN_CONFIG_FORMAT_XM) < 0)\n        return NULL;\n\n    if (xenFormatXMOS(conf, def) < 0)\n        return NULL;\n\n    if (xenFormatXMDisks(conf, def) < 0)\n        return NULL;\n\n    if (xenFormatXMInputDevs(conf, def) < 0)\n        return NULL;\n\n    return g_steal_pointer(&conf);\n}"
  },
  {
    "function_name": "xenFormatXMInputDevs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "546-578",
    "snippet": "static int\nxenFormatXMInputDevs(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n    const char *devtype;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        for (i = 0; i < def->ninputs; i++) {\n            if (def->inputs[i]->bus == VIR_DOMAIN_INPUT_BUS_USB) {\n                if (xenConfigSetInt(conf, \"usb\", 1) < 0)\n                    return -1;\n\n                switch (def->inputs[i]->type) {\n                    case VIR_DOMAIN_INPUT_TYPE_MOUSE:\n                        devtype = \"mouse\";\n                        break;\n                    case VIR_DOMAIN_INPUT_TYPE_TABLET:\n                        devtype = \"tablet\";\n                        break;\n                    case VIR_DOMAIN_INPUT_TYPE_KBD:\n                        devtype = \"keyboard\";\n                        break;\n                    default:\n                        continue;\n                }\n                if (xenConfigSetString(conf, \"usbdevice\", devtype) < 0)\n                    return -1;\n                break;\n            }\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xenConfigSetString",
          "args": [
            "conf",
            "\"usbdevice\"",
            "devtype"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "xenConfigSetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_common.c",
          "lines": "267-280",
          "snippet": "int\nxenConfigSetString(virConfPtr conf, const char *setting, const char *str)\n{\n    virConfValuePtr value = NULL;\n\n    if (VIR_ALLOC(value) < 0)\n        return -1;\n\n    value->type = VIR_CONF_STRING;\n    value->next = NULL;\n    value->str = g_strdup(str);\n\n    return virConfSetValue(conf, setting, value);\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xenxs_private.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nxenConfigSetString(virConfPtr conf, const char *setting, const char *str)\n{\n    virConfValuePtr value = NULL;\n\n    if (VIR_ALLOC(value) < 0)\n        return -1;\n\n    value->type = VIR_CONF_STRING;\n    value->next = NULL;\n    value->str = g_strdup(str);\n\n    return virConfSetValue(conf, setting, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenConfigSetInt",
          "args": [
            "conf",
            "\"usb\"",
            "1"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "xenConfigSetInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_common.c",
          "lines": "246-264",
          "snippet": "int\nxenConfigSetInt(virConfPtr conf, const char *setting, long long l)\n{\n    virConfValuePtr value = NULL;\n\n    if ((long)l != l) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"failed to store %lld to %s\"),\n                       l, setting);\n        return -1;\n    }\n    if (VIR_ALLOC(value) < 0)\n        return -1;\n\n    value->type = VIR_CONF_LLONG;\n    value->next = NULL;\n    value->l = l;\n\n    return virConfSetValue(conf, setting, value);\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xenxs_private.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nxenConfigSetInt(virConfPtr conf, const char *setting, long long l)\n{\n    virConfValuePtr value = NULL;\n\n    if ((long)l != l) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"failed to store %lld to %s\"),\n                       l, setting);\n        return -1;\n    }\n    if (VIR_ALLOC(value) < 0)\n        return -1;\n\n    value->type = VIR_CONF_LLONG;\n    value->next = NULL;\n    value->l = l;\n\n    return virConfSetValue(conf, setting, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenFormatXMInputDevs(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n    const char *devtype;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        for (i = 0; i < def->ninputs; i++) {\n            if (def->inputs[i]->bus == VIR_DOMAIN_INPUT_BUS_USB) {\n                if (xenConfigSetInt(conf, \"usb\", 1) < 0)\n                    return -1;\n\n                switch (def->inputs[i]->type) {\n                    case VIR_DOMAIN_INPUT_TYPE_MOUSE:\n                        devtype = \"mouse\";\n                        break;\n                    case VIR_DOMAIN_INPUT_TYPE_TABLET:\n                        devtype = \"tablet\";\n                        break;\n                    case VIR_DOMAIN_INPUT_TYPE_KBD:\n                        devtype = \"keyboard\";\n                        break;\n                    default:\n                        continue;\n                }\n                if (xenConfigSetString(conf, \"usbdevice\", devtype) < 0)\n                    return -1;\n                break;\n            }\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "xenFormatXMOS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "477-543",
    "snippet": "static int\nxenFormatXMOS(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        char boot[VIR_DOMAIN_BOOT_LAST+1];\n        if (xenConfigSetString(conf, \"builder\", \"hvm\") < 0)\n            return -1;\n\n        if (def->os.loader && def->os.loader->path &&\n            xenConfigSetString(conf, \"kernel\", def->os.loader->path) < 0)\n            return -1;\n\n        for (i = 0; i < def->os.nBootDevs; i++) {\n            switch (def->os.bootDevs[i]) {\n            case VIR_DOMAIN_BOOT_FLOPPY:\n                boot[i] = 'a';\n                break;\n            case VIR_DOMAIN_BOOT_CDROM:\n                boot[i] = 'd';\n                break;\n            case VIR_DOMAIN_BOOT_NET:\n                boot[i] = 'n';\n                break;\n            case VIR_DOMAIN_BOOT_DISK:\n            default:\n                boot[i] = 'c';\n                break;\n            }\n        }\n\n        if (!def->os.nBootDevs) {\n            boot[0] = 'c';\n            boot[1] = '\\0';\n        } else {\n            boot[def->os.nBootDevs] = '\\0';\n        }\n\n        if (xenConfigSetString(conf, \"boot\", boot) < 0)\n            return -1;\n\n        /* XXX floppy disks */\n    } else {\n        if (def->os.bootloader &&\n             xenConfigSetString(conf, \"bootloader\", def->os.bootloader) < 0)\n            return -1;\n\n         if (def->os.bootloaderArgs &&\n             xenConfigSetString(conf, \"bootargs\", def->os.bootloaderArgs) < 0)\n            return -1;\n\n         if (def->os.kernel &&\n             xenConfigSetString(conf, \"kernel\", def->os.kernel) < 0)\n            return -1;\n\n         if (def->os.initrd &&\n             xenConfigSetString(conf, \"ramdisk\", def->os.initrd) < 0)\n            return -1;\n\n         if (def->os.cmdline &&\n             xenConfigSetString(conf, \"extra\", def->os.cmdline) < 0)\n            return -1;\n     } /* !hvm */\n\n    return 0;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xenConfigSetString",
          "args": [
            "conf",
            "\"extra\"",
            "def->os.cmdline"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "xenConfigSetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_common.c",
          "lines": "267-280",
          "snippet": "int\nxenConfigSetString(virConfPtr conf, const char *setting, const char *str)\n{\n    virConfValuePtr value = NULL;\n\n    if (VIR_ALLOC(value) < 0)\n        return -1;\n\n    value->type = VIR_CONF_STRING;\n    value->next = NULL;\n    value->str = g_strdup(str);\n\n    return virConfSetValue(conf, setting, value);\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xenxs_private.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nxenConfigSetString(virConfPtr conf, const char *setting, const char *str)\n{\n    virConfValuePtr value = NULL;\n\n    if (VIR_ALLOC(value) < 0)\n        return -1;\n\n    value->type = VIR_CONF_STRING;\n    value->next = NULL;\n    value->str = g_strdup(str);\n\n    return virConfSetValue(conf, setting, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenFormatXMOS(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        char boot[VIR_DOMAIN_BOOT_LAST+1];\n        if (xenConfigSetString(conf, \"builder\", \"hvm\") < 0)\n            return -1;\n\n        if (def->os.loader && def->os.loader->path &&\n            xenConfigSetString(conf, \"kernel\", def->os.loader->path) < 0)\n            return -1;\n\n        for (i = 0; i < def->os.nBootDevs; i++) {\n            switch (def->os.bootDevs[i]) {\n            case VIR_DOMAIN_BOOT_FLOPPY:\n                boot[i] = 'a';\n                break;\n            case VIR_DOMAIN_BOOT_CDROM:\n                boot[i] = 'd';\n                break;\n            case VIR_DOMAIN_BOOT_NET:\n                boot[i] = 'n';\n                break;\n            case VIR_DOMAIN_BOOT_DISK:\n            default:\n                boot[i] = 'c';\n                break;\n            }\n        }\n\n        if (!def->os.nBootDevs) {\n            boot[0] = 'c';\n            boot[1] = '\\0';\n        } else {\n            boot[def->os.nBootDevs] = '\\0';\n        }\n\n        if (xenConfigSetString(conf, \"boot\", boot) < 0)\n            return -1;\n\n        /* XXX floppy disks */\n    } else {\n        if (def->os.bootloader &&\n             xenConfigSetString(conf, \"bootloader\", def->os.bootloader) < 0)\n            return -1;\n\n         if (def->os.bootloaderArgs &&\n             xenConfigSetString(conf, \"bootargs\", def->os.bootloaderArgs) < 0)\n            return -1;\n\n         if (def->os.kernel &&\n             xenConfigSetString(conf, \"kernel\", def->os.kernel) < 0)\n            return -1;\n\n         if (def->os.initrd &&\n             xenConfigSetString(conf, \"ramdisk\", def->os.initrd) < 0)\n            return -1;\n\n         if (def->os.cmdline &&\n             xenConfigSetString(conf, \"extra\", def->os.cmdline) < 0)\n            return -1;\n     } /* !hvm */\n\n    return 0;\n}"
  },
  {
    "function_name": "xenParseXM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "440-475",
    "snippet": "virDomainDefPtr\nxenParseXM(virConfPtr conf,\n           virCapsPtr caps,\n           virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDefPtr def = NULL;\n\n    if (!(def = virDomainDefNew()))\n        return NULL;\n\n    def->virtType = VIR_DOMAIN_VIRT_XEN;\n    def->id = -1;\n\n    if (xenParseConfigCommon(conf, def, caps, XEN_CONFIG_FORMAT_XM,\n                             xmlopt) < 0)\n        goto cleanup;\n\n    if (xenParseXMOS(conf, def) < 0)\n         goto cleanup;\n\n    if (xenParseXMDiskList(conf, def) < 0)\n         goto cleanup;\n\n    if (xenParseXMInputDevs(conf, def) < 0)\n         goto cleanup;\n\n    if (virDomainDefPostParse(def, VIR_DOMAIN_DEF_PARSE_ABI_UPDATE,\n                              xmlopt, NULL) < 0)\n        goto cleanup;\n\n    return def;\n\n cleanup:\n    virDomainDefFree(def);\n    return NULL;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefPostParse",
          "args": [
            "def",
            "VIR_DOMAIN_DEF_PARSE_ABI_UPDATE",
            "xmlopt",
            "NULL"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefPostParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "5869-5953",
          "snippet": "int\nvirDomainDefPostParse(virDomainDefPtr def,\n                      unsigned int parseFlags,\n                      virDomainXMLOptionPtr xmlopt,\n                      void *parseOpaque)\n{\n    int ret = -1;\n    bool localParseOpaque = false;\n    struct virDomainDefPostParseDeviceIteratorData data = {\n        .xmlopt = xmlopt,\n        .parseFlags = parseFlags,\n        .parseOpaque = parseOpaque,\n    };\n\n    def->postParseFailed = false;\n\n    /* call the basic post parse callback */\n    if (xmlopt->config.domainPostParseBasicCallback) {\n        ret = xmlopt->config.domainPostParseBasicCallback(def,\n                                                          xmlopt->config.priv);\n\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    if (!data.parseOpaque &&\n        xmlopt->config.domainPostParseDataAlloc) {\n        ret = xmlopt->config.domainPostParseDataAlloc(def, parseFlags,\n                                                      xmlopt->config.priv,\n                                                      &data.parseOpaque);\n\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n        localParseOpaque = true;\n    }\n\n    /* this must be done before the hypervisor-specific callback,\n     * in case presence of a controller at a specific index is checked\n     */\n    virDomainAssignControllerIndexes(def);\n\n    /* call the domain config callback */\n    if (xmlopt->config.domainPostParseCallback) {\n        ret = xmlopt->config.domainPostParseCallback(def, parseFlags,\n                                                     xmlopt->config.priv,\n                                                     data.parseOpaque);\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    /* iterate the devices */\n    ret = virDomainDeviceInfoIterateInternal(def,\n                                             virDomainDefPostParseDeviceIterator,\n                                             DOMAIN_DEVICE_ITERATE_ALL_CONSOLES |\n                                             DOMAIN_DEVICE_ITERATE_MISSING_INFO,\n                                             &data);\n\n    if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n        goto cleanup;\n\n    if ((ret = virDomainDefPostParseCommon(def, &data, xmlopt)) < 0)\n        goto cleanup;\n\n    if (xmlopt->config.assignAddressesCallback) {\n        ret = xmlopt->config.assignAddressesCallback(def, parseFlags,\n                                                     xmlopt->config.priv,\n                                                     data.parseOpaque);\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    if ((ret = virDomainDefPostParseCheckFeatures(def, xmlopt)) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (localParseOpaque && xmlopt->config.domainPostParseDataFree)\n        xmlopt->config.domainPostParseDataFree(data.parseOpaque);\n\n    if (ret == 1)\n        ret = -1;\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "enum {\n    DOMAIN_DEVICE_ITERATE_ALL_CONSOLES = 1 << 0,\n    DOMAIN_DEVICE_ITERATE_MISSING_INFO = 1 << 1,\n} virDomainDeviceIterateFlags;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nenum {\n    DOMAIN_DEVICE_ITERATE_ALL_CONSOLES = 1 << 0,\n    DOMAIN_DEVICE_ITERATE_MISSING_INFO = 1 << 1,\n} virDomainDeviceIterateFlags;\n\nint\nvirDomainDefPostParse(virDomainDefPtr def,\n                      unsigned int parseFlags,\n                      virDomainXMLOptionPtr xmlopt,\n                      void *parseOpaque)\n{\n    int ret = -1;\n    bool localParseOpaque = false;\n    struct virDomainDefPostParseDeviceIteratorData data = {\n        .xmlopt = xmlopt,\n        .parseFlags = parseFlags,\n        .parseOpaque = parseOpaque,\n    };\n\n    def->postParseFailed = false;\n\n    /* call the basic post parse callback */\n    if (xmlopt->config.domainPostParseBasicCallback) {\n        ret = xmlopt->config.domainPostParseBasicCallback(def,\n                                                          xmlopt->config.priv);\n\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    if (!data.parseOpaque &&\n        xmlopt->config.domainPostParseDataAlloc) {\n        ret = xmlopt->config.domainPostParseDataAlloc(def, parseFlags,\n                                                      xmlopt->config.priv,\n                                                      &data.parseOpaque);\n\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n        localParseOpaque = true;\n    }\n\n    /* this must be done before the hypervisor-specific callback,\n     * in case presence of a controller at a specific index is checked\n     */\n    virDomainAssignControllerIndexes(def);\n\n    /* call the domain config callback */\n    if (xmlopt->config.domainPostParseCallback) {\n        ret = xmlopt->config.domainPostParseCallback(def, parseFlags,\n                                                     xmlopt->config.priv,\n                                                     data.parseOpaque);\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    /* iterate the devices */\n    ret = virDomainDeviceInfoIterateInternal(def,\n                                             virDomainDefPostParseDeviceIterator,\n                                             DOMAIN_DEVICE_ITERATE_ALL_CONSOLES |\n                                             DOMAIN_DEVICE_ITERATE_MISSING_INFO,\n                                             &data);\n\n    if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n        goto cleanup;\n\n    if ((ret = virDomainDefPostParseCommon(def, &data, xmlopt)) < 0)\n        goto cleanup;\n\n    if (xmlopt->config.assignAddressesCallback) {\n        ret = xmlopt->config.assignAddressesCallback(def, parseFlags,\n                                                     xmlopt->config.priv,\n                                                     data.parseOpaque);\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    if ((ret = virDomainDefPostParseCheckFeatures(def, xmlopt)) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (localParseOpaque && xmlopt->config.domainPostParseDataFree)\n        xmlopt->config.domainPostParseDataFree(data.parseOpaque);\n\n    if (ret == 1)\n        ret = -1;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenParseXMInputDevs",
          "args": [
            "conf",
            "def"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "xenParseXMInputDevs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
          "lines": "405-435",
          "snippet": "static int\nxenParseXMInputDevs(virConfPtr conf, virDomainDefPtr def)\n{\n    g_autofree char *str = NULL;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        if (xenConfigGetString(conf, \"usbdevice\", &str, NULL) < 0)\n            return -1;\n        if (str &&\n                (STREQ(str, \"tablet\") ||\n                 STREQ(str, \"mouse\") ||\n                 STREQ(str, \"keyboard\"))) {\n            virDomainInputDefPtr input;\n            if (VIR_ALLOC(input) < 0)\n                return -1;\n\n            input->bus = VIR_DOMAIN_INPUT_BUS_USB;\n            if (STREQ(str, \"mouse\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_MOUSE;\n            else if (STREQ(str, \"tablet\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_TABLET;\n            else if (STREQ(str, \"keyboard\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_KBD;\n            if (VIR_APPEND_ELEMENT(def->inputs, def->ninputs, input) < 0) {\n                virDomainInputDefFree(input);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xen_xm.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenParseXMInputDevs(virConfPtr conf, virDomainDefPtr def)\n{\n    g_autofree char *str = NULL;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        if (xenConfigGetString(conf, \"usbdevice\", &str, NULL) < 0)\n            return -1;\n        if (str &&\n                (STREQ(str, \"tablet\") ||\n                 STREQ(str, \"mouse\") ||\n                 STREQ(str, \"keyboard\"))) {\n            virDomainInputDefPtr input;\n            if (VIR_ALLOC(input) < 0)\n                return -1;\n\n            input->bus = VIR_DOMAIN_INPUT_BUS_USB;\n            if (STREQ(str, \"mouse\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_MOUSE;\n            else if (STREQ(str, \"tablet\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_TABLET;\n            else if (STREQ(str, \"keyboard\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_KBD;\n            if (VIR_APPEND_ELEMENT(def->inputs, def->ninputs, input) < 0) {\n                virDomainInputDefFree(input);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenParseXMDiskList",
          "args": [
            "conf",
            "def"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "xenParseXMDiskList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
          "lines": "254-286",
          "snippet": "static int\nxenParseXMDiskList(virConfPtr conf, virDomainDefPtr def)\n{\n    char **disks = NULL, **entries;\n    int hvm = def->os.type == VIR_DOMAIN_OSTYPE_HVM;\n    int ret = -1;\n    int rc;\n\n    rc = virConfGetValueStringList(conf, \"disk\", false, &disks);\n    if (rc <= 0)\n        return rc;\n\n    for (entries = disks; *entries; entries++) {\n        virDomainDiskDefPtr disk;\n        char *entry = *entries;\n\n        if (!(disk = xenParseXMDisk(entry, hvm)))\n            continue;\n\n        /* Maintain list in sorted order according to target device name */\n        rc = VIR_APPEND_ELEMENT(def->disks, def->ndisks, disk);\n        virDomainDiskDefFree(disk);\n\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(disks);\n    return ret;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xen_xm.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenParseXMDiskList(virConfPtr conf, virDomainDefPtr def)\n{\n    char **disks = NULL, **entries;\n    int hvm = def->os.type == VIR_DOMAIN_OSTYPE_HVM;\n    int ret = -1;\n    int rc;\n\n    rc = virConfGetValueStringList(conf, \"disk\", false, &disks);\n    if (rc <= 0)\n        return rc;\n\n    for (entries = disks; *entries; entries++) {\n        virDomainDiskDefPtr disk;\n        char *entry = *entries;\n\n        if (!(disk = xenParseXMDisk(entry, hvm)))\n            continue;\n\n        /* Maintain list in sorted order according to target device name */\n        rc = VIR_APPEND_ELEMENT(def->disks, def->ndisks, disk);\n        virDomainDiskDefFree(disk);\n\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(disks);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenParseXMOS",
          "args": [
            "conf",
            "def"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "xenParseXMOS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
          "lines": "37-101",
          "snippet": "static int\nxenParseXMOS(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        g_autofree char *boot = NULL;\n\n        if (VIR_ALLOC(def->os.loader) < 0 ||\n            xenConfigCopyString(conf, \"kernel\", &def->os.loader->path) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"boot\", &boot, \"c\") < 0)\n            return -1;\n\n        for (i = 0; i < VIR_DOMAIN_BOOT_LAST && boot[i]; i++) {\n            switch (boot[i]) {\n            case 'a':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_FLOPPY;\n                break;\n            case 'd':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_CDROM;\n                break;\n            case 'n':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_NET;\n                break;\n            case 'c':\n            default:\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_DISK;\n                break;\n            }\n            def->os.nBootDevs++;\n        }\n    } else {\n        g_autofree char *extra = NULL;\n        g_autofree char *root = NULL;\n\n        if (xenConfigCopyStringOpt(conf, \"bootloader\", &def->os.bootloader) < 0)\n            return -1;\n        if (xenConfigCopyStringOpt(conf, \"bootargs\", &def->os.bootloaderArgs) < 0)\n            return -1;\n\n        if (xenConfigCopyStringOpt(conf, \"kernel\", &def->os.kernel) < 0)\n            return -1;\n\n        if (xenConfigCopyStringOpt(conf, \"ramdisk\", &def->os.initrd) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"extra\", &extra, NULL) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"root\", &root, NULL) < 0)\n            return -1;\n\n        if (root && extra) {\n            def->os.cmdline = g_strdup_printf(\"root=%s %s\", root, extra);\n        } else if (root) {\n            def->os.cmdline = g_strdup_printf(\"root=%s\", root);\n        } else if (extra) {\n            def->os.cmdline = g_strdup(extra);\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xen_xm.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenParseXMOS(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        g_autofree char *boot = NULL;\n\n        if (VIR_ALLOC(def->os.loader) < 0 ||\n            xenConfigCopyString(conf, \"kernel\", &def->os.loader->path) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"boot\", &boot, \"c\") < 0)\n            return -1;\n\n        for (i = 0; i < VIR_DOMAIN_BOOT_LAST && boot[i]; i++) {\n            switch (boot[i]) {\n            case 'a':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_FLOPPY;\n                break;\n            case 'd':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_CDROM;\n                break;\n            case 'n':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_NET;\n                break;\n            case 'c':\n            default:\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_DISK;\n                break;\n            }\n            def->os.nBootDevs++;\n        }\n    } else {\n        g_autofree char *extra = NULL;\n        g_autofree char *root = NULL;\n\n        if (xenConfigCopyStringOpt(conf, \"bootloader\", &def->os.bootloader) < 0)\n            return -1;\n        if (xenConfigCopyStringOpt(conf, \"bootargs\", &def->os.bootloaderArgs) < 0)\n            return -1;\n\n        if (xenConfigCopyStringOpt(conf, \"kernel\", &def->os.kernel) < 0)\n            return -1;\n\n        if (xenConfigCopyStringOpt(conf, \"ramdisk\", &def->os.initrd) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"extra\", &extra, NULL) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"root\", &root, NULL) < 0)\n            return -1;\n\n        if (root && extra) {\n            def->os.cmdline = g_strdup_printf(\"root=%s %s\", root, extra);\n        } else if (root) {\n            def->os.cmdline = g_strdup_printf(\"root=%s\", root);\n        } else if (extra) {\n            def->os.cmdline = g_strdup(extra);\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenParseConfigCommon",
          "args": [
            "conf",
            "def",
            "caps",
            "XEN_CONFIG_FORMAT_XM",
            "xmlopt"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "xenParseConfigCommon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_common.c",
          "lines": "1463-1513",
          "snippet": "int\nxenParseConfigCommon(virConfPtr conf,\n                     virDomainDefPtr def,\n                     virCapsPtr caps,\n                     const char *nativeFormat,\n                     virDomainXMLOptionPtr xmlopt)\n{\n    if (xenParseGeneralMeta(conf, def, caps) < 0)\n        return -1;\n\n    if (xenParseMem(conf, def) < 0)\n        return -1;\n\n    if (xenParseEventsActions(conf, def) < 0)\n        return -1;\n\n    if (xenParseCPUFeatures(conf, def, xmlopt) < 0)\n        return -1;\n\n    if (xenParseTimeOffset(conf, def) < 0)\n        return -1;\n\n    if (xenConfigCopyStringOpt(conf, \"device_model\", &def->emulator) < 0)\n        return -1;\n\n    if (STREQ(nativeFormat, XEN_CONFIG_FORMAT_XL)) {\n        if (xenParseVifList(conf, def, \"vif\") < 0)\n            return -1;\n    } else if (STREQ(nativeFormat, XEN_CONFIG_FORMAT_XM)) {\n        if (xenParseVifList(conf, def, \"netfront\") < 0)\n            return -1;\n    } else {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported config type %s\"), nativeFormat);\n        return -1;\n    }\n\n    if (xenParsePCIList(conf, def) < 0)\n        return -1;\n\n    if (xenParseEmulatedDevices(conf, def) < 0)\n        return -1;\n\n    if (xenParseVfb(conf, def) < 0)\n        return -1;\n\n    if (xenParseCharDev(conf, def, nativeFormat) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xenxs_private.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nxenParseConfigCommon(virConfPtr conf,\n                     virDomainDefPtr def,\n                     virCapsPtr caps,\n                     const char *nativeFormat,\n                     virDomainXMLOptionPtr xmlopt)\n{\n    if (xenParseGeneralMeta(conf, def, caps) < 0)\n        return -1;\n\n    if (xenParseMem(conf, def) < 0)\n        return -1;\n\n    if (xenParseEventsActions(conf, def) < 0)\n        return -1;\n\n    if (xenParseCPUFeatures(conf, def, xmlopt) < 0)\n        return -1;\n\n    if (xenParseTimeOffset(conf, def) < 0)\n        return -1;\n\n    if (xenConfigCopyStringOpt(conf, \"device_model\", &def->emulator) < 0)\n        return -1;\n\n    if (STREQ(nativeFormat, XEN_CONFIG_FORMAT_XL)) {\n        if (xenParseVifList(conf, def, \"vif\") < 0)\n            return -1;\n    } else if (STREQ(nativeFormat, XEN_CONFIG_FORMAT_XM)) {\n        if (xenParseVifList(conf, def, \"netfront\") < 0)\n            return -1;\n    } else {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported config type %s\"), nativeFormat);\n        return -1;\n    }\n\n    if (xenParsePCIList(conf, def) < 0)\n        return -1;\n\n    if (xenParseEmulatedDevices(conf, def) < 0)\n        return -1;\n\n    if (xenParseVfb(conf, def) < 0)\n        return -1;\n\n    if (xenParseCharDev(conf, def, nativeFormat) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefNew",
          "args": [],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3574-3594",
          "snippet": "virDomainDefPtr\nvirDomainDefNew(void)\n{\n    virDomainDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->numa = virDomainNumaNew()))\n        goto error;\n\n    ret->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.swap_hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return ret;\n\n error:\n    virDomainDefFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefNew(void)\n{\n    virDomainDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->numa = virDomainNumaNew()))\n        goto error;\n\n    ret->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.swap_hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return ret;\n\n error:\n    virDomainDefFree(ret);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainDefPtr\nxenParseXM(virConfPtr conf,\n           virCapsPtr caps,\n           virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDefPtr def = NULL;\n\n    if (!(def = virDomainDefNew()))\n        return NULL;\n\n    def->virtType = VIR_DOMAIN_VIRT_XEN;\n    def->id = -1;\n\n    if (xenParseConfigCommon(conf, def, caps, XEN_CONFIG_FORMAT_XM,\n                             xmlopt) < 0)\n        goto cleanup;\n\n    if (xenParseXMOS(conf, def) < 0)\n         goto cleanup;\n\n    if (xenParseXMDiskList(conf, def) < 0)\n         goto cleanup;\n\n    if (xenParseXMInputDevs(conf, def) < 0)\n         goto cleanup;\n\n    if (virDomainDefPostParse(def, VIR_DOMAIN_DEF_PARSE_ABI_UPDATE,\n                              xmlopt, NULL) < 0)\n        goto cleanup;\n\n    return def;\n\n cleanup:\n    virDomainDefFree(def);\n    return NULL;\n}"
  },
  {
    "function_name": "xenParseXMInputDevs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "405-435",
    "snippet": "static int\nxenParseXMInputDevs(virConfPtr conf, virDomainDefPtr def)\n{\n    g_autofree char *str = NULL;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        if (xenConfigGetString(conf, \"usbdevice\", &str, NULL) < 0)\n            return -1;\n        if (str &&\n                (STREQ(str, \"tablet\") ||\n                 STREQ(str, \"mouse\") ||\n                 STREQ(str, \"keyboard\"))) {\n            virDomainInputDefPtr input;\n            if (VIR_ALLOC(input) < 0)\n                return -1;\n\n            input->bus = VIR_DOMAIN_INPUT_BUS_USB;\n            if (STREQ(str, \"mouse\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_MOUSE;\n            else if (STREQ(str, \"tablet\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_TABLET;\n            else if (STREQ(str, \"keyboard\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_KBD;\n            if (VIR_APPEND_ELEMENT(def->inputs, def->ninputs, input) < 0) {\n                virDomainInputDefFree(input);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainInputDefFree",
          "args": [
            "input"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainInputDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1782-1791",
          "snippet": "void virDomainInputDefFree(virDomainInputDefPtr def)\n{\n    if (!def)\n        return;\n\n    virDomainDeviceInfoClear(&def->info);\n    VIR_FREE(def->source.evdev);\n    VIR_FREE(def->virtio);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainInputDefFree(virDomainInputDefPtr def)\n{\n    if (!def)\n        return;\n\n    virDomainDeviceInfoClear(&def->info);\n    VIR_FREE(def->source.evdev);\n    VIR_FREE(def->virtio);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "def->inputs",
            "def->ninputs",
            "input"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str",
            "\"keyboard\""
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str",
            "\"tablet\""
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str",
            "\"mouse\""
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "input"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str",
            "\"keyboard\""
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str",
            "\"mouse\""
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str",
            "\"tablet\""
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xenConfigGetString",
          "args": [
            "conf",
            "\"usbdevice\"",
            "&str",
            "NULL"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "xenConfigGetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_common.c",
          "lines": "223-243",
          "snippet": "int\nxenConfigGetString(virConfPtr conf,\n                   const char *name,\n                   char **value,\n                   const char *def)\n{\n    char *string = NULL;\n    int rc;\n\n    *value = NULL;\n    if ((rc = virConfGetValueString(conf, name, &string)) < 0)\n        return -1;\n\n    if (rc == 0 || !string) {\n        *value = g_strdup(def);\n    } else {\n        *value = string;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xenxs_private.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nxenConfigGetString(virConfPtr conf,\n                   const char *name,\n                   char **value,\n                   const char *def)\n{\n    char *string = NULL;\n    int rc;\n\n    *value = NULL;\n    if ((rc = virConfGetValueString(conf, name, &string)) < 0)\n        return -1;\n\n    if (rc == 0 || !string) {\n        *value = g_strdup(def);\n    } else {\n        *value = string;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenParseXMInputDevs(virConfPtr conf, virDomainDefPtr def)\n{\n    g_autofree char *str = NULL;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        if (xenConfigGetString(conf, \"usbdevice\", &str, NULL) < 0)\n            return -1;\n        if (str &&\n                (STREQ(str, \"tablet\") ||\n                 STREQ(str, \"mouse\") ||\n                 STREQ(str, \"keyboard\"))) {\n            virDomainInputDefPtr input;\n            if (VIR_ALLOC(input) < 0)\n                return -1;\n\n            input->bus = VIR_DOMAIN_INPUT_BUS_USB;\n            if (STREQ(str, \"mouse\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_MOUSE;\n            else if (STREQ(str, \"tablet\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_TABLET;\n            else if (STREQ(str, \"keyboard\"))\n                input->type = VIR_DOMAIN_INPUT_TYPE_KBD;\n            if (VIR_APPEND_ELEMENT(def->inputs, def->ninputs, input) < 0) {\n                virDomainInputDefFree(input);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "xenFormatXMDisks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "369-402",
    "snippet": "static int\nxenFormatXMDisks(virConfPtr conf, virDomainDefPtr def)\n{\n    virConfValuePtr diskVal = NULL;\n    size_t i = 0;\n\n    if (VIR_ALLOC(diskVal) < 0)\n        goto cleanup;\n\n    diskVal->type = VIR_CONF_LIST;\n    diskVal->list = NULL;\n\n    for (i = 0; i < def->ndisks; i++) {\n        if (def->disks[i]->device == VIR_DOMAIN_DISK_DEVICE_FLOPPY)\n            continue;\n\n        if (xenFormatXMDisk(diskVal, def->disks[i]) < 0)\n            goto cleanup;\n    }\n\n    if (diskVal->list != NULL) {\n        int ret = virConfSetValue(conf, \"disk\", diskVal);\n        diskVal = NULL;\n        if (ret < 0)\n            goto cleanup;\n    }\n    VIR_FREE(diskVal);\n\n    return 0;\n\n cleanup:\n    virConfFreeValue(diskVal);\n    return -1;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfFreeValue",
          "args": [
            "diskVal"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "virConfFreeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "147-159",
          "snippet": "void\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirConfFreeValue(virConfValuePtr val)\n{\n    if (val == NULL)\n        return;\n    if (val->type == VIR_CONF_STRING &&\n        val->str != NULL)\n        VIR_FREE(val->str);\n    if (val->type == VIR_CONF_LIST &&\n        val->list != NULL)\n        virConfFreeList(val->list);\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "diskVal"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfSetValue",
          "args": [
            "conf",
            "\"disk\"",
            "diskVal"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "virConfSetValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1338-1378",
          "snippet": "int\nvirConfSetValue(virConfPtr conf,\n                const char *setting,\n                virConfValuePtr value)\n{\n    virConfEntryPtr cur, prev = NULL;\n\n    if (value && value->type == VIR_CONF_STRING && value->str == NULL) {\n        virConfFreeValue(value);\n        return -1;\n    }\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (STREQ_NULLABLE(cur->name, setting))\n            break;\n        prev = cur;\n        cur = cur->next;\n    }\n\n    if (!cur) {\n        if (VIR_ALLOC(cur) < 0) {\n            virConfFreeValue(value);\n            return -1;\n        }\n        cur->comment = NULL;\n        cur->name = g_strdup(setting);\n        cur->value = value;\n        if (prev) {\n            cur->next = prev->next;\n            prev->next = cur;\n        } else {\n            cur->next = conf->entries;\n            conf->entries = cur;\n        }\n    } else {\n        virConfFreeValue(cur->value);\n        cur->value = value;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirConfSetValue(virConfPtr conf,\n                const char *setting,\n                virConfValuePtr value)\n{\n    virConfEntryPtr cur, prev = NULL;\n\n    if (value && value->type == VIR_CONF_STRING && value->str == NULL) {\n        virConfFreeValue(value);\n        return -1;\n    }\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (STREQ_NULLABLE(cur->name, setting))\n            break;\n        prev = cur;\n        cur = cur->next;\n    }\n\n    if (!cur) {\n        if (VIR_ALLOC(cur) < 0) {\n            virConfFreeValue(value);\n            return -1;\n        }\n        cur->comment = NULL;\n        cur->name = g_strdup(setting);\n        cur->value = value;\n        if (prev) {\n            cur->next = prev->next;\n            prev->next = cur;\n        } else {\n            cur->next = conf->entries;\n            conf->entries = cur;\n        }\n    } else {\n        virConfFreeValue(cur->value);\n        cur->value = value;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenFormatXMDisk",
          "args": [
            "diskVal",
            "def->disks[i]"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "xenFormatXMDisks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
          "lines": "369-402",
          "snippet": "static int\nxenFormatXMDisks(virConfPtr conf, virDomainDefPtr def)\n{\n    virConfValuePtr diskVal = NULL;\n    size_t i = 0;\n\n    if (VIR_ALLOC(diskVal) < 0)\n        goto cleanup;\n\n    diskVal->type = VIR_CONF_LIST;\n    diskVal->list = NULL;\n\n    for (i = 0; i < def->ndisks; i++) {\n        if (def->disks[i]->device == VIR_DOMAIN_DISK_DEVICE_FLOPPY)\n            continue;\n\n        if (xenFormatXMDisk(diskVal, def->disks[i]) < 0)\n            goto cleanup;\n    }\n\n    if (diskVal->list != NULL) {\n        int ret = virConfSetValue(conf, \"disk\", diskVal);\n        diskVal = NULL;\n        if (ret < 0)\n            goto cleanup;\n    }\n    VIR_FREE(diskVal);\n\n    return 0;\n\n cleanup:\n    virConfFreeValue(diskVal);\n    return -1;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "diskVal"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenFormatXMDisks(virConfPtr conf, virDomainDefPtr def)\n{\n    virConfValuePtr diskVal = NULL;\n    size_t i = 0;\n\n    if (VIR_ALLOC(diskVal) < 0)\n        goto cleanup;\n\n    diskVal->type = VIR_CONF_LIST;\n    diskVal->list = NULL;\n\n    for (i = 0; i < def->ndisks; i++) {\n        if (def->disks[i]->device == VIR_DOMAIN_DISK_DEVICE_FLOPPY)\n            continue;\n\n        if (xenFormatXMDisk(diskVal, def->disks[i]) < 0)\n            goto cleanup;\n    }\n\n    if (diskVal->list != NULL) {\n        int ret = virConfSetValue(conf, \"disk\", diskVal);\n        diskVal = NULL;\n        if (ret < 0)\n            goto cleanup;\n    }\n    VIR_FREE(diskVal);\n\n    return 0;\n\n cleanup:\n    virConfFreeValue(diskVal);\n    return -1;\n}"
  },
  {
    "function_name": "xenFormatXMDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "289-366",
    "snippet": "static int\nxenFormatXMDisk(virConfValuePtr list,\n                virDomainDiskDefPtr disk)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    virConfValuePtr val, tmp;\n    const char *src = virDomainDiskGetSource(disk);\n    int format = virDomainDiskGetFormat(disk);\n    const char *driver = virDomainDiskGetDriver(disk);\n\n    if (src) {\n        if (format) {\n            const char *type;\n\n            if (format == VIR_STORAGE_FILE_RAW)\n                type = \"aio\";\n            else\n                type = virStorageFileFormatTypeToString(format);\n\n            if (driver) {\n                virBufferAsprintf(&buf, \"%s:\", driver);\n                if (STREQ(driver, \"tap\") || STREQ(driver, \"tap2\"))\n                    virBufferAsprintf(&buf, \"%s:\", type);\n            }\n        } else {\n            switch (virDomainDiskGetType(disk)) {\n            case VIR_STORAGE_TYPE_FILE:\n                virBufferAddLit(&buf, \"file:\");\n                break;\n            case VIR_STORAGE_TYPE_BLOCK:\n                virBufferAddLit(&buf, \"phy:\");\n                break;\n            default:\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"unsupported disk type %s\"),\n                               virStorageTypeToString(virDomainDiskGetType(disk)));\n                goto cleanup;\n            }\n        }\n        virBufferAdd(&buf, src, -1);\n    }\n    virBufferAddLit(&buf, \",\");\n\n    virBufferAdd(&buf, disk->dst, -1);\n    if (disk->device == VIR_DOMAIN_DISK_DEVICE_CDROM)\n        virBufferAddLit(&buf, \":cdrom\");\n\n    if (disk->src->readonly)\n        virBufferAddLit(&buf, \",r\");\n    else if (disk->src->shared)\n        virBufferAddLit(&buf, \",!\");\n    else\n        virBufferAddLit(&buf, \",w\");\n    if (disk->transient) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"transient disks not supported yet\"));\n        return -1;\n    }\n\n    if (VIR_ALLOC(val) < 0)\n        goto cleanup;\n\n    val->type = VIR_CONF_STRING;\n    val->str = virBufferContentAndReset(&buf);\n    tmp = list->list;\n    while (tmp && tmp->next)\n        tmp = tmp->next;\n    if (tmp)\n        tmp->next = val;\n    else\n        list->list = val;\n\n    return 0;\n\n cleanup:\n    virBufferFreeAndReset(&buf);\n    return -1;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "val"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"transient disks not supported yet\")"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"transient disks not supported yet\""
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "libvirt_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/libxl_logger.c",
          "lines": "125-130",
          "snippet": "static void\nlibvirt_destroy(xentoollog_logger *logger_in)\n{\n    xentoollog_logger_libvirt *lg = (xentoollog_logger_libvirt*)logger_in;\n    VIR_FREE(lg);\n}",
          "includes": [
            "#include \"util/virtime.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virhash.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/virerror.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"libxl_logger.h\"",
            "#include \"internal.h\"",
            "#include <libxl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/virtime.h\"\n#include \"util/virstring.h\"\n#include \"util/virhash.h\"\n#include \"util/virfile.h\"\n#include \"util/virerror.h\"\n#include \"util/viralloc.h\"\n#include \"libxl_logger.h\"\n#include \"internal.h\"\n#include <libxl.h>\n#include <config.h>\n\nstatic void\nlibvirt_destroy(xentoollog_logger *logger_in)\n{\n    xentoollog_logger_libvirt *lg = (xentoollog_logger_libvirt*)logger_in;\n    VIR_FREE(lg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\",w\""
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\",!\""
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\",r\""
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\":cdrom\""
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "&buf",
            "disk->dst",
            "-1"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\",\""
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unsupported disk type %s\")",
            "virStorageTypeToString(virDomainDiskGetType(disk))"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageTypeToString",
          "args": [
            "virDomainDiskGetType(disk)"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetType",
          "args": [
            "disk"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2141-2145",
          "snippet": "int\nvirDomainDiskGetType(virDomainDiskDefPtr def)\n{\n    return def->src->type;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskGetType(virDomainDiskDefPtr def)\n{\n    return def->src->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"phy:\""
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"file:\""
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\"%s:\"",
            "type"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "driver",
            "\"tap2\""
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "driver",
            "\"tap\""
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "format"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetDriver",
          "args": [
            "disk"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2185-2189",
          "snippet": "const char *\nvirDomainDiskGetDriver(const virDomainDiskDef *def)\n{\n    return def->driverName;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetDriver(const virDomainDiskDef *def)\n{\n    return def->driverName;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetFormat",
          "args": [
            "disk"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2202-2206",
          "snippet": "int\nvirDomainDiskGetFormat(virDomainDiskDefPtr def)\n{\n    return def->src->format;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskGetFormat(virDomainDiskDefPtr def)\n{\n    return def->src->format;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetSource",
          "args": [
            "disk"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2155-2159",
          "snippet": "const char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenFormatXMDisk(virConfValuePtr list,\n                virDomainDiskDefPtr disk)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    virConfValuePtr val, tmp;\n    const char *src = virDomainDiskGetSource(disk);\n    int format = virDomainDiskGetFormat(disk);\n    const char *driver = virDomainDiskGetDriver(disk);\n\n    if (src) {\n        if (format) {\n            const char *type;\n\n            if (format == VIR_STORAGE_FILE_RAW)\n                type = \"aio\";\n            else\n                type = virStorageFileFormatTypeToString(format);\n\n            if (driver) {\n                virBufferAsprintf(&buf, \"%s:\", driver);\n                if (STREQ(driver, \"tap\") || STREQ(driver, \"tap2\"))\n                    virBufferAsprintf(&buf, \"%s:\", type);\n            }\n        } else {\n            switch (virDomainDiskGetType(disk)) {\n            case VIR_STORAGE_TYPE_FILE:\n                virBufferAddLit(&buf, \"file:\");\n                break;\n            case VIR_STORAGE_TYPE_BLOCK:\n                virBufferAddLit(&buf, \"phy:\");\n                break;\n            default:\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"unsupported disk type %s\"),\n                               virStorageTypeToString(virDomainDiskGetType(disk)));\n                goto cleanup;\n            }\n        }\n        virBufferAdd(&buf, src, -1);\n    }\n    virBufferAddLit(&buf, \",\");\n\n    virBufferAdd(&buf, disk->dst, -1);\n    if (disk->device == VIR_DOMAIN_DISK_DEVICE_CDROM)\n        virBufferAddLit(&buf, \":cdrom\");\n\n    if (disk->src->readonly)\n        virBufferAddLit(&buf, \",r\");\n    else if (disk->src->shared)\n        virBufferAddLit(&buf, \",!\");\n    else\n        virBufferAddLit(&buf, \",w\");\n    if (disk->transient) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"transient disks not supported yet\"));\n        return -1;\n    }\n\n    if (VIR_ALLOC(val) < 0)\n        goto cleanup;\n\n    val->type = VIR_CONF_STRING;\n    val->str = virBufferContentAndReset(&buf);\n    tmp = list->list;\n    while (tmp && tmp->next)\n        tmp = tmp->next;\n    if (tmp)\n        tmp->next = val;\n    else\n        list->list = val;\n\n    return 0;\n\n cleanup:\n    virBufferFreeAndReset(&buf);\n    return -1;\n}"
  },
  {
    "function_name": "xenParseXMDiskList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "254-286",
    "snippet": "static int\nxenParseXMDiskList(virConfPtr conf, virDomainDefPtr def)\n{\n    char **disks = NULL, **entries;\n    int hvm = def->os.type == VIR_DOMAIN_OSTYPE_HVM;\n    int ret = -1;\n    int rc;\n\n    rc = virConfGetValueStringList(conf, \"disk\", false, &disks);\n    if (rc <= 0)\n        return rc;\n\n    for (entries = disks; *entries; entries++) {\n        virDomainDiskDefPtr disk;\n        char *entry = *entries;\n\n        if (!(disk = xenParseXMDisk(entry, hvm)))\n            continue;\n\n        /* Maintain list in sorted order according to target device name */\n        rc = VIR_APPEND_ELEMENT(def->disks, def->ndisks, disk);\n        virDomainDiskDefFree(disk);\n\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(disks);\n    return ret;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "disks"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskDefFree",
          "args": [
            "disk"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2117-2138",
          "snippet": "void\nvirDomainDiskDefFree(virDomainDiskDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->dst);\n    virObjectUnref(def->mirror);\n    VIR_FREE(def->wwn);\n    VIR_FREE(def->driverName);\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->product);\n    VIR_FREE(def->domain_name);\n    VIR_FREE(def->blkdeviotune.group_name);\n    VIR_FREE(def->virtio);\n    virDomainDeviceInfoClear(&def->info);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDiskDefFree(virDomainDiskDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->dst);\n    virObjectUnref(def->mirror);\n    VIR_FREE(def->wwn);\n    VIR_FREE(def->driverName);\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->product);\n    VIR_FREE(def->domain_name);\n    VIR_FREE(def->blkdeviotune.group_name);\n    VIR_FREE(def->virtio);\n    virDomainDeviceInfoClear(&def->info);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "def->disks",
            "def->ndisks",
            "disk"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xenParseXMDisk",
          "args": [
            "entry",
            "hvm"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "xenParseXMDiskList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
          "lines": "254-286",
          "snippet": "static int\nxenParseXMDiskList(virConfPtr conf, virDomainDefPtr def)\n{\n    char **disks = NULL, **entries;\n    int hvm = def->os.type == VIR_DOMAIN_OSTYPE_HVM;\n    int ret = -1;\n    int rc;\n\n    rc = virConfGetValueStringList(conf, \"disk\", false, &disks);\n    if (rc <= 0)\n        return rc;\n\n    for (entries = disks; *entries; entries++) {\n        virDomainDiskDefPtr disk;\n        char *entry = *entries;\n\n        if (!(disk = xenParseXMDisk(entry, hvm)))\n            continue;\n\n        /* Maintain list in sorted order according to target device name */\n        rc = VIR_APPEND_ELEMENT(def->disks, def->ndisks, disk);\n        virDomainDiskDefFree(disk);\n\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(disks);\n    return ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueStringList",
          "args": [
            "conf",
            "\"disk\"",
            "false",
            "&disks"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "920-984",
          "snippet": "int virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenParseXMDiskList(virConfPtr conf, virDomainDefPtr def)\n{\n    char **disks = NULL, **entries;\n    int hvm = def->os.type == VIR_DOMAIN_OSTYPE_HVM;\n    int ret = -1;\n    int rc;\n\n    rc = virConfGetValueStringList(conf, \"disk\", false, &disks);\n    if (rc <= 0)\n        return rc;\n\n    for (entries = disks; *entries; entries++) {\n        virDomainDiskDefPtr disk;\n        char *entry = *entries;\n\n        if (!(disk = xenParseXMDisk(entry, hvm)))\n            continue;\n\n        /* Maintain list in sorted order according to target device name */\n        rc = VIR_APPEND_ELEMENT(def->disks, def->ndisks, disk);\n        virDomainDiskDefFree(disk);\n\n        if (rc < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(disks);\n    return ret;\n}"
  },
  {
    "function_name": "xenParseXMDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "104-251",
    "snippet": "static virDomainDiskDefPtr\nxenParseXMDisk(char *entry, int hvm)\n{\n    virDomainDiskDefPtr disk = NULL;\n    char *head;\n    char *offset;\n    char *tmp;\n    const char *src;\n\n    if (!(disk = virDomainDiskDefNew(NULL)))\n        return NULL;\n\n    head = entry;\n    /*\n     * Disks have 3 components, SOURCE,DEST-DEVICE,MODE\n     * eg, phy:/dev/HostVG/XenGuest1,xvda,w\n     * The SOURCE is usually prefixed with a driver type,\n     * and optionally driver sub-type\n     * The DEST-DEVICE is optionally post-fixed with disk type\n     */\n\n    /* Extract the source file path */\n    if (!(offset = strchr(head, ',')))\n        goto error;\n\n    if (offset == head) {\n        /* No source file given, eg CDROM with no media */\n        ignore_value(virDomainDiskSetSource(disk, NULL));\n    } else {\n        tmp = g_strndup(head, offset - head);\n\n        if (virDomainDiskSetSource(disk, tmp) < 0) {\n            VIR_FREE(tmp);\n            goto error;\n        }\n        VIR_FREE(tmp);\n    }\n\n    head = offset + 1;\n    /* Remove legacy ioemu: junk */\n    if (STRPREFIX(head, \"ioemu:\"))\n        head = head + 6;\n\n    /* Extract the dest device name */\n    if (!(offset = strchr(head, ',')))\n        goto error;\n\n    if (VIR_ALLOC_N(disk->dst, (offset - head) + 1) < 0)\n        goto error;\n\n    if (virStrncpy(disk->dst, head, offset - head,\n                   (offset - head) + 1) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Dest file %s too big for destination\"), head);\n        goto error;\n    }\n\n    head = offset + 1;\n    /* Extract source driver type */\n    src = virDomainDiskGetSource(disk);\n    if (src) {\n        size_t len;\n        /* The main type  phy:, file:, tap: ... */\n        if ((tmp = strchr(src, ':')) != NULL) {\n            len = tmp - src;\n            tmp = g_strndup(src, len);\n\n            if (virDomainDiskSetDriver(disk, tmp) < 0) {\n                VIR_FREE(tmp);\n                goto error;\n            }\n            VIR_FREE(tmp);\n\n            /* Strip the prefix we found off the source file name */\n            if (virDomainDiskSetSource(disk, src + len + 1) < 0)\n                goto error;\n\n            src = virDomainDiskGetSource(disk);\n        }\n\n        /* And the sub-type for tap:XXX: type */\n        if (STREQ_NULLABLE(virDomainDiskGetDriver(disk), \"tap\") ||\n            STREQ_NULLABLE(virDomainDiskGetDriver(disk), \"tap2\")) {\n            char *driverType;\n\n            if (!(tmp = strchr(src, ':')))\n                goto error;\n            len = tmp - src;\n\n            driverType = g_strndup(src, len);\n\n            if (STREQ(driverType, \"aio\"))\n                virDomainDiskSetFormat(disk, VIR_STORAGE_FILE_RAW);\n            else\n                virDomainDiskSetFormat(disk,\n                                       virStorageFileFormatTypeFromString(driverType));\n            VIR_FREE(driverType);\n            if (virDomainDiskGetFormat(disk) <= 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unknown driver type %s\"),\n                               src);\n                goto error;\n            }\n\n            /* Strip the prefix we found off the source file name */\n            if (virDomainDiskSetSource(disk, src + len + 1) < 0)\n                goto error;\n            src = virDomainDiskGetSource(disk);\n        }\n    }\n\n    /* No source, or driver name, so fix to phy: */\n    if (!virDomainDiskGetDriver(disk) &&\n        virDomainDiskSetDriver(disk, \"phy\") < 0)\n        goto error;\n\n    /* phy: type indicates a block device */\n    virDomainDiskSetType(disk,\n                         STREQ(virDomainDiskGetDriver(disk), \"phy\") ?\n                         VIR_STORAGE_TYPE_BLOCK :\n                         VIR_STORAGE_TYPE_FILE);\n\n    /* Check for a :cdrom/:disk postfix */\n    disk->device = VIR_DOMAIN_DISK_DEVICE_DISK;\n    if ((tmp = strchr(disk->dst, ':')) != NULL) {\n        if (STREQ(tmp, \":cdrom\"))\n            disk->device = VIR_DOMAIN_DISK_DEVICE_CDROM;\n        tmp[0] = '\\0';\n    }\n\n    if (STRPREFIX(disk->dst, \"xvd\") || !hvm)\n        disk->bus = VIR_DOMAIN_DISK_BUS_XEN;\n    else if (STRPREFIX(disk->dst, \"sd\"))\n        disk->bus = VIR_DOMAIN_DISK_BUS_SCSI;\n    else\n        disk->bus = VIR_DOMAIN_DISK_BUS_IDE;\n\n    if (STREQ(head, \"r\") || STREQ(head, \"ro\"))\n        disk->src->readonly = true;\n    else if (STREQ(head, \"w!\") || STREQ(head, \"!\"))\n        disk->src->shared = true;\n\n    return disk;\n\n error:\n    virDomainDiskDefFree(disk);\n    return NULL;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDiskDefFree",
          "args": [
            "disk"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2117-2138",
          "snippet": "void\nvirDomainDiskDefFree(virDomainDiskDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->dst);\n    virObjectUnref(def->mirror);\n    VIR_FREE(def->wwn);\n    VIR_FREE(def->driverName);\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->product);\n    VIR_FREE(def->domain_name);\n    VIR_FREE(def->blkdeviotune.group_name);\n    VIR_FREE(def->virtio);\n    virDomainDeviceInfoClear(&def->info);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDiskDefFree(virDomainDiskDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->dst);\n    virObjectUnref(def->mirror);\n    VIR_FREE(def->wwn);\n    VIR_FREE(def->driverName);\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->product);\n    VIR_FREE(def->domain_name);\n    VIR_FREE(def->blkdeviotune.group_name);\n    VIR_FREE(def->virtio);\n    virDomainDeviceInfoClear(&def->info);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "head",
            "\"!\""
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "head",
            "\"w!\""
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "head",
            "\"ro\""
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "head",
            "\"r\""
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "disk->dst",
            "\"sd\""
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "disk->dst",
            "\"xvd\""
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "tmp",
            "\":cdrom\""
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "disk->dst",
            "':'"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskSetType",
          "args": [
            "disk",
            "STREQ(virDomainDiskGetDriver(disk), \"phy\") ?\n                         VIR_STORAGE_TYPE_BLOCK :\n                         VIR_STORAGE_TYPE_FILE"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskSetType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2148-2152",
          "snippet": "void\nvirDomainDiskSetType(virDomainDiskDefPtr def, int type)\n{\n    def->src->type = type;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDiskSetType(virDomainDiskDefPtr def, int type)\n{\n    def->src->type = type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "virDomainDiskGetDriver(disk)",
            "\"phy\""
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetDriver",
          "args": [
            "disk"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2185-2189",
          "snippet": "const char *\nvirDomainDiskGetDriver(const virDomainDiskDef *def)\n{\n    return def->driverName;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetDriver(const virDomainDiskDef *def)\n{\n    return def->driverName;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskSetDriver",
          "args": [
            "disk",
            "\"phy\""
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskSetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2192-2199",
          "snippet": "int\nvirDomainDiskSetDriver(virDomainDiskDefPtr def, const char *name)\n{\n    char *tmp = g_strdup(name);\n    g_free(def->driverName);\n    def->driverName = tmp;\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskSetDriver(virDomainDiskDefPtr def, const char *name)\n{\n    char *tmp = g_strdup(name);\n    g_free(def->driverName);\n    def->driverName = tmp;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetSource",
          "args": [
            "disk"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2155-2159",
          "snippet": "const char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskSetSource",
          "args": [
            "disk",
            "src + len + 1"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskSetSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2162-2169",
          "snippet": "int\nvirDomainDiskSetSource(virDomainDiskDefPtr def, const char *src)\n{\n    char *tmp = g_strdup(src);\n    g_free(def->src->path);\n    def->src->path = tmp;\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskSetSource(virDomainDiskDefPtr def, const char *src)\n{\n    char *tmp = g_strdup(src);\n    g_free(def->src->path);\n    def->src->path = tmp;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unknown driver type %s\")",
            "src"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown driver type %s\""
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "libvirt_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/libxl_logger.c",
          "lines": "125-130",
          "snippet": "static void\nlibvirt_destroy(xentoollog_logger *logger_in)\n{\n    xentoollog_logger_libvirt *lg = (xentoollog_logger_libvirt*)logger_in;\n    VIR_FREE(lg);\n}",
          "includes": [
            "#include \"util/virtime.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virhash.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/virerror.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"libxl_logger.h\"",
            "#include \"internal.h\"",
            "#include <libxl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/virtime.h\"\n#include \"util/virstring.h\"\n#include \"util/virhash.h\"\n#include \"util/virfile.h\"\n#include \"util/virerror.h\"\n#include \"util/viralloc.h\"\n#include \"libxl_logger.h\"\n#include \"internal.h\"\n#include <libxl.h>\n#include <config.h>\n\nstatic void\nlibvirt_destroy(xentoollog_logger *logger_in)\n{\n    xentoollog_logger_libvirt *lg = (xentoollog_logger_libvirt*)logger_in;\n    VIR_FREE(lg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetFormat",
          "args": [
            "disk"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2202-2206",
          "snippet": "int\nvirDomainDiskGetFormat(virDomainDiskDefPtr def)\n{\n    return def->src->format;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskGetFormat(virDomainDiskDefPtr def)\n{\n    return def->src->format;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driverType"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskSetFormat",
          "args": [
            "disk",
            "virStorageFileFormatTypeFromString(driverType)"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskSetFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2209-2213",
          "snippet": "void\nvirDomainDiskSetFormat(virDomainDiskDefPtr def, int format)\n{\n    def->src->format = format;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDiskSetFormat(virDomainDiskDefPtr def, int format)\n{\n    def->src->format = format;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeFromString",
          "args": [
            "driverType"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "driverType",
            "\"aio\""
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "src",
            "len"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "src",
            "':'"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "virDomainDiskGetDriver(disk)",
            "\"tap2\""
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "virDomainDiskGetDriver(disk)",
            "\"tap\""
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "src",
            "len"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "src",
            "':'"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Dest file %s too big for destination\")",
            "head"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrncpy",
          "args": [
            "disk->dst",
            "head",
            "offset - head",
            "(offset - head) + 1"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virStrncpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "746-765",
          "snippet": "int\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "disk->dst",
            "(offset - head) + 1"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "head",
            "','"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "head",
            "\"ioemu:\""
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "head",
            "offset - head"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virDomainDiskSetSource(disk, NULL)"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "head",
            "','"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskDefNew",
          "args": [
            "NULL"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2093-2114",
          "snippet": "virDomainDiskDefPtr\nvirDomainDiskDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDiskDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->src = virStorageSourceNew()))\n        goto error;\n\n    if (xmlopt &&\n        xmlopt->privateData.diskNew &&\n        !(ret->privateData = xmlopt->privateData.diskNew()))\n        goto error;\n\n    return ret;\n\n error:\n    virDomainDiskDefFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDiskDefPtr\nvirDomainDiskDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDiskDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->src = virStorageSourceNew()))\n        goto error;\n\n    if (xmlopt &&\n        xmlopt->privateData.diskNew &&\n        !(ret->privateData = xmlopt->privateData.diskNew()))\n        goto error;\n\n    return ret;\n\n error:\n    virDomainDiskDefFree(ret);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainDiskDefPtr\nxenParseXMDisk(char *entry, int hvm)\n{\n    virDomainDiskDefPtr disk = NULL;\n    char *head;\n    char *offset;\n    char *tmp;\n    const char *src;\n\n    if (!(disk = virDomainDiskDefNew(NULL)))\n        return NULL;\n\n    head = entry;\n    /*\n     * Disks have 3 components, SOURCE,DEST-DEVICE,MODE\n     * eg, phy:/dev/HostVG/XenGuest1,xvda,w\n     * The SOURCE is usually prefixed with a driver type,\n     * and optionally driver sub-type\n     * The DEST-DEVICE is optionally post-fixed with disk type\n     */\n\n    /* Extract the source file path */\n    if (!(offset = strchr(head, ',')))\n        goto error;\n\n    if (offset == head) {\n        /* No source file given, eg CDROM with no media */\n        ignore_value(virDomainDiskSetSource(disk, NULL));\n    } else {\n        tmp = g_strndup(head, offset - head);\n\n        if (virDomainDiskSetSource(disk, tmp) < 0) {\n            VIR_FREE(tmp);\n            goto error;\n        }\n        VIR_FREE(tmp);\n    }\n\n    head = offset + 1;\n    /* Remove legacy ioemu: junk */\n    if (STRPREFIX(head, \"ioemu:\"))\n        head = head + 6;\n\n    /* Extract the dest device name */\n    if (!(offset = strchr(head, ',')))\n        goto error;\n\n    if (VIR_ALLOC_N(disk->dst, (offset - head) + 1) < 0)\n        goto error;\n\n    if (virStrncpy(disk->dst, head, offset - head,\n                   (offset - head) + 1) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Dest file %s too big for destination\"), head);\n        goto error;\n    }\n\n    head = offset + 1;\n    /* Extract source driver type */\n    src = virDomainDiskGetSource(disk);\n    if (src) {\n        size_t len;\n        /* The main type  phy:, file:, tap: ... */\n        if ((tmp = strchr(src, ':')) != NULL) {\n            len = tmp - src;\n            tmp = g_strndup(src, len);\n\n            if (virDomainDiskSetDriver(disk, tmp) < 0) {\n                VIR_FREE(tmp);\n                goto error;\n            }\n            VIR_FREE(tmp);\n\n            /* Strip the prefix we found off the source file name */\n            if (virDomainDiskSetSource(disk, src + len + 1) < 0)\n                goto error;\n\n            src = virDomainDiskGetSource(disk);\n        }\n\n        /* And the sub-type for tap:XXX: type */\n        if (STREQ_NULLABLE(virDomainDiskGetDriver(disk), \"tap\") ||\n            STREQ_NULLABLE(virDomainDiskGetDriver(disk), \"tap2\")) {\n            char *driverType;\n\n            if (!(tmp = strchr(src, ':')))\n                goto error;\n            len = tmp - src;\n\n            driverType = g_strndup(src, len);\n\n            if (STREQ(driverType, \"aio\"))\n                virDomainDiskSetFormat(disk, VIR_STORAGE_FILE_RAW);\n            else\n                virDomainDiskSetFormat(disk,\n                                       virStorageFileFormatTypeFromString(driverType));\n            VIR_FREE(driverType);\n            if (virDomainDiskGetFormat(disk) <= 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unknown driver type %s\"),\n                               src);\n                goto error;\n            }\n\n            /* Strip the prefix we found off the source file name */\n            if (virDomainDiskSetSource(disk, src + len + 1) < 0)\n                goto error;\n            src = virDomainDiskGetSource(disk);\n        }\n    }\n\n    /* No source, or driver name, so fix to phy: */\n    if (!virDomainDiskGetDriver(disk) &&\n        virDomainDiskSetDriver(disk, \"phy\") < 0)\n        goto error;\n\n    /* phy: type indicates a block device */\n    virDomainDiskSetType(disk,\n                         STREQ(virDomainDiskGetDriver(disk), \"phy\") ?\n                         VIR_STORAGE_TYPE_BLOCK :\n                         VIR_STORAGE_TYPE_FILE);\n\n    /* Check for a :cdrom/:disk postfix */\n    disk->device = VIR_DOMAIN_DISK_DEVICE_DISK;\n    if ((tmp = strchr(disk->dst, ':')) != NULL) {\n        if (STREQ(tmp, \":cdrom\"))\n            disk->device = VIR_DOMAIN_DISK_DEVICE_CDROM;\n        tmp[0] = '\\0';\n    }\n\n    if (STRPREFIX(disk->dst, \"xvd\") || !hvm)\n        disk->bus = VIR_DOMAIN_DISK_BUS_XEN;\n    else if (STRPREFIX(disk->dst, \"sd\"))\n        disk->bus = VIR_DOMAIN_DISK_BUS_SCSI;\n    else\n        disk->bus = VIR_DOMAIN_DISK_BUS_IDE;\n\n    if (STREQ(head, \"r\") || STREQ(head, \"ro\"))\n        disk->src->readonly = true;\n    else if (STREQ(head, \"w!\") || STREQ(head, \"!\"))\n        disk->src->shared = true;\n\n    return disk;\n\n error:\n    virDomainDiskDefFree(disk);\n    return NULL;\n}"
  },
  {
    "function_name": "xenParseXMOS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_xm.c",
    "lines": "37-101",
    "snippet": "static int\nxenParseXMOS(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        g_autofree char *boot = NULL;\n\n        if (VIR_ALLOC(def->os.loader) < 0 ||\n            xenConfigCopyString(conf, \"kernel\", &def->os.loader->path) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"boot\", &boot, \"c\") < 0)\n            return -1;\n\n        for (i = 0; i < VIR_DOMAIN_BOOT_LAST && boot[i]; i++) {\n            switch (boot[i]) {\n            case 'a':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_FLOPPY;\n                break;\n            case 'd':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_CDROM;\n                break;\n            case 'n':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_NET;\n                break;\n            case 'c':\n            default:\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_DISK;\n                break;\n            }\n            def->os.nBootDevs++;\n        }\n    } else {\n        g_autofree char *extra = NULL;\n        g_autofree char *root = NULL;\n\n        if (xenConfigCopyStringOpt(conf, \"bootloader\", &def->os.bootloader) < 0)\n            return -1;\n        if (xenConfigCopyStringOpt(conf, \"bootargs\", &def->os.bootloaderArgs) < 0)\n            return -1;\n\n        if (xenConfigCopyStringOpt(conf, \"kernel\", &def->os.kernel) < 0)\n            return -1;\n\n        if (xenConfigCopyStringOpt(conf, \"ramdisk\", &def->os.initrd) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"extra\", &extra, NULL) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"root\", &root, NULL) < 0)\n            return -1;\n\n        if (root && extra) {\n            def->os.cmdline = g_strdup_printf(\"root=%s %s\", root, extra);\n        } else if (root) {\n            def->os.cmdline = g_strdup_printf(\"root=%s\", root);\n        } else if (extra) {\n            def->os.cmdline = g_strdup(extra);\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"xen_common.h\"",
      "#include \"virstring.h\"",
      "#include \"domain_conf.h\"",
      "#include \"xen_xm.h\"",
      "#include \"xenxs_private.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "extra"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenConfigGetString",
          "args": [
            "conf",
            "\"root\"",
            "&root",
            "NULL"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "xenConfigGetString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_common.c",
          "lines": "223-243",
          "snippet": "int\nxenConfigGetString(virConfPtr conf,\n                   const char *name,\n                   char **value,\n                   const char *def)\n{\n    char *string = NULL;\n    int rc;\n\n    *value = NULL;\n    if ((rc = virConfGetValueString(conf, name, &string)) < 0)\n        return -1;\n\n    if (rc == 0 || !string) {\n        *value = g_strdup(def);\n    } else {\n        *value = string;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xenxs_private.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nxenConfigGetString(virConfPtr conf,\n                   const char *name,\n                   char **value,\n                   const char *def)\n{\n    char *string = NULL;\n    int rc;\n\n    *value = NULL;\n    if ((rc = virConfGetValueString(conf, name, &string)) < 0)\n        return -1;\n\n    if (rc == 0 || !string) {\n        *value = g_strdup(def);\n    } else {\n        *value = string;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xenConfigCopyStringOpt",
          "args": [
            "conf",
            "\"ramdisk\"",
            "&def->os.initrd"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "xenConfigCopyStringOpt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libxl/xen_common.c",
          "lines": "168-172",
          "snippet": "int\nxenConfigCopyStringOpt(virConfPtr conf, const char *name, char **value)\n{\n    return xenConfigCopyStringInternal(conf, name, value, 1);\n}",
          "includes": [
            "#include \"xen_common.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"xenxs_private.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xenxs_private.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nxenConfigCopyStringOpt(virConfPtr conf, const char *name, char **value)\n{\n    return xenConfigCopyStringInternal(conf, name, value, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def->os.loader"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xen_common.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"xen_xm.h\"\n#include \"xenxs_private.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nxenParseXMOS(virConfPtr conf, virDomainDefPtr def)\n{\n    size_t i;\n\n    if (def->os.type == VIR_DOMAIN_OSTYPE_HVM) {\n        g_autofree char *boot = NULL;\n\n        if (VIR_ALLOC(def->os.loader) < 0 ||\n            xenConfigCopyString(conf, \"kernel\", &def->os.loader->path) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"boot\", &boot, \"c\") < 0)\n            return -1;\n\n        for (i = 0; i < VIR_DOMAIN_BOOT_LAST && boot[i]; i++) {\n            switch (boot[i]) {\n            case 'a':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_FLOPPY;\n                break;\n            case 'd':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_CDROM;\n                break;\n            case 'n':\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_NET;\n                break;\n            case 'c':\n            default:\n                def->os.bootDevs[i] = VIR_DOMAIN_BOOT_DISK;\n                break;\n            }\n            def->os.nBootDevs++;\n        }\n    } else {\n        g_autofree char *extra = NULL;\n        g_autofree char *root = NULL;\n\n        if (xenConfigCopyStringOpt(conf, \"bootloader\", &def->os.bootloader) < 0)\n            return -1;\n        if (xenConfigCopyStringOpt(conf, \"bootargs\", &def->os.bootloaderArgs) < 0)\n            return -1;\n\n        if (xenConfigCopyStringOpt(conf, \"kernel\", &def->os.kernel) < 0)\n            return -1;\n\n        if (xenConfigCopyStringOpt(conf, \"ramdisk\", &def->os.initrd) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"extra\", &extra, NULL) < 0)\n            return -1;\n\n        if (xenConfigGetString(conf, \"root\", &root, NULL) < 0)\n            return -1;\n\n        if (root && extra) {\n            def->os.cmdline = g_strdup_printf(\"root=%s %s\", root, extra);\n        } else if (root) {\n            def->os.cmdline = g_strdup_printf(\"root=%s\", root);\n        } else if (extra) {\n            def->os.cmdline = g_strdup(extra);\n        }\n    }\n\n    return 0;\n}"
  }
]