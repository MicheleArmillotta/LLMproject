[
  {
    "function_name": "virAccessManagerCheckStorageVol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "368-382",
    "snippet": "int virAccessManagerCheckStorageVol(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virStoragePoolDefPtr pool,\n                                    virStorageVolDefPtr vol,\n                                    virAccessPermStorageVol perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s pool=%p vol=%p perm=%d\",\n              manager, manager->drv->name, driverName, pool, vol, perm);\n\n    if (manager->drv->checkStorageVol)\n        ret = manager->drv->checkStorageVol(manager, driverName, pool, vol, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkStorageVol",
          "args": [
            "manager",
            "driverName",
            "pool",
            "vol",
            "perm"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s pool=%p vol=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "pool",
            "vol",
            "perm"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckStorageVol(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virStoragePoolDefPtr pool,\n                                    virStorageVolDefPtr vol,\n                                    virAccessPermStorageVol perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s pool=%p vol=%p perm=%d\",\n              manager, manager->drv->name, driverName, pool, vol, perm);\n\n    if (manager->drv->checkStorageVol)\n        ret = manager->drv->checkStorageVol(manager, driverName, pool, vol, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckStoragePool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "353-366",
    "snippet": "int virAccessManagerCheckStoragePool(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virStoragePoolDefPtr pool,\n                                     virAccessPermStoragePool perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s pool=%p perm=%d\",\n              manager, manager->drv->name, driverName, pool, perm);\n\n    if (manager->drv->checkStoragePool)\n        ret = manager->drv->checkStoragePool(manager, driverName, pool, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkStoragePool",
          "args": [
            "manager",
            "driverName",
            "pool",
            "perm"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s pool=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "pool",
            "perm"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckStoragePool(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virStoragePoolDefPtr pool,\n                                     virAccessPermStoragePool perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s pool=%p perm=%d\",\n              manager, manager->drv->name, driverName, pool, perm);\n\n    if (manager->drv->checkStoragePool)\n        ret = manager->drv->checkStoragePool(manager, driverName, pool, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckSecret",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "338-351",
    "snippet": "int virAccessManagerCheckSecret(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virSecretDefPtr secret,\n                                virAccessPermSecret perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s secret=%p perm=%d\",\n              manager, manager->drv->name, driverName, secret, perm);\n\n    if (manager->drv->checkSecret)\n        ret = manager->drv->checkSecret(manager, driverName, secret, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkSecret",
          "args": [
            "manager",
            "driverName",
            "secret",
            "perm"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s secret=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "secret",
            "perm"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckSecret(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virSecretDefPtr secret,\n                                virAccessPermSecret perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s secret=%p perm=%d\",\n              manager, manager->drv->name, driverName, secret, perm);\n\n    if (manager->drv->checkSecret)\n        ret = manager->drv->checkSecret(manager, driverName, secret, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckNWFilterBinding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "323-336",
    "snippet": "int virAccessManagerCheckNWFilterBinding(virAccessManagerPtr manager,\n                                         const char *driverName,\n                                         virNWFilterBindingDefPtr binding,\n                                         virAccessPermNWFilterBinding perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s binding=%p perm=%d\",\n              manager, manager->drv->name, driverName, binding, perm);\n\n    if (manager->drv->checkNWFilterBinding)\n        ret = manager->drv->checkNWFilterBinding(manager, driverName, binding, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkNWFilterBinding",
          "args": [
            "manager",
            "driverName",
            "binding",
            "perm"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s binding=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "binding",
            "perm"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNWFilterBinding(virAccessManagerPtr manager,\n                                         const char *driverName,\n                                         virNWFilterBindingDefPtr binding,\n                                         virAccessPermNWFilterBinding perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s binding=%p perm=%d\",\n              manager, manager->drv->name, driverName, binding, perm);\n\n    if (manager->drv->checkNWFilterBinding)\n        ret = manager->drv->checkNWFilterBinding(manager, driverName, binding, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckNWFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "308-321",
    "snippet": "int virAccessManagerCheckNWFilter(virAccessManagerPtr manager,\n                                  const char *driverName,\n                                  virNWFilterDefPtr nwfilter,\n                                  virAccessPermNWFilter perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s nwfilter=%p perm=%d\",\n              manager, manager->drv->name, driverName, nwfilter, perm);\n\n    if (manager->drv->checkNWFilter)\n        ret = manager->drv->checkNWFilter(manager, driverName, nwfilter, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkNWFilter",
          "args": [
            "manager",
            "driverName",
            "nwfilter",
            "perm"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s nwfilter=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "nwfilter",
            "perm"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNWFilter(virAccessManagerPtr manager,\n                                  const char *driverName,\n                                  virNWFilterDefPtr nwfilter,\n                                  virAccessPermNWFilter perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s nwfilter=%p perm=%d\",\n              manager, manager->drv->name, driverName, nwfilter, perm);\n\n    if (manager->drv->checkNWFilter)\n        ret = manager->drv->checkNWFilter(manager, driverName, nwfilter, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckNodeDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "293-306",
    "snippet": "int virAccessManagerCheckNodeDevice(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virNodeDeviceDefPtr nodedev,\n                                    virAccessPermNodeDevice perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s nodedev=%p perm=%d\",\n              manager, manager->drv->name, driverName, nodedev, perm);\n\n    if (manager->drv->checkNodeDevice)\n        ret = manager->drv->checkNodeDevice(manager, driverName, nodedev, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkNodeDevice",
          "args": [
            "manager",
            "driverName",
            "nodedev",
            "perm"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s nodedev=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "nodedev",
            "perm"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNodeDevice(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virNodeDeviceDefPtr nodedev,\n                                    virAccessPermNodeDevice perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s nodedev=%p perm=%d\",\n              manager, manager->drv->name, driverName, nodedev, perm);\n\n    if (manager->drv->checkNodeDevice)\n        ret = manager->drv->checkNodeDevice(manager, driverName, nodedev, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckNetworkPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "277-291",
    "snippet": "int virAccessManagerCheckNetworkPort(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virNetworkDefPtr network,\n                                     virNetworkPortDefPtr port,\n                                     virAccessPermNetworkPort perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s network=%p port=%p perm=%d\",\n              manager, manager->drv->name, driverName, network, port, perm);\n\n    if (manager->drv->checkNetworkPort)\n        ret = manager->drv->checkNetworkPort(manager, driverName, network, port, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkNetworkPort",
          "args": [
            "manager",
            "driverName",
            "network",
            "port",
            "perm"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s network=%p port=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "network",
            "port",
            "perm"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNetworkPort(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virNetworkDefPtr network,\n                                     virNetworkPortDefPtr port,\n                                     virAccessPermNetworkPort perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s network=%p port=%p perm=%d\",\n              manager, manager->drv->name, driverName, network, port, perm);\n\n    if (manager->drv->checkNetworkPort)\n        ret = manager->drv->checkNetworkPort(manager, driverName, network, port, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckNetwork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "262-275",
    "snippet": "int virAccessManagerCheckNetwork(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virNetworkDefPtr network,\n                                 virAccessPermNetwork perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s network=%p perm=%d\",\n              manager, manager->drv->name, driverName, network, perm);\n\n    if (manager->drv->checkNetwork)\n        ret = manager->drv->checkNetwork(manager, driverName, network, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkNetwork",
          "args": [
            "manager",
            "driverName",
            "network",
            "perm"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s network=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "network",
            "perm"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNetwork(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virNetworkDefPtr network,\n                                 virAccessPermNetwork perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s network=%p perm=%d\",\n              manager, manager->drv->name, driverName, network, perm);\n\n    if (manager->drv->checkNetwork)\n        ret = manager->drv->checkNetwork(manager, driverName, network, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckInterface",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "247-260",
    "snippet": "int virAccessManagerCheckInterface(virAccessManagerPtr manager,\n                                   const char *driverName,\n                                   virInterfaceDefPtr iface,\n                                   virAccessPermInterface perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s iface=%p perm=%d\",\n              manager, manager->drv->name, driverName, iface, perm);\n\n    if (manager->drv->checkInterface)\n        ret = manager->drv->checkInterface(manager, driverName, iface, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkInterface",
          "args": [
            "manager",
            "driverName",
            "iface",
            "perm"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s iface=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "iface",
            "perm"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckInterface(virAccessManagerPtr manager,\n                                   const char *driverName,\n                                   virInterfaceDefPtr iface,\n                                   virAccessPermInterface perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s iface=%p perm=%d\",\n              manager, manager->drv->name, driverName, iface, perm);\n\n    if (manager->drv->checkInterface)\n        ret = manager->drv->checkInterface(manager, driverName, iface, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "232-245",
    "snippet": "int virAccessManagerCheckDomain(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virDomainDefPtr domain,\n                                virAccessPermDomain perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s domain=%p perm=%d\",\n              manager, manager->drv->name, driverName, domain, perm);\n\n    if (manager->drv->checkDomain)\n        ret = manager->drv->checkDomain(manager, driverName, domain, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkDomain",
          "args": [
            "manager",
            "driverName",
            "domain",
            "perm"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s domain=%p perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "domain",
            "perm"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckDomain(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virDomainDefPtr domain,\n                                virAccessPermDomain perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s domain=%p perm=%d\",\n              manager, manager->drv->name, driverName, domain, perm);\n\n    if (manager->drv->checkDomain)\n        ret = manager->drv->checkDomain(manager, driverName, domain, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerCheckConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "217-229",
    "snippet": "int virAccessManagerCheckConnect(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virAccessPermConnect perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s perm=%d\",\n              manager, manager->drv->name, driverName, perm);\n\n    if (manager->drv->checkConnect)\n        ret = manager->drv->checkConnect(manager, driverName, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerSanitizeError",
          "args": [
            "ret",
            "driverName"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerSanitizeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "204-215",
          "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "manager->drv->checkConnect",
          "args": [
            "manager",
            "driverName",
            "perm"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"manager=%p(name=%s) driver=%s perm=%d\"",
            "manager",
            "manager->drv->name",
            "driverName",
            "perm"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckConnect(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virAccessPermConnect perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s perm=%d\",\n              manager, manager->drv->name, driverName, perm);\n\n    if (manager->drv->checkConnect)\n        ret = manager->drv->checkConnect(manager, driverName, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
  },
  {
    "function_name": "virAccessManagerSanitizeError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "204-215",
    "snippet": "static int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessError",
          "args": [
            "VIR_ERR_ACCESS_DENIED",
            "_(\"'%s' denied access\")",
            "driverName"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"'%s' denied access\""
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int\nvirAccessManagerSanitizeError(int ret,\n                              const char *driverName)\n{\n    if (ret < 0) {\n        virResetLastError();\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"'%s' denied access\"), driverName);\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessManagerDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "188-195",
    "snippet": "static void virAccessManagerDispose(void *object)\n{\n    virAccessManagerPtr mgr = object;\n\n    if (mgr->drv->cleanup)\n        mgr->drv->cleanup(mgr);\n    VIR_FREE(mgr->privateData);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mgr->privateData"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mgr->drv->cleanup",
          "args": [
            "mgr"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic void virAccessManagerDispose(void *object)\n{\n    virAccessManagerPtr mgr = object;\n\n    if (mgr->drv->cleanup)\n        mgr->drv->cleanup(mgr);\n    VIR_FREE(mgr->privateData);\n}"
  },
  {
    "function_name": "virAccessManagerGetPrivateData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "182-185",
    "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
  },
  {
    "function_name": "virAccessManagerNewStack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "154-179",
    "snippet": "virAccessManagerPtr virAccessManagerNewStack(const char **names)\n{\n    virAccessManagerPtr manager = virAccessManagerNewDriver(&accessDriverStack);\n    size_t i;\n\n    if (!manager)\n        return NULL;\n\n    for (i = 0; names[i] != NULL; i++) {\n        virAccessManagerPtr child = virAccessManagerNew(names[i]);\n\n        if (!child)\n            goto error;\n\n        if (virAccessDriverStackAppend(manager, child) < 0) {\n            virObjectUnref(child);\n            goto error;\n        }\n    }\n\n    return manager;\n\n error:\n    virObjectUnref(manager);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "manager"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessDriverStackAppend",
          "args": [
            "manager",
            "child"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverStackAppend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
          "lines": "38-49",
          "snippet": "int virAccessDriverStackAppend(virAccessManagerPtr manager,\n                               virAccessManagerPtr child)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n\n    if (VIR_EXPAND_N(priv->managers, priv->managersLen, 1) < 0)\n        return -1;\n\n    priv->managers[priv->managersLen-1] = child;\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nint virAccessDriverStackAppend(virAccessManagerPtr manager,\n                               virAccessManagerPtr child)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n\n    if (VIR_EXPAND_N(priv->managers, priv->managersLen, 1) < 0)\n        return -1;\n\n    priv->managers[priv->managersLen-1] = child;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerNew",
          "args": [
            "names[i]"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerNewStack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "154-179",
          "snippet": "virAccessManagerPtr virAccessManagerNewStack(const char **names)\n{\n    virAccessManagerPtr manager = virAccessManagerNewDriver(&accessDriverStack);\n    size_t i;\n\n    if (!manager)\n        return NULL;\n\n    for (i = 0; names[i] != NULL; i++) {\n        virAccessManagerPtr child = virAccessManagerNew(names[i]);\n\n        if (!child)\n            goto error;\n\n        if (virAccessDriverStackAppend(manager, child) < 0) {\n            virObjectUnref(child);\n            goto error;\n        }\n    }\n\n    return manager;\n\n error:\n    virObjectUnref(manager);\n    return NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerNewDriver",
          "args": [
            "&accessDriverStack"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerNewDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "86-113",
          "snippet": "static virAccessManagerPtr virAccessManagerNewDriver(virAccessDriverPtr drv)\n{\n    virAccessManagerPtr mgr;\n    char *privateData;\n\n    if (virAccessManagerInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(privateData, drv->privateDataLen) < 0)\n        return NULL;\n\n    if (!(mgr = virObjectLockableNew(virAccessManagerClass))) {\n        VIR_FREE(privateData);\n        return NULL;\n    }\n\n    mgr->drv = drv;\n    mgr->privateData = privateData;\n\n    if (mgr->drv->setup &&\n        mgr->drv->setup(mgr) < 0) {\n        virObjectUnref(mgr);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"Initialized with %s\", mgr->drv->name);\n    return mgr;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virAccessManagerClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic virClassPtr virAccessManagerClass;\n\nstatic virAccessManagerPtr virAccessManagerNewDriver(virAccessDriverPtr drv)\n{\n    virAccessManagerPtr mgr;\n    char *privateData;\n\n    if (virAccessManagerInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(privateData, drv->privateDataLen) < 0)\n        return NULL;\n\n    if (!(mgr = virObjectLockableNew(virAccessManagerClass))) {\n        VIR_FREE(privateData);\n        return NULL;\n    }\n\n    mgr->drv = drv;\n    mgr->privateData = privateData;\n\n    if (mgr->drv->setup &&\n        mgr->drv->setup(mgr) < 0) {\n        virObjectUnref(mgr);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"Initialized with %s\", mgr->drv->name);\n    return mgr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvirAccessManagerPtr virAccessManagerNewStack(const char **names)\n{\n    virAccessManagerPtr manager = virAccessManagerNewDriver(&accessDriverStack);\n    size_t i;\n\n    if (!manager)\n        return NULL;\n\n    for (i = 0; names[i] != NULL; i++) {\n        virAccessManagerPtr child = virAccessManagerNew(names[i]);\n\n        if (!child)\n            goto error;\n\n        if (virAccessDriverStackAppend(manager, child) < 0) {\n            virObjectUnref(child);\n            goto error;\n        }\n    }\n\n    return manager;\n\n error:\n    virObjectUnref(manager);\n    return NULL;\n}"
  },
  {
    "function_name": "virAccessManagerNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "136-151",
    "snippet": "virAccessManagerPtr virAccessManagerNew(const char *name)\n{\n    virAccessDriverPtr drv;\n\n    if (virAccessManagerInitialize() < 0)\n        return NULL;\n\n    if (!(drv = virAccessManagerFindDriver(name))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find security driver '%s'\"),\n                       name);\n        return NULL;\n    }\n\n    return virAccessManagerNewDriver(drv);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerNewDriver",
          "args": [
            "drv"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerNewDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "86-113",
          "snippet": "static virAccessManagerPtr virAccessManagerNewDriver(virAccessDriverPtr drv)\n{\n    virAccessManagerPtr mgr;\n    char *privateData;\n\n    if (virAccessManagerInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(privateData, drv->privateDataLen) < 0)\n        return NULL;\n\n    if (!(mgr = virObjectLockableNew(virAccessManagerClass))) {\n        VIR_FREE(privateData);\n        return NULL;\n    }\n\n    mgr->drv = drv;\n    mgr->privateData = privateData;\n\n    if (mgr->drv->setup &&\n        mgr->drv->setup(mgr) < 0) {\n        virObjectUnref(mgr);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"Initialized with %s\", mgr->drv->name);\n    return mgr;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virAccessManagerClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic virClassPtr virAccessManagerClass;\n\nstatic virAccessManagerPtr virAccessManagerNewDriver(virAccessDriverPtr drv)\n{\n    virAccessManagerPtr mgr;\n    char *privateData;\n\n    if (virAccessManagerInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(privateData, drv->privateDataLen) < 0)\n        return NULL;\n\n    if (!(mgr = virObjectLockableNew(virAccessManagerClass))) {\n        VIR_FREE(privateData);\n        return NULL;\n    }\n\n    mgr->drv = drv;\n    mgr->privateData = privateData;\n\n    if (mgr->drv->setup &&\n        mgr->drv->setup(mgr) < 0) {\n        virObjectUnref(mgr);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"Initialized with %s\", mgr->drv->name);\n    return mgr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find security driver '%s'\")",
            "name"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot find security driver '%s'\""
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerFindDriver",
          "args": [
            "name"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerFindDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "124-133",
          "snippet": "static virAccessDriverPtr virAccessManagerFindDriver(const char *name)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(accessDrivers); i++) {\n        if (STREQ(name, accessDrivers[i]->name))\n            return accessDrivers[i];\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virAccessDriverPtr accessDrivers[] = {\n    &accessDriverNop,\n#if WITH_POLKIT\n    &accessDriverPolkit,\n#endif\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic virAccessDriverPtr accessDrivers[] = {\n    &accessDriverNop,\n#if WITH_POLKIT\n    &accessDriverPolkit,\n#endif\n};\n\nstatic virAccessDriverPtr virAccessManagerFindDriver(const char *name)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(accessDrivers); i++) {\n        if (STREQ(name, accessDrivers[i]->name))\n            return accessDrivers[i];\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerInitialize",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvirAccessManagerPtr virAccessManagerNew(const char *name)\n{\n    virAccessDriverPtr drv;\n\n    if (virAccessManagerInitialize() < 0)\n        return NULL;\n\n    if (!(drv = virAccessManagerFindDriver(name))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find security driver '%s'\"),\n                       name);\n        return NULL;\n    }\n\n    return virAccessManagerNewDriver(drv);\n}"
  },
  {
    "function_name": "virAccessManagerFindDriver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "124-133",
    "snippet": "static virAccessDriverPtr virAccessManagerFindDriver(const char *name)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(accessDrivers); i++) {\n        if (STREQ(name, accessDrivers[i]->name))\n            return accessDrivers[i];\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virAccessDriverPtr accessDrivers[] = {\n    &accessDriverNop,\n#if WITH_POLKIT\n    &accessDriverPolkit,\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "accessDrivers[i]->name"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "accessDrivers"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic virAccessDriverPtr accessDrivers[] = {\n    &accessDriverNop,\n#if WITH_POLKIT\n    &accessDriverPolkit,\n#endif\n};\n\nstatic virAccessDriverPtr virAccessManagerFindDriver(const char *name)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(accessDrivers); i++) {\n        if (STREQ(name, accessDrivers[i]->name))\n            return accessDrivers[i];\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virAccessManagerNewDriver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "86-113",
    "snippet": "static virAccessManagerPtr virAccessManagerNewDriver(virAccessDriverPtr drv)\n{\n    virAccessManagerPtr mgr;\n    char *privateData;\n\n    if (virAccessManagerInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(privateData, drv->privateDataLen) < 0)\n        return NULL;\n\n    if (!(mgr = virObjectLockableNew(virAccessManagerClass))) {\n        VIR_FREE(privateData);\n        return NULL;\n    }\n\n    mgr->drv = drv;\n    mgr->privateData = privateData;\n\n    if (mgr->drv->setup &&\n        mgr->drv->setup(mgr) < 0) {\n        virObjectUnref(mgr);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"Initialized with %s\", mgr->drv->name);\n    return mgr;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virAccessManagerClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Initialized with %s\"",
            "mgr->drv->name"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "mgr"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mgr->drv->setup",
          "args": [
            "mgr"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "privateData"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virAccessManagerClass"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "privateData",
            "drv->privateDataLen"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAccessManagerInitialize",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic virClassPtr virAccessManagerClass;\n\nstatic virAccessManagerPtr virAccessManagerNewDriver(virAccessDriverPtr drv)\n{\n    virAccessManagerPtr mgr;\n    char *privateData;\n\n    if (virAccessManagerInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(privateData, drv->privateDataLen) < 0)\n        return NULL;\n\n    if (!(mgr = virObjectLockableNew(virAccessManagerClass))) {\n        VIR_FREE(privateData);\n        return NULL;\n    }\n\n    mgr->drv = drv;\n    mgr->privateData = privateData;\n\n    if (mgr->drv->setup &&\n        mgr->drv->setup(mgr) < 0) {\n        virObjectUnref(mgr);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"Initialized with %s\", mgr->drv->name);\n    return mgr;\n}"
  },
  {
    "function_name": "virAccessManagerSetDefault",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "78-83",
    "snippet": "void virAccessManagerSetDefault(virAccessManagerPtr mgr)\n{\n    virObjectUnref(virAccessManagerDefault);\n\n    virAccessManagerDefault = virObjectRef(mgr);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virAccessManagerPtr virAccessManagerDefault;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "mgr"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "virAccessManagerDefault"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic virAccessManagerPtr virAccessManagerDefault;\n\nvoid virAccessManagerSetDefault(virAccessManagerPtr mgr)\n{\n    virObjectUnref(virAccessManagerDefault);\n\n    virAccessManagerDefault = virObjectRef(mgr);\n}"
  },
  {
    "function_name": "virAccessManagerGetDefault",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "66-75",
    "snippet": "virAccessManagerPtr virAccessManagerGetDefault(void)\n{\n    if (virAccessManagerDefault == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No access manager registered\"));\n        return NULL;\n    }\n\n    return virObjectRef(virAccessManagerDefault);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virAccessManagerPtr virAccessManagerDefault;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "virAccessManagerDefault"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No access manager registered\")"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No access manager registered\""
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic virAccessManagerPtr virAccessManagerDefault;\n\nvirAccessManagerPtr virAccessManagerGetDefault(void)\n{\n    if (virAccessManagerDefault == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No access manager registered\"));\n        return NULL;\n    }\n\n    return virObjectRef(virAccessManagerDefault);\n}"
  },
  {
    "function_name": "virAccessManagerOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
    "lines": "55-61",
    "snippet": "static int virAccessManagerOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virAccessManager, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "# include \"viraccessdriverpolkit.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include \"viraccessdrivernop.h\"",
      "#include \"viraccessmanager.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virAccessManager",
            "virClassForObjectLockable()"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nstatic int virAccessManagerOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virAccessManager, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]