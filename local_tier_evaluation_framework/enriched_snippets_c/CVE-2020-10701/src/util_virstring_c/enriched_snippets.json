[
  {
    "function_name": "virStringParseYesNo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1396-1406",
    "snippet": "int virStringParseYesNo(const char *str, bool *result)\n{\n    if (STREQ(str, \"yes\"))\n        *result = true;\n    else if (STREQ(str, \"no\"))\n        *result = false;\n    else\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str",
            "\"no\""
          ],
          "line": 1400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str",
            "\"yes\""
          ],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint virStringParseYesNo(const char *str, bool *result)\n{\n    if (STREQ(str, \"yes\"))\n        *result = true;\n    else if (STREQ(str, \"no\"))\n        *result = false;\n    else\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virStringParsePort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1358-1384",
    "snippet": "int\nvirStringParsePort(const char *str,\n                   unsigned int *port)\n{\n    unsigned int p = 0;\n\n    *port = 0;\n\n    if (!str)\n        return 0;\n\n    if (virStrToLong_uip(str, NULL, 10, &p) < 0) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"failed to parse port number '%s'\"), str);\n        return -1;\n    }\n\n    if (p > UINT16_MAX) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"port '%s' out of range\"), str);\n        return -1;\n    }\n\n    *port = p;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"port '%s' out of range\")",
            "str"
          ],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"port '%s' out of range\""
          ],
          "line": 1377
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"failed to parse port number '%s'\")",
            "str"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "str",
            "NULL",
            "10",
            "&p"
          ],
          "line": 1369
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStringParsePort(const char *str,\n                   unsigned int *port)\n{\n    unsigned int p = 0;\n\n    *port = 0;\n\n    if (!str)\n        return 0;\n\n    if (virStrToLong_uip(str, NULL, 10, &p) < 0) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"failed to parse port number '%s'\"), str);\n        return -1;\n    }\n\n    if (p > UINT16_MAX) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"port '%s' out of range\"), str);\n        return -1;\n    }\n\n    *port = p;\n\n    return 0;\n}"
  },
  {
    "function_name": "virStringTrimOptionalNewline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1338-1347",
    "snippet": "void virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}"
  },
  {
    "function_name": "virStringBufferIsPrintable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1317-1328",
    "snippet": "bool\nvirStringBufferIsPrintable(const uint8_t *buf,\n                           size_t buflen)\n{\n    size_t i;\n\n    for (i = 0; i < buflen; i++)\n        if (!g_ascii_isprint(buf[i]))\n            return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_isprint",
          "args": [
            "buf[i]"
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringBufferIsPrintable(const uint8_t *buf,\n                           size_t buflen)\n{\n    size_t i;\n\n    for (i = 0; i < buflen; i++)\n        if (!g_ascii_isprint(buf[i]))\n            return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virStringIsPrintable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1299-1309",
    "snippet": "bool\nvirStringIsPrintable(const char *str)\n{\n    size_t i;\n\n    for (i = 0; str[i]; i++)\n        if (!g_ascii_isprint(str[i]))\n            return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_isprint",
          "args": [
            "str[i]"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringIsPrintable(const char *str)\n{\n    size_t i;\n\n    for (i = 0; str[i]; i++)\n        if (!g_ascii_isprint(str[i]))\n            return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virStringToUpper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1271-1291",
    "snippet": "int\nvirStringToUpper(char **dst, const char *src)\n{\n    char *cap = NULL;\n    size_t i;\n\n    if (!src)\n        return 0;\n\n    if (VIR_ALLOC_N(cap, strlen(src) + 1) < 0)\n        return -1;\n\n    for (i = 0; src[i]; i++) {\n        cap[i] = g_ascii_toupper(src[i]);\n        if (cap[i] == '-')\n            cap[i] = '_';\n    }\n\n    *dst = cap;\n    return 1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_toupper",
          "args": [
            "src[i]"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "cap",
            "strlen(src) + 1"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "src"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStringToUpper(char **dst, const char *src)\n{\n    char *cap = NULL;\n    size_t i;\n\n    if (!src)\n        return 0;\n\n    if (VIR_ALLOC_N(cap, strlen(src) + 1) < 0)\n        return -1;\n\n    for (i = 0; src[i]; i++) {\n        cap[i] = g_ascii_toupper(src[i]);\n        if (cap[i] == '-')\n            cap[i] = '_';\n    }\n\n    *dst = cap;\n    return 1;\n}"
  },
  {
    "function_name": "virStringFilterChars",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1245-1259",
    "snippet": "void\nvirStringFilterChars(char *str, const char *valid)\n{\n    size_t len, i, j;\n\n    if (!str)\n        return;\n\n    len = strlen(str);\n    for (i = 0, j = 0; i < len; i++) {\n        if (strchr(valid, str[i]))\n            str[j++] = str[i];\n    }\n    str[j] = '\\0';\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "valid",
            "str[i]"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirStringFilterChars(char *str, const char *valid)\n{\n    size_t len, i, j;\n\n    if (!str)\n        return;\n\n    len = strlen(str);\n    for (i = 0, j = 0; i < len; i++) {\n        if (strchr(valid, str[i]))\n            str[j++] = str[i];\n    }\n    str[j] = '\\0';\n}"
  },
  {
    "function_name": "virStringStripControlChars",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1219-1235",
    "snippet": "void\nvirStringStripControlChars(char *str)\n{\n    size_t len, i, j;\n\n    if (!str)\n        return;\n\n    len = strlen(str);\n    for (i = 0, j = 0; i < len; i++) {\n        if (strchr(control_chars, str[i]))\n            continue;\n\n        str[j++] = str[i];\n    }\n    str[j] = '\\0';\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char control_chars[] =\n    \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\"\n    \"\\x08\" /* \\t \\n */ \"\\x0B\\x0C\" /* \\r */ \"\\x0E\\x0F\"\n    \"\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\"\n    \"\\x18\\x19\\x1A\\x1B\\x1C\\x1D\\x1E\\x1F\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "control_chars",
            "str[i]"
          ],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic const char control_chars[] =\n    \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\"\n    \"\\x08\" /* \\t \\n */ \"\\x0B\\x0C\" /* \\r */ \"\\x0E\\x0F\"\n    \"\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\"\n    \"\\x18\\x19\\x1A\\x1B\\x1C\\x1D\\x1E\\x1F\";\n\nvoid\nvirStringStripControlChars(char *str)\n{\n    size_t len, i, j;\n\n    if (!str)\n        return;\n\n    len = strlen(str);\n    for (i = 0, j = 0; i < len; i++) {\n        if (strchr(control_chars, str[i]))\n            continue;\n\n        str[j++] = str[i];\n    }\n    str[j] = '\\0';\n}"
  },
  {
    "function_name": "virStringHasControlChars",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1205-1209",
    "snippet": "bool\nvirStringHasControlChars(const char *str)\n{\n    return virStringHasChars(str, control_chars);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char control_chars[] =\n    \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\"\n    \"\\x08\" /* \\t \\n */ \"\\x0B\\x0C\" /* \\r */ \"\\x0E\\x0F\"\n    \"\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\"\n    \"\\x18\\x19\\x1A\\x1B\\x1C\\x1D\\x1E\\x1F\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringHasChars",
          "args": [
            "str",
            "control_chars"
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "virStringHasChars",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1188-1196",
          "snippet": "bool\nvirStringHasChars(const char *str,\n                  const char *chars)\n{\n    if (!str)\n        return false;\n\n    return str[strcspn(str, chars)] != '\\0';\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringHasChars(const char *str,\n                  const char *chars)\n{\n    if (!str)\n        return false;\n\n    return str[strcspn(str, chars)] != '\\0';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic const char control_chars[] =\n    \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\"\n    \"\\x08\" /* \\t \\n */ \"\\x0B\\x0C\" /* \\r */ \"\\x0E\\x0F\"\n    \"\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\"\n    \"\\x18\\x19\\x1A\\x1B\\x1C\\x1D\\x1E\\x1F\";\n\nbool\nvirStringHasControlChars(const char *str)\n{\n    return virStringHasChars(str, control_chars);\n}"
  },
  {
    "function_name": "virStringHasChars",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1188-1196",
    "snippet": "bool\nvirStringHasChars(const char *str,\n                  const char *chars)\n{\n    if (!str)\n        return false;\n\n    return str[strcspn(str, chars)] != '\\0';\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "str",
            "chars"
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringHasChars(const char *str,\n                  const char *chars)\n{\n    if (!str)\n        return false;\n\n    return str[strcspn(str, chars)] != '\\0';\n}"
  },
  {
    "function_name": "virStringStripIPv6Brackets",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1165-1178",
    "snippet": "void\nvirStringStripIPv6Brackets(char *str)\n{\n    size_t len;\n\n    if (!str)\n        return;\n\n    len = strlen(str);\n    if (str[0] == '[' && str[len - 1] == ']' && strchr(str, ':')) {\n        memmove(&str[0], &str[1], len - 2);\n        str[len - 2] = '\\0';\n    }\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "&str[0]",
            "&str[1]",
            "len - 2"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "str",
            "':'"
          ],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirStringStripIPv6Brackets(char *str)\n{\n    size_t len;\n\n    if (!str)\n        return;\n\n    len = strlen(str);\n    if (str[0] == '[' && str[len - 1] == ']' && strchr(str, ':')) {\n        memmove(&str[0], &str[1], len - 2);\n        str[len - 2] = '\\0';\n    }\n}"
  },
  {
    "function_name": "virStringMatchesNameSuffix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1141-1156",
    "snippet": "bool\nvirStringMatchesNameSuffix(const char *file,\n                           const char *name,\n                           const char *suffix)\n{\n    int filelen = strlen(file);\n    int namelen = strlen(name);\n    int suffixlen = strlen(suffix);\n\n    if (filelen == (namelen + suffixlen) &&\n        STREQLEN(file, name, namelen) &&\n        STREQ(file + namelen, suffix))\n        return true;\n    else\n        return false;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "file + namelen",
            "suffix"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQLEN",
          "args": [
            "file",
            "name",
            "namelen"
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "suffix"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "file"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringMatchesNameSuffix(const char *file,\n                           const char *name,\n                           const char *suffix)\n{\n    int filelen = strlen(file);\n    int namelen = strlen(name);\n    int suffixlen = strlen(suffix);\n\n    if (filelen == (namelen + suffixlen) &&\n        STREQLEN(file, name, namelen) &&\n        STREQ(file + namelen, suffix))\n        return true;\n    else\n        return false;\n}"
  },
  {
    "function_name": "virStringStripSuffix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1123-1139",
    "snippet": "bool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "str + len - suffixlen",
            "suffix"
          ],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "suffix"
          ],
          "line": 1128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}"
  },
  {
    "function_name": "virStringHasCaseSuffix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1110-1121",
    "snippet": "bool\nvirStringHasCaseSuffix(const char *str,\n                       const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    return STRCASEEQ(str + len - suffixlen, suffix);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "str + len - suffixlen",
            "suffix"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "suffix"
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringHasCaseSuffix(const char *str,\n                       const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    return STRCASEEQ(str + len - suffixlen, suffix);\n}"
  },
  {
    "function_name": "virStringHasSuffix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1097-1108",
    "snippet": "bool\nvirStringHasSuffix(const char *str,\n                   const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    return STREQ(str + len - suffixlen, suffix);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "str + len - suffixlen",
            "suffix"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "suffix"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringHasSuffix(const char *str,\n                   const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    return STREQ(str + len - suffixlen, suffix);\n}"
  },
  {
    "function_name": "virStringReplace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1067-1095",
    "snippet": "char *\nvirStringReplace(const char *haystack,\n                 const char *oldneedle,\n                 const char *newneedle)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *tmp1, *tmp2;\n    size_t oldneedlelen = strlen(oldneedle);\n    size_t newneedlelen = strlen(newneedle);\n\n    tmp1 = haystack;\n    tmp2 = NULL;\n\n    while (tmp1) {\n        tmp2 = strstr(tmp1, oldneedle);\n\n        if (tmp2) {\n            virBufferAdd(&buf, tmp1, (tmp2 - tmp1));\n            virBufferAdd(&buf, newneedle, newneedlelen);\n            tmp2 += oldneedlelen;\n        } else {\n            virBufferAdd(&buf, tmp1, -1);\n        }\n\n        tmp1 = tmp2;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "&buf",
            "tmp1",
            "-1"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "tmp1",
            "oldneedle"
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "newneedle"
          ],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "oldneedle"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar *\nvirStringReplace(const char *haystack,\n                 const char *oldneedle,\n                 const char *newneedle)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *tmp1, *tmp2;\n    size_t oldneedlelen = strlen(oldneedle);\n    size_t newneedlelen = strlen(newneedle);\n\n    tmp1 = haystack;\n    tmp2 = NULL;\n\n    while (tmp1) {\n        tmp2 = strstr(tmp1, oldneedle);\n\n        if (tmp2) {\n            virBufferAdd(&buf, tmp1, (tmp2 - tmp1));\n            virBufferAdd(&buf, newneedle, newneedlelen);\n            tmp2 += oldneedlelen;\n        } else {\n            virBufferAdd(&buf, tmp1, -1);\n        }\n\n        tmp1 = tmp2;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virStringMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "1039-1055",
    "snippet": "bool\nvirStringMatch(const char *str,\n               const char *regexp)\n{\n    g_autoptr(GRegex) regex = NULL;\n    g_autoptr(GError) err = NULL;\n\n    VIR_DEBUG(\"match '%s' for '%s'\", str, regexp);\n\n    regex = g_regex_new(regexp, 0, 0, &err);\n    if (!regex) {\n        VIR_WARN(\"Failed to compile regex %s\", err->message);\n        return false;\n    }\n\n    return g_regex_match(regex, str, 0, NULL);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_regex_match",
          "args": [
            "regex",
            "str",
            "0",
            "NULL"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Failed to compile regex %s\"",
            "err->message"
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_regex_new",
          "args": [
            "regexp",
            "0",
            "0",
            "&err"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"match '%s' for '%s'\"",
            "str",
            "regexp"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringMatch(const char *str,\n               const char *regexp)\n{\n    g_autoptr(GRegex) regex = NULL;\n    g_autoptr(GError) err = NULL;\n\n    VIR_DEBUG(\"match '%s' for '%s'\", str, regexp);\n\n    regex = g_regex_new(regexp, 0, 0, &err);\n    if (!regex) {\n        VIR_WARN(\"Failed to compile regex %s\", err->message);\n        return false;\n    }\n\n    return g_regex_match(regex, str, 0, NULL);\n}"
  },
  {
    "function_name": "virStringSearch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "965-1029",
    "snippet": "ssize_t\nvirStringSearch(const char *str,\n                const char *regexp,\n                size_t max_matches,\n                char ***matches)\n{\n    g_autoptr(GRegex) regex = NULL;\n    g_autoptr(GError) err = NULL;\n    size_t nmatches = 0;\n    ssize_t ret = -1;\n\n    *matches = NULL;\n\n    VIR_DEBUG(\"search '%s' for '%s'\", str, regexp);\n\n    regex = g_regex_new(regexp, 0, 0, &err);\n    if (!regex) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to compile regex %s\"), err->message);\n        return -1;\n    }\n\n    if (g_regex_get_capture_count(regex) != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Regular expression '%s' must have exactly 1 match group, not %d\"),\n                       regexp, g_regex_get_capture_count(regex));\n        goto cleanup;\n    }\n\n    /* '*matches' must always be NULL terminated in every iteration\n     * of the loop, so start by allocating 1 element\n     */\n    if (VIR_EXPAND_N(*matches, nmatches, 1) < 0)\n        goto cleanup;\n\n    while ((nmatches - 1) < max_matches) {\n        g_autoptr(GMatchInfo) info = NULL;\n        char *match;\n        int endpos;\n\n        if (!g_regex_match(regex, str, 0, &info))\n            break;\n\n        if (VIR_EXPAND_N(*matches, nmatches, 1) < 0)\n            goto cleanup;\n\n        match = g_match_info_fetch(info, 1);\n\n        VIR_DEBUG(\"Got '%s'\", match);\n\n        (*matches)[nmatches-2] = match;\n\n        g_match_info_fetch_pos(info, 1, NULL, &endpos);\n        str += endpos;\n    }\n\n    ret = nmatches - 1; /* don't count the trailing null */\n\n cleanup:\n    if (ret < 0) {\n        virStringListFree(*matches);\n        *matches = NULL;\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "*matches"
          ],
          "line": 1025
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_match_info_fetch_pos",
          "args": [
            "info",
            "1",
            "NULL",
            "&endpos"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Got '%s'\"",
            "match"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_match_info_fetch",
          "args": [
            "info",
            "1"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "*matches",
            "nmatches",
            "1"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_regex_match",
          "args": [
            "regex",
            "str",
            "0",
            "&info"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "*matches",
            "nmatches",
            "1"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Regular expression '%s' must have exactly 1 match group, not %d\")",
            "regexp",
            "g_regex_get_capture_count(regex)"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_regex_get_capture_count",
          "args": [
            "regex"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Regular expression '%s' must have exactly 1 match group, not %d\""
          ],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_regex_get_capture_count",
          "args": [
            "regex"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Failed to compile regex %s\")",
            "err->message"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_regex_new",
          "args": [
            "regexp",
            "0",
            "0",
            "&err"
          ],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"search '%s' for '%s'\"",
            "str",
            "regexp"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nssize_t\nvirStringSearch(const char *str,\n                const char *regexp,\n                size_t max_matches,\n                char ***matches)\n{\n    g_autoptr(GRegex) regex = NULL;\n    g_autoptr(GError) err = NULL;\n    size_t nmatches = 0;\n    ssize_t ret = -1;\n\n    *matches = NULL;\n\n    VIR_DEBUG(\"search '%s' for '%s'\", str, regexp);\n\n    regex = g_regex_new(regexp, 0, 0, &err);\n    if (!regex) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to compile regex %s\"), err->message);\n        return -1;\n    }\n\n    if (g_regex_get_capture_count(regex) != 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Regular expression '%s' must have exactly 1 match group, not %d\"),\n                       regexp, g_regex_get_capture_count(regex));\n        goto cleanup;\n    }\n\n    /* '*matches' must always be NULL terminated in every iteration\n     * of the loop, so start by allocating 1 element\n     */\n    if (VIR_EXPAND_N(*matches, nmatches, 1) < 0)\n        goto cleanup;\n\n    while ((nmatches - 1) < max_matches) {\n        g_autoptr(GMatchInfo) info = NULL;\n        char *match;\n        int endpos;\n\n        if (!g_regex_match(regex, str, 0, &info))\n            break;\n\n        if (VIR_EXPAND_N(*matches, nmatches, 1) < 0)\n            goto cleanup;\n\n        match = g_match_info_fetch(info, 1);\n\n        VIR_DEBUG(\"Got '%s'\", match);\n\n        (*matches)[nmatches-2] = match;\n\n        g_match_info_fetch_pos(info, 1, NULL, &endpos);\n        str += endpos;\n    }\n\n    ret = nmatches - 1; /* don't count the trailing null */\n\n cleanup:\n    if (ret < 0) {\n        virStringListFree(*matches);\n        *matches = NULL;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virStringSortRevCompare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "924-930",
    "snippet": "int virStringSortRevCompare(const void *a, const void *b)\n{\n    const char **sa = (const char**)a;\n    const char **sb = (const char**)b;\n\n    return strcmp(*sb, *sa);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "*sb",
            "*sa"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint virStringSortRevCompare(const void *a, const void *b)\n{\n    const char **sa = (const char**)a;\n    const char **sb = (const char**)b;\n\n    return strcmp(*sb, *sa);\n}"
  },
  {
    "function_name": "virStringSortCompare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "910-916",
    "snippet": "int virStringSortCompare(const void *a, const void *b)\n{\n    const char **sa = (const char**)a;\n    const char **sb = (const char**)b;\n\n    return strcmp(*sa, *sb);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "*sa",
            "*sb"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint virStringSortCompare(const void *a, const void *b)\n{\n    const char **sa = (const char**)a;\n    const char **sb = (const char**)b;\n\n    return strcmp(*sa, *sb);\n}"
  },
  {
    "function_name": "virStringListLength",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "893-901",
    "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
  },
  {
    "function_name": "virStringIsEmpty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "882-890",
    "snippet": "bool\nvirStringIsEmpty(const char *str)\n{\n    if (!str)\n        return true;\n\n    virSkipSpaces(&str);\n    return str[0] == '\\0';\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&str"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringIsEmpty(const char *str)\n{\n    if (!str)\n        return true;\n\n    virSkipSpaces(&str);\n    return str[0] == '\\0';\n}"
  },
  {
    "function_name": "virSkipSpacesBackwards",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "862-874",
    "snippet": "void\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTrimSpaces",
          "args": [
            "s",
            "endp"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "virTrimSpaces",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "835-853",
          "snippet": "void\nvirTrimSpaces(char *str, char **endp)\n{\n    char *end;\n\n    if (!endp || !*endp)\n        end = str + strlen(str);\n    else\n        end = *endp;\n    while (end > str && g_ascii_isspace(end[-1]))\n        end--;\n    if (endp) {\n        if (!*endp)\n            *end = '\\0';\n        *endp = end;\n    } else {\n        *end = '\\0';\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirTrimSpaces(char *str, char **endp)\n{\n    char *end;\n\n    if (!endp || !*endp)\n        end = str + strlen(str);\n    else\n        end = *endp;\n    while (end > str && g_ascii_isspace(end[-1]))\n        end--;\n    if (endp) {\n        if (!*endp)\n            *end = '\\0';\n        *endp = end;\n    } else {\n        *end = '\\0';\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesBackwards(const char *str, char **endp)\n{\n    /* Casting away const is safe, since virTrimSpaces does not\n     * modify string with this particular usage.  */\n    char *s = (char*) str;\n\n    if (!*endp)\n        *endp = s + strlen(s);\n    virTrimSpaces(s, endp);\n    if (s == *endp)\n        *endp = NULL;\n}"
  },
  {
    "function_name": "virTrimSpaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "835-853",
    "snippet": "void\nvirTrimSpaces(char *str, char **endp)\n{\n    char *end;\n\n    if (!endp || !*endp)\n        end = str + strlen(str);\n    else\n        end = *endp;\n    while (end > str && g_ascii_isspace(end[-1]))\n        end--;\n    if (endp) {\n        if (!*endp)\n            *end = '\\0';\n        *endp = end;\n    } else {\n        *end = '\\0';\n    }\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_isspace",
          "args": [
            "end[-1]"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirTrimSpaces(char *str, char **endp)\n{\n    char *end;\n\n    if (!endp || !*endp)\n        end = str + strlen(str);\n    else\n        end = *endp;\n    while (end > str && g_ascii_isspace(end[-1]))\n        end--;\n    if (endp) {\n        if (!*endp)\n            *end = '\\0';\n        *endp = end;\n    } else {\n        *end = '\\0';\n    }\n}"
  },
  {
    "function_name": "virSkipSpacesAndBackslash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "810-818",
    "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_isspace",
          "args": [
            "*cur"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
  },
  {
    "function_name": "virSkipSpaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "793-801",
    "snippet": "void\nvirSkipSpaces(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur))\n        cur++;\n    *str = cur;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_isspace",
          "args": [
            "*cur"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpaces(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur))\n        cur++;\n    *str = cur;\n}"
  },
  {
    "function_name": "virStrcpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "780-784",
    "snippet": "int\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrncpy",
          "args": [
            "dest",
            "src",
            "-1",
            "destbytes"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "virStrncpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "746-765",
          "snippet": "int\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}"
  },
  {
    "function_name": "virStrncpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "746-765",
    "snippet": "int\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dest",
            "src",
            "n"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "src"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}"
  },
  {
    "function_name": "virDoubleToStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "706-720",
    "snippet": "int\nvirDoubleToStr(char **strp, double number)\n{\n    virLocale oldlocale;\n\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n\n    *strp = g_strdup_printf(\"%lf\", number);\n\n    virLocaleRevert(&oldlocale);\n    virLocaleFixupRadix(strp);\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLocaleFixupRadix",
          "args": [
            "strp"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "virLocaleFixupRadix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "648-662",
          "snippet": "static void\nvirLocaleFixupRadix(char **strp)\n{\n    char *radix, *tmp;\n    struct lconv *lc;\n\n    lc = localeconv();\n    radix = lc->decimal_point;\n    tmp = strstr(*strp, radix);\n    if (tmp) {\n        *tmp = '.';\n        if (strlen(radix) > 1)\n            memmove(tmp + 1, tmp + strlen(radix), strlen(*strp) - (tmp - *strp));\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic void\nvirLocaleFixupRadix(char **strp)\n{\n    char *radix, *tmp;\n    struct lconv *lc;\n\n    lc = localeconv();\n    radix = lc->decimal_point;\n    tmp = strstr(*strp, radix);\n    if (tmp) {\n        *tmp = '.';\n        if (strlen(radix) > 1)\n            memmove(tmp + 1, tmp + strlen(radix), strlen(*strp) - (tmp - *strp));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLocaleRevert",
          "args": [
            "&oldlocale"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "virLocaleRevert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "643-646",
          "snippet": "static void\nvirLocaleRevert(virLocale *oldlocale G_GNUC_UNUSED)\n{\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic void\nvirLocaleRevert(virLocale *oldlocale G_GNUC_UNUSED)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%lf\"",
            "number"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLocaleSetRaw",
          "args": [
            "&oldlocale"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "virLocaleSetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "637-641",
          "snippet": "static int\nvirLocaleSetRaw(virLocale *oldlocale G_GNUC_UNUSED)\n{\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic int\nvirLocaleSetRaw(virLocale *oldlocale G_GNUC_UNUSED)\n{\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirDoubleToStr(char **strp, double number)\n{\n    virLocale oldlocale;\n\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n\n    *strp = g_strdup_printf(\"%lf\", number);\n\n    virLocaleRevert(&oldlocale);\n    virLocaleFixupRadix(strp);\n\n    return 0;\n}"
  },
  {
    "function_name": "virStrToDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "674-697",
    "snippet": "int\nvirStrToDouble(char const *s,\n               char **end_ptr,\n               double *result)\n{\n    virLocale oldlocale;\n    double val;\n    char *p;\n    int err;\n\n    errno = 0;\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n    val = strtod(s, &p); /* exempt from syntax-check */\n    virLocaleRevert(&oldlocale);\n\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLocaleRevert",
          "args": [
            "&oldlocale"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "virLocaleRevert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "643-646",
          "snippet": "static void\nvirLocaleRevert(virLocale *oldlocale G_GNUC_UNUSED)\n{\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic void\nvirLocaleRevert(virLocale *oldlocale G_GNUC_UNUSED)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtod",
          "args": [
            "s",
            "&p"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLocaleSetRaw",
          "args": [
            "&oldlocale"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "virLocaleSetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "637-641",
          "snippet": "static int\nvirLocaleSetRaw(virLocale *oldlocale G_GNUC_UNUSED)\n{\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic int\nvirLocaleSetRaw(virLocale *oldlocale G_GNUC_UNUSED)\n{\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToDouble(char const *s,\n               char **end_ptr,\n               double *result)\n{\n    virLocale oldlocale;\n    double val;\n    char *p;\n    int err;\n\n    errno = 0;\n    if (virLocaleSetRaw(&oldlocale) < 0)\n        return -1;\n    val = strtod(s, &p); /* exempt from syntax-check */\n    virLocaleRevert(&oldlocale);\n\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virLocaleFixupRadix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "648-662",
    "snippet": "static void\nvirLocaleFixupRadix(char **strp)\n{\n    char *radix, *tmp;\n    struct lconv *lc;\n\n    lc = localeconv();\n    radix = lc->decimal_point;\n    tmp = strstr(*strp, radix);\n    if (tmp) {\n        *tmp = '.';\n        if (strlen(radix) > 1)\n            memmove(tmp + 1, tmp + strlen(radix), strlen(*strp) - (tmp - *strp));\n    }\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "tmp + 1",
            "tmp + strlen(radix)",
            "strlen(*strp) - (tmp - *strp)"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "*strp"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "radix"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "radix"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "*strp",
            "radix"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "localeconv",
          "args": [],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic void\nvirLocaleFixupRadix(char **strp)\n{\n    char *radix, *tmp;\n    struct lconv *lc;\n\n    lc = localeconv();\n    radix = lc->decimal_point;\n    tmp = strstr(*strp, radix);\n    if (tmp) {\n        *tmp = '.';\n        if (strlen(radix) > 1)\n            memmove(tmp + 1, tmp + strlen(radix), strlen(*strp) - (tmp - *strp));\n    }\n}"
  },
  {
    "function_name": "virLocaleRevert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "643-646",
    "snippet": "static void\nvirLocaleRevert(virLocale *oldlocale G_GNUC_UNUSED)\n{\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic void\nvirLocaleRevert(virLocale *oldlocale G_GNUC_UNUSED)\n{\n}"
  },
  {
    "function_name": "virLocaleSetRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "637-641",
    "snippet": "static int\nvirLocaleSetRaw(virLocale *oldlocale G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic int\nvirLocaleSetRaw(virLocale *oldlocale G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "virLocaleFixupRadix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "628-631",
    "snippet": "static void\nvirLocaleFixupRadix(char **strp G_GNUC_UNUSED)\n{\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic void\nvirLocaleFixupRadix(char **strp G_GNUC_UNUSED)\n{\n}"
  },
  {
    "function_name": "virLocaleRevert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "622-626",
    "snippet": "static void\nvirLocaleRevert(virLocale *oldlocale)\n{\n    uselocale(*oldlocale);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uselocale",
          "args": [
            "*oldlocale"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic void\nvirLocaleRevert(virLocale *oldlocale)\n{\n    uselocale(*oldlocale);\n}"
  },
  {
    "function_name": "virLocaleSetRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "613-620",
    "snippet": "static int\nvirLocaleSetRaw(virLocale *oldlocale)\n{\n    if (virLocaleInitialize() < 0)\n        return -1;\n    *oldlocale = uselocale(virLocaleRaw);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uselocale",
          "args": [
            "virLocaleRaw"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLocaleInitialize",
          "args": [],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic int\nvirLocaleSetRaw(virLocale *oldlocale)\n{\n    if (virLocaleInitialize() < 0)\n        return -1;\n    *oldlocale = uselocale(virLocaleRaw);\n    return 0;\n}"
  },
  {
    "function_name": "virLocaleOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "594-601",
    "snippet": "static int\nvirLocaleOnceInit(void)\n{\n    virLocaleRaw = newlocale(LC_ALL_MASK, \"C\", (locale_t)0);\n    if (!virLocaleRaw)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "newlocale",
          "args": [
            "LC_ALL_MASK",
            "\"C\"",
            "(locale_t)0"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nstatic int\nvirLocaleOnceInit(void)\n{\n    virLocaleRaw = newlocale(LC_ALL_MASK, \"C\", (locale_t)0);\n    if (!virLocaleRaw)\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_ullp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "568-586",
    "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "s",
            "'-'",
            "p - s"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoull",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_ull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "547-564",
    "snippet": "int\nvirStrToLong_ull(char const *s, char **end_ptr, int base,\n                 unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoull",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ull(char const *s, char **end_ptr, int base,\n                 unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_ll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "526-542",
    "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoll",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_ulp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "505-523",
    "snippet": "int\nvirStrToLong_ulp(char const *s, char **end_ptr, int base,\n                 unsigned long *result)\n{\n    unsigned long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "s",
            "'-'",
            "p - s"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ulp(char const *s, char **end_ptr, int base,\n                 unsigned long *result)\n{\n    unsigned long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_ul",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "485-501",
    "snippet": "int\nvirStrToLong_ul(char const *s, char **end_ptr, int base, unsigned long *result)\n{\n    unsigned long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ul(char const *s, char **end_ptr, int base, unsigned long *result)\n{\n    unsigned long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_l",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "464-480",
    "snippet": "int\nvirStrToLong_l(char const *s, char **end_ptr, int base, long *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_l(char const *s, char **end_ptr, int base, long *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_uip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "444-461",
    "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "s",
            "'-'",
            "p - s"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_ui",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "412-440",
    "snippet": "int\nvirStrToLong_ui(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n\n    /* This one's tricky.  We _want_ to allow \"-1\" as shorthand for\n     * UINT_MAX regardless of whether long is 32-bit or 64-bit.  But\n     * strtoul treats \"-1\" as ULONG_MAX, and going from ulong back\n     * to uint differs depending on the size of long. */\n    if (sizeof(long) > sizeof(int) && memchr(s, '-', p - s)) {\n        if (-val > UINT_MAX)\n            err = true;\n        else\n            val &= 0xffffffff;\n    }\n\n    err |= (errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "s",
            "'-'",
            "p - s"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ui(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n\n    /* This one's tricky.  We _want_ to allow \"-1\" as shorthand for\n     * UINT_MAX regardless of whether long is 32-bit or 64-bit.  But\n     * strtoul treats \"-1\" as ULONG_MAX, and going from ulong back\n     * to uint differs depending on the size of long. */\n    if (sizeof(long) > sizeof(int) && memchr(s, '-', p - s)) {\n        if (-val > UINT_MAX)\n            err = true;\n        else\n            val &= 0xffffffff;\n    }\n\n    err |= (errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStrToLong_i",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "391-407",
    "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "s",
            "&p",
            "base"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
  },
  {
    "function_name": "virStringListGetFirstWithPrefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "367-383",
    "snippet": "char *\nvirStringListGetFirstWithPrefix(char **strings,\n                                const char *prefix)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return NULL;\n\n    while (strings[i]) {\n        if (STRPREFIX(strings[i], prefix))\n            return strings[i] + strlen(prefix);\n        i++;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "strings[i]",
            "prefix"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar *\nvirStringListGetFirstWithPrefix(char **strings,\n                                const char *prefix)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return NULL;\n\n    while (strings[i]) {\n        if (STRPREFIX(strings[i], prefix))\n            return strings[i] + strlen(prefix);\n        i++;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virStringListHasString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "350-365",
    "snippet": "bool\nvirStringListHasString(const char **strings,\n                       const char *needle)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return false;\n\n    while (strings[i]) {\n        if (STREQ(strings[i++], needle))\n            return true;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "strings[i++]",
            "needle"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringListHasString(const char **strings,\n                       const char *needle)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return false;\n\n    while (strings[i]) {\n        if (STREQ(strings[i++], needle))\n            return true;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "virStringListFreeCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "334-347",
    "snippet": "void\nvirStringListFreeCount(char **strings,\n                       size_t count)\n{\n    size_t i;\n\n    if (!strings)\n        return;\n\n    for (i = 0; i < count; i++)\n        VIR_FREE(strings[i]);\n\n    VIR_FREE(strings);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strings"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strings[i]"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirStringListFreeCount(char **strings,\n                       size_t count)\n{\n    size_t i;\n\n    if (!strings)\n        return;\n\n    for (i = 0; i < count; i++)\n        VIR_FREE(strings[i]);\n\n    VIR_FREE(strings);\n}"
  },
  {
    "function_name": "virStringListAutoFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "317-324",
    "snippet": "void virStringListAutoFree(char ***strings)\n{\n    if (!*strings)\n        return;\n\n    virStringListFree(*strings);\n    *strings = NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "*strings"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListAutoFree(char ***strings)\n{\n    if (!*strings)\n        return;\n\n    virStringListFree(*strings);\n    *strings = NULL;\n}"
  },
  {
    "function_name": "virStringListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "306-314",
    "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strings"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*tmp"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
  },
  {
    "function_name": "virStringListCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "272-296",
    "snippet": "int\nvirStringListCopy(char ***dst,\n                  const char **src)\n{\n    char **copy = NULL;\n    size_t i;\n\n    *dst = NULL;\n\n    if (!src)\n        return 0;\n\n    if (VIR_ALLOC_N(copy, virStringListLength(src) + 1) < 0)\n        goto error;\n\n    for (i = 0; src[i]; i++)\n        copy[i] = g_strdup(src[i]);\n\n    *dst = copy;\n    return 0;\n\n error:\n    virStringListFree(copy);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "copy"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src[i]"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "copy",
            "virStringListLength(src) + 1"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListLength",
          "args": [
            "src"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "893-901",
          "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStringListCopy(char ***dst,\n                  const char **src)\n{\n    char **copy = NULL;\n    size_t i;\n\n    *dst = NULL;\n\n    if (!src)\n        return 0;\n\n    if (VIR_ALLOC_N(copy, virStringListLength(src) + 1) < 0)\n        goto error;\n\n    for (i = 0; src[i]; i++)\n        copy[i] = g_strdup(src[i]);\n\n    *dst = copy;\n    return 0;\n\n error:\n    virStringListFree(copy);\n    return -1;\n}"
  },
  {
    "function_name": "virStringListMerge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "237-259",
    "snippet": "int\nvirStringListMerge(char ***dst,\n                   char ***src)\n{\n    size_t dst_len, src_len, i;\n\n    if (!src || !*src)\n        return 0;\n\n    dst_len = virStringListLength((const char **) *dst);\n    src_len = virStringListLength((const char **) *src);\n\n    if (VIR_REALLOC_N(*dst, dst_len + src_len + 1) < 0)\n        return -1;\n\n    for (i = 0; i <= src_len; i++)\n        (*dst)[i + dst_len] = (*src)[i];\n\n    /* Don't call virStringListFree() as it would free strings in\n     * @src. */\n    VIR_FREE(*src);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*src"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "*dst",
            "dst_len + src_len + 1"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListLength",
          "args": [
            "(const char **) *src"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "893-901",
          "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStringListMerge(char ***dst,\n                   char ***src)\n{\n    size_t dst_len, src_len, i;\n\n    if (!src || !*src)\n        return 0;\n\n    dst_len = virStringListLength((const char **) *dst);\n    src_len = virStringListLength((const char **) *src);\n\n    if (VIR_REALLOC_N(*dst, dst_len + src_len + 1) < 0)\n        return -1;\n\n    for (i = 0; i <= src_len; i++)\n        (*dst)[i + dst_len] = (*src)[i];\n\n    /* Don't call virStringListFree() as it would free strings in\n     * @src. */\n    VIR_FREE(*src);\n    return 0;\n}"
  },
  {
    "function_name": "virStringListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "198-223",
    "snippet": "void\nvirStringListRemove(char ***strings,\n                    const char *item)\n{\n    size_t r, w = 0;\n\n    if (!strings || !*strings)\n        return;\n\n    for (r = 0; (*strings)[r]; r++) {\n        if (STREQ((*strings)[r], item)) {\n            VIR_FREE((*strings)[r]);\n            continue;\n        }\n        if (r != w)\n            (*strings)[w] = (*strings)[r];\n        w++;\n    }\n\n    if (w == 0) {\n        VIR_FREE(*strings);\n    } else {\n        (*strings)[w] = NULL;\n        ignore_value(VIR_REALLOC_N(*strings, w + 1));\n    }\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_REALLOC_N(*strings, w + 1)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "*strings",
            "w + 1"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*strings"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "(*strings)[r]"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "(*strings)[r]",
            "item"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirStringListRemove(char ***strings,\n                    const char *item)\n{\n    size_t r, w = 0;\n\n    if (!strings || !*strings)\n        return;\n\n    for (r = 0; (*strings)[r]; r++) {\n        if (STREQ((*strings)[r], item)) {\n            VIR_FREE((*strings)[r]);\n            continue;\n        }\n        if (r != w)\n            (*strings)[w] = (*strings)[r];\n        w++;\n    }\n\n    if (w == 0) {\n        VIR_FREE(*strings);\n    } else {\n        (*strings)[w] = NULL;\n        ignore_value(VIR_REALLOC_N(*strings, w + 1));\n    }\n}"
  },
  {
    "function_name": "virStringListAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "176-188",
    "snippet": "int\nvirStringListAdd(char ***strings,\n                 const char *item)\n{\n    size_t i = virStringListLength((const char **) *strings);\n\n    if (VIR_EXPAND_N(*strings, i, 2) < 0)\n        return -1;\n\n    (*strings)[i - 2] = g_strdup(item);\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "item"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "*strings",
            "i",
            "2"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListLength",
          "args": [
            "(const char **) *strings"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "893-901",
          "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStringListAdd(char ***strings,\n                 const char *item)\n{\n    size_t i = virStringListLength((const char **) *strings);\n\n    if (VIR_EXPAND_N(*strings, i, 2) < 0)\n        return -1;\n\n    (*strings)[i - 2] = g_strdup(item);\n\n    return 0;\n}"
  },
  {
    "function_name": "virStringListJoin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "147-162",
    "snippet": "char *virStringListJoin(const char **strings,\n                        const char *delim)\n{\n    char *ret;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    while (*strings) {\n        virBufferAdd(&buf, *strings, -1);\n        if (*(strings+1))\n            virBufferAdd(&buf, delim, -1);\n        strings++;\n    }\n    ret = virBufferContentAndReset(&buf);\n    if (!ret)\n        ret = g_strdup(\"\");\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"\""
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "&buf",
            "delim",
            "-1"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar *virStringListJoin(const char **strings,\n                        const char *delim)\n{\n    char *ret;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    while (*strings) {\n        virBufferAdd(&buf, *strings, -1);\n        if (*(strings+1))\n            virBufferAdd(&buf, delim, -1);\n        strings++;\n    }\n    ret = virBufferContentAndReset(&buf);\n    if (!ret)\n        ret = g_strdup(\"\");\n    return ret;\n}"
  },
  {
    "function_name": "virStringSplit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "126-132",
    "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringSplitCount",
          "args": [
            "string",
            "delim",
            "max_tokens",
            "NULL"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplitCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "69-123",
          "snippet": "char **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
  },
  {
    "function_name": "virStringSplitCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
    "lines": "69-123",
    "snippet": "char **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virthread.h\"",
      "#include \"virstring.h\"",
      "# include <xlocale.h>",
      "#include <locale.h>",
      "#include <glib/gprintf.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tokens"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tokens[i]"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "tokens",
            "maxtokens",
            "ntokens",
            "1"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "remainder"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "tokens",
            "maxtokens",
            "ntokens",
            "1"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "remainder",
            "delim"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "remainder",
            "len"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "tokens",
            "maxtokens",
            "ntokens",
            "1"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "delim"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "remainder",
            "delim"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}"
  }
]